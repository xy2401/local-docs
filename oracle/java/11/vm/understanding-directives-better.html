<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="The following topics examine how directives behave and interact.">
      <meta name="description" content="The following topics examine how directives behave and interact.">
      <title>Understanding Directives</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Java Virtual Machine Guide">
      <meta property="og:description" content="The following topics examine how directives behave and interact.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Java Virtual Machine Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="java-virtual-machine-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-20T02:39:56-07:00">
      <meta name="dcterms.title" content="Java Virtual Machine Guide">
      <meta name="dcterms.dateCopyrighted" content="1993, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E95202-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="writing-directives.html" title="Previous" type="text/html">
      <link rel="next" href="commands-work-directive-files.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="VM">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="writing-directives.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="commands-work-directive-files.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Java Virtual Machine Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="compiler-control1.html" property="item" typeof="WebPage"><span property="name">Compiler Control</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Understanding Directives</li>
            </ol>
            <a id="GUID-C776A298-BC96-40C7-8028-DB461298DD9F" name="GUID-C776A298-BC96-40C7-8028-DB461298DD9F"></a>
            
            <h2 id="JSJVM-GUID-C776A298-BC96-40C7-8028-DB461298DD9F" class="sect2">Understanding Directives</h2>
         </header>
         <div class="ind">
            <div>
               <p>The following topics examine how directives behave and interact.</p>
               <div class="section">
                  <p class="subhead1" id="GUID-C776A298-BC96-40C7-8028-DB461298DD9F__GUID-5C232252-6A97-4F24-837A-22730B66F082">Topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="understanding-directives-better.html#GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61" title="The default directive is a compiler directive that contains default values for all possible directive options. It is the bottom-most directives in the stack and matches every method submitted for compilation.">What Is the Default Directive?</a></p>
                     </li>
                     <li>
                        <p><a href="understanding-directives-better.html#GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D" title="A directive is applied to code based on a method matching process. Every method submitted for compilation is matched with a directive in the directives stack.">How Directives are Applied to Code?</a></p>
                     </li>
                     <li>
                        <p><a href="understanding-directives-better.html#GUID-AC93D367-C00F-4054-83A0-42C4BD5C4F87" title="CompileCommand and command-line flags can be used alongside Compiler Control directives.">Compiler Control and Backward Compatibility</a></p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
            </div>
            <div class="sect2"><a id="GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61" name="GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61"></a><h3 id="JSJVM-GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61" class="sect3">What Is the Default Directive?</h3>
               <div>
                  <p>The default directive is a compiler directive that contains default values for all possible directive options. It is the bottom-most directives in the stack and matches every method submitted for compilation. </p>
                  <p>When you design a new compiler directive, you specify how the new directive differs from the default directive. The default directive becomes a template to guide your design decisions.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61__GUID-D477DA1F-D95A-4B63-B8E4-C0D25DCC296D">Directive Option Values in the Default Directive</p>
                     <div class="p">You can print an empty directive stack to reveal the matching criteria and the values for all directive options in the default compiler directive:<pre class="pre codeblock"><code>Directive: (default)
 matching: *.*
 c1 directives:
  inline: -
  Enable:true Exclude:false BreakAtExecute:false BreakAtCompile:false Log:false PrintAssembly:false PrintInlining:false PrintNMethods:false BackgroundCompilation:true ReplayInline:false DumpReplay:false DumpInline:false CompilerDirectivesIgnoreCompileCommands:false DisableIntrinsic: BlockLayoutByFrequency:true PrintOptoAssembly:false PrintIntrinsics:false TraceOptoPipelining:false TraceOptoOutput:false TraceSpilling:false Vectorize:false VectorizeDebug:0 CloneMapDebug:false IGVPrintLevel:0 MaxNodeLimit:80000

 c2 directives:
  inline: -
  Enable:true Exclude:false BreakAtExecute:false BreakAtCompile:false Log:false PrintAssembly:false PrintInlining:false PrintNMethods:false BackgroundCompilation:true ReplayInline:false DumpReplay:false DumpInline:false CompilerDirectivesIgnoreCompileCommands:false DisableIntrinsic: BlockLayoutByFrequency:true PrintOptoAssembly:false PrintIntrinsics:false TraceOptoPipelining:false TraceOptoOutput:false TraceSpilling:false Vectorize:false VectorizeDebug:0 CloneMapDebug:false IGVPrintLevel:0 MaxNodeLimit:80000
</code></pre><div class="infoboxnote" id="GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61__GUID-CD45A841-50FA-4EB4-BC4D-C9EC20C4D32B">
                           <p class="notep1">Note:</p>Certain options are applicable exclusively to the <code class="codeph">c2</code> compiler. For a complete list, see <a href="writing-directives.html#GUID-FF488969-AFCD-48ED-93F5-A49C6C893D39__C2OPTIONS-61F28E20" title="Options exclusive to the c2 compiler">Table 2-2</a>.
                        </div>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61__GUID-9F33081B-475E-4BAA-A6AF-7000099BB020">Directive Option Values in New Directives</p>
                     <p>In a new directives, you must specify how the directive differs from the default directive. If you don’t specify a directive option, then that option retains the value from the default directive.</p>
                     <div class="p">Example:<pre class="pre codeblock"><code>[
    {
        match: ["*Concurrent.*"],
        c2: {
            MaxNodeLimit: 1000,
        },
        Exclude:true,
    },
]</code></pre>When you add a new directive to the directives stack, the default directive becomes the bottom-most directive in the stack. See <a href="commands-work-directive-files.html#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D" title="The order of the directives in a directives file, and in the directives is very important. The top-most, best-matching directive in the stack receives priority and is applied to code compilation.">How Directives Are Ordered in the Directives Stack?</a> for a description of this process. For this example, when you print the directives stack, it shows how the directive options specified in the new directive differ from the values in the default directive:<pre class="pre codeblock"><code>Directive:
 matching: *Concurrent.*
 c1 directives:
  inline: -
  Enable:true Exclude:true BreakAtExecute:false BreakAtCompile:false Log:false PrintAssembly:false PrintInlining:false PrintNMethods:false BackgroundCompilation:true ReplayInline:false DumpReplay:false DumpInline:false CompilerDirectivesIgnoreCompileCommands:false DisableIntrinsic: BlockLayoutByFrequency:true PrintOptoAssembly:false PrintIntrinsics:false TraceOptoPipelining:false TraceOptoOutput:false TraceSpilling:false Vectorize:false VectorizeDebug:0 CloneMapDebug:false IGVPrintLevel:0 MaxNodeLimit:80000 

 c2 directives:
  inline: -
  Enable:true Exclude:true BreakAtExecute:false BreakAtCompile:false Log:false PrintAssembly:false PrintInlining:false PrintNMethods:false BackgroundCompilation:true ReplayInline:false DumpReplay:false DumpInline:false CompilerDirectivesIgnoreCompileCommands:false DisableIntrinsic: BlockLayoutByFrequency:true PrintOptoAssembly:false PrintIntrinsics:false TraceOptoPipelining:false TraceOptoOutput:false TraceSpilling:false Vectorize:false VectorizeDebug:0 CloneMapDebug:false IGVPrintLevel:0 MaxNodeLimit:1000 


Directive: (default)
 matching: *.*
 c1 directives:
  inline: -
  Enable:true Exclude:false BreakAtExecute:false BreakAtCompile:false Log:false PrintAssembly:false PrintInlining:false PrintNMethods:false BackgroundCompilation:true ReplayInline:false DumpReplay:false DumpInline:false CompilerDirectivesIgnoreCompileCommands:false DisableIntrinsic: BlockLayoutByFrequency:true PrintOptoAssembly:false PrintIntrinsics:false TraceOptoPipelining:false TraceOptoOutput:false TraceSpilling:false Vectorize:false VectorizeDebug:0 CloneMapDebug:false IGVPrintLevel:0 MaxNodeLimit:80000 

 c2 directives:
  inline: -
  Enable:true Exclude:false BreakAtExecute:false BreakAtCompile:false Log:false PrintAssembly:false PrintInlining:false PrintNMethods:false BackgroundCompilation:true ReplayInline:false DumpReplay:false DumpInline:false CompilerDirectivesIgnoreCompileCommands:false DisableIntrinsic: BlockLayoutByFrequency:true PrintOptoAssembly:false PrintIntrinsics:false TraceOptoPipelining:false TraceOptoOutput:false TraceSpilling:false Vectorize:false VectorizeDebug:0 CloneMapDebug:false IGVPrintLevel:0 MaxNodeLimit:80000 </code></pre></div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D" name="GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D"></a><h3 id="JSJVM-GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D" class="sect3">How Directives are Applied to Code?</h3>
               <div>
                  <p>A directive is applied to code based on a method matching process. Every method submitted for compilation is matched with a directive in the directives stack.</p>
                  <p>The process of matching a method with a directive in the directives stack is performed by the CompilerBroker.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D__GUID-CA350A20-34FE-4A50-9C2C-7DBEA6DB1348">The Method Matching Process</p>
                     <p>When a method is submitted for compilation, the fully qualified name of the method is compared with the matching criteria in the directives stack. The first directive in the stack that matches is applied to the method. The remaining directives in the stack are ignored. If no match is found, then the default directive is applied. </p>
                     <p>This process is repeated for all methods in a compilation. More than one directive can be applied in a compilation, but only one directive is applied to each method. All directives in the stack are considered active because they are potentially applicable. The key differences between active and applied directives are:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>A directive is active if it’s present in the directives stack.</p>
                        </li>
                        <li>
                           <p>A directive is applied if it’s affecting code.</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D__WHENAMATCHISFOUND-573E11E1">
                     <p class="titleinexample">Example 2-1 When a Match Is Found</p>
                     <div class="p">The following example shows a method submitted for compilation:<pre class="pre codeblock"><code>public int exampleMethod(int x){
	return x;
}</code></pre>Based on method-matching criteria, <code class="codeph">Directive 2</code> is applied from the following example directive stack:<pre class="pre codeblock"><code>Directive 2:
 matching: *.*example*
Directive 1:
 matching: *.*exampleMethod*
Directive 0: (default)
 matching: *.*</code></pre></div>
                  </div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D__WHENNOMATCHISFOUND-573E14F6">
                     <p class="titleinexample">Example 2-2 When No Match Is Found</p>
                     <div class="p">The following example shows a method submitted for compilation:<pre class="pre codeblock"><code>public int otherMethod(int y){
	return y;
}</code></pre>Based on method-matching criteria, <code class="codeph">Directive 0</code> (the default directive) is applied from the following example directive stack:<pre class="pre codeblock"><code>Directive 2:
 matching: *.*example*
Directive 1:
 matching: *.*exampleMethod*
Directive 0: (default)
 matching: *.*</code></pre></div>
                  </div>
                  <!-- class="example" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D__OTHERGUIDELINES-B2A2E979">Guidelines for Writing a New Directive</p>
                     <div class="p">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>No feedback mechanism is provided to verify which directive is applied to a given method. Instead, a profiler such as Java Management Extensions (JMX) is used to measure the cumulative effects of applied directives.</p>
                           </li>
                           <li>
                              <p>The CompilerBroker ignores directive options that create bad code, such as forcing hardware instructions on a platform that doesn't offer support. A warning message is displayed.</p>
                           </li>
                           <li>
                              <p>Directive options have the same limitations as typical command-line flags. For example, the instructions to inline code are followed only if the Intermediate Representation (IR) doesn’t become too large.</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-AC93D367-C00F-4054-83A0-42C4BD5C4F87" name="GUID-AC93D367-C00F-4054-83A0-42C4BD5C4F87"></a><h3 id="JSJVM-GUID-AC93D367-C00F-4054-83A0-42C4BD5C4F87" class="sect3">Compiler Control and Backward Compatibility</h3>
               <div>
                  <p>CompileCommand and command-line flags can be used alongside Compiler Control directives.</p>
                  <div class="p">Although Compiler Control can replace CompileCommand, backward compatibility is provided. It’s possible to utilize both at the same time. Compiler Control receives priority. Conflicts are handled based on the following prioritization:
                     <ol>
                        <li>
                           <p>Compiler Control</p>
                        </li>
                        <li>
                           <p>CompileCommand </p>
                        </li>
                        <li>
                           <p>Command-line flags</p>
                        </li>
                        <li>
                           <p>Default values</p>
                        </li>
                     </ol>
                  </div>
                  <div class="example" id="GUID-AC93D367-C00F-4054-83A0-42C4BD5C4F87__GUID-DCEFB89D-AA73-484F-B97A-270D472486A8">
                     <p class="titleinexample">Example 2-3 Mixing Compiler Control and CompileCommand</p>
                     <div class="p">The following list shows a small number of compilation options and values:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Compiler Control:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">Exclude: true</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">BreakAtExecute: false</code></p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>CompileCommand:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">BreakAtExecute: true</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">BreakAtCompile: true</code></p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Default values:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">Exclude: false</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">BreakAtExecute: false</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">BreakAtCompile: false</code></p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">Log: false</code></p>
                                 </li>
                              </ul>
                           </li>
                        </ul>For the options and values in this example, the resulting compilation is determined by using the rules for handling backward compatibility conflicts:
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">Exclude: true</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">BreakAtExecute: false</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">BreakAtCompile: true</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">Log: false</code></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="example" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>
