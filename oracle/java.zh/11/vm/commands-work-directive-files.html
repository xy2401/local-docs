<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="This topic examines commands and the effects of working with completed directive files.">
      <meta name="description" content="This topic examines commands and the effects of working with completed directive files.">
      <title>Commands for Working with Directive Files</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Java Virtual Machine Guide">
      <meta property="og:description" content="This topic examines commands and the effects of working with completed directive files.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Java Virtual Machine Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="java-virtual-machine-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-20T02:39:56-07:00">
      <meta name="dcterms.title" content="Java Virtual Machine Guide">
      <meta name="dcterms.dateCopyrighted" content="1993, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E95202-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="understanding-directives-better.html" title="Previous" type="text/html">
      <link rel="next" href="garbage-collection-enhancements.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="VM">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="understanding-directives-better.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="garbage-collection-enhancements.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Java Virtual Machine Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="compiler-control1.html" property="item" typeof="WebPage"><span property="name">Compiler Control</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Commands for Working with Directive Files</li>
            </ol>
            <a id="GUID-88ECC49E-4581-49F6-952F-0EB7E12E8C84" name="GUID-88ECC49E-4581-49F6-952F-0EB7E12E8C84"></a>
            
            <h2 id="JSJVM-GUID-88ECC49E-4581-49F6-952F-0EB7E12E8C84" class="sect2">Commands for Working with Directive Files</h2>
         </header>
         <div class="ind">
            <div>
               <p>This topic examines commands and the effects of working with completed directive files.</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="commands-work-directive-files.html#GUID-3517007F-824A-4079-B374-188C107D9AB2" title="You can use the command-line interface to add and print compiler directives while starting a program.">Compiler Directives and the Command Line</a></p>
                  </li>
                  <li>
                     <p><a href="commands-work-directive-files.html#GUID-4B31D43A-EEBF-47E0-AAB5-9BEB23B7CFC2" title="You can use diagnostic commands to manage which directives are active at runtime. You can add or remove directives without restarting a running program.">Compiler Directives and Diagnostic Commands</a></p>
                  </li>
                  <li>
                     <p><a href="commands-work-directive-files.html#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D" title="The order of the directives in a directives file, and in the directives is very important. The top-most, best-matching directive in the stack receives priority and is applied to code compilation.">How Directives Are Ordered in the Directives Stack?</a></p>
                  </li>
               </ul>
            </div>
            <div class="sect2"><a id="GUID-3517007F-824A-4079-B374-188C107D9AB2" name="GUID-3517007F-824A-4079-B374-188C107D9AB2"></a><h3 id="JSJVM-GUID-3517007F-824A-4079-B374-188C107D9AB2" class="sect3">Compiler Directives and the Command Line</h3>
               <div>
                  <p>You can use the command-line interface to add and print compiler directives while starting a program. </p>
                  <p>You can specify only one directives file at the command line. All directives within that file are added to the directives stack and are immediately active when the program starts. Adding directives at the command line enables you to test the performance effects of directives during a program’s early stages. You can also focus on debugging and developing your program.</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-3517007F-824A-4079-B374-188C107D9AB2__GUID-C2CED810-86A6-48D1-89B4-E1D2604F2231">Adding Directives Through the Command Line</p>
                     <div class="p"> The following command-line option specifies a directives file:<pre class="pre codeblock"><code>XX:CompilerDirectivesFile=<span class="variable" translate="no">file</span></code></pre>Include this command-line option when you start a Java program. The following example shows this option, which starts <code class="codeph">TestProgram</code>:<pre class="pre codeblock"><code>java -XX:+UnlockDiagnosticVMOptions -XX:CompilerDirectivesFile=File_A.json TestProgram</code></pre>In the example:<ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">-XX:+UnlockDiagnosticVMOptions</code> enables diagnostic options. You must enter this before you add directives at the command line.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">-XX:CompilerDirectivesFile</code> is a type of diagnostic option. You can use it to specify one directives file to add to the directives stack.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">File_A.json</code> is a directives file. The file can contain multiple directives, all of which are added to the stack of active directives when the program starts.
                              </p>
                           </li>
                           <li>
                              <p>If <code class="codeph">File_A.json</code> contains syntax errors or malformed directives, then an error message is displayed and <code class="codeph">TestProgram</code> does not start.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-3517007F-824A-4079-B374-188C107D9AB2__GUID-A30F49F4-D0B8-46FD-9BCC-F7D8FA0DDFC0">Printing Directives Through the Command Line</p>
                     <div class="p">You can automatically print the directives stack when a program starts or when additional directives are added through diagnostic commands.  The following command-line option to enables this behavior:<pre class="pre codeblock"><code>-XX:+CompilerDirectivesPrint</code></pre>The following example shows how to include this diagnostic command at the command line:<pre class="pre codeblock"><code>java -XX:+UnlockDiagnosticVMOptions -XX:+CompilerDirectivesPrint -XX:CompilerDirectivesFile=File_A.json TestProgram&nbsp;</code></pre></div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-4B31D43A-EEBF-47E0-AAB5-9BEB23B7CFC2" name="GUID-4B31D43A-EEBF-47E0-AAB5-9BEB23B7CFC2"></a><h3 id="JSJVM-GUID-4B31D43A-EEBF-47E0-AAB5-9BEB23B7CFC2" class="sect3">Compiler Directives and Diagnostic Commands</h3>
               <div>
                  <p>You can use diagnostic commands to manage which directives are active at runtime. You can add or remove directives without restarting a running program.</p>
                  <p>Crafting a single perfect directives file might take some iteration and experimentation. Diagnostic commands provide powerful mechanisms for testing different configurations of directives in the directives stack. Diagnostic commands let you add or remove directives without restarting a running program’s JVM. </p>
               </div>
               <div class="sect3"><a id="GUID-EDDC54D0-F1E9-45C9-A251-C8067B1ABE17" name="GUID-EDDC54D0-F1E9-45C9-A251-C8067B1ABE17"></a><h4 id="JSJVM-GUID-EDDC54D0-F1E9-45C9-A251-C8067B1ABE17" class="sect4">Getting Your Java Process Identification Number</h4>
                  <div>
                     <p>To test directives you must find the processor identifier (PID) number of your running program.</p>
                     <ol>
                        <li><span>Open a terminal.</span></li>
                        <li><span>Enter the <kbd class="userinput">jcmd</kbd> command.</span></li>
                     </ol>
                     <div class="section">The <code>jcmd</code> command returns a list of the Java process that are running, along with their PID numbers. In the following example, the information returned about <code class="codeph">TestProgram</code> :<pre class="pre codeblock"><code>11084 TestProgram</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-AC077891-EB16-42FD-A10B-9FE1D2F4D03B" name="GUID-AC077891-EB16-42FD-A10B-9FE1D2F4D03B"></a><h4 id="JSJVM-GUID-AC077891-EB16-42FD-A10B-9FE1D2F4D03B" class="sect4">Adding Directives Through Diagnostic Commands</h4>
                  <div>
                     <p>You can add all directives in a file to the directives stack through the following diagnostic command.</p>
                     <div class="p">Syntax:<pre class="pre codeblock"><code>jcmd <span class="variable" translate="no">pid</span> Compiler.directives_add <span class="variable" translate="no">file</span></code></pre>The following example shows a diagnostic command:<pre class="pre codeblock"><code>jcmd 11084 Compiler.directives_add File_B.json</code></pre>The terminal reports the number of individual directives added. If the directives file contains syntax errors or malformed directives, then an error message is displayed, and no directives from the file are added to the stack, and no changes are made to the running program.</div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-11268025-CEE7-4C8A-82A4-B77FB690EFE7" name="GUID-11268025-CEE7-4C8A-82A4-B77FB690EFE7"></a><h4 id="JSJVM-GUID-11268025-CEE7-4C8A-82A4-B77FB690EFE7" class="sect4">Removing Directives Through Diagnostic Commands</h4>
                  <div>
                     <p>You can remove directives by using diagnostic commands.</p>
                     <div class="p">To remove the top-most, individual directive from the directive stack, enter:<pre class="pre codeblock"><code>jcmd <span class="variable" translate="no">pid</span> Compiler.directives_remove</code></pre>To clear every directive you added to the directives stack, enter:<pre class="pre codeblock"><code>jcmd <span class="variable" translate="no">pid</span> Compiler.directives_clear</code></pre>It’s not possible to specify an entire file of directives to remove, nor is any other way available to remove directives in bulk.</div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-0BA25646-8CB5-4DC4-A818-97140D83A4D9" name="GUID-0BA25646-8CB5-4DC4-A818-97140D83A4D9"></a><h4 id="JSJVM-GUID-0BA25646-8CB5-4DC4-A818-97140D83A4D9" class="sect4">Printing Directives Through Diagnostic Commands</h4>
                  <div>
                     <p>You can use diagnostic commands to print the directives stack of a running program.</p>
                     <div class="p">To print a detailed description of the full directives stack, enter:<pre class="pre codeblock"><code>jcmd <span class="variable" translate="no">pid</span> Compiler.directives_print</code></pre>Example output is shown in <a href="understanding-directives-better.html#GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61" title="The default directive is a compiler directive that contains default values for all possible directive options. It is the bottom-most directives in the stack and matches every method submitted for compilation.">What Is the Default Directive?</a></div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D" name="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D"></a><h3 id="JSJVM-GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D" class="sect3">How Directives Are Ordered in the Directives Stack?</h3>
               <div>
                  <p>The order of the directives in a directives file, and in the directives is very important. The top-most, best-matching directive in the stack receives priority and is applied to code compilation.</p>
                  <p> The following examples illustrate the order of directive files in an example directives stack. The directive files in the examples contain the following directives :</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">File_A</code> contains <code class="codeph">Directive 1</code> and <code class="codeph">Directive 2</code>.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">File_B</code> contains <code class="codeph">Directive 3</code>.
                        </p>
                     </li>
                     <li>
                        <p><code class="codeph">File_C</code> contains <code class="codeph">Directive 4</code> and <code class="codeph">Directive 5</code>.
                        </p>
                     </li>
                  </ul>
                  <div class="section">
                     <p class="subhead2" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-A3AA5893-BA94-4988-A039-0974E69601CD">Starting an Application With or Without Directives</p>
                     <div class="p">You can start the <code class="codeph">TestProgram</code> without specifying the directive files.
                        <ul style="list-style-type: disc;">
                           <li>
                              <div class="p">To start <code class="codeph">TestProgram</code> without adding any directives, at the command line, enter the following command: <pre class="pre codeblock"><code>java TestProgram</code></pre></div>
                           </li>
                           <li>
                              <p><code class="codeph">TestProgram</code> starts without any directives file specified. 
                              </p>
                           </li>
                           <li>
                              <p>The default directive is always the bottom-most directive in the directives stack. <a href="commands-work-directive-files.html#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-25591A0A-0883-47B2-8BAC-6AF6B7DF3C0C">Figure 2-1</a> shows the default directive as <code class="codeph">Directive 0</code>. When you don’t specify a directives file, the default directive is also the top-most directive and it receives priority.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="figure" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-25591A0A-0883-47B2-8BAC-6AF6B7DF3C0C">
                        <p class="titleinfigure">Figure 2-1 Starting a Program Without Directives</p><img src="img/jsjvm_dt_005_default.png" alt="Description of Figure 2-1 follows" title="Description of Figure 2-1 follows" longdesc="img_text/jsjvm_dt_005_default.html"><br><a href="img_text/jsjvm_dt_005_default.html">Description of "Figure 2-1 Starting a Program Without Directives"</a></div>
                     <!-- class="figure" -->
                     <div class="p">You can start an application and specify directives.
                        <ul style="list-style-type: disc;">
                           <li>
                              <div class="p">To start the <code class="codeph">TestProgram</code> application and add the directives from <code class="codeph">File_A.json</code> to the directives stack, at the command line, enter the following command: <pre class="pre codeblock"><code>java -XX:+UnlockDiagnosticVMOptions -XX:CompilerDirectivesFile=File_A.json TestProgram</code></pre></div>
                           </li>
                           <li>
                              <p><code class="codeph">TestProgram</code> starts and the directives in <code class="codeph">File_A</code> are added to the stack. The top-most directive in the directives file becomes the top-most directive in the directives stack.
                              </p>
                           </li>
                           <li>
                              <p><a href="commands-work-directive-files.html#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-2BCA3FD8-D759-432F-87ED-D4DD3729F087">Figure 2-2</a> shows that the order of directives in the stack, from top to bottom, becomes is [1, 2, 0].
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="figure" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-2BCA3FD8-D759-432F-87ED-D4DD3729F087">
                        <p class="titleinfigure">Figure 2-2 Starting a Program with Directives</p><img src="img/jsjvm_dt_001_stacka.png" alt="Description of Figure 2-2 follows" title="Description of Figure 2-2 follows" longdesc="img_text/jsjvm_dt_001_stacka.html"><br><a href="img_text/jsjvm_dt_001_stacka.html">Description of "Figure 2-2 Starting a Program with Directives"</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-FE0C295C-696C-4B75-B691-2182CEF8A51B">Adding Directives to a Running Application</p>
                     <div class="p">You can add directives to a running application through diagnostic commands.
                        <ul style="list-style-type: disc;">
                           <li>
                              <div class="p">To to add all directives from <code class="codeph">File_B</code> to the directives stack, enter the following command:<pre class="pre codeblock"><code>jcmd 11084 Compiler.directives_add File_B.json</code></pre></div>
                              <p>The directive in <code class="codeph">File_B </code>is added to the top of the stack.
                              </p>
                           </li>
                           <li>
                              <p><a href="commands-work-directive-files.html#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-4C6536FE-940A-415F-8CF7-F30E7FB1DB1D">Figure 2-3</a> shows that the order of directives in the stack becomes is [3, 1, 2, 0].
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="figure" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-4C6536FE-940A-415F-8CF7-F30E7FB1DB1D">
                        <p class="titleinfigure">Figure 2-3 Adding a Directive to a Running Program</p><img src="img/jsjvm_dt_002_stackb.png" alt="Description of Figure 2-3 follows" title="Description of Figure 2-3 follows" longdesc="img_text/jsjvm_dt_002_stackb.html"><br><a href="img_text/jsjvm_dt_002_stackb.html">Description of "Figure 2-3 Adding a Directive to a Running Program"</a></div>
                     <!-- class="figure" -->
                     <div class="p">You can add directive files through diagnostic commands to the <code class="codeph">TestProgram</code> while it is running:
                        <ul style="list-style-type: disc;">
                           <li>
                              <div class="p">To add all directives from <code class="codeph">File_C</code> to the directives stack, enter the following command. <pre class="pre codeblock"><code>jcmd 11084 Compiler.directives_add File_C.json</code></pre></div>
                           </li>
                           <li>
                              <p><a href="commands-work-directive-files.html#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-214F325E-560B-439B-87D9-CEF7FCEC484B">Figure 2-4</a> shows that the order of directives in the stack becomes is [4, 5, 3, 1, 2, 0].
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="figure" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-214F325E-560B-439B-87D9-CEF7FCEC484B">
                        <p class="titleinfigure">Figure 2-4 Adding multiple Directives to a Running Program</p><img src="img/jsjvm_dt_003_stackc.png" alt="Description of Figure 2-4 follows" title="Description of Figure 2-4 follows" longdesc="img_text/jsjvm_dt_003_stackc.html"><br><a href="img_text/jsjvm_dt_003_stackc.html">Description of "Figure 2-4 Adding multiple Directives to a Running Program"</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-915216C4-D7CD-4009-887B-41B645B9A24F">Removing Directives from the Directives Stack</p>
                     <div class="p">You can remove the top-most directive from the directive stacks through diagnostic commands.
                        <ul style="list-style-type: disc;">
                           <li>
                              <div class="p">To remove <code class="codeph">Directive 4</code> from the stack, enter the following command:<pre class="pre codeblock"><code><kbd class="userinput">jcmd 11084 Compiler.directives_remove</kbd></code></pre></div>
                           </li>
                           <li>
                              <p>To remove more, repeat this diagnostic command until only the default directive remains. You can’t remove the default directive.</p>
                           </li>
                           <li>
                              <p><a href="commands-work-directive-files.html#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-71E5F16A-326E-46F0-8D87-43482E996466">Figure 2-5</a> shows that the order of directives in the stack becomes is [5, 3, 1, 2, 0].
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="figure" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-71E5F16A-326E-46F0-8D87-43482E996466">
                        <p class="titleinfigure">Figure 2-5 Removing One Directive from the Stack</p><img src="img/jsjvm_dt_006_remove.png" alt="Description of Figure 2-5 follows" title="Description of Figure 2-5 follows" longdesc="img_text/jsjvm_dt_006_remove.html"><br><a href="img_text/jsjvm_dt_006_remove.html">Description of "Figure 2-5 Removing One Directive from the Stack"</a></div>
                     <!-- class="figure" -->
                     <div class="p">You can remove multiple directives from the directives stack.
                        <ul style="list-style-type: disc;">
                           <li>
                              <div class="p">To clear the directives stack, enter the following command:<pre class="pre codeblock"><code><kbd class="userinput">jcmd 11084 Compiler.directives_clear</kbd></code></pre></div>
                           </li>
                           <li>
                              <p>All directives are removed except the default directive. You can’t remove the default directive.</p>
                           </li>
                           <li>
                              <p><a href="commands-work-directive-files.html#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-2430733A-6FD5-4BE1-A04C-B569D796325D">Figure 2-6</a> shows that only <code class="codeph">Directive 0</code> remains in the stack.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="figure" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-2430733A-6FD5-4BE1-A04C-B569D796325D">
                        <p class="titleinfigure">Figure 2-6 Removing All Directives from the Stack</p><img src="img/jsjvm_dt_004_clear.png" alt="Description of Figure 2-6 follows" title="Description of Figure 2-6 follows" longdesc="img_text/jsjvm_dt_004_clear.html"><br><a href="img_text/jsjvm_dt_004_clear.html">Description of "Figure 2-6 Removing All Directives from the Stack"</a></div>
                     <!-- class="figure" -->
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>
