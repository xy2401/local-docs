<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;7.&nbsp;Spring AOP APIs</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.60.1"><link rel="home" href="index.html" title="Spring Framework &#24320;&#21457;&#21442;&#32771;&#25163;&#20876;"><link rel="up" href="spring-core.html" title="Part&nbsp;I.&nbsp;&#26680;&#24515;&#25216;&#26415;"><link rel="previous" href="aop.html" title="Chapter&nbsp;6.&nbsp;&#20351;&#29992;Spring&#36827;&#34892;&#38754;&#21521;&#20999;&#38754;&#32534;&#31243;&#65288;AOP&#65289;"><link rel="next" href="testing.html" title="Chapter&nbsp;8.&nbsp;&#27979;&#35797;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" style="background-color:white;border:none;height:73px;border:1px solid black;"><a style="border:none;" href="http://www.springframework.org/" title="The Spring Framework"><img style="border:none;" src="images/xdev-spring_logo.jpg"></a><a style="border:none;" href="http://www.springsource.com/" title="SpringSource"><img style="border:none;position:absolute;padding-top:5px;right:42px;" src="images/springsource-banner-rhs.png"></a></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="aop-api"></a>Chapter&nbsp;7.&nbsp;Spring AOP APIs</h2></div></div><div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-api-introduction"></a>7.1.&nbsp;&#31616;&#20171;</h2></div></div><div></div></div><p> &#21069;&#19968;&#31456;&#20171;&#32461;&#20102;Spring 2.0&#20013;&#25552;&#20379;&#30340;&#20351;&#29992;@AspectJ&#21644;&#22522;&#20110;Schema&#20999;&#38754;&#23450;&#20041;&#30340;AOP&#12290;&#22312;&#36825;&#20010;&#31456;&#33410;&#37324;&#65292;&#25105;&#20204;&#23558;&#35752;&#35770;&#26356;&#24213;&#23618;&#30340;Spring AOP API&#65292;
    &#20197;&#21450;&#22914;&#20309;&#22312;Spring 1.2&#24212;&#29992;&#20013;&#20351;&#29992;&#36825;&#20123;API&#12290;&#23545;&#20110;&#26032;&#30340;&#24212;&#29992;&#31243;&#24207;&#65292;&#25105;&#20204;&#25512;&#33616;&#20351;&#29992;&#21069;&#19968;&#31456;&#20171;&#32461;&#30340;Spring 2.0 AOP&#25903;&#25345;&#65292;&#20294;&#26159;&#24403;&#20320;&#20351;&#29992;&#24050;&#26377;&#31995;&#32479;&#26102;&#65292;
    &#25110;&#26159;&#38405;&#35835;&#20070;&#31821;&#21644;&#25991;&#31456;&#26102;&#65292;&#24456;&#26377;&#21487;&#33021;&#20250;&#36935;&#21040;Spring 1.2&#39118;&#26684;&#30340;&#20363;&#23376;&#12290;Spring 2.0&#26159;&#23436;&#20840;&#21521;&#21069;&#20860;&#23481;Spring 1.2&#30340;&#65292;
    &#36825;&#19968;&#31456;&#20013;&#28041;&#21450;&#30340;&#25152;&#26377;&#20869;&#23481;&#22312;Spring 2.0&#37324;&#38754;&#24471;&#21040;&#20102;&#23436;&#20840;&#30340;&#25903;&#25345;&#12290; </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-api-pointcuts"></a>7.2.&nbsp;Spring&#20013;&#30340;&#20999;&#20837;&#28857;API</h2></div></div><div></div></div><p>&#35753;&#25105;&#20204;&#30475;&#30475;Spring&#26159;&#22914;&#20309;&#22788;&#29702;&#20999;&#20837;&#28857;&#36825;&#20010;&#37325;&#35201;&#27010;&#24565;&#30340;&#12290;</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-api-concepts"></a>7.2.1.&nbsp;&#27010;&#24565;</h3></div></div><div></div></div><p>Spring&#30340;&#20999;&#20837;&#28857;&#27169;&#22411;&#20351;&#24471;&#20999;&#20837;&#28857;&#21487;&#20197;&#29420;&#31435;&#20110;&#36890;&#30693;&#65288;advice&#65289;&#31867;&#22411;&#36827;&#34892;&#37325;&#29992;&#65292;&#36825;&#23601;&#20351;&#24471;&#38024;&#23545;&#19981;&#21516;&#36890;&#30693;&#20351;&#29992;&#30456;&#21516;&#30340;pointcut&#25104;&#20026;&#21487;&#33021;&#12290;</p><p><tt class="literal">org.springframework.aop.Pointcut</tt>&#26159;&#26368;&#26680;&#24515;&#30340;&#25509;&#21475;&#65292;&#29992;&#26469;&#23558;&#36890;&#30693;&#24212;&#29992;&#20110;&#29305;&#23450;&#30340;&#31867;&#21644;&#26041;&#27861;&#65292;&#23436;&#25972;&#30340;&#25509;&#21475;&#23450;&#20041;&#22914;&#19979;&#65306;</p><pre class="programlisting">public interface Pointcut {

    ClassFilter getClassFilter();

    MethodMatcher getMethodMatcher();

        }</pre><p>&#23558;<tt class="interfacename">Pointcut</tt>&#25509;&#21475;&#20998;&#21106;&#25104;&#26377;&#21033;&#20110;&#37325;&#29992;&#31867;&#21644;&#26041;&#27861;&#21305;&#37197;&#30340;&#20004;&#37096;&#20998;&#65292;
        &#20197;&#21450;&#36827;&#34892;&#26356;&#32454;&#31890;&#24230;&#30340;&#25805;&#20316;&#32452;&#21512;&#65288;&#20363;&#22914;&#19982;&#21478;&#19968;&#20010;&#26041;&#27861;&#21305;&#37197;&#23454;&#29616;&#36827;&#34892;&#8220;&#25110;&#25805;&#20316;&#8221;&#65289;&#12290;</p><p><tt class="interfacename">ClassFilter</tt>&#25509;&#21475;&#29992;&#26469;&#23558;&#20999;&#20837;&#28857;&#38480;&#23450;&#22312;&#19968;&#20010;&#32473;&#23450;&#30340;&#31867;&#38598;&#21512;&#20013;&#12290;
        &#22914;&#26524;<tt class="literal">matches()</tt>&#26041;&#27861;&#24635;&#26159;&#36820;&#22238;true&#65292;&#25152;&#26377;&#30446;&#26631;&#31867;&#37117;&#23558;&#34987;&#21305;&#37197;&#65306;</p><pre class="programlisting">public interface ClassFilter {

    boolean matches(Class clazz);
        }</pre><p><tt class="interfacename">MethodMatcher</tt>&#25509;&#21475;&#36890;&#24120;&#26356;&#37325;&#35201;&#65292;&#23436;&#25972;&#30340;&#25509;&#21475;&#23450;&#20041;&#22914;&#19979;&#65306;</p><pre class="programlisting">public interface MethodMatcher {

    boolean matches(Method m, Class targetClass);

    boolean isRuntime();

    boolean matches(Method m, Class targetClass, Object[] args);
        }</pre><p><tt class="literal">matches(Method, Class)</tt>&#26041;&#27861;&#29992;&#26469;&#27979;&#35797;&#36825;&#20010;&#20999;&#20837;&#28857;&#26159;&#21542;&#21305;&#37197;&#30446;&#26631;&#31867;&#30340;&#25351;&#23450;&#26041;&#27861;&#12290;
        &#36825;&#23558;&#22312;AOP&#20195;&#29702;&#34987;&#21019;&#24314;&#30340;&#26102;&#20505;&#36827;&#34892;&#36816;&#31639;&#65292;&#36825;&#26679;&#21487;&#20197;&#36991;&#20813;&#22312;&#27599;&#27425;&#26041;&#27861;&#35843;&#29992;&#30340;&#26102;&#20505;&#37117;&#36816;&#31639;&#12290;
        &#22914;&#26524;<tt class="literal">matches(Method, Class)</tt>&#23545;&#20110;&#19968;&#20010;&#32473;&#23450;&#30340;&#26041;&#27861;&#36820;&#22238;true&#65292;&#24182;&#19988;<tt class="literal">isRuntime()</tt>&#20063;&#36820;&#22238;true&#65292;
        &#37027;&#20040;<tt class="literal">matches(Method, Class, Object[])</tt>&#23558;&#22312;&#27599;&#20010;&#26041;&#27861;&#35843;&#29992;&#30340;&#26102;&#20505;&#34987;&#35843;&#29992;&#12290;
        &#36825;&#20351;&#24471;&#20999;&#20837;&#28857;&#22312;&#36890;&#30693;&#23558;&#34987;&#25191;&#34892;&#21069;&#21487;&#20197;&#26597;&#30475;&#20256;&#20837;&#21040;&#26041;&#27861;&#30340;&#21442;&#25968;&#12290;</p><p>&#22823;&#22810;&#25968;MethodMatcher&#26159;&#38745;&#24577;&#30340;&#65292;&#36825;&#24847;&#21619;&#30528;<tt class="literal">isRuntime()</tt>&#26041;&#27861;&#36820;&#22238;false&#12290;
        &#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;<tt class="literal">matches(Method, Class , Object[])</tt>&#27704;&#36828;&#19981;&#20250;&#34987;&#35843;&#29992;&#12290; </p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="http://shouce.jb51.net/images/admons/tip.png"></td><th align="left">Tip</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#24212;&#23613;&#21487;&#33021;&#22320;&#20351;&#20999;&#20837;&#28857;&#20445;&#25345;&#38745;&#24577;&#65292;&#36825;&#23601;&#20801;&#35768;AOP&#26694;&#26550;&#22312;AOP&#20195;&#29702;&#34987;&#21019;&#24314;&#26102;&#32531;&#23384;&#23545;&#20999;&#20837;&#28857;&#30340;&#35745;&#31639;&#32467;&#26524;&#12290;</p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-api-pointcut-ops"></a>7.2.2.&nbsp;&#20999;&#20837;&#28857;&#36816;&#31639;</h3></div></div><div></div></div><p>Spring&#22312;&#20999;&#20837;&#28857;&#19978;&#25903;&#25345;&#20197;&#19979;&#36816;&#31639;&#65306; <span class="emphasis"><em>&#25110;</em></span>&#21644;<span class="emphasis"><em>&#19982;</em></span>&#12290;</p><div class="itemizedlist"><ul type="disc"><li><p>&#25110;&#36816;&#31639;&#34920;&#31034;&#21482;&#38656;&#26377;&#19968;&#20010;&#20999;&#20837;&#28857;&#34987;&#21305;&#37197;&#23601;&#25191;&#34892;&#26041;&#27861;&#12290;</p></li><li><p>&#19982;&#36816;&#31639;&#34920;&#31034;&#25152;&#26377;&#30340;&#20999;&#20837;&#28857;&#37117;&#21305;&#37197;&#30340;&#24773;&#20917;&#19979;&#25165;&#25191;&#34892;&#12290;</p></li><li><p>&#36890;&#24120;&#25110;&#36816;&#31639;&#35201;&#26356;&#26377;&#29992;&#19968;&#20123;&#12290;</p></li><li><p>&#20999;&#20837;&#28857;&#21487;&#20197;&#20351;&#29992;<span class="emphasis"><em>org.springframework.aop.support.Pointcuts</em></span>&#31867;&#20013;&#30340;&#38745;&#24577;&#26041;&#27861;&#26469;&#36827;&#34892;&#32452;&#21512;&#65292;
                &#25110;&#32773;&#20351;&#29992;&#21516;&#19968;&#20010;&#21253;&#20869;&#30340;<span class="emphasis"><em>ComposablePointcut</em></span>&#31867;&#12290;&#19981;&#36807;&#20351;&#29992;AspectJ&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#36890;&#24120;&#20250;&#26356;&#31616;&#21333;&#19968;&#20123;&#12290; </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-api-pointcuts-aspectj"></a>7.2.3.&nbsp;AspectJ&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;</h3></div></div><div></div></div><p>&#20174;2.0&#24320;&#22987;&#65292;Spring&#20013;&#20351;&#29992;&#30340;&#26368;&#37325;&#35201;&#30340;&#20999;&#20837;&#28857;&#31867;&#22411;&#26159;<tt class="literal">org.springframework.aop.aspectj.AspectJExpressionPointcut</tt>&#12290;
        &#36825;&#20010;&#20999;&#20837;&#28857;&#20351;&#29992;AspectJ&#25552;&#20379;&#30340;&#24211;&#26469;&#35299;&#26512;&#28385;&#36275;AspectJ&#35821;&#27861;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#23383;&#31526;&#20018;&#12290; </p><p>&#21487;&#20197;&#26597;&#30475;&#21069;&#19968;&#31456;&#20851;&#20110;&#25152;&#25903;&#25345;&#30340;AspectJ&#20999;&#20837;&#28857;&#21407;&#35821;&#30340;&#35752;&#35770;&#12290; </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-api-pointcuts-impls"></a>7.2.4.&nbsp;&#20415;&#21033;&#30340;&#20999;&#20837;&#28857;&#23454;&#29616;</h3></div></div><div></div></div><p>Spring&#25552;&#20379;&#20102;&#19968;&#20123;&#24456;&#26041;&#20415;&#30340;&#20999;&#20837;&#28857;&#23454;&#29616;&#12290;&#19968;&#20123;&#21487;&#30452;&#25509;&#20351;&#29992;&#65292;&#20854;&#23427;&#30340;&#21017;&#26159;&#20999;&#20837;&#28857;&#24212;&#29992;&#35268;&#33539;&#30340;&#23376;&#38598;&#12290; </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-api-pointcuts-static"></a>7.2.4.1.&nbsp;&#38745;&#24577;&#20999;&#20837;&#28857;</h4></div></div><div></div></div><p>&#38745;&#24577;&#20999;&#20837;&#28857;&#22522;&#20110;&#26041;&#27861;&#21644;&#30446;&#26631;&#31867;&#36827;&#34892;&#20999;&#20837;&#28857;&#21028;&#26029;&#65292;&#19981;&#32771;&#34385;&#26041;&#27861;&#30340;&#21442;&#25968;&#12290;&#22312;&#22810;&#25968;&#24773;&#20917;&#19979;&#65292;&#38745;&#24577;&#20999;&#20837;&#28857;&#26159;&#39640;&#25928;&#30340;&#12289;&#26368;&#22909;&#30340;&#36873;&#25321;&#12290;
            Spring&#21482;&#22312;&#31532;&#19968;&#27425;&#35843;&#29992;&#26041;&#27861;&#26102;&#36816;&#31639;&#38745;&#24577;&#20999;&#20837;&#28857;&#65306;&#20197;&#21518;&#27599;&#27425;&#35843;&#29992;&#36825;&#20010;&#26041;&#27861;&#26102;&#23601;&#19981;&#38656;&#35201;&#20877;&#36816;&#31639;&#20102;&#12290; </p><p>&#35753;&#25105;&#20204;&#32771;&#34385;Spring&#20013;&#30340;&#19968;&#20123;&#38745;&#24577;&#20999;&#20837;&#28857;&#23454;&#29616;&#12290;</p><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="aop-api-pointcuts-regex"></a>7.2.4.1.1.&nbsp;&#27491;&#21017;&#34920;&#36798;&#24335;&#20999;&#20837;&#28857;</h5></div></div><div></div></div><p>&#26174;&#32780;&#26131;&#35265;&#65292;&#19968;&#31181;&#25551;&#36848;&#38745;&#24577;&#20999;&#20837;&#28857;&#30340;&#26041;&#24335;&#26159;&#20351;&#29992;&#27491;&#21017;&#34920;&#36798;&#24335;&#12290;&#21253;&#21547;Spring&#22312;&#20869;&#30340;&#19968;&#20123;AOP&#26694;&#26550;&#37117;&#25903;&#25345;&#36825;&#31181;&#26041;&#24335;&#12290;
                    <tt class="literal">org.springframework.aop.support.Perl5RegexpMethodPointcut</tt>&#26159;&#19968;&#20010;&#26368;&#22522;&#26412;&#30340;&#27491;&#21017;&#34920;&#36798;&#24335;&#20999;&#20837;&#28857;&#65292;
                    &#23427;&#20351;&#29992;Perl 5&#27491;&#21017;&#34920;&#36798;&#24335;&#35821;&#27861;&#12290;<tt class="literal">Perl5RegexpMethodPointcut</tt>&#20381;&#36182;Jakarta ORO&#36827;&#34892;&#27491;&#21017;&#34920;&#36798;&#24335;&#21305;&#37197;&#12290;
                Spring&#20063;&#25552;&#20379;&#20102;<tt class="literal">JdkRegexpMethodPointcut</tt>&#31867;&#65292;&#23427;&#20351;&#29992;JDK 1.4&#25110;&#26356;&#39640;&#29256;&#26412;&#37324;&#25552;&#20379;&#30340;&#27491;&#21017;&#34920;&#36798;&#24335;&#25903;&#25345;&#12290;</p><p>&#20351;&#29992;<tt class="literal">Perl5RegexpMethodPointcut</tt>&#31867;&#65292;&#20320;&#21487;&#20197;&#25552;&#20379;&#19968;&#32452;&#27169;&#24335;&#23383;&#31526;&#20018;&#12290;
                &#22914;&#26524;&#20854;&#20013;&#20219;&#24847;&#19968;&#20010;&#27169;&#24335;&#21305;&#37197;&#65292;&#20999;&#20837;&#28857;&#23558;&#34987;&#35299;&#26512;&#20026;true&#12290;&#65288;&#23454;&#38469;&#19978;&#23601;&#26159;&#36825;&#20123;&#20999;&#20837;&#28857;&#30340;&#25110;&#38598;&#12290;&#65289;</p><p>&#29992;&#27861;&#22914;&#19979;&#65306;</p><p>
                    </p><pre class="programlisting">&lt;bean id="settersAndAbsquatulatePointcut" 
                        class="org.springframework.aop.support.Perl5RegexpMethodPointcut"&gt;
                        &lt;property name="patterns"&gt;
                        &lt;list&gt;
                        &lt;value&gt;.*set.*&lt;/value&gt;
                        &lt;value&gt;.*absquatulate&lt;/value&gt;
                        &lt;/list&gt;
                        &lt;/property&gt;
                    &lt;/bean&gt;</pre><p>
                </p><p>Spring&#25552;&#20379;&#20102;&#19968;&#20010;&#26041;&#20415;&#30340;&#31867; <tt class="literal">RegexpMethodPointcutAdvisor</tt>&#65292;
                    &#23427;&#20063;&#20801;&#35768;&#25105;&#20204;&#24341;&#29992;&#19968;&#20010;&#36890;&#30693;&#65288;&#35760;&#20303;&#36825;&#37324;&#19968;&#20010;&#36890;&#30693;&#21487;&#20197;&#26159;&#25318;&#25130;&#22120;&#65292;&#21069;&#32622;&#36890;&#30693;&#65288;before advice&#65289;&#65292;&#24322;&#24120;&#36890;&#30693;&#65288;throws advice&#65289;&#31561;&#31867;&#22411;&#20013;&#30340;&#19968;&#20010;&#65289;&#12290;
                    &#22312;&#32972;&#21518;&#65292;&#22914;&#26524;&#20351;&#29992;J2SE 1.4&#25110;&#32773;&#20197;&#19978;&#29256;&#26412;&#65292;Spring&#23558;&#20351;&#29992;<tt class="literal">JdkRegexpMethodPointcut</tt>&#65292;
                    &#22312;&#20043;&#21069;&#29256;&#26412;&#30340;&#34394;&#25311;&#26426;&#19978;&#65292;Spring&#23558;&#36864;&#22238;&#21435;&#20351;&#29992;<tt class="literal">Perl5RegexpMethodPointcut</tt>&#12290;
                    &#21487;&#20197;&#36890;&#36807;&#35774;&#32622;<tt class="literal">perl5</tt>&#23646;&#24615;&#20026;true&#26469;&#24378;&#21046;&#20351;&#29992;<tt class="literal">Perl5RegexpMethodPointcut</tt>&#12290;
                    &#20351;&#29992;<tt class="literal">RegexpMethodPointcutAdvisor</tt>&#21487;&#20197;&#31616;&#21270;&#32455;&#20837;&#65292;&#22240;&#20026;&#19968;&#20010;bean&#21487;&#20197;&#21516;&#26102;&#20316;&#20026;&#20999;&#20837;&#28857;&#21644;&#36890;&#30693;&#22120;&#65288;advisor&#65289;&#65292;&#22914;&#19979;&#25152;&#31034;&#65306; </p><p>
                    </p><pre class="programlisting">&lt;bean id="settersAndAbsquatulateAdvisor" 
                        class="org.springframework.aop.support.RegexpMethodPointcutAdvisor"&gt;
                        &lt;property name="advice"&gt;
                        &lt;ref local="beanNameOfAopAllianceInterceptor"/&gt;
                        &lt;/property&gt;
                        &lt;property name="patterns"&gt;
                        &lt;list&gt;
                        &lt;value&gt;.*set.*&lt;/value&gt;
                        &lt;value&gt;.*absquatulate&lt;/value&gt;
                        &lt;/list&gt;
                        &lt;/property&gt;
                    &lt;/bean&gt;</pre><p>
                </p><p><span class="emphasis"><em>RegexpMethodPointcutAdvisor</em></span>&#21487;&#20197;&#21644;&#20219;&#20309;&#36890;&#30693;&#31867;&#22411;&#19968;&#36215;&#20351;&#29992;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="aop-api-pointcuts-attribute-driven"></a>7.2.4.1.2.&nbsp;&#23646;&#24615;&#39537;&#21160;&#30340;&#20999;&#20837;&#28857;</h5></div></div><div></div></div><p>&#19968;&#20010;&#37325;&#35201;&#30340;&#38745;&#24577;&#20999;&#20837;&#28857;&#26159;<span class="emphasis"><em>&#20803;&#25968;&#25454;&#39537;&#21160;(metadata-driven)</em></span>&#20999;&#20837;&#28857;&#12290;&#36825;&#20351;&#29992;&#20803;&#25968;&#25454;&#21442;&#25968;&#65306;&#29305;&#21035;&#26159;&#28304;&#20195;&#30721;&#32423;&#21035;&#30340;&#20803;&#25968;&#25454;&#12290;
                </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-api-pointcuts-dynamic"></a>7.2.4.2.&nbsp;&#21160;&#24577;&#20999;&#20837;&#28857;</h4></div></div><div></div></div><p>&#21160;&#24577;&#20999;&#20837;&#28857;&#27604;&#36215;&#38745;&#24577;&#20999;&#20837;&#28857;&#22312;&#25191;&#34892;&#26102;&#35201;&#28040;&#32791;&#26356;&#22810;&#30340;&#36164;&#28304;&#12290;&#23427;&#20204;&#21516;&#26102;&#35745;&#31639;&#26041;&#27861;<span class="emphasis"><em>&#21442;&#25968;</em></span>&#21644;&#38745;&#24577;&#20449;&#24687;&#12290;
            &#36825;&#24847;&#21619;&#30528;&#23427;&#20204;&#24517;&#39035;&#22312;&#27599;&#27425;&#26041;&#27861;&#35843;&#29992;&#26102;&#37117;&#34987;&#35745;&#31639;&#65307;&#30001;&#20110;&#21442;&#25968;&#30340;&#19981;&#21516;&#65292;&#32467;&#26524;&#19981;&#33021;&#34987;&#32531;&#23384;&#12290; </p><p>&#21160;&#24577;&#20999;&#20837;&#28857;&#30340;&#20027;&#35201;&#20363;&#23376;&#26159;<tt class="literal">&#25511;&#21046;&#27969;</tt>&#20999;&#20837;&#28857;&#12290;</p><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="aop-api-pointcuts-cflow"></a>7.2.4.2.1.&nbsp;&#25511;&#21046;&#27969;&#20999;&#20837;&#28857;</h5></div></div><div></div></div><p>Spring&#25511;&#21046;&#27969;&#20999;&#20837;&#28857;&#22312;&#27010;&#24565;&#19978;&#21644;AspectJ&#30340;<span class="emphasis"><em>cflow</em></span> &#20999;&#20837;&#28857;&#24456;&#30456;&#20284;&#65292;
                    &#34429;&#28982;&#23427;&#30340;&#21151;&#33021;&#19981;&#22914;&#21518;&#32773;&#37027;&#20040;&#24378;&#22823;&#12290;&#65288;&#30446;&#21069;&#36824;&#19981;&#33021;&#35753;&#19968;&#20010;&#20999;&#20837;&#28857;&#22312;&#21478;&#22806;&#19968;&#20010;&#20999;&#20837;&#28857;&#25152;&#21305;&#37197;&#30340;&#36830;&#25509;&#28857;&#22788;&#25191;&#34892;&#65289;&#12290;
                    &#19968;&#20010;&#25511;&#21046;&#27969;&#20999;&#20837;&#28857;&#21305;&#37197;&#24403;&#21069;&#30340;&#35843;&#29992;&#26632;&#12290;&#20363;&#22914;&#65292;&#19968;&#20010;&#36830;&#25509;&#28857;&#34987;<tt class="literal">com.mycompany.web</tt>
                    &#21253;&#20869;&#30340;&#19968;&#20010;&#26041;&#27861;&#25110;&#32773;<tt class="literal">SomeCaller</tt>&#31867;&#35843;&#29992;&#65292;&#20999;&#20837;&#28857;&#23601;&#21487;&#33021;&#34987;&#28608;&#27963;&#12290;
                    &#25511;&#21046;&#27969;&#20999;&#20837;&#28857;&#26159;&#30001;<tt class="literal">org.springframework.aop.support.ControlFlowPointcut</tt>&#31867;&#22768;&#26126;&#30340;&#12290; 
                    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#22312;&#36816;&#34892;&#26102;&#25511;&#21046;&#27969;&#20999;&#20837;&#28857;&#30340;&#24320;&#38144;&#26159;&#38750;&#24120;&#26114;&#36149;&#30340;&#65292;&#29978;&#33267;&#19982;&#20854;&#23427;&#21160;&#24577;&#20999;&#20837;&#28857;&#27604;&#36215;&#26469;&#20063;&#26159;&#22914;&#27492;&#12290;&#22312;Java 1.4&#37324;&#65292;
                        &#23427;&#30340;&#24320;&#38144;&#24046;&#19981;&#22810;&#26159;&#20854;&#23427;&#21160;&#24577;&#20999;&#20837;&#28857;&#30340;5&#20493;&#12290;</p></td></tr></table></div><p>
                </p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-api-pointcuts-superclasses"></a>7.2.5.&nbsp;&#20999;&#20837;&#28857;&#30340;&#36229;&#31867;</h3></div></div><div></div></div><p>Spring&#25552;&#20379;&#20102;&#24456;&#22810;&#26377;&#29992;&#30340;&#20999;&#20837;&#28857;&#36229;&#31867;&#26469;&#24110;&#21161;&#20320;&#23454;&#29616;&#20320;&#33258;&#24049;&#30340;&#20999;&#20837;&#28857;&#12290;</p><p>&#22240;&#20026;&#38745;&#24577;&#20999;&#20837;&#28857;&#26159;&#26368;&#24120;&#29992;&#30340;&#65292;&#20320;&#21487;&#33021;&#20250;&#20687;&#19979;&#38754;&#37027;&#26679;&#32487;&#25215;StaticMethodMatcherPointcut&#12290;&#36825;&#21482;&#38656;&#35201;&#23454;&#29616;&#19968;&#20010;&#25277;&#35937;&#26041;&#27861;
        &#65288;&#34429;&#28982;&#20063;&#21487;&#20197;&#35206;&#30422;&#20854;&#23427;&#26041;&#27861;&#26469;&#23450;&#21046;&#34892;&#20026;&#65289;&#65306;</p><pre class="programlisting">class TestStaticPointcut extends StaticMethodMatcherPointcut {
                
                public boolean matches(Method m, Class targetClass) {
                // return true if custom criteria match
                }
        }</pre><p>&#21160;&#24577;&#20999;&#20837;&#28857;&#20063;&#26377;&#24456;&#22810;&#36229;&#31867;&#12290;</p><p>&#20320;&#21487;&#20197;&#22312;&#20351;&#29992;&#33258;&#23450;&#20041;&#20999;&#20837;&#28857;&#30340;&#21516;&#26102;&#32467;&#21512;Spring 1.0 RC2&#21644;&#26356;&#39640;&#29256;&#26412;&#20013;&#30340;&#20219;&#24847;&#36890;&#30693;&#31867;&#22411;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-api-pointcuts-custom"></a>7.2.6.&nbsp;&#33258;&#23450;&#20041;&#20999;&#20837;&#28857;</h3></div></div><div></div></div><p>&#22240;&#20026;&#22312;Spring AOP&#20013;&#30340;&#20999;&#20837;&#28857;&#26159;Java&#31867;&#32780;&#19981;&#26159;&#35821;&#35328;&#30340;&#29305;&#24615;&#65288;&#23601;&#20687;AspectJ&#37027;&#26679;&#65289;&#65292;&#25152;&#20197;&#21487;&#20197;&#22768;&#26126;&#33258;&#23450;&#20041;&#30340;&#20999;&#20837;&#28857;&#65292;&#19981;&#35770;&#26159;&#38745;&#24577;&#36824;&#26159;&#21160;&#24577;&#30340;&#12290;
        &#33258;&#23450;&#20041;&#20999;&#20837;&#28857;&#22312;Spring&#37324;&#21487;&#33021;&#24456;&#24378;&#22823;&#12290;&#21363;&#20351;&#36825;&#26679;&#25105;&#20204;&#20173;&#25512;&#33616;&#23613;&#21487;&#33021;&#20351;&#29992;AspectJ&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#35821;&#35328;&#12290;</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#21518;&#32493;&#29256;&#26412;&#30340;Spring&#20063;&#35768;&#20250;&#25552;&#20379;&#8220;&#35821;&#20041;&#20999;&#20837;&#28857;&#8221;&#65292;&#20687;JAC&#25152;&#25552;&#20379;&#30340;&#37027;&#26679;&#65306;&#20363;&#22914;&#65292;&#8220;&#25152;&#26377;&#26041;&#27861;&#21487;&#20197;&#20462;&#25913;&#30446;&#26631;&#23545;&#35937;&#20013;&#23454;&#20363;&#21464;&#37327;&#8221;</p></td></tr></table></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-api-advice"></a>7.3.&nbsp;Spring&#30340;&#36890;&#30693;API</h2></div></div><div></div></div><p>&#29616;&#22312;&#35753;&#25105;&#20204;&#30475;&#19968;&#19979;SPring AOP&#26159;&#24590;&#26679;&#22788;&#29702;&#36890;&#30693;&#30340;&#12290;</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-api-advice-lifecycle"></a>7.3.1.&nbsp;&#36890;&#30693;&#30340;&#29983;&#21629;&#21608;&#26399;</h3></div></div><div></div></div><p>&#27599;&#20010;&#36890;&#30693;&#37117;&#26159;&#19968;&#20010;Spring bean&#12290;&#19968;&#20010;&#36890;&#30693;&#23454;&#20363;&#26082;&#21487;&#20197;&#34987;&#25152;&#26377;&#34987;&#36890;&#30693;&#30340;&#23545;&#35937;&#20849;&#20139;&#65292;&#20063;&#21487;&#20197;&#34987;&#27599;&#20010;&#34987;&#36890;&#30693;&#23545;&#35937;&#29420;&#21344;&#12290;
        &#36825;&#26681;&#25454;&#35774;&#32622;<span class="emphasis"><em>&#31867;&#20849;&#20139;&#65288;per-class&#65289;</em></span>&#25110;<span class="emphasis"><em>&#22522;&#20110;&#23454;&#20363;&#65288;per-instance&#65289;</em></span>&#30340;&#21442;&#25968;&#26469;&#20915;&#23450;&#12290;</p><p>&#31867;&#20849;&#20139;&#36890;&#30693;&#32463;&#24120;&#20250;&#34987;&#29992;&#21040;&#12290;&#23427;&#24456;&#36866;&#21512;&#29992;&#20316;&#36890;&#29992;&#30340;&#36890;&#30693;&#20363;&#22914;&#20107;&#21153;&#36890;&#30693;&#22120;&#65288;advisor&#65289;&#12290;&#36825;&#20123;&#36890;&#30693;&#22120;&#19981;&#20381;&#36182;&#20110;&#20195;&#29702;&#23545;&#35937;&#30340;&#29366;&#24577;&#20063;&#19981;&#20250;&#21521;&#20195;&#29702;&#23545;&#35937;&#28155;&#21152;&#26032;&#30340;&#29366;&#24577;&#65307;
        &#23427;&#20204;&#20165;&#20165;&#22312;&#26041;&#27861;&#21644;&#21442;&#25968;&#19978;&#36215;&#20316;&#29992;&#12290;
        </p><p>&#22522;&#20110;&#23454;&#20363;&#30340;&#36890;&#30693;&#24456;&#36866;&#21512;&#29992;&#20316;&#23548;&#20837;&#22120;&#26469;&#25903;&#25345;&#28151;&#21512;&#31867;&#22411;&#65288;mixin&#65289;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#36890;&#30693;&#21521;&#20195;&#29702;&#23545;&#35937;&#28155;&#21152;&#29366;&#24577;&#12290;</p><p>&#22312;&#21516;&#19968;&#20010;AOP&#20195;&#29702;&#37324;&#28151;&#21512;&#20351;&#29992;&#31867;&#20849;&#20139;&#21644;&#22522;&#20110;&#23454;&#20363;&#30340;&#36890;&#30693;&#26159;&#21487;&#33021;&#30340;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-api-advice-types"></a>7.3.2.&nbsp;Spring&#37324;&#30340;&#36890;&#30693;&#31867;&#22411;</h3></div></div><div></div></div><p>Spring&#33258;&#24102;&#20102;&#22810;&#31181;&#36890;&#30693;&#31867;&#22411;&#65292;&#32780;&#19988;&#23427;&#20204;&#20063;&#21487;&#20197;&#34987;&#25193;&#23637;&#26469;&#25903;&#25345;&#21508;&#31181;&#36890;&#30693;&#31867;&#22411;&#12290;&#35753;&#25105;&#20204;&#20808;&#30475;&#30475;&#22522;&#26412;&#27010;&#24565;&#21644;&#26631;&#20934;&#30340;&#36890;&#30693;&#31867;&#22411;&#12290;</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-api-advice-around"></a>7.3.2.1.&nbsp;&#25318;&#25130;&#29615;&#32469;&#36890;&#30693;</h4></div></div><div></div></div><p>&#22312;Spring&#20013;&#26368;&#22522;&#30784;&#30340;&#36890;&#30693;&#31867;&#22411;&#26159;<span class="emphasis"><em>&#25318;&#25130;&#29615;&#32469;&#36890;&#30693;</em></span>&#65288;interception around advice&#65289;&#12290;</p><p>Spring&#37324;&#20351;&#29992;&#26041;&#27861;&#25318;&#25130;&#30340;&#29615;&#32469;&#36890;&#30693;&#20860;&#23481;AOP&#32852;&#30431;&#25509;&#21475;&#12290;&#23454;&#29616;&#29615;&#32469;&#36890;&#30693;&#30340;MethodInterceptor&#24212;&#24403;&#23454;&#29616;&#19979;&#38754;&#30340;&#25509;&#21475;&#65306;</p><pre class="programlisting">public interface MethodInterceptor extends Interceptor {
                
                Object invoke(MethodInvocation invocation) throws Throwable;
            }</pre><p><tt class="methodname">invoke()</tt>&#26041;&#27861;&#30340;<tt class="classname">MethodInvocation</tt>&#21442;&#25968;&#26292;&#38706;&#20102;&#34987;&#35843;&#29992;&#30340;&#26041;&#27861;&#65307;
                &#30446;&#26631;&#36830;&#25509;&#28857;&#65307;AOP&#20195;&#29702;&#20197;&#21450;&#20256;&#36882;&#32473;&#26041;&#27861;&#30340;&#21442;&#25968;&#12290;<tt class="methodname">invoke()</tt>&#26041;&#27861;&#24212;&#35813;&#36820;&#22238;&#35843;&#29992;&#30340;&#32467;&#26524;&#65306;&#21363;&#36830;&#25509;&#28857;&#30340;&#36820;&#22238;&#20540;&#12290;
            </p><p>&#19968;&#20010;&#31616;&#21333;&#30340;<tt class="classname">MethodInterceptor</tt>&#23454;&#29616;&#30475;&#36215;&#26469;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;</p><pre class="programlisting">public class DebugInterceptor implements MethodInterceptor {
                
                public Object invoke(MethodInvocation invocation) throws Throwable {
                System.out.println("Before: invocation=[" + invocation + "]");
                Object rval = invocation.proceed();
                System.out.println("Invocation returned");
                return rval;
                }
            }</pre><p>&#27880;&#24847;&#23545;MethodInvocation&#20013;<tt class="methodname">proceed()</tt>&#26041;&#27861;&#30340;&#35843;&#29992;&#12290;
            &#36825;&#20010;&#26041;&#27861;&#32487;&#32493;&#36816;&#34892;&#25351;&#21521;&#36830;&#25509;&#28857;&#30340;&#25318;&#25130;&#22120;&#38142;&#24182;&#36820;&#22238;proceed()&#30340;&#32467;&#26524;&#12290;&#22823;&#22810;&#25968;&#25318;&#25130;&#22120;&#20250;&#35843;&#29992;&#36825;&#20010;&#26041;&#27861;&#65292;&#36820;&#22238;&#19968;&#20010;&#20540;&#12290;
            &#28982;&#32780;&#65292;&#19968;&#20010;&#31867;&#20284;&#20219;&#24847;&#29615;&#32469;&#36890;&#30693;&#30340;MethodInterceptor&#65292;&#21487;&#20197;&#36820;&#22238;&#19968;&#20010;&#19981;&#21516;&#30340;&#20540;&#25110;&#32773;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#32780;&#19981;&#26159;&#35843;&#29992;proceed&#26041;&#27861;&#12290;
            &#20294;&#38500;&#38750;&#20320;&#26377;&#24456;&#22909;&#30340;&#29702;&#30001;&#65292;&#21542;&#21017;&#19981;&#35201;&#32771;&#34385;&#36825;&#26679;&#20570;&#65281;</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>MethodInterceptor&#25552;&#20379;&#20102;&#19982;&#20854;&#23427;AOP&#32852;&#30431;&#20860;&#23481;&#23454;&#29616;&#30340;&#20114;&#25805;&#20316;&#24615;&#12290;&#26412;&#33410;&#30340;&#21097;&#19979;&#37096;&#20998;&#23558;&#35752;&#35770;&#20854;&#23427;&#30340;&#36890;&#30693;&#31867;&#22411;&#65292;
            	&#23427;&#20204;&#23454;&#29616;&#20102;&#36890;&#29992;&#30340;AOP&#27010;&#24565;&#65292;&#20294;&#26159;&#20197;&#19968;&#31181;Spring&#39118;&#26684;&#30340;&#26041;&#24335;&#26469;&#23454;&#29616;&#30340;&#12290;&#20351;&#29992;&#26368;&#36890;&#29992;&#30340;&#36890;&#30693;&#31867;&#22411;&#36824;&#26377;&#19968;&#20010;&#22909;&#22788;&#65292;
            	&#22266;&#23450;&#20351;&#29992;MethodInterceptor&#29615;&#32469;&#36890;&#30693;&#21487;&#20197;&#35753;&#20320;&#22312;&#20854;&#23427;&#30340;AOP&#26694;&#26550;&#37324;&#36816;&#34892;&#20320;&#25152;&#23450;&#21046;&#30340;&#20999;&#38754;&#12290;
            	&#35201;&#27880;&#24847;&#29616;&#22312;&#20999;&#20837;&#28857;&#36824;&#19981;&#33021;&#21644;&#20854;&#23427;&#26694;&#26550;&#36827;&#34892;&#20114;&#25805;&#20316;&#65292;AOP&#32852;&#30431;&#30446;&#21069;&#36824;&#27809;&#26377;&#23450;&#20041;&#20999;&#20837;&#28857;&#25509;&#21475;&#12290;</p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-api-advice-before"></a>7.3.2.2.&nbsp;&#21069;&#32622;&#36890;&#30693;</h4></div></div><div></div></div><p>&#19968;&#20010;&#26356;&#31616;&#21333;&#30340;&#36890;&#30693;&#31867;&#22411;&#26159;<span class="bold"><b>&#21069;&#32622;&#36890;&#30693;</b></span>&#65288;before advice&#65289;&#12290;
            &#23427;&#19981;&#38656;&#35201;<tt class="literal">MethodInvocation</tt>&#23545;&#35937;&#65292;&#22240;&#20026;&#23427;&#21482;&#26159;&#22312;&#36827;&#20837;&#26041;&#27861;&#20043;&#21069;&#34987;&#35843;&#29992;&#12290;</p><p>&#21069;&#32622;&#36890;&#30693;&#30340;&#19968;&#20010;&#20027;&#35201;&#20248;&#28857;&#26159;&#23427;&#19981;&#38656;&#35201;&#35843;&#29992;<tt class="literal">proceed()</tt>&#26041;&#27861;&#65292;
            &#22240;&#27492;&#23601;&#19981;&#20250;&#21457;&#29983;&#26080;&#24847;&#38388;&#36816;&#34892;&#25318;&#25130;&#22120;&#38142;&#22833;&#36133;&#30340;&#24773;&#20917;&#12290;</p><p>&#19979;&#38754;&#26159;<tt class="literal">MethodBeforeAdvice</tt> &#25509;&#21475;&#12290;
            &#65288;Spring&#30340;API&#35774;&#35745;&#33021;&#22815;&#20026;&#31867;&#20013;&#30340;&#25104;&#21592;&#21464;&#37327;&#25552;&#20379;&#21069;&#32622;&#36890;&#30693;&#65292;&#34429;&#28982;&#36890;&#24120;&#23545;&#35937;&#20250;&#34987;&#24212;&#29992;&#20110;&#25104;&#21592;&#21464;&#37327;&#25318;&#25130;&#20043;&#19978;&#65292;&#20294;&#30475;&#36215;&#26469;Spring&#24182;&#19981;&#25171;&#31639;&#23454;&#29616;&#36825;&#20010;&#21151;&#33021;&#12290;&#65289;
            </p><pre class="programlisting">public interface MethodBeforeAdvice extends BeforeAdvice {
                
                void before(Method m, Object[] args, Object target) throws Throwable;
            }</pre><p>&#27880;&#24847;&#36820;&#22238;&#20540;&#30340;&#31867;&#22411;&#26159;<tt class="literal">void</tt>&#12290;&#21069;&#32622;&#36890;&#30693;&#21487;&#20197;&#22312;&#36830;&#25509;&#28857;&#25191;&#34892;&#20043;&#21069;&#25554;&#20837;&#33258;&#23450;&#20041;&#34892;&#20026;&#65292;&#20294;&#26159;&#19981;&#33021;&#20462;&#25913;&#36830;&#25509;&#28857;&#30340;&#36820;&#22238;&#20540;&#12290;
            &#22914;&#26524;&#19968;&#20010;&#21069;&#32622;&#36890;&#30693;&#25243;&#20986;&#24322;&#24120;&#65292;&#36825;&#23558;&#20013;&#27490;&#25318;&#25130;&#22120;&#38142;&#30340;&#36827;&#19968;&#27493;&#25191;&#34892;&#12290;&#24322;&#24120;&#23558;&#27839;&#30528;&#25318;&#25130;&#22120;&#38142;&#21521;&#22238;&#20256;&#25773;&#12290;
            &#22914;&#26524;&#24322;&#24120;&#26159;&#38750;&#24378;&#21046;&#26816;&#26597;&#30340;&#65288;unchecked&#65289;&#25110;&#32773;&#24050;&#32463;&#34987;&#21253;&#21547;&#22312;&#34987;&#35843;&#29992;&#26041;&#27861;&#30340;throws&#22768;&#26126;&#20013;&#65292;&#23427;&#23558;&#34987;&#30452;&#25509;&#36820;&#22238;&#32473;&#23458;&#25143;&#31471;&#65307;
            &#21542;&#21017;&#23427;&#23558;&#30001;AOP&#20195;&#29702;&#21253;&#35013;&#22312;&#19968;&#20010;&#38750;&#24378;&#21046;&#26816;&#26597;&#24322;&#24120;&#20013;&#36820;&#22238;&#12290;</p><p>&#36825;&#26159;&#19968;&#20010;Spring&#21069;&#32622;&#36890;&#30693;&#30340;&#20363;&#23376;&#65292;&#23427;&#35745;&#31639;&#25152;&#26377;&#26041;&#27861;&#34987;&#35843;&#29992;&#30340;&#27425;&#25968;&#65306;</p><pre class="programlisting">public class CountingBeforeAdvice implements MethodBeforeAdvice {
                
                private int count;
                
                public void before(Method m, Object[] args, Object target) throws Throwable {
                ++count;
                }
                
                public int getCount() { 
                return count; 
                }
            }</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="http://shouce.jb51.net/images/admons/tip.png"></td><th align="left">Tip</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#21069;&#32622;&#36890;&#30693;&#21487;&#20197;&#21644;&#20219;&#20309;&#20999;&#20837;&#28857;&#19968;&#36215;&#20351;&#29992;&#12290;</p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-api-advice-throws"></a>7.3.2.3.&nbsp;&#24322;&#24120;&#36890;&#30693;</h4></div></div><div></div></div><p>&#22914;&#26524;&#36830;&#25509;&#28857;&#25243;&#20986;&#24322;&#24120;&#65292;<span class="bold"><b>&#24322;&#24120;&#36890;&#30693;&#65288;throws advice&#65289;</b></span>&#23558;&#22312;&#36830;&#25509;&#28857;&#36820;&#22238;&#21518;&#34987;&#35843;&#29992;&#12290;
                Spring&#25552;&#20379;&#31867;&#22411;&#26816;&#26597;&#30340;&#24322;&#24120;&#36890;&#30693;&#65288;typed throws advice&#65289;&#65292;&#36825;&#24847;&#21619;&#30528;<tt class="literal">org.springframework.aop.ThrowsAdvice</tt>&#25509;&#21475;&#19981;&#21253;&#21547;&#20219;&#20309;&#26041;&#27861;&#65306;
                &#23427;&#21482;&#26159;&#19968;&#20010;&#26631;&#35760;&#25509;&#21475;&#29992;&#26469;&#26631;&#35782;&#25152;&#32473;&#23545;&#35937;&#23454;&#29616;&#20102;&#19968;&#20010;&#25110;&#32773;&#22810;&#20010;&#38024;&#23545;&#29305;&#23450;&#31867;&#22411;&#30340;&#24322;&#24120;&#36890;&#30693;&#26041;&#27861;&#12290;&#36825;&#20123;&#26041;&#27861;&#24212;&#24403;&#28385;&#36275;&#19979;&#38754;&#30340;&#26684;&#24335;: </p><pre class="programlisting">afterThrowing([Method, args, target], subclassOfThrowable) </pre><p>&#21482;&#26377;&#26368;&#21518;&#19968;&#20010;&#21442;&#25968;&#26159;&#24517;&#39035;&#30340;&#12290;&#26681;&#25454;&#24322;&#24120;&#36890;&#30693;&#26041;&#27861;&#23545;&#26041;&#27861;&#21450;&#21442;&#25968;&#30340;&#38656;&#27714;&#65292;&#26041;&#27861;&#30340;&#31614;&#21517;&#21487;&#20197;&#26377;&#19968;&#20010;&#25110;&#32773;&#22235;&#20010;&#21442;&#25968;&#12290;
            &#19979;&#38754;&#26159;&#19968;&#20123;&#24322;&#24120;&#36890;&#30693;&#30340;&#20363;&#23376;&#12290;</p><p>&#24403;&#19968;&#20010;<tt class="literal">RemoteException</tt>&#65288;&#21253;&#25324;&#23427;&#30340;&#23376;&#31867;&#65289;&#34987;&#25243;&#20986;&#26102;&#65292;&#19979;&#38754;&#30340;&#36890;&#30693;&#20250;&#34987;&#35843;&#29992;&#65306;</p><pre class="programlisting">public class RemoteThrowsAdvice implements ThrowsAdvice {

    public void afterThrowing(RemoteException ex) throws Throwable {
                <i class="lineannotation"><span class="lineannotation">// Do something with remote exception</span></i>
    }
            }</pre><p>&#24403;&#19968;&#20010;<span class="emphasis"><em>ServletException</em></span>&#34987;&#25243;&#20986;&#65292;&#19979;&#38754;&#30340;&#36890;&#30693;&#23558;&#34987;&#35843;&#29992;&#12290;
            &#21644;&#19978;&#38754;&#30340;&#36890;&#30693;&#19981;&#21516;&#65292;&#23427;&#22768;&#26126;&#20102;4&#20010;&#21442;&#25968;&#65292;&#22240;&#27492;&#23427;&#21487;&#20197;&#35775;&#38382;&#34987;&#35843;&#29992;&#30340;&#26041;&#27861;&#65292;&#26041;&#27861;&#30340;&#21442;&#25968;&#20197;&#21450;&#30446;&#26631;&#23545;&#35937;&#65306;</p><pre class="programlisting">public class ServletThrowsAdviceWithArguments implements ThrowsAdvice {

    public void afterThrowing(Method m, Object[] args, Object target, ServletException ex) {
                <i class="lineannotation"><span class="lineannotation">// Do something with all arguments</span></i>
    }
            }</pre><p>&#26368;&#21518;&#19968;&#20010;&#20363;&#23376;&#35828;&#26126;&#24590;&#26679;&#22312;&#21516;&#19968;&#20010;&#31867;&#37324;&#20351;&#29992;&#20004;&#20010;&#26041;&#27861;&#26469;&#22788;&#29702;
            <tt class="literal">RemoteException</tt>&#21644;<tt class="literal">ServletException</tt>&#12290;&#21487;&#20197;&#22312;&#19968;&#20010;&#31867;&#37324;&#32452;&#21512;&#20219;&#24847;&#25968;&#37327;&#30340;&#24322;&#24120;&#36890;&#30693;&#26041;&#27861;&#12290;</p><pre class="programlisting">public static class CombinedThrowsAdvice implements ThrowsAdvice {
                
                public void afterThrowing(RemoteException ex) throws Throwable {
                // Do something with remote exception
                }
                
                public void afterThrowing(Method m, Object[] args, Object target, ServletException ex) {
                // Do something with all arguments
                }
            }</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="http://shouce.jb51.net/images/admons/tip.png"></td><th align="left">Tip</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#24322;&#24120;&#36890;&#30693;&#21487;&#20197;&#21644;&#20219;&#20309;&#20999;&#20837;&#28857;&#19968;&#36215;&#20351;&#29992;&#12290;</p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-api-advice-after-returning"></a>7.3.2.4.&nbsp;&#21518;&#32622;&#36890;&#30693;</h4></div></div><div></div></div><p>Spring&#20013;&#30340;&#21518;&#32622;&#36890;&#30693;&#65288;After Returning advice&#65289;&#24517;&#39035;&#23454;&#29616;
                <span class="emphasis"><em>org.springframework.aop.AfterReturningAdvice</em></span>
            &#25509;&#21475;&#65292;&#20687;&#19979;&#38754;&#26174;&#31034;&#30340;&#37027;&#26679;&#65306;</p><pre class="programlisting">public interface AfterReturningAdvice extends Advice {
                
                void afterReturning(Object returnValue, Method m, Object[] args, Object target) 
                throws Throwable;
            }</pre><p>&#21518;&#32622;&#36890;&#30693;&#21487;&#20197;&#35775;&#38382;&#36820;&#22238;&#20540;&#65288;&#20294;&#19981;&#33021;&#36827;&#34892;&#20462;&#25913;&#65289;&#65292;&#34987;&#35843;&#29992;&#26041;&#27861;&#65292;&#26041;&#27861;&#21442;&#25968;&#20197;&#21450;&#30446;&#26631;&#23545;&#35937;&#12290;</p><p>&#19979;&#38754;&#30340;&#21518;&#32622;&#36890;&#30693;&#35745;&#31639;&#25152;&#26377;&#36816;&#34892;&#25104;&#21151;&#65288;&#27809;&#26377;&#25243;&#20986;&#24322;&#24120;&#65289;&#30340;&#26041;&#27861;&#35843;&#29992;&#65306;</p><pre class="programlisting">public class CountingAfterReturningAdvice implements AfterReturningAdvice {
                
                private int count;
                
                public void afterReturning(Object returnValue, Method m, Object[] args, Object target)
                throws Throwable {
                ++count;
                }
                
                public int getCount() {
                return count;
                }
            }</pre><p>&#36825;&#20010;&#36890;&#30693;&#19981;&#25913;&#21464;&#25191;&#34892;&#36335;&#24452;&#12290;&#22914;&#26524;&#25243;&#20986;&#24322;&#24120;&#65292;&#23427;&#23558;&#27839;&#30528;&#25318;&#25130;&#22120;&#38142;&#34987;&#25243;&#20986;&#32780;&#19981;&#26159;&#36820;&#22238;&#34987;&#35843;&#29992;&#26041;&#27861;&#30340;&#25191;&#34892;&#32467;&#26524;&#12290;</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="http://shouce.jb51.net/images/admons/tip.png"></td><th align="left">Tip</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#21518;&#32622;&#36890;&#30693;&#21487;&#20197;&#21644;&#20219;&#20309;&#20999;&#20837;&#28857;&#19968;&#36215;&#20351;&#29992;&#12290;</p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-api-advice-introduction"></a>7.3.2.5.&nbsp;&#24341;&#20837;&#36890;&#30693;</h4></div></div><div></div></div><p>Spring &#25226;&#24341;&#20837;&#36890;&#30693;&#65288;introduction advice&#65289;&#20316;&#20026;&#19968;&#31181;&#29305;&#27530;&#30340;&#25318;&#25130;&#36890;&#30693;&#36827;&#34892;&#22788;&#29702;&#12290;</p><p>&#24341;&#20837;&#36890;&#30693;&#38656;&#35201;&#19968;&#20010;<tt class="literal">IntroductionAdvisor</tt>,
            &#21644;&#19968;&#20010;<tt class="literal">IntroductionInterceptor</tt>, &#21518;&#32773;&#23454;&#29616;&#19979;&#38754;&#30340;&#25509;&#21475;&#65306;</p><pre class="programlisting">public interface IntroductionInterceptor extends MethodInterceptor {
                
                boolean implementsInterface(Class intf);
            }</pre><p>&#32487;&#25215;&#33258;AOP&#32852;&#30431;<tt class="literal">MethodInterceptor</tt> &#25509;&#21475;&#30340;<tt class="literal">invoke() </tt>&#26041;&#27861;&#65292;&#24517;&#39035;&#30830;&#20445;&#23454;&#29616;&#24341;&#20837;&#65306;
            &#20063;&#23601;&#26159;&#35828;&#65292;&#22914;&#26524;&#34987;&#35843;&#29992;&#30340;&#26041;&#27861;&#20301;&#20110;&#19968;&#20010;&#24050;&#32463;&#34987;&#24341;&#20837;&#25509;&#21475;&#37324;&#65292;&#36825;&#20010;&#24341;&#20837;&#25318;&#25130;&#22120;&#23558;&#36127;&#36131;&#23436;&#25104;&#23545;&#36825;&#20010;&#26041;&#27861;&#30340;&#35843;&#29992;--&#22240;&#20026;&#23427;&#19981;&#33021;&#35843;&#29992;<tt class="literal">proceed()</tt>&#26041;&#27861;&#12290;</p><p>&#24341;&#20837;&#36890;&#30693;&#19981;&#33021;&#21644;&#20219;&#20309;&#20999;&#20837;&#28857;&#19968;&#36215;&#20351;&#29992;&#65292;&#22240;&#20026;&#23427;&#26159;&#24212;&#29992;&#22312;&#31867;&#32423;&#21035;&#32780;&#19981;&#26159;&#26041;&#27861;&#32423;&#21035;&#12290;
                &#20320;&#21482;&#33021;&#36890;&#36807;<tt class="literal">IntroductionAdvisor</tt>&#26469;&#20351;&#29992;&#24341;&#20837;&#36890;&#30693;&#65292;&#36825;&#20010;&#25509;&#21475;&#21253;&#25324;&#19979;&#38754;&#30340;&#26041;&#27861;&#65306;
            </p><pre class="programlisting">public interface IntroductionAdvisor extends Advisor, IntroductionInfo {
                
                ClassFilter getClassFilter();
                
                void validateInterfaces() throws IllegalArgumentException;
                }
                
                public interface IntroductionInfo {
                
                Class[] getInterfaces();
            }</pre><p>&#36825;&#37324;&#27809;&#26377;<tt class="interfacename">MethodMatcher</tt>&#25509;&#21475;&#65292;&#22240;&#27492;&#20063;&#23601;&#27809;&#26377;
            <tt class="interfacename">Pointcut</tt>&#19982;&#24341;&#20837;&#36890;&#30693;&#30456;&#20851;&#32852;&#12290;&#36825;&#37324;&#21482;&#36827;&#34892;&#31867;&#36807;&#28388;&#12290;</p><p><tt class="literal">getInterfaces()</tt>&#26041;&#27861;&#36820;&#22238;&#36825;&#20010;&#36890;&#30693;&#22120;&#25152;&#24341;&#20837;&#30340;&#25509;&#21475;&#12290;</p><p><tt class="literal">validateInterfaces()</tt>&#26041;&#27861;&#23558;&#34987;&#20869;&#37096;&#20351;&#29992;&#26469;&#26597;&#30475;&#34987;&#24341;&#20837;&#30340;&#25509;&#21475;&#26159;&#21542;&#33021;&#22815;&#30001;&#37197;&#32622;&#30340;<tt class="literal">IntroductionInterceptor</tt>&#26469;&#23454;&#29616;&#12290;</p><p>&#35753;&#25105;&#20204;&#30475;&#30475;&#20174;Spring&#27979;&#35797;&#38598;&#37324;&#25343;&#26469;&#30340;&#19968;&#20010;&#31616;&#21333;&#20363;&#23376;&#12290;&#35753;&#25105;&#20204;&#20551;&#35774;&#25105;&#20204;&#24076;&#26395;&#25226;&#19979;&#38754;&#30340;&#25509;&#21475;&#24341;&#20837;&#32473;&#19968;&#20010;&#25110;&#32773;&#22810;&#20010;&#23545;&#35937;&#65306;</p><p>
                </p><pre class="programlisting">public interface Lockable {
                    void lock();
                    void unlock();
                    boolean locked();
                }</pre><p>
            </p><p>&#36825;&#37324;&#25551;&#36848;&#20102;&#19968;&#20010;<span class="bold"><b>&#28151;&#21512;&#31867;&#22411;</b></span>&#65288;mixin&#65289;&#12290;&#25105;&#20204;&#24076;&#26395;&#19981;&#35770;&#21407;&#26412;&#23545;&#35937;&#26159;&#20160;&#20040;&#31867;&#22411;&#65292;&#37117;&#25226;&#36825;&#20010;&#34987;&#36890;&#30693;&#23545;&#35937;&#36716;&#25442;&#20026;Lockable&#25509;&#21475;&#24182;&#21487;&#20197;&#35843;&#29992;lock&#21644;unlock &#26041;&#27861;&#12290;
                &#22914;&#26524;&#25105;&#20204;&#35843;&#29992;lock() &#26041;&#27861;&#65292;&#25105;&#20204;&#24076;&#26395;&#25152;&#26377;&#30340;setter &#26041;&#27861;&#25243;&#20986;&#19968;&#20010;<tt class="literal">LockedException</tt>&#24322;&#24120;&#12290;
            &#36825;&#26679;&#25105;&#20204;&#23601;&#21487;&#20197;&#21152;&#20837;&#19968;&#20010;&#26041;&#38754;&#26469;&#30830;&#20445;&#23545;&#35937;&#22312;&#24471;&#21040;&#36890;&#30693;&#20043;&#21069;&#26159;&#19981;&#21487;&#20462;&#25913;&#30340;&#65306;&#19968;&#20010;&#20851;&#20110;AOP&#30340;&#22909;&#20363;&#23376;&#12290;</p><p>&#39318;&#20808;&#65292;&#25105;&#20204;&#38656;&#35201;&#19968;&#20010;<tt class="literal">IntroductionInterceptor</tt>&#26469;&#20570;&#20123;&#31895;&#27963;&#12290;&#36825;&#37324;&#65292;&#25105;&#20204;&#25193;&#23637;&#20102;
                <tt class="literal">org.springframework.aop.support.DelegatingIntroductionInterceptor</tt>&#36825;&#20010;&#26041;&#20415;&#30340;&#31867;&#12290;
                &#25105;&#20204;&#33021;&#22815;&#30452;&#25509;&#23454;&#29616;IntroductionInterceptor&#25509;&#21475;&#65292;
                &#20294;&#22312;&#36825;&#20010;&#20363;&#23376;&#37324;&#20351;&#29992;<tt class="literal">DelegatingIntroductionInterceptor</tt>&#26159;&#26368;&#22909;&#30340;&#36873;&#25321;&#12290;
            </p><p>
                <tt class="literal">DelegatingIntroductionInterceptor</tt>&#35774;&#35745;&#20026;&#25226;&#19968;&#20010;&#24341;&#20837;&#25176;&#31649;&#32473;&#19968;&#20010;&#23454;&#29616;&#36825;&#20010;&#25509;&#21475;&#30340;&#31867;&#65292;
                &#36825;&#36890;&#36807;&#38544;&#34255;&#25318;&#25130;&#30340;&#20351;&#29992;&#26469;&#23454;&#29616;&#12290;&#25176;&#31649;&#21487;&#20197;&#34987;&#35774;&#32622;&#21040;&#20219;&#20309;&#20855;&#26377;&#26500;&#36896;&#22120;&#26041;&#27861;&#30340;&#31867;&#65307;&#36825;&#37324;&#20351;&#29992;&#32570;&#30465;&#25176;&#31649;(&#21363;&#20351;&#29992;&#26080;&#21442;&#26500;&#36896;&#22120;)&#12290;
                &#22240;&#27492;&#22312;&#19979;&#38754;&#36825;&#20010;&#20363;&#23376;&#37324;&#65292;&#25176;&#31649;&#32773;&#23558;&#26159;<tt class="literal">DelegatingIntroductionInterceptor</tt>&#30340;&#23376;&#31867;
                <tt class="literal">LockMixin</tt>&#12290;
                &#24403;&#19968;&#20010;&#25176;&#31649;&#23454;&#29616;&#34987;&#25552;&#20379;&#65292;<tt class="literal">DelegatingIntroductionInterceptor</tt>&#23454;&#20363;&#23558;&#26597;&#25214;&#25176;&#31649;&#25152;&#23454;&#29616;&#30340;&#25152;&#26377;&#25509;&#21475;
                &#65288;&#38500;&#20102;IntroductionInterceptor&#20043;&#22806;&#65289;&#65292;&#24182;&#20026;&#36825;&#20123;&#25509;&#21475;&#30340;&#20171;&#32461;&#25552;&#20379;&#25903;&#25345;&#12290;&#23376;&#31867;&#20363;&#22914;<tt class="literal">LockMixin</tt>
                &#21487;&#20197;&#35843;&#29992;<tt class="literal">suppressInterface(Class intf) </tt>&#26041;&#27861;&#26469;&#31105;&#27490;&#37027;&#20123;&#19981;&#24212;&#35813;&#34987;&#26292;&#38706;&#30340;&#25509;&#21475;&#12290;
                &#28982;&#32780;&#65292;&#19981;&#35770;<tt class="literal">IntroductionInterceptor</tt>&#25903;&#25345;&#22810;&#23569;&#25509;&#21475;&#65292;
                <tt class="literal">IntroductionAdvisor</tt>&#30340;&#20351;&#29992;&#23558;&#25511;&#21046;&#21738;&#20123;&#25509;&#21475;&#30495;&#27491;&#34987;&#26292;&#38706;&#12290;
                &#19968;&#20010;&#34987;&#24341;&#20837;&#30340;&#25509;&#21475;&#23558;&#35206;&#30422;&#30446;&#26631;&#23545;&#35937;&#23454;&#29616;&#30340;&#30456;&#21516;&#25509;&#21475;&#12290;
            </p><p>&#36825;&#26679;LockMixin&#23601;&#32487;&#25215;&#20102;<tt class="literal">DelegatingIntroductionInterceptor</tt>&#24182;&#23454;&#29616;&#20102;Lockable&#25509;&#21475;&#12290;
            &#36825;&#37324;&#29238;&#31867;&#20250;&#33258;&#21160;&#36873;&#25321;Lockable&#25509;&#21475;&#24182;&#25552;&#20379;&#24341;&#20837;&#25903;&#25345;&#65292;&#22240;&#27492;&#25105;&#20204;&#19981;&#38656;&#35201;&#37197;&#32622;&#23427;&#12290;&#29992;&#36825;&#31181;&#26041;&#27861;&#25105;&#20204;&#33021;&#22815;&#24341;&#20837;&#20219;&#24847;&#25968;&#37327;&#30340;&#25509;&#21475;&#12290;
            </p><p>&#27880;&#24847;<tt class="literal">locked</tt>&#23454;&#20363;&#21464;&#37327;&#30340;&#29992;&#27861;&#12290;&#36825;&#26377;&#25928;&#22320;&#21521;&#30446;&#26631;&#23545;&#35937;&#22686;&#21152;&#20102;&#39069;&#22806;&#29366;&#24577;&#12290;</p><p>
                </p><pre class="programlisting">public class LockMixin extends DelegatingIntroductionInterceptor 
                    implements Lockable {
                    
                    private boolean locked;
                    
                    public void lock() {
                    this.locked = true;
                    }
                    
                    public void unlock() {
                    this.locked = false;
                    }
                    
                    public boolean locked() {
                    return this.locked;
                    }
                    
                    public Object invoke(MethodInvocation invocation) throws Throwable {
                    if (locked() &amp;&amp; invocation.getMethod().getName().indexOf("set") == 0)
                    throw new LockedException();
                    return super.invoke(invocation);
                    }
                    
                }</pre><p>
            </p><p>&#35206;&#30422;<tt class="literal">invoke()</tt>&#26041;&#27861;&#36890;&#24120;&#26159;&#19981;&#24517;&#35201;&#30340;&#65306;<tt class="literal">DelegatingIntroductionInterceptor</tt>&#23601;&#24050;&#32463;&#22815;&#29992;&#20102;&#65288;&#22914;&#26524;&#19968;&#20010;&#26041;&#27861;&#34987;&#24341;&#20837;&#65292;&#36825;&#20010;&#23454;&#29616;&#23558;&#35843;&#29992;&#23454;&#38469;&#30340;&#25176;&#31649;&#26041;&#27861;&#65292;&#21542;&#21017;&#23427;&#23558;&#30452;&#25509;&#22788;&#29702;&#36830;&#25509;&#28857;&#65289;&#12290;&#22312;&#24403;&#21069;&#36825;&#20010;&#20363;&#23376;&#37324;&#65292;&#25105;&#20204;&#38656;&#35201;&#22686;&#21152;&#19968;&#20010;&#26816;&#26597;&#65306;&#22914;&#26524;&#22788;&#20110;&#21152;&#38145;&#65288;locked&#65289;&#29366;&#24577;&#65292;&#27809;&#26377;setter&#26041;&#27861;&#21487;&#20197;&#34987;&#35843;&#29992;&#12290;
            </p><p>&#24341;&#20837;&#36890;&#30693;&#22120;&#30340;&#35201;&#27714;&#26159;&#24456;&#31616;&#21333;&#30340;&#12290;&#23427;&#30340;&#20840;&#37096;&#35201;&#27714;&#21482;&#26159;&#20445;&#25345;&#19968;&#20010;&#29305;&#23450;&#30340;<tt class="literal">LockMixin</tt>&#23454;&#20363;&#65292;
                &#24182;&#35828;&#26126;&#34987;&#36890;&#30693;&#30340;&#25509;&#21475; - &#22312;&#36825;&#20010;&#20363;&#23376;&#37324;&#65292;&#21482;&#26377;&#19968;&#20010;<tt class="literal">Lockable</tt>&#25509;&#21475;&#12290;
                &#26356;&#22797;&#26434;&#30340;&#20363;&#23376;&#20013;&#20063;&#35768;&#20250;&#24341;&#29992;&#19968;&#20010;&#24341;&#20837;&#25318;&#25130;&#22120;&#30340;&#65288;&#21487;&#20197;&#34987;&#23450;&#20041;&#20026;&#19968;&#20010;&#21407;&#22411;&#65289;&#65306;
                &#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#19981;&#38656;&#35201;&#23545;<tt class="literal">LockMixin</tt>&#36827;&#34892;&#30456;&#20851;&#37197;&#32622;&#65292;
                &#22240;&#27492;&#25105;&#20204;&#21487;&#20197;&#31616;&#21333;&#30340;&#29992;<tt class="literal">new</tt>&#20851;&#38190;&#23383;&#26469;&#21019;&#24314;&#23427;&#12290;
            </p><p>
                </p><pre class="programlisting">public class LockMixinAdvisor extends DefaultIntroductionAdvisor {
                    
                    public LockMixinAdvisor() {
                    super(new LockMixin(), Lockable.class);
                    }
                }</pre><p>
            </p><p>&#25105;&#20204;&#21487;&#20197;&#24456;&#23481;&#26131;&#24212;&#29992;&#36825;&#20010;&#36890;&#30693;&#22120;&#65306;&#23427;&#19981;&#38656;&#35201;&#37197;&#32622;&#12290;
                &#65288;&#28982;&#32780;&#65292;&#19979;&#38754;<span class="emphasis"><em>&#26159;</em></span>&#24517;&#39035;&#35760;&#20303;&#30340;&#65306;&#19981;&#21487;&#20197;&#22312;&#27809;&#26377;<span class="emphasis"><em>IntroductionAdvisor</em></span>&#30340;&#24773;&#20917;&#19979;&#20351;&#29992;<tt class="literal">IntroductionInterceptor</tt>&#12290;&#65289;
                &#36890;&#24120;&#30340;&#24341;&#20837;&#36890;&#30693;&#22120;&#24517;&#39035;&#26159;&#22522;&#20110;&#23454;&#20363;&#30340;&#65292;&#22240;&#20026;&#23427;&#26159;&#26377;&#29366;&#24577;&#30340;&#12290;&#22240;&#27492;&#65292;&#23545;&#20110;&#27599;&#20010;&#34987;&#36890;&#30693;&#23545;&#35937;&#25105;&#20204;&#38656;&#35201;&#19968;&#20010;&#19981;&#21516;
                &#23454;&#20363;&#30340;<tt class="literal">LockMixinAdvisor</tt>&#21644;<tt class="literal">LockMixin</tt>&#12290;
                &#36825;&#31181;&#24773;&#20917;&#19979;&#36890;&#30693;&#22120;&#20445;&#23384;&#20102;&#34987;&#36890;&#30693;&#23545;&#35937;&#30340;&#37096;&#20998;&#29366;&#24577;&#12290;
            </p><p>
                &#25105;&#20204;&#33021;&#22815;&#36890;&#36807;&#20351;&#29992;<tt class="literal">Advised.addAdvisor() </tt>&#30340;&#32534;&#31243;&#26041;&#24335;&#26469;&#24212;&#29992;&#36890;&#30693;&#22120;&#65292;&#25110;&#32773;&#20687;&#20854;&#23427;&#36890;&#30693;&#22120;&#37027;&#26679;&#65288;&#20063;&#26159;&#25512;&#33616;&#30340;&#26041;&#24335;&#65289;&#22312;XML&#37324;&#36827;&#34892;&#37197;&#32622;&#12290;&#20840;&#37096;&#30340;&#20195;&#29702;&#21019;&#24314;&#36873;&#25321;&#65288;&#21253;&#25324;&#8220;&#33258;&#21160;&#20195;&#29702;&#21019;&#24314;&#22120;&#8221;&#65289;&#23558;&#22312;&#19979;&#38754;&#36827;&#34892;&#35752;&#35770;&#65292;
                &#30475;&#30475;&#22914;&#20309;&#27491;&#30830;&#22320;&#22788;&#29702;&#24341;&#20837;&#21644;&#26377;&#29366;&#24577;&#28151;&#21512;&#31867;&#22411;&#12290;
            </p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-api-advisor"></a>7.4.&nbsp;Spring&#37324;&#30340;Advisor API</h2></div></div><div></div></div><p>&#22312;Spring&#37324;&#65292;&#19968;&#20010;Advisor&#26159;&#19968;&#20010;&#20165;&#20165;&#21253;&#21547;&#19968;&#20010;&#36890;&#30693;&#23545;&#35937;&#21644;&#19982;&#20043;&#20851;&#32852;&#30340;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#30340;&#20999;&#38754;&#12290;</p><p>&#38500;&#20102;&#24341;&#20837;&#36825;&#31181;&#29305;&#27530;&#24418;&#24335;&#65292;&#20219;&#20309;&#36890;&#30693;&#22120;&#65288;advisor&#65289;&#37117;&#21487;&#20197;&#21644;&#20219;&#20309;&#36890;&#30693;&#19968;&#36215;&#24037;&#20316;&#12290;
        <tt class="literal">org.springframework.aop.support.DefaultPointcutAdvisor</tt>&#26159;&#26368;&#24120;&#29992;&#30340;&#36890;&#30693;&#22120;&#31867;&#12290;&#20363;&#22914;&#65292;&#23427;&#21487;&#20197;&#21644;
        <tt class="literal">MethodInterceptor</tt>&#65292;<tt class="literal">BeforeAdvice</tt>&#25110;&#32773;
    <tt class="literal">ThrowsAdvice</tt>&#19968;&#36215;&#20351;&#29992;&#12290;</p><p>&#22312;Spring&#37324;&#26377;&#21487;&#33021;&#22312;&#21516;&#19968;&#20010;AOP&#20195;&#29702;&#37324;&#28151;&#21512;&#36890;&#30693;&#22120;&#21644;&#36890;&#30693;&#31867;&#22411;&#12290;
    &#20363;&#22914;&#65292;&#20320;&#21487;&#20197;&#22312;&#19968;&#20010;&#20195;&#29702;&#37197;&#32622;&#37324;&#20351;&#29992;&#19968;&#20010;&#25318;&#25130;&#29615;&#32469;&#36890;&#30693;&#65292;&#19968;&#20010;&#24322;&#24120;&#36890;&#30693;&#21644;&#19968;&#20010;&#21069;&#32622;&#36890;&#30693;&#65306;Spring&#23558;&#36127;&#36131;&#33258;&#21160;&#21019;&#24314;&#25152;&#38656;&#30340;&#25318;&#25130;&#22120;&#38142;&#12290;
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-pfb"></a>7.5.&nbsp;&#20351;&#29992;ProxyFactoryBean&#21019;&#24314;AOP&#20195;&#29702;</h2></div></div><div></div></div><p>&#22914;&#26524;&#20320;&#27491;&#22312;&#20351;&#29992;Spring IoC&#23481;&#22120;&#65288;&#21363;ApplicationContext&#25110;BeanFactory&#65289;&#26469;&#31649;&#29702;&#20320;&#30340;&#19994;&#21153;&#23545;&#35937;--&#36825;&#27491;&#26159;&#20320;&#24212;&#35813;&#20570;&#30340;--&#20320;&#20063;&#35768;&#20250;&#24819;&#35201;&#20351;&#29992;Spring&#20013;&#20851;&#20110;AOP&#30340;FactoryBean&#12290;
    &#65288;&#35760;&#20303;&#20351;&#29992;&#24037;&#21378;bean&#24341;&#20837;&#19968;&#20010;&#38388;&#25509;&#23618;&#20043;&#21518;&#65292;&#25105;&#20204;&#23601;&#21487;&#20197;&#21019;&#24314;&#19981;&#21516;&#31867;&#22411;&#30340;&#23545;&#35937;&#20102;&#65289;&#12290;</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>Spring 2.0&#30340;AOP&#25903;&#25345;&#20063;&#22312;&#24213;&#23618;&#20351;&#29992;&#24037;&#21378;bean&#12290;</p></td></tr></table></div><p>&#22312;Spring&#37324;&#21019;&#24314;&#19968;&#20010;AOP&#20195;&#29702;&#30340;&#22522;&#26412;&#26041;&#27861;&#26159;&#20351;&#29992;<span class="emphasis"><em>org.springframework.aop.framework.ProxyFactoryBean</em></span>&#12290;
    &#36825;&#20010;&#31867;&#23545;&#24212;&#29992;&#30340;&#20999;&#20837;&#28857;&#21644;&#36890;&#30693;&#25552;&#20379;&#20102;&#23436;&#25972;&#30340;&#25511;&#21046;&#33021;&#21147;&#65288;&#21253;&#25324;&#23427;&#20204;&#30340;&#24212;&#29992;&#39034;&#24207;&#65289;&#12290;&#28982;&#32780;&#22914;&#26524;&#20320;&#19981;&#38656;&#35201;&#36825;&#31181;&#25511;&#21046;&#65292;&#20320;&#20250;&#21916;&#27426;&#26356;&#31616;&#21333;&#30340;&#26041;&#24335;&#12290;</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-pfb-1"></a>7.5.1.&nbsp;&#22522;&#30784;</h3></div></div><div></div></div><p>&#20687;&#20854;&#23427;&#30340;<tt class="literal">FactoryBean</tt>&#23454;&#29616;&#19968;&#26679;&#65292;<tt class="literal">ProxyFactoryBean</tt>&#24341;&#20837;&#20102;&#19968;&#20010;&#38388;&#25509;&#23618;&#12290;&#22914;&#26524;&#20320;&#23450;&#20041;&#19968;&#20010;&#21517;&#20026;<tt class="literal">foo</tt>&#30340;<tt class="literal">ProxyFactoryBean</tt>&#65292;
            &#24341;&#29992;<tt class="literal">foo</tt>&#30340;&#23545;&#35937;&#30475;&#21040;&#30340;&#23558;&#19981;&#26159;<tt class="literal">ProxyFactoryBean</tt>&#23454;&#20363;&#26412;&#36523;&#65292;&#32780;&#26159;&#19968;&#20010;<tt class="literal">ProxyFactoryBean</tt>&#23454;&#29616;&#37324;<tt class="literal">getObject() </tt>&#26041;&#27861;&#25152;&#21019;&#24314;&#30340;&#23545;&#35937;&#12290;
        &#36825;&#20010;&#26041;&#27861;&#23558;&#21019;&#24314;&#19968;&#20010;AOP&#20195;&#29702;&#65292;&#23427;&#21253;&#35013;&#20102;&#19968;&#20010;&#30446;&#26631;&#23545;&#35937;&#12290;</p><p>&#20351;&#29992;<tt class="literal">ProxyFactoryBean</tt>&#25110;&#32773;&#20854;&#23427;IoC&#30456;&#20851;&#31867;&#24102;&#26469;&#30340;&#26368;&#37325;&#35201;&#30340;&#22909;&#22788;&#20043;&#19968;&#23601;&#26159;&#21019;&#24314;AOP&#20195;&#29702;&#65292;&#36825;&#24847;&#21619;&#30528;&#36890;&#30693;&#21644;&#20999;&#20837;&#28857;&#20063;&#21487;&#20197;&#30001;IoC&#26469;&#31649;&#29702;&#12290;&#36825;&#26159;&#19968;&#20010;&#24378;&#22823;&#30340;&#21151;&#33021;&#24182;&#20351;&#24471;&#26576;&#20123;&#29305;&#23450;&#30340;&#35299;&#20915;&#26041;&#26696;&#25104;&#20026;&#21487;&#33021;&#65292;
            &#32780;&#36825;&#20123;&#29992;&#20854;&#23427;AOP&#26694;&#26550;&#24456;&#38590;&#20570;&#21040;&#12290;&#20363;&#22914;&#65292;&#19968;&#20010;&#36890;&#30693;&#20063;&#35768;&#26412;&#36523;&#20063;&#35201;&#24341;&#29992;&#24212;&#29992;&#31243;&#24207;&#23545;&#35937;&#65288;&#19981;&#20165;&#20165;&#26159;&#20854;&#23427;AOP&#26694;&#26550;&#20013;&#20063;&#21487;&#20197;&#35775;&#38382;&#30340;&#30446;&#26631;&#23545;&#35937;&#65289;&#65292;&#36825;&#20196;&#20320;&#21487;&#20197;&#20174;&#20381;&#36182;&#27880;&#23556;&#30340;&#21487;&#25300;&#25554;&#29305;&#24615;&#20013;&#33719;&#30410;&#12290;
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-pfb-2"></a>7.5.2.&nbsp;JavaBean&#23646;&#24615;</h3></div></div><div></div></div><p>
            &#36890;&#24120;&#24773;&#20917;&#19979;Spring&#25552;&#20379;&#20102;&#22823;&#22810;&#25968;&#30340;<tt class="interfacename">FactoryBean</tt>&#23454;&#29616;&#65292;<tt class="classname">ProxyFactoryBean</tt>&#31867;&#26412;&#36523;&#20063;&#26159;&#19968;&#20010;JavaBean&#12290;&#23427;&#30340;&#23646;&#24615;&#34987;&#29992;&#26469;&#65306;
        </p><div class="itemizedlist"><ul type="disc"><li><p>&#25351;&#23450;&#20320;&#24076;&#26395;&#20195;&#29702;&#30340;&#30446;&#26631;&#23545;&#35937;</p></li><li><p>&#25351;&#23450;&#26159;&#21542;&#20351;&#29992;CGLIB&#65288;&#26597;&#30475;&#19979;&#38754;&#21483;&#20570;<a href="aop-api.html#aop-pfb-proxy-types" title="7.5.3.&nbsp;&#22522;&#20110;JDK&#21644;CGLIB&#30340;&#20195;&#29702;">Section&nbsp;7.5.3, &#8220;&#22522;&#20110;JDK&#21644;CGLIB&#30340;&#20195;&#29702;&#8221;</a>&#30340;&#23567;&#33410;&#65289;&#12290;</p></li></ul></div><p>
            &#19968;&#20123;&#20027;&#35201;&#23646;&#24615;&#20174;<tt class="classname">org.springframework.aop.framework.ProxyConfig</tt>&#37324;&#32487;&#25215;&#19979;&#26469;&#65288;&#36825;&#20010;&#31867;&#26159;Spring&#37324;&#25152;&#26377;AOP&#20195;&#29702;&#24037;&#21378;&#30340;&#29238;&#31867;&#65289;&#12290;&#36825;&#20123;&#20027;&#35201;&#23646;&#24615;&#21253;&#25324;&#65306;
        </p><div class="itemizedlist"><ul type="disc"><li><p>
                    <tt class="literal">proxyTargetClass</tt>&#65306;&#36825;&#20010;&#23646;&#24615;&#20026;<tt class="literal">true</tt>&#26102;&#65292;&#30446;&#26631;&#31867;&#26412;&#36523;&#34987;&#20195;&#29702;&#32780;&#19981;&#26159;&#30446;&#26631;&#31867;&#30340;&#25509;&#21475;&#12290;&#22914;&#26524;&#36825;&#20010;&#23646;&#24615;&#20540;&#34987;&#35774;&#20026;<tt class="literal">true</tt>&#65292;CGLIB&#20195;&#29702;&#23558;&#34987;&#21019;&#24314;&#65288;&#21487;&#20197;&#21442;&#30475;&#19979;&#38754;&#21517;&#20026;<a href="aop-api.html#aop-pfb-proxy-types" title="7.5.3.&nbsp;&#22522;&#20110;JDK&#21644;CGLIB&#30340;&#20195;&#29702;">Section&nbsp;7.5.3, &#8220;&#22522;&#20110;JDK&#21644;CGLIB&#30340;&#20195;&#29702;&#8221;</a>&#30340;&#31456;&#33410;&#65289;&#12290;
                </p></li><li><p>
                    <tt class="literal">optimize</tt>&#65306;&#29992;&#26469;&#25511;&#21046;<span class="emphasis"><em>&#36890;&#36807;CGLIB&#21019;&#24314;</em></span>&#30340;&#20195;&#29702;&#26159;&#21542;&#20351;&#29992;&#28608;&#36827;&#30340;&#20248;&#21270;&#31574;&#30053;&#12290;
                    &#38500;&#38750;&#23436;&#20840;&#20102;&#35299;AOP&#20195;&#29702;&#22914;&#20309;&#22788;&#29702;&#20248;&#21270;&#65292;&#21542;&#21017;&#19981;&#25512;&#33616;&#29992;&#25143;&#20351;&#29992;&#36825;&#20010;&#35774;&#32622;&#12290;&#30446;&#21069;&#36825;&#20010;&#23646;&#24615;&#20165;&#29992;&#20110;CGLIB&#20195;&#29702;&#65307;
                    &#23545;&#20110;JDK&#21160;&#24577;&#20195;&#29702;&#65288;&#32570;&#30465;&#20195;&#29702;&#65289;&#26080;&#25928;&#12290;
				</p></li><li><p>
					<tt class="literal">frozen</tt>&#65306;&#22914;&#26524;&#19968;&#20010;&#20195;&#29702;&#37197;&#32622;&#26159;<tt class="literal">frozen</tt>&#30340;&#65292;&#23601;&#19981;&#20801;&#35768;&#23545;&#35813;&#37197;&#32622;&#36827;&#34892;&#20462;&#25913;&#12290;
					&#36825;&#22312;&#31616;&#21333;&#20248;&#21270;&#21644;&#19981;&#24076;&#26395;&#35843;&#29992;&#32773;&#22312;&#20195;&#29702;&#21019;&#24314;&#21518;&#25805;&#20316;&#20195;&#29702;&#65288;&#36890;&#36807;<tt class="interfacename">Advised</tt>&#25509;&#21475;&#65289;
					&#26102;&#24456;&#26377;&#29992;&#12290;&#32570;&#30465;&#20540;&#20026;<tt class="literal">false</tt>&#65292;&#21363;&#21487;&#20197;&#36827;&#34892;&#31867;&#20284;&#28155;&#21152;&#38468;&#21152;&#36890;&#30693;&#30340;&#25805;&#20316;&#12290;
				</p></li><li><p>
                    <tt class="literal">exposeProxy</tt>&#65306;&#20915;&#23450;&#24403;&#21069;&#20195;&#29702;&#26159;&#21542;&#34987;&#26292;&#38706;&#22312;&#19968;&#20010;<tt class="classname">ThreadLocal</tt>
                    &#20013;&#20197;&#20415;&#34987;&#30446;&#26631;&#23545;&#35937;&#35775;&#38382;&#12290;&#22914;&#26524;&#30446;&#26631;&#23545;&#35937;&#38656;&#35201;&#33719;&#21462;&#20195;&#29702;&#32780;&#19988;<tt class="literal">exposeProxy</tt>&#23646;&#24615;&#34987;&#35774;&#20026;
                    <tt class="literal">true</tt>&#65292;&#30446;&#26631;&#23545;&#35937;&#21487;&#20197;&#20351;&#29992;<tt class="literal">AopContext.currentProxy()</tt>&#26041;&#27861;&#12290; 
                </p></li><li><p>
                    <tt class="literal">aopProxyFactory</tt>&#65306;&#20351;&#29992;<tt class="interfacename">AopProxyFactory</tt>&#30340;&#23454;&#29616;&#12290;&#36825;&#25552;&#20379;&#20102;&#19968;&#31181;&#26041;&#27861;&#26469;&#33258;&#23450;&#20041;&#26159;&#21542;&#20351;&#29992;&#21160;&#24577;&#20195;&#29702;&#65292;CGLIB&#25110;&#20854;&#23427;&#20195;&#29702;&#31574;&#30053;&#12290;
                    &#32570;&#30465;&#23454;&#29616;&#23558;&#26681;&#25454;&#24773;&#20917;&#36873;&#25321;&#21160;&#24577;&#20195;&#29702;&#25110;&#32773;CGLIB&#12290;&#19968;&#33324;&#24773;&#20917;&#19979;&#24212;&#35813;&#27809;&#26377;&#20351;&#29992;&#36825;&#20010;&#23646;&#24615;&#30340;&#38656;&#35201;&#65307;&#23427;&#26159;&#34987;&#35774;&#35745;&#26469;&#22312;Spring 1.1&#20013;&#28155;&#21152;&#26032;&#30340;&#20195;&#29702;&#31867;&#22411;&#30340;&#12290;
                </p></li></ul></div><p><tt class="classname">ProxyFactoryBean</tt>&#20013;&#38656;&#35201;&#35828;&#26126;&#30340;&#20854;&#23427;&#23646;&#24615;&#21253;&#25324;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>
                    <tt class="literal">proxyInterfaces</tt>&#65306;&#38656;&#35201;&#20195;&#29702;&#30340;&#25509;&#21475;&#21517;&#30340;&#23383;&#31526;&#20018;&#25968;&#32452;&#12290;
                    &#22914;&#26524;&#27809;&#26377;&#25552;&#20379;&#65292;&#23558;&#20026;&#30446;&#26631;&#31867;&#20351;&#29992;&#19968;&#20010;CGLIB&#20195;&#29702;&#65288;&#20063;&#21487;&#20197;&#26597;&#30475;&#19979;&#38754;&#21517;&#20026;<a href="aop-api.html#aop-pfb-proxy-types" title="7.5.3.&nbsp;&#22522;&#20110;JDK&#21644;CGLIB&#30340;&#20195;&#29702;">Section&nbsp;7.5.3, &#8220;&#22522;&#20110;JDK&#21644;CGLIB&#30340;&#20195;&#29702;&#8221;</a>&#30340;&#31456;&#33410;&#65289;&#12290; 
                </p></li><li><p>
                    <tt class="literal">interceptorNames</tt>&#65306;<tt class="interfacename">Advisor</tt>&#30340;&#23383;&#31526;&#20018;&#25968;&#32452;&#65292;&#21487;&#20197;&#21253;&#25324;&#25318;&#25130;&#22120;&#25110;&#20854;&#23427;&#36890;&#30693;&#30340;&#21517;&#23383;&#12290;
                    &#39034;&#24207;&#26159;&#24456;&#37325;&#35201;&#30340;&#65292;&#25490;&#22312;&#21069;&#38754;&#30340;&#23558;&#34987;&#20248;&#20808;&#26381;&#21153;&#12290;&#23601;&#26159;&#35828;&#21015;&#34920;&#37324;&#30340;&#31532;&#19968;&#20010;&#25318;&#25130;&#22120;&#23558;&#33021;&#22815;&#31532;&#19968;&#20010;&#25318;&#25130;&#35843;&#29992;&#12290;
                </p><p>
                    &#36825;&#37324;&#30340;&#21517;&#23383;&#26159;&#24403;&#21069;&#24037;&#21378;&#20013;bean&#30340;&#21517;&#23383;&#65292;&#21253;&#25324;&#29238;&#24037;&#21378;&#20013;bean&#30340;&#21517;&#23383;&#12290;&#36825;&#37324;&#20320;&#19981;&#33021;&#20351;&#29992;bean&#30340;&#24341;&#29992;&#22240;&#20026;&#36825;&#20250;&#23548;&#33268;<tt class="classname">ProxyFactoryBean</tt>&#24573;&#30053;&#36890;&#30693;&#30340;&#21333;&#20363;&#35774;&#32622;&#12290;
                </p><p>
                    &#20320;&#21487;&#20197;&#25226;&#19968;&#20010;&#25318;&#25130;&#22120;&#30340;&#21517;&#23383;&#21152;&#19978;&#19968;&#20010;&#26143;&#21495;&#20316;&#20026;&#21518;&#32512;&#65288;<tt class="literal">*</tt>&#65289;&#12290;&#36825;&#23558;&#23548;&#33268;&#36825;&#20010;&#24212;&#29992;&#31243;&#24207;&#37324;&#25152;&#26377;&#21517;&#23383;&#20197;&#26143;&#21495;&#20043;&#21069;&#37096;&#20998;&#24320;&#22836;&#30340;&#36890;&#30693;&#22120;&#37117;&#34987;&#24212;&#29992;&#12290;
                    &#20320;&#21487;&#20197;&#22312;<a href="aop-api.html#aop-global-advisors" title="7.5.6.&nbsp;&#20351;&#29992;&#8220;&#20840;&#23616;&#8221;&#36890;&#30693;&#22120;">Section&nbsp;7.5.6, &#8220;&#20351;&#29992;&#8220;&#20840;&#23616;&#8221;&#36890;&#30693;&#22120;&#8221;</a> &#21457;&#29616;&#19968;&#20010;&#20351;&#29992;&#36825;&#20010;&#29305;&#24615;&#30340;&#20363;&#23376;&#12290;
                </p></li><li><p>
                    &#21333;&#20363;&#65306;&#24037;&#21378;&#26159;&#21542;&#24212;&#35813;&#36820;&#22238;&#21516;&#19968;&#20010;&#23545;&#35937;&#65292;&#19981;&#35770;&#26041;&#27861;<tt class="literal">getObject()</tt>&#34987;&#35843;&#29992;&#30340;&#22810;&#39057;&#32321;&#12290;
                    &#22810;&#20010;<tt class="interfacename">FactoryBean</tt>&#23454;&#29616;&#37117;&#25552;&#20379;&#20102;&#36825;&#20010;&#26041;&#27861;&#12290;&#32570;&#30465;&#20540;&#26159;<tt class="literal">true</tt>&#12290;
                    &#22914;&#26524;&#20320;&#24076;&#26395;&#20351;&#29992;&#26377;&#29366;&#24577;&#30340;&#36890;&#30693;--&#20363;&#22914;&#65292;&#26377;&#29366;&#24577;&#30340;mixin--&#21487;&#20197;&#25226;&#21333;&#20363;&#23646;&#24615;&#30340;&#20540;&#35774;&#32622;&#20026;<tt class="literal">false</tt>&#26469;&#20351;&#29992;&#21407;&#22411;&#36890;&#30693;&#12290;
                </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-pfb-proxy-types"></a>7.5.3.&nbsp;&#22522;&#20110;JDK&#21644;CGLIB&#30340;&#20195;&#29702;</h3></div></div><div></div></div><p>
            &#36825;&#20010;&#23567;&#33410;&#20316;&#20026;&#35828;&#26126;&#24615;&#25991;&#26723;&#65292;&#35299;&#37322;&#20102;&#23545;&#20110;&#19968;&#20010;&#30446;&#26631;&#23545;&#35937;&#65288;&#38656;&#35201;&#34987;&#20195;&#29702;&#30340;&#23545;&#35937;&#65289;&#65292;<tt class="classname">ProxyFactryBean</tt>&#26159;&#22914;&#20309;&#20915;&#23450;&#31350;&#31455;&#21019;&#24314;&#19968;&#20010;&#22522;&#20110;JDK&#36824;&#26159;CGLIB&#30340;&#20195;&#29702;&#30340;&#12290;
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
                <tt class="classname">ProxyFactoryBean</tt>&#38656;&#35201;&#21019;&#24314;&#22522;&#20110;JDK&#36824;&#26159;CGLIB&#20195;&#29702;&#30340;&#20855;&#20307;&#34892;&#20026;&#22312;&#29256;&#26412;1.2.x&#21644;2.0&#20013;&#26377;&#25152;&#19981;&#21516;&#12290;
                &#29616;&#22312;<tt class="classname">ProxyFactoryBean</tt>&#22312;&#20851;&#20110;&#33258;&#21160;&#26816;&#27979;&#25509;&#21475;&#26041;&#38754;&#20351;&#29992;&#20102;&#19982;<tt class="classname">TransactionProxyFactoryBean</tt>&#30456;&#20284;&#30340;&#35821;&#20041;&#12290;	
            </p></td></tr></table></div><p>
            &#22914;&#26524;&#19968;&#20010;&#38656;&#35201;&#34987;&#20195;&#29702;&#30340;&#30446;&#26631;&#23545;&#35937;&#30340;&#31867;&#65288;&#21518;&#38754;&#23558;&#31616;&#21333;&#22320;&#31216;&#23427;&#20026;&#30446;&#26631;&#31867;&#65289;&#27809;&#26377;&#23454;&#29616;&#20219;&#20309;&#25509;&#21475;&#65292;&#37027;&#20040;&#19968;&#20010;&#22522;&#20110;CGLIB&#30340;&#20195;&#29702;&#23558;&#34987;&#21019;&#24314;&#12290;
            &#36825;&#26159;&#26368;&#31616;&#21333;&#30340;&#22330;&#26223;&#65292;&#22240;&#20026;JDK&#20195;&#29702;&#26159;&#22522;&#20110;&#25509;&#21475;&#30340;&#65292;&#27809;&#26377;&#25509;&#21475;&#24847;&#21619;&#30528;&#27809;&#26377;&#20351;&#29992;JDK&#36827;&#34892;&#20195;&#29702;&#30340;&#21487;&#33021;&#12290;
            &#22312;&#30446;&#26631;bean&#37324;&#23558;&#34987;&#25554;&#20837;&#25506;&#27979;&#20195;&#30721;&#65292;&#36890;&#36807;<tt class="literal">interceptorNames</tt>&#23646;&#24615;&#32473;&#20986;&#20102;&#25318;&#25130;&#22120;&#30340;&#21015;&#34920;&#12290;
            &#27880;&#24847;&#19968;&#20010;&#22522;&#20110;CGLIB&#30340;&#20195;&#29702;&#23558;&#34987;&#21019;&#24314;&#21363;&#20351;<tt class="classname">ProxyFactoryBean</tt>&#30340;<tt class="literal">proxyTargetClass</tt>&#23646;&#24615;&#34987;&#35774;&#32622;&#20026;<tt class="literal">false</tt>&#12290;
            &#65288;&#24456;&#26126;&#26174;&#36825;&#31181;&#24773;&#20917;&#19979;&#23545;&#36825;&#20010;&#23646;&#24615;&#36827;&#34892;&#35774;&#32622;&#26159;&#27809;&#26377;&#24847;&#20041;&#30340;&#65292;&#26368;&#22909;&#25226;&#23427;&#20174;bean&#30340;&#23450;&#20041;&#20013;&#31227;&#38500;&#65292;&#22240;&#20026;&#34429;&#28982;&#36825;&#21482;&#26159;&#20010;&#22810;&#20313;&#30340;&#23646;&#24615;&#65292;&#20294;&#22312;&#35768;&#22810;&#24773;&#20917;&#19979;&#20250;&#24341;&#36215;&#28151;&#28102;&#12290;&#65289;
        </p><p>
            &#22914;&#26524;&#30446;&#26631;&#31867;&#23454;&#29616;&#20102;&#19968;&#20010;&#65288;&#25110;&#32773;&#26356;&#22810;&#65289;&#25509;&#21475;&#65292;&#37027;&#20040;&#21019;&#24314;&#20195;&#29702;&#30340;&#31867;&#22411;&#23558;&#26681;&#25454;<tt class="classname">ProxyFactoryBean</tt>&#30340;&#37197;&#32622;&#26469;&#20915;&#23450;&#12290;
        </p><p>
            &#22914;&#26524;<tt class="classname">ProxyFactoryBean</tt>&#30340;<tt class="literal">proxyTargetClass</tt>&#23646;&#24615;&#34987;&#35774;&#20026;<tt class="literal">true</tt>&#65292;&#37027;&#20040;&#19968;&#20010;&#22522;&#20110;CGLIB&#30340;&#20195;&#29702;&#23558;&#21019;&#24314;&#12290;
            &#36825;&#26679;&#30340;&#35268;&#23450;&#26159;&#26377;&#24847;&#20041;&#30340;&#65292;&#36981;&#24490;&#20102;&#26368;&#23567;&#24778;&#35766;&#27861;&#21017;&#65288;&#20445;&#35777;&#20102;&#35774;&#23450;&#30340;&#19968;&#33268;&#24615;&#65289;&#12290;&#29978;&#33267;&#24403;<tt class="classname">ProxyFactoryBean</tt>&#30340;<tt class="literal">proxyInterfaces</tt>&#23646;&#24615;&#34987;&#35774;&#32622;&#20026;&#19968;&#20010;&#25110;&#32773;&#22810;&#20010;&#20840;&#38480;&#23450;&#25509;&#21475;&#21517;&#65292;
            &#32780;<tt class="literal">proxyTargetClass</tt>&#23646;&#24615;&#34987;&#35774;&#32622;&#20026;<tt class="literal">true</tt>&#20173;&#28982;<span class="emphasis"><em>&#23558;</em></span>&#23454;&#38469;&#20351;&#29992;&#22522;&#20110;CGLIB&#30340;&#20195;&#29702;&#12290;
        </p><p>
            &#22914;&#26524;<tt class="classname">ProxyFactoryBean</tt>&#30340;<tt class="literal">proxyInterfaces</tt>&#23646;&#24615;&#34987;&#35774;&#32622;&#20026;&#19968;&#20010;&#25110;&#32773;&#22810;&#20010;&#20840;&#38480;&#23450;&#25509;&#21475;&#21517;&#65292;&#19968;&#20010;&#22522;&#20110;JDK&#30340;&#20195;&#29702;&#23558;&#34987;&#21019;&#24314;&#12290;
            &#34987;&#21019;&#24314;&#30340;&#20195;&#29702;&#23558;&#23454;&#29616;&#25152;&#26377;&#22312;<tt class="literal">proxyInterfaces</tt>&#23646;&#24615;&#37324;&#34987;&#35828;&#26126;&#30340;&#25509;&#21475;&#65307;
            &#22914;&#26524;&#30446;&#26631;&#31867;&#23454;&#29616;&#20102;&#20840;&#37096;&#22312;<tt class="literal">proxyInterfaces</tt>&#23646;&#24615;&#37324;&#35828;&#26126;&#30340;&#25509;&#21475;&#20197;&#21450;&#19968;&#20123;&#39069;&#22806;&#25509;&#21475;&#65292;&#36820;&#22238;&#30340;&#20195;&#29702;&#23558;&#21482;&#23454;&#29616;&#35828;&#26126;&#30340;&#25509;&#21475;&#32780;&#19981;&#20250;&#23454;&#29616;&#37027;&#20123;&#39069;&#22806;&#25509;&#21475;&#12290;
        </p><p>
            &#22914;&#26524;<tt class="classname">ProxyFactoryBean</tt>&#30340;<tt class="literal">proxyInterfaces</tt>&#23646;&#24615;<span class="emphasis"><em>&#27809;&#26377;</em></span>&#34987;&#35774;&#32622;&#65292;
            &#20294;&#26159;&#30446;&#26631;&#31867;<span class="emphasis"><em>&#23454;&#29616;&#20102;&#19968;&#20010;&#65288;&#25110;&#32773;&#26356;&#22810;&#65289;</em></span>&#25509;&#21475;&#65292;&#37027;&#20040;<tt class="classname">ProxyFactoryBean</tt>&#23558;&#33258;&#21160;&#26816;&#27979;&#21040;&#36825;&#20010;&#30446;&#26631;&#31867;&#24050;&#32463;&#23454;&#29616;&#20102;&#33267;&#23569;&#19968;&#20010;&#25509;&#21475;&#65292;
            &#19968;&#20010;&#22522;&#20110;JDK&#30340;&#20195;&#29702;&#23558;&#34987;&#21019;&#24314;&#12290;&#34987;&#23454;&#38469;&#20195;&#29702;&#30340;&#25509;&#21475;&#23558;&#26159;&#30446;&#26631;&#31867;&#25152;&#23454;&#29616;&#30340;<span class="emphasis"><em>&#20840;&#37096;</em></span>&#25509;&#21475;&#65307;
            &#23454;&#38469;&#19978;&#65292;&#36825;&#21644;&#22312;<tt class="literal">proxyInterfaces</tt>&#23646;&#24615;&#20013;&#21015;&#20986;&#30446;&#26631;&#31867;&#23454;&#29616;&#30340;&#27599;&#20010;&#25509;&#21475;&#30340;&#24773;&#20917;&#26159;&#19968;&#26679;&#30340;&#12290;
            &#28982;&#32780;&#65292;&#36825;&#23558;&#26174;&#33879;&#22320;&#20943;&#23569;&#24037;&#20316;&#37327;&#20197;&#21450;&#36755;&#20837;&#38169;&#35823;&#30340;&#21487;&#33021;&#24615;&#12290;
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-api-proxying-intf"></a>7.5.4.&nbsp;&#23545;&#25509;&#21475;&#36827;&#34892;&#20195;&#29702;</h3></div></div><div></div></div><p>
            &#35753;&#25105;&#20204;&#30475;&#19968;&#20010;&#20851;&#20110;<tt class="classname">ProxyFactoryBean</tt>&#30340;&#31616;&#21333;&#20363;&#23376;&#12290;&#36825;&#20010;&#20363;&#23376;&#28041;&#21450;&#65306;
        </p><div class="itemizedlist"><ul type="disc"><li><p>&#19968;&#20010;&#23558;&#34987;&#20195;&#29702;&#30340;<span class="emphasis"><em>&#30446;&#26631;bean</em></span>&#12290;&#22312;&#19979;&#38754;&#30340;&#20363;&#23376;&#37324;&#36825;&#20010;bean&#26159;&#8220;personTarget&#8221;&#12290;</p></li><li><p>&#34987;&#29992;&#26469;&#25552;&#20379;&#36890;&#30693;&#30340;&#19968;&#20010;&#36890;&#30693;&#22120;&#21644;&#19968;&#20010;&#25318;&#25130;&#22120;&#12290;</p></li><li><p>&#19968;&#20010;AOP&#20195;&#29702;bean&#30340;&#23450;&#20041;&#65292;&#23427;&#35828;&#26126;&#20102;&#30446;&#26631;&#23545;&#35937;&#65288;personTarget bean&#65289;&#20197;&#21450;&#38656;&#35201;&#20195;&#29702;&#30340;&#25509;&#21475;&#65292;&#36824;&#21253;&#25324;&#38656;&#35201;&#34987;&#24212;&#29992;&#30340;&#36890;&#30693;&#12290;</p></li></ul></div><p>
            </p><pre class="programlisting">&lt;bean id="personTarget" class="com.mycompany.PersonImpl"&gt;
                &lt;property name="name"&gt;&lt;value&gt;Tony&lt;/value&gt;&lt;/property&gt;
                &lt;property name="age"&gt;&lt;value&gt;51&lt;/value&gt;&lt;/property&gt;
                &lt;/bean&gt;
                
                &lt;bean id="myAdvisor" class="com.mycompany.MyAdvisor"&gt;
                &lt;property name="someProperty"&gt;&lt;value&gt;Custom string property value&lt;/value&gt;&lt;/property&gt;
                &lt;/bean&gt;
                
                &lt;bean id="debugInterceptor" class="org.springframework.aop.interceptor.DebugInterceptor"&gt;
                &lt;/bean&gt;
                
                &lt;bean id="person" 
                class="org.springframework.aop.framework.ProxyFactoryBean"&gt;
                &lt;property name="proxyInterfaces"&gt;&lt;value&gt;com.mycompany.Person&lt;/value&gt;&lt;/property&gt;
                
                &lt;property name="target"&gt;&lt;ref local="personTarget"/&gt;&lt;/property&gt;
                &lt;property name="interceptorNames"&gt;
                &lt;list&gt;
                &lt;value&gt;myAdvisor&lt;/value&gt;
                &lt;value&gt;debugInterceptor&lt;/value&gt;
                &lt;/list&gt;
                &lt;/property&gt;
            &lt;/bean&gt;</pre><p>
        </p><p>&#27880;&#24847;<tt class="literal">interceptorNames</tt>&#23646;&#24615;&#25509;&#21463;&#19968;&#32452;&#23383;&#31526;&#20018;&#65306;&#24403;&#21069;&#24037;&#21378;&#20013;&#25318;&#25130;&#22120;&#25110;&#36890;&#30693;&#22120;bean&#30340;&#21517;&#23383;&#12290;
            &#25318;&#25130;&#22120;&#65292;&#36890;&#30693;&#22120;&#65292;&#21069;&#32622;, &#21518;&#32622;&#21644;&#24322;&#24120;&#36890;&#30693;&#23545;&#35937;&#37117;&#21487;&#20197;&#22312;&#36825;&#37324;&#34987;&#20351;&#29992;&#12290;&#36825;&#37324;&#36890;&#30693;&#22120;&#30340;&#39034;&#24207;&#26159;&#24456;&#37325;&#35201;&#30340;&#12290;
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#20320;&#20063;&#35768;&#24456;&#22855;&#24618;&#20026;&#20160;&#20040;&#36825;&#20010;&#21015;&#34920;&#19981;&#20445;&#23384;bean&#30340;&#24341;&#29992;&#12290;&#29702;&#30001;&#26159;&#22914;&#26524;ProxyFactoryBean&#30340;singleton&#23646;&#24615;&#34987;&#35774;&#32622;&#20026;false&#65292;&#23427;&#24517;&#39035;&#36820;&#22238;&#29420;&#31435;&#30340;&#20195;&#29702;&#23454;&#20363;&#12290;
                &#22914;&#26524;&#20219;&#20309;&#36890;&#30693;&#22120;&#26412;&#36523;&#26159;&#19968;&#20010;&#21407;&#22411;&#65292;&#21017;&#27599;&#27425;&#37117;&#36820;&#22238;&#19968;&#20010;&#29420;&#31435;&#23454;&#20363;&#65292;&#22240;&#27492;&#23427;&#24517;&#39035;&#33021;&#22815;&#20174;&#24037;&#21378;&#37324;&#33719;&#24471;&#21407;&#22411;&#30340;&#19968;&#20010;&#23454;&#20363;&#65307;&#20445;&#23384;&#19968;&#20010;&#24341;&#29992;&#26159;&#19981;&#22815;&#30340;&#12290;
            </p></td></tr></table></div><p>&#19978;&#38754;&#8220;person&#8221; bean&#30340;&#23450;&#20041;&#21487;&#20197;&#34987;&#29992;&#26469;&#21462;&#20195;&#19968;&#20010;Person&#25509;&#21475;&#30340;&#23454;&#29616;&#65292;&#23601;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;</p><pre class="programlisting">Person person = (Person) factory.getBean("person");</pre><p>&#22312;&#21516;&#19968;&#20010;IoC&#19978;&#19979;&#25991;&#20013;&#20854;&#23427;&#30340;bean&#21487;&#20197;&#23545;&#36825;&#20010;bean&#26377;&#22522;&#20110;&#31867;&#22411;&#30340;&#20381;&#36182;&#65292;&#23601;&#20687;&#23545;&#19968;&#20010;&#26222;&#36890;&#30340;Java&#23545;&#35937;&#37027;&#26679;&#65306;</p><p>
            </p><pre class="programlisting">&lt;bean id="personUser" class="com.mycompany.PersonUser"&gt;
                &lt;property name="person"&gt;&lt;ref local="person" /&gt;&lt;/property&gt;
            &lt;/bean&gt;</pre><p>
        </p><p>&#36825;&#20010;&#20363;&#23376;&#37324;&#30340;<tt class="literal">PersonUser</tt>&#31867;&#23558;&#26292;&#38706;&#19968;&#20010;&#31867;&#22411;&#20026;Person&#30340;&#23646;&#24615;&#12290;&#23601;&#20687;&#25105;&#20204;&#20851;&#24515;&#30340;&#37027;&#26679;&#65292;AOP&#20195;&#29702;&#21487;&#20197;&#36879;&#26126;&#22320;&#21462;&#20195;&#19968;&#20010;&#8220;&#30495;&#23454;&#8221;&#30340;person&#25509;&#21475;&#23454;&#29616;&#12290;
        &#28982;&#32780;&#65292;&#23427;&#30340;&#31867;&#23558;&#26159;&#19968;&#20010;&#21160;&#24577;&#20195;&#29702;&#31867;&#12290; &#23427;&#21487;&#20197;&#34987;&#36716;&#22411;&#25104;<tt class="literal">Advised</tt>&#25509;&#21475;&#65288;&#23558;&#22312;&#19979;&#38754;&#35752;&#35770;&#65289;&#12290;</p><p>&#23601;&#20687;&#19979;&#38754;&#36825;&#26679;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;&#19968;&#20010;&#21311;&#21517;<span class="emphasis"><em>&#20869;&#37096;bean</em></span>&#26469;&#38544;&#34255;&#30446;&#26631;&#21644;&#20195;&#29702;&#20043;&#38388;&#30340;&#21306;&#21035;&#12290;
        &#20165;&#20165;<tt class="literal">ProxyFactoryBean</tt>&#30340;&#23450;&#20041;&#26377;&#25152;&#19981;&#21516;&#65307;&#36890;&#30693;&#30340;&#23450;&#20041;&#21482;&#26159;&#30001;&#20110;&#23436;&#25972;&#24615;&#30340;&#21407;&#22240;&#32780;&#34987;&#21253;&#25324;&#36827;&#26469;&#65306;</p><p>
            </p><pre class="programlisting">&lt;bean id="myAdvisor" class="com.mycompany.MyAdvisor"&gt;
                &lt;property name="someProperty"&gt;&lt;value&gt;Custom string property value&lt;/value&gt;&lt;/property&gt;
                &lt;/bean&gt;
                
                &lt;bean id="debugInterceptor" class="org.springframework.aop.interceptor.DebugInterceptor"/&gt;
                
                &lt;bean id="person" class="org.springframework.aop.framework.ProxyFactoryBean"&gt;
                &lt;property name="proxyInterfaces"&gt;&lt;value&gt;com.mycompany.Person&lt;/value&gt;&lt;/property&gt;
                &lt;!-- Use inner bean, not local reference to target --&gt;
                &lt;property name="target"&gt;
                &lt;bean class="com.mycompany.PersonImpl"&gt;
                &lt;property name="name"&gt;&lt;value&gt;Tony&lt;/value&gt;&lt;/property&gt;
                &lt;property name="age"&gt;&lt;value&gt;51&lt;/value&gt;&lt;/property&gt;
                &lt;/bean&gt;
                &lt;/property&gt;
                &lt;property name="interceptorNames"&gt;
                &lt;list&gt;
                &lt;value&gt;myAdvisor&lt;/value&gt;
                &lt;value&gt;debugInterceptor&lt;/value&gt;
                &lt;/list&gt;
                &lt;/property&gt;
            &lt;/bean&gt;</pre><p>
        </p><p>&#23545;&#20110;&#21482;&#38656;&#35201;&#19968;&#20010;<tt class="literal">Person</tt>&#31867;&#22411;&#23545;&#35937;&#30340;&#24773;&#20917;&#65292;&#36825;&#26159;&#26377;&#22909;&#22788;&#30340;&#65306;&#22914;&#26524;&#20320;&#24076;&#26395;&#38459;&#27490;&#24212;&#29992;&#31243;&#24207;&#19978;&#19979;&#25991;&#30340;&#29992;&#25143;&#33719;&#21462;&#19968;&#20010;&#25351;&#21521;&#26410;&#36890;&#30693;&#23545;&#35937;&#30340;&#24341;&#29992;&#25110;&#32773;&#24076;&#26395;&#36991;&#20813;&#20351;&#29992;Spring IoC <span class="emphasis"><em>&#33258;&#21160;&#32455;&#20837;</em></span> &#26102;&#30340;&#28151;&#28102;&#12290;
        &#25353;&#29702;&#35828;ProxyFactoryBean&#23450;&#20041;&#36824;&#26377;&#19968;&#20010;&#20248;&#28857;&#26159;&#23427;&#26159;&#33258;&#21253;&#21547;&#30340;&#12290;&#28982;&#32780;&#65292;&#26377;&#26102;&#33021;&#22815;&#20174;&#24037;&#21378;&#37324;&#33719;&#21462;&#26410;&#36890;&#30693;&#30340;&#30446;&#26631;&#20063;&#26159;&#19968;&#20010;&#20248;&#28857;&#65306;&#20363;&#22914;&#65292;&#22312;&#26576;&#20123;&#27979;&#35797;&#22330;&#26223;&#37324;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-api-proxying-class"></a>7.5.5.&nbsp;&#23545;&#31867;&#36827;&#34892;&#20195;&#29702;</h3></div></div><div></div></div><p>&#22914;&#26524;&#20320;&#38656;&#35201;&#20195;&#29702;&#19968;&#20010;&#31867;&#32780;&#19981;&#26159;&#20195;&#29702;&#19968;&#20010;&#25110;&#26159;&#26356;&#22810;&#25509;&#21475;&#65292;&#37027;&#20040;&#24773;&#20917;&#23558;&#26159;&#24590;&#26679;&#65311;</p><p>&#24819;&#35937;&#22312;&#25105;&#20204;&#19978;&#38754;&#30340;&#20363;&#23376;&#37324;&#65292;&#19981;&#23384;&#22312;<tt class="literal">Person</tt>&#25509;&#21475;&#65306;&#25105;&#20204;&#38656;&#35201;&#36890;&#30693;&#19968;&#20010;&#21483;&#20570;<tt class="literal">Person</tt>&#30340;&#31867;&#65292;&#23427;&#27809;&#26377;&#23454;&#29616;&#20219;&#20309;&#19994;&#21153;&#25509;&#21475;&#12290;
            &#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#20320;&#21487;&#20197;&#37197;&#32622;Spring&#20351;&#29992;CGLIB&#20195;&#29702;&#65292;&#32780;&#19981;&#26159;&#21160;&#24577;&#20195;&#29702;&#12290;&#36825;&#21482;&#38656;&#31616;&#21333;&#22320;&#25226;&#19978;&#38754;ProxyFactoryBean&#30340;<tt class="literal">proxyTargetClass</tt>&#23646;&#24615;&#35774;&#20026;true&#12290;
            &#34429;&#28982;&#26368;&#20339;&#26041;&#26696;&#26159;&#38754;&#21521;&#25509;&#21475;&#32534;&#31243;&#32780;&#19981;&#26159;&#31867;&#65292;&#20294;&#22312;&#19982;&#36951;&#30041;&#20195;&#30721;&#19968;&#36215;&#24037;&#20316;&#26102;&#65292;&#36890;&#30693;&#27809;&#26377;&#23454;&#29616;&#25509;&#21475;&#30340;&#31867;&#30340;&#33021;&#21147;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#12290;
            &#65288;&#36890;&#24120;&#24773;&#20917;&#19979;&#65292;Spring&#27809;&#26377;&#20219;&#20309;&#35268;&#23450;&#12290;&#23427;&#21482;&#26159;&#35753;&#20320;&#24456;&#23481;&#26131;&#26681;&#25454;&#23454;&#38469;&#24773;&#20917;&#36873;&#25321;&#26368;&#22909;&#30340;&#35299;&#20915;&#26041;&#26696;&#65292;&#36991;&#20813;&#24378;&#36843;&#20351;&#29992;&#29305;&#23450;&#26041;&#24335;&#65289;&#12290;
        </p><p>&#20063;&#35768;&#20320;&#24076;&#26395;&#20320;&#33021;&#22815;&#22312;&#20219;&#20309;&#24773;&#20917;&#19979;&#37117;&#24378;&#21046;&#20351;&#29992;CGLIB&#65292;&#29978;&#33267;&#22312;&#20320;&#20351;&#29992;&#25509;&#21475;&#30340;&#26102;&#20505;&#20063;&#36825;&#26679;&#20570;&#12290;</p><p>CGLIB&#36890;&#36807;&#22312;&#36816;&#34892;&#26102;&#29983;&#25104;&#19968;&#20010;&#30446;&#26631;&#31867;&#30340;&#23376;&#31867;&#26469;&#36827;&#34892;&#20195;&#29702;&#24037;&#20316;&#12290;
        Spring&#37197;&#32622;&#36825;&#20010;&#29983;&#25104;&#30340;&#23376;&#31867;&#23545;&#21407;&#22987;&#30446;&#26631;&#23545;&#35937;&#30340;&#26041;&#27861;&#35843;&#29992;&#36827;&#34892;&#25176;&#31649;&#65306;&#23376;&#31867;&#23454;&#29616;&#20102;<span class="emphasis"><em>&#35013;&#39280;&#22120;&#65288;Decorator&#65289;</em></span>&#27169;&#24335;&#65292;&#25226;&#36890;&#30693;&#32455;&#20837;&#12290;</p><p>CGLIB&#30340;&#20195;&#29702;&#27963;&#21160;&#24212;&#24403;&#23545;&#29992;&#25143;&#26159;&#36879;&#26126;&#30340;&#12290;&#28982;&#32780;&#65292;&#26377;&#19968;&#20123;&#38382;&#39064;&#38656;&#35201;&#34987;&#32771;&#34385;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p><tt class="literal">Final</tt>&#26041;&#27861;&#19981;&#21487;&#20197;&#34987;&#36890;&#30693;&#65292;&#22240;&#20026;&#23427;&#20204;&#19981;&#33021;&#34987;&#35206;&#30422;&#12290;</p></li><li><p>&#20320;&#38656;&#35201;&#22312;&#20320;&#30340;&#31867;&#36335;&#24452;&#37324;&#26377;CGLIB 2&#30340;&#24211;&#65307;&#20351;&#29992;&#21160;&#24577;&#20195;&#29702;&#30340;&#35805;&#21482;&#38656;&#35201;JDK&#12290;</p></li></ul></div><p>&#22312;CGLIB&#20195;&#29702;&#21644;&#21160;&#24577;&#20195;&#29702;&#20043;&#38388;&#30340;&#36895;&#24230;&#24046;&#21035;&#26159;&#24456;&#23567;&#30340;&#12290;&#22312;Spring 1.0&#20013;&#65292;&#21160;&#24577;&#20195;&#29702;&#20250;&#24555;&#19968;&#28857;&#28857;&#12290;&#20294;&#36825;&#28857;&#21487;&#33021;&#22312;&#23558;&#26469;&#34987;&#25913;&#21464;&#12290;
            &#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#36873;&#25321;&#20351;&#29992;&#20309;&#31181;&#20195;&#29702;&#26102;&#36895;&#24230;&#19981;&#24212;&#35813;&#25104;&#20026;&#20915;&#23450;&#24615;&#30340;&#29702;&#30001;&#12290;
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-global-advisors"></a>7.5.6.&nbsp;&#20351;&#29992;&#8220;&#20840;&#23616;&#8221;&#36890;&#30693;&#22120;</h3></div></div><div></div></div><p>&#36890;&#36807;&#22312;&#19968;&#20010;&#25318;&#25130;&#22120;&#21517;&#21518;&#28155;&#21152;&#19968;&#20010;&#26143;&#21495;&#65292;&#25152;&#26377;bean&#21517;&#23383;&#19982;&#26143;&#21495;&#20043;&#21069;&#37096;&#20998;&#30456;&#21305;&#37197;&#30340;&#36890;&#30693;&#37117;&#23558;&#34987;&#21152;&#20837;&#21040;&#36890;&#30693;&#22120;&#38142;&#20013;&#12290;&#36825;&#35753;&#20320;&#24456;&#23481;&#26131;&#28155;&#21152;&#19968;&#32452;&#26631;&#20934;&#30340;&#8220;&#20840;&#23616;&#8221;&#36890;&#30693;&#22120;&#65306;</p><pre class="programlisting">
                &lt;bean id="proxy" class="org.springframework.aop.framework.ProxyFactoryBean"&gt;
                &lt;property name="target" ref="service"/&gt;
                &lt;property name="interceptorNames"&gt;
                &lt;list&gt;
                &lt;value&gt;globa *&lt;/value&gt;
                &lt;/list&gt;
                &lt;/property&gt;
                &lt;/bean&gt;
                
                &lt;bean id="global_debug" class="org.springframework.aop.interceptor.DebugInterceptor"/&gt;
                &lt;bean id="global_performance" class="org.springframework.aop.interceptor.PerformanceMonitorInterceptor"/&gt;
        </pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-concise-proxy"></a>7.6.&nbsp;&#31616;&#21270;&#20195;&#29702;&#23450;&#20041;</h2></div></div><div></div></div><p>&#20320;&#20063;&#35768;&#38656;&#35201;&#35768;&#22810;&#30456;&#20284;&#30340;&#20195;&#29702;&#23450;&#20041;&#65292;&#29305;&#21035;&#26159;&#23450;&#20041;&#20107;&#21153;&#24615;&#20195;&#29702;&#30340;&#26102;&#20505;&#12290;&#20351;&#29992;&#29238;&#23376;bean&#23450;&#20041;&#65292;&#20197;&#21450;&#20869;&#37096;bean&#23450;&#20041;&#65292;&#21487;&#20197;&#35753;&#20195;&#29702;&#23450;&#20041;&#22823;&#22823;&#24471;&#21040;&#26497;&#22823;&#30340;&#31616;&#21270;&#12290;</p><p>&#39318;&#20808;&#20174;&#29238;bean&#24320;&#22987;&#65292;&#20026;&#20195;&#29702;bean&#21019;&#24314;bean&#23450;&#20041;<span class="emphasis"><em>&#27169;&#29256;</em></span>&#65306;</p><p>
        </p><pre class="programlisting">&lt;bean id="txProxyTemplate" abstract="true"
            class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean"&gt;
            &lt;property name="transactionManager" ref="transactionManager"/&gt;
            &lt;property name="transactionAttributes"&gt;
            &lt;props&gt;
            &lt;prop key="*"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;
            &lt;/props&gt;
            &lt;/property&gt;
        &lt;/bean&gt;</pre><p>
    </p><p>&#36825;&#20010;bean&#26412;&#36523;&#23558;&#27704;&#36828;&#19981;&#20250;&#34987;&#21021;&#22987;&#21270;&#65292;&#25152;&#20197;&#23454;&#38469;&#19978;&#26159;&#19981;&#23436;&#25972;&#30340;&#12290;&#32780;&#21518;&#27599;&#20010;&#38656;&#35201;&#21019;&#24314;&#30340;&#20195;&#29702;&#37117;&#26159;&#36825;&#20010;bean&#23450;&#20041;&#30340;&#23376;bean&#23450;&#20041;&#65292;&#23427;&#20204;&#25226;&#20195;&#29702;&#30340;&#30446;&#26631;&#31867;&#21253;&#35013;&#20026;&#19968;&#20010;&#20869;&#37096;bean&#23450;&#20041;&#65292;&#22240;&#20026;&#30446;&#26631;&#23545;&#35937;&#26412;&#36523;&#23558;&#19981;&#20250;&#34987;&#21333;&#29420;&#20351;&#29992;&#12290;
        </p><pre class="programlisting">&lt;bean id="myService" parent="txProxyTemplate"&gt;
            &lt;property name="target"&gt;
            &lt;bean class="org.springframework.samples.MyServiceImpl"&gt;
            &lt;/bean&gt;
            &lt;/property&gt;
    &lt;/bean&gt;</pre><p>&#24403;&#28982;&#20320;&#21487;&#20197;&#35206;&#30422;&#20174;&#27169;&#29256;&#20013;&#32487;&#25215;&#30340;&#23646;&#24615;&#65292;&#20363;&#22914;&#22312;&#19979;&#38754;&#36825;&#20010;&#20363;&#23376;&#37324;&#30340;&#20107;&#21153;&#20256;&#25773;&#35774;&#32622;&#65306;</p><pre class="programlisting">&lt;bean id="mySpecialService" parent="txProxyTemplate"&gt;
            &lt;property name="target"&gt;
            &lt;bean class="org.springframework.samples.MySpecialServiceImpl"&gt;
            &lt;/bean&gt;
            &lt;/property&gt;
            &lt;property name="transactionAttributes"&gt;
            &lt;props&gt;
            &lt;prop key="get*"&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt;
            &lt;prop key="find*"&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt;
            &lt;prop key="load*"&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt;
            &lt;prop key="store*"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;
            &lt;/props&gt;
            &lt;/property&gt;
    &lt;/bean&gt;</pre><p>&#35201;&#27880;&#24847;&#19978;&#38754;&#20363;&#23376;&#20013;&#25105;&#20204;&#24050;&#32463;&#26126;&#30830;&#22320;&#36890;&#36807;&#35774;&#23450;<span class="emphasis"><em>abstract</em></span>&#23646;&#24615;&#25226;&#29238;bean&#23450;&#20041;&#26631;&#27880;&#20026;<span class="emphasis"><em>abstract</em></span>&#65292;&#22312;<a href="beans.html#beans-child-bean-definitions" title="3.6.&nbsp;bean&#23450;&#20041;&#30340;&#32487;&#25215;">&#21069;&#38754;</a>&#30340;&#31456;&#33410;&#37324;&#26377;&#25551;&#36848;&#65292;&#36825;&#26679;&#23427;&#23454;&#38469;&#19978;&#19981;&#33021;&#34987;&#21021;&#22987;&#21270;&#12290;
        &#32570;&#30465;&#24773;&#20917;&#19979;&#24212;&#29992;&#31243;&#24207;&#19978;&#19979;&#25991;&#65288;&#19981;&#20165;&#20165;&#26159;bean&#24037;&#21378;&#65289;&#23558;&#39044;&#20808;&#21021;&#22987;&#21270;&#25152;&#26377;&#30340;&#23454;&#20363;&#20026;&#21333;&#20363;&#12290;
        &#22240;&#27492;&#19979;&#38754;&#36825;&#28857;&#26159;&#24456;&#37325;&#35201;&#30340;&#65288;&#33267;&#23569;&#23545;&#20110;&#21333;&#20363;bean&#26469;&#35828;&#65289;&#65292;&#22914;&#26524;&#20320;&#26377;&#19968;&#20010;&#65288;&#29238;&#65289;bean&#23450;&#20041;&#20320;&#24076;&#26395;&#20165;&#20165;&#20316;&#20026;&#27169;&#29256;&#20351;&#29992;&#65292;&#32780;&#36825;&#20010;&#23450;&#20041;&#35828;&#26126;&#20102;&#19968;&#20010;&#31867;&#65292;&#20320;&#24517;&#39035;&#25226;<span class="emphasis"><em>abstract</em></span>&#21442;&#25968;&#35774;&#32622;&#20026;<span class="emphasis"><em>true</em></span>&#65292;&#21542;&#21017;&#24212;&#29992;&#31243;&#24207;&#19978;&#19979;&#25991;&#23558;&#35797;&#22270;&#39044;&#20808;&#21021;&#22987;&#21270;&#23427;&#12290;
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-prog"></a>7.7.&nbsp;&#20351;&#29992;ProxyFactory&#36890;&#36807;&#32534;&#31243;&#21019;&#24314;AOP&#20195;&#29702;</h2></div></div><div></div></div><p>&#20351;&#29992;Spring&#36890;&#36807;&#32534;&#31243;&#21019;&#24314;AOP&#20195;&#29702;&#26159;&#24456;&#23481;&#26131;&#30340;&#12290;&#36825;&#20351;&#20320;&#21487;&#20197;&#20351;&#29992;Spring AOP&#32780;&#19981;&#24517;&#20381;&#36182;&#20110;Spring IoC&#12290;</p><p>&#19979;&#38754;&#30340;&#28165;&#21333;&#26174;&#31034;&#20102;&#22914;&#20309;&#20351;&#29992;&#19968;&#20010;&#25318;&#25130;&#22120;&#21644;&#19968;&#20010;&#36890;&#30693;&#22120;&#26469;&#20026;&#19968;&#20010;&#30446;&#26631;&#23545;&#35937;&#26469;&#21019;&#24314;&#19968;&#20010;&#20195;&#29702;&#12290;&#30446;&#26631;&#23545;&#35937;&#23454;&#29616;&#30340;&#25509;&#21475;&#23558;&#34987;&#33258;&#21160;&#20195;&#29702;&#65306;</p><p>
        </p><pre class="programlisting">ProxyFactory factory = new ProxyFactory(myBusinessInterfaceImpl);
            factory.addInterceptor(myMethodInterceptor);
            factory.addAdvisor(myAdvisor);
        MyBusinessInterface tb = (MyBusinessInterface) factory.getProxy();</pre><p>
    </p><p>&#31532;&#19968;&#27493;&#26159;&#21019;&#24314;&#19968;&#20010;&#31867;&#22411;&#20026;<tt class="literal">org.springframework.aop.framework.ProxyFactory</tt>&#30340;&#23545;&#35937;&#12290;
    &#20320;&#21487;&#20197;&#20687;&#19978;&#38754;&#20363;&#23376;&#37324;&#37027;&#26679;&#20351;&#29992;&#19968;&#20010;&#30446;&#26631;&#23545;&#35937;&#26469;&#21019;&#24314;&#23427;&#65292;&#25110;&#32773;&#22312;&#19968;&#20010;&#21487;&#36873;&#30340;&#26500;&#36896;&#22120;&#37324;&#35828;&#26126;&#38656;&#35201;&#34987;&#20195;&#29702;&#30340;&#25509;&#21475;&#12290;</p><p>&#20320;&#21487;&#20197;&#28155;&#21152;&#25318;&#25130;&#22120;&#25110;&#36890;&#30693;&#22120;&#65292;&#24182;&#22312;ProxyFactory&#30340;&#29983;&#21629;&#21608;&#26399;&#37324;&#25805;&#20316;&#23427;&#20204;&#12290;&#22914;&#26524;&#20320;&#21152;&#20837;&#19968;&#20010;IntroductionInterceptionAroundAdvisor&#65292;&#20320;&#21487;&#20197;&#35753;&#20195;&#29702;&#23454;&#29616;&#39069;&#22806;&#30340;&#25509;&#21475;&#12290;</p><p>&#22312;ProxyFactory&#37324;&#20063;&#26377;&#24456;&#26041;&#20415;&#30340;&#26041;&#27861;&#65288;&#32487;&#25215;&#33258;<tt class="classname">AdvisedSupport</tt>&#65289;&#20801;&#35768;&#20320;&#21152;&#20837;&#20854;&#23427;&#30340;&#36890;&#30693;&#31867;&#22411;&#20363;&#22914;&#21069;&#32622;&#21644;&#24322;&#24120;&#36890;&#30693;&#12290;
    AdvisedSupport&#26159;ProxyFactory &#21644;ProxyFactoryBean&#30340;&#20849;&#21516;&#29238;&#31867;&#12290;</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="http://shouce.jb51.net/images/admons/tip.png"></td><th align="left">Tip</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#22312;&#22823;&#22810;&#25968;&#24212;&#29992;&#31243;&#24207;&#37324;&#65292;&#25226;AOP&#20195;&#29702;&#30340;&#21019;&#24314;&#21644;IoC&#26694;&#26550;&#38598;&#25104;&#26159;&#26368;&#20339;&#23454;&#36341;&#12290;&#36890;&#24120;&#24773;&#20917;&#19979;&#25105;&#20204;&#25512;&#33616;&#20320;&#22312;Java&#20195;&#30721;&#22806;&#36827;&#34892;AOP&#30340;&#37197;&#32622;&#12290;</p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-api-advised"></a>7.8.&nbsp;&#25805;&#20316;&#34987;&#36890;&#30693;&#23545;&#35937;</h2></div></div><div></div></div><p>&#22312;&#21019;&#24314;&#20102;AOP&#20195;&#29702;&#20043;&#21518;&#65292;&#20320;&#33021;&#22815;&#20351;&#29992;<tt class="literal">org.springframework.aop.framework.Advised</tt>&#25509;&#21475;&#23545;&#23427;&#20204;&#36827;&#34892;&#31649;&#29702;&#12290;
    &#20219;&#20309;AOP&#20195;&#29702;&#37117;&#33021;&#22815;&#34987;&#36716;&#22411;&#20026;&#36825;&#20010;&#25509;&#21475;&#65292;&#19981;&#35770;&#23427;&#23454;&#29616;&#20102;&#21738;&#20123;&#20854;&#23427;&#25509;&#21475;&#12290;&#36825;&#20010;&#25509;&#21475;&#21253;&#25324;&#19979;&#38754;&#30340;&#26041;&#27861;&#65306;</p><pre class="programlisting">Advisor[] getAdvisors();
        
        void addAdvice(Advice advice) throws AopConfigException;
        
        void addAdvice(int pos, Advice advice) 
        throws AopConfigException;
        
        void addAdvisor(Advisor advisor) throws AopConfigException;
        
        void addAdvisor(int pos, Advisor advisor) throws AopConfigException;
        
        int indexOf(Advisor advisor);
        
        boolean removeAdvisor(Advisor advisor) throws AopConfigException;
        
        void removeAdvisor(int index) throws AopConfigException;
        
        boolean replaceAdvisor(Advisor a, Advisor b) throws AopConfigException;
        
    boolean isFrozen();</pre><p><tt class="literal">getAdvisors()</tt>&#26041;&#27861;&#23558;&#20026;&#27599;&#20010;&#24050;&#32463;&#34987;&#21152;&#20837;&#24037;&#21378;&#30340;&#36890;&#30693;&#22120;&#65292;&#25318;&#25130;&#22120;&#25110;&#32773;&#20854;&#23427;&#36890;&#30693;&#31867;&#22411;&#36820;&#22238;&#19968;&#20010;&#36890;&#30693;&#22120;&#12290;&#22914;&#26524;&#20320;&#26366;&#32463;&#28155;&#21152;&#19968;&#20010;&#36890;&#30693;&#22120;&#65292;&#37027;&#20040;&#25152;&#36820;&#22238;&#30340;&#36890;&#30693;&#22120;&#23558;&#26159;&#20320;&#21152;&#20837;&#30340;&#23545;&#35937;&#12290;
        &#22914;&#26524;&#20320;&#26366;&#32463;&#21152;&#20837;&#19968;&#20010;&#25318;&#25130;&#22120;&#25110;&#32773;&#20854;&#23427;&#36890;&#30693;&#31867;&#22411;&#65292;Spring&#23558;&#25226;&#23427;&#20204;&#21253;&#35013;&#22312;&#19968;&#20010;&#36890;&#30693;&#22120;&#37324;&#65292;&#21518;&#32773;&#20351;&#29992;&#19968;&#20010;&#27704;&#36828;&#36820;&#22238;true&#30340;&#20999;&#20837;&#28857;&#12290;&#22240;&#27492;&#22914;&#26524;&#20320;&#26366;&#32463;&#21152;&#20837;&#19968;&#20010;<tt class="literal">MethodInterceptor</tt>&#65292;
        &#36820;&#22238;&#30340;&#36890;&#30693;&#22120;&#23558;&#26159;&#19968;&#20010;<tt class="literal">DefaultPointcutAdvisor</tt>&#65292;&#23427;&#21487;&#20197;&#36820;&#22238;&#20320;&#21152;&#20837;&#30340;<tt class="literal">MethodInterceptor</tt>&#21644;&#19968;&#20010;&#21305;&#37197;&#25152;&#26377;&#31867;&#21644;&#26041;&#27861;&#30340;&#20999;&#20837;&#28857;&#12290;
    </p><p><tt class="literal">addAdvisor()</tt>&#26041;&#27861;&#21487;&#20197;&#29992;&#26469;&#28155;&#21152;&#20219;&#20309;&#36890;&#30693;&#22120;&#12290;&#36890;&#24120;&#20445;&#23384;&#20999;&#20837;&#28857;&#21644;&#36890;&#30693;&#30340;&#36890;&#30693;&#22120;&#26159;<tt class="literal">DefaultPointcutAdvisor</tt>&#65292;&#23427;&#21487;&#20197;&#29992;&#20110;&#20219;&#20309;&#36890;&#30693;&#25110;&#20999;&#20837;&#28857;&#65288;&#20294;&#19981;&#21253;&#25324;&#24341;&#20837;&#31867;&#22411;&#65289;&#12290;</p><p>&#32570;&#30465;&#24773;&#20917;&#19979;&#65292;&#20320;&#21487;&#20197;&#21152;&#20837;&#25110;&#31227;&#38500;&#36890;&#30693;&#22120;&#25110;&#32773;&#25318;&#25130;&#22120;&#29978;&#33267;&#24403;&#20195;&#29702;&#24050;&#32463;&#34987;&#21019;&#24314;&#20043;&#21518;&#12290;&#21807;&#19968;&#30340;&#38480;&#21046;&#26159;&#26080;&#27861;&#21152;&#20837;&#25110;&#32773;&#31227;&#38500;&#19968;&#20010;&#24341;&#20837;&#36890;&#30693;&#22120;&#65292;&#22240;&#20026;&#24037;&#21378;&#20013;&#33719;&#24471;&#30340;&#24050;&#26377;&#20195;&#29702;&#19981;&#33021;&#26174;&#31034;&#25509;&#21475;&#30340;&#25913;&#21464;&#65288;&#20320;&#21487;&#20197;&#36890;&#36807;&#20174;&#24037;&#21378;&#37324;&#33719;&#21462;&#19968;&#20010;&#26032;&#30340;&#20195;&#29702;&#26469;&#36991;&#20813;&#36825;&#20010;&#38382;&#39064;&#65289;&#12290;</p><p>&#19979;&#38754;&#26159;&#19968;&#20010;&#31616;&#21333;&#30340;&#20363;&#23376;&#65292;&#23427;&#25226;&#19968;&#20010;AOP&#20195;&#29702;&#36716;&#22411;&#20026;<tt class="literal">Advised</tt>&#25509;&#21475;&#65292;&#26816;&#26597;&#24182;&#25805;&#20316;&#23427;&#30340;&#36890;&#30693;&#65306;</p><p>
        </p><pre class="programlisting">Advised advised = (Advised) myObject;
            Advisor[] advisors = advised.getAdvisors();
            int oldAdvisorCount = advisors.length;
            System.out.println(oldAdvisorCount + " advisors");
            
            // Add an advice like an interceptor without a pointcut
            // Will match all proxied methods
            // Can use for interceptors, before, after returning or throws advice
            advised.addAdvice(new DebugInterceptor());
            
            // Add selective advice using a pointcut
            advised.addAdvisor(new DefaultPointcutAdvisor(mySpecialPointcut, myAdvice));
            
            assertEquals("Added two advisors",
        oldAdvisorCount + 2, advised.getAdvisors().length);</pre><p>
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#22312;&#19968;&#20010;&#23454;&#38469;&#36816;&#34892;&#30340;&#31995;&#32479;&#37324;&#65292;&#20462;&#25913;&#19968;&#20010;&#19994;&#21153;&#23545;&#35937;&#19978;&#30340;&#36890;&#30693;&#26159;&#21542;&#26126;&#26234;&#26159;&#20010;&#38382;&#39064;&#65292;&#34429;&#28982;&#26080;&#30097;&#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#36825;&#26679;&#20570;&#26159;&#21512;&#29702;&#30340;&#12290;&#28982;&#32780;&#36825;&#22312;&#24320;&#21457;&#20013;&#26159;&#24456;&#26377;&#29992;&#30340;&#65306;
            &#20363;&#22914;&#65292;&#22312;&#27979;&#35797;&#30340;&#26102;&#20505;&#12290;&#23545;&#20110;&#24076;&#26395;&#27979;&#35797;&#30340;&#26041;&#27861;&#35843;&#29992;&#65292;&#26377;&#26102;&#25105;&#21457;&#29616;&#25226;&#27979;&#35797;&#20195;&#30721;&#21152;&#20837;&#21040;&#19968;&#20010;&#25318;&#25130;&#22120;&#25110;&#32773;&#20854;&#23427;&#36890;&#30693;&#37324;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#12290;
        &#65288;&#20363;&#22914;&#65292;&#36890;&#30693;&#21487;&#20197;&#19982;&#30446;&#26631;&#26041;&#27861;&#23384;&#22312;&#20110;&#21516;&#19968;&#20010;&#20107;&#21153;&#37324;&#65292;&#22312;&#25226;&#20107;&#21153;&#26631;&#35760;&#20026;&#22238;&#28378;&#20043;&#21069;&#21487;&#20197;&#29992;SQL&#26469;&#26816;&#26597;&#25968;&#25454;&#24211;&#26159;&#21542;&#34987;&#27491;&#30830;&#30340;&#26356;&#26032;&#20102;&#12290;&#65289;</p></td></tr></table></div><p>&#20381;&#36182;&#20110;&#20320;&#24590;&#26679;&#21019;&#24314;&#20195;&#29702;&#65292;&#20320;&#36890;&#24120;&#21487;&#20197;&#35774;&#32622;&#19968;&#20010;
        <tt class="literal">frozen</tt>&#26631;&#24535;&#65292;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;
        <tt class="literal">Advised</tt>&#30340;<tt class="literal">isFrozen()</tt>&#26041;&#27861;&#23558;&#36820;&#22238;true&#65292;&#20219;&#20309;&#22686;&#21152;&#25110;&#32773;&#31227;&#38500;&#36890;&#30693;&#30340;&#20462;&#25913;&#37117;&#20250;&#23548;&#33268;&#19968;&#20010;<tt class="literal">AopConfigException</tt>&#24322;&#24120;&#12290;
    &#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#36825;&#31181;&#20923;&#32467;&#34987;&#36890;&#30693;&#23545;&#35937;&#29366;&#24577;&#30340;&#33021;&#21147;&#26159;&#24456;&#26377;&#29992;&#30340;&#65306;&#20363;&#22914;&#65292;&#38450;&#27490;&#35843;&#29992;&#20195;&#30721;&#26469;&#31227;&#38500;&#19968;&#20010;&#36827;&#34892;&#23433;&#20840;&#26816;&#26597;&#30340;&#25318;&#25130;&#22120;&#12290;&#22312;Spring 1.1&#20013;&#23427;&#20063;&#34987;&#29992;&#26469;&#20801;&#35768;&#28608;&#36827;&#20248;&#21270;&#65292;&#22914;&#26524;&#24050;&#32463;&#30693;&#36947;&#19981;&#38656;&#35201;&#36816;&#34892;&#26102;&#23545;&#36890;&#30693;&#36827;&#34892;&#20462;&#25913;&#30340;&#35805;&#12290; </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-autoproxy"></a>7.9.&nbsp;&#20351;&#29992;&#8220;&#33258;&#21160;&#20195;&#29702;&#65288;autoproxy&#65289;&#8221;&#21151;&#33021;</h2></div></div><div></div></div><p>&#21040;&#30446;&#21069;&#20026;&#27490;&#25105;&#20204;&#24050;&#32463;&#32771;&#34385;&#20102;&#22914;&#20309;&#20351;&#29992;<tt class="literal">ProxyFactoryBean</tt>&#25110;&#32773;&#31867;&#20284;&#30340;&#24037;&#21378;bean&#26469;&#26174;&#24335;&#21019;&#24314;AOP&#20195;&#29702;&#12290;</p><p>Spring&#20063;&#20801;&#35768;&#25105;&#20204;&#20351;&#29992;&#8220;&#33258;&#21160;&#20195;&#29702;&#8221;&#30340;bean&#23450;&#20041;&#65292;&#21487;&#20197;&#33258;&#21160;&#23545;&#34987;&#36873;&#20013;&#30340;bean&#23450;&#20041;&#36827;&#34892;&#20195;&#29702;&#12290;
    &#36825;&#24314;&#31435;&#22312;Spring&#30340;&#8220;bean post processor&#8221;&#21151;&#33021;&#19978;&#65292;&#21518;&#32773;&#20801;&#35768;&#22312;&#23481;&#22120;&#21152;&#36733;&#26102;&#20462;&#25913;&#20219;&#20309;bean&#30340;&#23450;&#20041;&#12290;</p><p>&#22312;&#36825;&#20010;&#27169;&#22411;&#19979;&#65292;&#20320;&#22312;&#20320;&#30340;XML bean&#23450;&#20041;&#25991;&#20214;&#20013;&#24314;&#31435;&#19968;&#20123;&#29305;&#23450;&#30340;bean&#23450;&#20041;&#26469;&#37197;&#32622;&#33258;&#21160;&#20195;&#29702;&#21151;&#33021;&#12290;
    &#36825;&#20801;&#35768;&#20320;&#20165;&#20165;&#22768;&#26126;&#37027;&#20123;&#23558;&#34987;&#33258;&#21160;&#20195;&#29702;&#30340;&#36866;&#24403;&#30446;&#26631;&#65306;&#20320;&#19981;&#38656;&#35201;&#20351;&#29992;<tt class="literal">ProxyFactoryBean</tt>&#12290;</p><p>&#26377;&#20004;&#31181;&#26041;&#24335;&#21487;&#20197;&#20570;&#21040;&#36825;&#28857;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>&#20351;&#29992;&#19968;&#20010;&#24341;&#29992;&#24403;&#21069;&#19978;&#19979;&#25991;&#20013;&#29305;&#23450;bean&#30340;&#33258;&#21160;&#20195;&#29702;&#21019;&#24314;&#22120;&#12290;</p></li><li><p>&#19968;&#20010;&#19987;&#29992;&#33258;&#21160;&#20195;&#29702;&#30340;&#21019;&#24314;&#38656;&#35201;&#34987;&#21333;&#29420;&#32771;&#34385;&#65307;&#33258;&#21160;&#20195;&#29702;&#21019;&#24314;&#30001;&#28304;&#20195;&#30721;&#32423;&#21035;&#30340;&#20803;&#25968;&#25454;&#23646;&#24615;&#39537;&#21160;&#12290;</p></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-autoproxy-choices"></a>7.9.1.&nbsp;&#33258;&#21160;&#20195;&#29702;bean&#23450;&#20041;</h3></div></div><div></div></div><p><tt class="literal">org.springframework.aop.framework.autoproxy</tt>&#21253;&#25552;&#20379;&#20102;&#19979;&#21015;&#26631;&#20934;&#33258;&#21160;&#20195;&#29702;&#21019;&#24314;&#22120;&#12290;</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-api-autoproxy"></a>7.9.1.1.&nbsp;BeanNameAutoProxyCreator</h4></div></div><div></div></div><p>BeanNameAutoProxyCreator&#20026;&#21517;&#23383;&#21305;&#37197;&#23383;&#31526;&#20018;&#25110;&#32773;&#36890;&#37197;&#31526;&#30340;bean&#33258;&#21160;&#21019;&#24314;AOP&#20195;&#29702;&#12290;</p><p>
                </p><pre class="programlisting">&lt;bean class="org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator"&gt;
                    &lt;property name="beanNames"&gt;&lt;value&gt;jdk*,onlyJdk&lt;/value&gt;&lt;/property&gt;
                    &lt;property name="interceptorNames"&gt;
                    &lt;list&gt;
                    &lt;value&gt;myInterceptor&lt;/value&gt;
                    &lt;/list&gt;
                    &lt;/property&gt;
                &lt;/bean&gt;</pre><p>
            </p><p>&#21644;<tt class="literal">ProxyFactoryBean</tt>&#19968;&#26679;&#65292;&#36825;&#37324;&#26377;&#19968;&#20010;<tt class="literal">interceptorNames</tt>&#23646;&#24615;&#32780;&#19981;&#26159;&#19968;&#20010;&#25318;&#25130;&#22120;&#30340;&#21015;&#34920;&#65292;&#36825;&#20801;&#35768;&#20351;&#29992;&#21407;&#22411;&#65288;prototype&#65289;&#36890;&#30693;&#22120;&#12290;&#36825;&#37324;&#30340;&#8220;&#25318;&#25130;&#22120;&#8221;&#21487;&#20197;&#26159;&#36890;&#30693;&#22120;&#25110;&#20219;&#20309;&#36890;&#30693;&#31867;&#22411;&#12290;</p><p>&#19982;&#36890;&#24120;&#30340;&#33258;&#21160;&#20195;&#29702;&#19968;&#26679;&#65292;&#20351;&#29992;<tt class="literal">BeanNameAutoProxyCreator</tt>&#30340;&#20027;&#35201;&#30446;&#30340;&#26159;&#25226;&#30456;&#21516;&#30340;&#37197;&#32622;&#19968;&#33268;&#22320;&#24212;&#29992;&#21040;&#22810;&#20010;&#23545;&#35937;&#65292;
            &#24182;&#19988;&#20351;&#29992;&#26368;&#23569;&#37327;&#30340;&#37197;&#32622;&#12290;&#19968;&#20010;&#27969;&#34892;&#30340;&#36873;&#25321;&#26159;&#25226;&#22768;&#26126;&#24335;&#20107;&#21153;&#24212;&#29992;&#21040;&#22810;&#20010;&#23545;&#35937;&#19978;&#12290;</p><p>&#37027;&#20123;&#21517;&#23383;&#21305;&#37197;&#30340;Bean&#23450;&#20041;&#65292;&#20363;&#22914;&#19978;&#38754;&#30340;&#20363;&#23376;&#37324;&#30340;&#8220;jdkMyBean&#8221;&#21644;&#8220;onlyJdk&#8221;&#65292;&#26412;&#36523;&#21482;&#26159;&#30446;&#26631;&#31867;&#30340;&#26222;&#36890;bean&#23450;&#20041;&#12290;&#19968;&#20010;AOP&#23545;&#35937;&#23558;&#34987;<tt class="literal">BeanNameAutoProxyCreator</tt>&#33258;&#21160;&#21019;&#24314;&#12290;
            &#30456;&#21516;&#30340;&#36890;&#30693;&#23558;&#34987;&#24212;&#29992;&#21040;&#20840;&#37096;&#21305;&#37197;&#30340;bean&#19978;&#12290;&#27880;&#24847;&#22914;&#26524;&#36890;&#30693;&#22120;&#34987;&#20351;&#29992;&#65288;&#32780;&#19981;&#26159;&#20687;&#19978;&#38754;&#20363;&#23376;&#37324;&#37027;&#26679;&#20351;&#29992;&#25318;&#25130;&#22120;&#65289;&#65292;&#23545;&#20110;&#19981;&#21516;bean&#21487;&#20197;&#24212;&#29992;&#19981;&#21516;&#30340;&#20999;&#20837;&#28857;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-api-autoproxy-default"></a>7.9.1.2.&nbsp;DefaultAdvisorAutoProxyCreator</h4></div></div><div></div></div><p>&#19968;&#20010;&#26356;&#21152;&#36890;&#29992;&#32780;&#19988;&#24378;&#22823;&#24471;&#22810;&#30340;&#33258;&#21160;&#20195;&#29702;&#21019;&#24314;&#22120;&#26159;<tt class="literal">DefaultAdvisorAutoProxyCreator</tt>&#12290;&#23427;&#33258;&#21160;&#24212;&#29992;&#24403;&#21069;&#19978;&#19979;&#25991;&#20013;&#36866;&#24403;&#30340;&#36890;&#30693;&#22120;&#65292;&#26080;&#38656;&#22312;&#33258;&#21160;&#20195;&#29702;&#36890;&#30693;&#22120;&#30340;bean&#23450;&#20041;&#20013;&#21253;&#25324;bean&#30340;&#21517;&#23383;&#12290;
            &#27604;&#36215;<tt class="literal">BeanNameAutoProxyCreator</tt>&#65292;&#23427;&#25552;&#20379;&#20102;&#21516;&#26679;&#20851;&#20110;&#19968;&#33268;&#24615;&#37197;&#32622;&#30340;&#20248;&#28857;&#32780;&#36991;&#20813;&#20102;&#21069;&#32773;&#30340;&#37325;&#22797;&#24615;&#12290;</p><p>&#20351;&#29992;&#36825;&#20010;&#21151;&#33021;&#23558;&#28041;&#21450;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>Specifying a <tt class="literal">DefaultAdvisorAutoProxyCreator</tt> bean
                    definition.</p><p>&#35828;&#26126;&#19968;&#20010;
                    <tt class="literal">DefaultAdvisorAutoProxyCreator</tt>&#30340;bean&#23450;&#20041;</p></li><li><p>&#22312;&#21516;&#19968;&#20010;&#25110;&#32773;&#30456;&#20851;&#30340;&#19978;&#19979;&#25991;&#20013;&#35828;&#26126;&#20219;&#24847;&#25968;&#37327;&#30340;&#36890;&#30693;&#22120;&#12290;&#27880;&#24847;&#36825;&#20123;<span class="emphasis"><em>&#24517;&#39035;</em></span>&#26159;&#36890;&#30693;&#22120;&#32780;&#19981;&#20165;&#20165;&#26159;&#25318;&#25130;&#22120;&#25110;&#32773;&#20854;&#23427;&#36890;&#30693;&#12290;
                        &#36825;&#28857;&#26159;&#24517;&#35201;&#30340;&#22240;&#20026;&#24517;&#39035;&#26377;&#19968;&#20010;&#20999;&#20837;&#28857;&#34987;&#35780;&#20272;&#65292;&#20197;&#20415;&#26816;&#26597;&#27599;&#20010;&#36890;&#30693;&#20505;&#36873;bean&#23450;&#20041;&#30340;&#21512;&#36866;&#24615;&#12290;
                    </p></li></ul></div><p><tt class="literal">DefaultAdvisorAutoProxyCreator</tt>&#23558;&#33258;&#21160;&#35780;&#20272;&#21253;&#25324;&#22312;&#27599;&#20010;&#36890;&#30693;&#22120;&#20013;&#30340;&#20999;&#20837;&#28857;&#65292;
            &#26469;&#30475;&#30475;&#23427;&#24212;&#24403;&#24212;&#29992;&#21738;&#20010;&#65288;&#22914;&#26524;&#26377;&#30340;&#35805;&#65289;&#36890;&#30693;&#21040;&#27599;&#20010;&#19994;&#21153;&#23545;&#35937;&#65288;&#20363;&#22914;&#20363;&#23376;&#37324;&#30340;&#8220;businessObject1&#8221;&#21644;&#8220;businessObject2&#8221;&#65289;&#12290;</p><p>&#36825;&#24847;&#21619;&#30528;&#21487;&#20197;&#21521;&#27599;&#20010;&#19994;&#21153;&#23545;&#35937;&#24212;&#29992;&#20219;&#24847;&#25968;&#37327;&#30340;&#36890;&#30693;&#22120;&#12290;
            &#23545;&#20110;&#19968;&#20010;&#19994;&#21153;&#23545;&#35937;&#65292;&#22914;&#26524;&#25152;&#26377;&#36890;&#30693;&#22120;&#20013;&#30340;&#20999;&#20837;&#28857;&#37117;&#26080;&#27861;&#21305;&#37197;&#23427;&#30340;&#20219;&#24847;&#26041;&#27861;&#65292;&#36825;&#20010;&#23545;&#35937;&#23558;&#19981;&#20250;&#34987;&#20195;&#29702;&#12290;&#24403;&#20026;&#26032;&#30340;&#19994;&#21153;&#23545;&#35937;&#21152;&#20837;bean&#23450;&#20041;&#26102;&#65292;&#22914;&#26524;&#26377;&#24517;&#35201;&#23427;&#20204;&#23558;&#33258;&#21160;&#34987;&#20195;&#29702;&#12290;</p><p>&#36890;&#24120;&#33258;&#21160;&#20195;&#29702;&#30340;&#22909;&#22788;&#26159;&#23427;&#35753;&#35843;&#29992;&#32773;&#25110;&#32773;&#34987;&#20381;&#36182;&#23545;&#35937;&#19981;&#33021;&#24471;&#21040;&#19968;&#20010;&#27809;&#26377;&#36890;&#30693;&#36807;&#30340;&#23545;&#35937;&#12290;
                &#22312;&#36825;&#20010;ApplicationContext&#19978;&#35843;&#29992;getBean("businessObject1")&#23558;&#36820;&#22238;&#19968;&#20010;AOP&#20195;&#29702;&#65292;&#32780;&#19981;&#26159;&#30446;&#26631;&#19994;&#21153;&#23545;&#35937;&#12290;&#65288;&#21069;&#38754;&#26174;&#31034;&#30340;&#8220;&#20869;&#37096;bean&#8221;&#20063;&#25552;&#20379;&#20102;&#21516;&#26679;&#30340;&#20248;&#28857;&#12290;&#65289;
            </p><p>
                </p><pre class="programlisting">&lt;bean class="org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator"/&gt;
                    
                    &lt;bean class="org.springframework.transaction.interceptor.TransactionAttributeSourceAdvisor"&gt;
                    &lt;property name="transactionInterceptor" ref="transactionInterceptor"/&gt;
                    &lt;/bean&gt;
                    
                    &lt;bean id="customAdvisor" class="com.mycompany.MyAdvisor"/&gt;
                    
                    &lt;bean id="businessObject1" class="com.mycompany.BusinessObject1"&gt;
                    &lt;!-- Properties omitted --&gt;
                    &lt;/bean&gt;
                    
                    &lt;bean id="businessObject2" class="com.mycompany.BusinessObject2"/&gt;
                </pre><p>
            </p><p>&#22914;&#26524;&#20320;&#24819;&#35201;&#25226;&#30456;&#21516;&#30340;&#36890;&#30693;&#19968;&#33268;&#24615;&#22320;&#24212;&#29992;&#21040;&#35768;&#22810;&#19994;&#21153;&#23545;&#35937;&#19978;&#65292;<tt class="literal">DefaultAdvisorAutoProxyCreator</tt>&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#12290;
                &#19968;&#26086;&#26694;&#26550;&#30340;&#23450;&#20041;&#24050;&#32463;&#23436;&#25104;&#65292;&#20320;&#21487;&#20197;&#31616;&#21333;&#22320;&#21152;&#20837;&#26032;&#30340;&#19994;&#21153;&#23545;&#35937;&#32780;&#19981;&#24517;&#21253;&#25324;&#29305;&#23450;&#30340;&#20195;&#29702;&#37197;&#32622;&#12290;&#20320;&#20063;&#21487;&#20197;&#24456;&#23481;&#26131;&#30340;&#21435;&#25481;&#39069;&#22806;&#30340;&#20999;&#38754;--&#20363;&#22914;&#65292;&#36319;&#36394;&#25110;&#32773;&#24615;&#33021;&#30417;&#35270;&#20999;&#38754;--&#20165;&#20165;&#23545;&#37197;&#32622;&#20316;&#24456;&#23567;&#30340;&#20462;&#25913;&#12290;
            </p><p>DefaultAdvisorAutoProxyCreator&#25903;&#25345;&#36807;&#28388;&#65288;&#36890;&#36807;&#20351;&#29992;&#19968;&#20010;&#21629;&#21517;&#32422;&#23450;&#35753;&#21482;&#26377;&#29305;&#23450;&#30340;&#36890;&#30693;&#22120;&#34987;&#35780;&#20272;&#65292;&#20801;&#35768;&#22312;&#21516;&#19968;&#20010;&#24037;&#21378;&#37324;&#20351;&#29992;&#22810;&#20010;&#19981;&#21516;&#37197;&#32622;&#30340;AdvisorAutoProxyCreator&#65289;&#21644;&#25490;&#24207;&#12290;&#36890;&#30693;&#22120;&#21487;&#20197;&#23454;&#29616;<tt class="literal">org.springframework.core.Ordered</tt>&#25509;&#21475;&#26469;&#30830;&#20445;&#20197;&#27491;&#30830;&#30340;&#39034;&#24207;&#34987;&#24212;&#29992;&#12290;
                &#19978;&#38754;&#20363;&#23376;&#37324;&#30340;TransactionAttributeSourceAdvisor &#26377;&#19968;&#20010;&#21487;&#37197;&#32622;&#30340;&#24207;&#21495;&#20540;&#65307;&#32570;&#30465;&#24773;&#20917;&#19979;&#26159;&#27809;&#26377;&#25490;&#24207;&#30340;&#12290;
            </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-api-autoproxy-abstract"></a>7.9.1.3.&nbsp;AbstractAdvisorAutoProxyCreator</h4></div></div><div></div></div><p>&#36825;&#26159;DefaultAdvisorAutoProxyCreator&#30340;&#29238;&#31867;&#12290;&#22914;&#26524;&#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#26694;&#26550;&#25552;&#20379;&#30340;<tt class="literal">DefaultAdvisorAutoProxyCreator</tt>&#19981;&#33021;&#28385;&#36275;&#20320;&#30340;&#38656;&#35201;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;&#32487;&#25215;&#36825;&#20010;&#31867;&#26469;&#21019;&#24314;&#20320;&#33258;&#24049;&#30340;&#33258;&#21160;&#20195;&#29702;&#21019;&#24314;&#22120;&#12290;</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-autoproxy-metadata"></a>7.9.2.&nbsp;&#20351;&#29992;&#20803;&#25968;&#25454;&#39537;&#21160;&#30340;&#33258;&#21160;&#20195;&#29702;</h3></div></div><div></div></div><p>&#19968;&#20010;&#38750;&#24120;&#37325;&#35201;&#30340;&#33258;&#21160;&#20195;&#29702;&#31867;&#22411;&#26159;&#30001;&#20803;&#25968;&#25454;&#39537;&#21160;&#30340;&#12290;&#36825;&#25552;&#20379;&#20102;&#19968;&#31181;&#21644;.NET <tt class="literal">ServicedComponents</tt>&#30456;&#20284;&#30340;&#32534;&#31243;&#27169;&#22411;&#12290;
            &#20316;&#20026;&#20351;&#29992;&#31867;&#20284;EJB&#37324;&#30340;XML&#25551;&#36848;&#31526;&#30340;&#26367;&#20195;&#65292;&#23545;&#20110;&#20107;&#21153;&#31649;&#29702;&#21644;&#20854;&#23427;&#20225;&#19994;&#26381;&#21153;&#30340;&#37197;&#32622;&#37117;&#23558;&#34987;&#20445;&#23384;&#22312;&#28304;&#20195;&#30721;&#32423;&#21035;&#30340;&#23646;&#24615;&#37324;&#12290;
        </p><p>&#22312;&#36825;&#20010;&#24773;&#20917;&#19979;&#65292;&#20320;&#20351;&#29992;<tt class="literal">DefaultAdvisorAutoProxyCreator</tt>&#21644;&#21487;&#20197;&#29702;&#35299;&#20803;&#25968;&#25454;&#23646;&#24615;&#30340;&#36890;&#30693;&#22120;&#12290;
        &#20803;&#25968;&#25454;&#34987;&#20445;&#23384;&#22312;&#20505;&#36873;&#36890;&#30693;&#22120;&#30340;&#20999;&#20837;&#28857;&#37096;&#20998;&#20013;&#65292;&#32780;&#19981;&#26159;&#22312;&#33258;&#21160;&#20195;&#29702;&#21019;&#24314;&#31867;&#26412;&#36523;&#12290;</p><p>&#36825;&#26159;&#19968;&#20010;<tt class="literal">DefaultAdvisorAutoProxyCreator</tt>&#30340;&#29305;&#27530;&#20363;&#23376;&#65292;&#23427;&#26412;&#36523;&#27809;&#26377;&#20160;&#20040;&#29305;&#21035;&#12290;&#65288;&#20803;&#25968;&#25454;&#30340;&#30456;&#20851;&#20195;&#30721;&#20445;&#23384;&#22312;&#36890;&#30693;&#22120;&#30340;&#20999;&#20837;&#28857;&#37324;&#65292;&#32780;&#19981;&#26159;AOP&#26694;&#26550;&#37324;&#65289;&#12290; </p><p>JPetStore&#31034;&#20363;&#24212;&#29992;&#31243;&#24207;&#30340;<tt class="literal">/attributes</tt> &#30446;&#24405;&#26174;&#31034;&#20102;&#22914;&#20309;&#20351;&#29992;&#21442;&#25968;&#39537;&#21160;&#30340;&#33258;&#21160;&#20195;&#29702;&#12290;&#22312;&#36825;&#20010;&#20363;&#23376;&#37324;&#65292;&#19981;&#38656;&#35201;&#20351;&#29992;<tt class="literal">TransactionProxyFactoryBean</tt>&#12290;&#22240;&#20026;&#20351;&#29992;&#20102;&#20803;&#25968;&#25454;&#30456;&#20851;&#30340;&#20999;&#20837;&#28857;&#65292;
        &#25152;&#20197;&#31616;&#21333;&#22312;&#19994;&#21153;&#23545;&#35937;&#19978;&#23450;&#20041;&#20107;&#21153;&#23646;&#24615;&#23601;&#36275;&#22815;&#20102;&#12290;&#22312;<tt class="literal">/WEB-INF/declarativeServices.xml</tt>&#37324;&#30340;bean&#23450;&#20041;&#21253;&#25324;&#20102;&#19979;&#38754;&#30340;&#29255;&#26029;&#65292;&#27880;&#24847;&#36825;&#26159;&#36890;&#29992;&#30340;&#65292;&#21487;&#20197;&#34987;&#29992;&#22312;JPetStore&#20197;&#22806;&#30340;&#22320;&#26041;&#65306;</p><p>
            </p><pre class="programlisting">&lt;bean class="org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator"/&gt;
                
                &lt;bean class="org.springframework.transaction.interceptor.TransactionAttributeSourceAdvisor"&gt;
                &lt;property name="transactionInterceptor" ref="transactionInterceptor"/&gt;
                &lt;/bean&gt;
                
                &lt;bean id="transactionInterceptor"
                class="org.springframework.transaction.interceptor.TransactionInterceptor"&gt;
                &lt;property name="transactionManager" ref="transactionManager"/&gt;
                &lt;property name="transactionAttributeSource"&gt;
                &lt;bean class="org.springframework.transaction.interceptor.AttributesTransactionAttributeSource"&gt;
                &lt;property name="attributes" ref="attributes"/&gt;
                &lt;/bean&gt;
                &lt;/property&gt;
                &lt;/bean&gt;
                
            &lt;bean id="attributes" class="org.springframework.metadata.commons.CommonsAttributes"/&gt;</pre><p>
        </p><p><tt class="literal">DefaultAdvisorAutoProxyCreator</tt> bean&#23450;&#20041;&#65288;&#21517;&#23383;&#26159;&#19981;&#37325;&#35201;&#30340;&#65292;&#22240;&#27492;&#29978;&#33267;&#21487;&#20197;&#22312;&#23450;&#20041;&#37324;&#30465;&#30053;&#23427;&#65289;&#23558;&#22312;&#24403;&#21069;&#24212;&#29992;&#31243;&#24207;&#19978;&#19979;&#25991;&#20013;&#26597;&#25214;&#25152;&#26377;&#21512;&#36866;&#30340;&#20999;&#20837;&#28857;&#12290;&#22312;&#36825;&#20010;&#20363;&#23376;&#37324;&#65292;<tt class="literal">TransactionAttributeSourceAdvisor</tt>&#31867;&#22411;&#30340;&#8220;transactionAdvisor&#8221;bean&#23450;&#20041;&#23558;&#24212;&#29992;&#21040;&#24102;&#26377;&#19968;&#20010;&#20107;&#21153;&#23646;&#24615;&#30340;&#31867;&#25110;&#26041;&#27861;&#19978;&#12290;
            TransactionAttributeSourceAdvisor&#30340;&#26500;&#36896;&#22120;&#20381;&#36182;&#20110;&#19968;&#20010;TransactionInterceptor&#12290;&#36825;&#20010;&#20363;&#23376;&#37324;&#36890;&#36807;&#33258;&#21160;&#32455;&#20837;&#35299;&#20915;&#20102;&#36825;&#20010;&#38382;&#39064;&#12290;<tt class="literal">AttributesTransactionAttributeSource</tt>&#20381;&#36182;&#20110;&#19968;&#20010;<tt class="literal">org.springframework.metadata.Attributes</tt>&#25509;&#21475;&#30340;&#23454;&#29616;&#12290;
            &#22312;&#36825;&#20010;&#20195;&#30721;&#29255;&#26029;&#37324;&#65292;&#8220;attributes&#8221;bean&#20351;&#29992;Jakarta Commons Attributes API&#26469;&#33719;&#21462;&#23646;&#24615;&#20449;&#24687;&#20197;&#28385;&#36275;&#36825;&#20010;&#35201;&#27714;&#12290;&#65288;&#24212;&#29992;&#31243;&#24207;&#20195;&#30721;&#24517;&#39035;&#24050;&#32463;&#20351;&#29992;Commons Attribut&#26469;es&#30340;&#32534;&#35793;&#20219;&#21153;&#32534;&#35793;&#36807;&#20102;&#12290;&#65289;
        </p><p>JPetStore&#31034;&#20363;&#24212;&#29992;&#31243;&#24207;&#30340; <tt class="literal">/annotation</tt> &#30446;&#24405;&#21253;&#25324;&#20102;&#19968;&#20010;&#30001;JDK 1.5+&#27880;&#35299;&#39537;&#21160;&#30340;&#33258;&#21160;&#20195;&#29702;&#30340;&#27169;&#25311;&#20363;&#23376;&#12290;
            &#19979;&#38754;&#30340;&#37197;&#32622;&#20801;&#35768;&#33258;&#21160;&#26816;&#27979;Spring&#30340;<tt class="literal">Transactional</tt>&#27880;&#35299;&#65292;&#36825;&#21487;&#20197;&#20026;&#21253;&#21547;&#27880;&#35299;&#30340;bean&#25552;&#20379;&#38544;&#24335;&#20195;&#29702;&#65306;
        </p><p>
            </p><pre class="programlisting">&lt;bean class="org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator"/&gt;
                
                &lt;bean class="org.springframework.transaction.interceptor.TransactionAttributeSourceAdvisor"&gt;
                &lt;property name="transactionInterceptor" ref="transactionInterceptor"/&gt;
                &lt;/bean&gt;
                
                &lt;bean id="transactionInterceptor"
                class="org.springframework.transaction.interceptor.TransactionInterceptor"&gt;
                &lt;property name="transactionManager" ref="transactionManager"/&gt;
                &lt;property name="transactionAttributeSource"&gt;
                &lt;bean class="org.springframework.transaction.annotation.AnnotationTransactionAttributeSource"/&gt;
                &lt;/property&gt;
            &lt;/bean&gt;</pre><p>
        </p><p>&#36825;&#37324;&#23450;&#20041;&#30340;<tt class="literal">TransactionInterceptor</tt>&#20381;&#36182;&#20110;&#19968;&#20010;<tt class="literal">PlatformTransactionManager</tt>&#23450;&#20041;&#65292;
            &#21518;&#32773;&#27809;&#26377;&#34987;&#21253;&#25324;&#22312;&#36825;&#20010;&#36890;&#29992;&#30340;&#25991;&#20214;&#37324;&#65288;&#34429;&#28982;&#23427;&#21487;&#20197;&#34987;&#21253;&#25324;&#22312;&#36825;&#37324;&#65289;&#22240;&#20026;&#23427;&#22312;&#24212;&#29992;&#31243;&#24207;&#30340;&#20107;&#21153;&#38656;&#27714;&#35268;&#33539;&#20013;&#25351;&#23450;&#65288;&#22312;&#36825;&#20010;&#20363;&#23376;&#37324;&#20351;&#29992;JTA&#65292;&#32780;&#22312;&#20854;&#23427;&#24773;&#20917;&#19979;&#65292;&#21487;&#20197;&#26159;Hibernate&#65292;JDO&#25110;&#32773;JDBC&#65289;&#65306;
        </p><pre class="programlisting">&lt;bean id="transactionManager" 
        class="org.springframework.transaction.jta.JtaTransactionManager"/&gt;</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="http://shouce.jb51.net/images/admons/tip.png"></td><th align="left">Tip</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#22914;&#26524;&#20320;&#21482;&#38656;&#35201;&#22768;&#26126;&#24335;&#20107;&#21153;&#31649;&#29702;&#65292;&#20351;&#29992;&#36825;&#20123;&#36890;&#29992;&#30340;XML&#23450;&#20041;&#23558;&#23548;&#33268;Spring&#33258;&#21160;&#20195;&#29702;&#25152;&#26377;&#24102;&#26377;&#20107;&#21153;&#23646;&#24615;&#30340;&#31867;&#25110;&#32773;&#26041;&#27861;&#12290;&#20320;&#23558;&#19981;&#38656;&#35201;&#30452;&#25509;&#20351;&#29992;AOP&#24037;&#20316;&#65292;
            &#36825;&#20010;&#32534;&#31243;&#27169;&#22411;&#21644;.NET&#30340;ServicedComponents&#30456;&#20284;&#12290;</p></td></tr></table></div><p>&#36825;&#20010;&#26550;&#26500;&#26159;&#21487;&#20197;&#25193;&#23637;&#30340;&#12290;&#21487;&#20197;&#22312;&#33258;&#23450;&#20041;&#23646;&#24615;&#30340;&#22522;&#30784;&#19978;&#36827;&#34892;&#33258;&#21160;&#20195;&#29702;&#12290;&#20320;&#25152;&#38656;&#35201;&#20570;&#30340;&#26159;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>&#23450;&#20041;&#20320;&#33258;&#24049;&#30340;&#33258;&#23450;&#20041;&#23646;&#24615;</p></li><li><p>&#20351;&#29992;&#24517;&#35201;&#30340;&#36890;&#30693;&#35828;&#26126;&#19968;&#20010;&#36890;&#30693;&#22120;&#65292;&#20063;&#21253;&#25324;&#19968;&#20010;&#20999;&#20837;&#28857;&#65292;&#21518;&#32773;&#21487;&#20197;&#34987;&#31867;&#25110;&#32773;&#26041;&#27861;&#19978;&#30340;&#33258;&#23450;&#20041;&#23646;&#24615;&#35302;&#21457;&#12290;
                    &#20320;&#20063;&#35768;&#33021;&#22815;&#20351;&#29992;&#24050;&#26377;&#30340;&#36890;&#30693;&#65292;&#32780;&#20165;&#20165;&#23454;&#29616;&#19968;&#20010;&#33021;&#22815;&#22788;&#29702;&#33258;&#23450;&#20041;&#23646;&#24615;&#30340;&#38745;&#24577;&#20999;&#20837;&#28857;&#12290;
                </p></li></ul></div><p>&#21487;&#20197;&#35753;&#36825;&#20123;&#36890;&#30693;&#22120;&#23545;&#20110;&#27599;&#20010;&#34987;&#36890;&#30693;&#23545;&#35937;&#65288;&#20363;&#22914;&#65292;mixins&#65289;&#37117;&#26159;&#21807;&#19968;&#30340;&#65306;&#20165;&#20165;&#38656;&#35201;&#22312;bean&#23450;&#20041;&#20013;&#34987;&#23450;&#20041;&#20026;&#21407;&#22411;&#32780;&#19981;&#26159;&#21333;&#20363;&#12290;
            &#20363;&#22914;&#65292;&#22312;&#19978;&#38754;&#25152;&#26174;&#31034;&#30340;Spring&#27979;&#35797;&#38598;&#20013;&#30340;<tt class="literal">LockMixin</tt>&#24341;&#20837;&#25318;&#25130;&#22120;&#21487;&#20197;&#21644;&#19968;&#20010;&#23646;&#24615;&#39537;&#21160;&#30340;&#20999;&#20837;&#28857;&#32852;&#21512;&#23450;&#20301;&#19968;&#20010;mixin&#65292;
            &#20687;&#36825;&#37324;&#26174;&#31034;&#30340;&#36825;&#26679;&#12290;&#25105;&#20204;&#20351;&#29992;&#36890;&#29992;&#30340;<tt class="literal">DefaultPointcutAdvisor</tt>&#65292;&#20351;&#29992;JavaBean&#23646;&#24615;&#36827;&#34892;&#37197;&#32622;&#65306;
        </p><p>
            </p><pre class="programlisting">&lt;bean id="lockMixin" class="org.springframework.aop.LockMixin"
                scope="prototype"/&gt;
                
                &lt;bean id="lockableAdvisor" class="org.springframework.aop.support.DefaultPointcutAdvisor"
                scope="prototype"&gt;
                &lt;property name="pointcut" ref="myAttributeAwarePointcut"/&gt;
                &lt;property name="advice" ref="lockMixin"/&gt;
                &lt;/bean&gt;
                
            &lt;bean id="anyBean" class="anyclass" ...</pre><p>
        </p><p>&#22914;&#26524;&#21442;&#25968;&#30456;&#20851;&#30340;&#20999;&#20837;&#28857;&#21305;&#37197;<tt class="literal">anyBean</tt>&#25110;&#20854;&#23427;bean&#23450;&#20041;&#37324;&#30340;&#20219;&#20309;&#26041;&#27861;&#65292;mixin&#23558;&#34987;&#24212;&#29992;&#12290;
            &#27880;&#24847;<tt class="literal">lockMixin</tt>&#21644;<tt class="literal">lockableAdvisor</tt>&#30340;&#23450;&#20041;&#37117;&#26159;&#21407;&#22411;&#12290;
            <tt class="literal">myAttributeAwarePointcut</tt>&#20999;&#20837;&#28857;&#21487;&#20197;&#26159;&#20010;&#21333;&#20363;&#65292;&#22240;&#20026;&#23427;&#27809;&#26377;&#20026;&#21333;&#20010;&#34987;&#36890;&#30693;&#23545;&#35937;&#20445;&#25345;&#29366;&#24577;&#12290;
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-targetsource"></a>7.10.&nbsp;&#20351;&#29992;TargetSource</h2></div></div><div></div></div><p>Spring&#25552;&#20379;&#20102;<span class="emphasis"><em>TargetSource</em></span>&#30340;&#27010;&#24565;&#65292;&#30001;<tt class="literal">org.springframework.aop.TargetSource</tt>&#25509;&#21475;&#36827;&#34892;&#25551;&#36848;&#12290;
        &#36825;&#20010;&#25509;&#21475;&#36127;&#36131;&#36820;&#22238;&#19968;&#20010;&#23454;&#29616;&#36830;&#25509;&#28857;&#30340;&#8220;&#30446;&#26631;&#23545;&#35937;&#65288;target object&#65289;&#8221;&#12290;&#27599;&#24403;AOP&#20195;&#29702;&#22788;&#29702;&#19968;&#20010;&#26041;&#27861;&#35843;&#29992;&#26102;&#37117;&#20250;&#21521;<tt class="literal">TargetSource</tt>&#30340;&#23454;&#29616;&#35831;&#27714;&#19968;&#20010;&#30446;&#26631;&#23454;&#20363;&#12290;
    </p><p>&#20351;&#29992;Spring AOP&#30340;&#24320;&#21457;&#32773;&#36890;&#24120;&#19981;&#38656;&#35201;&#30452;&#25509;&#21644;TargetSource&#25171;&#20132;&#36947;&#65292;&#20294;&#36825;&#25552;&#20379;&#20102;&#19968;&#31181;&#24378;&#22823;&#30340;&#26041;&#24335;&#26469;&#25903;&#25345;&#27744;&#21270;&#65288;pooling&#65289;&#65292;&#28909;&#20132;&#25442;&#65288;hot swappable&#65289;&#21644;&#20854;&#23427;&#39640;&#32423;&#30446;&#26631;&#12290;
        &#20363;&#22914;&#65292;&#19968;&#20010;&#20351;&#29992;&#27744;&#26469;&#31649;&#29702;&#23454;&#20363;&#30340;TargetSource&#21487;&#20197;&#20026;&#27599;&#20010;&#35843;&#29992;&#36820;&#22238;&#19968;&#20010;&#19981;&#21516;&#30340;&#30446;&#26631;&#23454;&#20363;&#12290;
    </p><p>&#22914;&#26524;&#20320;&#19981;&#25351;&#23450;&#19968;&#20010;TargetSource&#65292;&#19968;&#20010;&#32570;&#30465;&#23454;&#29616;&#23558;&#34987;&#20351;&#29992;&#65292;&#23427;&#21253;&#35013;&#19968;&#20010;&#26412;&#22320;&#23545;&#35937;&#12290;&#23545;&#20110;&#27599;&#27425;&#35843;&#29992;&#23427;&#23558;&#36820;&#22238;&#30456;&#21516;&#30340;&#30446;&#26631;&#65288;&#20687;&#20320;&#26399;&#26395;&#30340;&#37027;&#26679;&#65289;&#12290;</p><p>&#35753;&#25105;&#20204;&#30475;&#30475;Spring&#25552;&#20379;&#30340;&#26631;&#20934;&#30446;&#26631;&#28304;&#65288;target source&#65289;&#20197;&#21450;&#22914;&#20309;&#20351;&#29992;&#23427;&#20204;&#12290;</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="http://shouce.jb51.net/images/admons/tip.png"></td><th align="left">Tip</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#24403;&#20351;&#29992;&#19968;&#20010;&#33258;&#23450;&#20041;&#30340;&#30446;&#26631;&#28304;&#65292;&#20320;&#30340;&#30446;&#26631;&#36890;&#24120;&#38656;&#35201;&#26159;&#19968;&#20010;&#21407;&#22411;&#32780;&#19981;&#26159;&#19968;&#20010;&#21333;&#20363;&#30340;bean&#23450;&#20041;&#12290;&#36825;&#20801;&#35768;Spring&#22312;&#24517;&#35201;&#26102;&#21019;&#24314;&#26032;&#30340;&#30446;&#26631;&#23454;&#20363;&#12290;</p></td></tr></table></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-ts-swap"></a>7.10.1.&nbsp;&#28909;&#20132;&#25442;&#30446;&#26631;&#28304;</h3></div></div><div></div></div><p><tt class="literal">org.springframework.aop.target.HotSwappableTargetSource</tt>&#20801;&#35768;&#24403;&#35843;&#29992;&#32773;&#20445;&#25345;&#24341;&#29992;&#30340;&#26102;&#20505;&#65292;&#20999;&#25442;&#19968;&#20010;AOP&#20195;&#29702;&#30340;&#30446;&#26631;&#12290;
        </p><p>&#20462;&#25913;&#30446;&#26631;&#28304;&#30340;&#30446;&#26631;&#23558;&#31435;&#21363;&#29983;&#25928;&#12290;
        <tt class="literal">HotSwappableTargetSource</tt>&#26159;&#32447;&#31243;&#23433;&#20840;&#30340;&#12290;</p><p>&#20320;&#21487;&#20197;&#36890;&#36807;HotSwappableTargetSource&#30340; <tt class="literal">swap()</tt>&#26041;&#27861;&#26469;&#25913;&#21464;&#30446;&#26631;&#65292;&#23601;&#20687;&#19979;&#38754;&#37027;&#26679;&#65306;
        </p><p>
            </p><pre class="programlisting">HotSwappableTargetSource swapper = 
                (HotSwappableTargetSource) beanFactory.getBean("swapper");
            Object oldTarget = swapper.swap(newTarget);</pre><p>
        </p><p>&#25152;&#38656;&#30340;XML&#23450;&#20041;&#30475;&#36215;&#26469;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;</p><p>
            </p><pre class="programlisting">&lt;bean id="initialTarget" class="mycompany.OldTarget"/&gt;
                
                &lt;bean id="swapper" class="org.springframework.aop.target.HotSwappableTargetSource"&gt;
                &lt;constructor-arg ref="initialTarget"/&gt;
                &lt;/bean&gt;
                
                &lt;bean id="swappable" class="org.springframework.aop.framework.ProxyFactoryBean"&gt;
                &lt;property name="targetSource" ref="swapper"/&gt;
            &lt;/bean&gt;</pre><p>
        </p><p>&#19978;&#38754;&#30340;<tt class="literal">swap()</tt>&#35843;&#29992;&#20462;&#25913;&#20102;swappable bean&#30340;&#30446;&#26631;&#12290;&#20445;&#25345;&#23545;&#36825;&#20010;bean&#30340;&#24341;&#29992;&#30340;&#23458;&#25143;&#23558;&#19981;&#30693;&#36947;&#21457;&#29983;&#20102;&#36825;&#20010;&#20462;&#25913;&#65292;&#20294;&#26159;&#23558;&#21487;&#20197;&#31435;&#21363;&#28857;&#20987;&#26032;&#30340;&#30446;&#26631;&#12290;</p><p>&#36825;&#20010;&#20363;&#23376;&#27809;&#26377;&#28155;&#21152;&#20219;&#20309;&#36890;&#30693;--&#20063;&#19981;&#24517;&#20026;&#20351;&#29992;&#19968;&#20010;<tt class="literal">TargetSource</tt>&#28155;&#21152;&#20219;&#20309;&#36890;&#30693;--&#24403;&#28982;&#20219;&#20309;<tt class="literal">TargetSource</tt>&#37117;&#21487;&#20197;&#19982;&#20219;&#24847;&#36890;&#30693;&#32852;&#21512;&#20351;&#29992;&#12290;
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-ts-pool"></a>7.10.2.&nbsp;&#27744;&#21270;&#30446;&#26631;&#28304;</h3></div></div><div></div></div><p>&#20351;&#29992;&#19968;&#20010;&#27744;&#21270;&#30446;&#26631;&#28304;&#25552;&#20379;&#20102;&#21644;&#26080;&#29366;&#24577;session EJB&#31867;&#20284;&#30340;&#32534;&#31243;&#27169;&#22411;&#65292;&#23427;&#32500;&#25252;&#19968;&#20010;&#21253;&#25324;&#30456;&#21516;&#23454;&#20363;&#30340;&#27744;&#65292;&#26041;&#27861;&#35843;&#29992;&#32467;&#26463;&#21518;&#23558;&#25226;&#23545;&#35937;&#37322;&#25918;&#22238;&#27744;&#20013;&#12290;</p><p>Spring&#27744;&#21270;&#21644;SLSB&#27744;&#21270;&#20043;&#38388;&#30340;&#19968;&#20010;&#20915;&#23450;&#24615;&#21306;&#21035;&#26159;Spring&#27744;&#21270;&#21151;&#33021;&#21487;&#20197;&#29992;&#20110;&#20219;&#20309;POJO&#12290;&#23601;&#20687;Spring&#36890;&#24120;&#24773;&#20917;&#19979;&#37027;&#26679;&#65292;&#36825;&#20010;&#26381;&#21153;&#26159;&#38750;&#20405;&#20837;&#24335;&#30340;&#12290;</p><p>Spring&#23545;Jakarta Commons Pool 1.3&#25552;&#20379;&#20102;&#24320;&#31665;&#21363;&#29992;&#30340;&#25903;&#25345;&#65292;&#21518;&#32773;&#25552;&#20379;&#20102;&#19968;&#20010;&#30456;&#24403;&#26377;&#25928;&#30340;&#27744;&#21270;&#23454;&#29616;&#12290;&#35201;&#20351;&#29992;&#36825;&#20010;&#29305;&#24615;&#65292;&#20320;&#38656;&#35201;&#22312;&#24212;&#29992;&#31243;&#24207;&#36335;&#24452;&#20013;&#23384;&#22312;commons-pool&#30340;Jar&#25991;&#20214;&#12290;
            &#20063;&#21487;&#20197;&#36890;&#36807;&#32487;&#25215;<tt class="literal">org.springframework.aop.target.AbstractPoolingTargetSource</tt>&#26469;&#25903;&#25345;&#20854;&#23427;&#30340;&#27744;&#21270;API&#12290;
        </p><p>&#19979;&#38754;&#26159;&#31034;&#20363;&#37197;&#32622;&#65306;</p><p>
            </p><pre class="programlisting">&lt;bean id="businessObjectTarget" class="com.mycompany.MyBusinessObject" 
                scope="prototype"&gt;
                ... properties omitted
                &lt;/bean&gt;
                
                &lt;bean id="poolTargetSource" class="org.springframework.aop.target.CommonsPoolTargetSource"&gt;
                &lt;property name="targetBeanName" value="businessObjectTarget"/&gt;
                &lt;property name="maxSize" value="25"/&gt;
                &lt;/bean&gt;
                
                &lt;bean id="businessObject" class="org.springframework.aop.framework.ProxyFactoryBean"&gt;
                &lt;property name="targetSource" ref="poolTargetSource"/&gt;
                &lt;property name="interceptorNames" value="myInterceptor"/&gt;
            &lt;/bean&gt;</pre><p>
        </p><p>&#27880;&#24847;&#30446;&#26631;&#23545;&#35937;--&#20363;&#23376;&#37324;&#30340;&#8220;businessObjectTarget&#8221;--<span class="emphasis"><em>&#24517;&#39035;</em></span>&#26159;&#20010;&#21407;&#22411;&#12290;
            &#36825;&#20801;&#35768;<tt class="literal">PoolingTargetSource</tt>&#30340;&#23454;&#29616;&#22312;&#24517;&#35201;&#26102;&#20026;&#30446;&#26631;&#21019;&#24314;&#26032;&#30340;&#23454;&#20363;&#26469;&#22686;&#22823;&#27744;&#30340;&#23481;&#37327;&#12290;
            &#26597;&#30475;<tt class="literal">AbstractPoolingTargetSource</tt>&#21644;&#20320;&#24819;&#35201;&#20351;&#29992;&#30340;&#20855;&#20307;&#23376;&#31867;&#30340;Javadoc&#33719;&#21462;&#26356;&#22810;&#20851;&#20110;&#23427;&#23646;&#24615;&#30340;&#20449;&#24687;&#65306;maxSize&#26159;&#26368;&#22522;&#30784;&#30340;&#65292;&#32780;&#19988;&#27704;&#36828;&#37117;&#35201;&#27714;&#34987;&#25552;&#20379;&#12290;
        </p><p>&#22312;&#36825;&#20010;&#20363;&#23376;&#37324;&#65292;&#8220;myInterceptor&#8221;&#26159;&#19968;&#20010;&#25318;&#25130;&#22120;&#30340;&#21517;&#23383;&#65292;&#36825;&#20010;&#25318;&#25130;&#22120;&#38656;&#35201;&#22312;&#21516;&#19968;&#20010;IoC&#19978;&#19979;&#25991;&#20013;&#34987;&#23450;&#20041;&#12290;&#28982;&#32780;&#65292;&#23450;&#20041;&#23545;&#25318;&#25130;&#22120;&#36827;&#34892;&#27744;&#21270;&#26159;&#19981;&#24517;&#35201;&#30340;&#12290;
            &#22914;&#26524;&#20320;&#24819;&#35201;&#30340;&#21482;&#26159;&#27744;&#21270;&#32780;&#27809;&#26377;&#20854;&#23427;&#36890;&#30693;&#65292;&#23601;&#19981;&#35201;&#35774;&#32622;interceptorNames&#23646;&#24615;&#12290;
        </p><p>&#21487;&#20197;&#37197;&#32622;Spring&#26469;&#25226;&#20219;&#20309;&#34987;&#27744;&#21270;&#23545;&#35937;&#36716;&#22411;&#21040;<tt class="literal">org.springframework.aop.target.PoolingConfig</tt>&#25509;&#21475;&#65292;
            &#36825;&#36890;&#36807;&#19968;&#20010;introduction&#26292;&#38706;&#37197;&#32622;&#20197;&#21450;&#24403;&#21069;&#27744;&#30340;&#22823;&#23567;&#12290;&#20320;&#38656;&#35201;&#20687;&#36825;&#26679;&#23450;&#20041;&#19968;&#20010;&#36890;&#30693;&#22120;&#65306;
        </p><p>
            </p><pre class="programlisting">&lt;bean id="poolConfigAdvisor" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean"&gt;
                &lt;property name="targetObject" ref="poolTargetSource"/&gt;
                &lt;property name="targetMethod" value="getPoolingConfigMixin"/&gt;
            &lt;/bean&gt;</pre><p>
        </p><p>&#36825;&#20010;&#36890;&#30693;&#22120;&#21487;&#20197;&#36890;&#36807;&#35843;&#29992;<tt class="literal">AbstractPoolingTargetSource</tt>&#31867;&#19978;&#30340;&#19968;&#20010;&#26041;&#20415;&#30340;&#26041;&#27861;&#26469;&#33719;&#24471;&#65292;&#22240;&#27492;&#36825;&#37324;&#20351;&#29992;MethodInvokingFactoryBean&#12290;
            &#36825;&#20010;&#36890;&#30693;&#22120;&#21517;&#65288;&#36825;&#37324;&#26159;&#8220;poolConfigAdvisor&#8221;&#65289;&#24517;&#39035;&#22312;&#25552;&#20379;&#34987;&#27744;&#21270;&#23545;&#35937;&#30340;ProxyFactoryBean&#37324;&#30340;&#25318;&#25130;&#22120;&#21517;&#21015;&#34920;&#37324;&#20013;&#12290;
        </p><p>&#36716;&#22411;&#30475;&#36215;&#26469;&#20687;&#36825;&#26679;&#65306;</p><pre class="programlisting">PoolingConfig conf = (PoolingConfig) beanFactory.getBean("businessObject");
        System.out.println("Max pool size is " + conf.getMaxSize());</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#27744;&#21270;&#26080;&#29366;&#24577;&#26381;&#21153;&#23545;&#35937;&#36890;&#24120;&#26159;&#19981;&#24517;&#35201;&#30340;&#12290;&#25105;&#20204;&#19981;&#35748;&#20026;&#36825;&#65288;&#27744;&#21270;&#65289;&#24212;&#24403;&#26159;&#32570;&#30465;&#30340;&#36873;&#25321;&#65292;&#22240;&#20026;&#22810;&#25968;&#26080;&#29366;&#24577;&#23545;&#35937;&#26159;&#20808;&#22825;&#32447;&#31243;&#23433;&#20840;&#30340;&#65292;&#22914;&#26524;&#36164;&#28304;&#34987;&#32531;&#23384;&#65292;&#37027;&#20040;&#23545;&#23454;&#20363;&#36827;&#34892;&#27744;&#21270;&#20250;&#24341;&#36215;&#24456;&#22810;&#38382;&#39064;&#12290;</p></td></tr></table></div><p>&#20351;&#29992;&#33258;&#21160;&#20195;&#29702;&#26102;&#27744;&#21270;&#26356;&#21152;&#31616;&#21333;&#12290;&#21487;&#20197;&#20026;&#20219;&#20309;&#33258;&#21160;&#20195;&#29702;&#21019;&#24314;&#22120;&#35774;&#32622;&#25152;&#20351;&#29992;&#30340;TargetSource</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-ts-prototype"></a>7.10.3.&nbsp;&#21407;&#22411;&#30446;&#26631;&#28304;</h3></div></div><div></div></div><p>&#24314;&#31435;&#19968;&#20010;&#8220;&#21407;&#22411;&#8221;&#30446;&#26631;&#28304;&#21644;&#27744;&#21270;TargetSource&#24456;&#30456;&#20284;&#12290;&#22312;&#36825;&#20010;&#20363;&#23376;&#37324;&#65292;&#24403;&#27599;&#27425;&#26041;&#27861;&#35843;&#29992;&#26102;&#65292;&#23558;&#21019;&#24314;&#19968;&#20010;&#30446;&#26631;&#30340;&#26032;&#23454;&#20363;&#12290;
        &#34429;&#28982;&#22312;&#26032;&#29256;&#26412;&#30340;JVM&#20013;&#21019;&#24314;&#19968;&#20010;&#26032;&#23545;&#35937;&#30340;&#20195;&#20215;&#24182;&#19981;&#39640;&#65292;&#20294;&#26159;&#25226;&#26032;&#23545;&#35937;&#32455;&#20837;&#65288;&#28385;&#36275;&#23427;&#30340;IoC&#20381;&#36182;&#65289;&#21487;&#33021;&#26159;&#24456;&#26114;&#36149;&#30340;&#12290;&#22240;&#27492;&#22914;&#26524;&#27809;&#26377;&#24456;&#22909;&#30340;&#29702;&#30001;&#65292;&#20320;&#19981;&#24212;&#35813;&#20351;&#29992;&#36825;&#20010;&#26041;&#27861;&#12290;</p><p>&#20026;&#20102;&#20570;&#21040;&#36825;&#28857;&#65292;&#20320;&#21487;&#20197;&#25226;&#19978;&#38754;&#30340;<tt class="literal">poolTargetSource</tt>&#23450;&#20041;&#20462;&#25913;&#25104;&#19979;&#38754;&#30340;&#24418;&#24335;&#12290;&#65288;&#20026;&#20102;&#28165;&#26970;&#35828;&#26126;&#65292;&#20462;&#25913;&#20102;bean&#30340;&#21517;&#23383;&#12290;&#65289; </p><pre class="programlisting">&lt;bean id="prototypeTargetSource" class="org.springframework.aop.target.PrototypeTargetSource"&gt;
  &lt;property name="targetBeanName" ref="businessObjectTarget"/&gt;
        &lt;/bean&gt;</pre><p>&#36825;&#37324;&#21482;&#26377;&#19968;&#20010;&#23646;&#24615;&#65306;&#30446;&#26631;bean&#30340;&#21517;&#23383;&#12290;TargetSource&#30340;&#23454;&#29616;&#20351;&#29992;&#32487;&#25215;&#26469;&#30830;&#20445;&#21629;&#21517;&#30340;&#19968;&#33268;&#24615;&#12290;&#23601;&#20687;&#27744;&#21270;&#30446;&#26631;&#28304;&#37027;&#26679;&#65292;&#30446;&#26631;bean&#24517;&#39035;&#26159;&#19968;&#20010;&#21407;&#22411;&#30340;bean&#23450;&#20041;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-ts-threadlocal"></a>7.10.4.&nbsp;<tt class="classname">ThreadLocal</tt>&#30446;&#26631;&#28304;</h3></div></div><div></div></div><p>&#22914;&#26524;&#20320;&#38656;&#35201;&#20026;&#27599;&#20010;&#36827;&#26469;&#30340;&#35831;&#27714;&#65288;&#21363;&#27599;&#20010;&#32447;&#31243;&#65289;&#21019;&#24314;&#19968;&#20010;&#23545;&#35937;&#65292;<tt class="classname">ThreadLocal</tt>&#30446;&#26631;&#28304;&#26159;&#24456;&#26377;&#29992;&#30340;&#12290;
            <tt class="classname">ThreadLocal</tt>&#30340;&#27010;&#24565;&#25552;&#20379;&#20102;&#19968;&#20010;JDK&#33539;&#22260;&#30340;&#21151;&#33021;&#65292;&#36825;&#21487;&#20197;&#20026;&#19968;&#20010;&#32447;&#31243;&#36879;&#26126;&#30340;&#20445;&#23384;&#36164;&#28304;&#12290;&#24314;&#31435;&#19968;&#20010;
        <tt class="classname">ThreadLocalTargetSource</tt>&#30340;&#36807;&#31243;&#21644;&#20854;&#23427;&#30446;&#26631;&#28304;&#20960;&#20046;&#23436;&#20840;&#19968;&#26679;&#65306;</p><pre class="programlisting">&lt;bean id="threadlocalTargetSource" class="org.springframework.aop.target.ThreadLocalTargetSource"&gt;
  &lt;property name="targetBeanName" value="businessObjectTarget"/&gt;
        &lt;/bean&gt;</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#22914;&#26524;&#19981;&#27491;&#30830;&#30340;&#22312;&#19968;&#20010;&#22810;&#32447;&#31243;&#21644;&#22810;&#31867;&#21152;&#36733;&#22120;&#30340;&#29615;&#22659;&#37324;&#20351;&#29992;ThreadLocal&#65292;&#23558;&#24102;&#26469;&#20005;&#37325;&#30340;&#38382;&#39064;&#65288;&#21487;&#33021;&#28508;&#22312;&#22320;&#23548;&#33268;&#20869;&#23384;&#27844;&#28431;&#65289;&#12290;
                &#27704;&#36828;&#35760;&#20303;&#24212;&#35813;&#25226;&#19968;&#20010;threadlocal&#21253;&#35013;&#22312;&#20854;&#23427;&#30340;&#31867;&#37324;&#65292;&#24182;&#27704;&#36828;&#19981;&#35201;&#30452;&#25509;&#20351;&#29992;<tt class="classname">ThreadLocal</tt>&#26412;&#36523;&#65288;&#24403;&#28982;&#26159;&#38500;&#20102;threadlocal&#21253;&#35013;&#31867;&#20043;&#22806;&#65289;&#12290;
                &#21516;&#26102;&#65292;&#27704;&#36828;&#35760;&#20303;&#27491;&#30830;&#30340;&#35774;&#32622;&#65288;set&#65289;&#21644;&#21462;&#28040;&#65288;unset&#65289;&#65288;&#21518;&#32773;&#20165;&#20165;&#38656;&#35201;&#35843;&#29992;<tt class="literal">ThreadLocal.set(null)</tt>&#65289;&#32465;&#23450;&#21040;&#32447;&#31243;&#30340;&#26412;&#22320;&#36164;&#28304;&#12290;
            &#21462;&#28040;&#22312;&#20219;&#20309;&#24773;&#20917;&#19979;&#37117;&#24212;&#35813;&#36827;&#34892;&#65292;&#21542;&#21017;&#20063;&#35768;&#20250;&#23548;&#33268;&#38169;&#35823;&#30340;&#34892;&#20026;&#12290;Spring&#30340;ThreadLocal&#25903;&#25345;&#23558;&#20026;&#20320;&#22788;&#29702;&#36825;&#20010;&#38382;&#39064;&#65292;&#25152;&#20197;&#22914;&#26524;&#27809;&#26377;&#20854;&#23427;&#27491;&#30830;&#30340;&#22788;&#29702;&#20195;&#30721;&#65292;&#27704;&#36828;&#24212;&#35813;&#32771;&#34385;&#20351;&#29992;&#36825;&#20010;&#21151;&#33021;&#12290;</p></td></tr></table></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-extensibility"></a>7.11.&nbsp;&#23450;&#20041;&#26032;&#30340;<tt class="interfacename">Advice</tt>&#31867;&#22411;</h2></div></div><div></div></div><p>Spring AOP&#34987;&#35774;&#35745;&#20026;&#21487;&#25193;&#23637;&#30340;&#12290;&#36890;&#36807;&#22312;&#20869;&#37096;&#20351;&#29992;&#25318;&#25130;&#23454;&#29616;&#31574;&#30053;&#65292;&#20320;&#21487;&#20197;&#25903;&#25345;&#24050;&#26377;&#30340;&#29615;&#32469;&#36890;&#30693;&#65292;&#21069;&#32622;&#36890;&#30693;&#65292;&#24322;&#24120;&#36890;&#30693;&#21644;&#21518;&#32622;&#36890;&#30693;&#20043;&#22806;&#30340;&#20219;&#24847;&#36890;&#30693;&#31867;&#22411;&#65292;&#23427;&#26159;&#24320;&#31665;&#21363;&#29992;&#30340;&#12290;</p><p><tt class="literal">org.springframework.aop.framework.adapter</tt>&#21253;&#26159;&#19968;&#20010;SPI&#21253;&#65292;&#23427;&#20801;&#35768;&#28155;&#21152;&#26032;&#30340;&#33258;&#23450;&#20041;&#36890;&#30693;&#31867;&#22411;&#32780;&#26080;&#38656;&#20462;&#25913;&#26680;&#24515;&#26694;&#26550;&#12290;
    &#23545;&#20110;&#33258;&#23450;&#20041;<tt class="interfacename">Advice</tt>&#31867;&#22411;&#30340;&#21807;&#19968;&#30340;&#38480;&#21046;&#26159;&#23427;&#24517;&#39035;&#23454;&#29616;<tt class="interfacename">org.aopalliance.aop.Advice</tt>&#36825;&#20010;&#26631;&#35760;&#25509;&#21475;&#12290;
</p><p>&#35831;&#21442;&#32771;<tt class="literal">org.springframework.aop.framework.adapter</tt>&#21253;&#30340;Javadoc&#26469;&#20102;&#35299;&#36827;&#19968;&#27493;&#30340;&#20449;&#24687;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-api-resources"></a>7.12.&nbsp;&#26356;&#22810;&#36164;&#28304;</h2></div></div><div></div></div><p>&#21487;&#20197;&#21442;&#32771;Spring&#30340;&#31034;&#20363;&#24212;&#29992;&#31243;&#24207;&#26469;&#26597;&#30475;Spring AOP&#30340;&#26356;&#22810;&#20363;&#23376;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>JPetStore&#30340;&#32570;&#30465;&#37197;&#32622;&#35828;&#26126;&#20102;&#22914;&#20309;&#20351;&#29992;<tt class="classname">TransactionProxyFactoryBean</tt>&#26469;&#36827;&#34892;&#22768;&#26126;&#24335;&#20107;&#21153;&#31649;&#29702;&#12290;</p></li><li><p>JPetStore&#30340;<tt class="literal">/attributes</tt>&#30446;&#24405;&#35828;&#26126;&#20102;&#22914;&#20309;&#20351;&#29992;&#23646;&#24615;&#39537;&#21160;&#30340;&#22768;&#26126;&#24615;&#20107;&#21153;&#31649;&#29702;&#12290;</p></li></ul></div></div></div><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="aop.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="testing.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;6.&nbsp;&#20351;&#29992;Spring&#36827;&#34892;&#38754;&#21521;&#20999;&#38754;&#32534;&#31243;&#65288;AOP&#65289;&nbsp;</td><td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.springsource.com/" title="SpringSource">Sponsored by SpringSource</a></span></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;8.&nbsp;&#27979;&#35797;</td></tr></table></div></body></html>