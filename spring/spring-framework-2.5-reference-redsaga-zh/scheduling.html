<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;23.&nbsp;Spring&#20013;&#30340;&#23450;&#26102;&#35843;&#24230;(Scheduling)&#21644;&#32447;&#31243;&#27744;(Thread Pooling)</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.60.1"><link rel="home" href="index.html" title="Spring Framework &#24320;&#21457;&#21442;&#32771;&#25163;&#20876;"><link rel="up" href="spring-integration.html" title="Part&nbsp;IV.&nbsp;&#25972;&#21512;"><link rel="previous" href="mail.html" title="Chapter&nbsp;22.&nbsp;Spring&#37038;&#20214;&#25277;&#35937;&#23618;"><link rel="next" href="dynamic-language.html" title="Chapter&nbsp;24.&nbsp;&#21160;&#24577;&#35821;&#35328;&#25903;&#25345;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" style="background-color:white;border:none;height:73px;border:1px solid black;"><a style="border:none;" href="http://www.springframework.org/" title="The Spring Framework"><img style="border:none;" src="images/xdev-spring_logo.jpg"></a><a style="border:none;" href="http://www.springsource.com/" title="SpringSource"><img style="border:none;position:absolute;padding-top:5px;right:42px;" src="images/springsource-banner-rhs.png"></a></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="scheduling"></a>Chapter&nbsp;23.&nbsp;Spring&#20013;&#30340;&#23450;&#26102;&#35843;&#24230;(Scheduling)&#21644;&#32447;&#31243;&#27744;(Thread Pooling)</h2></div></div><div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scheduling-introduction"></a>23.1.&nbsp;&#31616;&#20171;</h2></div></div><div></div></div><p>
  			Spring&#21253;&#21547;&#20102;&#23545;&#23450;&#26102;&#35843;&#24230;&#26381;&#21153;&#30340;&#20869;&#32622;&#25903;&#25345;&#31867;&#12290;&#24403;&#21069;&#65292;Spring&#25903;&#25345;&#20174;JDK1.3&#24320;&#22987;&#20869;&#32622;&#30340;<tt class="classname">Timer</tt>&#31867;&#21644;Quartz Scheduler(<a href="http://www.opensymphony.com/quartz/" target="_top">http://www.opensymphony.com/quartz/</a>)&#12290;&#20108;&#32773;&#37117;&#21487;&#20197;&#36890;&#36807;<tt class="interfacename">FactoryBean</tt>&#65292;&#20998;&#21035;&#25351;&#21521;<tt class="classname">Timer</tt>&#25110;<tt class="classname">Trigger</tt>&#23454;&#20363;&#30340;&#24341;&#29992;&#36827;&#34892;&#37197;&#32622;&#12290;&#26356;&#36827;&#19968;&#27493;&#65292;&#26377;&#20010;&#23545;Quartz Scheduler&#21644;<tt class="classname">Timer</tt>&#37117;&#26377;&#25928;&#30340;&#24037;&#20855;&#31867;&#21487;&#20197;&#35753;&#20320;&#35843;&#29992;&#26576;&#20010;&#30446;&#26631;&#23545;&#35937;&#30340;&#26041;&#27861;&#65288;&#31867;&#20284;&#36890;&#24120;&#30340;<tt class="classname">MethodInvokingFactoryBean</tt>&#25805;&#20316;&#65289;&#12290;Spring &#36824;&#21253;&#21547;&#26377;&#29992;&#20110;&#32447;&#31243;&#27744;&#35843;&#24230;&#30340;&#31867;&#65292;&#23427;&#38024;&#23545;Java 1.3,1.4,5&#21644;JEE&#29615;&#22659;&#30340;&#24046;&#24322;&#37117;&#36827;&#34892;&#20102;&#25277;&#35937;&#12290;
 		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scheduling-quartz"></a>23.2.&nbsp;&#20351;&#29992;OpenSymphony Quartz &#35843;&#24230;&#22120;</h2></div></div><div></div></div><p>
		Quartz&#20351;&#29992;<tt class="classname">Trigger</tt>, <tt class="classname">Job</tt>&#20197;&#21450;<tt class="classname">JobDetail</tt>&#31561;&#23545;&#35937;&#26469;&#36827;&#34892;&#21508;&#31181;&#31867;&#22411;&#30340;&#20219;&#21153;&#35843;&#24230;&#12290;&#20851;&#20110;Quartz&#30340;&#22522;&#26412;&#27010;&#24565;&#65292;&#35831;&#21442;&#38405;<a href="http://www.opensymphony.com/quartz" target="_top">http://www.opensymphony.com/quartz</a>&#12290;&#20026;&#20102;&#35753;&#22522;&#20110;Spring&#30340;&#24212;&#29992;&#31243;&#24207;&#26041;&#20415;&#20351;&#29992;&#65292;Spring&#25552;&#20379;&#20102;&#19968;&#20123;&#31867;&#26469;&#31616;&#21270;uartz&#30340;&#29992;&#27861;&#12290;
  	</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="scheduling-quartz-jobdetail"></a>23.2.1.&nbsp;&#20351;&#29992;JobDetailBean</h3></div></div><div></div></div><p>
  				<tt class="classname">JobDetail</tt> &#23545;&#35937;&#20445;&#23384;&#36816;&#34892;&#19968;&#20010;&#20219;&#21153;&#25152;&#38656;&#30340;&#20840;&#37096;&#20449;&#24687;&#12290;Spring&#25552;&#20379;&#19968;&#20010;&#21483;&#20316;<tt class="classname">JobDetailBean</tt>&#30340;&#31867;&#35753;<tt class="classname">JobDetail</tt>&#33021;&#23545;&#19968;&#20123;&#26377;&#24847;&#20041;&#30340;&#21021;&#22987;&#20540;&#36827;&#34892;&#21021;&#22987;&#21270;&#12290;&#35753;&#25105;&#20204;&#26469;&#30475;&#20010;&#20363;&#23376;&#65306;
  		</p><pre class="programlisting">
&lt;bean name="exampleJob" class="org.springframework.scheduling.quartz.JobDetailBean"&gt;
  &lt;property name="jobClass" value="example.ExampleJob" /&gt;
  &lt;property name="jobDataAsMap"&gt;
    &lt;map&gt;
      &lt;entry key="timeout" value="5" /&gt;
    &lt;/map&gt;
  &lt;/property&gt;
&lt;/bean&gt;</pre><p>
			Job detail bean&#25317;&#26377;&#25152;&#26377;&#36816;&#34892;job(<tt class="classname">ExampleJob</tt>)&#30340;&#24517;&#35201;&#20449;&#24687;&#12290;
			&#21487;&#20197;&#36890;&#36807;job&#30340;data map&#26469;&#21046;&#23450;timeout&#12290;Job&#30340;data map&#21487;&#20197;&#36890;&#36807;<tt class="classname">JobExecutionContext</tt>&#65288;&#22312;&#36816;&#34892;&#26102;&#21051;&#20256;&#36882;&#32473;&#20320;)&#26469;&#24471;&#21040;&#65292;&#20294;&#26159;<tt class="classname">JobDetailBean</tt>&#21516;&#26102;&#25226;&#20174;job&#30340;data map&#20013;&#24471;&#21040;&#30340;&#23646;&#24615;&#26144;&#23556;&#21040;&#23454;&#38469;job&#20013;&#30340;&#23646;&#24615;&#20013;&#21435;&#12290; 
			&#25152;&#20197;&#65292;&#22914;&#26524;ExampleJob&#20013;&#21253;&#21547;&#19968;&#20010;&#21517;&#20026;<tt class="literal">timeout</tt>&#30340;&#23646;&#24615;&#65292;<tt class="classname">JobDetailBean</tt>&#23558;&#33258;&#21160;&#20026;&#23427;&#36171;&#20540;&#65306; 
			</p><pre class="programlisting">package example;

public class ExampleJob extends QuartzJobBean {

  private int timeout;
  
  /**
   * Setter called after the ExampleJob is instantiated
   * with the value from the JobDetailBean (5)
   */ 
  public void setTimeout(int timeout) {
    this.timeout = timeout;
  }
  
  protected void executeInternal(JobExecutionContext ctx) throws JobExecutionException {
      <i class="lineannotation"><span class="lineannotation">// do the actual work</span></i>
  }
}</pre><p>&#24403;&#28982;&#65292;&#20320;&#21516;&#26679;&#21487;&#20197;&#23545;Job detail bean&#20013;&#25152;&#26377;&#20854;&#20182;&#30340;&#39069;&#22806;&#37197;&#32622;&#36827;&#34892;&#35774;&#32622;&#12290;</p><p>
			<span class="emphasis"><em>&#27880;&#24847;&#65306;&#20351;&#29992;<tt class="literal">name</tt>&#21644;<tt class="literal">group</tt>&#23646;&#24615;,&#20320;&#21487;&#20197;&#20998;&#21035;&#20462;&#25913;job&#22312;&#21738;&#19968;&#20010;&#32452;&#19979;&#36816;&#34892;&#21644;&#20351;&#29992;&#20160;&#20040;&#21517;&#31216;&#12290; &#40664;&#35748;&#24773;&#20917;&#19979;&#65292;job&#30340;&#21517;&#31216;&#31561;&#20110;job detail bean&#30340;&#21517;&#31216;&#65288;&#22312;&#19978;&#38754;&#30340;&#20363;&#23376;&#20013;&#20026;<tt class="literal">exampleJob</tt>&#65289;&#12290;</em></span>
			</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="scheduling-quartz-method-invoking-job"></a>23.2.2.&nbsp;&#20351;&#29992; <tt class="classname">MethodInvokingJobDetailFactoryBean</tt></h3></div></div><div></div></div><p>
				&#36890;&#24120;&#24773;&#20917;&#19979;,&#20320;&#21482;&#38656;&#35201;&#35843;&#29992;&#29305;&#23450;&#23545;&#35937;&#19978;&#30340;&#19968;&#20010;&#26041;&#27861;&#21363;&#21487;&#23454;&#29616;&#20219;&#21153;&#35843;&#24230;&#12290;&#20320;&#21487;&#20197;&#20351;&#29992;<tt class="classname">MethodInvokingJobDetailFactoryBean</tt>&#20934;&#30830;&#30340;&#20570;&#21040;&#36825;&#19968;&#28857;: 
			</p><pre class="programlisting">&lt;bean id="jobDetail" class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean"&gt;
  &lt;property name="targetObject" ref="exampleBusinessObject" /&gt;
  &lt;property name="targetMethod" value="doIt" /&gt;
&lt;/bean&gt;</pre><p>
				&#19978;&#38754;&#20363;&#23376;&#23558;&#35843;&#29992;<tt class="literal">exampleBusinessObject</tt>&#20013;&#30340;<tt class="literal">doIt</tt>&#26041;&#27861;&#65288;&#22914;&#19979;&#65289;&#65306; 
			</p><pre class="programlisting">public class ExampleBusinessObject {
  
  <i class="lineannotation"><span class="lineannotation">// properties and collaborators</span></i>
  
  public void doIt() {
    <i class="lineannotation"><span class="lineannotation">// do the actual work</span></i>
  }
}</pre><pre class="programlisting">
&lt;bean id="exampleBusinessObject" class="examples.ExampleBusinessObject"/&gt;</pre><p>	
			&#20351;&#29992;<tt class="literal">MethodInvokingJobDetailFactoryBean</tt>&#20320;&#19981;&#38656;&#35201;&#21019;&#24314;&#21482;&#26377;&#19968;&#34892;&#20195;&#30721;&#19988;&#21482;&#35843;&#29992;&#19968;&#20010;&#26041;&#27861;&#30340;job, &#20320;&#21482;&#38656;&#35201;&#21019;&#24314;&#30495;&#23454;&#30340;&#19994;&#21153;&#23545;&#35937;&#26469;&#21253;&#35013;&#20855;&#20307;&#30340;&#32454;&#33410;&#30340;&#23545;&#35937;&#12290;
			</p><p>
			&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;Quartz Jobs&#26159;&#26080;&#29366;&#24577;&#30340;&#65292;&#21487;&#33021;&#23548;&#33268;jobs&#20043;&#38388;&#20114;&#30456;&#30340;&#24433;&#21709;&#12290;&#22914;&#26524;&#20320;&#20026;&#30456;&#21516;&#30340;<tt class="classname">JobDetail</tt>&#25351;&#23450;&#20004;&#20010;Trigger,
			&#24456;&#21487;&#33021;&#24403;&#31532;&#19968;&#20010;job&#23436;&#25104;&#20043;&#21069;&#65292;&#31532;&#20108;&#20010;job&#23601;&#24320;&#22987;&#20102;&#12290;&#22914;&#26524;<tt class="classname">JobDetail</tt>&#23545;&#35937;&#23454;&#29616;&#20102;<tt class="interfacename">Stateful</tt>&#25509;&#21475;&#65292;&#23601;&#19981;&#20250;&#21457;&#29983;&#36825;&#26679;&#30340;&#20107;&#24773;&#12290;
			&#31532;&#20108;&#20010;job&#23558;&#19981;&#20250;&#22312;&#31532;&#19968;&#20010;job&#23436;&#25104;&#20043;&#21069;&#24320;&#22987;&#12290;&#20026;&#20102;&#20351;&#24471;jobs&#19981;&#24182;&#21457;&#36816;&#34892;,&#35774;&#32622;<tt class="classname">MethodInvokingJobDetailFactoryBean</tt>&#20013;&#30340;<tt class="literal">concurrent</tt>&#26631;&#35760;&#20026;<tt class="literal">false</tt>&#12290;
			</p><pre class="programlisting">
&lt;bean id="jobDetail" class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean"&gt;
  &lt;property name="targetObject" ref="exampleBusinessObject" /&gt;
  &lt;property name="targetMethod" value="doIt" /&gt;
  &lt;property name="concurrent" value="false" /&gt;
&lt;/bean&gt;</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
					&#27880;&#24847;&#65306;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;jobs&#22312;&#24182;&#34892;&#30340;&#26041;&#24335;&#19979;&#36816;&#34892;&#12290;
				</p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="scheduling-quartz-cron"></a>23.2.3.&nbsp;&#20351;&#29992;triggers&#21644;<tt class="classname">SchedulerFactoryBean</tt>&#26469;&#21253;&#35013;&#20219;&#21153;</h3></div></div><div></div></div><p>
			&#25105;&#20204;&#24050;&#32463;&#21019;&#24314;&#20102;job details,jobs&#12290;&#25105;&#20204;&#21516;&#26102;&#22238;&#39038;&#20102;&#20801;&#35768;&#20320;&#35843;&#29992;&#29305;&#23450;&#23545;&#35937;&#19978;&#26576;&#19968;&#20010;&#26041;&#27861;&#30340;&#20415;&#25463;&#30340;bean&#12290;
			&#24403;&#28982;&#25105;&#20204;&#20173;&#38656;&#35201;&#35843;&#24230;&#36825;&#20123;jobs&#12290;&#36825;&#38656;&#35201;&#20351;&#29992;triggers&#21644;<tt class="classname">SchedulerFactoryBean</tt>&#26469;&#23436;&#25104;&#12290;
			Quartz&#33258;&#24102;&#19968;&#20123;&#21487;&#20379;&#20351;&#29992;&#30340;triggers&#12290;Spring&#25552;&#20379;&#20004;&#20010;&#23376;&#31867;triggers&#65292;&#20998;&#21035;&#20026;<tt class="classname">CronTriggerBean</tt>&#21644;<tt class="classname">SimpleTriggerBean</tt>&#12290;
		</p><p>
			Triggers&#20063;&#38656;&#35201;&#34987;&#35843;&#24230;&#12290;Spring&#25552;&#20379;<tt class="classname">SchedulerFactoryBean</tt>&#26469;&#26292;&#38706;&#19968;&#20123;&#23646;&#24615;&#26469;&#35774;&#32622;triggers&#12290;<tt class="classname">SchedulerFactoryBean</tt>&#36127;&#36131;&#35843;&#24230;&#37027;&#20123;&#23454;&#38469;&#30340;triggers&#12290;
		</p><p>
			&#26469;&#30475;&#20960;&#20010;&#20363;&#23376;&#65306;
			</p><pre class="programlisting">&lt;bean id="simpleTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerBean"&gt;
    &lt;!-- see the example of method invoking job above --&gt;
    &lt;property name="jobDetail" ref="jobDetail" /&gt;
    &lt;!-- 10 seconds --&gt;
    &lt;property name="startDelay" value="10000" /&gt;
    &lt;!-- repeat every 50 seconds --&gt;
    &lt;property name="repeatInterval" value="50000" /&gt;
&lt;/bean&gt;

&lt;bean id="cronTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean"&gt;
    &lt;property name="jobDetail" ref="exampleJob" /&gt;
    &lt;!-- run every morning at 6 AM --&gt;
    &lt;property name="cronExpression" value="0 0 6 * * ?" /&gt;
&lt;/bean&gt;</pre><p>
			&#29616;&#22312;&#25105;&#20204;&#21019;&#24314;&#20102;&#20004;&#20010;triggers&#65292;&#20854;&#20013;&#19968;&#20010;&#24320;&#22987;&#24310;&#36831;10&#31186;&#20197;&#21518;&#27599;50&#31186;&#36816;&#34892;&#19968;&#27425;&#65292;&#21478;&#19968;&#20010;&#27599;&#22825;&#26089;&#19978;6&#28857;&#38047;&#36816;&#34892;&#12290;
			&#25105;&#20204;&#38656;&#35201;&#21019;&#24314;&#19968;&#20010;<tt class="classname">SchedulerFactoryBean</tt>&#26469;&#26368;&#32456;&#23454;&#29616;&#19978;&#36848;&#30340;&#19968;&#20999;&#65306;
			</p><pre class="programlisting">&lt;bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean"&gt;
    &lt;property name="triggers"&gt;
        &lt;list&gt;
            &lt;ref bean="cronTrigger" /&gt;
            &lt;ref bean="simpleTrigger" /&gt;
        &lt;/list&gt;
    &lt;/property&gt;
&lt;/bean&gt;</pre><p>
				&#26356;&#22810;&#30340;&#23646;&#24615;&#20320;&#21487;&#20197;&#36890;&#36807;<tt class="classname">SchedulerFactoryBean</tt>&#26469;&#35774;&#32622;&#65292;&#20363;&#22914;job details&#20351;&#29992;&#30340;Calendars, &#29992;&#26469;&#35746;&#21046;Quartz&#30340;&#19968;&#20123;&#23646;&#24615;&#20197;&#21450;&#20854;&#23427;&#30456;&#20851;&#20449;&#24687;&#12290;
			&#20320;&#21487;&#20197;&#26597;&#38405;&#30456;&#24212;&#30340;JavaDOC(<a href="http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/scheduling/quartz/SchedulerFactoryBean.html" target="_top">http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/scheduling/quartz/SchedulerFactoryBean.html</a>)&#26469;&#20102;&#35299;&#36827;&#19968;&#27493;&#30340;&#20449;&#24687;&#12290;
			</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scheduling-jdk-timer"></a>23.3.&nbsp;&#20351;&#29992;JDK Timer&#25903;&#25345;&#31867;</h2></div></div><div></div></div><p>
		&#21478;&#22806;&#19968;&#20010;&#35843;&#24230;&#20219;&#21153;&#30340;&#36884;&#24452;&#26159;&#20351;&#29992;JDK Timer&#23545;&#35937;&#12290;&#20320;&#21487;&#20197;&#21019;&#24314;&#23450;&#21046;&#30340;timer&#25110;&#32773;&#35843;&#29992;&#26576;&#20123;&#26041;&#27861;&#30340;timer&#12290;&#21253;&#35013;timers&#30340;&#24037;&#20316;&#30001;<tt class="classname">TimerFactoryBean</tt>&#23436;&#25104;&#12290;
	</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="scheduling-jdk-timer-creating"></a>23.3.1.&nbsp;&#21019;&#24314;&#23450;&#21046;&#30340;timers</h3></div></div><div></div></div><p>
			&#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">TimerTask</tt>&#21019;&#24314;&#23450;&#21046;&#30340;timer tasks&#65292;&#31867;&#20284;&#20110;Quartz&#20013;&#30340;jobs:
			</p><pre class="programlisting">public class CheckEmailAddresses extends TimerTask {

  private List emailAddresses;
  
  public void setEmailAddresses(List emailAddresses) {
    this.emailAddresses = emailAddresses;
  }
  
  public void run() {
    <i class="lineannotation"><span class="lineannotation">// iterate over all email addresses and archive them</span></i>
  }
}</pre><p>
				&#21253;&#35013;&#23427;&#24456;&#31616;&#21333;:
			</p><pre class="programlisting">&lt;bean id="checkEmail" class="examples.CheckEmailAddress"&gt;
    &lt;property name="emailAddresses"&gt;
        &lt;list&gt;
            &lt;value&gt;test@springframework.org&lt;/value&gt;
            &lt;value&gt;foo@bar.com&lt;/value&gt;
            &lt;value&gt;john@doe.net&lt;/value&gt;
        &lt;/list&gt;
    &lt;/property&gt;
&lt;/bean&gt;

&lt;bean id="scheduledTask" class="org.springframework.scheduling.timer.ScheduledTimerTask"&gt;
    <i class="lineannotation"><span class="lineannotation">&lt;!-- wait 10 seconds before starting repeated execution --&gt;</span></i>
    &lt;property name="delay" value="10000" /&gt;
    <i class="lineannotation"><span class="lineannotation">&lt;!-- run every 50 seconds --&gt;</span></i>
    &lt;property name="period" value="50000" /&gt;
    &lt;property name="timerTask" ref="checkEmail" /&gt;
&lt;/bean&gt;</pre><p>
				<span class="emphasis"><em>
				&#27880;&#24847;&#33509;&#35201;&#35753;&#20219;&#21153;&#21482;&#36816;&#34892;&#19968;&#27425;&#65292;&#20320;&#21487;&#20197;&#25226;<tt class="literal">period</tt>&#23646;&#24615;&#35774;&#32622;&#20026;0&#65288;&#25110;&#32773;&#36127;&#20540;&#65289;&#12290;
				</em></span>
			</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="scheduling-jdk-timer-method-invoking-task"></a>23.3.2.&nbsp;&#20351;&#29992; <tt class="classname">MethodInvokingTimerTaskFactoryBean</tt>&#31867;</h3></div></div><div></div></div><p>
				&#21644;&#23545;Quartz&#30340;&#25903;&#25345;&#31867;&#20284;&#65292;&#23545;<tt class="classname">Timer</tt>&#30340;&#25903;&#25345;&#20063;&#21253;&#21547;&#19968;&#20010;&#32452;&#20214;&#65292;&#21487;&#20197;&#35753;&#20320;&#21608;&#26399;&#24615;&#30340;&#35843;&#29992;&#26576;&#20010;&#26041;&#27861;:
			</p><pre class="programlisting">&lt;bean id="doIt" class="org.springframework.scheduling.timer.MethodInvokingTimerTaskFactoryBean"&gt;
    &lt;property name="targetObject" ref="exampleBusinessObject" /&gt;
    &lt;property name="targetMethod" value="doIt" /&gt;
&lt;/bean&gt;</pre><p>
				&#20197;&#19978;&#30340;&#20363;&#23376;&#20250;&#35843;&#29992;<tt class="literal">exampleBusinessObject</tt>&#23545;&#35937;&#30340;<tt class="literal">doIt</tt>&#26041;&#27861;&#12290;(&#35265;&#19979;):
			</p><pre class="programlisting">public class BusinessObject {
  
  <i class="lineannotation"><span class="lineannotation">// properties and collaborators</span></i>
  
  public void doIt() {
    <i class="lineannotation"><span class="lineannotation">// do the actual work</span></i>
  }
}</pre><p>
				&#23558;&#19978;&#20363;&#20013;<tt class="classname">ScheduledTimerTask</tt>&#30340;<tt class="literal">timerTask</tt>&#24341;&#29992;&#20462;&#25913;&#20026;<tt class="literal">doIt</tt>&#65292;bean&#23558;&#20250;&#29992;&#19968;&#20010;&#22266;&#23450;&#30340;&#21608;&#26399;&#26469;&#35843;&#29992;<tt class="literal">doIt</tt>&#26041;&#27861;&#12290;
			</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="scheduling-jdk-timer-factory-bean"></a>23.3.3.&nbsp;&#26368;&#21518;&#65306;&#20351;&#29992;<tt class="classname">TimerFactoryBean</tt>&#26469;&#35774;&#32622;&#20219;&#21153;</h3></div></div><div></div></div><p>
				<tt class="classname">TimerFactoryBean</tt>&#31867;&#21644;Quartz&#30340;<tt class="classname">SchedulerFactoryBean</tt>&#31867;&#26377;&#20123;&#31867;&#20284;&#65292;&#23427;&#20204;&#26159;&#20026;&#21516;&#26679;&#30340;&#30446;&#30340;&#32780;&#35774;&#35745;&#30340;&#65306;&#35774;&#32622;&#30830;&#20999;&#30340;&#20219;&#21153;&#35745;&#21010;&#12290;<tt class="classname">TimerFactoryBean</tt>&#23545;&#19968;&#20010;Timer&#36827;&#34892;&#37197;&#32622;&#65292;&#35774;&#32622;&#20854;&#24341;&#29992;&#30340;&#20219;&#21153;&#30340;&#21608;&#26399;&#12290;&#20320;&#21487;&#20197;&#25351;&#23450;&#26159;&#21542;&#20351;&#29992;&#32972;&#26223;&#32447;&#31243;&#12290;
			</p><pre class="programlisting">&lt;bean id="timerFactory" class="org.springframework.scheduling.timer.TimerFactoryBean"&gt;
    &lt;property name="scheduledTimerTasks"&gt;
        &lt;list&gt;
            <i class="lineannotation"><span class="lineannotation">&lt;!-- see the example above --&gt;</span></i>
            &lt;ref bean="scheduledTask" /&gt;
        &lt;/list&gt;
    &lt;/property&gt;
&lt;/bean&gt;</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="scheduling-task-executor"></a>23.4.&nbsp;Spring<tt class="interfacename">TaskExecutor</tt>&#25277;&#35937;</h2></div></div><div></div></div><p>
			Spring 2.0 &#20026;&#25191;&#34892;&#22120;(Executor)&#22788;&#29702;&#24341;&#20837;&#20102;&#19968;&#20010;&#26032;&#30340;&#25277;&#35937;&#23618;&#12290;Executor&#26159;Java 5&#30340;&#21517;&#35789;&#65292;&#29992;&#26469;&#34920;&#31034;&#32447;&#31243;&#27744;&#30340;&#27010;&#24565;&#12290;
			&#20043;&#25152;&#20197;&#29992;&#36825;&#20010;&#22855;&#24618;&#30340;&#21517;&#35789;&#65292;&#26159;&#22240;&#20026;&#23454;&#38469;&#19978;&#19981;&#33021;&#20445;&#35777;&#24213;&#23618;&#23454;&#29616;&#30340;&#30830;&#26159;&#19968;&#20010;&#27744;&#12290;&#23454;&#38469;&#19978;&#65292;&#24456;&#22810;&#24773;&#20917;&#19979;&#65292;executor&#21482;&#26159;&#21333;&#32447;&#31243;&#12290;
			Spring&#30340;&#25277;&#35937;&#23618;&#24110;&#21161;&#20320;&#25226;&#32447;&#31243;&#27744;&#24341;&#20837;&#21040;Java 1.3&#21644;1.4&#29615;&#22659;&#20013;&#65292;&#21516;&#26102;&#38544;&#34255;&#20102; 1.3, 1.4, 5, &#21644; Java EE&#29615;&#22659;&#20013;&#32447;&#31243;&#27744;&#23454;&#29616;&#30340;&#24046;&#24322;&#12290;
		</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="scheduling-task-executor-interface"></a>23.4.1.&nbsp;<tt class="interfacename">TaskExecutor</tt>&#25509;&#21475;</h3></div></div><div></div></div><p>
				Spring&#30340;<tt class="interfacename">TaskExecutor</tt>&#25509;&#21475;&#31561;&#21516;&#20110;<tt class="classname">java.util.concurrent.Executor</tt>&#25509;&#21475;&#12290;
				&#23454;&#38469;&#19978;&#65292;&#23427;&#23384;&#22312;&#30340;&#20027;&#35201;&#21407;&#22240;&#26159;&#20026;&#20102;&#22312;&#20351;&#29992;&#32447;&#31243;&#27744;&#30340;&#26102;&#20505;&#65292;&#23558;&#23545;Java 5&#30340;&#20381;&#36182;&#25277;&#35937;&#20986;&#26469;&#12290;
				&#36825;&#20010;&#25509;&#21475;&#21482;&#26377;&#19968;&#20010;&#26041;&#27861;<tt class="classname">execute(Runnable task)</tt>&#65292;&#23427;&#26681;&#25454;&#32447;&#31243;&#27744;&#30340;&#35821;&#20041;&#21644;&#37197;&#32622;&#65292;&#26469;&#25509;&#21463;&#19968;&#20010;&#25191;&#34892;&#20219;&#21153;&#12290;
		</p><p>
				&#26368;&#21021;&#21019;&#24314;<tt class="interfacename">TaskExecutor</tt>&#26159;&#20026;&#20102;&#22312;&#38656;&#35201;&#26102;&#32473;&#20854;&#20182;Spring&#32452;&#20214;&#25552;&#20379;&#19968;&#20010;&#32447;&#31243;&#27744;&#30340;&#25277;&#35937;&#12290;
				&#20363;&#22914;<tt class="classname">ApplicationEventMulticaster</tt>&#32452;&#20214;&#12289;JMS&#30340; <tt class="classname">AbstractMessageListenerContainer</tt>&#21644;&#23545;Quartz&#30340;&#25972;&#21512;&#37117;&#20351;&#29992;&#20102;<tt class="interfacename">TaskExecutor</tt>&#25277;&#35937;&#26469;&#25552;&#20379;&#32447;&#31243;&#27744;&#12290;
				&#24403;&#28982;&#65292;&#22914;&#26524;&#20320;&#30340;bean&#38656;&#35201;&#32447;&#31243;&#27744;&#34892;&#20026;&#65292;&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;&#36825;&#20010;&#25277;&#35937;&#23618;&#12290;
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="scheduling-task-executor-types"></a>23.4.2.&nbsp;<tt class="interfacename">TaskExecutor</tt>&#31867;&#22411;</h3></div></div><div></div></div><p>
				&#22312;Spring&#21457;&#34892;&#21253;&#20013;&#39044;&#23450;&#20041;&#20102;&#19968;&#20123;<tt class="interfacename">TaskExecutor</tt>&#23454;&#29616;&#12290;&#26377;&#20102;&#23427;&#20204;&#65292;&#20320;&#29978;&#33267;&#19981;&#38656;&#35201;&#20877;&#33258;&#34892;&#23454;&#29616;&#20102;&#12290;
			</p><div class="itemizedlist"><ul type="disc"><li><p>
						<tt class="classname">SimpleAsyncTaskExecutor</tt>
&#31867;
					</p><p>
					&#36825;&#20010;&#23454;&#29616;&#19981;&#37325;&#29992;&#20219;&#20309;&#32447;&#31243;&#65292;&#25110;&#32773;&#35828;&#23427;&#27599;&#27425;&#35843;&#29992;&#37117;&#21551;&#21160;&#19968;&#20010;&#26032;&#32447;&#31243;&#12290;&#20294;&#26159;&#65292;&#23427;&#36824;&#26159;&#25903;&#25345;&#23545;&#24182;&#21457;&#24635;&#25968;&#35774;&#38480;&#65292;&#24403;&#36229;&#36807;&#32447;&#31243;&#24182;&#21457;&#24635;&#25968;&#38480;&#21046;&#26102;&#65292;&#38459;&#22622;&#26032;&#30340;&#35843;&#29992;&#65292;&#30452;&#21040;&#26377;&#20301;&#32622;&#34987;&#37322;&#25918;&#12290;&#22914;&#26524;&#20320;&#38656;&#35201;&#30495;&#27491;&#30340;&#27744;&#65292;&#35831;&#32487;&#32493;&#24448;&#19979;&#30475;&#12290;
					</p></li><li><p><a name="syncTaskExecutor"></a>
						<tt class="classname">SyncTaskExecutor</tt>&#31867;
					</p><p>
						&#36825;&#20010;&#23454;&#29616;&#19981;&#20250;&#24322;&#27493;&#25191;&#34892;&#12290;&#30456;&#21453;&#65292;&#27599;&#27425;&#35843;&#29992;&#37117;&#22312;&#21457;&#36215;&#35843;&#29992;&#30340;&#32447;&#31243;&#20013;&#25191;&#34892;&#12290;&#23427;&#30340;&#20027;&#35201;&#29992;&#22788;&#26159;&#22312;&#19981;&#38656;&#35201;&#22810;&#32447;&#31243;&#30340;&#26102;&#20505;&#65292;&#27604;&#22914;&#31616;&#21333;&#30340;test case&#12290;
					</p></li><li><p><a name="concurrentTaskExecutor"></a>
						<tt class="classname">ConcurrentTaskExecutor</tt>
&#31867;
					</p><p>
					&#36825;&#20010;&#23454;&#29616;&#26159;&#23545;Java 5 <tt class="classname">java.util.concurrent.Executor</tt>&#31867;&#30340;&#21253;&#35013;&#12290;&#26377;&#21478;&#19968;&#20010;&#22791;&#36873;, <tt class="classname">ThreadPoolTaskExecutor</tt>&#31867;&#65292;&#23427;&#26292;&#38706;&#20102;<tt class="classname">Executor</tt>&#30340;&#37197;&#32622;&#21442;&#25968;&#20316;&#20026;bean&#23646;&#24615;&#12290;&#24456;&#23569;&#38656;&#35201;&#20351;&#29992;<tt class="classname">ConcurrentTaskExecutor</tt>, &#20294;&#26159;&#22914;&#26524;<a href="scheduling.html#threadPoolTaskExecutor"><tt class="classname">ThreadPoolTaskExecutor</tt></a>&#19981;&#25975;&#25152;&#38656;&#65292;<tt class="classname">ConcurrentTaskExecutor</tt>&#26159;&#21478;&#22806;&#19968;&#20010;&#22791;&#36873;&#12290;
					</p></li><li><p><a name="simpleThreadPoolTaskExecutor"></a>
						<tt class="classname">SimpleThreadPoolTaskExecutor</tt>
&#31867;
					</p><p>
						&#36825;&#20010;&#23454;&#29616;&#23454;&#38469;&#19978;&#26159;Quartz&#30340;<tt class="classname">SimpleThreadPool</tt>&#31867;&#30340;&#23376;&#31867;&#65292;&#23427;&#20250;&#30417;&#21548;Spring&#30340;&#29983;&#21629;&#21608;&#26399;&#22238;&#35843;&#12290;&#24403;&#20320;&#26377;&#32447;&#31243;&#27744;&#65292;&#38656;&#35201;&#22312;Quartz&#21644;&#38750;Quartz&#32452;&#20214;&#20013;&#20849;&#29992;&#26102;&#65292;&#36825;&#26159;&#23427;&#30340;&#20856;&#22411;&#29992;&#22788;&#12290;
					</p></li><li><p><a name="threadPoolTaskExecutor"></a>
						<tt class="classname">ThreadPoolTaskExecutor</tt>
&#31867;
					</p><div class="sidebar"><p>
							&#23427;&#19981;&#25903;&#25345;&#20219;&#20309;&#23545;<tt class="classname">java.util.concurrent</tt>&#21253;&#30340;&#26367;&#25442;&#25110;&#32773;&#19979;&#34892;&#31227;&#26893;&#12290;Doug Lea&#21644;Dawid Kurzyniec&#23545;<tt class="classname">java.util.concurrent</tt>&#30340;&#23454;&#29616;&#37117;&#37319;&#29992;&#20102;&#19981;&#21516;&#30340;&#21253;&#32467;&#26500;&#65292;&#23548;&#33268;&#23427;&#20204;&#26080;&#27861;&#27491;&#30830;&#36816;&#34892;&#12290;
						</p></div><p>
					&#36825;&#20010;&#23454;&#29616;&#21482;&#33021;&#22312;Java 5&#29615;&#22659;&#20013;&#20351;&#29992;&#65292;&#20294;&#26159;&#21364;&#26159;&#36825;&#20010;&#29615;&#22659;&#20013;&#26368;&#24120;&#29992;&#30340;&#12290;&#23427;&#26292;&#38706;&#30340;bean properties&#21487;&#20197;&#29992;&#26469;&#37197;&#32622;&#19968;&#20010;<tt class="classname">java.util.concurrent.ThreadPoolExecutor</tt>&#65292;&#25226;&#23427;&#21253;&#35013;&#21040;&#19968;&#20010;<tt class="interfacename">TaskExecutor</tt>&#20013;&#12290;&#22914;&#26524;&#20320;&#38656;&#35201;&#26356;&#21152;&#20808;&#36827;&#30340;&#31867;&#65292;&#27604;&#22914;<tt class="classname">ScheduledThreadPoolExecutor</tt>,&#25105;&#20204;&#24314;&#35758;&#20320;&#20351;&#29992;<a href="scheduling.html#concurrentTaskExecutor"><tt class="classname">ConcurrentTaskExecutor</tt></a>&#26469;&#26367;&#20195;&#12290;
                    </p></li><li><p>
						<tt class="classname">TimerTaskExecutor</tt>&#31867;
					</p><p>
						&#36825;&#20010;&#23454;&#29616;&#20351;&#29992;&#19968;&#20010;<tt class="classname">TimerTask</tt>&#20316;&#20026;&#20854;&#32972;&#21518;&#30340;&#23454;&#29616;&#12290;&#23427;&#21644;<a href="scheduling.html#syncTaskExecutor"><tt class="classname">SyncTaskExecutor</tt></a>&#30340;&#19981;&#21516;&#22312;&#20110;&#65292;&#26041;&#27861;&#35843;&#29992;&#26159;&#22312;&#19968;&#20010;&#29420;&#31435;&#30340;&#32447;&#31243;&#20013;&#36827;&#34892;&#30340;&#65292;&#34429;&#28982;&#22312;&#37027;&#20010;&#32447;&#31243;&#20013;&#26159;&#21516;&#27493;&#30340;&#12290;
					</p></li><li><p>
						<tt class="classname">WorkManagerTaskExecutor</tt>&#31867;
					</p><div class="sidebar"><p>
							CommonJ &#26159;BEA&#21644;IBM&#32852;&#21512;&#24320;&#21457;&#30340;&#19968;&#22871;&#35268;&#33539;&#12290;&#36825;&#20123;&#35268;&#33539;&#24182;&#38750;Java EE&#30340;&#26631;&#20934;&#65292;&#20294;&#23427;&#26159;BEA&#21644;IBM&#30340;&#24212;&#29992;&#26381;&#21153;&#22120;&#23454;&#29616;&#30340;&#20849;&#21516;&#26631;&#20934;
						</p></div><p>
					&#36825;&#20010;&#23454;&#29616;&#20351;&#29992;&#20102;CommonJ WorkManager&#20316;&#20026;&#20854;&#24213;&#23618;&#23454;&#29616;&#65292;&#26159;&#22312;Spring context&#20013;&#37197;&#32622;CommonJ WorkManager&#24212;&#29992;&#30340;&#26368;&#37325;&#35201;&#30340;&#31867;&#12290;&#21644;<a href="scheduling.html#simpleThreadPoolTaskExecutor"><tt class="classname">SimpleThreadPoolTaskExecutor</tt></a>&#31867;&#20284;&#65292;&#36825;&#20010;&#31867;&#23454;&#29616;&#20102;WorkManager&#25509;&#21475;&#65292;&#22240;&#27492;&#21487;&#20197;&#30452;&#25509;&#20316;&#20026;WorkManager&#20351;&#29992;&#12290;
					</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="scheduling-task-executor-usage"></a>23.4.3.&nbsp;&#20351;&#29992;<tt class="interfacename">TaskExecutor</tt></h3></div></div><div></div></div><p>
				Spring&#30340;<tt class="interfacename">TaskExecutor</tt>&#23454;&#29616;&#20316;&#20026;&#19968;&#20010;&#31616;&#21333;&#30340;JavaBeans&#20351;&#29992;&#12290;&#22312;&#19979;&#38754;&#30340;&#31034;&#20363;&#20013;&#65292;&#25105;&#20204;&#23450;&#20041;&#19968;&#20010;bean,&#20351;&#29992; <tt class="classname">ThreadPoolTaskExecutor</tt>&#26469;&#24322;&#27493;&#25171;&#21360;&#20986;&#19968;&#31995;&#21015;&#23383;&#31526;&#20018;&#12290;
			</p><pre class="programlisting">import org.springframework.core.task.TaskExecutor;

public class TaskExecutorExample {

  private class MessagePrinterTask implements Runnable {

    private String message;

    public MessagePrinterTask(String message) {
      this.message = message;
    }

    public void run() {
      System.out.println(message);
    }

  }

  private TaskExecutor taskExecutor;

  public TaskExecutorExample(TaskExecutor taskExecutor) {
    this.taskExecutor = taskExecutor;
  }

  public void printMessages() {
    for(int i = 0; i &lt; 25; i++) {
      taskExecutor.execute(new MessagePrinterTask("Message" + i));
    }
  }
}</pre><p>
				&#21487;&#20197;&#30475;&#21040;&#65292;&#26080;&#38656;&#20320;&#33258;&#24049;&#20174;&#27744;&#20013;&#33719;&#21462;&#19968;&#20010;&#32447;&#31243;&#26469;&#25191;&#34892;&#65292;&#20320;&#25226;&#33258;&#24049;&#30340;<tt class="classname">Runnable</tt>&#31867;&#21152;&#20837;&#21040;&#38431;&#21015;&#20013;&#21435;&#65292;<tt class="interfacename">TaskExecutor</tt>&#20351;&#29992;&#23427;&#33258;&#24049;&#30340;&#20869;&#32622;&#35268;&#21017;&#26469;&#20915;&#23450;&#20309;&#26102;&#24212;&#35813;&#25191;&#34892;&#20219;&#21153;&#12290;
			</p><p>
				&#20026;&#20102;&#37197;&#32622;<tt class="interfacename">TaskExecutor</tt>&#20351;&#29992;&#30340;&#35268;&#21017;&#65292;&#26292;&#38706;&#20102;&#31616;&#21333;&#30340;bean properties&#12290;
			</p><pre class="programlisting">&lt;bean id="taskExecutor" class="org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor"&gt;
  &lt;property name="corePoolSize" value="5" /&gt;
  &lt;property name="maxPoolSize" value="10" /&gt;
  &lt;property name="queueCapacity" value="25" /&gt;
&lt;/bean&gt;

&lt;bean id="taskExecutorExample" class="TaskExecutorExample"&gt;
  &lt;constructor-arg ref="taskExecutor" /&gt;
&lt;/bean&gt;</pre></div></div></div><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mail.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="dynamic-language.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;22.&nbsp;Spring&#37038;&#20214;&#25277;&#35937;&#23618;&nbsp;</td><td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.springsource.com/" title="SpringSource">Sponsored by SpringSource</a></span></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;24.&nbsp;&#21160;&#24577;&#35821;&#35328;&#25903;&#25345;</td></tr></table></div></body></html>