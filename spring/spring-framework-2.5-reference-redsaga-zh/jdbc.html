<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;11.&nbsp;&#20351;&#29992;JDBC&#36827;&#34892;&#25968;&#25454;&#35775;&#38382;</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.60.1"><link rel="home" href="index.html" title="Spring Framework &#24320;&#21457;&#21442;&#32771;&#25163;&#20876;"><link rel="up" href="spring-middle-tier.html" title="Part&nbsp;II.&nbsp;&#20013;&#38388;&#23618;&#25968;&#25454;&#35775;&#38382;"><link rel="previous" href="dao.html" title="Chapter&nbsp;10.&nbsp;DAO&#25903;&#25345;"><link rel="next" href="orm.html" title="Chapter&nbsp;12.&nbsp;&#20351;&#29992;ORM&#24037;&#20855;&#36827;&#34892;&#25968;&#25454;&#35775;&#38382;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" style="background-color:white;border:none;height:73px;border:1px solid black;"><a style="border:none;" href="http://www.springframework.org/" title="The Spring Framework"><img style="border:none;" src="images/xdev-spring_logo.jpg"></a><a style="border:none;" href="http://www.springsource.com/" title="SpringSource"><img style="border:none;position:absolute;padding-top:5px;right:42px;" src="images/springsource-banner-rhs.png"></a></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="jdbc"></a>Chapter&nbsp;11.&nbsp;&#20351;&#29992;JDBC&#36827;&#34892;&#25968;&#25454;&#35775;&#38382;</h2></div></div><div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jdbc-introduction"></a>11.1.&nbsp;&#31616;&#20171;</h2></div></div><div></div></div><p>
			Spring JDBC&#25277;&#35937;&#26694;&#26550;&#25152;&#24102;&#26469;&#30340;&#20215;&#20540;&#23558;&#22312;&#20197;&#19979;&#20960;&#20010;&#26041;&#38754;&#24471;&#20197;&#20307;&#29616;&#65306;&#65288;&#27880;&#65306;&#20351;&#29992;&#20102;Spring JDBC&#25277;&#35937;&#26694;&#26550;&#20043;&#21518;&#65292;&#24212;&#29992;&#24320;&#21457;&#20154;&#21592;&#21482;&#38656;&#35201;&#23436;&#25104;&#26012;&#20307;&#23383;&#37096;&#20998;&#30340;&#32534;&#30721;&#24037;&#20316;&#12290;&#65289;
		</p><div class="orderedlist"><ol type="1"><li><p>&#23450;&#20041;&#25968;&#25454;&#24211;&#36830;&#25509;&#21442;&#25968;</p></li><li><p>&#25171;&#24320;&#25968;&#25454;&#24211;&#36830;&#25509;</p></li><li><p><span class="emphasis"><em>&#22768;&#26126;SQL&#35821;&#21477;</em></span></p></li><li><p>&#39044;&#32534;&#35793;&#24182;&#25191;&#34892;SQL&#35821;&#21477;</p></li><li><p>&#36941;&#21382;&#26597;&#35810;&#32467;&#26524;&#65288;&#22914;&#26524;&#38656;&#35201;&#30340;&#35805;&#65289;</p></li><li><p><span class="emphasis"><em>&#22788;&#29702;&#27599;&#19968;&#27425;&#36941;&#21382;&#25805;&#20316;</em></span></p></li><li><p>&#22788;&#29702;&#25243;&#20986;&#30340;&#20219;&#20309;&#24322;&#24120;</p></li><li><p>&#22788;&#29702;&#20107;&#21153;</p></li><li><p>&#20851;&#38381;&#25968;&#25454;&#24211;&#36830;&#25509;</p></li></ol></div><p>
			Spring&#23558;&#26367;&#25105;&#20204;&#23436;&#25104;&#25152;&#26377;&#20351;&#29992;JDBC API&#36827;&#34892;&#24320;&#21457;&#30340;&#21333;&#35843;&#20047;&#21619;&#30340;&#12289;&#24213;&#23618;&#32454;&#33410;&#22788;&#29702;&#24037;&#20316;&#12290;
		</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-choose-style"></a>11.1.1.&nbsp;&#36873;&#25321;&#19968;&#31181;&#24037;&#20316;&#27169;&#24335;</h3></div></div><div></div></div><p>
      	&#20351;&#29992;Spring&#36827;&#34892;&#22522;&#26412;&#30340;JDBC&#35775;&#38382;&#25968;&#25454;&#24211;&#26377;&#22810;&#31181;&#36873;&#25321;&#12290;Spring&#33267;&#23569;&#25552;&#20379;&#20102;&#19977;&#31181;&#19981;&#21516;&#30340;&#24037;&#20316;&#27169;&#24335;&#65306;JdbcTemplate, &#19968;&#20010;&#22312;Spring2.5&#20013;&#26032;&#25552;&#20379;&#30340;SimpleJdbc&#31867;&#33021;&#22815;&#26356;&#22909;&#30340;&#22788;&#29702;&#25968;&#25454;&#24211;&#20803;&#25968;&#25454;; &#36824;&#26377;&#19968;&#31181;&#31216;&#20043;&#20026;RDBMS Object&#30340;&#39118;&#26684;&#30340;&#38754;&#21521;&#23545;&#35937;&#23553;&#35013;&#26041;&#24335;, &#26377;&#28857;&#31867;&#20284;&#20110;JDO&#30340;&#26597;&#35810;&#35774;&#35745;&#12290;
      	&#25105;&#20204;&#22312;&#36825;&#37324;&#31616;&#35201;&#21015;&#20030;&#20320;&#37319;&#21462;&#26576;&#19968;&#31181;&#24037;&#20316;&#26041;&#24335;&#30340;&#20027;&#35201;&#29702;&#30001;. &#19981;&#36807;&#35831;&#27880;&#24847;, &#21363;&#20351;&#20320;&#36873;&#25321;&#20102;&#20854;&#20013;&#30340;&#19968;&#31181;&#24037;&#20316;&#27169;&#24335;, &#20320;&#20381;&#28982;&#21487;&#20197;&#22312;&#20320;&#30340;&#20195;&#30721;&#20013;&#28151;&#29992;&#20854;&#20182;&#20219;&#20309;&#19968;&#31181;&#27169;&#24335;&#20197;&#33719;&#21462;&#20854;&#24102;&#26469;&#30340;&#22909;&#22788;&#21644;&#20248;&#21183;&#12290;
      	&#25152;&#26377;&#30340;&#24037;&#20316;&#27169;&#24335;&#37117;&#24517;&#39035;&#35201;&#27714;JDBC 2.0&#20197;&#19978;&#30340;&#25968;&#25454;&#24211;&#39537;&#21160;&#30340;&#25903;&#25345;, &#20854;&#20013;&#19968;&#20123;&#39640;&#32423;&#30340;&#21151;&#33021;&#21487;&#33021;&#38656;&#35201;JDBC 3.0&#20197;&#19978;&#30340;&#25968;&#25454;&#24211;&#39537;&#21160;&#25903;&#25345;&#12290;
      </p><div class="itemizedlist"><ul type="disc"><li><p>
          	<span class="bold"><b>JdbcTemplate</b></span> - &#36825;&#26159;&#32463;&#20856;&#30340;&#20063;&#26159;&#26368;&#24120;&#29992;&#30340;Spring&#23545;&#20110;JDBC&#35775;&#38382;&#30340;&#26041;&#26696;&#12290;&#36825;&#20063;&#26159;&#26368;&#20302;&#32423;&#21035;&#30340;&#23553;&#35013;, &#20854;&#20182;&#30340;&#24037;&#20316;&#27169;&#24335;&#20107;&#23454;&#19978;&#22312;&#24213;&#23618;&#20351;&#29992;&#20102;JdbcTemplate&#20316;&#20026;&#20854;&#24213;&#23618;&#30340;&#23454;&#29616;&#22522;&#30784;&#12290;JdbcTemplate&#22312;JDK 1.4&#20197;&#19978;&#30340;&#29615;&#22659;&#19978;&#24037;&#20316;&#24471;&#24456;&#22909;&#12290;
          </p></li><li><p>
           		<span class="bold"><b>NamedParameterJdbcTemplate</b></span> - &#23545;JdbcTemplate&#20570;&#20102;&#23553;&#35013;&#65292;&#25552;&#20379;&#20102;&#26356;&#21152;&#20415;&#25463;&#30340;&#22522;&#20110;&#21629;&#21517;&#21442;&#25968;&#30340;&#20351;&#29992;&#26041;&#24335;&#32780;&#19981;&#26159;&#20256;&#32479;&#30340;JDBC&#25152;&#20351;&#29992;&#30340;&#8220;?&#8221;&#20316;&#20026;&#21442;&#25968;&#30340;&#21344;&#20301;&#31526;&#12290;&#36825;&#31181;&#26041;&#24335;&#22312;&#20320;&#38656;&#35201;&#20026;&#26576;&#20010;SQL&#25351;&#23450;&#35768;&#22810;&#20010;&#21442;&#25968;&#26102;&#65292;&#26174;&#24471;&#26356;&#21152;&#30452;&#35266;&#32780;&#26131;&#29992;&#12290;&#35813;&#29305;&#24615;&#24517;&#39035;&#24037;&#20316;&#22312;JDK 1.4&#20197;&#19978;&#12290;
           </p></li><li><p>
          		<span class="bold"><b>SimpleJdbcTemplate</b></span> - &#36825;&#20010;&#31867;&#32467;&#21512;&#20102;JdbcTemplate&#21644;NamedParameterJdbcTemplate&#30340;&#26368;&#24120;&#29992;&#30340;&#21151;&#33021;&#65292;&#21516;&#26102;&#23427;&#20063;&#21033;&#29992;&#20102;&#19968;&#20123;Java 5&#30340;&#29305;&#24615;&#25152;&#24102;&#26469;&#30340;&#20248;&#21183;&#65292;&#20363;&#22914;&#27867;&#22411;&#12289;varargs&#21644;autoboxing&#31561;&#65292;&#20174;&#32780;&#25552;&#20379;&#20102;&#26356;&#21152;&#31616;&#20415;&#30340;API&#35775;&#38382;&#26041;&#24335;&#12290;&#38656;&#35201;&#24037;&#20316;&#22312;Java 5&#20197;&#19978;&#30340;&#29615;&#22659;&#20013;&#12290;
          </p></li><li><p>
          		<span class="bold"><b>SimpleJdbcInsert &#21644; SimpleJdbcCall</b></span> - &#36825;&#20004;&#20010;&#31867;&#21487;&#20197;&#20805;&#20998;&#21033;&#29992;&#25968;&#25454;&#24211;&#20803;&#25968;&#25454;&#30340;&#29305;&#24615;&#26469;&#31616;&#21270;&#37197;&#32622;&#12290;&#36890;&#36807;&#20351;&#29992;&#36825;&#20004;&#20010;&#31867;&#36827;&#34892;&#32534;&#31243;&#65292;&#20320;&#21487;&#20197;&#20165;&#20165;&#25552;&#20379;&#25968;&#25454;&#24211;&#34920;&#21517;&#25110;&#32773;&#23384;&#20648;&#36807;&#31243;&#30340;&#21517;&#31216;&#20197;&#21450;&#19968;&#20010;Map&#20316;&#20026;&#21442;&#25968;&#12290;&#20854;&#20013;Map&#30340;key&#38656;&#35201;&#19982;&#25968;&#25454;&#24211;&#34920;&#20013;&#30340;&#23383;&#27573;&#20445;&#25345;&#19968;&#33268;&#12290;&#36825;&#20004;&#20010;&#31867;&#36890;&#24120;&#21644;SimpleJdbcTemplate&#37197;&#21512;&#20351;&#29992;&#12290;&#36825;&#20004;&#20010;&#31867;&#38656;&#35201;&#24037;&#20316;&#22312;JDK 5&#20197;&#19978;&#65292;&#21516;&#26102;&#25968;&#25454;&#24211;&#38656;&#35201;&#25552;&#20379;&#36275;&#22815;&#30340;&#20803;&#25968;&#25454;&#20449;&#24687;&#12290;
          </p></li><li><p>
          	<span class="bold"><b>RDBMS &#23545;&#35937;&#21253;&#25324;MappingSqlQuery, SqlUpdate and StoredProcedure</b></span> - &#36825;&#31181;&#26041;&#24335;&#20801;&#35768;&#20320;&#22312;&#21021;&#22987;&#21270;&#20320;&#30340;&#25968;&#25454;&#35775;&#38382;&#23618;&#26102;&#21019;&#24314;&#21487;&#37325;&#29992;&#24182;&#19988;&#32447;&#31243;&#23433;&#20840;&#30340;&#23545;&#35937;&#12290;&#35813;&#23545;&#35937;&#22312;&#20320;&#23450;&#20041;&#20102;&#20320;&#30340;&#26597;&#35810;&#35821;&#21477;&#65292;&#22768;&#26126;&#26597;&#35810;&#21442;&#25968;&#24182;&#32534;&#35793;&#30456;&#24212;&#30340;Query&#20043;&#21518;&#34987;&#27169;&#22411;&#21270;&#12290;&#19968;&#26086;&#27169;&#22411;&#21270;&#23436;&#25104;&#65292;&#20219;&#20309;&#25191;&#34892;&#20989;&#25968;&#23601;&#21487;&#20197;&#20256;&#20837;&#19981;&#21516;&#30340;&#21442;&#25968;&#23545;&#20043;&#36827;&#34892;&#22810;&#27425;&#35843;&#29992;&#12290;&#36825;&#31181;&#26041;&#24335;&#38656;&#35201;&#24037;&#20316;&#22312;JDK 1.4&#20197;&#19978;&#12290;
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-packages"></a>11.1.2.&nbsp;Spring JDBC&#21253;&#32467;&#26500;</h3></div></div><div></div></div><p>
			Spring Framework&#30340;JDBC&#25277;&#35937;&#26694;&#26550;&#30001;&#22235;&#20010;&#21253;&#26500;&#25104;&#65306;<tt class="literal">core</tt>&#12289; <tt class="literal">dataSource</tt>&#12289;<tt class="literal">object</tt>&#20197;&#21450;<tt class="literal">support</tt>&#12290;
	  </p><p>
			<tt class="literal">org.springframework.jdbc.core</tt>&#21253;&#30001;<tt class="classname">JdbcTemplate</tt>&#31867;&#20197;&#21450;&#30456;&#20851;&#30340;&#22238;&#35843;&#25509;&#21475;&#65288;callback interface&#65289;&#21644;&#31867;&#32452;&#25104;&#12290;
			<tt class="literal">org.springframework.jdbc.core.simple</tt> &#23376;&#21253;&#21017;&#21253;&#21547;&#20102;
 <tt class="classname">SimpleJdbcTemplate</tt> &#31867;&#20197;&#21450;&#30456;&#20851;&#30340;<tt class="classname">SimpleJdbcInsert</tt> &#31867;&#21644;<tt class="classname">SimpleJdbcCall</tt> &#31867;&#12290;
			<tt class="literal">org.springframework.jdbc.core.namedparam</tt> &#23376;&#21253;&#21017;&#21253;&#21547;&#20102;<tt class="classname">NamedParameterJdbcTemplate</tt>	&#31867;&#20197;&#21450;&#20854;&#30456;&#20851;&#30340;&#25903;&#25345;&#31867;&#12290;
	  </p><p>
		<tt class="literal">org.springframework.jdbc.datasource</tt>&#21253;&#25552;&#20379;&#20102;&#19968;&#20123;&#24037;&#20855;&#31867;&#26469;&#31616;&#21270;&#23545;<tt class="interfacename">DataSource</tt>&#30340;&#35775;&#38382;&#12290;&#21516;&#26102;&#25552;&#20379;&#20102;&#22810;&#31181;&#31616;&#21333;&#30340;<tt class="interfacename">DataSource</tt>&#23454;&#29616;&#12290;&#36825;&#20123;&#23454;&#29616;&#21487;&#20197;&#33073;&#31163;J2EE&#23481;&#22120;&#36827;&#34892;&#29420;&#31435;&#27979;&#35797;&#21644;&#36816;&#34892;&#12290;
      &#36825;&#20123;&#24037;&#20855;&#31867;&#25552;&#20379;&#20102;&#19968;&#20123;&#38745;&#24577;&#26041;&#27861;&#65292;&#20801;&#35768;&#20320;&#36890;&#36807;JNDI&#26469;&#33719;&#21462;&#25968;&#25454;&#24211;&#36830;&#25509;&#21644;&#20851;&#38381;&#36830;&#25509;&#12290;&#21516;&#26102;&#25903;&#25345;&#32465;&#23450;&#21040;&#24403;&#21069;&#32447;&#31243;&#30340;&#25968;&#25454;&#24211;&#36830;&#25509;&#12290;&#20363;&#22914;&#20351;&#29992;<tt class="classname">DataSourceTransactionManager</tt>&#12290;
      </p><p>
	  	&#25509;&#30528;<tt class="literal">org.springframework.jdbc.object</tt>&#21253;&#21253;&#21547;&#20102;&#19968;&#20123;&#31867;&#65292;&#29992;&#20110;&#23558;RDBMS&#26597;&#35810;&#12289;&#26356;&#26032;&#20197;&#21450;&#23384;&#20648;&#36807;&#31243;&#34920;&#36848;&#20026;&#19968;&#20123;&#21487;&#37325;&#29992;&#30340;&#12289;&#32447;&#31243;&#23433;&#20840;&#30340;&#23545;&#35937;&#12290;&#36825;&#31181;&#26041;&#24335;&#36890;&#36807;JDO&#36827;&#34892;&#27169;&#22411;&#21270;&#65292;&#19981;&#36807;&#36825;&#20123;&#36890;&#36807;&#26597;&#35810;&#36820;&#22238;&#30340;&#23545;&#35937;&#26159;&#19982;&#25968;&#25454;&#24211;&#33073;&#31163;&#30340;&#23545;&#35937;&#12290; &#36825;&#31181;&#23545;&#20110;JDBC&#30340;&#39640;&#23618;&#27425;&#30340;&#23553;&#35013;&#26159;&#22522;&#20110;<tt class="literal">org.springframework.jdbc.core</tt>&#21253;&#23545;JDBC&#30340;&#20302;&#23618;&#27425;&#23553;&#35013;&#20043;&#19978;&#30340;&#12290;
	  </p><p>
		&#26368;&#21518;&#65292;<tt class="literal">org.springframework.jdbc.support</tt>&#21253;&#23450;&#20041;&#20102;<tt class="classname">SQLException</tt>&#36716;&#21270;&#31867;&#20197;&#21450;&#19968;&#20123;&#20854;&#20182;&#30340;&#24037;&#20855;&#31867;&#12290;
		</p><p>
      &#22312;JDBC&#35843;&#29992;&#36807;&#31243;&#20013;&#25152;&#25243;&#20986;&#30340;&#24322;&#24120;&#37117;&#20250;&#34987;&#36716;&#21270;&#20026;&#22312;<tt class="literal">org.springframework.dao</tt>&#21253;&#20013;&#23450;&#20041;&#30340;&#24322;&#24120;&#12290;&#20063;&#23601;&#26159;&#35828;&#65292;&#20961;&#26159;&#20351;&#29992;Spring&#30340;JDBC&#23553;&#35013;&#23618;&#30340;&#20195;&#30721;&#26080;&#38656;&#23454;&#29616;&#20219;&#20309;JDBC&#25110;&#32773;RDBMS&#30456;&#20851;&#30340;&#24322;&#24120;&#22788;&#29702;&#12290;&#25152;&#26377;&#30340;&#36825;&#20123;&#34987;&#36716;&#21270;&#30340;&#24322;&#24120;&#37117;&#26159;unchecked&#24322;&#24120;&#65292;&#22240;&#32780;&#20063;&#32473;&#20102;&#20320;&#19968;&#31181;&#39069;&#22806;&#30340;&#36873;&#25321;&#65292;&#20320;&#21487;&#20197;&#25235;&#20303;&#36825;&#20123;&#24322;&#24120;&#65292;&#20174;&#32780;&#36716;&#21270;&#25104;&#20854;&#20182;&#31867;&#22411;&#30340;&#24322;&#24120;&#34987;&#20801;&#35768;&#35843;&#29992;&#32773;&#20256;&#25773;&#12290;
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jdbc-core"></a>11.2.&nbsp;&#21033;&#29992;JDBC&#26680;&#24515;&#31867;&#25511;&#21046;JDBC&#30340;&#22522;&#26412;&#25805;&#20316;&#21644;&#38169;&#35823;&#22788;&#29702;</h2></div></div><div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-JdbcTemplate"></a>11.2.1.&nbsp;<tt class="classname">JdbcTemplate</tt>&#31867;</h3></div></div><div></div></div><p>
			<tt class="classname">JdbcTemplate</tt>&#26159;core&#21253;&#30340;&#26680;&#24515;&#31867;&#12290;&#23427;&#26367;&#25105;&#20204;&#23436;&#25104;&#20102;&#36164;&#28304;&#30340;&#21019;&#24314;&#20197;&#21450;&#37322;&#25918;&#24037;&#20316;&#65292;&#20174;&#32780;&#31616;&#21270;&#20102;&#25105;&#20204;&#23545;JDBC&#30340;&#20351;&#29992;&#12290;
			&#23427;&#36824;&#21487;&#20197;&#24110;&#21161;&#25105;&#20204;&#36991;&#20813;&#19968;&#20123;&#24120;&#35265;&#30340;&#38169;&#35823;&#65292;&#27604;&#22914;&#24536;&#35760;&#20851;&#38381;&#25968;&#25454;&#24211;&#36830;&#25509;&#12290;
			JdbcTemplate&#23558;&#23436;&#25104;JDBC&#26680;&#24515;&#22788;&#29702;&#27969;&#31243;&#65292;&#27604;&#22914;SQL&#35821;&#21477;&#30340;&#21019;&#24314;&#12289;&#25191;&#34892;&#65292;&#32780;&#25226;SQL&#35821;&#21477;&#30340;&#29983;&#25104;&#20197;&#21450;&#26597;&#35810;&#32467;&#26524;&#30340;&#25552;&#21462;&#24037;&#20316;&#30041;&#32473;&#25105;&#20204;&#30340;&#24212;&#29992;&#20195;&#30721;&#12290;
			&#23427;&#21487;&#20197;&#23436;&#25104;SQL&#26597;&#35810;&#12289;&#26356;&#26032;&#20197;&#21450;&#35843;&#29992;&#23384;&#20648;&#36807;&#31243;&#65292;&#21487;&#20197;&#23545;<tt class="interfacename">ResultSet</tt>&#36827;&#34892;&#36941;&#21382;&#24182;&#21152;&#20197;&#25552;&#21462;&#12290;
			&#23427;&#36824;&#21487;&#20197;&#25429;&#33719;JDBC&#24322;&#24120;&#24182;&#23558;&#20854;&#36716;&#25442;&#25104;<tt class="literal">org.springframework.dao</tt>&#21253;&#20013;&#23450;&#20041;&#30340;&#65292;&#36890;&#29992;&#30340;&#65292;&#20449;&#24687;&#26356;&#20016;&#23500;&#30340;&#24322;&#24120;&#12290;
		</p><p>
			&#20351;&#29992;JdbcTemplate&#36827;&#34892;&#32534;&#30721;&#21482;&#38656;&#35201;&#26681;&#25454;&#26126;&#30830;&#23450;&#20041;&#30340;&#19968;&#32452;&#22865;&#32422;&#26469;&#23454;&#29616;&#22238;&#35843;&#25509;&#21475;&#12290;
			<tt class="interfacename">PreparedStatementCreator</tt>&#22238;&#35843;&#25509;&#21475;&#36890;&#36807;&#32473;&#23450;&#30340;<tt class="interfacename">Connection</tt>&#21019;&#24314;&#19968;&#20010;PreparedStatement&#65292;&#21253;&#21547;SQL&#21644;&#20219;&#20309;&#30456;&#20851;&#30340;&#21442;&#25968;&#12290;
			<tt class="literal">CallableStatementCreateor</tt>&#23454;&#29616;&#21516;&#26679;&#30340;&#22788;&#29702;&#65292;&#21482;&#19981;&#36807;&#23427;&#21019;&#24314;&#30340;&#26159;CallableStatement&#12290;
			<tt class="literal">RowCallbackHandler</tt>&#25509;&#21475;&#21017;&#20174;&#25968;&#25454;&#38598;&#30340;&#27599;&#19968;&#34892;&#20013;&#25552;&#21462;&#20540;&#12290;
		</p><p>
			&#25105;&#20204;&#21487;&#20197;&#22312;DAO&#23454;&#29616;&#31867;&#20013;&#36890;&#36807;&#20256;&#36882;&#19968;&#20010;<tt class="interfacename">DataSource</tt>&#24341;&#29992;&#26469;&#23436;&#25104;JdbcTemplate&#30340;&#23454;&#20363;&#21270;&#65292;&#20063;&#21487;&#20197;&#22312;Spring&#30340;IoC&#23481;&#22120;&#20013;&#37197;&#32622;&#19968;&#20010;JdbcTemplate&#30340;bean&#24182;&#36171;&#20104;DAO&#23454;&#29616;&#31867;&#20316;&#20026;&#19968;&#20010;&#23454;&#20363;&#12290;
			&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;<tt class="interfacename">DataSource</tt>&#22312;Spring&#30340;IoC&#23481;&#22120;&#20013;&#24635;&#26159;&#37197;&#21046;&#25104;&#19968;&#20010;bean&#65292;&#31532;&#19968;&#31181;&#24773;&#20917;&#19979;&#65292;<tt class="interfacename">DataSource</tt> bean&#23558;&#20256;&#36882;&#32473;service&#65292;&#31532;&#20108;&#31181;&#24773;&#20917;&#19979;<tt class="interfacename">DataSource</tt> bean&#20256;&#36882;&#32473;JdbcTemplate bean&#12290;
		</p><p>
			&#26368;&#21518;&#65292;JdbcTemplate&#20013;&#20351;&#29992;&#30340;&#25152;&#26377;SQL&#23558;&#20250;&#20197;&#8220;DEBUG&#8221;&#32423;&#21035;&#35760;&#20837;&#26085;&#24535;&#65288;&#19968;&#33324;&#24773;&#20917;&#19979;&#26085;&#24535;&#30340;category&#26159;<tt class="classname">JdbcTemplate</tt>&#30456;&#24212;&#30340;&#20840;&#38480;&#23450;&#31867;&#21517;&#65292;&#19981;&#36807;&#22914;&#26524;&#38656;&#35201;&#23545;<tt class="classname">JdbcTemplate</tt>&#36827;&#34892;&#23450;&#21046;&#30340;&#35805;&#65292;&#21487;&#33021;&#26159;&#23427;&#30340;&#23376;&#31867;&#21517;&#65289;&#12290;
		</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="jdbc-JdbcTemplate-examples"></a>11.2.1.1.&nbsp;&#19968;&#20123;&#31034;&#20363;</h4></div></div><div></div></div><p>
		&#19979;&#38754;&#26159;&#19968;&#20123;&#20351;&#29992;<tt class="classname">JdbcTemplate</tt>&#31867;&#30340;&#31034;&#20363;&#12290;&#65288;&#36825;&#20123;&#31034;&#20363;&#24182;&#19981;&#26159;&#23436;&#25972;&#23637;&#31034;&#25152;&#26377;&#30340;<tt class="classname">JdbcTemplate</tt>&#25152;&#26292;&#38706;&#20986;&#26469;&#30340;&#21151;&#33021;&#12290;&#35831;&#26597;&#30475;&#19982;&#20043;&#30456;&#20851;&#30340;Javadoc&#65289;&#12290;
		</p><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="jdbc-JdbcTemplate-examples-query"></a>11.2.1.1.1.&nbsp;&#26597;&#35810;&#65288;SELECT&#65289;</h5></div></div><div></div></div><p>&#19968;&#20010;&#31616;&#21333;&#30340;&#20363;&#23376;&#29992;&#20110;&#23637;&#31034;&#22914;&#20309;&#33719;&#21462;&#19968;&#20010;&#34920;&#20013;&#30340;&#25152;&#26377;&#34892;&#25968;&#12290;</p><pre class="programlisting">int rowCount = this.jdbcTemplate.queryForInt("select count(0) from t_accrual");</pre><p>&#19968;&#20010;&#31616;&#21333;&#30340;&#20363;&#23376;&#23637;&#31034;&#22914;&#20309;&#36827;&#34892;&#21442;&#25968;&#32465;&#23450;&#12290;</p><pre class="programlisting">int countOfActorsNamedJoe = this.jdbcTemplate.queryForInt(
        "select count(0) from t_actors where first_name = ?", new Object[]{"Joe"});</pre><p>&#26597;&#35810;&#19968;&#20010;<tt class="classname">String</tt>&#12290;</p><pre class="programlisting">String surname = (String) this.jdbcTemplate.queryForObject(
        "select surname from t_actor where id = ?", 
        new Object[]{new Long(1212)}, String.class);</pre><p>&#26597;&#35810;&#24182;&#23558;&#32467;&#26524;&#35760;&#24405;&#20026;&#19968;&#20010;&#31616;&#21333;&#30340;&#25968;&#25454;&#27169;&#22411;&#12290;</p><pre class="programlisting">Actor actor = (Actor) this.jdbcTemplate.queryForObject(
    "select first_name, surname from t_actor where id = ?",
    new Object[]{new Long(1212)},
    new RowMapper() {

        public Object mapRow(ResultSet rs, int rowNum) throws SQLException {
            Actor actor = new Actor();
            actor.setFirstName(rs.getString("first_name"));
            actor.setSurname(rs.getString("surname"));
            return actor;
        }
    });</pre><p>&#26597;&#35810;&#24182;&#32452;&#35013;&#22810;&#20010;&#25968;&#25454;&#27169;&#22411;&#12290;</p><pre class="programlisting">Collection actors = this.jdbcTemplate.query(
    "select first_name, surname from t_actor",
    new RowMapper() {

        public Object mapRow(ResultSet rs, int rowNum) throws SQLException {
            Actor actor = new Actor();
            actor.setFirstName(rs.getString("first_name"));
            actor.setSurname(rs.getString("surname"));
            return actor;
        }
    });</pre><p>
		&#22914;&#26524;&#26368;&#21518;2&#20010;&#31034;&#20363;&#20013;&#30340;&#20195;&#30721;&#20986;&#29616;&#22312;&#21516;&#19968;&#27573;&#31243;&#24207;&#20013;&#65292;&#25105;&#20204;&#26377;&#24517;&#35201;&#21435;&#25481;&#36825;&#20123;&#37325;&#22797;&#30340;<tt class="interfacename">RowMapper</tt>&#21311;&#21517;&#31867;&#20195;&#30721;&#65292;&#23558;&#36825;&#20123;&#20195;&#30721;&#25277;&#21462;&#21040;&#19968;&#20010;&#21333;&#29420;&#30340;&#31867;&#20013;&#65288;&#36890;&#24120;&#26159;&#19968;&#20010;&#38745;&#24577;&#30340;&#20869;&#37096;&#31867;&#65289;&#12290;
			&#36825;&#26679;&#65292;&#36825;&#20010;&#20869;&#37096;&#31867;&#23601;&#21487;&#20197;&#22312;DAO&#30340;&#26041;&#27861;&#20013;&#34987;&#20849;&#20139;&#12290;&#22240;&#32780;&#65292;&#26368;&#21518;2&#20010;&#31034;&#20363;&#20889;&#25104;&#22914;&#19979;&#30340;&#24418;&#24335;&#23558;&#26356;&#21152;&#22909;&#65306;
		</p><pre class="programlisting">public Collection findAllActors() {
    return this.jdbcTemplate.query( "select first_name, surname from t_actor", new ActorMapper());
}

private static final class ActorMapper implements RowMapper {

    public Object mapRow(ResultSet rs, int rowNum) throws SQLException {
        Actor actor = new Actor();
        actor.setFirstName(rs.getString("first_name"));
        actor.setSurname(rs.getString("surname"));
        return actor;
    }
}</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="jdbc-JdbcTemplate-examples-update"></a>11.2.1.1.2.&nbsp;&#26356;&#26032;&#65288;INSERT/UPDATE/DELETE&#65289;</h5></div></div><div></div></div><pre class="programlisting">this.jdbcTemplate.update(
        "insert into t_actor (first_name, surname) values (?, ?)", 
        new Object[] {"Leonor", "Watling"});</pre><pre class="programlisting">this.jdbcTemplate.update(
        "update t_actor set weapon = ? where id = ?", 
        new Object[] {"Banjo", new Long(5276)});</pre><pre class="programlisting">this.jdbcTemplate.update(
        "delete from actor where id = ?",
        new Object[] {new Long.valueOf(actorId)});</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="jdbc-JdbcTemplate-examples-other"></a>11.2.1.1.3.&nbsp;&#20854;&#20182;&#25805;&#20316;</h5></div></div><div></div></div><p>
			<tt class="methodname">execute(..)</tt>&#26041;&#27861;&#21487;&#20197;&#34987;&#29992;&#20316;&#25191;&#34892;&#20219;&#20309;&#31867;&#22411;&#30340;SQL&#65292;&#29978;&#33267;&#26159;DDL&#35821;&#21477;&#12290;
					&#36825;&#20010;&#26041;&#27861;&#30340;&#23454;&#29616;&#38656;&#35201;&#20256;&#20837;&#19968;&#20010;&#22238;&#35843;&#25509;&#21475;&#12289;&#38656;&#35201;&#32465;&#23450;&#30340;&#21442;&#25968;&#25968;&#32452;&#31561;&#20316;&#20026;&#21442;&#25968;&#12290;
			</p><pre class="programlisting">this.jdbcTemplate.execute("create table mytable (id integer, name varchar(100))");</pre><p>&#35843;&#29992;&#19968;&#20010;&#31616;&#21333;&#30340;&#23384;&#20648;&#36807;&#31243;&#65288;&#26356;&#22810;&#22797;&#26434;&#30340;&#23384;&#20648;&#36807;&#31243;&#25903;&#25345;&#35831;&#21442;&#35265;<a href="jdbc.html#jdbc-StoredProcedure" title="11.6.4.&nbsp;StoredProcedure&#31867;">&#23384;&#20648;&#36807;&#31243;&#25903;&#25345;</a>&#65289;&#12290;</p><pre class="programlisting">this.jdbcTemplate.update(
        "call SUPPORT.REFRESH_ACTORS_SUMMARY(?)", 
        new Object[]{Long.valueOf(unionId)});</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="jdbc-JdbcTemplate-idioms"></a>11.2.1.2.&nbsp;<tt class="classname">JdbcTemplate</tt> &#30340;&#26368;&#20339;&#23454;&#36341;</h4></div></div><div></div></div><p>
		<tt class="classname">JdbcTemplate</tt>&#31867;&#30340;&#23454;&#20363;&#26159;&#32447;&#31243;&#23433;&#20840;&#30340;&#23454;&#20363;&#12290;&#36825;&#19968;&#28857;&#38750;&#24120;&#37325;&#35201;&#65292;&#27491;&#22240;&#20026;&#22914;&#27492;&#65292;&#20320;&#21487;&#20197;&#37197;&#32622;&#19968;&#20010;&#31616;&#21333;&#30340;<tt class="classname">JdbcTemplate</tt>&#23454;&#20363;&#65292;&#24182;&#23558;&#36825;&#20010;&#8220;&#20849;&#20139;&#30340;&#8221;&#12289;&#8220;&#23433;&#20840;&#30340;&#8221;&#23454;&#20363;&#27880;&#20837;&#21040;&#19981;&#21516;&#30340;DAO&#31867;&#20013;&#21435;&#12290;
			&#21478;&#22806;&#65292; <tt class="classname">JdbcTemplate</tt> &#26159;&#26377;&#29366;&#24577;&#30340;&#65292;&#22240;&#20026;&#20182;&#25152;&#32500;&#25252;&#30340;<tt class="interfacename">DataSource</tt> &#23454;&#20363;&#26159;&#26377;&#29366;&#24577;&#30340;&#65292;&#20294;&#26159;&#36825;&#31181;&#29366;&#24577;&#26159;&#26080;&#27861;&#21464;&#21270;&#30340;&#12290;
		</p><p>&#20351;&#29992;<tt class="classname">JdbcTemplate</tt>&#30340;&#19968;&#20010;&#24120;&#35265;&#30340;&#26368;&#20339;&#23454;&#36341;&#65288;&#21516;&#26102;&#20063;&#26159;<a href="jdbc.html#jdbc-SimpleJdbcTemplate" title="11.2.3.&nbsp;SimpleJdbcTemplate&#31867;"><tt class="classname">SimpleJdbcTemplate</tt></a>&#21644;<a href="jdbc.html#jdbc-NamedParameterJdbcTemplate" title="11.2.2.&nbsp;NamedParameterJdbcTemplate&#31867;"><tt class="classname">NamedParameterJdbcTemplate</tt></a>
        &#31867;&#30340;&#26368;&#20339;&#23454;&#36341;&#65289;&#23601;&#26159;&#22312;Spring&#37197;&#32622;&#25991;&#20214;&#20013;&#37197;&#32622;&#19968;&#20010;<tt class="interfacename">DataSource</tt>&#23454;&#20363;&#65292;&#28982;&#21518;&#23558;&#36825;&#20010;&#20849;&#20139;&#30340;<tt class="interfacename">DataSource</tt>&#23454;&#20363;&#21161;&#20110;&#21040;&#20320;&#30340;DAO&#20013;&#21435;&#12290;
        &#32780;<tt class="classname">JdbcTemplate</tt>&#30340;&#23454;&#20363;&#23558;&#22312;<tt class="interfacename">DataSource</tt>&#30340;setter&#26041;&#27861;&#20013;&#34987;&#21019;&#24314;&#12290;&#36825;&#26679;&#30340;&#35805;&#65292;DAO&#21487;&#33021;&#30475;&#19978;&#21435;&#20687;&#36825;&#26679;&#65306;</p><pre class="programlisting">public class JdbcCorporateEventDao implements CorporateEventDao {

    private JdbcTemplate jdbcTemplate;

    public void setDataSource(DataSource dataSource) {
        <span class="bold"><b>this.jdbcTemplate = new JdbcTemplate(dataSource);</b></span>
    }

    <i class="lineannotation"><span class="lineannotation">// JDBC-backed implementations of the methods on the <tt class="interfacename">CorporateEventDao</tt> follow...</span></i>
}</pre><p>&#30456;&#20851;&#30340;&#37197;&#32622;&#30475;&#19978;&#21435;&#23601;&#20687;&#36825;&#26679;&#12290;</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans 
       http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"&gt;

    &lt;bean id="corporateEventDao" class="com.example.JdbcCorporateEventDao"&gt;
        &lt;property name="dataSource" ref="dataSource"/&gt;
    &lt;/bean&gt;

    <i class="lineannotation"><span class="lineannotation">&lt;!-- the <tt class="interfacename">DataSource</tt> (parameterized for configuration via a <a href="beans.html#beans-factory-placeholderconfigurer" title="3.7.2.1.&nbsp;PropertyPlaceholderConfigurer&#31034;&#20363;"><tt class="classname">PropertyPlaceHolderConfigurer</tt></a>) --&gt;</span></i>
    &lt;bean id="dataSource" destroy-method="close" class="org.apache.commons.dbcp.BasicDataSource"&gt;
        &lt;property name="driverClassName" value="${jdbc.driverClassName}"/&gt;
        &lt;property name="url" value="${jdbc.url}"/&gt;
        &lt;property name="username" value="${jdbc.username}"/&gt;
        &lt;property name="password" value="${jdbc.password}"/&gt;
    &lt;/bean&gt;

&lt;/beans&gt;</pre><p>
		&#22914;&#26524;&#20320;&#20351;&#29992;Spring&#25552;&#20379;&#30340;<tt class="classname">JdbcDaoSupport</tt>&#31867;&#65292;&#24182;&#19988;&#20320;&#30340;&#37027;&#20123;&#22522;&#20110;JDBC&#30340;DAO&#37117;&#32487;&#25215;&#33258;&#36825;&#20010;&#31867;&#65292;&#37027;&#20040;&#20320;&#20250;&#33258;&#21160;&#22320;&#20174;<tt class="classname">JdbcDaoSupport</tt>&#31867;&#20013;&#32487;&#25215;&#20102;<tt class="methodname">setDataSource(..)</tt>&#26041;&#27861;&#12290;
		&#26159;&#21542;&#23558;&#20320;&#30340;DAO&#31867;&#32487;&#25215;&#33258;&#36825;&#20123;&#31867;&#23436;&#20840;&#21462;&#20915;&#20110;&#20320;&#33258;&#24049;&#30340;&#20915;&#23450;&#65292;&#20107;&#23454;&#19978;&#36825;&#24182;&#19981;&#26159;&#24517;&#39035;&#30340;&#65292;&#22914;&#26524;&#20320;&#30475;&#19968;&#19979;<tt class="classname">JdbcDaoSupport</tt>&#31867;&#20320;&#20250;&#21457;&#29616;&#65292;&#36825;&#37324;&#21482;&#26159;&#25552;&#20379;&#20102;&#19968;&#20010;&#31616;&#20415;&#30340;&#26041;&#24335;&#32780;&#24050;&#12290;
		</p><p>
        &#26080;&#35770;&#20320;&#26159;&#21542;&#20351;&#29992;&#19978;&#36848;&#36825;&#31181;&#21021;&#22987;&#21270;&#26041;&#24335;&#65292;&#37117;&#26080;&#38656;&#22312;&#25191;&#34892;&#26576;&#20123;SQL&#25805;&#20316;&#26102;&#22810;&#27425;&#21019;&#24314;&#19968;&#20010;<tt class="classname">JdbcTemplate</tt>&#23454;&#20363;&#12290;&#35760;&#20303;&#65292;&#19968;&#26086;<tt class="classname">JdbcTemplate</tt>&#34987;&#21019;&#24314;&#65292;&#20182;&#26159;&#19968;&#20010;&#32447;&#31243;&#23433;&#20840;&#30340;&#23545;&#35937;&#12290;
        &#19968;&#20010;&#20320;&#38656;&#35201;&#21019;&#24314;&#22810;&#27425;<tt class="classname">JdbcTemplate</tt>&#23454;&#20363;&#30340;&#29702;&#30001;&#21487;&#33021;&#22312;&#20110;&#65292;&#20320;&#30340;&#24212;&#29992;&#38656;&#35201;&#35775;&#38382;&#22810;&#20010;&#19981;&#21516;&#30340;&#25968;&#25454;&#24211;&#65292;&#20174;&#32780;&#38656;&#35201;&#19981;&#21516;&#30340;<tt class="interfacename">DataSources</tt>&#26469;&#21019;&#24314;&#19981;&#21516;&#30340;<tt class="classname">JdbcTemplates</tt>&#23454;&#20363;&#12290;
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-NamedParameterJdbcTemplate"></a>11.2.2.&nbsp;<tt class="classname">NamedParameterJdbcTemplate</tt>&#31867;</h3></div></div><div></div></div><p>
      <tt class="classname">NamedParameterJdbcTemplate</tt>&#31867;&#20026;JDBC&#25805;&#20316;&#22686;&#21152;&#20102;&#21629;&#21517;&#21442;&#25968;&#30340;&#29305;&#24615;&#25903;&#25345;&#65292;&#32780;&#19981;&#26159;&#20256;&#32479;&#30340;&#20351;&#29992;&#65288;<tt class="literal">'?'</tt>&#65289;&#20316;&#20026;&#21442;&#25968;&#30340;&#21344;&#20301;&#31526;&#12290;<tt class="classname">NamedParameterJdbcTemplate</tt>&#31867;&#23545;<tt class="classname">JdbcTemplate</tt>&#31867;&#36827;&#34892;&#20102;&#23553;&#35013;&#65292;
      &#22312;&#24213;&#23618;&#65292;<tt class="classname">JdbcTemplate</tt>&#23436;&#25104;&#20102;&#22810;&#25968;&#30340;&#24037;&#20316;&#12290;&#36825;&#19968;&#20010;&#31456;&#33410;&#23558;&#20027;&#35201;&#25551;&#36848;<tt class="classname">NamedParameterJdbcTemplate</tt>&#31867;&#19982;<tt class="classname">JdbcTemplate</tt>&#31867;&#30340;&#19968;&#20123;&#21306;&#21035;&#65292;&#20063;&#23601;&#26159;&#20351;&#29992;&#21629;&#21517;&#21442;&#25968;&#36827;&#34892;JDBC&#25805;&#20316;&#12290;
      </p><pre class="programlisting"><i class="lineannotation"><span class="lineannotation">// some JDBC-backed DAO class...</span></i>
private NamedParameterJdbcTemplate namedParameterJdbcTemplate;

public void setDataSource(DataSource dataSource) {
    this.namedParameterJdbcTemplate = new NamedParameterJdbcTemplate(dataSource);
}

public int countOfActorsByFirstName(String firstName) {

    String sql = "select count(0) from T_ACTOR where first_name = :first_name";

    SqlParameterSource namedParameters = new MapSqlParameterSource("first_name", firstName);

    return namedParameterJdbcTemplate.queryForInt(sql, namedParameters);
}</pre><p>
			&#27880;&#24847;&#36825;&#37324;&#22312;<tt class="literal">'sql'</tt>&#20013;&#20351;&#29992;&#20102;&#21629;&#21517;&#21442;&#25968;&#20316;&#20026;&#21464;&#37327;&#65292;&#32780;&#36825;&#20010;&#21517;&#31216;&#25152;&#23545;&#24212;&#30340;&#20540;&#34987;&#23450;&#20041;&#22312;&#20256;&#20837;&#30340;<tt class="literal">'namedParameters'</tt>
&#20013;&#20316;&#20026;&#21442;&#25968;&#65288;&#20063;&#21487;&#20197;&#20256;&#20837;&#21040;<tt class="classname">MapSqlParameterSource</tt>&#20013;&#20316;&#20026;&#21442;&#25968;&#65289;&#12290;
		</p><p>
			&#20320;&#20063;&#21487;&#20197;&#20256;&#20837;&#35768;&#22810;&#21629;&#21517;&#21442;&#25968;&#20197;&#21450;&#20182;&#20204;&#25152;&#23545;&#24212;&#30340;&#20540;&#65292;&#20197;<tt class="interfacename">Map</tt>&#30340;&#26041;&#24335;&#65292;&#20316;&#20026;&#38190;&#20540;&#23545;&#20256;&#20837;&#21040;<tt class="classname">NamedParameterJdbcTemplate</tt>&#20013;&#12290;
      &#65288;&#20854;&#20313;&#30340;&#34987;<tt class="interfacename">NamedParameterJdbcOperations</tt>&#25152;&#26292;&#38706;&#30340;&#25509;&#21475;&#20197;&#21450;<tt class="classname">NamedParameterJdbcTemplate</tt>&#23454;&#29616;&#31867;&#36981;&#24490;&#20102;&#31867;&#20284;&#30340;&#26041;&#24335;&#65292;&#27492;&#22788;&#19981;&#21253;&#21547;&#30456;&#20851;&#20869;&#23481;&#65289;&#12290;
      		</p><pre class="programlisting"><i class="lineannotation"><span class="lineannotation">// some JDBC-backed DAO class...</span></i>
private NamedParameterJdbcTemplate namedParameterJdbcTemplate;

public void setDataSource(DataSource dataSource) {
    this.namedParameterJdbcTemplate = new NamedParameterJdbcTemplate(dataSource);
}

public int countOfActorsByFirstName(String firstName) {

    String sql = "select count(0) from T_ACTOR where first_name = :first_name";

    Map namedParameters = Collections.singletonMap("first_name", firstName);

    return this.namedParameterJdbcTemplate.queryForInt(sql, namedParameters);
}</pre><p>
		<tt class="classname">NamedParameterJdbcTemplate</tt>&#31867;&#25152;&#20855;&#22791;&#30340;&#21478;&#22806;&#19968;&#20010;&#27604;&#36739;&#22909;&#30340;&#29305;&#24615;&#23601;&#26159;&#21487;&#20197;&#25509;&#25910;<tt class="interfacename">SqlParameterSource</tt>&#20316;&#20026;&#20256;&#20837;&#21442;&#25968; (&#36825;&#20010;&#31867;&#20301;&#20110;&#30456;&#21516;&#30340;&#21253;&#23450;&#20041;&#20013;)&#12290;
			&#20320;&#24050;&#32463;&#22312;&#20808;&#21069;&#30340;&#19968;&#20010;&#20363;&#23376;&#20013;&#30475;&#21040;&#20102;&#36825;&#20010;&#25509;&#21475;&#30340;&#19968;&#20010;&#20855;&#20307;&#23454;&#29616;&#31867;&#12290;&#65288;
<tt class="classname">MapSqlParameterSource</tt>&#31867;&#65289;&#12290;&#32780;<tt class="interfacename">SqlParameterSource</tt>
			&#36825;&#20010;&#25509;&#21475;&#23545;&#20110;<tt class="classname">NamedParameterJdbcTemplate</tt>&#31867;&#30340;&#25805;&#20316;&#32780;&#35328;&#26159;&#19968;&#20010;&#20256;&#20837;&#30340;&#21442;&#25968;&#12290;<tt class="classname">MapSqlParameterSource</tt>&#21482;&#26159;&#19968;&#20010;&#38750;&#24120;&#31616;&#21333;&#30340;&#23454;&#29616;&#65292;&#20351;&#29992;&#20102;<tt class="interfacename">java.util.Map</tt>&#20316;&#20026;&#36716;&#25509;&#22120;&#65292; 
			&#20854;&#20013;&#65292;Map&#20013;&#30340;Key&#34920;&#31034;&#21442;&#25968;&#21517;&#31216;&#65292;&#32780;Map&#20013;&#30340;Value&#34920;&#31034;&#21442;&#25968;&#20540;&#12290;
		</p><p>
		&#21478;&#22806;&#19968;&#20010;<tt class="interfacename">SqlParameterSource</tt>
&#30340;&#23454;&#29616;&#31867;&#26159;<tt class="classname">BeanPropertySqlParameterSource</tt>&#12290;&#36825;&#20010;&#31867;&#23545;&#20256;&#32479;&#30340;Java&#36827;&#34892;&#20102;&#23553;&#35013;&#65288;&#20063;&#23601;&#26159;&#37027;&#20123;&#31526;&#21512;<a href="http://java.sun.com/products/javabeans/docs/spec.html" target="_top">JavaBean</a>&#26631;&#20934;&#30340;&#31867;&#65289;&#65292;
			&#24182;&#19988;&#20351;&#29992;&#20102;JavaBean&#30340;&#23646;&#24615;&#20316;&#20026;&#21442;&#25968;&#30340;&#21517;&#31216;&#21644;&#20540;&#12290;</p><pre class="programlisting">public class Actor {

    private Long id;
    private String firstName;
    private String lastName;
    
    public String getFirstName() {
        return this.firstName;
    }
    
    public String getLastName() {
        return this.lastName;
    }
    
    public Long getId() {
        return this.id;
    }
    
    <i class="lineannotation"><span class="lineannotation">// setters omitted...</span></i>

}</pre><pre class="programlisting"><i class="lineannotation"><span class="lineannotation">// some JDBC-backed DAO class...</span></i>
private NamedParameterJdbcTemplate namedParameterJdbcTemplate;

public void setDataSource(DataSource dataSource) {
    this.namedParameterJdbcTemplate = new NamedParameterJdbcTemplate(dataSource);
}

public int countOfActors(Actor exampleActor) {

    <i class="lineannotation"><span class="lineannotation">// notice how the named parameters match the properties of the above '<tt class="classname">Actor</tt>' class</span></i>
    String sql = "select count(0) from T_ACTOR where first_name = :firstName and last_name = :lastName";

    SqlParameterSource namedParameters = new BeanPropertySqlParameterSource(exampleActor);

    return this.namedParameterJdbcTemplate.queryForInt(sql, namedParameters);
}</pre><p>
			&#27880;&#24847;&#65292;<tt class="classname">NamedParameterJdbcTemplate</tt>&#31867;&#21482;&#26159;<span class="emphasis"><em>&#23553;&#35013;</em></span>&#20102;<tt class="classname">JdbcTemplate</tt>&#27169;&#26495;&#65307; 
			&#22240;&#32780;&#22914;&#26524;&#20320;&#38656;&#35201;&#35775;&#38382;&#30456;&#24212;&#34987;&#23553;&#35013;&#30340;<tt class="classname">JdbcTemplate</tt>&#31867;&#65292;&#24182;&#35775;&#38382;&#19968;&#20123;&#21482;&#26377;&#22312;<tt class="classname">JdbcTemplate</tt>&#20013;&#25317;&#26377;&#30340;&#21151;&#33021;&#65292;&#20320;&#38656;&#35201;&#20351;&#29992;<tt class="methodname">getJdbcOperations()</tt>&#26041;&#27861;&#26469;&#36827;&#34892;&#35775;&#38382;&#12290;
		</p><p>
      &#35831;&#21442;&#29031;<a href="jdbc.html#jdbc-JdbcTemplate-idioms" title="11.2.1.2.&nbsp;JdbcTemplate &#30340;&#26368;&#20339;&#23454;&#36341;">Section&nbsp;11.2.1.2, &#8220;JdbcTemplate &#30340;&#26368;&#20339;&#23454;&#36341;&#8221;</a>&#26469;&#33719;&#21462;&#19968;&#20123;&#20351;&#29992;<tt class="classname">NamedParameterJdbcTemplate</tt>&#30340;&#26368;&#20339;&#23454;&#36341;&#12290;
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-SimpleJdbcTemplate"></a>11.2.3.&nbsp;<tt class="classname">SimpleJdbcTemplate</tt>&#31867;</h3></div></div><div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p><span class="emphasis"><em><tt class="classname">SimpleJdbcTemplate</tt>&#25152;&#25552;&#20379;&#30340;&#19968;&#20123;&#29305;&#24615;&#24517;&#39035;&#24037;&#20316;&#22312;Java 5&#21450;&#20197;&#19978;&#29256;&#26412;&#12290;</em></span></p></td></tr></table></div><p>
	<tt class="classname">SimpleJdbcTemplate</tt>&#31867;&#26159;&#23545;<tt class="classname">JdbcTemplate</tt>&#31867;&#36827;&#34892;&#30340;&#23553;&#35013;&#65292;&#20174;&#32780;&#21487;&#20197;&#20805;&#20998;&#21033;&#29992;Java 5&#25152;&#24102;&#26469;&#30340;varargs&#21644;autoboxing&#31561;&#29305;&#24615;&#12290;
      <tt class="classname">SimpleJdbcTemplate</tt>&#31867;&#23436;&#20840;&#21033;&#29992;&#20102;Java 5&#35821;&#27861;&#25152;&#24102;&#26469;&#30340;&#34588;&#31958;&#25928;&#24212;&#12290;&#20961;&#26159;&#20351;&#29992;&#36807;Java 5&#30340;&#31243;&#24207;&#21592;&#20204;&#22914;&#26524;&#35201;&#20174;Java 5&#36801;&#31227;&#22238;&#20043;&#21069;&#30340;JDK&#29256;&#26412;&#65292;&#26080;&#30097;&#20250;&#21457;&#29616;&#36825;&#20123;&#29305;&#24615;&#25152;&#24102;&#26469;&#30340;&#34588;&#31958;&#25928;&#24212;&#12290;
      </p><p>
		<span class="emphasis"><em>&#8220;before and after&#8221;</em></span>&#31034;&#20363;&#21487;&#20197;&#25104;&#20026;<tt class="classname">SimpleJdbcTemplate</tt>&#31867;&#25152;&#24102;&#26469;&#30340;&#34588;&#31958;&#25928;&#24212;&#30340;&#26368;&#20339;&#35808;&#37322;&#12290;
			&#19979;&#38754;&#30340;&#20195;&#30721;&#31034;&#20363;&#39318;&#20808;&#23637;&#31034;&#20102;&#20351;&#29992;&#20256;&#32479;&#30340;<tt class="classname">JdbcTemplate</tt>&#36827;&#34892;JDBC&#35775;&#38382;&#30340;&#20195;&#30721;&#65292;&#25509;&#30528;&#26159;&#20351;&#29992;<tt class="classname">SimpleJdbcTemplate</tt>&#31867;&#20570;&#21516;&#26679;&#30340;&#20107;&#24773;&#12290;
		</p><pre class="programlisting"><i class="lineannotation"><span class="lineannotation">// classic <tt class="classname">JdbcTemplate</tt>-style...</span></i>
private JdbcTemplate jdbcTemplate;

public void setDataSource(DataSource dataSource) {
    this.jdbcTemplate = new JdbcTemplate(dataSource);
}

public Actor findActor(long id) {
    String sql = "select id, first_name, last_name from T_ACTOR where id = ?";
    
    RowMapper mapper = new RowMapper() {
    
        public Object mapRow(ResultSet rs, int rowNum) throws SQLException {
            Actor actor = new Actor();
            actor.setId(rs.getLong("id"));
            actor.setFirstName(rs.getString("first_name"));
            actor.setLastName(rs.getString("last_name"));
            return actor;
        }
    };
    
    <i class="lineannotation"><span class="lineannotation">// notice the cast, the wrapping up of the 'id' argument
    // in an array, and the boxing of the 'id' argument as a reference type</span></i>
    return (Actor) jdbcTemplate.queryForObject(sql, mapper, new Object[] {Long.valueOf(id)});
}</pre><p>&#19979;&#38754;&#26159;&#21516;&#26679;&#30340;&#36923;&#36753;&#65292;&#20351;&#29992;&#20102;<tt class="classname">SimpleJdbcTemplate</tt>&#65307;&#21487;&#20197;&#30475;&#21040;&#20195;&#30721;&#8220;&#24178;&#20928;&#8221;&#22810;&#20102;&#65306;</p><pre class="programlisting"><i class="lineannotation"><span class="lineannotation">// <tt class="classname">SimpleJdbcTemplate</tt>-style...</span></i>
private SimpleJdbcTemplate simpleJdbcTemplate;

public void setDataSource(DataSource dataSource) {
    this.simpleJdbcTemplate = new SimpleJdbcTemplate(dataSource);
}

public Actor findActor(long id) {
    String sql = "select id, first_name, last_name from T_ACTOR where id = ?";

    ParameterizedRowMapper&lt;Actor&gt; mapper = new ParameterizedRowMapper&lt;Actor&gt;() {
    
        <i class="lineannotation"><span class="lineannotation">// notice the return type with respect to Java 5 covariant return types</span></i>
        public Actor mapRow(ResultSet rs, int rowNum) throws SQLException {
            Actor actor = new Actor();
            actor.setId(rs.getLong("id"));
            actor.setFirstName(rs.getString("first_name"));
            actor.setLastName(rs.getString("last_name"));
            return actor;
        }
    };

    return this.simpleJdbcTemplate.queryForObject(sql, mapper, id);
}</pre><p>&#35831;&#21516;&#26679;&#21442;&#29031;<a href="jdbc.html#jdbc-JdbcTemplate-idioms" title="11.2.1.2.&nbsp;JdbcTemplate &#30340;&#26368;&#20339;&#23454;&#36341;">Section&nbsp;11.2.1.2, &#8220;JdbcTemplate &#30340;&#26368;&#20339;&#23454;&#36341;&#8221;</a>&#26469;&#33719;&#21462;&#19968;&#20123;<tt class="classname">SimpleJdbcTemplate</tt>&#30340;&#26368;&#20339;&#23454;&#36341;</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p><tt class="classname">SimpleJdbcTemplate</tt>&#21482;&#26159;&#25552;&#20379;&#20102;<tt class="classname">JdbcTemplate</tt>&#25152;&#25552;&#20379;&#30340;&#21151;&#33021;&#30340;&#23376;&#31867;&#12290;
        &#22914;&#26524;&#20320;&#38656;&#35201;&#20351;&#29992;<tt class="classname">JdbcTemplate</tt>&#30340;&#26041;&#27861;&#65292;&#32780;&#36825;&#20123;&#26041;&#27861;&#21448;&#27809;&#26377;&#22312;<tt class="classname">SimpleJdbcTemplate</tt>&#20013;&#23450;&#20041;&#65292;&#20320;&#38656;&#35201;&#35843;&#29992;<tt class="methodname">getJdbcOperations()</tt>&#26041;&#27861;
        &#33719;&#21462;&#30456;&#24212;&#30340;&#26041;&#27861;&#35843;&#29992;&#12290;<tt class="interfacename">JdbcOperations</tt>&#25509;&#21475;&#20013;&#23450;&#20041;&#30340;&#26041;&#27861;&#38656;&#35201;&#22312;&#36825;&#36793;&#20570;&#24378;&#21046;&#36716;&#21270;&#25165;&#33021;&#20351;&#29992;&#12290;</p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-datasource"></a>11.2.4.&nbsp;<tt class="interfacename">DataSource</tt>&#25509;&#21475;</h3></div></div><div></div></div><p>
		&#20026;&#20102;&#20174;&#25968;&#25454;&#24211;&#20013;&#21462;&#24471;&#25968;&#25454;&#65292;&#25105;&#20204;&#39318;&#20808;&#38656;&#35201;&#33719;&#21462;&#19968;&#20010;&#25968;&#25454;&#24211;&#36830;&#25509;&#12290;Spring&#36890;&#36807;<tt class="interfacename">DataSource</tt>&#23545;&#35937;&#26469;&#23436;&#25104;&#36825;&#20010;&#24037;&#20316;&#12290;
		<tt class="interfacename">DataSource</tt>&#26159;JDBC&#35268;&#33539;&#30340;&#19968;&#37096;&#20998;&#65292;&#23427;&#34987;&#35270;&#20026;&#19968;&#20010;&#36890;&#29992;&#30340;&#25968;&#25454;&#24211;&#36830;&#25509;&#24037;&#21378;&#12290;&#36890;&#36807;&#20351;&#29992;DataSource&#65292;
		Container&#25110;Framework&#21487;&#20197;&#23558;&#36830;&#25509;&#27744;&#20197;&#21450;&#20107;&#21153;&#31649;&#29702;&#30340;&#32454;&#33410;&#20174;&#24212;&#29992;&#20195;&#30721;&#20013;&#20998;&#31163;&#20986;&#26469;&#12290;
		&#20316;&#20026;&#19968;&#20010;&#24320;&#21457;&#20154;&#21592;&#65292;&#22312;&#24320;&#21457;&#21644;&#27979;&#35797;&#20135;&#21697;&#30340;&#36807;&#31243;&#20013;&#65292;&#20320;&#21487;&#33021;&#38656;&#35201;&#30693;&#36947;&#36830;&#25509;&#25968;&#25454;&#24211;&#30340;&#32454;&#33410;&#12290;&#20294;&#22312;&#20135;&#21697;&#23454;&#26045;&#26102;&#65292;&#20320;&#19981;&#38656;&#35201;&#30693;&#36947;&#36825;&#20123;&#32454;&#33410;&#12290;&#36890;&#24120;&#25968;&#25454;&#24211;&#31649;&#29702;&#21592;&#20250;&#24110;&#20320;&#35774;&#32622;&#22909;&#25968;&#25454;&#28304;&#12290;
	</p><p>
		&#22312;&#20351;&#29992;Spring JDBC&#26102;&#65292;&#20320;&#26082;&#21487;&#20197;&#36890;&#36807;JNDI&#33719;&#24471;&#25968;&#25454;&#28304;&#65292;&#20063;&#21487;&#20197;&#33258;&#34892;&#37197;&#32622;&#25968;&#25454;&#28304;&#65288;&#20351;&#29992;Spring&#25552;&#20379;&#30340;DataSource&#23454;&#29616;&#31867;&#65289;&#12290;&#20351;&#29992;&#21518;&#32773;&#21487;&#20197;&#26356;&#26041;&#20415;&#30340;&#33073;&#31163;Web&#23481;&#22120;&#26469;&#36827;&#34892;&#21333;&#20803;&#27979;&#35797;&#12290;
		&#36825;&#37324;&#25105;&#20204;&#23558;&#20351;&#29992;<tt class="classname">DriverManagerDataSource</tt>&#65292;&#19981;&#36807;DataSource&#26377;&#22810;&#31181;&#23454;&#29616;&#65292;
		&#21518;&#38754;&#25105;&#20204;&#20250;&#35762;&#21040;&#12290;&#20351;&#29992;<tt class="classname">DriverManagerDataSource</tt>&#21644;&#20320;&#20197;&#21069;&#33719;&#21462;&#19968;&#20010;JDBC&#36830;&#25509;
		&#30340;&#20570;&#27861;&#27809;&#20160;&#20040;&#20004;&#26679;&#12290;&#20320;&#39318;&#20808;&#24517;&#39035;&#25351;&#23450;JDBC&#39537;&#21160;&#31243;&#24207;&#30340;&#20840;&#38480;&#23450;&#21517;&#65292;&#36825;&#26679;<tt class="classname">DriverManager</tt>
		&#25165;&#33021;&#21152;&#36733;JDBC&#39537;&#21160;&#31867;&#65292;&#25509;&#30528;&#20320;&#24517;&#39035;&#25552;&#20379;&#19968;&#20010;url&#65288;&#22240;JDBC&#39537;&#21160;&#32780;&#24322;&#65292;&#20026;&#20102;&#20445;&#35777;&#35774;&#32622;&#27491;&#30830;&#35831;&#21442;&#32771;&#30456;&#20851;JDBC&#39537;&#21160;&#30340;&#25991;&#26723;&#65289;&#65292;
		&#26368;&#21518;&#20320;&#24517;&#39035;&#25552;&#20379;&#19968;&#20010;&#29992;&#25143;&#36830;&#25509;&#25968;&#25454;&#24211;&#30340;&#29992;&#25143;&#21517;&#21644;&#23494;&#30721;&#12290;&#19979;&#38754;&#25105;&#20204;&#23558;&#36890;&#36807;&#19968;&#20010;&#20363;&#23376;&#26469;&#35828;&#26126;&#22914;&#20309;&#37197;&#32622;&#19968;&#20010;<tt class="classname">DriverManagerDataSource</tt>&#65306;
		</p><pre class="programlisting">DriverManagerDataSource dataSource = new DriverManagerDataSource();
dataSource.setDriverClassName("org.hsqldb.jdbcDriver");
dataSource.setUrl("jdbc:hsqldb:hsql://localhost:");
dataSource.setUsername("sa");
dataSource.setPassword("");</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-SQLExceptionTranslator"></a>11.2.5.&nbsp;<tt class="interfacename">SQLExceptionTranslator</tt>&#25509;&#21475;</h3></div></div><div></div></div><p>
			<tt class="interfacename">SQLExceptionTranslator</tt>&#26159;&#19968;&#20010;&#25509;&#21475;&#65292;&#22914;&#26524;&#20320;&#38656;&#35201;&#22312;
			<tt class="classname">SQLException</tt>&#21644;<tt class="classname">org.springframework.dao.DataAccessException</tt>&#20043;&#38388;&#20316;&#36716;&#25442;&#65292;&#37027;&#20040;&#24517;&#39035;&#23454;&#29616;&#35813;&#25509;&#21475;&#12290;
			&#36716;&#25442;&#22120;&#31867;&#30340;&#23454;&#29616;&#21487;&#20197;&#37319;&#29992;&#19968;&#33324;&#36890;&#29992;&#30340;&#20570;&#27861;(&#27604;&#22914;&#20351;&#29992;JDBC&#30340;SQLState code)&#65292;&#22914;&#26524;&#20026;&#20102;&#20351;&#36716;&#25442;&#26356;&#20934;&#30830;&#65292;&#20063;&#21487;&#20197;&#36827;&#34892;&#23450;&#21046;&#65288;&#27604;&#22914;&#20351;&#29992;Oracle&#30340;error code&#65289;&#12290;
		</p><p>
			<tt class="classname">SQLErrorCodeSQLExceptionTranslator</tt>&#26159;SQLExceptionTranslator&#30340;&#40664;&#35748;&#23454;&#29616;&#12290;
			&#35813;&#23454;&#29616;&#20351;&#29992;&#25351;&#23450;&#25968;&#25454;&#24211;&#21378;&#21830;&#30340;error code&#65292;&#27604;&#37319;&#29992;<tt class="literal">SQLState</tt>&#26356;&#31934;&#30830;&#12290;&#36716;&#25442;&#36807;&#31243;&#22522;&#20110;&#19968;&#20010;JavaBean&#65288;&#31867;&#22411;&#20026;<tt class="classname">SQLErrorCodes</tt>&#65289;&#20013;&#30340;error code&#12290;
			&#36825;&#20010;JavaBean&#30001;<tt class="classname">SQLErrorCodesFactory</tt>&#24037;&#21378;&#31867;&#21019;&#24314;&#65292;&#20854;&#20013;&#30340;&#20869;&#23481;&#26469;&#33258;&#20110;
			&#8220;sql-error-codes.xml&#8221;&#37197;&#32622;&#25991;&#20214;&#12290;&#35813;&#25991;&#20214;&#20013;&#30340;&#25968;&#25454;&#24211;&#21378;&#21830;&#20195;&#30721;&#22522;&#20110; <tt class="interfacename">Database MetaData</tt> &#20449;&#24687;&#20013;&#30340;DatabaseProductName&#65292;&#20174;&#32780;&#37197;&#21512;&#24403;&#21069;&#25968;&#25454;&#24211;&#30340;&#20351;&#29992;&#12290;
		</p><p>
      <tt class="classname">SQLErrorCodeSQLExceptionTranslator</tt>&#20351;&#29992;&#20197;&#19979;&#30340;&#21305;&#37197;&#35268;&#21017;&#65306;
      </p><div class="itemizedlist"><ul type="disc" compact><li><p>
				&#39318;&#20808;&#26816;&#26597;&#26159;&#21542;&#23384;&#22312;&#23436;&#25104;&#23450;&#21046;&#36716;&#25442;&#30340;&#23376;&#31867;&#23454;&#29616;&#12290;&#36890;&#24120;<tt class="classname">SQLErrorCodeSQLExceptionTranslator</tt>
				&#36825;&#20010;&#31867;&#21487;&#20197;&#20316;&#20026;&#19968;&#20010;&#20855;&#20307;&#31867;&#20351;&#29992;&#65292;&#19981;&#38656;&#35201;&#36827;&#34892;&#23450;&#21046;&#65292;&#37027;&#20040;&#36825;&#20010;&#35268;&#21017;&#23558;&#19981;&#36866;&#29992;&#12290;
			</p></li><li><p>
				&#25509;&#30528;&#23558;SQLException&#30340;error code&#19982;&#38169;&#35823;&#20195;&#30721;&#38598;&#20013;&#30340;error code&#36827;&#34892;&#21305;&#37197;&#12290;
				&#40664;&#35748;&#24773;&#20917;&#19979;&#38169;&#35823;&#20195;&#30721;&#38598;&#23558;&#20174;<tt class="classname">SQLErrorCodesFactory</tt>&#21462;&#24471;&#12290;
				&#38169;&#35823;&#20195;&#30721;&#38598;&#26469;&#33258;classpath&#19979;&#30340;sql-error-codes.xml&#25991;&#20214;&#65292;&#23427;&#20204;&#23558;&#19982;&#25968;&#25454;&#24211;metadata&#20449;&#24687;&#20013;&#30340;database name&#36827;&#34892;&#26144;&#23556;&#12290;
			</p></li><li><p>
				&#20351;&#29992;fallback&#32763;&#35793;&#22120;&#12290;<tt class="classname">SQLStateSQLExceptionTranslator</tt>&#31867;&#26159;&#32570;&#30465;&#30340;fallback&#32763;&#35793;&#22120;&#12290;
			</p></li></ul></div><p>
        </p><p>
			<tt class="classname">SQLErrorCodeSQLExceptionTranslator</tt>&#21487;&#20197;&#37319;&#29992;&#19979;&#38754;&#30340;&#26041;&#24335;&#36827;&#34892;&#25193;&#23637;&#65306;
		</p><pre class="programlisting">public class MySQLErrorCodesTranslator extends SQLErrorCodeSQLExceptionTranslator {

    protected DataAccessException customTranslate(String task, String sql, SQLException sqlex) {
        if (sqlex.getErrorCode() == -12345) {
            return new DeadlockLoserDataAccessException(task, sqlex);
        }
        return null;
    }
}</pre><p>
		&#22312;&#19978;&#38754;&#30340;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;error code&#20026;<tt class="literal">'-12345'</tt>&#30340;SQLException&#23558;&#37319;&#29992;&#35813;&#36716;&#25442;&#22120;&#36827;&#34892;&#36716;&#25442;&#65292;&#32780;&#20854;&#20182;&#30340;error code&#23558;&#30001;&#40664;&#35748;&#30340;&#36716;&#25442;&#22120;&#36827;&#34892;&#36716;&#25442;&#12290;
		&#20026;&#20102;&#20351;&#29992;&#35813;&#36716;&#25442;&#22120;&#65292;&#24517;&#39035;&#23558;&#20854;&#20316;&#20026;&#21442;&#25968;&#20256;&#36882;&#32473;<tt class="classname">JdbcTemplate</tt>&#31867;&#30340;<tt class="literal">setExceptionTranslator</tt>&#26041;&#27861;&#65292;&#24182;&#22312;&#38656;&#35201;&#20351;&#29992;&#36825;&#20010;&#36716;&#25442;&#22120;&#22120;&#30340;&#25968;&#25454;
		&#23384;&#21462;&#25805;&#20316;&#20013;&#20351;&#29992;&#35813;<tt class="classname">JdbcTemplate</tt>&#12290;&#19979;&#38754;&#30340;&#20363;&#23376;&#28436;&#31034;&#20102;&#22914;&#20309;&#20351;&#29992;&#35813;&#23450;&#21046;&#36716;&#25442;&#22120;&#65306;
	  </p><pre class="programlisting"><i class="lineannotation"><span class="lineannotation">// create a <tt class="classname">JdbcTemplate</tt> and set data source</span></i> 
JdbcTemplate jt = new JdbcTemplate(); 
jt.setDataSource(dataSource); 
<i class="lineannotation"><span class="lineannotation">// create a custom translator and set the <tt class="interfacename">DataSource</tt> for the default translation lookup</span></i> 
MySQLErrorCodesTransalator tr = new MySQLErrorCodesTransalator(); 
tr.setDataSource(dataSource); 
jt.setExceptionTranslator(tr); 
<i class="lineannotation"><span class="lineannotation">// use the <tt class="classname">JdbcTemplate</tt> for this <tt class="classname">SqlUpdate</tt></span></i>
SqlUpdate su = new SqlUpdate(); 
su.setJdbcTemplate(jt); 
su.setSql("update orders set shipping_charge = shipping_charge * 1.05"); 
su.compile(); 
su.update();</pre><p>
		&#22312;&#19978;&#38754;&#30340;&#23450;&#21046;&#36716;&#25442;&#22120;&#20013;&#65292;&#25105;&#20204;&#32473;&#23427;&#27880;&#20837;&#20102;&#19968;&#20010;&#25968;&#25454;&#28304;&#65292;&#22240;&#20026;&#25105;&#20204;&#20173;&#28982;&#38656;&#35201;
		&#20351;&#29992;&#40664;&#35748;&#30340;&#36716;&#25442;&#22120;&#20174;<tt class="literal">sql-error-codes.xml</tt>&#20013;&#33719;&#21462;&#38169;&#35823;&#20195;&#30721;&#38598;&#12290;
	</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-statements-executing"></a>11.2.6.&nbsp;&#25191;&#34892;SQL&#35821;&#21477;</h3></div></div><div></div></div><p>
		&#25105;&#20204;&#20165;&#38656;&#35201;&#38750;&#24120;&#23569;&#30340;&#20195;&#30721;&#23601;&#21487;&#20197;&#36798;&#21040;&#25191;&#34892;SQL&#35821;&#21477;&#30340;&#30446;&#30340;&#65292;&#19968;&#26086;&#33719;&#24471;&#19968;&#20010;
		<tt class="interfacename">DataSource</tt>&#21644;&#19968;&#20010;<tt class="classname">JdbcTemplate</tt>&#65292;
		&#25105;&#20204;&#23601;&#21487;&#20197;&#20351;&#29992;<tt class="classname">JdbcTemplate</tt>&#25552;&#20379;&#30340;&#20016;&#23500;&#21151;&#33021;&#23454;&#29616;&#25105;&#20204;&#30340;&#25805;&#20316;&#12290;&#19979;&#38754;&#30340;&#20363;&#23376;&#20351;&#29992;&#20102;&#26497;&#23569;&#30340;&#20195;&#30721;&#23436;&#25104;&#21019;&#24314;&#19968;&#24352;&#34920;&#30340;&#24037;&#20316;&#12290;
		</p><pre class="programlisting">import javax.sql.DataSource;
import org.springframework.jdbc.core.JdbcTemplate;

public class ExecuteAStatement {

    private JdbcTemplate jdbcTemplate;

    public void setDataSource(DataSource dataSource) {
        this.jdbcTemplate = new JdbcTemplate(dataSource);
    }

    public void doExecute() {
        this.jdbcTemplate.execute("create table mytable (id integer, name varchar(100))");
    }
}</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-statements-querying"></a>11.2.7.&nbsp;&#25191;&#34892;&#26597;&#35810;</h3></div></div><div></div></div><p>
			&#38500;&#20102;execute&#26041;&#27861;&#20043;&#22806;&#65292;<tt class="classname">JdbcTemplate</tt>&#36824;&#25552;&#20379;&#20102;&#22823;&#37327;&#30340;&#26597;&#35810;&#26041;&#27861;&#12290;
			&#22312;&#36825;&#20123;&#26597;&#35810;&#26041;&#27861;&#20013;&#65292;&#26377;&#24456;&#22823;&#19968;&#37096;&#20998;&#26159;&#29992;&#26469;&#26597;&#35810;&#21333;&#20540;&#30340;&#12290;&#27604;&#22914;&#36820;&#22238;&#19968;&#20010;&#27719;&#24635;&#65288;count&#65289;&#32467;&#26524;
			&#25110;&#32773;&#20174;&#36820;&#22238;&#34892;&#32467;&#26524;&#20013;&#21462;&#24471;&#25351;&#23450;&#21015;&#30340;&#20540;&#12290;&#36825;&#26102;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;<tt class="literal">queryForInt(..)</tt>&#12289;
			<tt class="literal">queryForLong(..)</tt>&#25110;&#32773;<tt class="literal">queryForObject(..)</tt>&#26041;&#27861;&#12290;
			queryForObject&#26041;&#27861;&#29992;&#26469;&#23558;&#36820;&#22238;&#30340;JDBC&#31867;&#22411;&#23545;&#35937;&#36716;&#25442;&#25104;&#25351;&#23450;&#30340;Java&#23545;&#35937;&#65292;&#22914;&#26524;&#31867;&#22411;&#36716;&#25442;&#22833;&#36133;&#23558;&#25243;&#20986;
			<tt class="classname">InvalidDataAccessApiUsageException</tt>&#24322;&#24120;&#12290;
			&#19979;&#38754;&#30340;&#20363;&#23376;&#28436;&#31034;&#20102;&#20004;&#20010;&#26597;&#35810;&#30340;&#29992;&#27861;&#65292;&#19968;&#20010;&#36820;&#22238;<tt class="literal">int</tt>&#20540;&#65292;&#21478;&#19968;&#20010;&#36820;&#22238;<tt class="classname">String</tt>&#12290;
		</p><pre class="programlisting">import javax.sql.DataSource;
import org.springframework.jdbc.core.JdbcTemplate;

public class RunAQuery {

    private JdbcTemplate jdbcTemplate;

    public void setDataSource(DataSource dataSource) {
        this.jdbcTemplate = new JdbcTemplate(dataSource);
    }
  
    public int getCount() {
        return this.jdbcTemplate.queryForInt("select count(*) from mytable");
    }

    public String getName() {
        return (String) this.jdbcTemplate.queryForObject("select name from mytable", String.class);
    }

    public void setDataSource(DataSource dataSource) {
        this.dataSource = dataSource;
    }
}</pre><p>
		&#38500;&#20102;&#36820;&#22238;&#21333;&#20540;&#30340;&#26597;&#35810;&#26041;&#27861;&#65292;<tt class="classname">JdbcTemplate</tt>&#36824;&#25552;&#20379;&#20102;&#19968;&#32452;&#36820;&#22238;List&#32467;&#26524;
		&#30340;&#26041;&#27861;&#12290;List&#20013;&#30340;&#27599;&#19968;&#39033;&#23545;&#24212;&#26597;&#35810;&#36820;&#22238;&#32467;&#26524;&#20013;&#30340;&#19968;&#34892;&#12290;&#20854;&#20013;&#26368;&#31616;&#21333;&#30340;&#26159;<tt class="literal">queryForList</tt>&#26041;&#27861;&#65292;
		&#35813;&#26041;&#27861;&#23558;&#36820;&#22238;&#19968;&#20010;<tt class="interfacename">List</tt>&#65292;&#35813;<tt class="interfacename">List</tt>&#20013;&#30340;&#27599;&#19968;&#26465;
		&#35760;&#24405;&#26159;&#19968;&#20010;<tt class="interfacename">Map</tt>&#23545;&#35937;&#65292;&#23545;&#24212;&#24212;&#25968;&#25454;&#24211;&#20013;&#26576;&#19968;&#34892;&#65307;&#32780;&#35813;<tt class="interfacename">Map</tt>
		&#20013;&#30340;&#27599;&#19968;&#39033;&#23545;&#24212;&#35813;&#25968;&#25454;&#24211;&#34892;&#20013;&#30340;&#26576;&#19968;&#21015;&#20540;&#12290;&#19979;&#38754;&#30340;&#20195;&#30721;&#29255;&#26029;&#25509;&#30528;&#19978;&#38754;&#30340;&#20363;&#23376;&#28436;&#31034;&#20102;&#22914;&#20309;&#29992;&#35813;&#26041;&#27861;&#36820;&#22238;&#34920;&#20013;&#25152;&#26377;&#35760;&#24405;&#65306;
		</p><pre class="programlisting">
private JdbcTemplate jdbcTemplate;

public void setDataSource(DataSource dataSource) {
    this.jdbcTemplate = new JdbcTemplate(dataSource);
}

public List getList() {
    return this.jdbcTemplate.queryForList("select * from mytable");
}</pre><p>
		&#36820;&#22238;&#30340;&#32467;&#26524;&#38598;&#31867;&#20284;&#19979;&#38754;&#36825;&#31181;&#24418;&#24335;&#65306;
	</p><pre class="programlisting">[{name=Bob, id=1}, {name=Mary, id=2}]</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-updates"></a>11.2.8.&nbsp;&#26356;&#26032;&#25968;&#25454;&#24211;</h3></div></div><div></div></div><p>
			<tt class="classname">JdbcTemplate</tt>&#36824;&#25552;&#20379;&#20102;&#19968;&#20123;&#26356;&#26032;&#25968;&#25454;&#24211;&#30340;&#26041;&#27861;&#12290;
			&#22312;&#19979;&#38754;&#30340;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#26681;&#25454;&#32473;&#23450;&#30340;&#20027;&#38190;&#20540;&#23545;&#25351;&#23450;&#30340;&#21015;&#36827;&#34892;&#26356;&#26032;&#12290;
			&#20363;&#23376;&#20013;&#30340;SQL&#35821;&#21477;&#20013;&#20351;&#29992;&#20102;&#8220;?&#8221;&#21344;&#20301;&#31526;&#26469;&#25509;&#21463;&#21442;&#25968;&#65288;&#36825;&#31181;&#20570;&#27861;&#22312;&#26356;&#26032;&#21644;&#26597;&#35810;SQL&#35821;&#21477;&#20013;&#24456;&#24120;&#35265;&#65289;&#12290;
			&#20256;&#36882;&#30340;&#21442;&#25968;&#20540;&#20301;&#20110;&#19968;&#20010;&#23545;&#35937;&#25968;&#32452;&#20013;&#65288;&#22522;&#26412;&#31867;&#22411;&#38656;&#35201;&#34987;&#21253;&#35013;&#25104;&#20854;&#23545;&#24212;&#30340;&#23545;&#35937;&#31867;&#22411;&#65289;&#12290;
		</p><pre class="programlisting">import javax.sql.DataSource;

import org.springframework.jdbc.core.JdbcTemplate;

public class ExecuteAnUpdate {

    private JdbcTemplate jdbcTemplate;

    public void setDataSource(DataSource dataSource) {
        this.jdbcTemplate = new JdbcTemplate(dataSource);
    }

    public void setName(int id, String name) {
        this.jdbcTemplate.update(
                "update mytable set name = ? where id = ?", 
                new Object[] {name, new Integer(id)});
    }
}</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-auto-genereted-keys"></a>11.2.9.&nbsp;&#33719;&#21462;&#33258;&#21160;&#29983;&#25104;&#30340;&#20027;&#38190;</h3></div></div><div></div></div><p>
      <tt class="classname">JdbcTemplate</tt>&#20013;&#26377;&#19968;&#20010;<tt class="methodname">update</tt>&#26041;&#27861;&#65292;&#21487;&#20197;&#26041;&#20415;&#22320;&#20174;&#25968;&#25454;&#24211;&#20013;&#33719;&#21462;&#25968;&#25454;&#24211;&#33258;&#21160;&#21019;&#24314;&#30340;&#20027;&#38190;&#12290;&#65288;&#36825;&#26159;JDBC 3.0&#30340;&#26631;&#20934; - &#21487;&#20197;&#21442;&#35265;13.6&#33410;&#33719;&#21462;&#35814;&#32454;&#20449;&#24687;&#65289;&#12290;
      &#36825;&#20010;&#26041;&#27861;&#20351;&#29992;&#20102;<tt class="classname">PreparedStatementCreator</tt>&#25509;&#21475;&#20316;&#20026;&#31532;&#19968;&#20010;&#21442;&#25968;&#65292; &#21487;&#20197;&#36890;&#36807;&#36825;&#20010;&#25509;&#21475;&#30340;&#23454;&#29616;&#31867;&#26469;&#23450;&#20041;&#30456;&#24212;&#30340;Insert&#35821;&#21477;&#12290;&#21478;&#22806;&#19968;&#20010;&#21442;&#25968;&#26159;<tt class="classname">KeyHolder</tt>&#65292;
      &#19968;&#26086;update&#26041;&#27861;&#25104;&#21151;&#65292;&#36825;&#20010;&#21442;&#25968;&#23558;&#21253;&#21547;&#29983;&#25104;&#30340;&#20027;&#38190;&#12290;&#36825;&#37324;&#23545;&#20110;&#21019;&#24314;&#21512;&#36866;&#30340;<tt class="classname">PreparedStatement</tt>&#24182;&#27809;&#26377;&#19968;&#20010;&#32479;&#19968;&#30340;&#26631;&#20934;&#12290;&#65288;&#36825;&#20063;&#35299;&#37322;&#20102;&#20989;&#25968;&#31614;&#21517;&#22914;&#27492;&#23450;&#20041;&#30340;&#21407;&#22240;&#65289;&#12290;&#19979;&#38754;&#26159;&#19968;&#20010;&#22312;Oracle&#19978;&#36816;&#34892;&#33391;&#22909;&#30340;&#31034;&#20363;&#65292;&#23427;&#21487;&#33021;&#22312;&#20854;&#20182;&#24179;&#21488;&#19978;&#26080;&#27861;&#24037;&#20316;&#65306;
      </p><pre class="programlisting">final String INSERT_SQL = "insert into my_test (name) values(?)";
final String name = "Rob";

KeyHolder keyHolder = new GeneratedKeyHolder();
jdbcTemplate.update(
    new PreparedStatementCreator() {
        public PreparedStatement createPreparedStatement(Connection connection) throws SQLException {
            PreparedStatement ps =
                connection.prepareStatement(INSERT_SQL, new String[] {"id"});
            ps.setString(1, name);
            return ps;
        }
    },
    keyHolder);

<i class="lineannotation"><span class="lineannotation">// keyHolder.getKey() now contains the generated key</span></i></pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jdbc-connections"></a>11.3.&nbsp;&#25511;&#21046;&#25968;&#25454;&#24211;&#36830;&#25509;</h2></div></div><div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-DataSourceUtils"></a>11.3.1.&nbsp;<tt class="classname">DataSourceUtils</tt>&#31867;</h3></div></div><div></div></div><p>
			<tt class="classname">DataSourceUtils</tt>&#20316;&#20026;&#19968;&#20010;&#24110;&#21161;&#31867;&#25552;&#20379;&#26131;&#29992;&#19988;&#24378;&#22823;&#30340;&#25968;&#25454;&#24211;&#35775;&#38382;&#33021;&#21147;&#65292;
			&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#35813;&#31867;&#25552;&#20379;&#30340;<tt class="literal">&#38745;&#24577;</tt>&#26041;&#27861;&#20174;JNDI&#33719;&#21462;&#25968;&#25454;&#24211;&#36830;&#25509;&#20197;&#21450;&#22312;&#24517;&#35201;&#30340;&#26102;&#20505;&#20851;&#38381;&#20043;&#12290;
			&#23427;&#25552;&#20379;&#25903;&#25345;&#32447;&#31243;&#32465;&#23450;&#30340;&#25968;&#25454;&#24211;&#36830;&#25509;&#65288;&#27604;&#22914;&#20351;&#29992;<tt class="classname">DataSourceTransactionManager</tt>&#30340;&#26102;&#20505;&#65292;&#23558;&#25226;&#25968;&#25454;&#24211;&#36830;&#25509;&#32465;&#23450;&#21040;&#24403;&#21069;&#30340;&#32447;&#31243;&#19978;&#65289;&#12290;
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-SmartDataSource"></a>11.3.2.&nbsp;<tt class="interfacename">SmartDataSource</tt>&#25509;&#21475;</h3></div></div><div></div></div><p>
			<tt class="interfacename">SmartDataSource</tt>&#26159;<tt class="interfacename">DataSource</tt>
			&#25509;&#21475;&#30340;&#19968;&#20010;&#25193;&#23637;&#65292;&#29992;&#26469;&#25552;&#20379;&#25968;&#25454;&#24211;&#36830;&#25509;&#12290;&#20351;&#29992;&#35813;&#25509;&#21475;&#30340;&#31867;&#22312;&#25351;&#23450;&#30340;&#25805;&#20316;&#20043;&#21518;&#21487;&#20197;&#26816;&#26597;&#26159;&#21542;&#38656;&#35201;&#20851;&#38381;&#36830;&#25509;&#12290;&#35813;&#25509;&#21475;&#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#38750;&#24120;&#26377;&#29992;&#65292;&#27604;&#22914;&#26377;&#20123;&#24773;&#20917;&#38656;&#35201;&#37325;&#29992;&#25968;&#25454;&#24211;&#36830;&#25509;&#12290;
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-AbstractDataSource"></a>11.3.3.&nbsp;<tt class="classname">AbstractDataSource</tt>&#31867;</h3></div></div><div></div></div><p>
			<tt class="classname">AbstractDataSource</tt>&#26159;&#19968;&#20010;&#23454;&#29616;&#20102;<tt class="interfacename">DataSource</tt>
			&#25509;&#21475;&#30340;<tt class="literal">abstract</tt>&#22522;&#31867;&#12290;&#23427;&#23454;&#29616;&#20102;<tt class="interfacename">DataSource</tt>&#25509;&#21475;&#30340;
			&#19968;&#20123;&#26080;&#20851;&#30171;&#30162;&#30340;&#26041;&#27861;&#65292;&#22914;&#26524;&#20320;&#38656;&#35201;&#23454;&#29616;&#33258;&#24049;&#30340;<tt class="interfacename">DataSource</tt>&#65292;&#37027;&#20040;&#21487;&#20197;&#32487;&#25215;&#35813;&#31867;&#12290;
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-SingleConnectionDataSource"></a>11.3.4.&nbsp;<tt class="classname">SingleConnectionDataSource</tt>&#31867;</h3></div></div><div></div></div><p>
		<tt class="classname">SingleConnectionDataSource</tt>&#26159;<tt class="literal">SmartDataSource</tt>&#25509;&#21475;
		&#30340;&#19968;&#20010;&#23454;&#29616;&#65292;&#20854;&#20869;&#37096;&#21253;&#35013;&#20102;&#19968;&#20010;&#21333;&#36830;&#25509;&#12290;&#35813;&#36830;&#25509;&#22312;&#20351;&#29992;&#20043;&#21518;&#23558;&#19981;&#20250;&#20851;&#38381;&#65292;&#24456;&#26174;&#28982;&#23427;&#19981;&#33021;&#22312;&#22810;&#32447;&#31243;&#30340;&#29615;&#22659;&#19979;&#20351;&#29992;&#12290;
	</p><p>
		&#24403;&#23458;&#25143;&#31471;&#20195;&#30721;&#35843;&#29992;close&#26041;&#27861;&#30340;&#26102;&#20505;&#65292;&#22914;&#26524;&#23427;&#24635;&#26159;&#20551;&#35774;&#25968;&#25454;&#24211;&#36830;&#25509;&#26469;&#33258;&#36830;&#25509;&#27744;&#65288;&#23601;&#20687;&#20351;&#29992;&#25345;&#20037;&#21270;&#24037;&#20855;&#26102;&#19968;&#26679;&#65289;&#65292;
		&#20320;&#24212;&#35813;&#23558;<tt class="literal">suppressClose</tt>&#35774;&#32622;&#20026;true&#12290;&#36825;&#26679;&#65292;&#36890;&#36807;&#35813;&#31867;&#33719;&#21462;&#30340;&#23558;&#26159;&#20195;&#29702;&#36830;&#25509;&#65288;&#31105;&#27490;&#20851;&#38381;&#65289;&#32780;&#19981;&#26159;&#21407;&#26377;&#30340;&#29289;&#29702;&#36830;&#25509;&#12290;
		&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#65292;&#25105;&#20204;&#19981;&#33021;&#25226;&#20351;&#29992;&#35813;&#31867;&#33719;&#21462;&#30340;&#25968;&#25454;&#24211;&#36830;&#25509;&#36896;&#22411;&#65288;cast&#65289;&#20026;Oracle Connection&#20043;&#31867;&#30340;&#26412;&#22320;&#25968;&#25454;&#24211;&#36830;&#25509;&#12290;
		</p><p>
			<tt class="classname">SingleConnectionDataSource</tt>&#20027;&#35201;&#22312;&#27979;&#35797;&#30340;&#26102;&#20505;&#20351;&#29992;&#12290;&#23427;&#20351;&#24471;&#27979;&#35797;&#20195;&#30721;&#24456;&#23481;&#26131;&#33073;&#31163;&#24212;&#29992;&#26381;&#21153;&#22120;&#32780;&#22312;&#19968;&#20010;&#31616;&#21333;&#30340;JNDI&#29615;&#22659;&#19979;&#36816;&#34892;&#12290;
			&#19982;<tt class="classname">DriverManagerDataSource</tt>&#19981;&#21516;&#30340;&#26159;&#65292;&#23427;&#22987;&#32456;&#21482;&#20250;&#20351;&#29992;&#21516;&#19968;&#20010;&#25968;&#25454;&#24211;&#36830;&#25509;&#65292;&#20174;&#32780;&#36991;&#20813;&#27599;&#27425;&#24314;&#31435;&#29289;&#29702;&#36830;&#25509;&#30340;&#24320;&#38144;&#12290;
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-DriverManagerDataSource"></a>11.3.5.&nbsp;<tt class="classname">DriverManagerDataSource</tt>&#31867;</h3></div></div><div></div></div><p>
			<tt class="classname">DriverManagerDataSource</tt>&#31867;&#23454;&#29616;&#20102;
<tt class="interfacename">SmartDataSource</tt>&#25509;&#21475;&#12290;&#21487;&#20197;&#20351;&#29992;bean properties&#26469;&#35774;&#32622;JDBC Driver&#23646;&#24615;&#65292;&#35813;&#31867;&#27599;&#27425;&#36820;&#22238;&#30340;&#37117;&#26159;&#19968;&#20010;&#26032;&#30340;&#36830;&#25509;&#12290;
		</p><p>
			&#35813;&#31867;&#20027;&#35201;&#22312;&#27979;&#35797;&#20197;&#21450;&#33073;&#31163;J2EE&#23481;&#22120;&#30340;&#29420;&#31435;&#29615;&#22659;&#20013;&#20351;&#29992;&#12290;&#23427;&#26082;&#21487;&#20197;&#29992;&#26469;&#22312;application context&#20013;&#20316;&#20026;&#19968;&#20010;<tt class="interfacename">DataSource</tt> bean&#65292;&#20063;&#21487;&#20197;&#22312;&#31616;&#21333;&#30340;JNDI&#29615;&#22659;&#19979;&#20351;&#29992;&#12290;
			&#30001;&#20110;<tt class="literal">Connection.close()</tt>&#20165;&#20165;&#21482;&#26159;&#31616;&#21333;&#30340;&#20851;&#38381;&#25968;&#25454;&#24211;&#36830;&#25509;&#65292;&#22240;&#27492;&#20219;&#20309;&#33021;&#22815;&#33719;&#21462;<tt class="interfacename">DataSource</tt>&#30340;&#25345;&#20037;&#21270;&#20195;&#30721;&#37117;&#33021;&#24456;&#22909;&#30340;&#24037;&#20316;&#12290;&#19981;&#36807;&#20351;&#29992;JavaBean&#39118;&#26684;&#30340;&#36830;&#25509;&#27744;
			&#65288;&#27604;&#22914;commons-dbcp&#65289;&#20063;&#24182;&#38750;&#38590;&#20107;&#12290;&#21363;&#20351;&#26159;&#22312;&#27979;&#35797;&#29615;&#22659;&#19979;&#65292;&#20351;&#29992;&#36830;&#25509;&#27744;&#20063;&#26159;&#19968;&#31181;&#27604;&#20351;&#29992;<tt class="classname">DriverManagerDataSource</tt>&#26356;&#22909;&#30340;&#20570;&#27861;&#12290;
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-TransactionAwareDataSourceProxy"></a>11.3.6.&nbsp;<tt class="classname">TransactionAwareDataSourceProxy</tt>&#31867;</h3></div></div><div></div></div><p>
			<tt class="classname">TransactionAwareDataSourceProxy</tt>&#20316;&#20026;&#30446;&#26631;<tt class="interfacename">DataSource</tt>&#30340;&#19968;&#20010;&#20195;&#29702;&#65292;
			&#22312;&#23545;&#30446;&#26631;<tt class="interfacename">DataSource</tt>&#21253;&#35013;&#30340;&#21516;&#26102;&#65292;&#36824;&#22686;&#21152;&#20102;Spring&#30340;&#20107;&#21153;&#31649;&#29702;&#33021;&#21147;&#65292;
			&#22312;&#36825;&#19968;&#28857;&#19978;&#65292;&#36825;&#20010;&#31867;&#30340;&#21151;&#33021;&#38750;&#24120;&#20687;J2EE&#26381;&#21153;&#22120;&#25152;&#25552;&#20379;&#30340;&#20107;&#21153;&#21270;&#30340;JNDI <tt class="interfacename">DataSource</tt>&#12290;
		</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
			&#35813;&#31867;&#20960;&#20046;&#24456;&#23569;&#34987;&#29992;&#21040;&#65292;&#38500;&#38750;&#29616;&#26377;&#20195;&#30721;&#22312;&#34987;&#35843;&#29992;&#30340;&#26102;&#20505;&#38656;&#35201;&#19968;&#20010;&#26631;&#20934;&#30340; JDBC <tt class="interfacename">DataSource</tt>&#25509;&#21475;&#23454;&#29616;&#20316;&#20026;&#21442;&#25968;&#12290;
			&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#36825;&#20010;&#31867;&#21487;&#20197;&#20351;&#29616;&#26377;&#20195;&#30721;&#21442;&#19982;Spring&#30340;&#20107;&#21153;&#31649;&#29702;&#12290;&#36890;&#24120;&#26368;&#22909;&#30340;&#20570;&#27861;&#26159;&#20351;&#29992;&#26356;&#39640;&#23618;&#30340;&#25277;&#35937;
			&#26469;&#23545;&#25968;&#25454;&#28304;&#36827;&#34892;&#31649;&#29702;&#65292;&#27604;&#22914;<tt class="classname">JdbcTemplate</tt>&#21644;<tt class="classname">DataSourceUtils</tt>&#31561;&#31561;&#12290;
			</p></td></tr></table></div><p>
			<span class="emphasis"><em>&#22914;&#26524;&#38656;&#35201;&#26356;&#35814;&#32454;&#30340;&#36164;&#26009;&#65292;&#35831;&#21442;&#32771; <tt class="classname">TransactionAwareDataSourceProxy</tt> JavaDocs&#12290;</em></span>
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-DataSourceTransactionManager"></a>11.3.7.&nbsp;<tt class="classname">DataSourceTransactionManager</tt>&#31867;</h3></div></div><div></div></div><p>
			<tt class="classname">DataSourceTransactionManager</tt>&#31867;&#26159;
			<tt class="interfacename">PlatformTransactionManager</tt>&#25509;&#21475;&#30340;&#19968;&#20010;&#23454;&#29616;&#65292;&#29992;&#20110;&#22788;&#29702;&#21333;JDBC&#25968;&#25454;&#28304;&#12290;
			&#23427;&#23558;&#20174;&#25351;&#23450;DataSource&#21462;&#24471;&#30340;JDBC&#36830;&#25509;&#32465;&#23450;&#21040;&#24403;&#21069;&#32447;&#31243;&#65292;&#22240;&#27492;&#23427;&#20063;&#25903;&#25345;&#20102;&#27599;&#20010;&#25968;&#25454;&#28304;&#23545;&#24212;&#21040;&#19968;&#20010;&#32447;&#31243;&#12290;
		</p><p>
				&#25105;&#20204;&#25512;&#33616;&#22312;&#24212;&#29992;&#20195;&#30721;&#20013;&#20351;&#29992;<tt class="literal">DataSourceUtils.getConnection(DataSource)</tt>&#26469;&#33719;&#21462;
				JDBC&#36830;&#25509;&#65292;&#32780;&#19981;&#26159;&#20351;&#29992;J2EE&#26631;&#20934;&#30340;<tt class="literal">DataSource.getConnection</tt>&#12290;&#22240;&#20026;&#21069;&#32773;&#23558;&#25243;&#20986;
				unchecked&#30340;<tt class="literal">org.springframework.dao</tt>&#24322;&#24120;&#65292;&#32780;&#19981;&#26159;checked&#30340;
				<tt class="classname">SQLException</tt>&#24322;&#24120;&#12290;Spring Framework&#20013;&#25152;&#26377;&#30340;&#31867;&#65288;&#27604;&#22914;
				<tt class="classname">JdbcTemplate</tt>&#65289;&#37117;&#37319;&#29992;&#36825;&#31181;&#20570;&#27861;&#12290;&#22914;&#26524;&#19981;&#38656;&#35201;&#21644;&#36825;&#20010;
				<tt class="classname">DataSourceTransactionManager</tt>&#31867;&#19968;&#36215;&#20351;&#29992;&#65292;DataSourceUtils
				&#25552;&#20379;&#30340;&#21151;&#33021;&#36319;&#19968;&#33324;&#30340;&#25968;&#25454;&#24211;&#36830;&#25509;&#31574;&#30053;&#27809;&#26377;&#20160;&#20040;&#20004;&#26679;&#65292;&#22240;&#27492;&#23427;&#21487;&#20197;&#22312;&#20219;&#20309;&#22330;&#26223;&#19979;&#20351;&#29992;&#12290;
		</p><p>
			<tt class="classname">DataSourceTransactionManager</tt>&#31867;&#25903;&#25345;&#23450;&#21046;&#38548;&#31163;&#32423;&#21035;&#65292;&#20197;&#21450;&#23545;SQL&#35821;&#21477;&#26597;&#35810;&#36229;&#26102;&#30340;&#35774;&#23450;&#12290;
			&#20026;&#20102;&#25903;&#25345;&#21518;&#32773;&#65292;&#24212;&#29992;&#20195;&#30721;&#24517;&#39035;&#20351;&#29992;<tt class="classname">JdbcTemplate</tt>&#25110;&#32773;&#22312;&#27599;&#27425;&#21019;&#24314;SQL&#35821;&#21477;&#26102;&#35843;&#29992;<tt class="literal">DataSourceUtils.applyTransactionTimeout(..)</tt>&#26041;&#27861;&#12290;
		</p><p>
				&#22312;&#20351;&#29992;&#21333;&#20010;&#25968;&#25454;&#28304;&#30340;&#24773;&#24418;&#19979;&#65292;&#20320;&#21487;&#20197;&#29992;<tt class="classname">DataSourceTransactionManager</tt>&#26469;&#26367;&#20195;<tt class="classname">JtaTransactionManager</tt>&#65292;
				&#22240;&#20026;<tt class="classname">DataSourceTransactionManager</tt>&#19981;&#38656;&#35201;&#23481;&#22120;&#25903;&#25345;JTA&#12290;&#22914;&#26524;&#20320;&#20351;&#29992;<tt class="literal">DataSourceUtils.getConnection(DataSource)</tt>&#26469;&#33719;&#21462;
				JDBC&#36830;&#25509;&#65292;&#20108;&#32773;&#20043;&#38388;&#30340;&#20999;&#25442;&#21482;&#38656;&#35201;&#26356;&#25913;&#19968;&#20123;&#37197;&#32622;&#12290;&#26368;&#21518;&#38656;&#35201;&#27880;&#24847;&#30340;&#19968;&#28857;&#23601;&#26159;<tt class="classname">JtaTransactionManager</tt>&#19981;&#25903;&#25345;&#38548;&#31163;&#32423;&#21035;&#30340;&#23450;&#21046;&#65281;
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-NativeJdbcExtractor"></a>11.3.8.&nbsp;NativeJdbcExtractor</h3></div></div><div></div></div><p>&#26377;&#26102;&#25105;&#20204;&#38656;&#35201;&#25191;&#34892;&#29305;&#27530;&#30340;&#65292;&#30001;&#29305;&#23450;&#21378;&#21830;&#25552;&#20379;&#30340;&#19982;&#26631;&#20934;JDBC&#30340;API&#19981;&#21516;&#30340;JDBC&#26041;&#27861;&#12290;&#27492;&#26102;&#65292;&#24403;&#25105;&#20204;&#22312;&#26576;&#20010;&#24212;&#29992;&#26381;&#21153;&#22120;&#19978;&#36816;&#34892;&#21253;&#35013;&#20102;&#36825;&#20123;&#21378;&#21830;&#21508;&#33258;&#23454;&#29616;&#30340;<tt class="classname">Connection</tt>, <tt class="classname">Statement</tt>&#21644;<tt class="classname">ResultSet</tt>&#23545;&#35937;&#30340;<tt class="classname">DataSource</tt>
&#26102;&#65292;&#21487;&#33021;&#20250;&#36935;&#21040;&#19968;&#20123;&#38382;&#39064;&#12290;&#22914;&#26524;&#20320;&#35201;&#35775;&#38382;&#36825;&#20123;&#23545;&#35937;&#65292;&#20320;&#21487;&#20197;&#37197;&#32622;&#19968;&#20010;&#21253;&#21547;<tt class="classname">NativeJdbcExtractor</tt>&#30340;<tt class="classname">JdbcTemplate</tt>&#25110;&#32773;<tt class="classname">OracleLobHandler</tt>&#12290;</p><p>NativeJdbcExtractor&#26681;&#25454;&#25191;&#34892;&#29615;&#22659;&#30340;&#19981;&#21516;&#65292;&#20250;&#26377;&#19981;&#21516;&#30340;&#39118;&#26684;&#30340;&#23454;&#29616;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>SimpleNativeJdbcExtractor</p></li><li><p>C3P0NativeJdbcExtractor</p></li><li><p>CommonsDbcpNativeJdbcExtractor</p></li><li><p>JBossNativeJdbcExtractor</p></li><li><p>WebLogicNativeJdbcExtractor</p></li><li><p>WebSphereNativeJdbcExtractor</p></li><li><p>XAPoolNativeJdbcExtractor</p></li></ul></div><p>&#36890;&#24120;&#26469;&#35828;<tt class="classname">SimpleNativeJdbcExtractor</tt>&#31867;&#23545;&#20110;&#32477;&#22823;&#22810;&#25968;&#29615;&#22659;&#65292;&#24050;&#32463;&#36275;&#20197;&#23631;&#34109; <tt class="classname">Connection</tt> &#23545;&#35937;&#12290;&#21487;&#20197;&#21442;&#35265;Java Docs&#33719;&#21462;&#35814;&#32454;&#20449;&#24687;&#12290;</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jdbc-advanced-jdbc"></a>11.4.&nbsp;JDBC&#25209;&#37327;&#25805;&#20316;</h2></div></div><div></div></div><p>
		&#32477;&#22823;&#22810;&#25968;JDBC&#39537;&#21160;&#38024;&#23545;&#25209;&#37327;&#35843;&#29992;&#30456;&#21516;&#30340;prepared statement&#23545;&#35937;&#25552;&#20379;&#20102;&#24615;&#33021;&#25552;&#21319;&#12290;&#36890;&#36807;&#23558;&#36825;&#20123;&#26356;&#26032;&#25805;&#20316;&#23553;&#35013;&#21040;&#19968;&#20010;&#25209;&#37327;&#25805;&#20316;&#20013;&#65292;&#21487;&#20197;&#22823;&#37327;&#20943;&#23569;&#19982;&#25968;&#25454;&#24211;&#30340;&#25805;&#20316;&#39057;&#32321;&#24230;&#12290;
		&#26412;&#31456;&#33410;&#23558;&#35814;&#32454;&#25551;&#36848;&#20351;&#29992;JdbcTemplate&#25110;&#32773;SimpleJdbcTemplate&#36827;&#34892;&#25209;&#37327;&#25805;&#20316;&#30340;&#27969;&#31243;&#12290;
		</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-advanced-classic"></a>11.4.1.&nbsp;&#20351;&#29992;JdbcTemplate&#36827;&#34892;&#25209;&#37327;&#25805;&#20316;</h3></div></div><div></div></div><p>
			JdbcTemplate&#30340;&#25209;&#37327;&#25805;&#20316;&#29305;&#24615;&#38656;&#35201;&#23454;&#29616;&#29305;&#23450;&#30340;&#25509;&#21475;<tt class="classname">BatchPreparedStatementSetter</tt>&#26469;&#36827;&#34892;&#30340;, &#36890;&#36807;&#23454;&#29616;&#36825;&#20010;&#25509;&#21475;&#65292;&#24182;&#23558;&#20854;&#20256;&#20837;<tt class="classname">batchUpdate</tt>&#26041;&#27861;&#36827;&#34892;&#35843;&#29992;&#12290;
			&#36825;&#20010;&#25509;&#21475;&#26377;&#20004;&#20010;&#26041;&#27861;&#38656;&#35201;&#23454;&#29616;&#12290;&#19968;&#20010;&#21483;&#20570;<tt class="classname">getBatchSize</tt>&#26469;&#25552;&#20379;&#24403;&#21069;&#38656;&#35201;&#25209;&#37327;&#25805;&#20316;&#30340;&#25968;&#37327;&#12290;&#21478;&#22806;&#19968;&#20010;&#26041;&#27861;&#26159;<tt class="classname">setValues</tt>
 &#20801;&#35768;&#20320;&#20026;prepared statement&#35774;&#32622;&#21442;&#25968;&#12290;&#36825;&#20010;&#26041;&#27861;&#23558;&#22312;&#25972;&#20010;&#36807;&#31243;&#20013;&#34987;&#35843;&#29992;&#30340;&#27425;&#25968;&#65292;&#21017;&#21462;&#20915;&#20110;&#20320;&#22312;<tt class="classname">getBatchSize</tt>&#20013;&#25152;&#25351;&#23450;&#30340;&#22823;&#23567;&#12290;
			&#19979;&#38754;&#30340;&#31034;&#20363;&#23637;&#31034;&#20102;&#26681;&#25454;&#20256;&#20837;&#30340;list&#21442;&#25968;&#26356;&#26032;actor&#34920;&#65292;&#32780;&#20256;&#20837;&#30340;list&#21516;&#26102;&#20316;&#20026;&#25209;&#37327;&#25805;&#20316;&#30340;&#21442;&#25968;&#12290;
		</p><p>
      </p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private JdbcTemplate jdbcTemplate;

    public void setDataSource(DataSource dataSource) {
        this.jdbcTemplate = new JdbcTemplate(dataSource);
    }

    public int[] batchUpdate(final List actors) {
        int[] updateCounts = jdbcTemplate.batchUpdate(
                "update t_actor set first_name = ?, last_name = ? where id = ?",
                new BatchPreparedStatementSetter() {
                    public void setValues(PreparedStatement ps, int i) throws SQLException {
                        ps.setString(1, ((Actor)actors.get(i)).getFirstName());
                        ps.setString(2, ((Actor)actors.get(i)).getLastName());
                        ps.setLong(3, ((Actor)actors.get(i)).getId().longValue());
                    }

                    public int getBatchSize() {
                        return actors.size();
                    }
                } );
        return updateCounts;
    }

    //  ... additional methods
}</pre><p>
     &#22914;&#26524;&#20320;&#26159;&#36890;&#36807;&#35835;&#21462;&#25991;&#20214;&#36827;&#34892;&#25209;&#37327;&#25805;&#20316;&#65292;&#37027;&#20040;&#20320;&#21487;&#33021;&#38656;&#35201;&#19968;&#20010;&#29305;&#23450;&#30340;&#25209;&#37327;&#25805;&#20316;&#30340;&#25968;&#37327;&#65292;&#19981;&#36807;&#26368;&#21518;&#19968;&#27425;&#30340;&#25209;&#37327;&#25805;&#20316;&#65292;&#20320;&#21487;&#33021;&#27809;&#26377;&#37027;&#20040;&#22810;&#25968;&#37327;&#30340;&#35760;&#24405;&#12290;
     &#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#20320;&#21487;&#20197;&#23454;&#29616;<tt class="classname">InterruptibleBatchPreparedStatementSetter</tt>&#25509;&#21475;&#65292;&#20174;&#32780;&#20801;&#35768;&#20320;&#22312;&#26576;&#20123;&#24773;&#20917;&#20013;&#26029;&#25209;&#37327;&#25805;&#20316;&#65292;<tt class="classname">isBatchExhausted</tt> &#26041;&#27861;&#20801;&#35768;&#20320;&#25351;&#23450;&#19968;&#20010;&#32456;&#27490;&#25209;&#37327;&#25805;&#20316;&#30340;&#20449;&#21495;&#37327;&#12290;
     </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-advanced-simple"></a>11.4.2.&nbsp;&#20351;&#29992;SimpleJdbcTemplate&#36827;&#34892;&#25209;&#37327;&#25805;&#20316;</h3></div></div><div></div></div><p><tt class="classname">SimpleJdbcTemplate</tt>&#31867;&#25552;&#20379;&#20102;&#21478;&#22806;&#19968;&#31181;&#25209;&#37327;&#25805;&#20316;&#30340;&#26041;&#24335;&#12290;&#26080;&#38656;&#23454;&#29616;&#19968;&#20010;&#29305;&#23450;&#30340;&#25509;&#21475;&#65292;&#20320;&#21482;&#38656;&#35201;&#25552;&#20379;&#25152;&#26377;&#22312;&#35843;&#29992;&#36807;&#31243;&#20013;&#35201;&#29992;&#21040;&#30340;&#21442;&#25968;&#65292;&#26694;&#26550;&#20250;&#36941;&#21382;&#36825;&#20123;&#21442;&#25968;&#20540;&#65292;&#24182;&#20351;&#29992;&#20869;&#32622;&#30340;prepared statement&#31867;&#36827;&#34892;&#25209;&#37327;&#25805;&#20316;&#12290;API&#23558;&#26681;&#25454;&#20320;&#26159;&#21542;&#20351;&#29992;&#21629;&#21517;&#21442;&#25968;&#32780;&#26377;&#25152;&#19981;&#21516;&#12290;&#23545;&#20110;&#20351;&#29992;&#21629;&#21517;&#21442;&#25968;&#30340;&#24773;&#20917;&#65292;&#20320;&#38656;&#35201;&#25552;&#20379;&#19968;&#20010;<tt class="classname">SqlParameterSource</tt>&#30340;&#25968;&#32452;, &#20854;&#20013;&#30340;&#27599;&#20010;&#20803;&#32032;&#23558;&#23558;&#20316;&#20026;&#25209;&#37327;&#25805;&#20316;&#30340;&#21442;&#25968;&#12290;
			&#20320;&#21487;&#20197;&#20351;&#29992;<tt class="classname">SqlParameterSource.createBatch</tt>&#26041;&#27861;&#65292;&#36890;&#36807;&#20256;&#20837;&#19968;&#20010;JavaBean&#30340;&#25968;&#32452;&#25110;&#32773;&#19968;&#20010;&#21253;&#21547;&#20102;&#21442;&#25968;&#38190;&#20540;&#23545;&#30340;Map&#25968;&#32452;&#26469;&#21019;&#24314;&#36825;&#20010;&#25968;&#32452;&#12290;
		</p><p>&#19979;&#38754;&#30340;&#31034;&#20363;&#23637;&#31034;&#20102;&#20351;&#29992;&#21629;&#21517;&#21442;&#25968;&#36827;&#34892;&#25209;&#37327;&#26356;&#26032;&#30340;&#26041;&#27861;&#65306;</p><p>
      </p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private SimpleJdbcTemplate simpleJdbcTemplate;

    public void setDataSource(DataSource dataSource) {
        this.simpleJdbcTemplate = new SimpleJdbcTemplate(dataSource);
    }

    public int[] batchUpdate(final List&lt;Actor&gt; actors) {
        SqlParameterSource[] batch = SqlParameterSourceUtils.createBatch(actors.toArray());
        int[] updateCounts = simpleJdbcTemplate.batchUpdate(
                "update t_actor set first_name = :firstName, last_name = :lastName where id = :id",
                batch);
        return updateCounts;
    }

    //  ... additional methods
}</pre><p>
		&#23545;&#20110;&#20351;&#29992;&#20256;&#32479;&#30340;&#8220;?&#8221;&#20316;&#20026;&#21442;&#25968;&#21344;&#20301;&#31526;&#30340;&#24773;&#20917;&#65292;&#20320;&#21487;&#20197;&#20256;&#20837;&#19968;&#20010;List&#65292;&#21253;&#21547;&#20102;&#25152;&#26377;&#38656;&#35201;&#36827;&#34892;&#25209;&#37327;&#26356;&#26032;&#30340;&#23545;&#35937;&#12290;&#36825;&#26679;&#30340;&#23545;&#35937;&#25968;&#32452;&#24517;&#39035;&#19982;&#27599;&#20010;SQL Statement&#30340;&#21344;&#20301;&#31526;&#20197;&#21450;&#20182;&#20204;&#22312;SQL Statement&#20013;&#20986;&#29616;&#30340;&#20301;&#32622;&#19968;&#19968;&#23545;&#24212;&#12290;
		</p><p>&#19979;&#38754;&#26159;&#21516;&#26679;&#30340;&#20363;&#23376;&#65292;&#20351;&#29992;&#30340;&#20256;&#32479;&#30340;&#8220;?&#8221;&#20316;&#20026;&#21442;&#25968;&#21344;&#20301;&#31526;&#65306;</p><p>
      </p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private SimpleJdbcTemplate simpleJdbcTemplate;

    public void setDataSource(DataSource dataSource) {
        this.simpleJdbcTemplate = new SimpleJdbcTemplate(dataSource);
    }

    public int[] batchUpdate(final List&lt;Actor&gt; actors) {
        List&lt;Object[]&gt; batch = new ArrayList&lt;Object[]&gt;();
        for (Actor actor : actors) {
            Object[] values = new Object[] {
                    actor.getFirstName(),
                    actor.getLastName(),
                    actor.getId()};
            batch.add(values);
        }
        int[] updateCounts = simpleJdbcTemplate.batchUpdate(
                "update t_actor set first_name = ?, last_name = ? where id = ?",
                batch);
        return updateCounts;
    }

    //  ... additional methods
}</pre><p>
			&#25152;&#26377;&#30340;&#25209;&#37327;&#26356;&#26032;&#30340;&#26041;&#27861;&#37117;&#20250;&#36820;&#22238;&#19968;&#32452;int&#30340;&#25968;&#32452;&#65292;&#34920;&#31034;&#22312;&#25972;&#20010;&#25805;&#20316;&#36807;&#31243;&#20013;&#26377;&#22810;&#23569;&#35760;&#24405;&#34987;&#25209;&#37327;&#26356;&#26032;&#12290;
			&#36825;&#20010;&#25968;&#37327;&#26159;&#30001;JDBC&#39537;&#21160;&#25152;&#36820;&#22238;&#30340;&#65292;&#26377;&#26102;&#36825;&#20010;&#36820;&#22238;&#24182;&#19981;&#21487;&#38752;&#65292;&#23588;&#20854;&#23545;&#20110;&#26576;&#20123;JDBC&#39537;&#21160;&#21482;&#26159;&#31616;&#21333;&#30340;&#36820;&#22238;-2&#20316;&#20026;&#36820;&#22238;&#20540;&#12290;   
		</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jdbc-simple-jdbc"></a>11.5.&nbsp;&#36890;&#36807;&#20351;&#29992;SimpleJdbc&#31867;&#31616;&#21270;JDBC&#25805;&#20316;</h2></div></div><div></div></div><p>
		<tt class="classname">SimpleJdbcInsert</tt>&#31867;&#21644;<tt class="classname">SimpleJdbcCall</tt>&#31867;&#20027;&#35201;&#21033;&#29992;&#20102;JDBC&#39537;&#21160;&#25152;&#25552;&#20379;&#30340;&#25968;&#25454;&#24211;&#20803;&#25968;&#25454;&#30340;&#19968;&#20123;&#29305;&#24615;&#26469;&#31616;&#21270;&#25968;&#25454;&#24211;&#25805;&#20316;&#37197;&#32622;&#12290;
		 &#36825;&#24847;&#21619;&#30528;&#20320;&#21487;&#20197;&#23613;&#21487;&#33021;&#30340;&#31616;&#21270;&#20320;&#30340;&#25968;&#25454;&#24211;&#25805;&#20316;&#37197;&#32622;&#12290;&#24403;&#28982;&#65292;&#20320;&#21487;&#20197;&#21487;&#20197;&#23558;&#20803;&#25968;&#25454;&#22788;&#29702;&#30340;&#29305;&#24615;&#20851;&#38381;&#65292;&#20174;&#32780;&#22312;&#20320;&#30340;&#20195;&#30721;&#20013;&#35814;&#32454;&#25351;&#23450;&#36825;&#20123;&#29305;&#24615;&#12290;
	</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-simple-jdbc-insert-1"></a>11.5.1.&nbsp;&#20351;&#29992;SimpleJdbcInsert&#25554;&#20837;&#25968;&#25454;</h3></div></div><div></div></div><p>
		&#35753;&#25105;&#20204;&#20174;<tt class="classname">SimpleJdbcInsert</tt>&#31867;&#24320;&#22987;&#12290;&#25105;&#20204;&#23558;&#23613;&#21487;&#33021;&#20351;&#29992;&#26368;&#23569;&#37327;&#30340;&#37197;&#32622;&#12290;<tt class="classname">SimpleJdbcInsert</tt>&#31867;&#24517;&#39035;&#22312;&#25968;&#25454;&#35775;&#38382;&#23618;&#30340;&#21021;&#22987;&#21270;&#26041;&#27861;&#20013;&#34987;&#21021;&#22987;&#21270;&#12290;
			&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#21021;&#22987;&#21270;&#26041;&#27861;&#20026;<tt class="classname">setDataSource</tt>&#26041;&#27861;&#12290;&#20320;&#26080;&#38656;&#32487;&#25215;&#33258;<tt class="classname">SimpleJdbcInsert</tt>
&#31867;&#65292;&#21482;&#38656;&#35201;&#21019;&#24314;&#19968;&#20010;&#26032;&#30340;&#23454;&#20363;&#65292;&#24182;&#36890;&#36807;<tt class="classname">withTableName</tt>&#26041;&#27861;&#35774;&#32622;table&#21517;&#31216;&#12290;
			&#36825;&#20010;&#31867;&#20351;&#29992;&#20102;&#8220;fluid&#8221;&#27169;&#24335;&#36820;&#22238;<tt class="classname">SimpleJdbcInsert</tt>&#65292;&#20174;&#32780;&#20320;&#21487;&#20197;&#35775;&#38382;&#21040;&#25152;&#26377;&#30340;&#21487;&#20197;&#36827;&#34892;&#37197;&#32622;&#30340;&#26041;&#27861;&#12290;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#21482;&#20351;&#29992;&#20102;&#19968;&#20010;&#26041;&#27861;&#65292;&#31245;&#21518;&#25105;&#20204;&#20250;&#30475;&#21040;&#26356;&#22810;&#30340;&#37197;&#32622;&#26041;&#27861;&#12290;
			</p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private SimpleJdbcTemplate simpleJdbcTemplate;
    private SimpleJdbcInsert insertActor;

    public void setDataSource(DataSource dataSource) {
        this.simpleJdbcTemplate = new SimpleJdbcTemplate(dataSource);
        this.insertActor = 
                new SimpleJdbcInsert(dataSource).withTableName("t_actor");
    }

    public void add(Actor actor) {
        Map&lt;String, Object&gt; parameters = new HashMap&lt;String, Object&gt;(3);
        parameters.put("id", actor.getId());
        parameters.put("first_name", actor.getFirstName());
        parameters.put("last_name", actor.getLastName());
        insertActor.execute(parameters);
    }

    //  ... additional methods
}</pre><p>&#36825;&#20010;&#26041;&#27861;&#36890;&#36807;&#25509;&#25910; <tt class="classname">java.utils.Map</tt> &#20316;&#20026;&#23427;&#21807;&#19968;&#30340;&#21442;&#25968;&#12290;
     	&#22312;&#36825;&#37324;&#38656;&#35201;&#37325;&#28857;&#27880;&#24847;&#30340;&#26159;&#65292;&#22312;Map&#20013;&#30340;&#25152;&#26377;&#30340;key&#65292;&#24517;&#39035;&#21644;&#25968;&#25454;&#24211;&#20013;&#23450;&#20041;&#30340;&#21015;&#21517;&#23436;&#20840;&#21305;&#37197;&#12290;&#36825;&#26159;&#22240;&#20026;&#25105;&#20204;&#26159;&#36890;&#36807;&#35835;&#21462;&#20803;&#25968;&#25454;&#26469;&#26500;&#36896;&#23454;&#38469;&#30340;Insert&#35821;&#21477;&#30340;&#12290;
     	</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-simple-jdbc-insert-2"></a>11.5.2.&nbsp;&#20351;&#29992;SimpleJdbcInsert&#26469;&#33719;&#21462;&#33258;&#21160;&#29983;&#25104;&#30340;&#20027;&#38190;</h3></div></div><div></div></div><p>&#25509;&#19979;&#26469;&#65292;&#25105;&#20204;&#23545;&#20110;&#21516;&#26679;&#30340;&#25554;&#20837;&#35821;&#21477;&#65292;&#25105;&#20204;&#24182;&#19981;&#20256;&#20837;id&#65292;&#32780;&#26159;&#36890;&#36807;&#25968;&#25454;&#24211;&#33258;&#21160;&#33719;&#21462;&#20027;&#38190;&#30340;&#26041;&#24335;&#26469;&#21019;&#24314;&#26032;&#30340;Actor&#23545;&#35937;&#24182;&#25554;&#20837;&#25968;&#25454;&#24211;&#12290;
		&#24403;&#25105;&#20204;&#21019;&#24314;<tt class="classname">SimpleJdbcInsert</tt>&#23454;&#20363;&#26102;, &#25105;&#20204;&#19981;&#20165;&#38656;&#35201;&#25351;&#23450;&#34920;&#21517;&#65292;&#21516;&#26102;&#25105;&#20204;&#36890;&#36807;<tt class="classname">usingGeneratedKeyColumns</tt>&#26041;&#27861;&#25351;&#23450;&#38656;&#35201;&#25968;&#25454;&#24211;&#33258;&#21160;&#29983;&#25104;&#20027;&#38190;&#30340;&#21015;&#21517;&#12290;
		</p><p>
      </p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private SimpleJdbcTemplate simpleJdbcTemplate;
    private SimpleJdbcInsert insertActor;

    public void setDataSource(DataSource dataSource) {
        this.simpleJdbcTemplate = new SimpleJdbcTemplate(dataSource);
        this.insertActor =
                new SimpleJdbcInsert(dataSource)
                        .withTableName("t_actor")
                        .usingGeneratedKeyColumns("id");
    }

    public void add(Actor actor) {
        Map&lt;String, Object&gt; parameters = new HashMap&lt;String, Object&gt;(2);
        parameters.put("first_name", actor.getFirstName());
        parameters.put("last_name", actor.getLastName());
        Number newId = insertActor.executeAndReturnKey(parameters);
        actor.setId(newId.longValue());
    }

    //  ... additional methods
}</pre><p>
		&#36825;&#26679;&#25105;&#20204;&#21487;&#20197;&#30475;&#21040;&#19982;&#20043;&#21069;&#25191;&#34892;&#30340;insert&#25805;&#20316;&#30340;&#19981;&#21516;&#20043;&#22788;&#22312;&#20110;&#65292;&#25105;&#20204;&#26080;&#38656;&#28155;&#21152;id&#21040;&#21442;&#25968;&#30340;Map&#20013;&#21435;&#65292;&#21482;&#38656;&#35201;&#35843;&#29992;<tt class="literal">executeReturningKey</tt>&#26041;&#27861;&#12290;
		&#36825;&#20010;&#26041;&#27861;&#23558;&#36820;&#22238;&#19968;&#20010;<tt class="literal">java.lang.Number</tt>&#23545;&#35937;&#65292;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#36825;&#20010;&#23545;&#35937;&#26469;&#21019;&#24314;&#19968;&#20010;&#23383;&#31526;&#31867;&#22411;&#30340;&#23454;&#20363;&#20316;&#20026;&#25105;&#20204;&#30340;&#22495;&#27169;&#22411;&#30340;&#23646;&#24615;&#12290;
		&#26377;&#19968;&#28857;&#24456;&#37325;&#35201;&#30340;&#22320;&#26041;&#38656;&#35201;&#27880;&#24847;&#65292;&#25105;&#20204;&#26080;&#27861;&#20381;&#36182;&#25152;&#26377;&#30340;&#25968;&#25454;&#24211;&#26469;&#36820;&#22238;&#25105;&#20204;&#25351;&#23450;&#30340;Java&#31867;&#22411;&#65292;&#22240;&#20026;&#25105;&#20204;&#21482;&#30693;&#36947;&#36825;&#20123;&#23545;&#35937;&#30340;&#22522;&#31867;&#26159;<tt class="literal">java.lang.Number</tt>&#12290;
		&#22914;&#26524;&#20320;&#26377;&#32852;&#21512;&#20027;&#38190;&#25110;&#32773;&#37027;&#20123;&#38750;&#25968;&#23383;&#31867;&#22411;&#30340;&#20027;&#38190;&#38656;&#35201;&#29983;&#25104;&#65292;&#37027;&#20040;&#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">executeReturningKeyHolder</tt>&#26041;&#27861;&#36820;&#22238;&#30340;<tt class="literal">KeyHolder</tt>&#23545;&#35937;&#12290;		
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-simple-jdbc-insert-3"></a>11.5.3.&nbsp;&#25351;&#23450;SimpleJdbcInsert&#25152;&#20351;&#29992;&#30340;&#23383;&#27573;</h3></div></div><div></div></div><p>
      &#36890;&#36807;&#25351;&#23450;&#25152;&#20351;&#29992;&#30340;&#23383;&#27573;&#21517;&#31216;&#65292;&#21487;&#20197;&#20351;SimpleJdbcInsert&#20165;&#20351;&#29992;&#36825;&#20123;&#23383;&#27573;&#20316;&#20026;insert&#35821;&#21477;&#25152;&#20351;&#29992;&#30340;&#23383;&#27573;&#12290;&#36825;&#21487;&#20197;&#36890;&#36807;<tt class="classname">usingColumns</tt>&#26041;&#27861;&#36827;&#34892;&#37197;&#32622;&#12290;
      </p><p>
      </p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private SimpleJdbcTemplate simpleJdbcTemplate;
    private SimpleJdbcInsert insertActor;

    public void setDataSource(DataSource dataSource) {
        this.simpleJdbcTemplate = new SimpleJdbcTemplate(dataSource);
        this.insertActor =
                new SimpleJdbcInsert(dataSource)
                        .withTableName("t_actor")
                        .usingColumns("first_name", "last_name")
                        .usingGeneratedKeyColumns("id");
    }

    public void add(Actor actor) {
        Map&lt;String, Object&gt; parameters = new HashMap&lt;String, Object&gt;(2);
        parameters.put("first_name", actor.getFirstName());
        parameters.put("last_name", actor.getLastName());
        Number newId = insertActor.executeAndReturnKey(parameters);
        actor.setId(newId.longValue());
    }

    //  ... additional methods
}</pre><p>
     &#25191;&#34892;&#36825;&#26679;&#30340;insert&#35821;&#21477;&#25152;&#20351;&#29992;&#30340;&#23383;&#27573;&#65292;&#19982;&#20043;&#21069;&#25105;&#20204;&#25152;&#20381;&#36182;&#30340;&#25968;&#25454;&#24211;&#20803;&#25968;&#25454;&#26159;&#19968;&#33268;&#30340;&#12290; 
	</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-simple-jdbc-parameters"></a>11.5.4.&nbsp;&#20351;&#29992;SqlParameterSource&#25552;&#20379;&#21442;&#25968;&#20540;</h3></div></div><div></div></div><p>&#20351;&#29992;Map&#26469;&#25351;&#23450;&#21442;&#25968;&#20540;&#26377;&#26102;&#20505;&#24037;&#20316;&#24471;&#38750;&#24120;&#22909;&#65292;&#20294;&#26159;&#36825;&#24182;&#19981;&#26159;&#26368;&#31616;&#21333;&#30340;&#20351;&#29992;&#26041;&#24335;&#12290;Spring&#25552;&#20379;&#20102;&#19968;&#20123;&#20854;&#20182;&#30340;<tt class="classname">SqlParameterSource</tt>&#23454;&#29616;&#31867;&#26469;&#25351;&#23450;&#21442;&#25968;&#20540;&#12290;
			&#25105;&#20204;&#39318;&#20808;&#21487;&#20197;&#30475;&#30475;<tt class="classname">BeanPropertySqlParameterSource</tt>&#31867;&#65292;&#36825;&#26159;&#19968;&#20010;&#38750;&#24120;&#31616;&#20415;&#30340;&#25351;&#23450;&#21442;&#25968;&#30340;&#23454;&#29616;&#31867;&#65292;&#21482;&#35201;&#20320;&#26377;&#19968;&#20010;&#31526;&#21512;JavaBean&#35268;&#33539;&#30340;&#31867;&#23601;&#34892;&#20102;&#12290;&#23427;&#23558;&#20351;&#29992;&#20854;&#20013;&#30340;getter&#26041;&#27861;&#26469;&#33719;&#21462;&#21442;&#25968;&#20540;&#12290;
			&#19979;&#38754;&#26159;&#19968;&#20010;&#20363;&#23376;&#65306;
		</p><p>
      </p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private SimpleJdbcTemplate simpleJdbcTemplate;
    private SimpleJdbcInsert insertActor;

    public void setDataSource(DataSource dataSource) {
        this.simpleJdbcTemplate = new SimpleJdbcTemplate(dataSource);
        this.insertActor =
                new SimpleJdbcInsert(dataSource)
                        .withTableName("t_actor")
                        .usingGeneratedKeyColumns("id");
    }

    public void add(Actor actor) {
        SqlParameterSource parameters = new BeanPropertySqlParameterSource(actor);
        Number newId = insertActor.executeAndReturnKey(parameters);
        actor.setId(newId.longValue());
    }

    //  ... additional methods
}</pre><p>
        &#21478;&#22806;&#19968;&#20010;&#23454;&#29616;&#31867;&#65306;<tt class="classname">MapSqlParameterSource</tt>&#20063;&#20351;&#29992;Map&#26469;&#25351;&#23450;&#21442;&#25968;&#65292;&#20294;&#26159;&#20182;&#21478;&#22806;&#25552;&#20379;&#20102;&#19968;&#20010;&#38750;&#24120;&#31616;&#20415;&#30340;<tt class="classname">addValue</tt>&#26041;&#27861;&#65292;&#21487;&#20197;&#34987;&#36830;&#32493;&#35843;&#29992;&#65292;&#26469;&#22686;&#21152;&#21442;&#25968;&#12290;
        </p><p>
      </p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private SimpleJdbcTemplate simpleJdbcTemplate;
    private SimpleJdbcInsert insertActor;

    public void setDataSource(DataSource dataSource) {
        this.simpleJdbcTemplate = new SimpleJdbcTemplate(dataSource);
        this.insertActor =
                new SimpleJdbcInsert(dataSource)
                        .withTableName("t_actor")
                        .usingGeneratedKeyColumns("id");
    }

    public void add(Actor actor) {
        SqlParameterSource parameters = new MapSqlParameterSource()
                .addValue("first_name", actor.getFirstName())
                .addValue("last_name", actor.getLastName());
        Number newId = insertActor.executeAndReturnKey(parameters);
        actor.setId(newId.longValue());
    }

    //  ... additional methods
}</pre><p>
		&#27491;&#22914;&#20320;&#30475;&#21040;&#30340;&#65292;&#37197;&#32622;&#26159;&#19968;&#26679;&#30340;&#65292;&#21306;&#21035;&#21482;&#26159;&#20999;&#25442;&#20102;&#19981;&#21516;&#30340;&#25552;&#20379;&#21442;&#25968;&#30340;&#23454;&#29616;&#26041;&#24335;&#26469;&#25191;&#34892;&#35843;&#29992;&#12290;
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-simple-jdbc-call-1"></a>11.5.5.&nbsp;&#20351;&#29992;SimpleJdbcCall&#35843;&#29992;&#23384;&#20648;&#36807;&#31243;</h3></div></div><div></div></div><p>
		&#25509;&#19979;&#26469;&#25105;&#20204;&#25226;&#25105;&#20204;&#30340;&#20851;&#27880;&#28857;&#25918;&#22312;&#20351;&#29992; <tt class="classname">SimpleJdbcCall</tt> &#26469;&#36827;&#34892;&#23384;&#20648;&#36807;&#31243;&#30340;&#35843;&#29992;&#19978;&#12290;
			&#35774;&#35745;&#36825;&#20010;&#31867;&#30340;&#30446;&#30340;&#22312;&#20110;&#20351;&#24471;&#35843;&#29992;&#23384;&#20648;&#36807;&#31243;&#23613;&#21487;&#33021;&#31616;&#21333;&#12290;&#23427;&#21516;&#26679;&#21033;&#29992;&#30340;&#25968;&#25454;&#24211;&#20803;&#25968;&#25454;&#30340;&#29305;&#24615;&#26469;&#26597;&#25214;&#20256;&#20837;&#30340;&#21442;&#25968;&#21644;&#36820;&#22238;&#20540;&#12290;
			&#36825;&#24847;&#21619;&#30528;&#20320;&#26080;&#38656;&#26126;&#30830;&#22768;&#26126;&#37027;&#20123;&#21442;&#25968;&#12290;&#24403;&#28982;&#65292;&#22914;&#26524;&#20320;&#21916;&#27426;&#65292;&#21487;&#20197;&#20381;&#28982;&#22768;&#26126;&#36825;&#20123;&#21442;&#25968;&#65292;&#23588;&#20854;&#23545;&#20110;&#26576;&#20123;&#21442;&#25968;&#65292;&#20320;&#26080;&#27861;&#30452;&#25509;&#23558;&#20182;&#20204;&#26144;&#23556;&#21040;Java&#31867;&#19978;&#65292;&#20363;&#22914;ARRAY&#31867;&#22411;&#21644;STRUCT&#31867;&#22411;&#30340;&#21442;&#25968;&#12290;
			&#22312;&#25105;&#20204;&#30340;&#31532;&#19968;&#20010;&#31034;&#20363;&#20013;&#65292;&#25105;&#20204;&#21487;&#20197;&#30475;&#21040;&#19968;&#20010;&#31616;&#21333;&#30340;&#23384;&#20648;&#36807;&#31243;&#35843;&#29992;&#65292;&#23427;&#20165;&#20165;&#36820;&#22238;VARCHAR&#21644;DATE&#31867;&#22411;&#12290;
			&#36825;&#37324;&#65292;&#25105;&#29305;&#22320;&#20026;Actor&#31867;&#22686;&#21152;&#20102;&#19968;&#20010;birthDate&#30340;&#23646;&#24615;&#65292;&#20174;&#32780;&#21487;&#20197;&#20351;&#24471;&#36820;&#22238;&#20540;&#25317;&#26377;&#19981;&#21516;&#30340;&#25968;&#25454;&#31867;&#22411;&#12290;
			&#36825;&#20010;&#23384;&#20648;&#36807;&#31243;&#35835;&#21462;actor&#30340;&#20027;&#38190;&#65292;&#24182;&#36820;&#22238;first_name&#65292;last_name&#65292;&#21644;birth_date&#23383;&#27573;&#20316;&#20026;&#36820;&#22238;&#20540;&#12290;
			&#19979;&#38754;&#26159;&#36825;&#20010;&#23384;&#20648;&#36807;&#31243;&#30340;&#28304;&#30721;&#65292;&#23427;&#21487;&#20197;&#24037;&#20316;&#22312;MySQL&#25968;&#25454;&#24211;&#19978;&#65306;
		</p><p>
      </p><pre class="programlisting">CREATE PROCEDURE read_actor ( 
  IN in_id INTEGER, 
  OUT out_first_name VARCHAR(100), 
  OUT out_last_name VARCHAR(100), 
  OUT out_birth_date DATE) 
BEGIN 
  SELECT first_name, last_name, birth_date 
  INTO out_first_name, out_last_name, out_birth_date 
  FROM t_actor where id = in_id;
END;</pre><p>
		&#27491;&#22914;&#20320;&#30475;&#21040;&#30340;&#65292;&#36825;&#37324;&#26377;&#22235;&#20010;&#21442;&#25968;&#65292;&#20854;&#20013;&#19968;&#20010;&#26159;&#20256;&#20837;&#30340;&#21442;&#25968;&#8220;in_id&#8221;&#65292;&#34920;&#31034;&#20102;Actor&#30340;&#20027;&#38190;&#65292;&#21097;&#19979;&#30340;&#21442;&#25968;&#26159;&#20316;&#20026;&#35835;&#21462;&#25968;&#25454;&#24211;&#34920;&#20013;&#30340;&#25968;&#25454;&#25152;&#36820;&#22238;&#30340;&#36820;&#22238;&#20540;&#12290;	
	</p><p>
		<tt class="classname">SimpleJdbcCall</tt>&#30340;&#22768;&#26126;&#19982;<tt class="classname">SimpleJdbcInsert</tt>&#31867;&#20284;&#65292;&#20320;&#26080;&#38656;&#32487;&#25215;&#36825;&#20010;&#31867;&#65292;&#32780;&#21482;&#38656;&#35201;&#22312;&#21021;&#22987;&#21270;&#26041;&#27861;&#20013;&#36827;&#34892;&#21021;&#22987;&#21270;&#12290;
			&#22312;&#36825;&#37324;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#21482;&#38656;&#35201;&#25351;&#23450;&#23384;&#20648;&#36807;&#31243;&#30340;&#21517;&#31216;&#12290;
		</p><p>
      </p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private SimpleJdbcTemplate simpleJdbcTemplate;
    private SimpleJdbcCall procReadActor;

    public void setDataSource(DataSource dataSource) {
        this.simpleJdbcTemplate = new SimpleJdbcTemplate(dataSource);
        this.procReadActor =
                new SimpleJdbcCall(dataSource)
                        .withProcedureName("read_actor");
    }

    public Actor readActor(Long id) {
        SqlParameterSource in = new MapSqlParameterSource()
                .addValue("in_id", id); 
        Map out = procReadActor.execute(in);
        Actor actor = new Actor();
        actor.setId(id);
        actor.setFirstName((String) out.get("out_first_name"));
        actor.setLastName((String) out.get("out_last_name"));
        actor.setBirthDate((Date) out.get("out_birth_date"));
        return actor;
    }

    //  ... additional methods
}</pre><p>
      &#36890;&#36807;SimpleJdbcCall&#25191;&#34892;&#23384;&#20648;&#36807;&#31243;&#38656;&#35201;&#21019;&#24314;&#19968;&#20010;<tt class="classname">SqlParameterSource</tt>&#30340;&#23454;&#29616;&#31867;&#26469;&#25351;&#23450;&#20256;&#20837;&#30340;&#21442;&#25968;&#12290;
      &#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#65292;&#20256;&#20837;&#21442;&#25968;&#30340;&#21517;&#31216;&#19982;&#23384;&#20648;&#36807;&#31243;&#20013;&#23450;&#20041;&#30340;&#21517;&#31216;&#24517;&#39035;&#20445;&#25345;&#19968;&#33268;&#12290;&#36825;&#37324;&#65292;&#25105;&#20204;&#26080;&#38656;&#20445;&#25345;&#19968;&#33268;&#65292;&#22240;&#20026;&#25105;&#20204;&#20351;&#29992;&#25968;&#25454;&#24211;&#30340;&#20803;&#25968;&#25454;&#20449;&#24687;&#26469;&#20915;&#23450;&#25105;&#20204;&#38656;&#35201;&#20160;&#20040;&#26679;&#30340;&#25968;&#25454;&#24211;&#23545;&#35937;&#12290;
      &#24403;&#28982;&#65292;&#20320;&#22312;&#28304;&#20195;&#30721;&#20013;&#25152;&#25351;&#23450;&#30340;&#21517;&#31216;&#21487;&#33021;&#21644;&#25968;&#25454;&#24211;&#20013;&#23436;&#20840;&#19981;&#21516;&#65292;&#26377;&#30340;&#25968;&#25454;&#24211;&#20250;&#25226;&#36825;&#20123;&#21517;&#31216;&#20840;&#37096;&#36716;&#21270;&#25104;&#22823;&#20889;&#65292;&#32780;&#26377;&#20123;&#25968;&#25454;&#24211;&#20250;&#25226;&#36825;&#20123;&#21517;&#31216;&#36716;&#21270;&#20026;&#23567;&#20889;&#12290;    
      </p><p><tt class="classname">execute</tt>&#26041;&#27861;&#25509;&#25910;&#20256;&#20837;&#30340;&#21442;&#25968;&#65292;&#24182;&#36820;&#22238;&#19968;&#20010;Map&#20316;&#20026;&#36820;&#22238;&#20540;&#65292;&#36825;&#20010;Map&#21253;&#21547;&#25152;&#26377;&#22312;&#23384;&#20648;&#36807;&#31243;&#20013;&#25351;&#23450;&#30340;&#21442;&#25968;&#21517;&#31216;&#20316;&#20026;key&#12290;
			&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#20182;&#20204;&#20998;&#21035;&#26159;<tt class="classname">out_first_name&#65292;out_last_name</tt>&#21644;
      <tt class="classname">out_birth_date</tt>&#12290;
      </p><p>
		<tt class="classname">execute</tt>&#26041;&#27861;&#30340;&#26368;&#21518;&#37096;&#20998;&#26159;&#20351;&#29992;&#23384;&#20648;&#36807;&#31243;&#25152;&#36820;&#22238;&#30340;&#20540;&#21019;&#24314;&#19968;&#20010;&#26032;&#30340;Actor&#23454;&#20363;&#12290;
			&#21516;&#26679;&#30340;&#65292;&#36825;&#37324;&#25105;&#20204;&#23558;&#21517;&#31216;&#19982;&#23384;&#20648;&#36807;&#31243;&#20013;&#23450;&#20041;&#30340;&#21517;&#31216;&#20445;&#25345;&#19968;&#33268;&#38750;&#24120;&#37325;&#35201;&#12290;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#22312;&#36820;&#22238;&#30340;Map&#20013;&#25152;&#23450;&#20041;&#30340;key&#20540;&#21644;&#25968;&#25454;&#24211;&#30340;&#23384;&#20648;&#36807;&#31243;&#20013;&#23450;&#20041;&#30340;&#20540;&#19968;&#33268;&#12290;
			&#20320;&#21487;&#33021;&#38656;&#35201;&#22312;&#36825;&#37324;&#25351;&#23450;Spring&#20351;&#29992;Jakarta Commons&#25552;&#20379;&#30340;<tt class="classname">CaseInsensitiveMap</tt>&#12290;&#36825;&#26679;&#20570;&#65292;&#20320;&#38656;&#35201;&#22312;&#21019;&#24314;&#20320;&#33258;&#24049;&#30340;<tt class="classname">JdbcTemplate</tt>&#31867;&#26102;&#65292;&#35774;&#32622;<tt class="classname">setResultsMapCaseInsensitive</tt>&#23646;&#24615;&#20026;True&#12290;
			&#28982;&#21518;&#65292;&#20320;&#23558;&#36825;&#20010;&#33258;&#23450;&#20041;&#30340;<tt class="classname">JdbcTemplate</tt>&#20256;&#20837;<tt class="classname">SimpleJdbcCall</tt>&#30340;&#26500;&#36896;&#20989;&#25968;&#12290;&#24403;&#28982;&#65292;&#20320;&#38656;&#35201;&#25226;<tt class="classname">commons-collections.jar</tt>&#21152;&#20837;&#21040;classpath&#20013;&#21435;&#12290;
			&#19979;&#38754;&#26159;&#37197;&#32622;&#31034;&#20363;&#65306;
		</p><p>
      </p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private SimpleJdbcCall procReadActor;

    public void setDataSource(DataSource dataSource) {
        JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);
        jdbcTemplate.setResultsMapCaseInsensitive(true);
        this.procReadActor =
                new SimpleJdbcCall(jdbcTemplate)
                        .withProcedureName("read_actor");
    }


    //  ... additional methods
}</pre><p>
         &#36890;&#36807;&#36825;&#26679;&#30340;&#37197;&#32622;&#65292;&#20320;&#23601;&#21487;&#20197;&#26080;&#38656;&#25285;&#24515;&#36820;&#22238;&#21442;&#25968;&#20540;&#30340;&#22823;&#23567;&#20889;&#38382;&#39064;&#12290;      
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-simple-jdbc-call-2"></a>11.5.6.&nbsp;&#22768;&#26126;SimpleJdbcCall&#20351;&#29992;&#30340;&#21442;&#25968;</h3></div></div><div></div></div><p>&#20320;&#24050;&#32463;&#30475;&#21040;&#22914;&#20309;&#36890;&#36807;&#20803;&#25968;&#25454;&#26469;&#31616;&#21270;&#21442;&#25968;&#37197;&#32622;&#65292;&#20294;&#26159;&#20320;&#20063;&#21487;&#20197;&#26126;&#30830;&#22320;&#25351;&#23450;&#36825;&#20123;&#21442;&#25968;&#12290;&#21487;&#20197;&#22312;&#21019;&#24314;<tt class="classname">SimpleJdbcCall</tt>&#26102;&#65292;&#36890;&#36807;&#20351;&#29992;<tt class="classname">declareParameters</tt>&#26041;&#27861;&#26469;&#22768;&#26126;&#21442;&#25968;&#12290;
			&#36825;&#20010;&#26041;&#27861;&#25509;&#25910;&#19968;&#32452;<tt class="classname">SqlParameter</tt>&#23545;&#35937;&#20316;&#20026;&#21442;&#25968;&#12290;&#25105;&#20204;&#21487;&#20197;&#21442;&#29031;&#19979;&#19968;&#20010;&#31456;&#33410;&#65292;&#22914;&#20309;&#21019;&#24314;<tt class="classname">SqlParameter</tt>&#12290;
		</p><p>
		&#25105;&#20204;&#21487;&#20197;&#26377;&#36873;&#25321;&#24615;&#30340;&#26174;&#31034;&#22768;&#26126;&#19968;&#20010;&#12289;&#22810;&#20010;&#12289;&#29978;&#33267;&#25152;&#26377;&#30340;&#21442;&#25968;&#12290;&#21442;&#25968;&#20803;&#25968;&#25454;&#22312;&#36825;&#37324;&#20250;&#34987;&#21516;&#26102;&#20351;&#29992;&#12290;
			&#36890;&#36807;&#35843;&#29992;<tt class="classname">withoutProcedureColumnMetaDataAccess</tt>&#26041;&#27861;&#65292;&#25105;&#20204;&#21487;&#20197;&#25351;&#23450;&#25968;&#25454;&#24211;&#24573;&#30053;&#25152;&#26377;&#30340;&#20803;&#25968;&#25454;&#22788;&#29702;&#24182;&#20351;&#29992;&#26174;&#31034;&#22768;&#26126;&#30340;&#21442;&#25968;&#12290;
			&#21478;&#22806;&#19968;&#31181;&#24773;&#20917;&#26159;&#65292;&#20854;&#20013;&#30340;&#26576;&#20123;&#21442;&#25968;&#20540;&#20855;&#26377;&#40664;&#35748;&#30340;&#36820;&#22238;&#20540;&#65292;&#25105;&#20204;&#38656;&#35201;&#22312;&#36820;&#22238;&#20540;&#20013;&#25351;&#23450;&#36825;&#20123;&#36820;&#22238;&#20540;&#12290;&#20026;&#20102;&#23454;&#29616;&#36825;&#20010;&#29305;&#24615;&#65292;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;<tt class="classname">useInParameterNames</tt>&#26469;&#25351;&#23450;&#19968;&#32452;&#38656;&#35201;&#34987;&#21253;&#21547;&#30340;&#21442;&#25968;&#21517;&#31216;&#12290;
		</p><p>&#36825;&#26159;&#19968;&#20010;&#23436;&#25972;&#30340;&#22768;&#26126;&#23384;&#20648;&#36807;&#31243;&#35843;&#29992;&#30340;&#20363;&#23376;&#65306;</p><p>
      </p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private SimpleJdbcCall procReadActor;

    public void setDataSource(DataSource dataSource) {
        JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);
        jdbcTemplate.setResultsMapCaseInsensitive(true);
        this.procReadActor =
                new SimpleJdbcCall(jdbcTemplate)
                        .withProcedureName("read_actor")
                        .withoutProcedureColumnMetaDataAccess()
                        .useInParameterNames("in_id")
                        .declareParameters(
                                new SqlParameter("in_id", Types.NUMERIC),
                                new SqlOutParameter("out_first_name", Types.VARCHAR),
                                new SqlOutParameter("out_last_name", Types.VARCHAR),
                                new SqlOutParameter("out_birth_date", Types.DATE)
                        );
    }


    //  ... additional methods
}</pre><p>
      &#25191;&#34892;&#21644;&#26368;&#32456;&#30340;&#36820;&#22238;&#22788;&#29702;&#26159;&#30456;&#21516;&#30340;&#65292;&#25105;&#20204;&#22312;&#36825;&#37324;&#21482;&#26159;&#26126;&#30830;&#22768;&#26126;&#20102;&#21442;&#25968;&#31867;&#22411;&#65292;&#32780;&#19981;&#26159;&#20381;&#36182;&#25968;&#25454;&#24211;&#20803;&#25968;&#25454;&#29305;&#24615;&#12290;
      &#36825;&#19968;&#28857;&#24456;&#37325;&#35201;&#65292;&#23588;&#20854;&#23545;&#20110;&#37027;&#20123;&#25968;&#25454;&#24211;&#24182;&#19981;&#25903;&#25345;&#20803;&#25968;&#25454;&#30340;&#24773;&#20917;&#12290;&#24403;&#21069;&#65292;&#25105;&#20204;&#25903;&#25345;&#20803;&#25968;&#25454;&#30340;&#29305;&#24615;&#30340;&#25968;&#25454;&#21253;&#21547;&#65306;Apache Derby&#12289;DB2&#12289;MySQL&#12289;
      Microsoft SQL Server&#12289;Oracle&#21644;Sybase&#12290;&#25105;&#20204;&#21516;&#26102;&#23545;&#26576;&#20123;&#25968;&#25454;&#24211;&#20869;&#32622;&#20989;&#25968;&#25903;&#25345;&#20803;&#25968;&#25454;&#29305;&#24615;&#65306;MySQL&#12289;Microsoft SQL Server&#21644;Oracle&#12290;
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-params"></a>11.5.7.&nbsp;&#22914;&#20309;&#23450;&#20041;SqlParameters</h3></div></div><div></div></div><p>
		&#20026;SimpleJdbc&#31867;&#25110;&#32773;&#21518;&#32493;&#31456;&#33410;&#25552;&#21040;&#30340;RDBMS&#25805;&#20316;&#25351;&#23450;&#21442;&#25968;&#65292;&#20320;&#38656;&#35201;&#20351;&#29992;<tt class="classname">SqlParameter</tt>&#25110;&#32773;&#20182;&#30340;&#23376;&#31867;&#12290;
			&#20320;&#21487;&#20197;&#36890;&#36807;&#25351;&#23450;&#21442;&#25968;&#21517;&#31216;&#20197;&#21450;&#23545;&#24212;&#30340;SQL&#31867;&#22411;&#24182;&#20256;&#20837;&#26500;&#36896;&#20989;&#25968;&#20316;&#20026;&#21442;&#25968;&#26469;&#25351;&#23450;<tt class="classname">SqlParameter</tt>&#65292;&#20854;&#20013;&#65292;SQL&#31867;&#22411;&#26159;<tt class="classname">java.sql.Types</tt>&#20013;&#25152;&#23450;&#20041;&#30340;&#24120;&#37327;&#12290;
			&#25105;&#20204;&#24050;&#32463;&#30475;&#21040;&#36807;&#31867;&#20284;&#30340;&#22768;&#26126;&#65306;
		</p><p>
      </p><pre class="programlisting">   new SqlParameter("in_id", Types.NUMERIC),
   new SqlOutParameter("out_first_name", Types.VARCHAR),</pre><p>
   </p><p>&#31532;&#19968;&#34892;&#30340;<tt class="classname">SqlParameter</tt>&#23450;&#20041;&#20102;&#19968;&#20010;&#20256;&#20837;&#21442;&#25968;&#12290;&#20256;&#20837;&#21442;&#25968;&#21487;&#20197;&#22312;&#25152;&#26377;&#30340;&#23384;&#20648;&#36807;&#31243;&#20013;&#20351;&#29992;&#65292;&#20063;&#21487;&#20197;&#22312;&#31245;&#21518;&#31456;&#33410;&#20013;&#25552;&#21040;&#30340;<tt class="classname">SqlQuery</tt>&#31867;&#21450;&#20854;&#23376;&#31867;&#20013;&#20351;&#29992;&#12290;
		</p><p>&#31532;&#20108;&#34892;<tt class="classname">SqlOutParameter</tt>&#23450;&#20041;&#20102;&#19968;&#20010;&#36820;&#22238;&#20540;&#12290;&#23427;&#21487;&#20197;&#34987;&#23384;&#20648;&#36807;&#31243;&#35843;&#29992;&#25152;&#20351;&#29992;&#12290;&#24403;&#28982;&#65292;&#36824;&#26377;&#19968;&#20010;<tt class="classname">SqlInOutParameter</tt>&#31867;&#65292;&#21487;&#20197;&#29992;&#20110;&#36755;&#20837;&#36755;&#20986;&#21442;&#25968;&#12290;
			&#20063;&#23601;&#26159;&#35828;&#65292;&#23427;&#26082;&#26159;&#19968;&#20010;&#20256;&#20837;&#21442;&#25968;&#65292;&#20063;&#26159;&#19968;&#20010;&#36820;&#22238;&#20540;&#12290;
		</p><p>
      &#38500;&#20102;&#21442;&#25968;&#21517;&#31216;&#21644;SQL&#31867;&#22411;&#65292;&#20320;&#36824;&#21487;&#20197;&#22768;&#26126;&#19968;&#20123;&#20854;&#20182;&#39069;&#22806;&#30340;&#36873;&#39033;&#12290;&#23545;&#20110;&#20256;&#20837;&#21442;&#25968;&#65292;&#20320;&#21487;&#20197;&#20026;numeric&#25968;&#25454;&#31867;&#22411;&#25351;&#23450;&#31934;&#24230;&#65292;&#25110;&#32773;&#23545;&#20110;&#29305;&#23450;&#30340;&#25968;&#25454;&#24211;&#25351;&#23450;&#29305;&#27530;&#31867;&#22411;&#12290;
      &#23545;&#20110;&#36820;&#22238;&#20540;&#65292;&#20320;&#21487;&#20197;&#25552;&#20379;&#19968;&#20010;<tt class="classname">RowMapper</tt>&#25509;&#21475;&#26469;&#22788;&#29702;&#25152;&#26377;&#20174;REF cursor&#36820;&#22238;&#30340;&#21015;&#12290;&#21478;&#22806;&#19968;&#20010;&#36873;&#39033;&#26159;&#25351;&#23450;&#19968;&#20010;<tt class="classname">SqlReturnType</tt>&#31867;&#65292;&#20174;&#32780;&#21487;&#20197;&#23450;&#21046;&#36820;&#22238;&#20540;&#30340;&#22788;&#29702;&#26041;&#24335;&#12290;
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-simple-jdbc-call-3"></a>11.5.8.&nbsp;&#20351;&#29992;SimpleJdbcCall&#35843;&#29992;&#20869;&#32622;&#20989;&#25968;</h3></div></div><div></div></div><p>&#20869;&#32622;&#20989;&#25968;&#30340;&#35843;&#29992;&#20960;&#20046;&#21644;&#23384;&#20648;&#36807;&#31243;&#30340;&#35843;&#29992;&#26159;&#19968;&#26679;&#30340;&#12290;&#21807;&#19968;&#30340;&#19981;&#21516;&#22312;&#20110;&#65292;&#20320;&#38656;&#35201;&#22768;&#26126;&#30340;&#26159;&#19968;&#20010;&#20989;&#25968;&#30340;&#21517;&#31216;&#32780;&#19981;&#26159;&#23384;&#20648;&#36807;&#31243;&#30340;&#21517;&#31216;&#12290;
			&#36825;&#21487;&#20197;&#36890;&#36807;<tt class="classname">withFunctionName</tt>&#26041;&#27861;&#26469;&#23436;&#25104;&#12290;&#20351;&#29992;&#36825;&#20010;&#26041;&#27861;&#65292;&#34920;&#26126;&#20320;&#30340;&#35843;&#29992;&#26159;&#19968;&#20010;&#20989;&#25968;&#12290;&#20320;&#25152;&#25351;&#23450;&#30340;&#36825;&#20010;&#20989;&#25968;&#21517;&#31216;&#23558;&#34987;&#20316;&#20026;&#35843;&#29992;&#23545;&#35937;&#12290;
			&#21516;&#26102;&#26377;&#19968;&#20010;&#21483;&#20570;<tt class="classname">executeFunction</tt>&#30340;&#26041;&#27861;&#65292;&#23558;&#33719;&#24471;&#29305;&#23450;&#30340;Java&#31867;&#22411;&#30340;&#20989;&#25968;&#35843;&#29992;&#30340;&#36820;&#22238;&#20540;&#12290;
			&#27492;&#26102;&#65292;&#20320;&#26080;&#38656;&#36890;&#36807;&#36820;&#22238;&#30340;Map&#26469;&#33719;&#21462;&#36820;&#22238;&#20540;&#12290;&#21478;&#22806;&#26377;&#19968;&#20010;&#31867;&#20284;&#30340;&#20415;&#25463;&#26041;&#27861;<tt class="classname">executeObject</tt>&#29992;&#20110;&#23384;&#20648;&#36807;&#31243;&#65292;&#20294;&#26159;&#20182;&#21482;&#33021;&#22788;&#29702;&#21333;&#20010;&#36820;&#22238;&#20540;&#30340;&#24773;&#20917;&#12290;
			&#19979;&#38754;&#30340;&#31034;&#20363;&#23637;&#31034;&#20102;&#19968;&#20010;&#21483;&#20570;<tt class="classname">get_actor_name</tt>
&#30340;&#20989;&#25968;&#35843;&#29992;&#65292;&#36820;&#22238;actor&#30340;&#23436;&#25972;&#30340;&#21517;&#31216;&#12290;
			&#36825;&#20010;&#20989;&#25968;&#23558;&#24037;&#20316;&#22312;MySQL&#25968;&#25454;&#24211;&#19978;&#12290;
		</p><p>
      </p><pre class="programlisting">CREATE FUNCTION get_actor_name (in_id INTEGER)
RETURNS VARCHAR(200) READS SQL DATA 
BEGIN
  DECLARE out_name VARCHAR(200);
  SELECT concat(first_name, ' ', last_name)
    INTO out_name
    FROM t_actor where id = in_id;
  RETURN out_name;
END;</pre><p>
</p><p>&#35843;&#29992;&#36825;&#20010;&#20989;&#25968;&#65292;&#25105;&#20204;&#20381;&#28982;&#22312;&#21021;&#22987;&#21270;&#26041;&#27861;&#20013;&#21019;&#24314;<tt class="classname">SimpleJdbcCall</tt></p><p>
      </p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private SimpleJdbcTemplate simpleJdbcTemplate;
    private SimpleJdbcCall funcGetActorName;

    public void setDataSource(DataSource dataSource) {
        this.simpleJdbcTemplate = new SimpleJdbcTemplate(dataSource);
        JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);
        jdbcTemplate.setResultsMapCaseInsensitive(true);
        this.funcGetActorName =
                new SimpleJdbcCall(jdbcTemplate)
                        .withFunctionName("get_actor_name");
    }

    public String getActorName(Long id) {
        SqlParameterSource in = new MapSqlParameterSource()
                .addValue("in_id", id); 
        String name = funcGetActorName.executeFunction(String.class, in);
        return name;
    }

    //  ... additional methods
}</pre><p>
			&#34987;&#35843;&#29992;&#30340;&#20989;&#25968;&#36820;&#22238;&#19968;&#20010;<tt class="classname">String</tt>&#31867;&#22411;&#12290;
			</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-simple-jdbc-call-4"></a>11.5.9.&nbsp;&#20351;&#29992;SimpleJdbcCall&#36820;&#22238;&#30340;ResultSet/REF Cursor</h3></div></div><div></div></div><p>&#26399;&#26395;&#36890;&#36807;&#35843;&#29992;&#23384;&#20648;&#36807;&#31243;&#25110;&#32773;&#20989;&#25968;&#26469;&#36820;&#22238;ResultSet&#19968;&#30452;&#26159;&#19968;&#20010;&#38382;&#39064;&#12290;&#19968;&#20123;&#25968;&#25454;&#24211;&#22312;JDBC&#32467;&#26524;&#22788;&#29702;&#20013;&#36820;&#22238;&#32467;&#26524;&#38598;&#65292;&#32780;&#21478;&#22806;&#19968;&#20123;&#25968;&#25454;&#24211;&#21017;&#38656;&#35201;&#26126;&#30830;&#25351;&#23450;&#36820;&#22238;&#20540;&#30340;&#31867;&#22411;&#12290;
			&#26080;&#35770;&#21738;&#31181;&#26041;&#27861;&#65292;&#37117;&#38656;&#35201;&#22312;&#24490;&#29615;&#36941;&#21382;&#32467;&#26524;&#38598;&#26102;&#65292;&#20570;&#20986;&#19968;&#20123;&#39069;&#22806;&#30340;&#24037;&#20316;&#65292;&#20174;&#32780;&#22788;&#29702;&#27599;&#19968;&#26465;&#35760;&#24405;&#12290;
			&#36890;&#36807;<tt class="classname">SimpleJdbcCall</tt>&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<tt class="classname">returningResultSet</tt>&#26041;&#27861;&#65292;&#24182;&#23450;&#20041;&#19968;&#20010;<tt class="classname">RowMapper</tt>&#30340;&#23454;&#29616;&#31867;&#26469;&#22788;&#29702;&#29305;&#23450;&#30340;&#36820;&#22238;&#20540;&#12290; 
			&#24403;&#32467;&#26524;&#38598;&#22312;&#36820;&#22238;&#32467;&#26524;&#22788;&#29702;&#36807;&#31243;&#20013;&#27809;&#26377;&#34987;&#23450;&#20041;&#21517;&#31216;&#26102;&#65292;&#36820;&#22238;&#30340;&#32467;&#26524;&#38598;&#24517;&#39035;&#19982;&#23450;&#20041;&#30340;<tt class="classname">RowMapper</tt>&#30340;&#23454;&#29616;&#31867;&#25351;&#23450;&#30340;&#39034;&#24207;&#20445;&#25345;&#19968;&#33268;&#12290;
			&#32780;&#25351;&#23450;&#30340;&#21517;&#23383;&#20063;&#20250;&#34987;&#29992;&#20316;&#36820;&#22238;&#32467;&#26524;&#38598;&#20013;&#30340;&#21517;&#31216;&#12290;
		</p><p>&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#23558;&#20351;&#29992;&#19968;&#20010;&#23384;&#20648;&#36807;&#31243;&#65292;&#23427;&#24182;&#19981;&#25509;&#25910;&#20219;&#20309;&#21442;&#25968;&#65292;&#36820;&#22238;t_actor&#34920;&#20013;&#30340;&#25152;&#26377;&#30340;&#34892;&#65292;&#19979;&#38754;&#26159;MySQL&#25968;&#25454;&#24211;&#20013;&#30340;&#23384;&#20648;&#36807;&#31243;&#28304;&#30721;&#65306;
      </p><pre class="programlisting">CREATE PROCEDURE read_all_actors()
BEGIN
 SELECT a.id, a.first_name, a.last_name, a.birth_date FROM t_actor a;
END;</pre><p>
      &#35201;&#35843;&#29992;&#36825;&#20010;&#23384;&#20648;&#36807;&#31243;&#65292;&#25105;&#20204;&#38656;&#35201;&#23450;&#20041;&#19968;&#20010;<tt class="classname">RowMapper</tt>&#30340;&#23454;&#29616;&#31867;&#12290;&#25105;&#20204;&#25152;&#20351;&#29992;&#30340;&#31867;&#36981;&#24490;JavaBean&#30340;&#35268;&#33539;&#65292;&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;<tt class="classname">ParameterizedBeanPropertyRowMapper</tt>&#20316;&#20026;&#23454;&#29616;&#31867;&#12290;
      &#36890;&#36807;&#23558;&#30456;&#24212;&#30340;class&#31867;&#20316;&#20026;&#21442;&#25968;&#20256;&#20837;&#21040;newInstance&#26041;&#27861;&#20013;&#65292;&#25105;&#20204;&#21487;&#20197;&#21019;&#24314;&#36825;&#20010;&#23454;&#29616;&#31867;&#12290;
      </p><p>
      </p><pre class="programlisting">public class JdbcActorDao implements ActorDao {
    private SimpleJdbcTemplate simpleJdbcTemplate;
    private SimpleJdbcCall procReadAllActors;

    public void setDataSource(DataSource dataSource) {
        this.simpleJdbcTemplate = new SimpleJdbcTemplate(dataSource);
        JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);
        jdbcTemplate.setResultsMapCaseInsensitive(true);
        this.procReadAllActors =
                new SimpleJdbcCall(jdbcTemplate)
                        .withProcedureName("read_all_actors")
                        .returningResultSet("actors",
                                ParameterizedBeanPropertyRowMapper.newInstance(Actor.class));
    }

    public List getActorsList() {
        Map m = procReadAllActors.execute(new HashMap&lt;String, Object&gt;(0));
        return (List) m.get("actors");
    }

    //  ... additional methods
}</pre><p>
			&#36825;&#20010;&#20989;&#25968;&#35843;&#29992;&#20256;&#20837;&#19968;&#20010;&#31354;&#30340;Map&#36827;&#20837;&#65292;&#22240;&#20026;&#36825;&#37324;&#19981;&#38656;&#35201;&#20219;&#20309;&#30340;&#21442;&#25968;&#20256;&#20837;&#12290;&#32780;&#20989;&#25968;&#35843;&#29992;&#25152;&#36820;&#22238;&#30340;&#32467;&#26524;&#38598;&#23558;&#36820;&#22238;&#30340;&#26159;Actors&#21015;&#34920;&#12290;     
</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jdbc-object"></a>11.6.&nbsp;&#29992;Java&#23545;&#35937;&#26469;&#34920;&#36798;JDBC&#25805;&#20316;</h2></div></div><div></div></div><p>
			<tt class="literal">org.springframework.jdbc.object</tt>&#21253;&#19979;&#30340;&#31867;&#20801;&#35768;&#29992;&#25143;&#20197;&#26356;&#21152;
			&#38754;&#21521;&#23545;&#35937;&#30340;&#26041;&#24335;&#21435;&#35775;&#38382;&#25968;&#25454;&#24211;&#12290;&#27604;&#22914;&#35828;&#65292;&#29992;&#25143;&#21487;&#20197;&#25191;&#34892;&#26597;&#35810;&#24182;&#36820;&#22238;&#19968;&#20010;list&#65292;
			&#35813;list&#20316;&#20026;&#19968;&#20010;&#32467;&#26524;&#38598;&#23558;&#25226;&#20174;&#25968;&#25454;&#24211;&#20013;&#21462;&#20986;&#30340;&#21015;&#25968;&#25454;&#26144;&#23556;&#21040;&#19994;&#21153;&#23545;&#35937;&#30340;&#23646;&#24615;&#19978;&#12290;
			&#29992;&#25143;&#20063;&#21487;&#20197;&#25191;&#34892;&#23384;&#20648;&#36807;&#31243;&#65292;&#20197;&#21450;&#36816;&#34892;&#26356;&#26032;&#12289;&#21024;&#38500;&#20197;&#21450;&#25554;&#20837;SQL&#35821;&#21477;&#12290;
	</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
			&#22312;&#35768;&#22810;Spring&#24320;&#21457;&#20154;&#21592;&#20013;&#38388;&#23384;&#22312;&#26377;&#19968;&#31181;&#35266;&#28857;&#65292;&#37027;&#23601;&#26159;&#19979;&#38754;&#23558;&#35201;&#25552;&#21040;&#30340;&#21508;&#31181;RDBMS&#25805;&#20316;&#31867;
			&#65288;<a href="jdbc.html#jdbc-StoredProcedure" title="11.6.4.&nbsp;StoredProcedure&#31867;"><tt class="classname">StoredProcedure</tt></a>&#31867;&#38500;&#22806;&#65289;
			&#36890;&#24120;&#20063;&#21487;&#20197;&#30452;&#25509;&#20351;&#29992;<tt class="classname">JdbcTemplate</tt>&#30456;&#20851;&#30340;&#26041;&#27861;&#26469;&#26367;&#25442;&#12290;
			&#30456;&#23545;&#20110;&#25226;&#19968;&#20010;&#26597;&#35810;&#25805;&#20316;&#23553;&#35013;&#25104;&#19968;&#20010;&#31867;&#32780;&#35328;&#65292;&#30452;&#25509;&#35843;&#29992;<tt class="classname">JdbcTemplate</tt>&#26041;&#27861;&#23558;&#26356;&#31616;&#21333;&#32780;&#19988;&#26356;&#23481;&#26131;&#29702;&#35299;&#12290;
		</p><p>
			&#24517;&#39035;&#24378;&#35843;&#30340;&#19968;&#28857;&#26159;&#65292;&#36825;&#20165;&#20165;&#21482;&#26159;&#19968;&#31181;<span class="emphasis"><em>&#35266;&#28857;</em></span>&#32780;&#24050;&#65292;
			&#22914;&#26524;&#20320;&#35748;&#20026;&#20320;&#21487;&#20197;&#20174;&#30452;&#25509;&#20351;&#29992;RDBMS&#25805;&#20316;&#31867;&#20013;&#33719;&#21462;&#19968;&#20123;&#39069;&#22806;&#30340;&#22909;&#22788;&#65292;&#20320;&#19981;&#22952;&#26681;&#25454;&#33258;&#24049;&#30340;&#38656;&#35201;&#21644;&#21916;&#22909;&#36827;&#34892;&#19981;&#21516;&#30340;&#36873;&#25321;&#12290;
		</p></td></tr></table></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-SqlQuery"></a>11.6.1.&nbsp;<tt class="classname">SqlQuery</tt>&#31867;</h3></div></div><div></div></div><p>
			<tt class="classname">SqlQuery</tt>&#26159;&#19968;&#20010;&#21487;&#37325;&#29992;&#12289;&#32447;&#31243;&#23433;&#20840;&#30340;&#31867;&#65292;&#23427;&#23553;&#35013;&#20102;&#19968;&#20010;SQL&#26597;&#35810;&#12290;
			&#20854;&#23376;&#31867;&#24517;&#39035;&#23454;&#29616;<tt class="literal">newResultReader()</tt>&#26041;&#27861;&#65292;&#35813;&#26041;&#27861;&#29992;&#26469;&#22312;&#36941;&#21382;
			<tt class="interfacename">ResultSet</tt>&#30340;&#26102;&#20505;&#33021;&#20351;&#29992;&#19968;&#20010;&#31867;&#26469;&#20445;&#23384;&#32467;&#26524;&#12290;
			&#25105;&#20204;&#24456;&#23569;&#38656;&#35201;&#30452;&#25509;&#20351;&#29992;<tt class="classname">SqlQuery</tt>&#65292;&#22240;&#20026;&#20854;&#23376;&#31867;
			<tt class="classname">MappingSqlQuery</tt>&#20316;&#20026;&#19968;&#20010;&#26356;&#21152;&#26131;&#29992;&#30340;&#23454;&#29616;&#33021;&#22815;&#23558;&#32467;&#26524;&#38598;&#20013;&#30340;&#34892;&#26144;&#23556;&#20026;Java&#23545;&#35937;&#12290;
			<tt class="classname">SqlQuery</tt>&#36824;&#26377;&#21478;&#22806;&#20004;&#20010;&#25193;&#23637;&#20998;&#21035;&#26159;
			<tt class="classname">MappingSqlQueryWithParameters</tt>&#21644;<tt class="classname">UpdatableSqlQuery</tt>&#12290;
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-MappingSqlQuery"></a>11.6.2.&nbsp;<tt class="classname">MappingSqlQuery</tt>&#31867;</h3></div></div><div></div></div><p>
			<tt class="classname">MappingSqlQuery</tt>&#26159;&#19968;&#20010;&#21487;&#37325;&#29992;&#30340;&#26597;&#35810;&#25277;&#35937;&#31867;&#65292;&#20854;&#20855;&#20307;&#31867;&#24517;&#39035;&#23454;&#29616;
			<tt class="literal">mapRow(ResultSet, int)</tt>&#25277;&#35937;&#26041;&#27861;&#26469;&#23558;&#32467;&#26524;&#38598;&#20013;&#30340;&#27599;&#19968;&#34892;&#36716;&#25442;&#25104;Java&#23545;&#35937;&#12290;
			&#19979;&#38754;&#36825;&#20010;&#20363;&#23376;&#28436;&#31034;&#20102;&#19968;&#20010;&#23450;&#21046;&#26597;&#35810;&#65292;&#23427;&#23558;&#20174;&#23458;&#25143;&#34920;&#20013;&#21462;&#24471;&#30340;&#25968;&#25454;&#26144;&#23556;&#21040;&#19968;&#20010;<tt class="classname">Customer</tt>&#31867;&#23454;&#20363;&#12290;
	</p><pre class="programlisting">private class CustomerMappingQuery extends MappingSqlQuery {

    public CustomerMappingQuery(DataSource ds) {
        super(ds, "SELECT id, name FROM customer WHERE id = ?");
        super.declareParameter(new SqlParameter("id", Types.INTEGER));
        compile();
    }

    public Object mapRow(ResultSet rs, int rowNumber) throws SQLException {
        Customer cust = new Customer();
        cust.setId((Integer) rs.getObject("id"));
        cust.setName(rs.getString("name"));
        return cust;
    } 
}</pre><p>
			&#22312;&#19978;&#38754;&#30340;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#20026;&#29992;&#25143;&#26597;&#35810;&#25552;&#20379;&#20102;&#19968;&#20010;&#26500;&#36896;&#20989;&#25968;&#24182;&#20026;&#26500;&#36896;&#20989;&#25968;&#20256;&#36882;&#20102;&#19968;&#20010;
			<tt class="interfacename">DataSource</tt>&#21442;&#25968;&#12290;&#22312;&#26500;&#36896;&#20989;&#25968;&#37324;&#38754;&#25105;&#20204;&#25226;
			<tt class="interfacename">DataSource</tt>&#21644;&#19968;&#20010;&#29992;&#26469;&#36820;&#22238;&#26597;&#35810;&#32467;&#26524;&#30340;SQL&#35821;&#21477;&#20316;&#20026;&#21442;&#25968;
			&#35843;&#29992;&#29238;&#31867;&#30340;&#26500;&#36896;&#20989;&#25968;&#12290;SQL&#35821;&#21477;&#23558;&#34987;&#29992;&#20110;&#29983;&#25104;&#19968;&#20010;<tt class="interfacename">PreparedStatement</tt>&#23545;&#35937;&#65292;
			&#22240;&#27492;&#23427;&#21487;&#20197;&#21253;&#21547;&#21344;&#20301;&#31526;&#26469;&#20256;&#36882;&#21442;&#25968;&#12290;&#32780;&#27599;&#19968;&#20010;SQL&#35821;&#21477;&#30340;&#21442;&#25968;&#24517;&#39035;&#36890;&#36807;&#35843;&#29992;
			<tt class="literal">declareParameter</tt>&#26041;&#27861;&#26469;&#36827;&#34892;&#22768;&#26126;&#65292;&#35813;&#26041;&#27861;&#38656;&#35201;&#19968;&#20010;
			<tt class="classname">SqlParameter</tt>&#65288;&#23553;&#35013;&#20102;&#19968;&#20010;&#23383;&#27573;&#21517;&#23383;&#21644;&#19968;&#20010;
			<tt class="classname">java.sql.Types</tt>&#20013;&#23450;&#20041;&#30340;JDBC&#31867;&#22411;&#65289;&#23545;&#35937;&#20316;&#20026;&#21442;&#25968;&#12290;
			&#25152;&#26377;&#21442;&#25968;&#23450;&#20041;&#23436;&#20043;&#21518;&#65292;&#25105;&#20204;&#35843;&#29992;<tt class="literal">compile()</tt>&#26041;&#27861;&#26469;&#23545;SQL&#35821;&#21477;&#36827;&#34892;&#39044;&#32534;&#35793;&#12290;
		</p><pre class="programlisting">public Customer getCustomer(Integer id) {
    CustomerMappingQuery custQry = new CustomerMappingQuery(dataSource); 
    Object[] parms = new Object[1];
    parms[0] = id;
    List customers = custQry.execute(parms);
    if (customers.size() &gt; 0) {
        return (Customer) customers.get(0);
    }
    else {
        return null;
    }
}</pre><p>
			&#22312;&#19978;&#38754;&#30340;&#20363;&#23376;&#20013;&#65292;getCustomer&#26041;&#27861;&#36890;&#36807;&#20256;&#36882;&#24799;&#19968;&#21442;&#25968;id&#26469;&#36820;&#22238;&#19968;&#20010;&#23458;&#25143;&#23545;&#35937;&#12290;
			&#35813;&#26041;&#27861;&#20869;&#37096;&#22312;&#21019;&#24314;<tt class="classname">CustomerMappingQuery</tt>&#23454;&#20363;&#20043;&#21518;&#65292;
			&#25105;&#20204;&#21019;&#24314;&#20102;&#19968;&#20010;&#23545;&#35937;&#25968;&#32452;&#29992;&#26469;&#21253;&#21547;&#35201;&#20256;&#36882;&#30340;&#26597;&#35810;&#21442;&#25968;&#12290;&#36825;&#37324;&#25105;&#20204;&#21482;&#26377;&#21807;&#19968;&#30340;&#19968;&#20010;
			<tt class="classname">Integer</tt>&#21442;&#25968;&#12290;&#25191;&#34892;<tt class="classname">CustomerMappingQuery</tt>&#30340;
			execute&#26041;&#27861;&#20043;&#21518;&#65292;&#25105;&#20204;&#24471;&#21040;&#20102;&#19968;&#20010;<tt class="literal">List</tt>&#65292;&#35813;List&#20013;&#21253;&#21547;&#19968;&#20010;
			<tt class="classname">Customer</tt>&#23545;&#35937;&#65292;&#22914;&#26524;&#26377;&#23545;&#35937;&#28385;&#36275;&#26597;&#35810;&#26465;&#20214;&#30340;&#35805;&#12290;
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-SqlUpdate"></a>11.6.3.&nbsp;<tt class="classname">SqlUpdate</tt>&#31867;</h3></div></div><div></div></div><p>
			<tt class="classname">SqlUpdate</tt>&#31867;&#23553;&#35013;&#20102;&#19968;&#20010;&#21487;&#37325;&#22797;&#20351;&#29992;&#30340;SQL&#26356;&#26032;&#25805;&#20316;&#12290;
			&#36319;&#25152;&#26377;<tt class="classname">RdbmsOperation</tt>&#31867;&#19968;&#26679;&#65292;SqlUpdate&#21487;&#20197;&#22312;SQL&#20013;&#23450;&#20041;&#21442;&#25968;&#12290;
			&#35813;&#31867;&#25552;&#20379;&#20102;&#19968;&#31995;&#21015;<tt class="literal">update()</tt>&#26041;&#27861;&#65292;&#23601;&#20687;SqlQuery&#25552;&#20379;&#30340;&#19968;&#31995;&#21015;<tt class="literal">execute()</tt>&#26041;&#27861;&#19968;&#26679;&#12290; 
			<tt class="classname">SqlUpdate</tt>&#26159;&#19968;&#20010;&#20855;&#20307;&#30340;&#31867;&#12290;&#36890;&#36807;&#22312;SQL&#35821;&#21477;&#20013;&#23450;&#20041;&#21442;&#25968;&#65292;&#36825;&#20010;&#31867;&#21487;&#20197;&#25903;&#25345;&#19981;&#21516;&#30340;&#26356;&#26032;&#26041;&#27861;&#65292;&#25105;&#20204;&#19968;&#33324;&#19981;&#38656;&#35201;&#36890;&#36807;&#32487;&#25215;&#26469;&#23454;&#29616;&#23450;&#21046;&#12290;
		</p><pre class="programlisting">import java.sql.Types;

import javax.sql.DataSource;

import org.springframework.jdbc.core.SqlParameter;
import org.springframework.jdbc.object.SqlUpdate;

public class UpdateCreditRating extends SqlUpdate {

    public UpdateCreditRating(DataSource ds) {
        setDataSource(ds);
        setSql("update customer set credit_rating = ? where id = ?");
        declareParameter(new SqlParameter(Types.NUMERIC));
        declareParameter(new SqlParameter(Types.NUMERIC));
        compile();
    }

    <i class="lineannotation"><span class="lineannotation">/**
     * @param id for the Customer to be updated
     * @param rating the new value for credit rating
     * @return number of rows updated
     */</span></i>
    public int run(int id, int rating) {
        Object[] params =
            new Object[] {
                new Integer(rating),
                new Integer(id)};
        return update(params);
    }
}</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-StoredProcedure"></a>11.6.4.&nbsp;<tt class="classname">StoredProcedure</tt>&#31867;</h3></div></div><div></div></div><p>
			<tt class="classname">StoredProcedure</tt>&#31867;&#26159;&#19968;&#20010;&#25277;&#35937;&#22522;&#31867;&#65292;&#23427;&#26159;&#23545;RDBMS&#23384;&#20648;&#36807;&#31243;&#30340;&#19968;&#31181;&#25277;&#35937;&#12290;
			&#35813;&#31867;&#25552;&#20379;&#20102;&#22810;&#31181;<tt class="literal">execute(..)</tt>&#26041;&#27861;&#65292;&#19981;&#36807;&#36825;&#20123;&#26041;&#27861;&#30340;&#35775;&#38382;&#31867;&#22411;&#37117;&#26159;<tt class="literal">protected</tt>&#30340;&#12290;
		</p><p>
			&#20174;&#29238;&#31867;&#32487;&#25215;&#30340;<tt class="literal">sql</tt>&#23646;&#24615;&#29992;&#26469;&#25351;&#23450;RDBMS&#23384;&#20648;&#36807;&#31243;&#30340;&#21517;&#23383;&#12290;
			&#23613;&#31649;&#35813;&#31867;&#25552;&#20379;&#20102;&#35768;&#22810;&#24517;&#39035;&#22312;JDBC3.0&#19979;&#20351;&#29992;&#30340;&#21151;&#33021;&#65292;&#20294;&#26159;&#25105;&#20204;&#26356;&#20851;&#27880;&#30340;&#26159;JDBC 3.0&#20013;&#24341;&#20837;&#30340;&#21629;&#21517;&#21442;&#25968;&#29305;&#24615;&#12290;
		</p><p>
			&#19979;&#38754;&#30340;&#31243;&#24207;&#28436;&#31034;&#20102;&#22914;&#20309;&#35843;&#29992;Oracle&#20013;&#30340;<tt class="literal">sysdate()</tt>&#20989;&#25968;&#12290;
			&#36825;&#37324;&#25105;&#20204;&#21019;&#24314;&#20102;&#19968;&#20010;&#32487;&#25215;<tt class="classname">StoredProcedure</tt>&#30340;&#23376;&#31867;&#65292;&#34429;&#28982;&#23427;&#27809;&#26377;&#36755;&#20837;&#21442;&#25968;&#65292;
			&#20294;&#26159;&#25105;&#24517;&#39035;&#36890;&#36807;&#20351;&#29992;<tt class="classname">SqlOutParameter</tt>&#26469;&#22768;&#26126;&#19968;&#20010;&#26085;&#26399;&#31867;&#22411;&#30340;&#36755;&#20986;&#21442;&#25968;&#12290;
			<tt class="literal">execute()</tt>&#26041;&#27861;&#23558;&#36820;&#22238;&#19968;&#20010;map&#65292;map&#20013;&#30340;&#27599;&#20010;entry&#26159;&#19968;&#20010;&#29992;&#21442;&#25968;&#21517;&#20316;key&#65292;&#20197;&#36755;&#20986;&#21442;&#25968;&#20026;value&#30340;&#21517;&#20540;&#23545;&#12290;
		</p><pre class="programlisting">
import java.sql.Types;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;

import javax.sql.DataSource;

import org.springframework.jdbc.core.SqlOutParameter;
import org.springframework.jdbc.datasource.*;
import org.springframework.jdbc.object.StoredProcedure;

public class TestStoredProcedure {

    public static void main(String[] args)  {
        TestStoredProcedure t = new TestStoredProcedure();
        t.test();
        System.out.println("Done!");
    }
    
    void test() {
        DriverManagerDataSource ds = new DriverManagerDataSource();
        ds.setDriverClassName("oracle.jdbc.OracleDriver");
        ds.setUrl("jdbc:oracle:thin:@localhost:1521:mydb");
        ds.setUsername("scott");
        ds.setPassword("tiger");

        MyStoredProcedure sproc = new MyStoredProcedure(ds);
        Map results = sproc.execute();
        printMap(results);
    }

    private class MyStoredProcedure extends StoredProcedure {
        
        private static final String SQL = "sysdate";

        public MyStoredProcedure(DataSource ds) {
            setDataSource(ds);
            setFunction(true);
            setSql(SQL);
            declareParameter(new SqlOutParameter("date", Types.DATE));
            compile();
        }

        public Map execute() {
            <i class="lineannotation"><span class="lineannotation">// the 'sysdate' sproc has no input parameters, so an empty Map is supplied...</span></i>
            return execute(new HashMap());
        }
    }

    private static void printMap(Map results) {
        for (Iterator it = results.entrySet().iterator(); it.hasNext(); ) {
            System.out.println(it.next());  
        }
    }
}</pre><p>
			&#19979;&#38754;&#26159;<tt class="classname">StoredProcedure</tt>&#30340;&#21478;&#19968;&#20010;&#20363;&#23376;&#65292;&#23427;&#20351;&#29992;&#20102;&#20004;&#20010;Oracle&#28216;&#26631;&#31867;&#22411;&#30340;&#36755;&#20986;&#21442;&#25968;&#12290;
		</p><pre class="programlisting">import oracle.jdbc.driver.OracleTypes;
import org.springframework.jdbc.core.SqlOutParameter;
import org.springframework.jdbc.object.StoredProcedure;

import javax.sql.DataSource;
import java.util.HashMap;
import java.util.Map;

public class TitlesAndGenresStoredProcedure extends StoredProcedure {

    private static final String SPROC_NAME = "AllTitlesAndGenres";

    public TitlesAndGenresStoredProcedure(DataSource dataSource) {
        super(dataSource, SPROC_NAME);
        declareParameter(new SqlOutParameter("titles", OracleTypes.CURSOR, new TitleMapper()));
        declareParameter(new SqlOutParameter("genres", OracleTypes.CURSOR, new GenreMapper()));
        compile();
    }

    public Map execute() {
        <i class="lineannotation"><span class="lineannotation">// again, this sproc has no input parameters, so an empty Map is supplied...</span></i>
        return super.execute(new HashMap());
    }
}</pre><p>
			&#20540;&#24471;&#27880;&#24847;&#30340;&#26159;<tt class="classname">TitlesAndGenresStoredProcedure</tt>&#26500;&#36896;&#20989;&#25968;&#20013;
			<tt class="literal">declareParameter(..)</tt>&#30340;<tt class="classname">SqlOutParameter</tt>&#21442;&#25968;&#65292;
			&#35813;&#21442;&#25968;&#20351;&#29992;&#20102;<tt class="interfacename">RowMapper</tt>&#25509;&#21475;&#30340;&#23454;&#29616;&#12290;&#36825;&#26159;&#19968;&#31181;&#38750;&#24120;&#26041;&#20415;&#32780;&#24378;&#22823;&#30340;&#37325;&#29992;&#26041;&#24335;&#12290;
			&#19979;&#38754;&#25105;&#20204;&#26469;&#30475;&#19968;&#19979;<tt class="interfacename">RowMapper</tt>&#30340;&#20004;&#20010;&#20855;&#20307;&#23454;&#29616;&#12290;
		</p><p>
			&#39318;&#20808;&#26159;<tt class="classname">TitleMapper</tt>&#31867;&#65292;&#23427;&#31616;&#21333;&#30340;&#25226;<tt class="interfacename">ResultSet</tt>&#20013;&#30340;&#27599;&#19968;&#34892;&#26144;&#23556;&#20026;&#19968;&#20010;<tt class="classname">Title</tt>Domain Object&#12290;
		</p><pre class="programlisting">import com.foo.sprocs.domain.Title;
import org.springframework.jdbc.core.RowMapper;

import java.sql.ResultSet;
import java.sql.SQLException;

public final class TitleMapper implements RowMapper {
    
    public Object mapRow(ResultSet rs, int rowNum) throws SQLException {
        Title title = new Title();
        title.setId(rs.getLong("id"));
        title.setName(rs.getString("name"));
        return title;
    }
}</pre><p>
			&#21478;&#19968;&#20010;&#26159;<tt class="classname">GenreMapper</tt>&#31867;&#65292;&#20063;&#26159;&#38750;&#24120;&#31616;&#21333;&#30340;&#23558;<tt class="interfacename">ResultSet</tt>&#20013;&#30340;&#27599;&#19968;&#34892;&#26144;&#23556;&#20026;&#19968;&#20010;<tt class="classname">Genre</tt>Domain Object&#12290;
		</p><pre class="programlisting">import org.springframework.jdbc.core.RowMapper;

import java.sql.ResultSet;
import java.sql.SQLException;

import com.foo.domain.Genre;

public final class GenreMapper implements RowMapper {
    
    public Object mapRow(ResultSet rs, int rowNum) throws SQLException {
        return new Genre(rs.getString("name"));
    }
}</pre><p>
			&#22914;&#26524;&#20320;&#38656;&#35201;&#32473;&#23384;&#20648;&#36807;&#31243;&#20256;&#36755;&#20837;&#21442;&#25968;&#65288;&#36825;&#20123;&#36755;&#20837;&#21442;&#25968;&#26159;&#22312;RDBMS&#23384;&#20648;&#36807;&#31243;&#20013;&#23450;&#20041;&#22909;&#20102;&#30340;&#65289;&#65292;
			&#21017;&#38656;&#35201;&#25552;&#20379;&#19968;&#20010;&#25351;&#23450;&#31867;&#22411;&#30340;<tt class="literal">execute(..)</tt>&#26041;&#27861;&#65292;
			&#35813;&#26041;&#27861;&#23558;&#35843;&#29992;&#22522;&#31867;&#30340;<tt class="literal">protected</tt> <tt class="literal">execute(Map parameters)</tt>&#26041;&#27861;&#12290;&#20363;&#22914;&#65306;
		</p><pre class="programlisting">import oracle.jdbc.driver.OracleTypes;
import org.springframework.jdbc.core.SqlOutParameter;
import org.springframework.jdbc.object.StoredProcedure;

import javax.sql.DataSource;
import java.util.HashMap;
import java.util.Map;

public class TitlesAfterDateStoredProcedure extends StoredProcedure {

    private static final String SPROC_NAME = "TitlesAfterDate";
    private static final String CUTOFF_DATE_PARAM = "cutoffDate";

    public TitlesAfterDateStoredProcedure(DataSource dataSource) {
        super(dataSource, SPROC_NAME);
        declareParameter(new SqlParameter(CUTOFF_DATE_PARAM, Types.DATE);
        declareParameter(new SqlOutParameter("titles", OracleTypes.CURSOR, new TitleMapper()));
        compile();
    }

    public Map execute(Date cutoffDate) {
        Map inputs = new HashMap();
        inputs.put(CUTOFF_DATE_PARAM, cutoffDate);
        return super.execute(inputs);
    }
}</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-SqlFunction"></a>11.6.5.&nbsp;<tt class="classname">SqlFunction</tt>&#31867;</h3></div></div><div></div></div><p>
			<tt class="classname">SqlFunction</tt> RDBMS&#25805;&#20316;&#31867;&#23553;&#35013;&#20102;&#19968;&#20010;SQL&#8220;&#20989;&#25968;&#8221;&#21253;&#35013;&#22120;&#65288;wrapper&#65289;&#65292;
			&#35813;&#21253;&#35013;&#22120;&#36866;&#29992;&#20110;&#26597;&#35810;&#24182;&#36820;&#22238;&#19968;&#20010;&#21333;&#34892;&#32467;&#26524;&#38598;&#12290;&#40664;&#35748;&#36820;&#22238;&#30340;&#26159;&#19968;&#20010;<tt class="literal">int</tt>&#20540;&#65292;
			&#19981;&#36807;&#25105;&#20204;&#21487;&#20197;&#37319;&#29992;&#31867;&#20284;<tt class="classname">JdbcTemplate</tt>&#20013;&#30340;<tt class="literal">queryForXxx</tt>
			&#20570;&#27861;&#33258;&#24049;&#23454;&#29616;&#26469;&#36820;&#22238;&#20854;&#23427;&#31867;&#22411;&#12290;<tt class="classname">SqlFunction</tt>&#20248;&#21183;&#22312;&#20110;&#25105;&#20204;&#19981;&#24517;&#21019;&#24314;
			<tt class="classname">JdbcTemplate</tt>&#65292;&#36825;&#20123;&#23427;&#37117;&#22312;&#20869;&#37096;&#26367;&#25105;&#20204;&#20570;&#20102;&#12290;
		</p><p>
			&#35813;&#31867;&#30340;&#20027;&#35201;&#29992;&#36884;&#26159;&#35843;&#29992;SQL&#20989;&#25968;&#26469;&#36820;&#22238;&#19968;&#20010;&#21333;&#20540;&#30340;&#32467;&#26524;&#38598;&#65292;&#27604;&#22914;&#31867;&#20284;&#8220;select user()&#8221;&#12289;
			&#8220;select sysdate from dual&#8221;&#30340;&#26597;&#35810;&#12290;&#22914;&#26524;&#38656;&#35201;&#35843;&#29992;&#26356;&#22797;&#26434;&#30340;&#23384;&#20648;&#20989;&#25968;&#65292;
			&#65288;&#21487;&#20197;&#20026;&#36825;&#31181;&#31867;&#22411;&#30340;&#22788;&#29702;&#20351;&#29992;<tt class="classname">StoredProcedure</tt>&#25110;<tt class="classname">SqlCall&#65289;</tt>&#12290;
		</p><p>
			<tt class="classname">SqlFunction</tt>&#26159;&#19968;&#20010;&#20855;&#20307;&#31867;&#65292;&#36890;&#24120;&#25105;&#20204;&#19981;&#38656;&#35201;&#23427;&#30340;&#23376;&#31867;&#12290;
			&#20854;&#29992;&#27861;&#26159;&#21019;&#24314;&#35813;&#31867;&#30340;&#23454;&#20363;&#65292;&#28982;&#21518;&#22768;&#26126;SQL&#35821;&#21477;&#20197;&#21450;&#21442;&#25968;&#23601;&#21487;&#20197;&#35843;&#29992;&#30456;&#20851;&#30340;run&#26041;&#27861;&#21435;&#22810;&#27425;&#25191;&#34892;&#20989;&#25968;&#12290;
			&#19979;&#38754;&#30340;&#20363;&#23376;&#29992;&#26469;&#36820;&#22238;&#25351;&#23450;&#34920;&#30340;&#35760;&#24405;&#34892;&#25968;&#65306;
		</p><pre class="programlisting">public int countRows() {
    SqlFunction sf = new SqlFunction(dataSource, "select count(*) from mytable");
    sf.compile();
    return sf.run();
}</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jdbc-parameter-handling"></a>11.7.&nbsp;&#21442;&#25968;&#21644;&#25968;&#25454;&#22788;&#29702;&#30340;&#22522;&#26412;&#21407;&#21017;</h2></div></div><div></div></div><p>&#22312;Spring&#30340;JDBC&#26694;&#26550;&#30340;&#25152;&#26377;&#24037;&#20316;&#27169;&#24335;&#20013;&#36143;&#24443;&#20102;&#19968;&#20123;&#19982;&#21442;&#25968;&#21644;&#25968;&#25454;&#22788;&#29702;&#30456;&#20851;&#30340;&#22522;&#26412;&#21407;&#21017;&#12290;</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-type-information"></a>11.7.1.&nbsp;&#20026;&#21442;&#25968;&#35774;&#32622;SQL&#31867;&#22411;&#20449;&#24687;</h3></div></div><div></div></div><p>&#22810;&#25968;&#24773;&#20917;&#19979;&#65292;Spring&#20250;&#26681;&#25454;&#20256;&#20837;&#30340;&#21442;&#25968;&#20540;&#26469;&#35774;&#23450;&#30456;&#24212;&#30340;SQL&#31867;&#22411;&#12290;&#26377;&#26102;&#65292;&#25105;&#20204;&#26377;&#24517;&#35201;&#26126;&#30830;&#25351;&#23450;&#20256;&#20837;&#21442;&#25968;&#25152;&#20195;&#34920;&#30340;SQL&#31867;&#22411;&#65292;&#36825;&#19968;&#28857;&#23545;&#20110;&#27491;&#30830;&#35774;&#32622;NULL&#20540;&#30340;&#26102;&#20505;&#21487;&#33021;&#27604;&#36739;&#26377;&#29992;&#12290;</p><p>&#21478;&#22806;&#36824;&#26377;&#19968;&#20123;&#20854;&#20182;&#30340;&#19981;&#21516;&#26041;&#38754;&#30340;&#20316;&#29992;:</p><div class="itemizedlist"><ul type="disc"><li><p>&#22810;&#25968;<tt class="classname">JdbcTemplate</tt>&#30340;update&#25110;&#32773;query&#26041;&#27861;&#20250;&#25509;&#25910;&#19968;&#20010;&#39069;&#22806;&#30340;int&#25968;&#32452;&#26500;&#25104;&#30340;&#21442;&#25968;&#12290;
          &#36825;&#20010;&#25968;&#32452;&#38656;&#35201;&#25552;&#20379;&#30340;&#26159;&#20351;&#29992;<tt class="classname">java.sql.Types</tt>&#20013;&#25152;&#23450;&#20041;&#30340;SQL&#31867;&#22411;&#12290;&#32780;&#36825;&#20010;&#25968;&#32452;&#20013;&#23450;&#20041;&#30340;&#31867;&#22411;&#38656;&#35201;&#19982;&#27599;&#20010;&#20256;&#20837;&#30340;&#21442;&#25968;&#25152;&#23545;&#24212;&#12290;
          </p></li></ul></div><div class="itemizedlist"><ul type="disc"><li><p>&#20320;&#21487;&#20197;&#20351;&#29992;<tt class="classname">SqlParameterValue</tt>&#23545;&#21442;&#25968;&#36827;&#34892;&#39069;&#22806;&#30340;&#23553;&#35013;&#20174;&#32780;&#21253;&#35013;&#26356;&#22810;&#30340;&#21442;&#25968;&#20449;&#24687;&#12290;&#36890;&#36807;&#20256;&#20837;&#21442;&#25968;&#20540;&#21644;&#23545;&#24212;&#30340;SQL&#31867;&#22411;&#20316;&#20026;&#26500;&#36896;&#20989;&#25968;&#30340;&#21442;&#25968;&#65292;&#20320;&#21487;&#20197;&#21019;&#24314;&#36825;&#20010;&#31867;&#30340;&#19968;&#20010;&#23454;&#20363;&#12290;
          &#20320;&#20063;&#21487;&#20197;&#20026;numeric&#30340;&#20540;&#25552;&#20379;&#19968;&#20123;&#39069;&#22806;&#30340;&#31934;&#24230;&#35201;&#27714;&#12290;
          </p></li></ul></div><div class="itemizedlist"><ul type="disc"><li><p>&#23545;&#20110;&#37027;&#20123;&#20351;&#29992;&#21629;&#21517;&#21442;&#25968;&#30340;&#24773;&#20917;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<tt class="classname">SqlParameterSource</tt>&#12289;<tt class="classname">BeanPropertySqlParameterSource</tt>&#25110;&#32773;<tt class="classname">MapSqlParameterSource</tt>&#31867;&#12290;
         &#20182;&#20204;&#37117;&#20855;&#22791;&#20102;&#20026;&#21629;&#21517;&#21442;&#25968;&#27880;&#20876;SQL&#31867;&#22411;&#30340;&#21151;&#33021;&#12290;
         </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-lob"></a>11.7.2.&nbsp;&#22788;&#29702;BLOB &#21644; CLOB&#23545;&#35937;</h3></div></div><div></div></div><p>&#20320;&#21487;&#20197;&#22312;&#25968;&#25454;&#24211;&#20013;&#23384;&#20648;&#22270;&#20687;&#12289;&#20108;&#36827;&#21046;&#23545;&#35937;&#25110;&#32773;&#22823;&#25991;&#26412;&#31561;&#23545;&#35937;&#12290;&#36825;&#20123;&#36739;&#22823;&#30340;&#20108;&#36827;&#21046;&#23545;&#35937;&#34987;&#31216;&#20043;&#20026;BLOB&#31867;&#22411;&#65292;&#32780;&#23545;&#24212;&#30340;&#22823;&#25991;&#26412;&#23545;&#35937;&#34987;&#31216;&#20043;&#20026;CLOB&#23545;&#35937;&#12290;
			Spring&#20801;&#35768;&#20320;&#20351;&#29992;JdbcTemplate&#12289;&#26356;&#39640;&#23618;&#27425;&#23553;&#35013;&#30340;RDBMS&#23545;&#35937;&#21644;SimpleJdbc&#31867;&#23545;&#36825;&#20123;&#22823;&#23545;&#35937;&#36827;&#34892;&#25805;&#20316;&#12290; &#25152;&#26377;&#30340;&#36825;&#20123;&#25805;&#20316;&#26041;&#24335;&#37117;&#23454;&#29616;&#20102;<tt class="classname">LobHandler</tt>&#25509;&#21475;&#26469;&#22788;&#29702;LOB&#31867;&#22411;&#30340;&#25968;&#25454;&#12290;
			<tt class="classname">LobHandler</tt>&#25509;&#21475;&#25552;&#20379;&#20102;&#35775;&#38382;<tt class="classname">LobCreator</tt>&#30340;&#26041;&#27861;&#65292;&#36890;&#36807;&#35843;&#29992;<tt class="classname">getLobCreator</tt>&#65292;&#20320;&#21487;&#20197;&#21019;&#24314;&#19968;&#20010;&#26032;&#30340;LOB&#31867;&#22411;&#30340;&#25968;&#25454;&#12290;
		</p><p><tt class="classname">LobCreator/LobHandler</tt>&#25509;&#21475;&#38024;&#23545;LOB&#31867;&#22411;&#30340;&#25968;&#25454;&#25805;&#20316;&#25552;&#20379;&#20102;&#19979;&#21015;&#25903;&#25345;&#65306;</p><p>
      </p><div class="itemizedlist"><ul type="disc"><li><p>BLOB</p><div class="itemizedlist"><ul type="circle"><li><p>byte[] &#8211; getBlobAsBytes and setBlobAsBytes</p><p>byte[] &#8211; getBlobAsBytes &#21644; setBlobAsBytes</p></li><li><p>InputStream &#8211; getBlobAsBinaryStream and
                setBlobAsBinaryStream</p><p>InputStream &#8211; getBlobAsBinaryStream&#21644;setBlobAsBinaryStream</p></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="disc"><li><p>CLOB</p><div class="itemizedlist"><ul type="circle"><li><p>String &#8211; getClobAsString and setClobAsString</p><p>String &#8211; getClobAsString&#21644;setClobAsString</p></li><li><p>InputStream &#8211; getClobAsAsciiStream and
                setClobAsAsciiStream</p><p>InputStream &#8211; getClobAsAsciiStream&#21644;setClobAsAsciiStream</p></li><li><p>Reader &#8211; getClobAsCharacterStream and
                setClobAsCharacterStream</p><p>Reader &#8211; getClobAsCharacterStream&#21644;setClobAsCharacterStream</p></li></ul></div></li></ul></div><p>
        </p><p>&#29616;&#22312;&#25105;&#20204;&#36890;&#36807;&#19968;&#20010;&#31034;&#20363;&#26469;&#23637;&#31034;&#22914;&#20309;&#21019;&#24314;&#19968;&#20010;BLOB&#25968;&#25454;&#24182;&#25554;&#20837;&#25968;&#25454;&#24211;&#12290;&#31245;&#21518;&#30340;&#20363;&#23376;&#65292;&#25105;&#20204;&#23558;&#23637;&#31034;&#22914;&#20309;&#20174;&#25968;&#25454;&#24211;&#20013;&#23558;BLOB&#25968;&#25454;&#35835;&#21462;&#20986;&#26469;&#12290;</p><p>&#36825;&#20010;&#20363;&#23376;&#20351;&#29992;JdbcTemplate&#21644;&#19968;&#20010;AbstractLobCreatingPreparedStatementCallback&#30340;&#23454;&#29616;&#31867;&#12290;
			&#36825;&#37324;&#21807;&#19968;&#38656;&#35201;&#23454;&#29616;&#30340;&#26041;&#27861;&#23601;&#26159;"setValues"&#12290;&#22312;&#36825;&#20010;&#26041;&#27861;&#20013;&#65292;&#23558;&#25552;&#20379;&#19968;&#20010;LobCreator&#25509;&#21475;&#65292;&#34987;&#29992;&#20316;&#22312;&#20320;&#30340;&#25554;&#20837;&#35821;&#21477;&#20013;&#35774;&#32622;LOB&#23383;&#27573;&#30340;&#20540;&#12290;
		</p><p>&#25105;&#20204;&#20551;&#35774;&#26377;&#19968;&#20010;&#21464;&#37327;&#21483;&#20570;&#8220;lobHandler&#8221;&#24050;&#32463;&#34987;&#35774;&#32622;&#21040;<tt class="classname">DefaultLobHandler</tt>&#30340;&#23454;&#20363;&#20013;&#12290;&#24403;&#28982;&#65292;&#36825;&#26159;&#30001;&#27880;&#20837;&#23436;&#25104;&#30340;&#12290;
		</p><div class="programlistingco"><pre class="programlisting">final File blobIn = new File("spring2004.jpg");
final InputStream blobIs = new FileInputStream(blobIn);
final File clobIn = new File("large.txt");
final InputStream clobIs = new FileInputStream(clobIn);
final InputStreamReader clobReader = new InputStreamReader(clobIs);
jdbcTemplate.execute(
  "INSERT INTO lob_table (id, a_clob, a_blob) VALUES (?, ?, ?)",
  new AbstractLobCreatingPreparedStatementCallback(lobhandler) {                         <span class="co"><img src="http://shouce.jb51.net/images/callouts/1.png" alt="(1)"></span>
      protected void setValues(PreparedStatement ps, LobCreator lobCreator) 
          throws SQLException {
        ps.setLong(1, 1L);
        lobCreator.setClobAsCharacterStream(ps, 2, clobReader, (int)clobIn.length());    <span class="co"><img src="http://shouce.jb51.net/images/callouts/2.png" alt="(2)"></span>
        lobCreator.setBlobAsBinaryStream(ps, 3, blobIs, (int)blobIn.length());           <span class="co"><img src="http://shouce.jb51.net/images/callouts/3.png" alt="(3)"></span>
      }
  }
);
blobIs.close();
clobReader.close();</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><img src="http://shouce.jb51.net/images/callouts/1.png" alt="1" border="0"></td><td valign="top" align="left"><p>&#25105;&#20204;&#22312;&#36825;&#37324;&#20351;&#29992;&#30340;lobHandler&#23454;&#29616;&#31867;&#26159;&#19968;&#20010;&#26222;&#36890;&#30340;<tt class="classname">DefaultLobHandler</tt></p></td></tr><tr><td width="5%" valign="top" align="left"><img src="http://shouce.jb51.net/images/callouts/2.png" alt="2" border="0"></td><td valign="top" align="left"><p>&#20351;&#29992;<tt class="classname">setClobAsCharacterStream</tt>&#65292;&#25105;&#20204;&#20256;&#20837;CLOB&#30340;&#20869;&#23481;</p></td></tr><tr><td width="5%" valign="top" align="left"><img src="http://shouce.jb51.net/images/callouts/3.png" alt="3" border="0"></td><td valign="top" align="left"><p>&#20351;&#29992;<tt class="classname">setBlobAsBinartStream</tt>&#65292;&#25105;&#20204;&#20256;&#20837;BLOB&#30340;&#20869;&#23481;</p></td></tr></table></div></div><p>&#29616;&#22312;&#25105;&#20204;&#26469;&#31034;&#33539;&#20174;&#25968;&#25454;&#24211;&#20013;&#35835;&#21462;LOB&#25968;&#25454;&#12290;&#25105;&#20204;&#36825;&#37324;&#20877;&#27425;&#20351;&#29992;JdbcTempate&#24182;&#20351;&#29992;&#30456;&#21516;&#30340;<tt class="classname">DefaultLobHandler</tt>&#23454;&#20363;&#12290;
		</p><div class="programlistingco"><pre class="programlisting">List l = jdbcTemplate.query("select id, a_clob, a_blob from lob_table",
    new RowMapper() {
      public Object mapRow(ResultSet rs, int i) throws SQLException {
        Map results = new HashMap();
        String clobText = lobHandler.getClobAsString(rs, "a_clob");                      <span class="co"><img src="http://shouce.jb51.net/images/callouts/1.png" alt="(1)"></span>
        results.put("CLOB", clobText);
        byte[] blobBytes = lobHandler.getBlobAsBytes(rs, "a_blob");                      <span class="co"><img src="http://shouce.jb51.net/images/callouts/2.png" alt="(2)"></span>
        results.put("BLOB", blobBytes);
        return results;
      }
    });
</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><img src="http://shouce.jb51.net/images/callouts/2.png" alt="2" border="0"></td><td valign="top" align="left"><p>&#20351;&#29992;<tt class="classname">getClobAsString </tt>&#33719;&#21462;CLOB&#20869;&#23481;</p></td></tr><tr><td width="5%" valign="top" align="left"><img src="http://shouce.jb51.net/images/callouts/3.png" alt="3" border="0"></td><td valign="top" align="left"><p>&#20351;&#29992;<tt class="classname">getBlobAsBytes</tt>&#33719;&#21462;BLOB&#20869;&#23481;</p></td></tr></table></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-in-clause"></a>11.7.3.&nbsp;&#22312;IN&#35821;&#21477;&#20013;&#20256;&#20837;&#19968;&#32452;&#21442;&#25968;&#20540;</h3></div></div><div></div></div><p>SQL&#26631;&#20934;&#20801;&#35768;&#22522;&#20110;&#19968;&#20010;&#24102;&#21442;&#25968;&#21015;&#34920;&#30340;&#34920;&#36798;&#24335;&#36827;&#34892;&#26597;&#35810;&#12290;&#19968;&#20010;&#20856;&#22411;&#30340;&#20363;&#23376;&#21487;&#33021;&#20687;&#36825;&#26679;&#65306;"select * from T_ACTOR where id in (1, 2, 3)"&#12290;
			&#19981;&#36807;&#36825;&#31181;&#21442;&#25968;&#21015;&#34920;&#30340;&#26041;&#24335;&#24182;&#19981;&#33021;&#30452;&#25509;&#34987;JDBC&#26631;&#20934;&#25152;&#25903;&#25345; - &#22240;&#20026;&#24182;&#19981;&#23384;&#22312;&#36825;&#31181;&#22768;&#26126;&#19968;&#20010;&#21015;&#34920;&#21442;&#25968;&#20316;&#20026;&#21344;&#20301;&#31526;&#30340;&#26041;&#24335;&#12290;
			&#20320;&#19981;&#24471;&#19981;&#20026;&#27492;&#20889;&#22810;&#20010;&#21344;&#20301;&#31526;&#26469;&#34920;&#31034;&#22810;&#20010;&#21442;&#25968;&#65292;&#25110;&#32773;&#24403;&#20320;&#30693;&#36947;&#21344;&#20301;&#31526;&#30340;&#25968;&#37327;&#26102;&#65292;&#20320;&#21487;&#20197;&#21160;&#24577;&#26500;&#24314;SQL&#23383;&#31526;&#20018;&#12290;
      <tt class="classname">NamedParameterJdbcTemplate</tt>&#21644;<tt class="classname">SimpleJdbcTemplate</tt>&#20013;&#25152;&#25552;&#20379;&#30340;&#21629;&#21517;&#21442;&#25968;&#30340;&#29305;&#24615;&#65292;&#37319;&#29992;&#30340;&#26159;&#21518;&#38754;&#19968;&#31181;&#20570;&#27861;&#12290;
      &#24403;&#20320;&#20256;&#20837;&#21442;&#25968;&#26102;&#65292;&#20320;&#38656;&#35201;&#20256;&#20837;&#19968;&#20010;<tt class="classname">java.util.List</tt>&#31867;&#22411;&#65292;&#25903;&#25345;&#22522;&#26412;&#31867;&#22411;&#12290;&#32780;&#36825;&#20010;list&#23558;&#20250;&#22312;SQL&#25191;&#34892;&#26102;&#26367;&#25442;&#21344;&#20301;&#31526;&#24182;&#20256;&#20837;&#21442;&#25968;&#12290;
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="http://shouce.jb51.net/images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#22312;&#20351;&#29992;IN&#35821;&#21477;&#26102;&#65292;&#24403;&#20320;&#20256;&#20837;&#22823;&#25209;&#37327;&#30340;&#20540;&#26102;&#35201;&#23567;&#24515;&#65292;JDBC&#26631;&#20934;&#24182;&#19981;&#30830;&#20445;&#36229;&#36807;100&#20010;&#20803;&#32032;&#22312;IN&#35821;&#21477;&#20013;&#12290;
        &#26377;&#19981;&#23569;&#25968;&#25454;&#24211;&#21487;&#20197;&#36229;&#20986;&#36825;&#20010;&#20540;&#30340;&#38480;&#21046;&#65292;&#20294;&#26159;&#19981;&#21516;&#30340;&#25968;&#25454;&#24211;&#20250;&#26377;&#19981;&#21516;&#30340;&#25968;&#37327;&#38480;&#21046;&#65292;&#27604;&#22914;Oracle&#30340;&#38480;&#21046;&#25968;&#37327;&#26159;1000&#20010;&#12290;
        </p></td></tr></table></div><p>&#38500;&#20102;&#22522;&#26412;&#31867;&#22411;&#20043;&#22806;&#65292;&#20320;&#36824;&#21487;&#20197;&#21019;&#24314;&#19968;&#20010;<tt class="classname">java.util.List</tt>&#30340;&#23545;&#35937;&#25968;&#32452;&#65292;&#36825;&#21487;&#20197;&#35753;&#20320;&#25903;&#25345;&#22312;IN&#34920;&#36798;&#24335;&#20013;&#32534;&#20889;&#22810;&#37325;&#34920;&#36798;&#24335;&#65292;&#20363;&#22914;"select * from T_ACTOR where (id, last_name) in ((1,
      'Johnson'), (2, 'Harrop'))". &#24403;&#28982;&#65292;&#36825;&#26679;&#20570;&#30340;&#21069;&#25552;&#26159;&#25968;&#25454;&#24211;&#24213;&#23618;&#30340;&#35821;&#27861;&#25903;&#25345;&#12290;
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-complex-types"></a>11.7.4.&nbsp;&#22788;&#29702;&#22797;&#26434;&#31867;&#22411;&#30340;&#23384;&#20648;&#36807;&#31243;&#35843;&#29992;</h3></div></div><div></div></div><p>&#24403;&#35843;&#29992;&#23384;&#20648;&#36807;&#31243;&#26102;&#65292;&#26377;&#26102;&#38656;&#35201;&#20351;&#29992;&#25968;&#25454;&#24211;&#29305;&#23450;&#30340;&#22797;&#26434;&#31867;&#22411;&#12290;&#20026;&#20102;&#36866;&#24212;&#36825;&#20123;&#31867;&#22411;&#65292;Spring&#25552;&#20379;&#20102;<tt class="classname">SqlReturnType</tt>&#31867;&#26469;&#22788;&#29702;&#23384;&#20648;&#36807;&#31243;&#30340;&#36820;&#22238;&#20540;&#65292;&#32780;&#20351;&#29992;<tt class="classname">SqlTypeValue</tt>&#26469;&#22788;&#29702;&#20256;&#20837;&#30340;&#21442;&#25968;&#12290;
		</p><p>&#19979;&#38754;&#36825;&#20010;&#20363;&#23376;&#65292;&#23558;Oracle&#30340;STRUCT&#23545;&#35937;&#20316;&#20026;&#36820;&#22238;&#20540;&#65292;&#36825;&#26159;&#19968;&#20010;&#30001;&#29992;&#25143;&#33258;&#23450;&#20041;&#30340;&#8220;ITEM_TYPE&#8221;&#12290;
		<tt class="classname">SqlReturnType</tt>&#25509;&#21475;&#26377;&#21807;&#19968;&#30340;&#26041;&#27861;&#8220;<tt class="classname">getTypeValue</tt>&#8221;&#38656;&#35201;&#34987;&#23454;&#29616;&#12290;&#32780;&#36825;&#20010;&#25509;&#21475;&#30340;&#23454;&#29616;&#23558;&#34987;&#29992;&#20316;<tt class="classname">SqlOutParameter</tt>&#22768;&#26126;&#30340;&#19968;&#37096;&#20998;&#12290;
		</p><p>
      </p><pre class="programlisting">declareParameter(new SqlOutParameter("item", OracleTypes.STRUCT, "ITEM_TYPE",
    new SqlReturnType() {
      public Object getTypeValue(CallableStatement cs, int colIndx, int sqlType, String typeName) 
          throws SQLException {
        STRUCT struct = (STRUCT)cs.getObject(colIndx);
        Object[] attr = struct.getAttributes();
        TestItem item = new TestItem();
        item.setId(((Number) attr[0]).longValue());
        item.setDescription((String)attr[1]);
        item.setExpirationDate((java.util.Date)attr[2]);
        return item;
      }
    }));</pre><p>
			&#36890;&#36807;Java&#20195;&#30721;&#35843;&#29992;&#23384;&#20648;&#36807;&#31243;&#20351;&#29992;<tt class="classname">SqlTypeValue</tt>&#26469;&#20256;&#20837;&#19968;&#20010;<tt class="classname">TestItem</tt>&#20316;&#20026;&#21442;&#25968;&#12290;
			<tt class="classname">SqlTypeValue</tt>&#25509;&#21475;&#26377;&#19968;&#20010;&#26041;&#27861;"<tt class="classname">createTypeValue</tt>"&#38656;&#35201;&#34987;&#23454;&#29616;&#12290;
			&#19968;&#20010;&#27963;&#21160;&#30340;&#25968;&#25454;&#24211;&#36830;&#25509;&#20063;&#21516;&#26102;&#34987;&#20256;&#20837;&#65292;&#23427;&#23558;&#34987;&#29992;&#20316;&#21019;&#24314;&#25968;&#25454;&#24211;&#29305;&#23450;&#30340;&#23545;&#35937;&#65292;&#31867;&#20284;<tt class="classname">StructDescriptor</tt>&#21644;<tt class="classname">ArrayDescriptor</tt> 
			</p><p>
      </p><pre class="programlisting">SqlTypeValue value = new AbstractSqlTypeValue() {
  protected Object createTypeValue(Connection conn, int sqlType, String typeName) throws SQLException {
    StructDescriptor itemDescriptor = new StructDescriptor(typeName, conn);
    Struct item = new STRUCT(itemDescriptor, conn,
        new Object[] {
            testItem.getId(),
            testItem.getDescription(),
            new java.sql.Date(testItem.getExpirationDate().getTime())
        });
    return item;
  }
};</pre><p>
		&#36825;&#37324;&#30340;<tt class="classname">SqlTypeValue</tt> &#29616;&#22312;&#21487;&#20197;&#34987;&#21152;&#20837;&#21040;&#20316;&#20026;&#21442;&#25968;&#30340;Map&#20013;&#21435;&#65292;&#20174;&#32780;&#21487;&#20197;&#25191;&#34892;&#30456;&#24212;&#30340;&#23384;&#20648;&#36807;&#31243;&#12290;
	</p></div></div></div><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="dao.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="orm.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;10.&nbsp;DAO&#25903;&#25345;&nbsp;</td><td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.springsource.com/" title="SpringSource">Sponsored by SpringSource</a></span></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;12.&nbsp;&#20351;&#29992;ORM&#24037;&#20855;&#36827;&#34892;&#25968;&#25454;&#35775;&#38382;</td></tr></table></div></body></html>