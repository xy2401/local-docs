<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>FileMessageFactory (Apache Tomcat 9.0.21 API Documentation)</title>
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="FileMessageFactory (Apache Tomcat 9.0.21 API Documentation)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":9,"i4":10,"i5":10,"i6":41,"i7":10,"i8":10,"i9":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"],32:["t6","Deprecated Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>Apache Tomcat 9.0.21</b></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/catalina/ha/deploy/FileMessage.html" title="class in org.apache.catalina.ha.deploy"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/apache/catalina/ha/deploy/UndeployMessage.html" title="class in org.apache.catalina.ha.deploy"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/catalina/ha/deploy/FileMessageFactory.html" target="_top">Frames</a></li>
<li><a href="FileMessageFactory.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.catalina.ha.deploy</div>
<h2 title="Class FileMessageFactory" class="title">Class FileMessageFactory</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.catalina.ha.deploy.FileMessageFactory</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">FileMessageFactory</span>
extends java.lang.Object</pre>
<div class="block">This factory is used to read files and write files by splitting them up into
 smaller messages. So that entire files don't have to be read into memory.
 <BR>
 The factory can be used as a reader or writer but not both at the same time.
 When done reading or writing the factory will close the input or output
 streams and mark the factory as closed. It is not possible to use it after
 that. <BR>
 To force a cleanup, call cleanup() from the calling object. <BR>
 This class is not thread safe.</div>
<dl>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>1.0</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#closed">closed</a></span></code>
<div class="block">Once the factory is used, it cannot be reused.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#creationTime">creationTime</a></span></code>
<div class="block">The time this instance was created.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#data">data</a></span></code>
<div class="block">The bytes that we hold the data in, not thread safe.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected java.io.File</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#file">file</a></span></code>
<div class="block">The file that we are reading/writing</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.io.FileInputStream</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#in">in</a></span></code>
<div class="block">When openForWrite=false, the input stream is held by this variable</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#isWriting">isWriting</a></span></code>
<div class="block">Flag that indicates if a thread is writing messages to disk.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.util.concurrent.atomic.AtomicLong</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#lastMessageProcessed">lastMessageProcessed</a></span></code>
<div class="block">The number of the last message processed.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#maxValidTime">maxValidTime</a></span></code>
<div class="block">The maximum valid time(in seconds) from creationTime.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.util.Map&lt;java.lang.Long,<a href="../../../../../org/apache/catalina/ha/deploy/FileMessage.html" title="class in org.apache.catalina.ha.deploy">FileMessage</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#msgBuffer">msgBuffer</a></span></code>
<div class="block">Messages received out of order are held in the buffer until required.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#nrOfMessagesProcessed">nrOfMessagesProcessed</a></span></code>
<div class="block">The number of messages we have written</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#openForWrite">openForWrite</a></span></code>
<div class="block">True means that we are writing with this factory.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected java.io.FileOutputStream</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#out">out</a></span></code>
<div class="block">When openForWrite=true, the output stream is held by this variable</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#READ_SIZE">READ_SIZE</a></span></code>
<div class="block">The number of bytes that we read from file</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#size">size</a></span></code>
<div class="block">The total size of the file</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#totalNrOfMessages">totalNrOfMessages</a></span></code>
<div class="block">The total number of packets that we split this file into</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t6" class="tableTab"><span><a href="javascript:show(32);">Deprecated Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#checkState-boolean-">checkState</a></span>(boolean&nbsp;openForWrite)</code>
<div class="block">Check to make sure the factory is able to perform the function it is
 asked to do.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#cleanup--">cleanup</a></span>()</code>
<div class="block">Closes the factory, its streams and sets all its references to null</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>java.io.File</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#getFile--">getFile</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static <a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html" title="class in org.apache.catalina.ha.deploy">FileMessageFactory</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#getInstance-java.io.File-boolean-">getInstance</a></span>(java.io.File&nbsp;f,
           boolean&nbsp;openForWrite)</code>
<div class="block">Creates a factory to read or write from a file.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#getMaxValidTime--">getMaxValidTime</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#isValid--">isValid</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#main-java.lang.String:A-">main</a></span>(java.lang.String[]&nbsp;args)</code>
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;&nbsp;</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code><a href="../../../../../org/apache/catalina/ha/deploy/FileMessage.html" title="class in org.apache.catalina.ha.deploy">FileMessage</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#readMessage-org.apache.catalina.ha.deploy.FileMessage-">readMessage</a></span>(<a href="../../../../../org/apache/catalina/ha/deploy/FileMessage.html" title="class in org.apache.catalina.ha.deploy">FileMessage</a>&nbsp;f)</code>
<div class="block">Reads file data into the file message and sets the size, totalLength,
 totalNrOfMsgs and the message number <BR>
 If EOF is reached, the factory returns null, and closes itself, otherwise
 the same message is returned as was passed in.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#setMaxValidTime-int-">setMaxValidTime</a></span>(int&nbsp;maxValidTime)</code>&nbsp;</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html#writeMessage-org.apache.catalina.ha.deploy.FileMessage-">writeMessage</a></span>(<a href="../../../../../org/apache/catalina/ha/deploy/FileMessage.html" title="class in org.apache.catalina.ha.deploy">FileMessage</a>&nbsp;msg)</code>
<div class="block">Writes a message to file.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="READ_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>READ_SIZE</h4>
<pre>public static final&nbsp;int READ_SIZE</pre>
<div class="block">The number of bytes that we read from file</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.catalina.ha.deploy.FileMessageFactory.READ_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="file">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>file</h4>
<pre>protected final&nbsp;java.io.File file</pre>
<div class="block">The file that we are reading/writing</div>
</li>
</ul>
<a name="openForWrite">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>openForWrite</h4>
<pre>protected final&nbsp;boolean openForWrite</pre>
<div class="block">True means that we are writing with this factory. False means that we are
 reading with this factory</div>
</li>
</ul>
<a name="closed">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>closed</h4>
<pre>protected&nbsp;boolean closed</pre>
<div class="block">Once the factory is used, it cannot be reused.</div>
</li>
</ul>
<a name="in">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>in</h4>
<pre>protected&nbsp;java.io.FileInputStream in</pre>
<div class="block">When openForWrite=false, the input stream is held by this variable</div>
</li>
</ul>
<a name="out">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>out</h4>
<pre>protected&nbsp;java.io.FileOutputStream out</pre>
<div class="block">When openForWrite=true, the output stream is held by this variable</div>
</li>
</ul>
<a name="nrOfMessagesProcessed">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nrOfMessagesProcessed</h4>
<pre>protected&nbsp;int nrOfMessagesProcessed</pre>
<div class="block">The number of messages we have written</div>
</li>
</ul>
<a name="size">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>size</h4>
<pre>protected&nbsp;long size</pre>
<div class="block">The total size of the file</div>
</li>
</ul>
<a name="totalNrOfMessages">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>totalNrOfMessages</h4>
<pre>protected&nbsp;long totalNrOfMessages</pre>
<div class="block">The total number of packets that we split this file into</div>
</li>
</ul>
<a name="lastMessageProcessed">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lastMessageProcessed</h4>
<pre>protected&nbsp;java.util.concurrent.atomic.AtomicLong lastMessageProcessed</pre>
<div class="block">The number of the last message processed. Message IDs are 1 based.</div>
</li>
</ul>
<a name="msgBuffer">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>msgBuffer</h4>
<pre>protected final&nbsp;java.util.Map&lt;java.lang.Long,<a href="../../../../../org/apache/catalina/ha/deploy/FileMessage.html" title="class in org.apache.catalina.ha.deploy">FileMessage</a>&gt; msgBuffer</pre>
<div class="block">Messages received out of order are held in the buffer until required. If
 everything is worked as expected, messages will spend very little time in
 the buffer.</div>
</li>
</ul>
<a name="data">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>data</h4>
<pre>protected&nbsp;byte[] data</pre>
<div class="block">The bytes that we hold the data in, not thread safe.</div>
</li>
</ul>
<a name="isWriting">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isWriting</h4>
<pre>protected&nbsp;boolean isWriting</pre>
<div class="block">Flag that indicates if a thread is writing messages to disk. Access to
 this flag must be synchronised.</div>
</li>
</ul>
<a name="creationTime">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>creationTime</h4>
<pre>protected&nbsp;long creationTime</pre>
<div class="block">The time this instance was created. (in milliseconds)</div>
</li>
</ul>
<a name="maxValidTime">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>maxValidTime</h4>
<pre>protected&nbsp;int maxValidTime</pre>
<div class="block">The maximum valid time(in seconds) from creationTime.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getInstance-java.io.File-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getInstance</h4>
<pre>public static&nbsp;<a href="../../../../../org/apache/catalina/ha/deploy/FileMessageFactory.html" title="class in org.apache.catalina.ha.deploy">FileMessageFactory</a>&nbsp;getInstance(java.io.File&nbsp;f,
                                             boolean&nbsp;openForWrite)
                                      throws java.io.FileNotFoundException,
                                             java.io.IOException</pre>
<div class="block">Creates a factory to read or write from a file. When opening for read,
 the readMessage can be invoked, and when opening for write the
 writeMessage can be invoked.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>f</code> - File - the file to be read or written</dd>
<dd><code>openForWrite</code> - boolean - true, means we are writing to the file, false means
            we are reading from it</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>FileMessageFactory</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.FileNotFoundException</code> - -
             if the file to be read doesn't exist</dd>
<dd><code>java.io.IOException</code> - -
             if it fails to create the file that is to be written</dd>
</dl>
</li>
</ul>
<a name="readMessage-org.apache.catalina.ha.deploy.FileMessage-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readMessage</h4>
<pre>public&nbsp;<a href="../../../../../org/apache/catalina/ha/deploy/FileMessage.html" title="class in org.apache.catalina.ha.deploy">FileMessage</a>&nbsp;readMessage(<a href="../../../../../org/apache/catalina/ha/deploy/FileMessage.html" title="class in org.apache.catalina.ha.deploy">FileMessage</a>&nbsp;f)
                        throws java.lang.IllegalArgumentException,
                               java.io.IOException</pre>
<div class="block">Reads file data into the file message and sets the size, totalLength,
 totalNrOfMsgs and the message number <BR>
 If EOF is reached, the factory returns null, and closes itself, otherwise
 the same message is returned as was passed in. This makes sure that not
 more memory is ever used. To remember, neither the file message or the
 factory are thread safe. dont hand off the message to one thread and read
 the same with another.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>f</code> - FileMessage - the message to be populated with file data</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>FileMessage - returns the same message passed in as a parameter,
         or null if EOF</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - -
             if the factory is for writing or is closed</dd>
<dd><code>java.io.IOException</code> - -
             if a file read exception occurs</dd>
</dl>
</li>
</ul>
<a name="writeMessage-org.apache.catalina.ha.deploy.FileMessage-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeMessage</h4>
<pre>public&nbsp;boolean&nbsp;writeMessage(<a href="../../../../../org/apache/catalina/ha/deploy/FileMessage.html" title="class in org.apache.catalina.ha.deploy">FileMessage</a>&nbsp;msg)
                     throws java.lang.IllegalArgumentException,
                            java.io.IOException</pre>
<div class="block">Writes a message to file. If (msg.getMessageNumber() ==
 msg.getTotalNrOfMsgs()) the output stream will be closed after writing.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>msg</code> - FileMessage - message containing data to be written</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>returns true if the file is complete and outputstream is closed,
         false otherwise.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - -
             if the factory is opened for read or closed</dd>
<dd><code>java.io.IOException</code> - -
             if a file write error occurs</dd>
</dl>
</li>
</ul>
<a name="cleanup--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cleanup</h4>
<pre>public&nbsp;void&nbsp;cleanup()</pre>
<div class="block">Closes the factory, its streams and sets all its references to null</div>
</li>
</ul>
<a name="checkState-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkState</h4>
<pre>protected&nbsp;void&nbsp;checkState(boolean&nbsp;openForWrite)
                   throws java.lang.IllegalArgumentException</pre>
<div class="block">Check to make sure the factory is able to perform the function it is
 asked to do. Invoked by readMessage/writeMessage before those methods
 proceed.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>openForWrite</code> - The value to check</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if the state is not the expected one</dd>
</dl>
</li>
</ul>
<a name="main-java.lang.String:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>main</h4>
<pre>@Deprecated
public static&nbsp;void&nbsp;main(java.lang.String[]&nbsp;args)
                              throws java.lang.Exception</pre>
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;</div>
<div class="block">Example usage.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>args</code> - String[], args[0] - read from filename, args[1] write to
            filename</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - An error occurred</dd>
</dl>
</li>
</ul>
<a name="getFile--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFile</h4>
<pre>public&nbsp;java.io.File&nbsp;getFile()</pre>
</li>
</ul>
<a name="isValid--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isValid</h4>
<pre>public&nbsp;boolean&nbsp;isValid()</pre>
</li>
</ul>
<a name="getMaxValidTime--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMaxValidTime</h4>
<pre>public&nbsp;int&nbsp;getMaxValidTime()</pre>
</li>
</ul>
<a name="setMaxValidTime-int-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>setMaxValidTime</h4>
<pre>public&nbsp;void&nbsp;setMaxValidTime(int&nbsp;maxValidTime)</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>Apache Tomcat 9.0.21</b></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/catalina/ha/deploy/FileMessage.html" title="class in org.apache.catalina.ha.deploy"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/apache/catalina/ha/deploy/UndeployMessage.html" title="class in org.apache.catalina.ha.deploy"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/catalina/ha/deploy/FileMessageFactory.html" target="_top">Frames</a></li>
<li><a href="FileMessageFactory.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2000-2019 Apache Software Foundation. All Rights Reserved.</small></p>
</body>
</html>
