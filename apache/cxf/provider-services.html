
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<html>
  <head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - Provider Services">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushBash.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>
Apache CXF -- Provider Services
    </title>
  </head>
<body onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tr>
    <td id="cell-0-0" colspan="2">&nbsp;</td>
    <td id="cell-0-1">&nbsp;</td>
    <td id="cell-0-2" colspan="2">&nbsp;</td>
  </tr>
  <tr>
    <td id="cell-1-0">&nbsp;</td>
    <td id="cell-1-1">&nbsp;</td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight: bold; font-size: 170%; color: white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="The Apache Sofware Foundation"><img border="0" alt="ASF Logo" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs -->
<a href="index.html">Index</a>&nbsp;&gt;&nbsp;<a href="frontends.html">Frontends</a>&nbsp;&gt;&nbsp;<a href="jax-ws.html">JAX-WS</a>&nbsp;&gt;&nbsp;<a href="provider-services.html">Provider Services</a>
                <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">Download</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">Documentation</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </table>
      </div>
    </td>
    <td id="cell-1-3">&nbsp;</td>
    <td id="cell-1-4">&nbsp;</td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2">&nbsp;</td>
    <td id="cell-2-1">
      <table>
        <tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">Overview</a></li><li><a shape="rect" href="how-tos.html">How-Tos</a></li><li><a shape="rect" href="frontends.html">Frontends</a></li><li><a shape="rect" href="databindings.html">DataBindings</a></li><li><a shape="rect" href="transports.html">Transports</a></li><li><a shape="rect" href="configuration.html">Configuration</a></li><li><a shape="rect" href="debugging-and-logging.html">Debugging and Logging</a></li><li><a shape="rect" href="tools.html">Tools</a></li><li><a shape="rect" href="restful-services.html">RESTful Services</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL Bindings</a></li><li><a shape="rect" href="service-routing.html">Service Routing</a></li><li><a shape="rect" href="dynamic-languages.html">Dynamic Languages</a></li><li><a shape="rect" href="ws-support.html">WS-* Support</a></li><li><a shape="rect" href="advanced-integration.html">Advanced Integration</a></li><li><a shape="rect" href="deployment.html">Deployment</a></li><li><a shape="rect" href="schemas-and-namespaces.html">Use of Schemas and Namespaces</a></li></ul><hr><ul class="alternate"><li><p>Search</p></li></ul><form enctype="application/x-www-form-urlencoded" method="get" id="cse-search-box" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="Search">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x (Javadoc)</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x (Javadoc)</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF Website</a></li></ul><p>&#160;</p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><h2 id="ProviderServices-MessagingModes">Messaging Modes</h2>

<h3 id="ProviderServices-Overview">Overview</h3>

<p>Objects that implement the <code>Provider</code> interface have two <em>messaging modes</em>:</p>
<ul><li>Message mode</li><li>Payload mode</li></ul>


<p>The messaging mode you specify determines the level of messaging detail that is passed to your implementation.</p>

<h3 id="ProviderServices-Messagemode">Message mode</h3>

<p>When using <em>message mode</em>, a <code>Provider</code> implementation works with complete messages. A complete message includes any binding specific headers and wrappers. For example, a <code>Provider</code> implementation that uses a SOAP binding would receive requests as fully specified SOAP message. Any response returned from the implementation would also need to be a fully specified SOAP message.</p>

<p>You specify that a <code>Provider</code> implementation uses message mode by providing the value <code>java.xml.ws.Service.Mode.MESSAGE</code> as the value to the <code>javax.xml.ws.ServiceMode</code> annotation.</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
@WebServiceProvider
@ServiceMode(value=Service.Mode.MESSAGE)
public class stockQuoteProvider implements Provider&lt;SOAPMessage&gt;
{
  ...
}
</pre>
</div></div>

<h3 id="ProviderServices-Payloadmode">Payload mode</h3>

<p>In <em>payload mode</em> a <code>Provider</code> implementation works with only the payload of a message. For example, a <code>Provider</code> implementation working in payload mode works only with the body of a SOAP message. The binding layer processes any binding level wrappers and headers.</p>
<div class="confluence-information-macro confluence-information-macro-tip"><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>When working with a binding that does not use special wrappers, such as the XML binding, payload mode and message mode provide the same results.</p></div></div>
<p>You specify that a <code>Provider</code> implementation uses payload mode by providing the value <code>java.xml.ws.Service.Mode.PAYLOAD</code> as the value to the <code>javax.xml.ws.ServiceMode</code> annotation.</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
@WebServiceProvider
@ServiceMode(value=Service.Mode.PAYLOAD)
public class stockQuoteProvider implements Provider&lt;DOMSource&gt;
{
  ...
}
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>If you do not provide the <code>@ServiceMode</code> annotation, the <code>Provider</code> implementation will default to using payload mode.</p></div></div>

<h2 id="ProviderServices-DataTypes">Data Types</h2>


<h3 id="ProviderServices-Overview.1">Overview</h3>

<p><code>Provider</code> implementations, because they are low-level objects, cannot use the same JAXB generated types as the higher level consumer APIs. Provider implementations work with the following types of objects:</p>
<ul><li><code>javax.xml.transform.Source</code></li><li><code>javax.xml.soap.SOAPMessage</code></li><li><code>javax.activation.DataSource</code></li></ul>


<h3 id="ProviderServices-UsingSourceobjects">Using <code>Source</code> objects</h3>

<p>A <code>Provider</code> implementation can accept and return objects that are derived from the <code>javax.xml.transform.Source</code> interface. <code>Source</code> objects are low level objects that hold XML documents. Each <code>Source</code> implementation provides methods that access the stored XML documents and manipulate its contents. The following objects implement the <code>Source</code> interface:</p>
<ul><li><code>DOMSource</code> holds XML messages as a Document Object Model(DOM) tree. The XML message is stored as a set of <code>Node</code> objects that can be accessed using the <code>getNode()</code> method. Nodes can be updated or added to the DOM tree using the <code>setNode()</code> method.</li><li><code>SAXSource</code> holds XML messages as a Simple API for XML (SAX) object. SAX objects contain an <code>InputSource</code> object that contains the raw data and an <code>XMLReader</code> object that parses the raw data.</li><li><code>StreamSource</code> holds XML messages as a data stream. The data stream can be manipulated as would any other data stream.
<div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>When using <code>Source</code> objects the developer is responsible for ensuring that all required binding specific wrappers are added to the message. For example, when interacting with a service expecting SOAP messages, the developer must ensure that the required SOAP envelope is added to the outgoing request and that the SOAP envelope's contents are correct.</p></div></div></li></ul>


<h3 id="ProviderServices-UsingSOAPMessageobjects">Using <code>SOAPMessage</code> objects</h3>

<p><code>Provider</code> implementations can use <code>javax.xml.soap.SOAPMessage</code> objects when the following conditions are true:</p>
<ul><li>the <code>Provider</code> implementation is using the SOAP binding.</li><li>the <code>Provider</code> implementation is using message mode.</li></ul>


<p>A <code>SOAPMessage</code> object, as the name implies, holds a SOAP message. They contain one <code>SOAPPart</code> object and zero or more <code>AttachmentPart</code> objects. The <code>SOAPPart</code> object contains the SOAP specific portions of the SOAP message including the SOAP envelope, any SOAP headers, and the SOAP message body. The <code>AttachmentPart</code> objects contain binary data that was passed as an attachment.</p>

<h3 id="ProviderServices-UsingDataSourceobjects">Using <code>DataSource</code> objects</h3>

<p>Provider implementations can use objects that implement the <code>javax.activation.DataSource</code> interface when the following conditions are true:</p>
<ul><li>the implementation is using the HTTP binding.</li><li>the implementation is using message mode.</li></ul>


<p><code>DataSource</code> objects provide a mechanism for working with MIME typed data from a variety of sources including URLs, files, and byte arrays.</p>

<h3 id="ProviderServices-ImplementingaProviderObject">Implementing a Provider Object</h3>


<h4 id="ProviderServices-Overview.2">Overview</h4>

<p>The <code>Provider</code> interface is relatively easy to implement. It only has one method, invoke(), that needs to be implemented. In addition it has three simple requirements:</p>
<ul><li>An implementation must have the <code>@WebServiceProvider</code> annotation.</li><li>An implementation must have a default public constructor.</li><li>An implementation must implement a typed version of the Provider interface.<br clear="none" class="atl-forced-newline">
In other words, you cannot implement a <code>Provider&lt;T&gt;</code> interface. You must implement a version of the interface that uses a concrete data type. For example, you can implement an instance of a <code>Provider&lt;SAXSource&gt;</code>.</li></ul>


<p>The complexity of implementing the Provider interface surrounds handling the request messages and building the proper responses.</p>

<h4 id="ProviderServices-Workingwithmessages">Working with messages</h4>

<p>Unlike the higher-level SEI based service implementations, <code>Provider</code> implementations receive requests as raw XML data and must send responses as raw XML data. This requires that the developer has intimate knowledge of the messages used by the service being implemented. These details can typically be found in the WSDL document describing the service.</p>

<p>WS-I Basic Profile provides guidelines about the messages used by services including:</p>
<ul><li>The root element of a request is based in the value of the name attribute of the <code>wsdl:operation</code> element that corresponds to the operation being invoked.
<div class="confluence-information-macro confluence-information-macro-warning"><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>If the service uses doc/literal bare messages, the root element of the request will be based on the value of name attribute of the <code>wsdl:part</code> element referred to by the <code>wsdl:operation</code> element.</p></div></div></li><li>The root element of all messages will be namespace qualified.</li><li>If the service uses rpc/literal messages, the top-level elements in the messages will not be namespace qualified.
<div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>The children of top-level elements may be namespace qualified. To be certain you will need to check their schema definitions.</p></div></div></li><li>If the service uses rpc/literal messages, none of the top-level elements can be null.</li><li>If the service uses doc/literal messages, the schema definition of the message determines if any of the elements are namespace qualified.</li></ul>


<h3 id="ProviderServices-Implementingtheinvoke()method">Implementing the <code>invoke()</code> method</h3>

<p>The <code>Provider</code> interface has only one method, <code>invoke()</code>, that needs to be implemented. <code>invoke()</code> receives the incoming request packaged into the type of object declared by the type of <code>Provider</code> interface being implemented and returns the response message packaged into the same type of object. For example, an implementation of a <code>Provider&lt;SOAPMessage&gt;</code> interface would receive the request as a <code>SOAPMessage</code> object and return the response as a <code>SOAPMessage</code> object.</p>

<p>The messaging mode used by the <code>Provider</code> implementation determines the amount of binding specific information the request and response messages contain. Implementation using message mode receive all of the binding specific wrappers and headers along with the request. They must also add all of the binding specific wrappers and headers to the response message. Implementations using payload mode only receive the body of the request. The XML document returned by an implementation using payload mode will be placed into the body of the request message.</p>

<h3 id="ProviderServices-Examples">Examples</h3>

<p>The following shows a <code>Provider</code> implementation that works with <code>SOAPMessage</code> objects in message mode.</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
import javax.xml.ws.Provider;
import javax.xml.ws.Service;
import javax.xml.ws.ServiceMode;
import javax.xml.ws.WebServiceProvider;

@WebServiceProvider(portName="stockQuoteReporterPort" 
    serviceName="stockQuoteReporter")
@ServiceMode(value="Service.Mode.MESSAGE")
public class  stockQuoteReporterProvider 
    implements Provider&lt;SOAPMessage&gt; 
{
  public stockQuoteReporterProvider() 
  {
  }

  public SOAPMessage invoke(SOAPMessage request) 
  {
    SOAPBody requestBody = request.getSOAPBody();
    if(requestBody.getElementName.getLocalName.equals("getStockPrice"))
    {
      MessageFactory mf = MessageFactory.newInstance();
      SOAPFactory sf = SOAPFactory.newInstance();

      SOAPMessage response = mf.createMessage();
      SOAPBody respBody = response.getSOAPBody();
      Name bodyName = sf.createName("getStockPriceResponse");
      respBody.addBodyElement(bodyName);
      SOAPElement respContent = respBody.addChildElement("price");
      respContent.setValue("123.00");
      response.saveChanges();
      return response;
    }
    ...
  }
}
</pre>
</div></div>
<p>The code does the following:</p>
<ol><li>Specifies that the following class implements a <code>Provider</code> object that implements the service whose <code>wsdl:service</code> element is named <code>stockQuoteReporter</code> and whose <code>wsdl:port</code> element is named <code>stockQuoteReporterPort</code>.</li><li>Specifies that this <code>Provider</code> implementation uses message mode.</li><li>Provides the required default public constructor.</li><li>Provides an implementation of the <code>invoke()</code> method that takes <code>a SOAPMessage</code> object and returns a <code>SOAPMessage</code> object.</li><li>Extracts the request message from the body of the incoming SOAP message.</li><li>Checks the root element of the request message to determine how to process the request.</li><li>Creates the factories needed for building the response.</li><li>Builds the SOAP message for the response.</li><li>Returns the response as a SOAPMessage object.</li></ol>


<p>The following shows an example of a Provider implementation using DOMSource objects in payload mode.</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
import javax.xml.ws.Provider;
import javax.xml.ws.Service;
import javax.xml.ws.ServiceMode;
import javax.xml.ws.WebServiceProvider;

@WebServiceProvider(portName="stockQuoteReporterPort"
  serviceName="stockQuoteReporter")
@ServiceMode(value="Service.Mode.PAYLOAD")
public class  stockQuoteReporterProvider implements Provider&lt;DOMSource&gt;
{
  public stockQuoteReporterProvider()
  {
  }

  public DOMSource invoke(DOMSource request)
  {
    DOMSource response = new DOMSource();
    ...
    return response;
  }
}
</pre>
</div></div>
<p>The code does the following:</p>
<ol><li>Specifies that the class implements a <code>Provider</code> object that implements the service whose <code>wsdl:service</code> element is named <code>stockQuoteReporter</code> and whose <code>wsdl:port</code> element is named <code>stockQuoteReporterPort</code>.</li><li>Specifies that this Provider implementation uses payload mode.</li><li>Provides the required default public constructor.</li><li>Provides an implementation of the <code>invoke()</code> method that takes a <code>DOMSource</code> object and returns a <code>DOMSource</code> object.</li></ol></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </table>
   </td>
   <td id="cell-2-2" colspan="2">&nbsp;</td>
  </tr>
  <tr>
   <td id="cell-3-0">&nbsp;</td>
   <td id="cell-3-1">&nbsp;</td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">Privacy Policy</a> - 
         (<a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=59880">edit page</a>) 
	 (<a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=59880&amp;showComments=true&amp;showCommentArea=true#addcomment">add comment</a>)<br>
	Apache CXF, CXF, Apache, the Apache feather logo are trademarks of The Apache Software Foundation.<br>
        All other marks mentioned may be trademarks or registered trademarks of their respective owners.
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3">&nbsp;</td>
   <td id="cell-3-4">&nbsp;</td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2">&nbsp;</td>
    <td id="cell-4-1">&nbsp;</td>
    <td id="cell-4-2" colspan="2">&nbsp;</td>
  </tr>
</table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>

</body>
</html>

