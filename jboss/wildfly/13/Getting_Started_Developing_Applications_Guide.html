<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="author" content="WildFly team">
<title>Getting Started Developing Applications Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body id="Getting_Started_Developing_Applications_Guide" class="book toc2 toc-left">
<div id="header">
<h1>Getting Started Developing Applications Guide</h1>
<div class="details">
<span id="author" class="author">WildFly team</span><br>
<span id="revnumber">version 13.0.0.Final,</span>
<span id="revdate">2018-05-31T05:22:12Z</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Getting Started Developing Applications Guide</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#downloading-the-quickstarts">1.1. Downloading the quickstarts</a></li>
</ul>
</li>
<li><a href="#getting-started-with-wildfly">2. Getting started with WildFly</a>
<ul class="sectlevel2">
<li><a href="#installing-and-starting-the-jboss-server-on-linux-unix-or-mac-os-x">2.1. Installing and starting the JBoss server on Linux, Unix or Mac OS X</a></li>
<li><a href="#installing-and-starting-the-jboss-server-on-windows">2.2. Installing and starting the JBoss server on Windows</a></li>
<li><a href="#starting-the-jboss-server-from-jbds-or-eclipse-with-jboss-tools">2.3. Starting the JBoss server from JBDS or Eclipse with JBoss Tools</a></li>
<li><a href="#importing-the-quickstarts-into-eclipse">2.4. Importing the quickstarts into Eclipse</a></li>
<li><a href="#managing-jboss-wildfly">2.5. Managing JBoss WildFly</a></li>
</ul>
</li>
<li><a href="#cdi-servlet-helloworld-quickstart">3. CDI + Servlet: Helloworld quickstart</a>
<ul class="sectlevel2">
<li><a href="#deploying-the-helloworld-quickstart-using-jboss-developer-studio-or-eclipse-with-jboss-tools">3.1. Deploying the Helloworld quickstart using JBoss Developer Studio, or Eclipse with JBoss Tools</a></li>
<li><a href="#the-helloworld-quickstart-in-depth">3.2. The helloworld quickstart in depth</a></li>
</ul>
</li>
<li><a href="#cdi-jsf-numberguess-quickstart">4. CDI + JSF: Numberguess quickstart</a>
<ul class="sectlevel2">
<li><a href="#deploying-the-numberguess-quickstart-using-eclipse">4.1. Deploying the Numberguess quickstart using Eclipse</a></li>
<li><a href="#the-numberguess-quickstart-in-depth">4.2. The numberguess quickstart in depth</a></li>
</ul>
</li>
<li><a href="#cdi-jpa-ejb-jta-jsf-greeter-quickstart">5. CDI + JPA + EJB + JTA + JSF: Greeter quickstart</a>
<ul class="sectlevel2">
<li><a href="#greeter_in_depth">5.1. The greeter quickstart in depth</a></li>
</ul>
</li>
<li><a href="#cdi-jsf-ejb-jta-bean-validation-jax-rs-arquillian-kitchensink-quickstart">6. CDI + JSF + EJB + JTA + Bean Validation + JAX-RS + Arquillian: Kitchensink quickstart</a>
<ul class="sectlevel2">
<li><a href="#deploying-the-kitchensink-quickstart-using-jboss-developer-studio-or-eclipse-with-jboss-tools">6.1. Deploying the Kitchensink quickstart using JBoss Developer Studio, or Eclipse with JBoss Tools</a></li>
<li><a href="#the-kitchensink-quickstart-in-depth">6.2. The kitchensink quickstart in depth</a></li>
</ul>
</li>
<li><a href="#creating-your-own-application">7. Creating your own application</a></li>
<li><a href="#more-resources">8. More Resources</a>
<ul class="sectlevel2">
<li><a href="#Developing_JSF_Project_Using">8.1. Developing JSF Project Using JBoss AS7, Maven and IntelliJ</a></li>
<li><a href="#Getting_Started_Developing_Applications_Presentation_Demo">8.2. Getting Started Developing Applications Presentation &amp; Demo</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>&#169; 2017 The original authors.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>This guide has moved to
<a href="https://github.com/wildfly/quickstart/blob/11.x/guide/" class="bare">https://github.com/wildfly/quickstart/blob/11.x/guide/</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide will walk you through installing and starting up JBoss WildFly. It will then introduce key features of the Java EE 6 (Web Profile) programming model, of which JBoss WildFly is a certified implementation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Java EE 7</div>
<div class="paragraph">
<p>The Java EE 7 platform offers developers the ability to write
distributed, transactional and portable applications quickly and easily.
We class applications that require these capabilities "enterprise
applications". These applications must be fast, secure and reliable.</p>
</div>
<div class="paragraph">
<p>Java EE has always offered strong messaging (JMS), transactional (JTA)
and resource (JCA) capabilities as well as exposing web services via
SOAP (JAX-WS). Java EE 5 started a radical shift for the programming
model, offering a powerful, declarative and lightweight
object-relational mapper (JPA) and  annotation-driven, lightweight
access to enterprise services (EJB 3). Java EE 6 added a type-safe,
loosely coupled programming model (CDI), declarative validation of
constraints (Bean Validation) and RESTful web services (JAX-RS) to
produce a complete, modern development environment.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>JBoss WildFly depart from the familiar structure of previous JBoss AS versions, so we recommend all developers follow the steps in <a href="https://github.com/wildfly/quickstart/blob/10.x/guide/GettingStarted.asciidoc">Getting Started with JBoss WildFly</a> to install and start up the application server for the first time.</p>
</div>
<div class="paragraph">
<p>JBoss WildFly come with a series of quickstarts aimed to get you up to writing applications with minimal fuss. We recommend to start by working through the quickstarts in this guide, in the order they are presented. If you have previous experience with Java EE 6, you may wish to skip some or all of the quickstarts.</p>
</div>
<div class="paragraph">
<p><strong>Core</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://github.com/wildfly/quickstart/blob/10.x/guide/HelloworldQuickstart.asciidoc">Helloworld Quickstart</a>. If you have previously developed applications using technologies such as JSF or Wicket, and EJB or Spring, you may wish to skip this quickstart.</p>
</li>
<li>
<p><a href="https://github.com/wildfly/quickstart/blob/10.x/guide/NumberguessQuickstart.asciidoc">Numberguess Quickstart</a>. If you have previously developed applications using technologies such as JSF or Wicket, EJB or Spring, and JPA or Hibernate you may wish to skip this quickstart.</p>
</li>
<li>
<p><a href="https://github.com/wildfly/quickstart/blob/10.x/guide/GreeterQuickstart.asciidoc">Greeter Quickstart</a>. If you are a Java EE wizard you may wish to skip this quickstart.</p>
</li>
<li>
<p><a href="https://github.com/wildfly/quickstart/blob/10.x/guide/KitchensinkQuickstart.asciidoc">Kitchensink Quickstart</a>. A great starting point for your project.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="downloading-the-quickstarts">1.1. Downloading the quickstarts</h3>
<div class="paragraph">
<p>The quickstarts are are available for download from <a href="https://github.com/wildfly/quickstart">JBoss Developer Framework</a>. Make sure you download the latest zip!</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started-with-wildfly">2. Getting started with WildFly</h2>
<div class="sectionbody">
<div id="GettingStarted-" class="paragraph">
<p>To run the quickstarts with the provided build scripts, you&#8217;ll need:</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you already have any of these pieces of software, there is no need to
install them again!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Java 8, to run WildFly and Maven</dt>
<dd>
<p>Choose your Java runtime, and follow their installation instructions. For example, you could choose one of:</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://openjdk.java.net/install/">OpenJDK</a></p>
</li>
<li>
<p><a href="http://www.oracle.com/technetwork/java/javase/index-137561.html">Oracle Java SE</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Maven 3, to build and deploy the quickstarts</dt>
<dd>
<p>Follow the official Maven installation guide if you don&#8217;t already have Maven 3 installed. You can check which version of Maven you have installed (if any) by running <code>mvn --version</code> . If you see a version newer than 3.0.0, you are ready to go.</p>
</dd>
<dt class="hdlist1">The JBoss WildFly runtime</dt>
<dd>
<p>Download JBoss WildFly from the <a href="http://wildfly.org/downloads/">WildFly download page</a></p>
</dd>
<dt class="hdlist1">The WildFly quickstarts</dt>
<dd>
<p>Available from <a href="https://github.com/wildfly/quickstart">WildFly Quickstarts</a></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If you wish to use the examples from an IDE, we recommend using JBoss Developer Studio, or Eclipse with JBoss Tools.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">JBoss Developer Studio</dt>
<dd>
<p>Download JBDS from <a href="http://devstudio.jboss.com/download/" class="bare">http://devstudio.jboss.com/download/</a>.</p>
</dd>
<dt class="hdlist1">Eclipse, with JBoss Tools</dt>
<dd>
<p>Download JBoss Tools from <a href="http://jboss.org/tools" class="bare">http://jboss.org/tools</a>. Make sure you install m2eclipse as well.</p>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>JBoss WildFly offer the
ability to manage multiple AS instances from a single control point.
A collection of such servers are referred to as members of a "domain",
with a single Domain Controller process acting as the management control
point. Domains can span multiple physical (or virtual) machines, with
all AS instances on a given host under the control of a Host Controller
process. The Host Controllers interact with the Domain Controller to
control the lifecycle of the AS instances running on that host and to
assist the Domain Controller in managing them.</p>
</div>
<div class="paragraph">
<p>JBoss WildFly also offers a standalone mode, which is perfect for a single
server. We use this throughout the quickstarts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="installing-and-starting-the-jboss-server-on-linux-unix-or-mac-os-x">2.1. Installing and starting the JBoss server on Linux, Unix or Mac OS X</h3>
<div id="GettingStarted-on_linux" class="paragraph">
<p>First, let&#8217;s verify that both Java and Maven are correctly
installed. In a console, type:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>java -version</pre>
</div>
</div>
<div class="paragraph">
<p>You should see a version string (at least <code>1.8.0</code>) printed. If not, contact your provider of Java for assistance. Next, type:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn --version</pre>
</div>
</div>
<div class="paragraph">
<p>You should see a version string (at least <code>3.3.0</code>) printed. If not, contact the Maven community for assistance.</p>
</div>
<div class="paragraph">
<p>Next, we need to choose a location for WildFly to live. By default, WildFly will be extracted into <code>wildfly-11.x.x.x</code> (where <code>11.x.x.x</code> matches the version you downloaded):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>unzip wildfly-11.x.x.x.zip</pre>
</div>
</div>
<div class="paragraph">
<p>Now, let&#8217;s start WildFly in standalone mode:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>wildfly-11.x.x.x/bin/standalone.sh</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to stop WildFly, simply press Crtl-C whilst the terminal
has focus.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That&#8217;s it, WildFly is installed and running! Visit <a href="http://localhost:8080/" class="bare">http://localhost:8080/</a> to check the server has started properly.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can find the server log for standalone instances in
<code>wildfly-11.x.x.x/standalone/log/server.log</code>. The
<a href="http://docs.redhat.com/docs/en-US/JBoss_Enterprise_Application_Platform/7/html/Administration_and_Configuration_Guide/index.html">Administration and Configuration Guide for JBoss Enterprise Application Platform 7</a> or the
<a href="https://docs.jboss.org/author/display/AS71/Getting+Started+Guide">Getting Started Guide for JBoss WildFly</a>
covers more on configuring logging.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="installing-and-starting-the-jboss-server-on-windows">2.2. Installing and starting the JBoss server on Windows</h3>
<div id="GettingStarted-on_windows" class="paragraph">
<p>First, let&#8217;s verify that both Java and Maven are correctly installed. In a Command Prompt, type:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>java -version</pre>
</div>
</div>
<div class="paragraph">
<p>You should see a version string (at least <code>1.8.0</code>) printed. If not, contact your provider of Java for assistance. Next, type:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn --version</pre>
</div>
</div>
<div class="paragraph">
<p>You should see a version string (at least <code>3.3.0</code>) printed. If not, contact the Maven community for assistance.</p>
</div>
<div class="paragraph">
<p>Next, we need to choose a location for JBoss WildFly to live. By default, JBoss WildFly will be extracted into <code>wildfly-11.x.x.x</code> (where <code>11.x.x.x</code> matches the version you downloaded). Unzip JBoss Enterprise Application Platform or JBoss WildFly using your tool of choice.</p>
</div>
<div class="paragraph">
<p>Finally, let&#8217;s start JBoss WildFly in standalone mode. Locate your installation and run <code>standalone.bat</code> located in <code>bin</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to stop the server, simply press Crtl-C whilst the terminal
has focus.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That&#8217;s it, JBoss WildFly is installed and running! Visit <a href="http://localhost:8080/" class="bare">http://localhost:8080/</a> to check the server has started properly.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can find the server log for standalone instances in
<code>wildfly-11.x.x.x/standalone/log/server.log</code>. The
<a href="http://docs.redhat.com/docs/en-US/JBoss_Enterprise_Application_Platform/7/html/Administration_and_Configuration_Guide/index.html">Administration and Configuration Guide for JBoss Enterprise Application Platform 7</a> or the
<a href="https://docs.jboss.org/author/display/WFLY/Getting+Started+Guide">Getting Started Guide for JBoss WildFly</a>
covers more on configuring logging.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="starting-the-jboss-server-from-jbds-or-eclipse-with-jboss-tools">2.3. Starting the JBoss server from JBDS or Eclipse with JBoss Tools</h3>
<div id="GettingStarted-with_jboss_tools" class="paragraph">
<p>You may choose to use JBoss Developer Studio, or Eclipse with JBoss Tools, rather than the command line to run JBoss WildFly, and to deploy the quickstarts. If you don&#8217;t wish to use Eclipse, you should skip this section.</p>
</div>
<div class="paragraph">
<p>Make sure you have installed and started JBoss Developer Studio or Eclipse. First, we need to add our WildFly instance to it. First, navigate to <em>Preferences</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Detect_Servers_1.png" alt="Eclipse Detect Servers 1"></span></p>
</div>
<div class="paragraph">
<p>Now, locate the <em>JBoss Tools Runtime Detection</em> preferences:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Detect_Servers_2.png" alt="Eclipse Detect Servers 2"></span></p>
</div>
<div class="paragraph">
<p>Click <em>Add</em> and locate where you put servers on your disk:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Detect_Servers_3.png" alt="Eclipse Detect Servers 3"></span></p>
</div>
<div class="paragraph">
<p>Any available servers will be located, now all you need to do is click <em>OK</em>, and then <em>OK</em> on the preferences dialog:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Detect_Servers_4.png" alt="Eclipse Detect Servers 4"></span></p>
</div>
<div class="paragraph">
<p>Now, let&#8217;s start the server from Eclipse. If you previously started a server from the command line, you should stop it there first.</p>
</div>
<div class="paragraph">
<p>First, we need to make sure the Server tab is on view. Open the <em>Window &#8594; Show View &#8594; Other&#8230;&#8203;</em> dialog:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Server_Tab_1.jpg" alt="Eclipse Server Tab 1"></span></p>
</div>
<div class="paragraph">
<p>And select the Server view:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Server_Tab_2.jpg" alt="Eclipse Server Tab 2"></span></p>
</div>
<div class="paragraph">
<p>You should see the Server View appear with the detected servers:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Server_Tab_3.jpg" alt="Eclipse Server Tab 3"></span></p>
</div>
<div class="paragraph">
<p>Now, we can start the server. Right click on the server in the Server view, and select Start :</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Server_Start_1.jpg" alt="Eclipse Server Start 1"></span></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to debug your application, you can simply select Debug
rather than Start . This will start the server in debug mode, and
automatically attach the Eclipse debugger.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You&#8217;ll see the server output in the Console :</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Server_Start_2.jpg" alt="Eclipse Server Start 2"></span></p>
</div>
<div class="paragraph">
<p>That&#8217;s it, we now have the server up and running in Eclipse!</p>
</div>
</div>
<div class="sect2">
<h3 id="importing-the-quickstarts-into-eclipse">2.4. Importing the quickstarts into Eclipse</h3>
<div id="GettingStarted-importing_quickstarts_into_eclipse" class="paragraph">
<p>In order to import the quickstarts into Eclipse, you will need m2eclipse installed. If you have JBoss Developer Studio, then m2eclipse is already installed.</p>
</div>
<div class="paragraph">
<p>First, choose <em>File &#8594; Import&#8230;&#8203;</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Import_Quickstarts_1.jpg" alt="Import Quickstarts 1"></span></p>
</div>
<div class="paragraph">
<p>Select <em>Existing Maven Projects</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Import_Quickstarts_2.jpg" alt="Import Quickstarts 2"></span></p>
</div>
<div class="paragraph">
<p>Click on <em>Browse</em>, and navigate to the <code>quickstarts/</code> directory:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Import_Quickstarts_3.jpg" alt="Import Quickstarts 3"></span></p>
</div>
<div class="paragraph">
<p>Finally, make sure all 4 quickstarts are found and selected, and click <em>Finish</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Import_Quickstarts_4.jpg" alt="Import Quickstarts 4"></span></p>
</div>
<div class="paragraph">
<p>Eclipse should now successfully import 4 projects:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Import_Quickstarts_5.jpg" alt="Import Quickstarts 5"></span></p>
</div>
<div class="paragraph">
<p>It will take a short time to import the projects, as Maven needs to download the project&#8217;s dependencies from remote repositories.</p>
</div>
</div>
<div class="sect2">
<h3 id="managing-jboss-wildfly">2.5. Managing JBoss WildFly</h3>
<div class="paragraph">
<p>Here we will quickly outline how you can access both the command line interface and the web management interface for managing JBoss WildFly. Detailed information for both can be found in the <a href="http://docs.redhat.com/docs/en-US/JBoss_Enterprise_Application_Platform/6/html/Administration_and_Configuration_Guide/index.html">Administration and Configuration Guide for JBoss Enterprise Application Platform 6</a> or the <a href="https://docs.jboss.org/author/display/WFLY/Admin+Guide">Admin Guide for JBoss WildFly</a>.</p>
</div>
<div class="paragraph">
<p>When the server is running, the web management interface can be accessed at <a href="http://localhost:9990/console" class="bare">http://localhost:9990/console</a>. You can use the web management interface to create datasources, manage deployments and configure the server.</p>
</div>
<div class="paragraph">
<p>JBoss WildFly also comes with a command line interface. To run it on Linux, Unix or Mac, execute:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>wildfly-11.x.x.x/bin/jboss-admin.sh --connect</pre>
</div>
</div>
<div class="paragraph">
<p>Or, on Windows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>wildfly-11.x.x.x/bin/jboss-admin.bat --connect</pre>
</div>
</div>
<div class="paragraph">
<p>Once started, type help to discover the commands available to you.</p>
</div>
<div class="paragraph">
<p>Throughout this guide we use the <code>wildfly</code> maven plugin to deploy and undeploy applications. This plugin uses the Native Java Detyped Management API to communicate with the server. The Detyped API is used by management tools to control an entire domain of servers, and exposes only a small number of types, allowing for backwards and forwards compatibility.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdi-servlet-helloworld-quickstart">3. CDI + Servlet: Helloworld quickstart</h2>
<div class="sectionbody">
<div id="HelloworldQuickstart-" class="paragraph">
<p>This quickstart shows you how to deploy a simple servlet to JBoss WildFly. The business logic is encapsulated in a service, which is provided as a CDI bean, and injected into the Servlet.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Contexts and Dependency Injection for Java EE</div>
<div class="paragraph">
<p>CDI is a new specification in Java EE 6, inspired by JBoss Seam and
Google Guice, and also drawing on lessons learned from frameworks such
as Spring. It allows application developers to concentrate on developing
their application logic by providing the ability to wire services
together, and abstract out orthogonal concerns, all in a type safe
manner.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Switch to the <code>quickstarts/helloworld</code> directory and instruct Maven to build and deploy the application:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn package wildfly:deploy</pre>
</div>
</div>
<div class="paragraph">
<p>The quickstart uses a Maven plugin to deploy the application. The plugin requires JBoss WildFly to be running (you can find out how to start the server in <a href="#GettingStarted-on_linux">Installing and starting the JBoss server on Linux, Unix or Mac OS X</a> or <a href="#GettingStarted-on_windows">Installing and starting the JBoss server on Windows</a>).</p>
</div>
<div class="paragraph">
<p>Now, check if the application has deployed properly by clicking <a href="http://localhost:8080/wildfly-helloworld/HelloWorld" class="bare">http://localhost:8080/wildfly-helloworld/HelloWorld</a>. If you see a "Hello World" message it&#8217;s all working!</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Should you wish to undeploy the quickstart, or redeploy after making
some changes, it&#8217;s pretty easy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mvn wildfly:deploy</code> - deploy any changes to the application to the
application server</p>
</li>
<li>
<p><code>mvn wildfly:undeploy</code> - undeploy the quickstart</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It&#8217;s time to pull the covers back and dive into the internals of the quickstart.</p>
</div>
<div class="sect2">
<h3 id="deploying-the-helloworld-quickstart-using-jboss-developer-studio-or-eclipse-with-jboss-tools">3.1. Deploying the Helloworld quickstart using JBoss Developer Studio, or Eclipse with JBoss Tools</h3>
<div class="paragraph">
<p>You may choose to deploy the quickstart using JBoss Developer Studio, or Eclipse with JBoss Tools. You&#8217;ll need to have JBoss WildFly started in the IDE (as described  in <a href="#GettingStarted-with_jboss_tools">Starting the JBoss server from JBDS or Eclipse with JBoss Tools</a>) and to have imported the quickstarts into Eclipse (as described in <a href="#GettingStarted-importing_quickstarts_into_eclipse">Importing the quickstarts into Eclipse</a>).</p>
</div>
<div class="paragraph">
<p>With the quickstarts imported, you can deploy the quickstart by right clicking on the <code>wildfly-helloworld</code> project, and choosing <em>Run As &#8594; Run On Server</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Helloworld_Deploy_1.jpg" alt="Eclipse Helloworld Deploy 1"></span></p>
</div>
<div class="paragraph">
<p>Make sure the correct server is selected, and hit Finish:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Deploy_2.jpg" alt="Eclipse Deploy 2"></span></p>
</div>
<div class="paragraph">
<p>You should see the server start up (unless you already started it in <a href="#GettingStarted-with_jboss_tools">Starting the JBoss server from JBDS or Eclipse with JBoss Tools</a>) and the application deploy in the Console log</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Helloworld_Deploy_3.jpg" alt="Eclipse Helloworld Deploy 3"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="the-helloworld-quickstart-in-depth">3.2. The helloworld quickstart in depth</h3>
<div class="paragraph">
<p>The quickstart is very simple - all it does is print "Hello World" onto a web page.</p>
</div>
<div class="paragraph">
<p>The helloworld quickstart is comprised of a servlet and a CDI bean. We also include an empty <code>beans.xml</code> file, which tells JBoss WildFly to look for beans in this application and to activate the CDI. <code>beans.xml</code> is located in <code>WEB-INF/</code>, which can be found in the <code>src/main/webapp</code> directory. Also in this directory we include <code>index.html</code> which uses a simple meta refresh to send the users browser to the Servlet, which is located at <a href="http://localhost:8080/wildfly-helloworld/HelloWorld" class="bare">http://localhost:8080/wildfly-helloworld/HelloWorld</a>.</p>
</div>
<div class="paragraph">
<p>All the configuration files for this quickstart are located in <code>WEB-INF/</code>, which can be found in the <code>src/main/webapp</code> directory.</p>
</div>
<div class="paragraph">
<p>Notice that we don&#8217;t even need a <code>web.xml</code>!</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start by taking a look at the servlet:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/helloworld/HelloWorldServlet.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">serial</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@WebServlet</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/HelloWorld</span><span class="delimiter">&quot;</span></span>)                                           <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloWorldServlet</span> <span class="directive">extends</span> HttpServlet {

   <span class="directive">static</span> <span class="predefined-type">String</span> PAGE_HEADER =
       <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;html&gt;&lt;head&gt;&lt;title&gt;helloworld&lt;/title&gt;&lt;/head&gt;&lt;body&gt;</span><span class="delimiter">&quot;</span></span>;                <i class="conum" data-value="2"></i><b>(2)</b>

   <span class="directive">static</span> <span class="predefined-type">String</span> PAGE_FOOTER = <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;/body&gt;&lt;/html&gt;</span><span class="delimiter">&quot;</span></span>;

   <span class="annotation">@Inject</span>
   HelloService helloService;                                        <i class="conum" data-value="3"></i><b>(3)</b>

   <span class="annotation">@Override</span>
   <span class="directive">protected</span> <span class="type">void</span> doGet(HttpServletRequest req,
                        HttpServletResponse resp)
                        <span class="directive">throws</span> ServletException, <span class="exception">IOException</span> {
      resp.setContentType(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/html</span><span class="delimiter">&quot;</span></span>);
      <span class="predefined-type">PrintWriter</span> writer = resp.getWriter();
      writer.println(PAGE_HEADER);
      writer.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;h1&gt;</span><span class="delimiter">&quot;</span></span> +
                     helloService.createHelloMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">World</span><span class="delimiter">&quot;</span></span>) +      <i class="conum" data-value="4"></i><b>(4)</b>
                     <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;/h1&gt;</span><span class="delimiter">&quot;</span></span>);
      writer.println(PAGE_FOOTER);
      writer.close();
   }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If you&#8217;ve used Servlet before, then you&#8217;ll remember having to use xml to register your servlets. Fortunately, this is a thing of the past. Now all you need to do is add the @WebServlet annotation, and provide a mapping to a URL used to access the servlet. Much cleaner!</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Every web page needs to be correctly formed HTML. We&#8217;ve created static Strings to hold the minimum header and footer to write out.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We inject the HelloService (a CDI bean) which generates the actual message. This allows to alter the implementation of HelloService at a later date without changing the view layer at all (assuming we don&#8217;t alter the API of HelloService ).</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We call into the service to generate the message "Hello World", and write it out to the HTTP request.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The package declaration and imports have been excluded from these
listings. The complete listing is available in the quickstart source.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now we understand how the information is sent to the browser, let&#8217;s take a look at the service.</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/helloworld/HelloService.java</div>
<div class="content">
<pre>public class HelloService {

   String createHelloMessage(String name) {
      return "Hello " + name + "!";
   }

}</pre>
</div>
</div>
<div class="paragraph">
<p>The service is very simple - no registration (XML or annotation) is required!</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdi-jsf-numberguess-quickstart">4. CDI + JSF: Numberguess quickstart</h2>
<div class="sectionbody">
<div id="NumberguessQuickstart-" class="paragraph">
<p>This quickstart shows you how to create and deploy a simple application to JBoss WildFly; the application does not persist any information. Information is displayed using a JSF view, and business logic is encapsulated in two CDI beans.</p>
</div>
<div class="paragraph">
<p>Switch to the <code>quickstarts/numberguess</code> directory and instruct Maven to build and deploy the application:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn package wildfly:deploy</pre>
</div>
</div>
<div class="paragraph">
<p>The quickstart uses a Maven plugin to deploy the application. The plugin requires JBoss WildFly to be running (you can find out how to start the server in <a href="#GettingStarted-on_linux">Installing and starting the JBoss server on Linux, Unix or Mac OS X</a> or <a href="#GettingStarted-on_windows">Installing and starting the JBoss server on Windows</a>).</p>
</div>
<div class="paragraph">
<p>Or you can start the server using an IDE, like JBoss Developer Studio.</p>
</div>
<div class="paragraph">
<p>Now, see if you can determine the most efficient approach to pinpoint the random number at the URL <a href="http://localhost:8080/wildfly-numberguess" class="bare">http://localhost:8080/wildfly-numberguess</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Should you wish to undeploy the quickstart, or redeploy after making
some changes, it&#8217;s pretty easy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mvn wildfly:deploy</code> - deploy any changes to the application to the
application server</p>
</li>
<li>
<p><code>mvn wildfly:undeploy</code> - undeploy the quickstart</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It&#8217;s time to pull the covers back and dive into the internals of the quickstart.</p>
</div>
<div class="sect2">
<h3 id="deploying-the-numberguess-quickstart-using-eclipse">4.1. Deploying the Numberguess quickstart using Eclipse</h3>
<div class="paragraph">
<p>You may choose to deploy the quickstart using Eclipse. You&#8217;ll need to have JBoss WildFly started in Eclipse as described  in <a href="#GettingStarted-with_jboss_tools">Starting the JBoss server from JBDS or Eclipse with JBoss Tools</a>) and to have imported the quickstarts into Eclipse (as described in <a href="#GettingStarted-importing_quickstarts_into_eclipse">Importing the quickstarts into Eclipse</a>).</p>
</div>
<div class="paragraph">
<p>With the quickstarts imported, you can deploy the quickstart by right clicking on the <code>wildfly-numberguess</code> project, and choosing <em>Run As &#8594; Run On Server</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Numberguess_Deploy_1.jpg" alt="Eclipse Numberguess Deploy 1"></span></p>
</div>
<div class="paragraph">
<p>Make sure the correct server is selected, and hit Finish:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Deploy_2.jpg" alt="Eclipse Deploy 2"></span></p>
</div>
<div class="paragraph">
<p>You should see the server start up (unless you already started it in <a href="#GettingStarted-with_jboss_tools">Starting the JBoss server from JBDS or Eclipse with JBoss Tools</a>) and the application deploy in the Console log:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Numberguess_Deploy_3.jpg" alt="Eclipse Numberguess Deploy 3"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="the-numberguess-quickstart-in-depth">4.2. The numberguess quickstart in depth</h3>
<div class="paragraph">
<p>In the numberguess application you get 10 attempts to guess a number between 1 and 100. After each attempt, you&#8217;re told whether your guess was too high or too low.</p>
</div>
<div class="paragraph">
<p>The quickstart is comprised of a number of beans, configuration files and Facelets (JSF) views, packaged as a war module. Let&#8217;s start by examining the configuration files.</p>
</div>
<div class="paragraph">
<p>All the configuration files for this quickstart are located in <code>WEB-INF/</code>, which can be found in the <code>src/main/webapp</code> directory. First, we have the JSF 2.0 version of <code>faces-config.xml</code>. A standardized version of Facelets is the default view handler in JSF 2.0, so there&#8217;s really nothing that we have to configure. WildFly goes above and beyond Java EE here, and will automatically configure JSF for you if you include this file. Thus, the configuration consists of only the root element.</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/faces-config.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;faces-config</span> <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2.0</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/xml/ns/javaee</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span>
      <span class="content">http://java.sun.com/xml/ns/javaee</span>
      <span class="content">http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

<span class="tag">&lt;/faces-config&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There&#8217;s also an empty <code>beans.xml</code> file, which tells WildFly to look for beans in this  application and to activate the CDI.</p>
</div>
<div class="paragraph">
<p>Notice that we don&#8217;t even need a <code>web.xml</code>!</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at the main JSF view, <code>src/main/webapp/home.xhtml</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>JSF uses the .xhtml extension for source files, but serves up the
rendered views with the .jsf extension.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/home.xhtml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="doctype">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
   &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/1999/xhtml</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xmlns:ui</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/facelets</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xmlns:h</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/html</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xmlns:f</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/core</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

<span class="tag">&lt;head&gt;</span>
<span class="tag">&lt;meta</span> <span class="attribute-name">http-equiv</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text/html;</span>
    <span class="content">charset=iso-8859-1</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;title&gt;</span>numberguess<span class="tag">&lt;/title&gt;</span>
<span class="tag">&lt;/head&gt;</span>

<span class="tag">&lt;body&gt;</span>
   <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;h1&gt;</span>Guess a number...<span class="tag">&lt;/h1&gt;</span>
      <span class="tag">&lt;h:form</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">numberGuess</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

         <span class="comment">&lt;!-- Feedback for the user on their guess --&gt;</span>
         <span class="tag">&lt;div</span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">color</span>: <span class="value">red</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>                                    <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="tag">&lt;h:messages</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">messages</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">globalOnly</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;h:outputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Higher</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Higher!</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">rendered</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{game.number gt game.guess and game.guess ne 0}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;h:outputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Lower</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Lower!</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">rendered</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{game.number lt game.guess and game.guess ne 0}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
         <span class="tag">&lt;/div&gt;</span>

         <span class="comment">&lt;!-- Instructions for the user --&gt;</span>
         <span class="tag">&lt;div&gt;</span>                                                       <i class="conum" data-value="2"></i><b>(2)</b>
            I'm thinking of a number between <span class="tag">&lt;span</span>
               <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">numberGuess:smallest</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>#{game.smallest}<span class="tag">&lt;/span&gt;</span> and <span class="tag">&lt;span</span>
               <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">numberGuess:biggest</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>#{game.biggest}<span class="tag">&lt;/span&gt;</span>. You have
            #{game.remainingGuesses} guesses remaining.
         <span class="tag">&lt;/div&gt;</span>

         <span class="comment">&lt;!-- Input box for the users guess, plus a button to submit, and reset --&gt;</span>
         <span class="comment">&lt;!-- These are bound using EL to our CDI beans --&gt;</span>
         <span class="tag">&lt;div&gt;</span>
            Your guess:                                              <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">inputGuess</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{game.guess}</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">required</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">disabled</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{game.number eq game.guess}</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">validator</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{game.validateNumberRange}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>            <i class="conum" data-value="4"></i><b>(4)</b>
            <span class="tag">&lt;h:commandButton</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">guessButton</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Guess</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{game.check}</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">disabled</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{game.number eq game.guess}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
         <span class="tag">&lt;/div&gt;</span>
         <span class="tag">&lt;div&gt;</span>                                                       <i class="conum" data-value="5"></i><b>(5)</b>
            <span class="tag">&lt;h:commandButton</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">restartButton</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Reset</span><span class="delimiter">&quot;</span></span>
               <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{game.reset}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">immediate</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
         <span class="tag">&lt;/div&gt;</span>
      <span class="tag">&lt;/h:form&gt;</span>

   <span class="tag">&lt;/div&gt;</span>

   <span class="tag">&lt;br</span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">clear</span>: <span class="value">both</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>

<span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>There are a number of messages which can be sent to the user, "Higher!" and "Lower!"</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>As the user guesses, the range of numbers they can guess gets smaller - this sentence changes to make sure they know the number range of a valid guess.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This input field is bound to a bean property using a value expression.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>A validator binding is used to make sure the user doesn&#8217;t accidentally input a number outside of the range in which they can guess - if the validator wasn&#8217;t here, the user might use up a guess on an out of bounds number.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>There must be a way for the user to send their guess to the server. Here we bind to an action method on the bean.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The quickstart consists of 4 classes, the first two of which are qualifiers.  First, there is the <code>@Random</code> qualifier, used for injecting a random number:</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A <em>qualifier</em> is used to disambiguate between two beans both of which
are eligible for injection based on their type. For more, see the
<a href="http://docs.jboss.org/weld/reference/latest/en-US/html/">Weld Reference Guide</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/numberguess/Random.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({ TYPE, METHOD, PARAMETER, FIELD })
<span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Documented</span>
<span class="annotation">@Qualifier</span>
<span class="directive">public</span> <span class="annotation">@interface</span> <span class="predefined-type">Random</span> {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is also the <code>@MaxNumber</code> qualifier, used for injecting the maximum number that can be injected:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/numberguess/MaxNumber.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Documented</span>
<span class="annotation">@Qualifier</span>
<span class="directive">public</span> <span class="annotation">@interface</span> MaxNumber {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The application-scoped <code>Generator</code> class is responsible for creating the random number, via a producer method. It also exposes the maximum possible number via a producer method:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/numberguess/Generator.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">serial</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@ApplicationScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Generator</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

   <span class="directive">private</span> java.util.Random random = <span class="keyword">new</span> java.util.Random(<span class="predefined-type">System</span>.currentTimeMillis());

   <span class="directive">private</span> <span class="type">int</span> maxNumber = <span class="integer">100</span>;

   java.util.Random getRandom() {
      <span class="keyword">return</span> random;
   }

   <span class="annotation">@Produces</span>
   <span class="annotation">@Random</span>
   <span class="type">int</span> next() {
      <span class="comment">// a number between 1 and 100</span>
      <span class="keyword">return</span> getRandom().nextInt(maxNumber - <span class="integer">1</span>) + <span class="integer">1</span>;
   }

   <span class="annotation">@Produces</span>
   <span class="annotation">@MaxNumber</span>
   <span class="type">int</span> getMaxNumber() {
      <span class="keyword">return</span> maxNumber;
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Generator</code> is application scoped, so we don&#8217;t get a different random each time.</p>
</div>
<div class="paragraph">
<p>The final bean in the application is the session-scoped <code>Game</code> class. This is the primary entry point of the application. It&#8217;s responsible for setting up or resetting the game, capturing and validating the user&#8217;s guess and providing feedback to the user with a <code>FacesMessage</code>. We&#8217;ve used the post-construct lifecycle method to initialize the game by retrieving a random number from the <code>@RandomInstance&lt;Integer&gt;</code> bean.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll notice that we&#8217;ve also added the <code>@Named</code> annotation to this class. This annotation is only required when you want to make the bean accessible to a JSF view via EL (i.e. <code>#{game}</code>)</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/numberguess/Game.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">serial</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Named</span>
<span class="annotation">@SessionScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Game</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

   <span class="comment">/**
    * The number that the user needs to guess
    */</span>
   <span class="directive">private</span> <span class="type">int</span> number;

   <span class="comment">/**
    * The users latest guess
    */</span>
   <span class="directive">private</span> <span class="type">int</span> guess;

   <span class="comment">/**
    * The smallest number guessed so far (so we can track the valid guess range).
    */</span>
   <span class="directive">private</span> <span class="type">int</span> smallest;

   <span class="comment">/**
    * The largest number guessed so far
    */</span>
   <span class="directive">private</span> <span class="type">int</span> biggest;

   <span class="comment">/**
    * The number of guesses remaining
    */</span>
   <span class="directive">private</span> <span class="type">int</span> remainingGuesses;

   <span class="comment">/**
    * The maximum number we should ask them to guess
    */</span>
   <span class="annotation">@Inject</span>
   <span class="annotation">@MaxNumber</span>
   <span class="directive">private</span> <span class="type">int</span> maxNumber;

   <span class="comment">/**
    * The random number to guess
    */</span>
   <span class="annotation">@Inject</span>
   <span class="annotation">@Random</span>
   Instance&lt;<span class="predefined-type">Integer</span>&gt; randomNumber;

   <span class="directive">public</span> Game() {
   }

   <span class="directive">public</span> <span class="type">int</span> getNumber() {
      <span class="keyword">return</span> number;
   }

   <span class="directive">public</span> <span class="type">int</span> getGuess() {
      <span class="keyword">return</span> guess;
   }

   <span class="directive">public</span> <span class="type">void</span> setGuess(<span class="type">int</span> guess) {
      <span class="local-variable">this</span>.guess = guess;
   }

   <span class="directive">public</span> <span class="type">int</span> getSmallest() {
      <span class="keyword">return</span> smallest;
   }

   <span class="directive">public</span> <span class="type">int</span> getBiggest() {
      <span class="keyword">return</span> biggest;
   }

   <span class="directive">public</span> <span class="type">int</span> getRemainingGuesses() {
      <span class="keyword">return</span> remainingGuesses;
   }

   <span class="comment">/**
    * Check whether the current guess is correct, and update the biggest/smallest guesses as needed.
    * Give feedback to the user if they are correct.
    */</span>
   <span class="directive">public</span> <span class="type">void</span> check() {
      <span class="keyword">if</span> (guess &gt; number) {
         biggest = guess - <span class="integer">1</span>;
      } <span class="keyword">else</span> <span class="keyword">if</span> (guess &lt; number) {
         smallest = guess + <span class="integer">1</span>;
      } <span class="keyword">else</span> <span class="keyword">if</span> (guess == number) {
         FacesContext.getCurrentInstance().addMessage(<span class="predefined-constant">null</span>, <span class="keyword">new</span> FacesMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">Correct!</span><span class="delimiter">&quot;</span></span>));
      }
      remainingGuesses--;
   }

   <span class="comment">/**
    * Reset the game, by putting all values back to their defaults, and getting a new random number.
    * We also call this method when the user starts playing for the first time using
    * {@linkplain PostConstruct @PostConstruct} to set the initial values.
    */</span>
   <span class="annotation">@PostConstruct</span>
   <span class="directive">public</span> <span class="type">void</span> reset() {
      <span class="local-variable">this</span>.smallest = <span class="integer">0</span>;
      <span class="local-variable">this</span>.guess = <span class="integer">0</span>;
      <span class="local-variable">this</span>.remainingGuesses = <span class="integer">10</span>;
      <span class="local-variable">this</span>.biggest = maxNumber;
      <span class="local-variable">this</span>.number = randomNumber.get();
   }

   <span class="comment">/**
    * A JSF validation method which checks whether the guess is valid. It might not be valid because
    * there are no guesses left, or because the guess is not in range.
    *
    */</span>
   <span class="directive">public</span> <span class="type">void</span> validateNumberRange(FacesContext context, UIComponent toValidate, <span class="predefined-type">Object</span> value) {
      <span class="keyword">if</span> (remainingGuesses &lt;= <span class="integer">0</span>) {
         FacesMessage message = <span class="keyword">new</span> FacesMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">No guesses left!</span><span class="delimiter">&quot;</span></span>);
         context.addMessage(toValidate.getClientId(context), message);
         ((UIInput) toValidate).setValid(<span class="predefined-constant">false</span>);
         <span class="keyword">return</span>;
      }
      <span class="type">int</span> input = (<span class="predefined-type">Integer</span>) value;

      <span class="keyword">if</span> (input &lt; smallest || input &gt; biggest) {
         ((UIInput) toValidate).setValid(<span class="predefined-constant">false</span>);

         FacesMessage message = <span class="keyword">new</span> FacesMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">Invalid guess</span><span class="delimiter">&quot;</span></span>);
         context.addMessage(toValidate.getClientId(context), message);
      }
   }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdi-jpa-ejb-jta-jsf-greeter-quickstart">5. CDI + JPA + EJB + JTA + JSF: Greeter quickstart</h2>
<div class="sectionbody">
<div id="GreeterQuickstart-" class="paragraph">
<p>This quickstart shows you how to create and deploy an application which persists information to a database to JBoss WildFly. Information is displayed using JSF views, business logic is encapsulated in CDI beans, information is persisted using JPA, and transactions can be controlled manually or using EJB.</p>
</div>
<div class="paragraph">
<p>Switch to the <code>quickstarts/greeter</code> directory and instruct Maven to build and deploy the application:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn package wildfly:deploy</pre>
</div>
</div>
<div class="paragraph">
<p>The quickstart uses a Maven plugin to deploy the application. The plugin requires JBoss WildFly to be running (you can find out how to start the server in <a href="#GettingStarted-on_linux">Installing and starting the JBoss server on Linux, Unix or Mac OS X</a> or <a href="#GettingStarted-on_windows">Installing and starting the JBoss server on Windows</a>).</p>
</div>
<div class="paragraph">
<p>Or you can start the server using an IDE, like JBoss Developer Studio. If you are using JBoss Developer Studio, you can deploy the quickstart by right clicking on the <code>greeter</code> project, and choosing <em>Run As &#8594; Run On Server</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Greeter_Deploy_1.png" alt="Eclipse Greeter Deploy 1"></span></p>
</div>
<div class="paragraph">
<p>Make sure the server is selected, and hit Finish:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Deploy_2.jpg" alt="Eclipse Deploy 2"></span></p>
</div>
<div class="paragraph">
<p>You should see the server start up (unless you already started it in <a href="#GettingStarted-with_jboss_tools">Starting the JBoss server from JBDS or Eclipse with JBoss Tools</a>) and the application deploy in the Console log:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Greeter_Deploy_3.png" alt="Eclipse Greeter Deploy 3"></span></p>
</div>
<div class="paragraph">
<p>To use the application, visit <a href="http://localhost:8080/greeter/" class="bare">http://localhost:8080/greeter/</a>.</p>
</div>
<div class="sect2">
<h3 id="greeter_in_depth">5.1. The greeter quickstart in depth</h3>
<div class="paragraph">
<p>In the quickstart, all users are stored in an H2 database (an in-memory, embedded database provided out of the box in JBoss WildFly). Each user is stored as an entity, and entities are mapped to the database using JPA. By default, transactions are managed manually, using the JTA API. Optionally, you can use EJB to manage transactions (we&#8217;ll look at how to enable that later). We need a transaction in progress in order to read and write any entities.</p>
</div>
<div class="paragraph">
<p>The quickstart is comprised of two JSF views, an entity, and a number of CDI beans. Additionally, there are the usual configuration files in <code>WEB-INF/</code> (which can be found in the <code>src/main/webapp</code> directory). Here we find <code>beans.xml</code> and <code>faces-config.xml</code> which tell JBoss WildFly to enable CDI and JSF for the application. Notice that we don&#8217;t need a <code>web.xml</code>. There are two new configuration files in <code>WEB-INF/classes/META-INF</code> (which can be found in the <code>src/main/resources</code> directory of the quickstart)  <code>persistence.xml</code>, which sets up JPA, and <code>import.sql</code> which Hibernate, the JPA provider in  JBoss WildFly, will use to load the initial users into the application when the application starts.</p>
</div>
<div class="paragraph">
<p><code>persistence.xml</code> is pretty straight forward, and links JPA to a datasource:</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/META-INF/persistence.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;persistence</span> <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2.0</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/xml/ns/persistence</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span>
        <span class="content">http://java.sun.com/xml/ns/persistence</span>
        <span class="content">http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">primary</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>                                <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="comment">&lt;!-- If you are running in a production environment, add a
             managed  data source, this example data source is just
             for development and testing! --&gt;</span>
        <span class="comment">&lt;!-- The datasource is deployed as
             WEB-INF/greeter-quickstart-ds.xml, you can find it in
             the source at
             src/main/webapp/WEB-INF/greeter-quickstart-ds.xml --&gt;</span>
        <span class="tag">&lt;jta-data-source&gt;</span>
            java:jboss/datasources/GreeterQuickstartDS               <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="tag">&lt;/jta-data-source&gt;</span>
        <span class="tag">&lt;properties&gt;</span>
            <span class="comment">&lt;!-- Properties for Hibernate --&gt;</span>                        <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hibernate.hbm2ddl.auto</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">create-drop</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hibernate.show_sql</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;/properties&gt;</span>
    <span class="tag">&lt;/persistence-unit&gt;</span>
<span class="tag">&lt;/persistence&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The persistence unit is given a name, so that the application can use multiple if needed. If only one is defined, JPA will automatically use it.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The persistence unit references a data source. Here we are using the built in, sample, data source.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>JPA allows us to configure the JPA provider specific properties. Here we tell Hibernate to automatically create any needed tables when the application starts (and drop them when the application is stopped).</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>JBoss WildFly ships with a
sample datasource <code>java:jboss/datasources/ExampleDS</code>. This data source
is backed by H2, an in-memory database. Whilst this datasource is great
for quickstarts, you will probably want to use a different datasource in
your application. The <a href="http://docs.redhat.com/docs/en-US/JBoss_Enterprise_Application_Platform/6/html/Administration_and_Configuration_Guide/index.html">Administration and Configuration Guide for JBoss Enterprise Application Platform 6</a> or the
<a href="https://docs.jboss.org/author/display/WFLY/Getting+Started+Guide">Getting Started Guide for JBoss WildFly</a>
tells you how to create a new datasource.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at the JSF views. First up is <code>src/main/webapp/greet.xhtml</code>:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/greet.xhtml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="doctype">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;
    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/1999/xhtml</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:ui</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/facelets</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:h</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/html</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:f</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/core</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

<span class="tag">&lt;ui:composition</span> <span class="attribute-name">template</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">template.xhtml</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>                           <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;ui:define</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;h:messages</span> <span class="tag">/&gt;</span>                                               <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="tag">&lt;h:form</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">greetForm</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;h:panelGrid</span> <span class="attribute-name">columns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Enter username:<span class="tag">&lt;/h:outputLabel&gt;</span>
                <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{greetController.username}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;h:message</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;/h:panelGrid&gt;</span>
            <span class="tag">&lt;h:commandButton</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">greet</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Greet!</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{greetController.greet}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;/h:form&gt;</span>
        <span class="tag">&lt;h:outputText</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{greetController.greeting}</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">rendered</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{not empty greetController.greeting}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>      <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="tag">&lt;br</span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;h:link</span> <span class="attribute-name">outcome</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/create.xhtml</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Add a new user</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>    <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="tag">&lt;/ui:define&gt;</span>
<span class="tag">&lt;/ui:composition&gt;</span>
<span class="tag">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>As we have multiple views in this application, we&#8217;ve created a template that defines the common elements. We&#8217;ll examine this next. Here we define the "content" section of the page, which will be inserted into the template.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We output any messages for the user at the top of the form, e.g. when a new user is created.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The greeting message is only rendered if there is a message.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We also a link to the page which allows a user to be added.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now let&#8217;s take a look at the template. It defines common elements for the page, and allows pages which use it to insert content in various places.</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/template.xhtml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="comment">&lt;!-- The template for our app, defines some regions --&gt;</span>

<span class="tag">&lt;head&gt;</span>
<span class="tag">&lt;meta</span> <span class="attribute-name">http-equiv</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text/html; charset=iso-8859-1</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;title&gt;</span>greeter<span class="tag">&lt;/title&gt;</span>
<span class="tag">&lt;ui:insert</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">head</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>                                            <i class="conum" data-value="1"></i><b>(1)</b>
<span class="tag">&lt;/head&gt;</span>

<span class="tag">&lt;body&gt;</span>

    <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">container</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">header</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/div&gt;</span>

        <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sidebar</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/div&gt;</span>

        <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;ui:insert</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>                             <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="tag">&lt;/div&gt;</span>

        <span class="tag">&lt;br</span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">clear</span>: <span class="value">both</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;/div&gt;</span>

<span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The head, defined in case a page wants to add some content to the head of the page.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The content, defined by a page using this template, will be inserted here</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, let&#8217;s take a look at the user management page. It provides a form to add users:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/create.xhtml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="doctype">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/1999/xhtml</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:ui</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/facelets</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:h</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/html</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:f</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/core</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

<span class="tag">&lt;ui:composition</span> <span class="attribute-name">template</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">template.xhtml</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;ui:define</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;h:messages</span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;h:form&gt;</span>
            <span class="tag">&lt;h:panelGrid</span> <span class="attribute-name">columns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Enter username:<span class="tag">&lt;/h:outputLabel&gt;</span>
                <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{newUser.username}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;h:message</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>

                <span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Enter first name:<span class="tag">&lt;/h:outputLabel&gt;</span>
                <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{newUser.firstName}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;h:message</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstName</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>

                <span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Enter last name:<span class="tag">&lt;/h:outputLabel&gt;</span>
                <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{newUser.lastName}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;h:message</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>

            <span class="tag">&lt;/h:panelGrid&gt;</span>
            <span class="tag">&lt;h:commandButton</span> <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{createController.create}</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Add User</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;/h:form&gt;</span>
        <span class="tag">&lt;h:link</span> <span class="attribute-name">outcome</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/greet.xhtml</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Greet a user!<span class="tag">&lt;/h:link&gt;</span>
    <span class="tag">&lt;/ui:define&gt;</span>
<span class="tag">&lt;/ui:composition&gt;</span>
<span class="tag">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The quickstart has one entity, which is mapped via JPA to the relational database:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/greeter/domain/User.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Entity</span>                                                              <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">User</span> {

    <span class="annotation">@Id</span>                                                              <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="annotation">@GeneratedValue</span>
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;

    <span class="annotation">@Column</span>(unique = <span class="predefined-constant">true</span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> username;

    <span class="directive">private</span> <span class="predefined-type">String</span> firstName;                                        <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="directive">private</span> <span class="predefined-type">String</span> lastName;

    <span class="directive">public</span> <span class="predefined-type">Long</span> getId() {                                            <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="keyword">return</span> id;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getUsername() {
        <span class="keyword">return</span> username;
    }

    <span class="directive">public</span> <span class="type">void</span> setUsername(<span class="predefined-type">String</span> username) {
        <span class="local-variable">this</span>.username = username;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getFirstName() {
        <span class="keyword">return</span> firstName;
    }

    <span class="directive">public</span> <span class="type">void</span> setFirstName(<span class="predefined-type">String</span> firstName) {
        <span class="local-variable">this</span>.firstName = firstName;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getLastName() {
        <span class="keyword">return</span> lastName;
    }

    <span class="directive">public</span> <span class="type">void</span> setLastName(<span class="predefined-type">String</span> lastName) {
        <span class="local-variable">this</span>.lastName = lastName;
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@Entity</code> annotation used on the class tells JPA that this class should be mapped as a table in the database.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Every entity requires an id, the <code>@Id</code> annotation placed on a field (or a JavaBean mutator/accessor) tells JPA that this property is the id. You can use a synthetic id, or a natural id (as we do here).</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The entity also stores the real name of the user</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>As this is Java, every property needs an accessor/mutator!</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We use a couple of controller classes to back the JSF pages. First up is <code>GreetController</code> which is responsible for getting the user&#8217;s real name from persistence layer, and then constructing the message.</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/greeter/web/GreetController.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Named</span>                                                               <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@RequestScoped</span>                                                       <i class="conum" data-value="2"></i><b>(2)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">GreetController</span> {

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> UserDao userDao;                                         <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="directive">private</span> <span class="predefined-type">String</span> username;

    <span class="directive">private</span> <span class="predefined-type">String</span> greeting;

    <span class="directive">public</span> <span class="type">void</span> greet() {
        User user = userDao.getForUsername(username);
        <span class="keyword">if</span> (user != <span class="predefined-constant">null</span>) {
            greeting = <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, </span><span class="delimiter">&quot;</span></span> +
                       user.getFirstName() +
                       <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span> +
                       user.getLastName() +
                       <span class="string"><span class="delimiter">&quot;</span><span class="content">!</span><span class="delimiter">&quot;</span></span>;
        } <span class="keyword">else</span> {
            greeting =
                <span class="string"><span class="delimiter">&quot;</span><span class="content">No such user exists! Use 'emuster' or 'jdoe'</span><span class="delimiter">&quot;</span></span>;
        }
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getUsername() {                                    <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="keyword">return</span> username;
    }

    <span class="directive">public</span> <span class="type">void</span> setUsername(<span class="predefined-type">String</span> username) {
        <span class="local-variable">this</span>.username = username;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getGreeting() {
        <span class="keyword">return</span> greeting;
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The bean is given a name, so we can access it from JSF</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The bean is request scoped, a different greeting can be made in each request</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We inject the <code>UserDao</code>, which handles database abstraction</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We need to expose JavaBean style mutators and accessors for every property the JSF page needs to access to</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The second controller class is responsible for adding a new user:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/greeter/web/CreateController.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Named</span>                                                               <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@RequestScoped</span>                                                       <i class="conum" data-value="2"></i><b>(2)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">CreateController</span> {

    <span class="annotation">@Inject</span>                                                          <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="directive">private</span> FacesContext facesContext;

    <span class="annotation">@Inject</span>                                                          <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="directive">private</span> UserDao userDao;

    <span class="annotation">@Named</span>                                                           <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="annotation">@Produces</span>
    <span class="annotation">@RequestScoped</span>
    <span class="directive">private</span> User newUser = <span class="keyword">new</span> User();

    <span class="directive">public</span> <span class="type">void</span> create() {
        <span class="keyword">try</span> {
            userDao.createUser(newUser);
            <span class="predefined-type">String</span> message = <span class="string"><span class="delimiter">&quot;</span><span class="content">A new user with id </span><span class="delimiter">&quot;</span></span> +
                             newUser.getId() +
                             <span class="string"><span class="delimiter">&quot;</span><span class="content"> has been created successfully</span><span class="delimiter">&quot;</span></span>;
            facesContext.addMessage(<span class="predefined-constant">null</span>, <span class="keyword">new</span> FacesMessage(message));
        } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
            <span class="predefined-type">String</span> message = <span class="string"><span class="delimiter">&quot;</span><span class="content">An error has occured while creating</span><span class="delimiter">&quot;</span></span> +
                             <span class="string"><span class="delimiter">&quot;</span><span class="content"> the user (see log for details)</span><span class="delimiter">&quot;</span></span>;
            facesContext.addMessage(<span class="predefined-constant">null</span>, <span class="keyword">new</span> FacesMessage(message));
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The bean is given a name, so we can access it from JSF</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The bean is request scoped, a different user can be added in each request</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We inject the <code>FacesContext</code>, to allow us to send messages to the user when the user is created, or if an error occurs</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We inject the <code>UserDao</code>, which handles database abstraction</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We expose a prototype user using a named producer, which allows us to access it from a JSF page</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now that we have the controllers in place, let&#8217;s look at the most interesting part of the application, how we interact with the database. As we mentioned earlier, by default the application uses the JTA API to manually control transactions. To implement both approaches, we&#8217;ve defined a <code>UserDao</code> interface, with two implementations, one of which (the EJB variant) is as an alternative which can be enabled via a deployment descriptor. If you were wondering why we "hid" the persistence logic in the <code>UserDao</code>, rather than placing it directly in the controller classes, this is why!</p>
</div>
<div class="paragraph">
<p>Let&#8217;s first look at the interface, and the manual transaction control variant.</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/greeter/domain/UserDao.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">UserDao</span> {
    User getForUsername(<span class="predefined-type">String</span> username);

    <span class="type">void</span> createUser(User user);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The methods are fairly self explanatory, so let&#8217;s move on quickly to the implementation, <code>ManagedBeanUserDao</code>:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/greeter/domain/ManagedBeanUserDao.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ManagedBeanUserDao</span> <span class="directive">implements</span> UserDao {

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> EntityManager entityManager;                             <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> UserTransaction utx;                                     <i class="conum" data-value="2"></i><b>(2)</b>

    <span class="directive">public</span> User getForUsername(<span class="predefined-type">String</span> username) {                    <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="keyword">try</span> {
            User user;
            <span class="keyword">try</span> {
                utx.begin();
                <span class="predefined-type">Query</span> query = entityManager.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select u from User u where u.username = :username</span><span class="delimiter">&quot;</span></span>);
                query.setParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>, username);
                user = (User) query.getSingleResult();
            } <span class="keyword">catch</span> (NoResultException e) {
                user = <span class="predefined-constant">null</span>;
            }
            utx.commit();
            <span class="keyword">return</span> user;
        } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
            <span class="keyword">try</span> {
                utx.rollback();
            } <span class="keyword">catch</span> (SystemException se) {
                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(se);
            }
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(e);
        }
    }

    <span class="directive">public</span> <span class="type">void</span> createUser(User user) {                              <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="keyword">try</span> {
            <span class="keyword">try</span> {
                utx.begin();
                entityManager.persist(user);
            } <span class="keyword">finally</span> {
                utx.commit();
            }
        } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
            <span class="keyword">try</span> {
                utx.rollback();
            } <span class="keyword">catch</span> (SystemException se) {
                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(se);
            }
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(e);
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We inject the entity manager. This was set up in <code>persistence.xml</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We inject the <code>UserTransaction</code>, to allow us to programmatically control the transaction</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>getUserForUsername</code> method can check whether a user with a matching username and password exists, and return it if it does.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>createUser</code> persists a new user to the database.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You&#8217;ve probably noticed two things as you&#8217;ve read through this. Firstly, that manually managing transactions is a real pain. Secondly, you may be wondering how the entity manager and the logger are injected. First, let&#8217;s tidy up the transaction manager, and use EJB to provide us with declarative transaction support.</p>
</div>
<div class="paragraph">
<p>The class <code>EJBUserDao</code> provides this, and is defined as an alternative. Alternatives are disabled by default, and when enabled replace the original implementation. In order to enable this variant of <code>UserDao</code>, edit <code>beans.xml</code> and uncomment the alternative. Your <code>beans.xml</code> should now look like:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/beans.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;beans</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/xml/ns/javaee</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span>
        <span class="content">http://java.sun.com/xml/ns/javaee</span>
        <span class="content">http://java.sun.com/xml/ns/javaee/beans_1_0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

        <span class="comment">&lt;!-- Uncomment this alternative to see EJB declarative transactions in use --&gt;</span>
        <span class="tag">&lt;alternatives&gt;</span>
            <span class="tag">&lt;class&gt;</span>org.jboss.as.quickstarts.greeter.domain.EJBUserDao<span class="tag">&lt;/class&gt;</span>
        <span class="tag">&lt;/alternatives&gt;</span>
<span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, let&#8217;s look at <code>EJBUserDao</code>:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/greeter/domain/EJBUserDao.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Stateful</span>
<span class="annotation">@Alternative</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EJBUserDao</span> <span class="directive">implements</span> UserDao {

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> EntityManager entityManager;

    <span class="directive">public</span> User getForUsername(<span class="predefined-type">String</span> username) {
        <span class="keyword">try</span> {
            <span class="predefined-type">Query</span> query = entityManager.createQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">select u from User u where u.username = ?</span><span class="delimiter">&quot;</span></span>);
            query.setParameter(<span class="integer">1</span>, username);
            <span class="keyword">return</span> (User) query.getSingleResult();
        } <span class="keyword">catch</span> (NoResultException e) {
            <span class="keyword">return</span> <span class="predefined-constant">null</span>;
        }
    }

    <span class="directive">public</span> <span class="type">void</span> createUser(User user) {
        entityManager.persist(user);
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using declarative transaction management has allowed us to remove a third of the lines of code from the class, but more importantly emphasizes the functionality of the class. Much better!</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Sharp eyed developers who are used to Java EE will have noticed that we
have added this EJB to a war. This is the key improvement offered in
EJB 3.1 (which was first included in Java EE 6).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, let&#8217;s take a look at the <code>Resources</code> class, which provides resources such as the entity manager. CDI recommends using "resource producers", as we do in this quickstart, to alias resources to CDI beans, allowing for a  consistent style throughout our application:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/greeter/Resources.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Resources</span> {

    <span class="comment">// Expose an entity manager using the resource producer pattern</span>
    <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unused</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@PersistenceContext</span>
    <span class="annotation">@Produces</span>
    <span class="directive">private</span> EntityManager em;                                        <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="annotation">@Produces</span>
    <span class="predefined-type">Logger</span> getLogger(InjectionPoint ip) {                            <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="predefined-type">String</span> category = ip.getMember()
                            .getDeclaringClass()
                            .getName();
        <span class="keyword">return</span> <span class="predefined-type">Logger</span>.getLogger(category);
    }

    <span class="annotation">@Produces</span>
    FacesContext getFacesContext() {                                 <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="keyword">return</span> FacesContext.getCurrentInstance();
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We use the "resource producer" pattern, from CDI, to "alias" the old fashioned <code>@PersistenceContext</code> injection of the entity manager to a CDI style injection. This allows us to use a consistent injection style (<code>@Inject</code>) throughout the application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We expose a JDK logger for injection. In order to save a bit more boiler plate, we automatically set the logger category as the class name!</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We expose the <code>FacesContext</code> via a producer method, which allows it to be injected. If we were adding tests, we could also then mock it out.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That concludes our tour of the greeter application!</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdi-jsf-ejb-jta-bean-validation-jax-rs-arquillian-kitchensink-quickstart">6. CDI + JSF + EJB + JTA + Bean Validation + JAX-RS + Arquillian: Kitchensink quickstart</h2>
<div class="sectionbody">
<div id="KitchensinkQuickstart-" class="paragraph">
<p>This quickstart shows off all the new features of Java EE 6, and makes a great starting point for your project.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Bean Validation</div>
<div class="paragraph">
<p>Bean Validation is a new specification in Java EE 6, inspired by
Hibernate Validator. It allows application developers to specify
constraints once (often in their domain model), and have them applied in
all layers of the application, protecting data and giving useful
feedback to users.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">JAX-RS: The Java API for RESTful Web Services</div>
<div class="paragraph">
<p>JAX-RS is a new specification in Java EE 6. It allows application
developers to easily expose Java services as RESTful web services.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Switch to the <code>quickstarts/kitchensink</code> directory and instruct Maven to build and deploy the application:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn package wildfly:deploy</pre>
</div>
</div>
<div class="paragraph">
<p>The quickstart uses a Maven plugin to deploy the application. The plugin requires JBoss WildFly to be running (you can find out how to start the server in <a href="#GettingStarted-on_linux">Installing and starting the JBoss server on Linux, Unix or Mac OS X</a> or <a href="#GettingStarted-on_windows">Installing and starting the JBoss server on Windows</a>).</p>
</div>
<div class="paragraph">
<p>Or you can start the server using an IDE, like Eclipse.</p>
</div>
<div class="paragraph">
<p>Now, check if the application has deployed properly by clicking <a href="http://localhost:8080/wildfly-kitchensink" class="bare">http://localhost:8080/wildfly-kitchensink</a>. If you see a splash page it&#8217;s all working!</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Should you wish to undeploy the quickstart, or redeploy after making
some changes, it&#8217;s pretty easy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mvn wildfly:deploy</code> - deploy any changes to the application to the
application server</p>
</li>
<li>
<p><code>mvn wildfly:undeploy</code> - undeploy the quickstart</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It&#8217;s time to pull the covers back and dive into the internals of the application.</p>
</div>
<div class="sect2">
<h3 id="deploying-the-kitchensink-quickstart-using-jboss-developer-studio-or-eclipse-with-jboss-tools">6.1. Deploying the Kitchensink quickstart using JBoss Developer Studio, or Eclipse with JBoss Tools</h3>
<div class="paragraph">
<p>You may choose to deploy the quickstart using JBoss Developer Studio, or Eclipse with JBoss Tools. You&#8217;ll need to have JBoss WildFly started in the IDE (as described  in <a href="#GettingStarted-with_jboss_tools">Starting the JBoss server from JBDS or Eclipse with JBoss Tools</a>) and to have imported the quickstarts into Eclipse (as described in <a href="#GettingStarted-importing_quickstarts_into_eclipse">Importing the quickstarts into Eclipse</a>).</p>
</div>
<div class="paragraph">
<p>With the quickstarts imported, you can deploy the quickstart by right clicking on the <code>wildfly-kitchensink</code> project, and choosing <em>Run As &#8594; Run On Server</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_KitchenSink_Deploy_1.jpg" alt="Eclipse KitchenSink Deploy 1"></span></p>
</div>
<div class="paragraph">
<p>Make sure the server is selected, and hit Finish:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_Deploy_2.jpg" alt="Eclipse Deploy 2"></span></p>
</div>
<div class="paragraph">
<p>You should see the server start up (unless you already started it in  <a href="#GettingStarted-with_jboss_tools">Starting the JBoss server from JBDS or Eclipse with JBoss Tools</a>) and the application deploy in the Console log:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_KitchenSink_Deploy_3.jpg" alt="Eclipse KitchenSink Deploy 3"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="the-kitchensink-quickstart-in-depth">6.2. The kitchensink quickstart in depth</h3>
<div class="paragraph">
<p>The kitchensink application shows off a number of Java EE technologies such as CDI, JSF, EJB, JTA, JAX-RS and Arquillian. It does this by providing a member registration database, available via JSF and JAX-RS.</p>
</div>
<div class="paragraph">
<p>As usual, let&#8217;s start by looking at the necessary deployment descriptors. By now, we&#8217;re very used to seeing <code>beans.xml</code> and <code>faces-config.xml</code> in <code>WEB-INF/</code> (which can be found in the <code>src/main/webapp</code> directory). Notice that, once again, we don&#8217;t need a <code>web.xml</code>. There are two configuration files in <code>WEB-INF/classes/META-INF</code> (which can be found in the <code>src/main/resources</code> directory)  <code>persistence.xml</code>, which sets up JPA, and <code>import.sql</code> which Hibernate, the JPA provider in JBoss WildFly, will use to load the initial users into the application when the application starts. We discussed both of these files in detail in <a href="#GreeterQuickstart-">the Greeter Quickstart</a>, and these are largely the same.</p>
</div>
<div class="paragraph">
<p>Next, let&#8217;s take a look at the JSF view the user sees. As usual, we use a template to provide the sidebar and footer. This one lives in <code>src/main/webapp/WEB-INF/templates/default.xhtml</code>:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/templates/default.xhtml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="doctype">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;
    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/1999/xhtml</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:h</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/html</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:ui</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/facelets</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="tag">&lt;h:head&gt;</span>                                                             <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;title&gt;</span>kitchensink<span class="tag">&lt;/title&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">http-equiv</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text/html; charset=utf-8</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;h:outputStylesheet</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">css/screen.css</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/h:head&gt;</span>
<span class="tag">&lt;h:body&gt;</span>
    <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">container</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;div</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dualbrand</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;img</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">resources/gfx/dualbrand_logo.png</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;/div&gt;</span>
        <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;ui:insert</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>                               <i class="conum" data-value="2"></i><b>(2)</b>
                 [Template content will be inserted here]
            <span class="tag">&lt;/ui:insert&gt;</span>
        <span class="tag">&lt;/div&gt;</span>
        <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">aside</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>                                             <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="tag">&lt;p&gt;</span>Learn more about JBoss Enterprise Application
                Platform 6.<span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;ul&gt;</span>
                <span class="tag">&lt;li&gt;</span>
                    <span class="tag">&lt;a</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://red.ht/jbeap-6-docs</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        Documentation
                    <span class="tag">&lt;/a&gt;</span>
                <span class="tag">&lt;/li&gt;</span>
                <span class="tag">&lt;li&gt;</span>
                    <span class="tag">&lt;a</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://red.ht/jbeap-6</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        Product Information
                    <span class="tag">&lt;/a&gt;</span>
               <span class="tag">&lt;/li&gt;</span>
            <span class="tag">&lt;/ul&gt;</span>
            <span class="tag">&lt;p&gt;</span>Learn more about JBoss WildFly.<span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;ul&gt;</span>
                <span class="tag">&lt;li&gt;</span>
                    <span class="tag">&lt;a</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/jdf/quickstarts/wildfly-quickstart/guide</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        Getting Started Developing Applications Guide
                    <span class="tag">&lt;/a&gt;</span>
                <span class="tag">&lt;/li&gt;</span>
                <span class="tag">&lt;li&gt;</span>
                    <span class="tag">&lt;a</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/jbossas</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        Community Project Information
                    <span class="tag">&lt;/a&gt;</span>
                <span class="tag">&lt;/li&gt;</span>
            <span class="tag">&lt;/ul&gt;</span>
        <span class="tag">&lt;/div&gt;</span>
        <span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">footer</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;p&gt;</span>
                This project was generated from a Maven archetype from
                JBoss.<span class="tag">&lt;br</span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;/div&gt;</span>
    <span class="tag">&lt;/div&gt;</span>
<span class="tag">&lt;/h:body&gt;</span>
<span class="tag">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We have a common <code>&lt;head&gt;</code> element, where we define styles and more</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The content is inserted here, and defined by views using this template</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This application defines a common sidebar and footer, putting them in the template means we only have to define them once</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That leaves the main page, index.xhtml , in which we place the content unique to the main page:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/index.xhtml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;ui:composition</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/1999/xhtml</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:ui</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/facelets</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:f</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/core</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:h</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/jsf/html</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">template</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/WEB-INF/templates/default.xhtml</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;ui:define</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;h1&gt;</span>Welcome to JBoss!<span class="tag">&lt;/h1&gt;</span>

        <span class="tag">&lt;h:form</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">reg</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>                                            <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="tag">&lt;h2&gt;</span>Member Registration<span class="tag">&lt;/h2&gt;</span>
            <span class="tag">&lt;p&gt;</span>Enforces annotation-based constraints defined on the
                model class.<span class="tag">&lt;/p&gt;</span>
            <span class="tag">&lt;h:panelGrid</span> <span class="attribute-name">columns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">columnClasses</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">titleCell</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Name:</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{newMember.name}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>  <i class="conum" data-value="2"></i><b>(2)</b>
                <span class="tag">&lt;h:message</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">errorClass</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">invalid</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>

                <span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">email</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Email:</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">email</span><span class="delimiter">&quot;</span></span>
                             <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{newMember.email}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>           <i class="conum" data-value="2"></i><b>(2)</b>
                <span class="tag">&lt;h:message</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">email</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">errorClass</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">invalid</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>

                <span class="tag">&lt;h:outputLabel</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">phoneNumber</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Phone #:</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;h:inputText</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">phoneNumber</span><span class="delimiter">&quot;</span></span>
                             <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{newMember.phoneNumber}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>     <i class="conum" data-value="2"></i><b>(2)</b>
                <span class="tag">&lt;h:message</span> <span class="attribute-name">for</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">phoneNumber</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">errorClass</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">invalid</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
            <span class="tag">&lt;/h:panelGrid&gt;</span>

            <span class="tag">&lt;p&gt;</span>
                <span class="tag">&lt;h:panelGrid</span> <span class="attribute-name">columns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;h:commandButton</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">register</span><span class="delimiter">&quot;</span></span>
                        <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{memberController.register}</span><span class="delimiter">&quot;</span></span>
                        <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Register</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">styleClass</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">register</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                    <span class="tag">&lt;h:messages</span> <span class="attribute-name">styleClass</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">messages</span><span class="delimiter">&quot;</span></span>
                        <span class="attribute-name">errorClass</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">invalid</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">infoClass</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">valid</span><span class="delimiter">&quot;</span></span>
                        <span class="attribute-name">warnClass</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">warning</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">globalOnly</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;/h:panelGrid&gt;</span>
            <span class="tag">&lt;/p&gt;</span>
        <span class="tag">&lt;/h:form&gt;</span>
        <span class="tag">&lt;h2&gt;</span>Members<span class="tag">&lt;/h2&gt;</span>
        <span class="tag">&lt;h:panelGroup</span> <span class="attribute-name">rendered</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{empty members}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;em&gt;</span>No registered members.<span class="tag">&lt;/em&gt;</span>
        <span class="tag">&lt;/h:panelGroup&gt;</span>
        <span class="tag">&lt;h:dataTable</span> <span class="attribute-name">var</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">_member</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{members}</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">rendered</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{not empty members}</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">styleClass</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">simpletablestyle</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>                           <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="tag">&lt;h:column&gt;</span>
                <span class="tag">&lt;f:facet</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">header</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Id<span class="tag">&lt;/f:facet&gt;</span>
                #{_member.id}
            <span class="tag">&lt;/h:column&gt;</span>
            <span class="tag">&lt;h:column&gt;</span>
                <span class="tag">&lt;f:facet</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">header</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Name<span class="tag">&lt;/f:facet&gt;</span>
                #{_member.name}
            <span class="tag">&lt;/h:column&gt;</span>
            <span class="tag">&lt;h:column&gt;</span>
                <span class="tag">&lt;f:facet</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">header</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Email<span class="tag">&lt;/f:facet&gt;</span>
                #{_member.email}
            <span class="tag">&lt;/h:column&gt;</span>
            <span class="tag">&lt;h:column&gt;</span>
                <span class="tag">&lt;f:facet</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">header</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Phone #<span class="tag">&lt;/f:facet&gt;</span>
                #{_member.phoneNumber}
            <span class="tag">&lt;/h:column&gt;</span>
            <span class="tag">&lt;h:column&gt;</span>
                <span class="tag">&lt;f:facet</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">header</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>REST URL<span class="tag">&lt;/f:facet&gt;</span>
                <span class="tag">&lt;a</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{request.contextPath}/rest/members/#{_member.id}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    /rest/members/#{_member.id}
                <span class="tag">&lt;/a&gt;</span>
            <span class="tag">&lt;/h:column&gt;</span>
            <span class="tag">&lt;f:facet</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">footer</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                REST URL for all members:
                    <span class="tag">&lt;a</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#{request.contextPath}/rest/members</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        /rest/members
                    <span class="tag">&lt;/a&gt;</span>
            <span class="tag">&lt;/f:facet&gt;</span>
        <span class="tag">&lt;/h:dataTable&gt;</span>
    <span class="tag">&lt;/ui:define&gt;</span>
<span class="tag">&lt;/ui:composition&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The JSF form allows us to register new users. There should be one already created when the application started.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The application uses Bean Validation to validate data entry. The error messages from Bean Validation are automatically attached to the relevant field by JSF, and adding a messages JSF component will display them.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This application exposes REST endpoints for each registered member. The application helpfully displays the URL to the REST endpoint on this page.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Next, let&#8217;s take a look at the Member entity, before we look at how the application is wired together:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/kitchensink/model/Member.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">serial</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Entity</span>                                                              <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@XmlRootElement</span>                                                      <i class="conum" data-value="2"></i><b>(2)</b>
<span class="annotation">@Table</span>(uniqueConstraints = <span class="annotation">@UniqueConstraint</span>(columnNames = <span class="string"><span class="delimiter">&quot;</span><span class="content">email</span><span class="delimiter">&quot;</span></span>))
<span class="directive">public</span> <span class="type">class</span> <span class="class">Member</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

    <span class="annotation">@Id</span>
    <span class="annotation">@GeneratedValue</span>
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;

    <span class="annotation">@NotNull</span>
    <span class="annotation">@Size</span>(min = <span class="integer">1</span>, max = <span class="integer">25</span>)
    <span class="annotation">@Pattern</span>(regexp = <span class="string"><span class="delimiter">&quot;</span><span class="content">[A-Za-z ]*</span><span class="delimiter">&quot;</span></span>,
             message = <span class="string"><span class="delimiter">&quot;</span><span class="content">must contain only letters and spaces</span><span class="delimiter">&quot;</span></span>)       <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="directive">private</span> <span class="predefined-type">String</span> name;

    <span class="annotation">@NotNull</span>
    <span class="annotation">@NotEmpty</span>
    <span class="annotation">@Email</span>                                                           <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="directive">private</span> <span class="predefined-type">String</span> email;

    <span class="annotation">@NotNull</span>
    <span class="annotation">@Size</span>(min = <span class="integer">10</span>, max = <span class="integer">12</span>)
    <span class="annotation">@Digits</span>(fraction = <span class="integer">0</span>, integer = <span class="integer">12</span>)                              <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="annotation">@Column</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">phone_number</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> phoneNumber;

    <span class="directive">public</span> <span class="predefined-type">Long</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Long</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getEmail() {
        <span class="keyword">return</span> email;
    }

    <span class="directive">public</span> <span class="type">void</span> setEmail(<span class="predefined-type">String</span> email) {
        <span class="local-variable">this</span>.email = email;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getPhoneNumber() {
        <span class="keyword">return</span> phoneNumber;
    }

    <span class="directive">public</span> <span class="type">void</span> setPhoneNumber(<span class="predefined-type">String</span> phoneNumber) {
        <span class="local-variable">this</span>.phoneNumber = phoneNumber;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>As usual with JPA, we define that the class is an entity by adding @Entity</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Members are exposed as a RESTful service using JAX-RS. We can use JAXB to map the object to XML and to do this we need to add @XmlRootElement</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Bean Validation allows constraints to be defined once (on the entity) and applied everywhere. Here we constrain the person&#8217;s name to a certain size and regular expression</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Hibernate Validator also offers some extra validations such as @Email</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>@Digits , @NotNull and @Size are further examples of constraints</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at <code>MemberRepository</code>, which is responsible for interactions with the persistence layer:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/kitchensink/data/MemberRepository.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ApplicationScoped</span>                                                   <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MemberRepository</span> {

    <span class="annotation">@Inject</span>                                                          <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="directive">private</span> EntityManager em;

    <span class="directive">public</span> <span class="predefined-type">Member</span> findById(<span class="predefined-type">Long</span> id) {
        <span class="keyword">return</span> em.find(<span class="predefined-type">Member</span>.class, id);
    }

    <span class="directive">public</span> <span class="predefined-type">Member</span> findByEmail(<span class="predefined-type">String</span> email) {
        CriteriaBuilder cb = em.getCriteriaBuilder();                <i class="conum" data-value="3"></i><b>(3)</b>
        CriteriaQuery&lt;<span class="predefined-type">Member</span>&gt; c = cb.createQuery(<span class="predefined-type">Member</span>.class);
        Root&lt;<span class="predefined-type">Member</span>&gt; member = c.from(<span class="predefined-type">Member</span>.class);
        c.select(member).where(cb.equal(member.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">email</span><span class="delimiter">&quot;</span></span>), email));
        <span class="keyword">return</span> em.createQuery(c).getSingleResult();
    }

    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Member</span>&gt; findAllOrderedByName() {
        CriteriaBuilder cb = em.getCriteriaBuilder();
        CriteriaQuery&lt;<span class="predefined-type">Member</span>&gt; criteria = cb.createQuery(<span class="predefined-type">Member</span>.class);
        Root&lt;<span class="predefined-type">Member</span>&gt; member = criteria.from(<span class="predefined-type">Member</span>.class);
        criteria.select(member).orderBy(cb.asc(member.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>)));
        <span class="keyword">return</span> em.createQuery(criteria).getResultList();             <i class="conum" data-value="4"></i><b>(4)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The bean is application scoped, as it is a singleton</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The entity manager is injected, to allow interaction with JPA</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The JPA criteria api is used to load a member by their unique identifier, their email address</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The criteria api can also be used to load lists of entities</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at <code>MemberListProducer</code>, which is responsible for managing the list of registered members.</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/kitchensink/data/MemberListProducer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RequestScoped</span>                                                       <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MemberListProducer</span> {

    <span class="annotation">@Inject</span>                                                          <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="directive">private</span> MemberRepository memberRepository;

    <span class="directive">private</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Member</span>&gt; members;

    <span class="comment">// @Named provides access the return value via the EL variable</span>
    <span class="comment">// name &quot;members&quot; in the UI (e.g. Facelets or JSP view)</span>
    <span class="annotation">@Produces</span>                                                        <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="annotation">@Named</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Member</span>&gt; getMembers() {
        <span class="keyword">return</span> members;
    }

    <span class="directive">public</span> <span class="type">void</span> onMemberListChanged(                                 <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="annotation">@Observes</span>(notifyObserver = Reception.IF_EXISTS)
            <span class="directive">final</span> <span class="predefined-type">Member</span> member) {
        retrieveAllMembersOrderedByName();
    }

    <span class="annotation">@PostConstruct</span>
    <span class="directive">public</span> <span class="type">void</span> retrieveAllMembersOrderedByName() {
        members = memberRepository.findAllOrderedByName();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This bean is request scoped, meaning that any fields (such as members ) will be stored for the entire request</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>MemberRepository</code> is responsible or interactions with the persistence layer</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The list of members is exposed as a producer method, it&#8217;s also available via EL</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The observer method is notified whenever a member is created, removed, or updated. This allows us to refresh the list of members whenever they are needed. This is a good approach as it allows us to cache the list of members, but keep it up to date at the same time</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s now look at MemberRegistration, the service that allows us to create new members:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/kitchensink/service/MemberRegistration.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Stateless</span>                                                           <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MemberRegistration</span> {

    <span class="annotation">@Inject</span>                                                          <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="directive">private</span> <span class="predefined-type">Logger</span> log;

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> EntityManager em;

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> <span class="predefined-type">Event</span>&lt;<span class="predefined-type">Member</span>&gt; memberEventSrc;

    <span class="directive">public</span> <span class="type">void</span> register(<span class="predefined-type">Member</span> member) <span class="directive">throws</span> <span class="exception">Exception</span> {
        log.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">Registering </span><span class="delimiter">&quot;</span></span> + member.getName());
        em.persist(member);
        memberEventSrc.fire(member);                                 <i class="conum" data-value="3"></i><b>(3)</b>
   }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This bean requires transactions as it needs to write to the database. Making this an EJB gives us access to declarative transactions - much simpler than manual transaction control!</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Here we inject a JDK logger, defined in the <code>Resources</code> class</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>An event is sent every time a member is updated. This allows other pieces of code (in this quickstart the member list is refreshed) to react to changes in the member list without any coupling to this class.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, let&#8217;s take a look at the <code>Resources</code> class, which provides resources such as the entity manager. CDI recommends using "resource producers", as we do in this quickstart, to alias resources to CDI beans, allowing for a  consistent style throughout our application:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/kitchensink/util/Resources.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Resources</span> {
    <span class="comment">// use @SuppressWarnings to tell IDE to ignore warnings about</span>
    <span class="comment">// field not being referenced directly</span>
    <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unused</span><span class="delimiter">&quot;</span></span>)                                      <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="annotation">@Produces</span>
    <span class="annotation">@PersistenceContext</span>
    <span class="directive">private</span> EntityManager em;

    <span class="annotation">@Produces</span>                                                        <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="directive">public</span> <span class="predefined-type">Logger</span> produceLog(InjectionPoint injectionPoint) {
        <span class="keyword">return</span> <span class="predefined-type">Logger</span>.getLogger(injectionPoint.getMember()
                                              .getDeclaringClass()
                                              .getName());
    }

    <span class="annotation">@Produces</span>                                                        <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="annotation">@RequestScoped</span>
    <span class="directive">public</span> FacesContext produceFacesContext() {
        <span class="keyword">return</span> FacesContext.getCurrentInstance();
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We use the "resource producer" pattern, from CDI, to "alias" the old fashioned <code>@PersistenceContext</code> injection of the entity manager to a CDI style injection. This allows us to use a consistent injection style (<code>@Inject</code>) throughout the application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We expose a JDK logger for injection. In order to save a bit more boiler plate, we automatically set the logger category as the class name!</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We expose the <code>FacesContext</code> via a producer method, which allows it to be injected. If we were adding tests, we could also then mock it out.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you want to define your own datasource, take a look at the <a href="http://docs.redhat.com/docs/en-US/JBoss_Enterprise_Application_Platform/6/html/Administration_and_Configuration_Guide/index.html">Administration and Configuration Guide for JBoss Enterprise Application Platform 6</a> or the <a href="https://docs.jboss.org/author/display/AS71/Getting+Started+Guide">Getting Started Guide</a>.</p>
</div>
<div class="paragraph">
<p>Of course, we need to allow JSF to interact with the services. The <code>MemberController</code> class is responsible for this:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/kitchensink/controller/MemberController.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Model</span>                                                               <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MemberController</span> {

    <span class="annotation">@Inject</span>                                                          <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="directive">private</span> FacesContext facesContext;

    <span class="annotation">@Inject</span>                                                          <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="directive">private</span> MemberRegistration memberRegistration;

    <span class="annotation">@Produces</span>                                                        <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="annotation">@Named</span>
    <span class="directive">private</span> <span class="predefined-type">Member</span> newMember;

    <span class="annotation">@PostConstruct</span>                                                   <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="directive">public</span> <span class="type">void</span> initNewMember() {
        newMember = <span class="keyword">new</span> <span class="predefined-type">Member</span>();
    }

    <span class="directive">public</span> <span class="type">void</span> register() <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="keyword">try</span> {
            memberRegistration.register(newMember);                  <i class="conum" data-value="6"></i><b>(6)</b>
            FacesMessage m =
                <span class="keyword">new</span> FacesMessage(FacesMessage.SEVERITY_INFO,
                                 <span class="string"><span class="delimiter">&quot;</span><span class="content">Registered!</span><span class="delimiter">&quot;</span></span>,
                                 <span class="string"><span class="delimiter">&quot;</span><span class="content">Registration successful</span><span class="delimiter">&quot;</span></span>);
            facesContext.addMessage(<span class="predefined-constant">null</span>, m);                        <i class="conum" data-value="7"></i><b>(7)</b>
            initNewMember();                                         <i class="conum" data-value="8"></i><b>(8)</b>
        } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
            <span class="predefined-type">String</span> errorMessage = getRootErrorMessage(e);
            FacesMessage m =
                <span class="keyword">new</span> FacesMessage(FacesMessage.SEVERITY_ERROR,
                                 errorMessage,
                                 <span class="string"><span class="delimiter">&quot;</span><span class="content">Registration unsuccessful</span><span class="delimiter">&quot;</span></span>);
            facesContext.addMessage(<span class="predefined-constant">null</span>, m);
        }
    }

    <span class="directive">private</span> <span class="predefined-type">String</span> getRootErrorMessage(<span class="exception">Exception</span> e) {
        <span class="comment">// Default to general error message that registration failed.</span>
        <span class="predefined-type">String</span> errorMessage = <span class="string"><span class="delimiter">&quot;</span><span class="content">Registration failed. See server log for more information</span><span class="delimiter">&quot;</span></span>;
        <span class="keyword">if</span> (e == <span class="predefined-constant">null</span>) {
            <span class="comment">// This shouldn't happen, but return the default messages</span>
            <span class="keyword">return</span> errorMessage;
        }

        <span class="comment">// Start with the exception and recurse to find the root cause</span>
        <span class="predefined-type">Throwable</span> t = e;
        <span class="keyword">while</span> (t != <span class="predefined-constant">null</span>) {
            <span class="comment">// Get the message from the Throwable class instance</span>
            errorMessage = t.getLocalizedMessage();
            t = t.getCause();
        }
        <span class="comment">// This is the root cause message</span>
        <span class="keyword">return</span> errorMessage;
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>MemberController</code> class uses the <code>@Model</code> stereotype, which adds <code>@Named</code> and <code>@RequestScoped</code> to the class</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>FacesContext</code> is injected, so that messages can be sent to the user</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>MemberRegistration</code> bean is injected, to allow the controller to interact with the database</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>Member</code> class is exposed using a named producer field, which allows access from JSF. Note that that the named producer field has dependent scope, so every time it is injected, the field will be read</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The <code>@PostConstruct</code> annotation causes a new member object to be placed in the <code>newMember</code> field when the bean is instantiated</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>When the register method is called, the <code>newMember</code> object is passed to the persistence service</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>We also send a message to the user, to give them feedback on their actions</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Finally, we replace the <code>newMember</code> with a new object, thus blanking out the data the user has added so far. This works as the producer field is dependent scoped</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before we wrap up our tour of the kitchensink application, let&#8217;s take a look at how the JAX-RS endpoints are created. Firstly, <code>JaxRSActivator</code>, which extends <code>Application</code> and is annotated with <code>@ApplicationPath</code>, is the Java EE 6 "no XML" approach to activating JAX-RS.</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/kitchensink/rest/JaxRsActivator.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ApplicationPath</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/rest</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">JaxRsActivator</span> <span class="directive">extends</span> Application {
   <span class="comment">/* class body intentionally left blank */</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The real work goes in <code>MemberResourceRESTService</code>, which produces the endpoint:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/org/jboss/as/quickstarts/kitchensink/rest/MemberResourceRESTService.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/members</span><span class="delimiter">&quot;</span></span>)                                                    <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@RequestScoped</span>                                                       <i class="conum" data-value="2"></i><b>(2)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MemberResourceRESTService</span> {

    <span class="annotation">@Inject</span>                                                          <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="directive">private</span> <span class="predefined-type">Logger</span> log;

    <span class="annotation">@Inject</span>                                                          <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="directive">private</span> <span class="predefined-type">Validator</span> validator;

    <span class="annotation">@Inject</span>                                                          <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="directive">private</span> MemberRepository repository;

    <span class="annotation">@Inject</span>                                                          <i class="conum" data-value="6"></i><b>(6)</b>
    <span class="directive">private</span> MemberRegistration registration;

    <span class="annotation">@GET</span>                                                             <i class="conum" data-value="7"></i><b>(7)</b>
    <span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Member</span>&gt; listAllMembers() {
        <span class="keyword">return</span> repository.findAllOrderedByName();
    }

    <span class="annotation">@GET</span>                                                             <i class="conum" data-value="8"></i><b>(8)</b>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{id:[0-9][0-9]*}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
    <span class="directive">public</span> <span class="predefined-type">Member</span> lookupMemberById(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="type">long</span> id) {
        <span class="predefined-type">Member</span> member = repository.findById(id);
        <span class="keyword">if</span> (member == <span class="predefined-constant">null</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span>
                WebApplicationException(Response.Status.NOT_FOUND);
        }
        <span class="keyword">return</span> member;
    }

    <span class="comment">/**
     * Creates a new member from the values provided.  Performs
     * validation, and will return a JAX-RS response with either
     * 200 ok, or with a map of fields, and related errors.
     */</span>
    <span class="annotation">@POST</span>
    <span class="annotation">@Consumes</span>(MediaType.APPLICATION_JSON)
    <span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
    <span class="directive">public</span> Response createMember(<span class="predefined-type">Member</span> member) {                    <i class="conum" data-value="9"></i><b>(9)</b>
        Response.ResponseBuilder builder = <span class="predefined-constant">null</span>;

        <span class="keyword">try</span> {
            <span class="comment">// Validates member using bean validation</span>
            validateMember(member);                                  <i class="conum" data-value="10"></i><b>(10)</b>

            registration.register(member);                           <i class="conum" data-value="11"></i><b>(11)</b>

            <span class="comment">//Create an &quot;ok&quot; response</span>
            builder = Response.ok();
        } <span class="keyword">catch</span> (ConstraintViolationException ce) {                  <i class="conum" data-value="12"></i><b>(12)</b>
            <span class="comment">//Handle bean validation issues</span>
            builder = createViolationResponse(
                          ce.getConstraintViolations());
        } <span class="keyword">catch</span> (ValidationException e) {
            <span class="comment">//Handle the unique constrain violation</span>
            <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; responseObj =
                <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;();
            responseObj.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">email</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Email taken</span><span class="delimiter">&quot;</span></span>);
            builder = Response.status(Response.Status.CONFLICT)
                              .entity(responseObj);
        } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
            <span class="comment">// Handle generic exceptions</span>
            <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; responseObj
                = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;();
            responseObj.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">error</span><span class="delimiter">&quot;</span></span>, e.getMessage());
            builder = Response.status(Response.Status.BAD_REQUEST)
                              .entity(responseObj);
        }

        <span class="keyword">return</span> builder.build();
    }


    <span class="comment">/**
     * &lt;p&gt;
     * Validates the given Member variable and throws validation
     * exceptions based on the type of error. If the error is
     * standard bean validation errors then it will throw a
     * ConstraintValidationException with the set of the
     * constraints violated.
     * &lt;/p&gt;
     * &lt;p&gt;
     * If the error is caused because an existing member with the
     * same email is registered it throws a regular validation
     * exception so that it can be interpreted separately.
     * &lt;/p&gt;
     *
     * @param member Member to be validated
     * @throws ConstraintViolationException
     *     If Bean Validation errors exist
     * @throws ValidationException
     *     If member with the same email already exists
     */</span>
    <span class="directive">private</span> <span class="type">void</span> validateMember(<span class="predefined-type">Member</span> member)
            <span class="directive">throws</span> ConstraintViolationException,
                   ValidationException {
        <span class="comment">//Create a bean validator and check for issues.</span>
        <span class="predefined-type">Set</span>&lt;ConstraintViolation&lt;<span class="predefined-type">Member</span>&gt;&gt; violations =
            validator.validate(member);

        <span class="keyword">if</span> (!violations.isEmpty()) {
            <span class="keyword">throw</span> <span class="keyword">new</span> ConstraintViolationException(
                <span class="keyword">new</span> <span class="predefined-type">HashSet</span>&lt;ConstraintViolation&lt;?&gt;&gt;(violations));
        }

        <span class="comment">//Check the uniqueness of the email address</span>
        <span class="keyword">if</span> (emailAlreadyExists(member.getEmail())) {
            <span class="keyword">throw</span> <span class="keyword">new</span> ValidationException(<span class="string"><span class="delimiter">&quot;</span><span class="content">Unique Email Violation</span><span class="delimiter">&quot;</span></span>);
        }
    }

    <span class="comment">/**
     * Creates a JAX-RS &quot;Bad Request&quot; response including a map of
     * all violation fields, and their message. This can then be
     * used by clients to show violations.
     *
     * @param violations A set of violations that needs to be
     *                   reported
     * @return JAX-RS response containing all violations
     */</span>
    <span class="directive">private</span> Response.ResponseBuilder createViolationResponse
            (<span class="predefined-type">Set</span>&lt;ConstraintViolation&lt;?&gt;&gt; violations) {
        log.fine(<span class="string"><span class="delimiter">&quot;</span><span class="content">Validation completed. violations found: </span><span class="delimiter">&quot;</span></span>
            + violations.size());

        <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; responseObj =
            <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;();

        <span class="keyword">for</span> (ConstraintViolation&lt;?&gt; violation : violations) {
            responseObj.put(violation.getPropertyPath().toString(),
                            violation.getMessage());
        }

        <span class="keyword">return</span> Response.status(Response.Status.BAD_REQUEST)
                       .entity(responseObj);
    }

    <span class="comment">/**
     * Checks if a member with the same email address is already
     * registered.  This is the only way to easily capture the
     * &quot;@UniqueConstraint(columnNames = &quot;email&quot;)&quot; constraint from
     * the Member class.
     *
     * @param email The email to check
     * @return True if the email already exists, and false
               otherwise
     */</span>
    <span class="directive">public</span> <span class="type">boolean</span> emailAlreadyExists(<span class="predefined-type">String</span> email) {
        <span class="predefined-type">Member</span> member = <span class="predefined-constant">null</span>;
        <span class="keyword">try</span> {
            member = repository.findByEmail(email);
        } <span class="keyword">catch</span> (NoResultException e) {
            <span class="comment">// ignore</span>
        }
        <span class="keyword">return</span> member != <span class="predefined-constant">null</span>;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@Path</code> annotation tells JAX-RS that this class provides a REST endpoint mapped to <code>rest/members</code> (concatenating the path from the activator with the path for this endpoint).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The bean is request scoped, as JAX-RS interactions typically don&#8217;t hold state between requests</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>JAX-RS endpoints are CDI enabled, and can use CDI-style injection.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>CDI allows us to inject a Bean Validation <code>Validator</code> instance, which is used to validate the POSTed member before it is persisted</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><code>MemberRegistration</code> is injected to allow us to alter the member database</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><code>MemberRepository</code> is injected to allow us to query the member database</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The <code>listAllMembers()</code> method is called when the raw endpoint is accessed and offers up a list of endpoints. Notice that the object is automatically marshalled to JSON by RESTEasy (the JAX-RS implementation included in JBoss WildFly).</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The <code>lookupMemberById()</code> method is called when the endpoint is accessed with a member id parameter appended (for example <code>rest/members/1)</code>. Again, the object is automatically marshalled to JSON by RESTEasy.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td><code>createMember()</code> is called when a POST is performed on the URL. Once again, the object is automatically unmarshalled from JSON.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>In order to ensure that the member is valid, we call the <code>validateMember</code> method, which validates the object, and adds any constraint violations to the response. These can then be handled on the client side, and displayed to the user</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>The object is then passed to the <code>MemberRegistration</code> service to be persisted</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>We then handle any remaining issues with validating the object, which are raised when the object is persisted</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="arquillian">6.2.1. Arquillian</h4>
<div class="paragraph">
<p>If you&#8217;ve been following along with the Test Driven Development craze of the past few years, you&#8217;re probably getting a bit nervous by now, wondering how on earth you are going to test your application. Lucky for you, the Arquillian project is here to help!</p>
</div>
<div class="paragraph">
<p>Arquillian provides all the boiler plate for running your test inside JBoss WildFly, allowing you to concentrate on testing your application. In order to do that, it utilizes Shrinkwrap, a fluent API for defining packaging, to create an archive to deploy. We&#8217;ll go through the testcase, and how you configure Arquillian in just a moment, but first let&#8217;s run the test.</p>
</div>
<div class="paragraph">
<p>Before we start, we need to let Arquillian know the path to our server. Open up <code>src/test/resources/arquillian.xml</code>, uncomment the <code>&lt;configuration&gt;</code> elements, and set the <code>jbossHome</code> property to the path to the server:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/eclipse_arquillian_0.png" alt="eclipse arquillian 0"></span></p>
</div>
<div class="paragraph">
<p>Now, make sure the server is not running (so that the instance started for running the test does not interfere), and then run the tests from the command line by typing:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn clean test -Parq-managed</pre>
</div>
</div>
<div class="paragraph">
<p>You should see the server start up, a <code>test.war</code> deployed, test executed, and then the results displayed to you on the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ &gt; mvn clean test -Parq-managed


[INFO] Scanning for projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building WildFly Quickstarts: Kitchensink 7.0.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- maven-clean-plugin:2.4.1:clean (default-clean) @ wildfly-kitchensink ---
[INFO] Deleting /Users/pmuir/workspace/wildfly-docs/quickstarts/kitchensink/target
[INFO]
[INFO] --- maven-resources-plugin:2.4.3:resources (default-resources) @ wildfly-kitchensink ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO]
[INFO] --- maven-compiler-plugin:2.3.1:compile (default-compile) @ wildfly-kitchensink ---
[INFO] Compiling 6 source files to /Users/pmuir/workspace/wildfly-docs/quickstarts/kitchensink/target/classes
[INFO]
[INFO] --- maven-resources-plugin:2.4.3:testResources (default-testResources) @ wildfly-kitchensink ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO]
[INFO] --- maven-compiler-plugin:2.3.1:testCompile (default-testCompile) @ wildfly-kitchensink ---
[INFO] Compiling 1 source file to /Users/pmuir/workspace/wildfly-docs/quickstarts/kitchensink/target/test-classes
[INFO]
[INFO] --- maven-surefire-plugin:2.7.2:test (default-test) @ wildfly-kitchensink ---
[INFO] Surefire report directory: /Users/pmuir/workspace/wildfly-docs/quickstarts/kitchensink/target/surefire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.jboss.as.quickstarts.kitchensink.test.MemberRegistrationTest
Jun 25, 2011 7:17:49 PM org.jboss.arquillian.container.impl.client.container.ContainerRegistryCreator getActivatedConfiguration
INFO: Could not read active container configuration: null
log4j:WARN No appenders could be found for logger (org.jboss.remoting).
log4j:WARN Please initialize the log4j system properly.
Jun 25, 2011 7:17:54 PM org.jboss.as.arquillian.container.managed.ManagedDeployableContainer startInternal
INFO: Starting container with: [java, -Djboss.home.dir=/Users/pmuir/development/jboss, -Dorg.jboss.boot.log.file=/Users/pmuir/development/jboss/standalone/log/boot.log, -Dlogging.configuration=file:/Users/pmuir/development/jboss/standalone/configuration/logging.properties, -jar, /Users/pmuir/development/jboss/jboss-modules.jar, -mp, /Users/pmuir/development/jboss/modules, -logmodule, org.jboss.logmanager, -jaxpmodule, javax.xml.jaxp-provider, org.jboss.as.standalone, -server-config, standalone.xml]
19:17:55,107 INFO  [org.jboss.modules] JBoss Modules version 1.0.0.CR4
19:17:55,329 INFO  [org.jboss.msc] JBoss MSC version 1.0.0.CR2
19:17:55,386 INFO  [org.jboss.as] JBoss WildFly.0.0.Beta4-SNAPSHOT "(TBD)" starting
19:17:56,159 INFO  [org.jboss.as] creating http management service using network interface (management) port (9990) securePort (-1)
19:17:56,181 INFO  [org.jboss.as.logging] Removing bootstrap log handlers
19:17:56,189 INFO  [org.jboss.as.naming] (Controller Boot Thread) Activating Naming Subsystem
19:17:56,203 INFO  [org.jboss.as.naming] (MSC service thread 1-4) Starting Naming Service
19:17:56,269 INFO  [org.jboss.as.security] (Controller Boot Thread) Activating Security Subsystem
19:17:56,305 INFO  [org.jboss.remoting] (MSC service thread 1-1) JBoss Remoting version 3.2.0.Beta2
19:17:56,317 INFO  [org.xnio] (MSC service thread 1-1) XNIO Version 3.0.0.Beta3
19:17:56,331 INFO  [org.xnio.nio] (MSC service thread 1-1) XNIO NIO Implementation Version 3.0.0.Beta3
19:17:56,522 INFO  [org.jboss.as.connector.subsystems.datasources] (Controller Boot Thread) Deploying JDBC-compliant driver class org.h2.Driver (version 1.2)
19:17:56,572 INFO  [org.apache.catalina.core.AprLifecycleListener] (MSC service thread 1-7) The Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: .:/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java
19:17:56,627 INFO  [org.jboss.as.remoting] (MSC service thread 1-3) Listening on /127.0.0.1:9999
19:17:56,641 INFO  [org.jboss.as.jmx.JMXConnectorService] (MSC service thread 1-2) Starting remote JMX connector
19:17:56,705 INFO  [org.jboss.as.ee] (Controller Boot Thread) Activating EE subsystem
19:17:56,761 INFO  [org.apache.coyote.http11.Http11Protocol] (MSC service thread 1-7) Starting Coyote HTTP/1.1 on http--127.0.0.1-8080
19:17:56,793 INFO  [org.jboss.as.connector] (MSC service thread 1-3) Starting JCA Subsystem (JBoss IronJacamar 1.0.0.CR2)
19:17:56,837 INFO  [org.jboss.as.connector.subsystems.datasources] (MSC service thread 1-2) Bound data source [java:jboss/datasources/ExampleDS]
19:17:57,335 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-1) Starting deployment of "arquillian-service"
19:17:57,348 INFO  [org.jboss.as.deployment] (MSC service thread 1-7) Started FileSystemDeploymentService for directory /Users/pmuir/development/jboss/standalone/deployments
19:17:57,693 INFO  [org.jboss.as] (Controller Boot Thread) JBoss WildFly.0.0.Beta4-SNAPSHOT "(TBD)" started in 2806ms - Started 111 of 138 services (27 services are passive or on-demand)
19:18:00,596 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-6) Stopped deployment arquillian-service in 8ms
19:18:01,394 INFO  [org.jboss.as.server.deployment] (pool-2-thread-7) Content added at location /Users/pmuir/development/jboss/standalone/data/content/0a/9e20b7bc978fd2778b89c7c06e4d3e1f308dfe/content
19:18:01,403 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-7) Starting deployment of "arquillian-service"
19:18:01,650 INFO  [org.jboss.as.server.deployment] (pool-2-thread-6) Content added at location /Users/pmuir/development/jboss/standalone/data/content/94/8324ab8f5a693c67fa57b59323304d3947bbf6/content
19:18:01,659 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-5) Starting deployment of "test.war"
19:18:01,741 INFO  [org.jboss.jpa] (MSC service thread 1-7) read persistence.xml for primary
19:18:01,764 INFO  [org.jboss.weld] (MSC service thread 1-3) Processing CDI deployment: test.war
19:18:01,774 INFO  [org.jboss.as.ejb3.deployment.processors.EjbJndiBindingsDeploymentUnitProcessor] (MSC service thread 1-3) JNDI bindings for session bean named MemberRegistration in deployment unit deployment "test.war" are as follows:

        java:global/test/MemberRegistration!org.jboss.as.quickstarts.kitchensink.controller.MemberRegistration
        java:app/test/MemberRegistration!org.jboss.as.quickstarts.kitchensink.controller.MemberRegistration
        java:module/MemberRegistration!org.jboss.as.quickstarts.kitchensink.controller.MemberRegistration
        java:global/test/MemberRegistration
        java:app/test/MemberRegistration
        java:module/MemberRegistration

19:18:01,908 INFO  [org.jboss.weld] (MSC service thread 1-5) Starting Services for CDI deployment: test.war
19:18:02,131 INFO  [org.jboss.weld.Version] (MSC service thread 1-5) WELD-000900 1.1.1 (Final)
19:18:02,169 INFO  [org.jboss.weld] (MSC service thread 1-2) Starting weld service
19:18:02,174 INFO  [org.jboss.as.arquillian] (MSC service thread 1-3) Arquillian deployment detected: ArquillianConfig[service=jboss.arquillian.config."test.war",unit=test.war,tests=[org.jboss.as.quickstarts.kitchensink.test.MemberRegistrationTest]]
19:18:02,179 INFO  [org.jboss.jpa] (MSC service thread 1-6) starting Persistence Unit Service 'test.war#primary'
19:18:02,322 INFO  [org.hibernate.annotations.common.Version] (MSC service thread 1-6) Hibernate Commons Annotations 3.2.0.Final
19:18:02,328 INFO  [org.hibernate.cfg.Environment] (MSC service thread 1-6) HHH00412:Hibernate [WORKING]
19:18:02,330 INFO  [org.hibernate.cfg.Environment] (MSC service thread 1-6) HHH00206:hibernate.properties not found
19:18:02,332 INFO  [org.hibernate.cfg.Environment] (MSC service thread 1-6) HHH00021:Bytecode provider name : javassist
19:18:02,354 INFO  [org.hibernate.ejb.Ejb3Configuration] (MSC service thread 1-6) HHH00204:Processing PersistenceUnitInfo [
	name: primary
	...]
19:18:02,400 WARN  [org.hibernate.cfg.AnnotationBinder] (MSC service thread 1-6) HHH00194:Package not found or wo package-info.java: org.jboss.as.quickstarts.kitchensink.test
19:18:02,400 WARN  [org.hibernate.cfg.AnnotationBinder] (MSC service thread 1-6) HHH00194:Package not found or wo package-info.java: org.jboss.as.quickstarts.kitchensink.controller
19:18:02,401 WARN  [org.hibernate.cfg.AnnotationBinder] (MSC service thread 1-6) HHH00194:Package not found or wo package-info.java: org.jboss.as.quickstarts.kitchensink.util
19:18:02,401 WARN  [org.hibernate.cfg.AnnotationBinder] (MSC service thread 1-6) HHH00194:Package not found or wo package-info.java: org.jboss.as.quickstarts.kitchensink.model
19:18:02,592 INFO  [org.hibernate.service.jdbc.connections.internal.ConnectionProviderInitiator] (MSC service thread 1-6) HHH00130:Instantiating explicit connection provider: org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider
19:18:02,852 INFO  [org.hibernate.dialect.Dialect] (MSC service thread 1-6) HHH00400:Using dialect: org.hibernate.dialect.H2Dialect
19:18:02,858 WARN  [org.hibernate.dialect.H2Dialect] (MSC service thread 1-6) HHH00431:Unable to determine H2 database version, certain features may not work
19:18:02,862 INFO  [org.hibernate.engine.jdbc.internal.LobCreatorBuilder] (MSC service thread 1-6) HHH00423:Disabling contextual LOB creation as JDBC driver reported JDBC version [3] less than 4
19:18:02,870 INFO  [org.hibernate.engine.transaction.internal.TransactionFactoryInitiator] (MSC service thread 1-6) HHH00268:Transaction strategy: org.hibernate.engine.transaction.internal.jta.CMTTransactionFactory
19:18:02,874 INFO  [org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory] (MSC service thread 1-6) HHH00397:Using ASTQueryTranslatorFactory
19:18:02,911 INFO  [org.hibernate.validator.util.Version] (MSC service thread 1-6) Hibernate Validator 4.1.0.Final
19:18:02,917 INFO  [org.hibernate.validator.engine.resolver.DefaultTraversableResolver] (MSC service thread 1-6) Instantiated an instance of org.hibernate.validator.engine.resolver.JPATraversableResolver.
19:18:03,079 INFO  [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-6) HHH00227:Running hbm2ddl schema export
19:18:03,093 INFO  [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-6) HHH00230:Schema export complete
19:18:03,217 INFO  [org.jboss.web] (MSC service thread 1-5) registering web context: /test
19:18:03,407 WARN  [org.jboss.weld.Bean] (RMI TCP Connection(3)-127.0.0.1) WELD-000018 Executing producer field or method [method] @Produces public org.jboss.as.quickstarts.kitchensink.test.MemberRegistrationTest.produceLog(InjectionPoint) on incomplete declaring bean Managed Bean [class org.jboss.as.quickstarts.kitchensink.test.MemberRegistrationTest] with qualifiers [@Any @Default] due to circular injection
19:18:03,427 WARN  [org.jboss.weld.Bean] (RMI TCP Connection(3)-127.0.0.1) WELD-000018 Executing producer field or method [method] @Produces public org.jboss.as.quickstarts.kitchensink.test.MemberRegistrationTest.produceLog(InjectionPoint) on incomplete declaring bean Managed Bean [class org.jboss.as.quickstarts.kitchensink.test.MemberRegistrationTest] with qualifiers [@Any @Default] due to circular injection
19:18:03,450 WARN  [org.jboss.as.ejb3.component.EJBComponent] (RMI TCP Connection(3)-127.0.0.1) EJBTHREE-2120: deprecated getTransactionAttributeType method called (dev problem)
19:18:03,459 INFO  [org.jboss.as.quickstarts.kitchensink.controller.MemberRegistration] (RMI TCP Connection(3)-127.0.0.1) Registering Jane Doe
19:18:03,616 INFO  [org.jboss.as.quickstarts.kitchensink.test.MemberRegistrationTest] (RMI TCP Connection(3)-127.0.0.1) Jane Doe was persisted with id 1
19:18:03,686 INFO  [org.jboss.jpa] (MSC service thread 1-1) stopping Persistence Unit Service 'test.war#primary'
19:18:03,687 INFO  [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-1) HHH00227:Running hbm2ddl schema export
19:18:03,690 INFO  [org.jboss.weld] (MSC service thread 1-3) Stopping weld service
19:18:03,692 INFO  [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-1) HHH00230:Schema export complete
19:18:03,704 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-8) Stopped deployment test.war in 52ms
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 14.859 sec

Results :

Tests run: 1, Failures: 0, Errors: 0, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 22.305s
[INFO] Finished at: Sat Jun 25 19:18:04 BST 2011
[INFO] Final Memory: 17M/125M
[INFO] ------------------------------------------------------------------------</pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, that didn&#8217;t take too long (approximately 15s), and is great for running in your QA environment, but if you running locally, you might prefer to connect to a running server. To do that, start up JBoss WildFly (as described in <a href="#GettingStarted-">Getting Started with JBoss Enterprise Application Platform of WildFly</a>. Now, run your test, but use the <code>arq-wildfly-remote</code> profile:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn clean test -Parq-remote</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ &gt; mvn clean test -Parq-remote


[INFO] Scanning for projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building WildFly Quickstarts: Kitchensink 7.0.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- maven-clean-plugin:2.4.1:clean (default-clean) @ wildfly-kitchensink ---
[INFO] Deleting /Users/pmuir/workspace/wildfly-docs/quickstarts/kitchensink/target
[INFO]
[INFO] --- maven-resources-plugin:2.4.3:resources (default-resources) @ wildfly-kitchensink ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO]
[INFO] --- maven-compiler-plugin:2.3.1:compile (default-compile) @ wildfly-kitchensink ---
[INFO] Compiling 6 source files to /Users/pmuir/workspace/wildfly-docs/quickstarts/kitchensink/target/classes
[INFO]
[INFO] --- maven-resources-plugin:2.4.3:testResources (default-testResources) @ wildfly-kitchensink ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO]
[INFO] --- maven-compiler-plugin:2.3.1:testCompile (default-testCompile) @ wildfly-kitchensink ---
[INFO] Compiling 1 source file to /Users/pmuir/workspace/wildfly-docs/quickstarts/kitchensink/target/test-classes
[INFO]
[INFO] --- maven-surefire-plugin:2.7.2:test (default-test) @ wildfly-kitchensink ---
[INFO] Surefire report directory: /Users/pmuir/workspace/wildfly-docs/quickstarts/kitchensink/target/surefire-reports

------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.jboss.as.quickstarts.kitchensink.test.MemberRegistrationTest
Jun 25, 2011 7:22:28 PM org.jboss.arquillian.container.impl.client.container.ContainerRegistryCreator getActivatedConfiguration
INFO: Could not read active container configuration: null
log4j:WARN No appenders could be found for logger (org.jboss.as.arquillian.container.MBeanServerConnectionProvider).
log4j:WARN Please initialize the log4j system properly.
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.13 sec

Results :

Tests run: 1, Failures: 0, Errors: 0, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 10.474s
[INFO] Finished at: Sat Jun 25 19:22:33 BST 2011
[INFO] Final Memory: 17M/125M
[INFO] ------------------------------------------------------------------------
$ &gt;</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Arquillian defines two modes, <em>managed</em> and <em>remote</em> . The <em>managed</em>
mode will take care of starting and stopping the server for you, whilst
the <em>remote</em> mode connects to an already running server.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This time you can see the test didn&#8217;t start the server (if you check the instance you started, you will see the application was deployed there), and the test ran a lot faster (approximately 4s).</p>
</div>
<div class="paragraph">
<p>We can also run the test from Eclipse, in both managed and remote modes. First, we&#8217;ll run in in managed mode. In order to set up the correct dependencies on your classpath, right click on the project, and select Properties :</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/eclipse_arquillian_1.png" alt="eclipse arquillian 1"></span></p>
</div>
<div class="paragraph">
<p>Now, locate the Maven panel:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/eclipse_arquillian_2.png" alt="eclipse arquillian 2"></span></p>
</div>
<div class="paragraph">
<p>And activate the <code>arq-managed</code> profile:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/eclipse_arquillian_3.png" alt="eclipse arquillian 3"></span></p>
</div>
<div class="paragraph">
<p>Finally, hit <em>Ok</em>, and then confirm you want to update the project configuration:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/eclipse_arquillian_4.png" alt="eclipse arquillian 4"></span></p>
</div>
<div class="paragraph">
<p>Once the project has built, locate the <code>MemberRegistrationTest</code> in <code>src/test/java</code>, right click on the test, and choose <em>Run As &#8594; JUnit Test&#8230;&#8203;`</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/eclipse_arquillian_12.png" alt="eclipse arquillian 12"></span></p>
</div>
<div class="paragraph">
<p>You should see the server start in the Eclipse Console, the test be deployed, and finally the JUnit View pop up with the result (a pass of course!).</p>
</div>
<div class="paragraph">
<p>We can also run the test in an already running instance of Eclipse. Simply change the active profile to <code>arq-remote</code>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/eclipse_arquillian_11.png" alt="eclipse arquillian 11"></span></p>
</div>
<div class="paragraph">
<p>Now, make sure the server is running, right click on the test case and choose <em>Run As &#8594; JUnit Test&#8230;&#8203;</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/eclipse_arquillian_12.png" alt="eclipse arquillian 12"></span></p>
</div>
<div class="paragraph">
<p>Again, you&#8217;ll see the test run in the server, and the JUnit View pop up, with the test passing.</p>
</div>
<div class="paragraph">
<p>So far so good, the test is running in both Eclipse and from the command line. But what does the test look like?</p>
</div>
<div class="listingblock">
<div class="title">src/test/java/org/jboss/as/quickstarts/kitchensink/test/MemberRegistrationTest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RunWith</span>(Arquillian.class)                                           <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MemberRegistrationTest</span> {
    <span class="annotation">@Deployment</span>                                                      <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="directive">public</span> <span class="directive">static</span> Archive&lt;?&gt; createTestArchive() {
        <span class="keyword">return</span> ShrinkWrap.create(WebArchive.class, <span class="string"><span class="delimiter">&quot;</span><span class="content">test.war</span><span class="delimiter">&quot;</span></span>)
                .addClasses(<span class="predefined-type">Member</span>.class,
                            MemberRegistration.class,
                            Resources.class)                         <i class="conum" data-value="3"></i><b>(3)</b>
                .addAsResource(<span class="string"><span class="delimiter">&quot;</span><span class="content">META-INF/test-persistence.xml</span><span class="delimiter">&quot;</span></span>,
                               <span class="string"><span class="delimiter">&quot;</span><span class="content">META-INF/persistence.xml</span><span class="delimiter">&quot;</span></span>)           <i class="conum" data-value="4"></i><b>(4)</b>
                .addAsWebInfResource(EmptyAsset.INSTANCE,
                                     <span class="string"><span class="delimiter">&quot;</span><span class="content">beans.xml</span><span class="delimiter">&quot;</span></span>)                    <i class="conum" data-value="5"></i><b>(5)</b>
                <span class="comment">// Deploy our test datasource</span>
                .addAsWebInfResource(<span class="string"><span class="delimiter">&quot;</span><span class="content">test-ds.xml</span><span class="delimiter">&quot;</span></span>);                 <i class="conum" data-value="6"></i><b>(6)</b>
    }

    <span class="annotation">@Inject</span>                                                          <i class="conum" data-value="7"></i><b>(7)</b>
    MemberRegistration memberRegistration;

    <span class="annotation">@Inject</span>
    <span class="predefined-type">Logger</span> log;

    <span class="annotation">@Test</span>
    <span class="directive">public</span> <span class="type">void</span> testRegister() <span class="directive">throws</span> <span class="exception">Exception</span> {                    <i class="conum" data-value="8"></i><b>(8)</b>
        <span class="predefined-type">Member</span> newMember = <span class="keyword">new</span> <span class="predefined-type">Member</span>();
        newMember.setName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Jane Doe</span><span class="delimiter">&quot;</span></span>);
        newMember.setEmail(<span class="string"><span class="delimiter">&quot;</span><span class="content">jane@mailinator.com</span><span class="delimiter">&quot;</span></span>);
        newMember.setPhoneNumber(<span class="string"><span class="delimiter">&quot;</span><span class="content">2125551234</span><span class="delimiter">&quot;</span></span>);
        memberRegistration.register(newMember);
        assertNotNull(newMember.getId());
        log.info(newMember.getName() +
                 <span class="string"><span class="delimiter">&quot;</span><span class="content"> was persisted with id </span><span class="delimiter">&quot;</span></span> +
                 newMember.getId());
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@RunWith(Arquillian.class)</code> tells JUnit to hand control over to Arquillian when executing tests</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>@Deployment</code> annotation identifies the <code>createTestArchive()</code> static method to Arquillian as the one to use to determine which resources and classes to deploy</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We add just the classes needed for the test, no more</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We also add persistence.xml as our test is going to use the database</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Of course, we must add beans.xml to enable CDI</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Finally, we add a test datasource, so that test data doesn&#8217;t overwrite production data</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Arquillian allows us to inject beans into the test case</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The test method works as you would expect - creates a new member, registers them, and then verifies that the member was created</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As you can see, Arquillian has lived up to the promise - the test case is focused on <em>what</em> to test (the <code>@Deployment</code> method) and <em>how</em> to test (the <code>@Test</code> method). It&#8217;s also worth noting that this isn&#8217;t a simplistic unit test - this is a fully fledged integration test that uses the database.</p>
</div>
<div class="paragraph">
<p>Now, let&#8217;s look at how we configure Arquillian. First of all, let&#8217;s take a look at <code>arquillian.xml</code> in <code>src/test/resources</code>.</p>
</div>
<div class="listingblock">
<div class="title">src/test/resources/META-INF/arquillian.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;arquillian</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/schema/arquillian</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/schema/arquillian</span>
        <span class="content">http://jboss.org/schema/arquillian/arquillian_1_0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

   <span class="comment">&lt;!-- Uncomment to have test archives exported to the
        file system for inspection --&gt;</span>
<span class="comment">&lt;!--    &lt;engine&gt;  --&gt;</span>                                                <i class="conum" data-value="1"></i><b>(1)</b>
<span class="comment">&lt;!--       &lt;property name=&quot;deploymentExportPath&quot;&gt;
               target/
           &lt;/property&gt;  --&gt;</span>
<span class="comment">&lt;!--    &lt;/engine&gt; --&gt;</span>

   <span class="comment">&lt;!-- Force the use of the Servlet 3.0 protocol with all
        containers, as it is the most mature --&gt;</span>
   <span class="tag">&lt;defaultProtocol</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Servlet 3.0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>                            <i class="conum" data-value="2"></i><b>(2)</b>

   <span class="comment">&lt;!-- Example configuration for a remote JBoss WildFly instance --&gt;</span>
   <span class="tag">&lt;container</span> <span class="attribute-name">qualifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jboss</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">default</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="comment">&lt;!-- If you want to use the JBOSS_HOME environment variable,
           just delete the jbossHome property --&gt;</span>
      <span class="tag">&lt;configuration&gt;</span>
         <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jbossHome</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>/path/to/wildfly<span class="tag">&lt;/property&gt;</span>
      <span class="tag">&lt;/configuration&gt;</span>
   <span class="tag">&lt;/container&gt;</span>

<span class="tag">&lt;/arquillian&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Arquillian deploys the test war, and doesn&#8217;t write it to disk. For debugging, it can be very useful to see exactly what is in your war, so Arquillian allows you to export the war when the tests runs</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Arquillian currently needs configuring to use the Servlet protocol to connect to the server</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, we need to look at how we select between containers in the <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;profile&gt;</span>
    <span class="comment">&lt;!-- An optional Arquillian testing profile that executes tests
        in your WildFly instance --&gt;</span>
    <span class="comment">&lt;!-- This profile will start a new WildFly instance, and
        execute the test, shutting it down when done --&gt;</span>
    <span class="comment">&lt;!-- Run with: mvn clean test -Parq-managed --&gt;</span>
    <span class="tag">&lt;id&gt;</span>arq-wildfly-managed<span class="tag">&lt;/id&gt;</span>                                     <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;dependencies&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.jboss.as<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>                                             <i class="conum" data-value="2"></i><b>(2)</b>
                wildfly-arquillian-container-managed
            <span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;/dependencies&gt;</span>
<span class="tag">&lt;/profile&gt;</span>

<span class="tag">&lt;profile&gt;</span>
    <span class="comment">&lt;!-- An optional Arquillian testing profile that executes
        tests in a remote WildFly instance --&gt;</span>
    <span class="comment">&lt;!-- Run with: mvn clean test -Parq-remote --&gt;</span>
    <span class="tag">&lt;id&gt;</span>arq-wildfly-remote<span class="tag">&lt;/id&gt;</span>
    <span class="tag">&lt;dependencies&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.jboss.as<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>                                             <i class="conum" data-value="3"></i><b>(3)</b>
                wildfly-arquillian-container-remote
            <span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;/dependencies&gt;</span>
<span class="tag">&lt;/profile&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>&lt;1&gt;The profile needs an id so we can activate from Eclipse or the command line
&lt;2&gt; Arquillian decides which container to use depending on your classpath. Here we define the managed container.
&lt;3&gt; Arquillian decides which container to use depending on your classpath. Here we define the remote container.</p>
</div>
<div class="paragraph">
<p>And that&#8217;s it! As you can see Arquillian delivers simple and true testing. You can concentrate on writing your test functionality, and run your tests in the same environment in which you will run your application.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Arquillian also offers other containers, allowing you to run your tests
against Weld Embedded (super fast, but your enterprise services are
mocked), GlassFish, and more</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That concludes our tour of the kitchensink quickstart. If you would like to use this project as a basis for your own application, you can of course copy this application sources and modify it.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-your-own-application">7. Creating your own application</h2>
<div class="sectionbody">
<div id="Archetype-" class="paragraph">
<p>What we didn&#8217;t tell you about the kitchensink quickstart is that it is generated from a Maven archetype. Using this archetype offers you the perfect opportunity to generate your own project.</p>
</div>
<div class="paragraph">
<p>You can create a project from the archetype using Red Hat JBoss Developer Studio, or Eclipse with JBoss Tools. First, open up <em>JBoss Central</em>, if it isn&#8217;t already open. Hit <em>Cmd-3</em> (Mac) or <em>Ctrl-3</em> (Windows, Linux) and type <em>JBoss Central</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_JBoss_Central_1.png" alt="Eclipse JBoss Central 1"></span></p>
</div>
<div class="paragraph">
<p>You will now be shown <em>JBoss Central</em>, an excellent place to find about all things JBoss!</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_JBoss_Central_2.png" alt="Eclipse JBoss Central 2"></span></p>
</div>
<div class="paragraph">
<p>To create a new project, based on the kitchensink quickstart, click on <em>Create Projects | Java EE Web Project</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_JavaEEWebProject_1.png" alt="Eclipse JavaEEWebProject 1"></span></p>
</div>
<div class="paragraph">
<p>Red Hat JBoss Developer Studio will then check that you have the necessary pre-requisites to create the project. If you are using JBoss Developer Studio, then you should, otherwise, JBoss Tools will help you install the necessary pre-requisites. See <a href="http://jboss.org/tools">JBoss Tools</a> for more information.</p>
</div>
<div class="paragraph">
<p>Hit <em>Next &gt;</em>. On the next screen you can enter a project name, package for sample code, and finally select a target runtime:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_JavaEEWebProject_2.png" alt="Eclipse JavaEEWebProject 2"></span></p>
</div>
<div class="paragraph">
<p>Finally, hit <em>Finish</em>. You&#8217;ll be presented with the <em>New Project Example</em> dialog, in which you can simply hit <em>Finish</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_JavaEEWebProject_3.png" alt="Eclipse JavaEEWebProject 3"></span></p>
</div>
<div class="paragraph">
<p>You should now have a brand new project:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/gfx/Eclipse_JavaEEWebProject_4.png" alt="Eclipse JavaEEWebProject 4"></span></p>
</div>
<div class="paragraph">
<p>Enjoy!</p>
</div>
<div class="paragraph">
<p>To use the archetype to generate a new project, you should run:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn archetype:generate \
    -DarchetypeArtifactId=jboss-javaee7-webapp-archetype \
    -DarchetypeGroupId=org.jboss.spec.archetypes \
    -DarchetypeVersion=7.1.1.CR2 \</pre>
</div>
</div>
<div class="paragraph">
<p>Maven will download the archetype and it&#8217;s dependencies, and ask you some questions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ &gt; mvn archetype:generate \
        -DarchetypeArtifactId=jboss-javaee7-webapp-archetype \
        -DarchetypeGroupId=org.jboss.spec.archetypes \
        -DarchetypeVersion=7.1.1.CR2
[INFO] Scanning for projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building Maven Stub Project (No POM) 1
[INFO] ------------------------------------------------------------------------
[INFO]

.........

Define value for property 'groupId': : com.acme.corp                 <i class="conum" data-value="1"></i><b>(1)</b>
Define value for property 'artifactId': : acme-sales                 <i class="conum" data-value="2"></i><b>(2)</b>
Define value for property 'version':  1.0-SNAPSHOT: :                <i class="conum" data-value="3"></i><b>(3)</b>
Define value for property 'package':  com.acme.corp: :               <i class="conum" data-value="4"></i><b>(4)</b>
[INFO] Using property: name = Java EE webapp project               <i class="conum" data-value="5"></i><b>(5)</b>
Confirm properties configuration:
groupId: com.acme.corp
artifactId: acme-sales
version: 1.0-SNAPSHOT
package: com.acme.corp
name: Java EE webapp project
 Y: :
[WARNING] CP Don't override file /Users/pmuir/tmp/acme-sales/.settings/org.eclipse.jdt.apt.core.prefs
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 14.774s
[INFO] Finished at: Mon Jun 06 18:53:38 BST 2011
[INFO] Final Memory: 7M/125M
[INFO] ------------------------------------------------------------------------
$ &gt;</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enter the groupId you wish to use</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Enter the artifactId you wish to use</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Enter the version you wish to use, or just hit Enter if you wish to accept the default 1.0-SNAPSHOT</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Enter the java package you wish to use, or just hit Enter if you wish to accept the default (which is copied from groupId ).</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Finally, if you are happy with your choices, hit Enter and Maven will generate the project for you.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>And that&#8217;s it, you now have a brand new project with the same functionality as <code>kitchensink</code>, but customized with your details.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The archetype contains some sample code to get you started. If you
would prefer a blank canvas, with only a project skeleton, then use
<code>jboss-javaee7-webapp-blank-archetype</code> as your archetype id.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Prefer Enterprise Applications (EARs)?</div>
<div class="paragraph">
<p>The archetype generates a WAR project. With Java EE, you can include
EJBs in your WAR, meaning you won&#8217;t need an EAR until you need to divide
your code into modules. If you would like to create an EAR based project
then use <code>jboss-javaee7-webapp-ear-archetype</code>
as your archetype id (or if you want a blank EAR, then
<code>jboss-javaee7-webapp-ear-blank-archetype</code>).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="more-resources">8. More Resources</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="Getting_Started_Guide.html">Getting Started Guide</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Getting Started Guide covers topics such as
server layout (what you can configure where), data source definition,
and using the web management interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://torquebox.org/">Torquebox</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Torque Box allows you to use all the familiar services from
JBoss AS 7, but with Ruby.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.jboss.org/wiki/JBossAS7FAQ">JBoss AS 7 FAQ</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frequently Asked Questions for JBoss AS 7</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="Developing_JSF_Project_Using">8.1. Developing JSF Project Using JBoss AS7, Maven and IntelliJ</h3>
<div class="paragraph">
<p>JBoss AS7 is a very 'modern' application server that has very fast
startup speed. So it&#8217;s an excellent container to test your JSF project.
In this article, I&#8217;d like to show you how to use AS7, maven and IntelliJ
together to develop your JSF project.</p>
</div>
<div class="paragraph">
<p>In this article I&#8217;d like to introduce the following things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a project using Maven</p>
</li>
<li>
<p>Add JSF into project</p>
</li>
<li>
<p>Writing Code</p>
</li>
<li>
<p>Add JBoss AS 7 deploy plugin into project</p>
</li>
<li>
<p>Deploy project to JBoss AS 7</p>
</li>
<li>
<p>Import project into IntelliJ</p>
</li>
<li>
<p>Add IntelliJ JSF support to project</p>
</li>
<li>
<p>Add JBoss AS7 to IntelliJ</p>
</li>
<li>
<p>Debugging project with IntelliJ and AS7</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>I won&#8217;t explain many basic concepts about AS7, maven and IntelliJ in
this article because there are already many good introductions on these
topics. So before doing the real work, there some preparations should be
done firstly:</p>
</div>
<div class="paragraph">
<p><strong>Download JBoss AS7</strong></p>
</div>
<div class="paragraph">
<p>It could be downloaded from here:
<a href="http://www.jboss.org/jbossas/downloads/" class="bare">http://www.jboss.org/jbossas/downloads/</a></p>
</div>
<div class="paragraph">
<p>Using the latest release would be fine. When I&#8217;m writing this article
the latest version is 7.1.1.Final.</p>
</div>
<div class="paragraph">
<p><strong>Install Maven</strong></p>
</div>
<div class="paragraph">
<p>Please make sure you have maven installed on your machine. Here is my
environment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">weli@power:~$ mvn -version
Apache Maven 3.0.3 (r1075438; 2011-03-01 01:31:09+0800)
Maven home: /usr/share/maven
Java version: 1.6.0_33, vendor: Apple Inc.
Java home: /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home
Default locale: en_US, platform encoding: MacRoman
OS name: &quot;mac os x&quot;, version: &quot;10.8&quot;, arch: &quot;x86_64&quot;, family: &quot;mac&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Get IntelliJ</strong></p>
</div>
<div class="paragraph">
<p>In this article I&#8217;d like to use IntelliJ Ultimate Edition as the IDE for
development, it&#8217;s a commercial software and can be downloaded from:
<a href="http://www.jetbrains.com/idea/" class="bare">http://www.jetbrains.com/idea/</a></p>
</div>
<div class="paragraph">
<p>The version I&#8217;m using is IntelliJ IDEA Ultimate 11.1</p>
</div>
<div class="paragraph">
<p>After all of these prepared, we can dive into the real work:</p>
</div>
<div class="sect3">
<h4 id="create-a-project-using-maven">8.1.1. Create a project using Maven</h4>
<div class="paragraph">
<p>Use the following maven command to create a web project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">mvn archetype:create -DarchetypeGroupId=org.apache.maven.archetypes \
-DarchetypeArtifactId=maven-archetype-webapp \
-DarchetypeVersion=1.0 \
-DgroupId=net.bluedash \
-DartifactId=jsfdemo \
-Dversion=1.0-SNAPSHOT</code></pre>
</div>
</div>
<div class="paragraph">
<p>If everything goes fine maven will generate the project for us:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/8108c4f111aab2c3465472eb84cf1d9b7cf912d0.jpg" alt="images/jsf/8108c4f111aab2c3465472eb84cf1d9b7cf912d0.jpg"></span></p>
</div>
<div class="paragraph">
<p>The contents of the project is shown as above.</p>
</div>
</div>
<div class="sect3">
<h4 id="add-jsf-into-project">8.1.2. Add JSF into project</h4>
<div class="paragraph">
<p>The JSF library is now included in maven repo, so we can let maven to
manage the download for us. First is to add repository into our pom.xml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">&lt;repository&gt;
  &lt;id&gt;jvnet-nexus-releases&lt;/id&gt;
  &lt;name&gt;jvnet-nexus-releases&lt;/name&gt;
  &lt;url&gt;https:<span class="comment">//maven.java.net/content/repositories/releases/&lt;/url&gt;</span>
&lt;/repository&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we add JSF dependency into pom.xml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>javax.faces<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>jsf-api<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>2.1<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;scope&gt;</span>provided<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note the 'scope' is 'provided', because we don&#8217;t want to bundle
the jsf.jar into the war produced by our project later, as JBoss AS7
already have jsf bundled in.</p>
</div>
<div class="paragraph">
<p>Then we run 'mvn install' to update the project, and maven will download
jsf-api for us automatically.</p>
</div>
</div>
<div class="sect3">
<h4 id="writing-code">8.1.3. Writing Code</h4>
<div class="paragraph">
<p>Writing JSF code in this article is trivial, so I&#8217;ve put written a
project called 'jsfdemo' onto github:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/liweinan/jsfdemo" class="bare">https://github.com/liweinan/jsfdemo</a></p>
</div>
<div class="paragraph">
<p>Please clone this project into your local machine, and import it into
IntelliJ following the steps described as above.</p>
</div>
</div>
<div class="sect3">
<h4 id="add-jboss-as-7-deploy-plugin-into-project">8.1.4. Add JBoss AS 7 deploy plugin into project</h4>
<div class="paragraph">
<p>JBoss AS7 has provide a set of convenient maven plugins to perform daily
tasks such as deploying project into AS7. In this step let&#8217;s see how to
use it in our project.</p>
</div>
<div class="paragraph">
<p>We should put AS7&#8217;s repository into pom.xml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;repository&gt;</span>
    <span class="tag">&lt;id&gt;</span>jboss-public-repository-group<span class="tag">&lt;/id&gt;</span>
    <span class="tag">&lt;name&gt;</span>JBoss Public Repository Group<span class="tag">&lt;/name&gt;</span>
    <span class="tag">&lt;url&gt;</span>http://repository.jboss.org/nexus/content/groups/public/<span class="tag">&lt;/url&gt;</span>
    <span class="tag">&lt;layout&gt;</span>default<span class="tag">&lt;/layout&gt;</span>
    <span class="tag">&lt;releases&gt;</span>
        <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
        <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
    <span class="tag">&lt;/releases&gt;</span>
    <span class="tag">&lt;snapshots&gt;</span>
        <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>
        <span class="tag">&lt;updatePolicy&gt;</span>never<span class="tag">&lt;/updatePolicy&gt;</span>
    <span class="tag">&lt;/snapshots&gt;</span>
<span class="tag">&lt;/repository&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And also the plugin repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">&lt;pluginRepository&gt;
    &lt;id&gt;jboss-<span class="directive">public</span>-repository-group&lt;/id&gt;
    &lt;name&gt;JBoss Public Repository <span class="predefined-type">Group</span>&lt;/name&gt;
    &lt;url&gt;http:<span class="comment">//repository.jboss.org/nexus/content/groups/public/&lt;/url&gt;</span>
    &lt;releases&gt;
        &lt;enabled&gt;<span class="predefined-constant">true</span>&lt;/enabled&gt;
    &lt;/releases&gt;
    &lt;snapshots&gt;
        &lt;enabled&gt;<span class="predefined-constant">true</span>&lt;/enabled&gt;
    &lt;/snapshots&gt;
&lt;/pluginRepository&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>And put jboss deploy plugin into 'build' section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">&lt;plugin&gt;
    &lt;groupId&gt;org.jboss.as.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;jboss-as-maven-plugin&lt;/artifactId&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;phase&gt;<span class="keyword">package</span>&lt;/<span class="namespace">phase</span>&gt;
            &lt;<span class="namespace">goals</span>&gt;
                &lt;<span class="namespace">goal</span>&gt;<span class="namespace">deploy</span>&lt;/<span class="namespace">goal</span>&gt;
            &lt;/<span class="namespace">goals</span>&gt;
        &lt;/<span class="namespace">execution</span>&gt;
    &lt;/<span class="namespace">executions</span>&gt;
&lt;/<span class="namespace">plugin</span>&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>I&#8217;ve put the final version pom.xml here to check whether your
modification is correct:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/liweinan/jsfdemo/blob/master/pom.xml" class="bare">https://github.com/liweinan/jsfdemo/blob/master/pom.xml</a></p>
</div>
<div class="paragraph">
<p>Now we have finished the setup work for maven.</p>
</div>
</div>
<div class="sect3">
<h4 id="deploy-project-to-jboss-as-7">8.1.5. Deploy project to JBoss AS 7</h4>
<div class="paragraph">
<p>To deploy the project to JBoss AS7, we should start AS7 firstly. In
JBoss AS7 directory, run following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">bin/standalone.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>AS7 should start in a short time. Then let&#8217;s go back to our project
directory and run maven command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn -q jboss-as:deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p>Maven will use some time to download necessary components for a while,
so please wait patiently. After a while, we can see the result:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/97d781c6be9db755aef80a110f1d9b29590610d6.jpg" alt="images/jsf/97d781c6be9db755aef80a110f1d9b29590610d6.jpg"></span></p>
</div>
<div class="paragraph">
<p>And if you check the console output of AS7, you can see the project is
deployed:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/2._java.jpg" alt="images/jsf/2._java.jpg"></span></p>
</div>
<div class="paragraph">
<p>Now we have learnt how to create a JSF project and deploy it to AS7
without any help from graphical tools. Next let&#8217;s see how to use
IntelliJ IDEA to go on developing/debugging our project.</p>
</div>
</div>
<div class="sect3">
<h4 id="import-project-into-intellij">8.1.6. Import project into IntelliJ</h4>
<div class="paragraph">
<p>Now it&#8217;s time to import the project into IntelliJ. Now let&#8217;s open
IntelliJ, and choose 'New Project&#8230;&#8203;':</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/05222f3059e387df96ce04d2aea156c82af15096.jpg" alt="images/jsf/05222f3059e387df96ce04d2aea156c82af15096.jpg"></span></p>
</div>
<div class="paragraph">
<p>The we choose 'Import project from external model':</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/d68a0cdbc8c90db3db8af998f34616f73c7fe809.jpg" alt="images/jsf/d68a0cdbc8c90db3db8af998f34616f73c7fe809.jpg"></span></p>
</div>
<div class="paragraph">
<p>Next step is choosing 'Maven':</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/0b3d1cb5794fb54a2465da93648b5a0d1a6643f3.jpg" alt="images/jsf/0b3d1cb5794fb54a2465da93648b5a0d1a6643f3.jpg"></span></p>
</div>
<div class="paragraph">
<p>Then IntelliJ will ask you the position of the project you want to
import. In 'Root directory' input your project&#8217;s directory and leave
other options as default:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/2f192d02993248c97e2ac42ea8f3105d855e5cdf.jpg" alt="images/jsf/2f192d02993248c97e2ac42ea8f3105d855e5cdf.jpg"></span></p>
</div>
<div class="paragraph">
<p>For next step, just click 'Next':</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/3a3ee36eb581930822c4a66362795345f5d2f9a7.jpg" alt="images/jsf/3a3ee36eb581930822c4a66362795345f5d2f9a7.jpg"></span></p>
</div>
<div class="paragraph">
<p>Finally click 'Finish':</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/91e40cd0b1545cff4622857d6dc9959f96faf056.jpg" alt="images/jsf/91e40cd0b1545cff4622857d6dc9959f96faf056.jpg"></span></p>
</div>
<div class="paragraph">
<p>Hooray! We&#8217;ve imported the project into IntelliJ now <span class="icon yellow"><i class="fa fa-smile-o"></i></span></p>
</div>
</div>
<div class="sect3">
<h4 id="adding-intellij-jsf-support-to-project">8.1.7. Adding IntelliJ JSF support to project</h4>
<div class="paragraph">
<p>Let&#8217;s see how to use IntelliJ and AS7 to debug the project. First we
need to add 'JSF' facet into project. Open project setting:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/8b8d0051f4f15033f17cb859c65f2d8481914678.jpg" alt="images/jsf/8b8d0051f4f15033f17cb859c65f2d8481914678.jpg"></span></p>
</div>
<div class="paragraph">
<p>Click on 'Facets' section on left; Select 'Web' facet that we already
have, and click the '+' on top, choose 'JSF':</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/e6947b84a56a698ca1392a440081bddfb5cae284.jpg" alt="images/jsf/e6947b84a56a698ca1392a440081bddfb5cae284.jpg"></span></p>
</div>
<div class="paragraph">
<p>Select 'Web' as parent facet:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/6b2296be1bb2d8a81952caef0f025a139a39b381.jpg" alt="images/jsf/6b2296be1bb2d8a81952caef0f025a139a39b381.jpg"></span></p>
</div>
<div class="paragraph">
<p>Click 'Ok':</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/9988c572bad281146f405e9287f645a3da201885.jpg" alt="images/jsf/9988c572bad281146f405e9287f645a3da201885.jpg"></span></p>
</div>
<div class="paragraph">
<p>Now we have enabled IntelliJ&#8217;s JSF support for project.</p>
</div>
</div>
<div class="sect3">
<h4 id="add-jboss-as7-to-intellij">8.1.8. Add JBoss AS7 to IntelliJ</h4>
<div class="paragraph">
<p>Let&#8217;s add JBoss AS7 into IntelliJ and use it to debug our project. First
please choose 'Edit Configuration' in menu tab:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/dc0550785aae11f9d3eb439fdc0c51069affd25d.jpg" alt="images/jsf/dc0550785aae11f9d3eb439fdc0c51069affd25d.jpg"></span></p>
</div>
<div class="paragraph">
<p>Click '+' and choose 'JBoss Server' &#8594; 'Local':</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/1231420c938f087030cb3dcd37237b5585beb154.jpg" alt="images/jsf/1231420c938f087030cb3dcd37237b5585beb154.jpg"></span></p>
</div>
<div class="paragraph">
<p>Click 'configure':</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/d7e6ab58230b2d31fdcd8fd5f14cd4eb47b05f64.jpg" alt="images/jsf/d7e6ab58230b2d31fdcd8fd5f14cd4eb47b05f64.jpg"></span></p>
</div>
<div class="paragraph">
<p>and choose your JBoss AS7:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/f7b29ac8009f04fc7f209222ced0bcf54f4b8d9a.jpg" alt="images/jsf/f7b29ac8009f04fc7f209222ced0bcf54f4b8d9a.jpg"></span></p>
</div>
<div class="paragraph">
<p>Now we need to add our project into deployment. Click the 'Deployment'
tab:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/6802fb7e29283d0e064a7cc4466b918995ba5645.jpg" alt="images/jsf/6802fb7e29283d0e064a7cc4466b918995ba5645.jpg"></span></p>
</div>
<div class="paragraph">
<p>Choose 'Artifact', and add our project:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/359484b8f6f2c655d94132e9cb6f9dbe5a058656.jpg" alt="images/jsf/359484b8f6f2c655d94132e9cb6f9dbe5a058656.jpg"></span></p>
</div>
<div class="paragraph">
<p>Leave everything as default and click 'Ok', now we&#8217;ve added JBoss AS7
into IntelliJ</p>
</div>
</div>
<div class="sect3">
<h4 id="debugging-project-with-intellij-and-as7">8.1.9. Debugging project with IntelliJ and AS7</h4>
<div class="paragraph">
<p>Now comes the fun part. To debug our project, we cannot directly use the
'debug' feature provided by IntelliJ right now(maybe in the future
version this problem could be fixed). So now we should use the debugging
config provided by AS7 itself to enable JPDA feature, and then use the
remote debug function provided by IntelliJ to get things done. Let&#8217;s
dive into the details now:</p>
</div>
<div class="paragraph">
<p>First we need to enable JPDA config inside AS7, open
'bin/standalone.conf' and find following lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="error">#</span> Sample JPDA settings <span class="keyword">for</span> remote socket debugging
<span class="error">#</span>JAVA_OPTS=<span class="string"><span class="delimiter">&quot;</span><span class="content">$JAVA_OPTS -Xrunjdwp:transport=dt_socket,address=8787,server=y,suspend=n</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Enable the above config by removing the leading hash sign:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="error">#</span> Sample JPDA settings <span class="keyword">for</span> remote socket debugging
JAVA_OPTS=<span class="string"><span class="delimiter">&quot;</span><span class="content">$JAVA_OPTS -Xrunjdwp:transport=dt_socket,address=8787,server=y,suspend=n</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
With WildFly you can directly start the server in debug mode:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">bin/standalone.sh --debug --server-config=standalone.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we start AS7 in IntelliJ:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/52369d67f9117c924213de24dd6642b48e47a436.png" alt="images/jsf/52369d67f9117c924213de24dd6642b48e47a436.png"></span></p>
</div>
<div class="paragraph">
<p>Please note we should undeploy the existing 'jsfdemo' project in AS7 as
we&#8217;ve added by maven jboss deploy plugin before. Or AS7 will tell us
there is already existing project with same name so IntelliJ could not
deploy the project anymore.</p>
</div>
<div class="paragraph">
<p>If the project start correctly we can see from the IntelliJ console
window, and please check the debug option is enabled:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/eaac5cb1a836809ab29513346b527fe051b7c7ac.png" alt="images/jsf/eaac5cb1a836809ab29513346b527fe051b7c7ac.png"></span></p>
</div>
<div class="paragraph">
<p>Now we will setup the debug configuration, click 'debug' option on menu:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/b8323caf6980c40c3d635db5e308b03847618d06.jpg" alt="images/jsf/b8323caf6980c40c3d635db5e308b03847618d06.jpg"></span></p>
</div>
<div class="paragraph">
<p>Choose 'Edit Configurations':</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/8327bbe0e83cb7170dd84767631c98956e91c42c.jpg" alt="images/jsf/8327bbe0e83cb7170dd84767631c98956e91c42c.jpg"></span></p>
</div>
<div class="paragraph">
<p>Then we click 'Add' and choose Remote:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/7103da6b6323e515a03a04cafe111aa7c6b3169d.jpg" alt="images/jsf/7103da6b6323e515a03a04cafe111aa7c6b3169d.jpg"></span></p>
</div>
<div class="paragraph">
<p>Set the 'port' to the one you used in AS7 config file 'standalone.conf':</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/30bbef45137c7d45ae300ba8d551423d1feefc96.png" alt="images/jsf/30bbef45137c7d45ae300ba8d551423d1feefc96.png"></span></p>
</div>
<div class="paragraph">
<p>Leave other configurations as default and click 'Ok'. Now we need to set
breakpoints in project, let&#8217;s choose TimeBean.java and set a breakpoint
on 'getNow()' method by clicking the left side of that line of code:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/a96b7d32e04aa67956bd00a187f09b75a5af241e.jpg" alt="images/jsf/a96b7d32e04aa67956bd00a187f09b75a5af241e.jpg"></span></p>
</div>
<div class="paragraph">
<p>Now we can use the profile to do debug:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/5ea6987d1635c2c58d3ccdb1f5718f29d6a0fac3.png" alt="images/jsf/5ea6987d1635c2c58d3ccdb1f5718f29d6a0fac3.png"></span></p>
</div>
<div class="paragraph">
<p>If everything goes fine we can see the console output:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/1096ebbbf2b29e694e300e02a48d0fa4207cb746.jpg" alt="images/jsf/1096ebbbf2b29e694e300e02a48d0fa4207cb746.jpg"></span></p>
</div>
<div class="paragraph">
<p>Now we go to web browser and see our project&#8217;s main page, try to click
on 'Get current time':</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/5ad5d0216d3326e9bc29705042db59f11c3c1e70.png" alt="images/jsf/5ad5d0216d3326e9bc29705042db59f11c3c1e70.png"></span></p>
</div>
<div class="paragraph">
<p>Then IntelliJ will popup and the code is pausing on break point:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/images/jsf/2499d43c0dce2cab72ba472c8452a2b57999ac84.jpg" alt="images/jsf/2499d43c0dce2cab72ba472c8452a2b57999ac84.jpg"></span></p>
</div>
<div class="paragraph">
<p>And we could inspect our project now.</p>
</div>
</div>
<div class="sect3">
<h4 id="conclusion">8.1.10. Conclusion</h4>
<div class="paragraph">
<p>In this article I&#8217;ve shown to you how to use maven to create a project
using JSF and deploy it in JBoss AS7, and I&#8217;ve also talked about the
usage of IntelliJ during project development phase. Hope the contents
are practical and helpful to you <span class="icon yellow"><i class="fa fa-smile-o"></i></span></p>
</div>
</div>
<div class="sect3">
<h4 id="references">8.1.11. References</h4>
<div class="ulist">
<ul>
<li>
<p><em><a href="https://community.jboss.org/wiki/JBossAS7UsingJPDAToDebugTheASSourceCode">JBoss
AS7: Using JPDA to debug the AS source code</a></em></p>
</li>
<li>
<p><em><a href="http://navinpeiris.com/2011/07/19/importing-jboss-7-dependencies-through-maven/">Importing
JBoss 7 Bundled Dependency Versions Through Maven</a></em></p>
</li>
<li>
<p><em><a href="https://community.jboss.org/wiki/MavenGettingStarted-Developers">Maven
Getting Started - Developers</a></em></p>
</li>
<li>
<p><em><a href="http://localhost:8090/blog.v-s-f.co.uk/2010/09/jsf-2-1-project-using-eclipse-and-maven-2/">JSF
2.1 project using Eclipse and Maven 2:http</a></em></p>
</li>
<li>
<p><em><a href="http://www.amazon.com/Practical-RichFaces-Max-Katz/dp/1430234490/ref=dp_ob_title_bk">Practical
RichFaces</a></em></p>
</li>
<li>
<p><em><a href="http://javaserverfaces.java.net/download.html">Oracle Mojarra
JavaServer Faces</a></em></p>
</li>
<li>
<p><em><a href="https://github.com/jbossas/jboss-as-maven-plugin">JBoss AS7 Maven
Plugin</a></em></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Getting_Started_Developing_Applications_Presentation_Demo">8.2. Getting Started Developing Applications Presentation &amp; Demo</h3>
<div class="paragraph">
<p>This document is a "script" for use with the quickstarts associated with
the <a href="Getting_Started_Developing_Applications_Guide.html">Getting
Started Developing Applications Guide</a>. It can be used as the basis for
demoing/explaining the Java EE 6 programming model with JBoss AS 7.</p>
</div>
<div class="paragraph">
<p>There is an associated presentation  JBoss AS - Getting Started
Developing Applications  which can be used to introduce the Java EE 6
ecosystem.</p>
</div>
<div class="paragraph">
<p>The emphasis here is on the programming model, not on OAM/dev-ops,
performance etc.</p>
</div>
<div class="sect3">
<h4 id="prerequisites-for-using-the-script">8.2.1. Prerequisites for using the script</h4>
<div class="ulist">
<ul>
<li>
<p>JBoss AS 7 downloaded and installed</p>
</li>
<li>
<p>Eclipse Indigo with m2eclipse and JBoss Tools installed</p>
</li>
<li>
<p>The quickstarts downloaded and imported into Eclipse</p>
</li>
<li>
<p>Make sure <code>$JBOSS_HOME</code> is set.</p>
</li>
<li>
<p>Make sure <code>src/test/resources/arquillian.xml</code> has the correct path to
your JBoss AS install for kitchensink</p>
</li>
<li>
<p>Make sure your font size is set in Eclipse so everyone can read the
text!</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="import-examples-into-eclipse-and-set-up-jboss-as">8.2.2. Import examples into Eclipse and set up JBoss AS</h4>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect3">
<h4 id="the-helloworld-quickstart">8.2.3. The Helloworld Quickstart</h4>
<div class="sect4">
<h5 id="introduction-1">Introduction</h5>
<div class="paragraph">
<p>This quickstart is extremely basic, and is really useful for nothing
more than showing than the app server is working properly, and our
deployment mechanism is working. We recommend you use this quickstart to
demonstrate the various ways you can deploy apps to JBoss AS 7.</p>
</div>
</div>
<div class="sect4">
<h5 id="using-maven">Using Maven</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start JBoss AS 7 from the console</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="error">$</span>JBOSS_HOME/bin/standalone.sh</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploy the app using Maven</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn clean <span class="keyword">package</span> <span class="namespace">jboss</span>-<span class="namespace">as</span>:<span class="namespace">deploy</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The quickstarts use the jboss-as maven plugin to deploy and undeploy
applications. This plugin uses the JBoss AS Native Java Detyped
Management API to communicate with the server. The Detyped API is used
by management tools to control an entire domain of servers, and exposes
only a small number of types, allowing for backwards and forwards
compatibility.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Show the app has deployed in the terminal</p>
</div>
<div class="paragraph">
<p>Visit <a href="http://localhost:8080/jboss-as-helloworld" class="bare">http://localhost:8080/jboss-as-helloworld</a></p>
</div>
<div class="paragraph">
<p>Undeploy the app using Maven</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn jboss-as:undeploy</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="using-the-command-line-interface-cli">Using the Command Line Interface (CLI)</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start JBoss AS 7 from the console (if not already running)</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="error">$</span>JBOSS_HOME/bin/standalone.sh</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Build the war</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn clean <span class="keyword">package</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Start the CLI</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="error">$</span>JBOSS_HOME/bin/jboss-admin.sh --connect</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The command line also uses the Deptyped Management API to communicate
with the server. It&#8217;s designed to be as "unixy" as possible, allowing
you to "cd" into nodes, with full tab completion etc. The CLI allows you
to deploy and undeploy applications, create JMS queues, topics etc.,
create datasources (normal and XA). It also fully supports the domain
node.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Deploy the app</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">deploy target/jboss-as-helloworld.war</code></pre>
</div>
</div>
<div class="paragraph">
<p>Show the app has deployed</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">undeploy jboss-as-helloworld.war</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="using-the-web-management-interface">Using the web management interface</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start JBoss AS 7 from the console (if not already running)</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="error">$</span>JBOSS_HOME/bin/standalone.sh</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Build the war</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn clean <span class="keyword">package</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Open up the web management interface <a href="http://localhost:9990/console" class="bare">http://localhost:9990/console</a></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The web maangement interface offers the same functionality as the CLI
(and again uses the Detyped Management API), but does so using a pretty
GWT interface! You can set up virtual servers, interrogate sub systems
and more.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Navigate <code>Manage Deployments &#8594; Add content</code>. Click on choose file and
locate <code>helloworld/target/jboss-as-helloworld.war</code>.</p>
</div>
<div class="paragraph">
<p>Click <code>Next</code> and <code>Finish</code> to upload the war to the server.</p>
</div>
<div class="paragraph">
<p>Now click <code>Enable</code> and <code>Ok</code> to start the application</p>
</div>
<div class="paragraph">
<p>Switch to the console to show it deployed</p>
</div>
<div class="paragraph">
<p>Now click <code>Remove</code></p>
</div>
</div>
<div class="sect4">
<h5 id="using-the-filesystem">Using the filesystem</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start JBoss AS 7 from the console (if not already running)</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="error">$</span>JBOSS_HOME/bin/standalone.sh</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Build the war</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvn clean <span class="keyword">package</span></code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Of course, you can still use the good ol' file system to deploy. Just
copy the file to <code>$JBOSS_HOME/standalone/deployments</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Copy the war</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">cp target/jboss-as-helloworld.war <span class="error">$</span>JBOSS_HOME/standalone/deployments</code></pre>
</div>
</div>
<div class="paragraph">
<p>Show the war deployed</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The filesystem deployment uses marker files to indicate the status of a
deployment. As this deployment succeeded we get a
<code>$JBOSS_HOME/standalone/deployments/jboss-as-helloworld.war.deployed</code>
file. If the deployment failed, you would get a <code>.failed</code> file etc.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Undeploy the war</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">rm <span class="error">$</span>JBOSS_HOME/standalone/deployments/jboss-as-helloworld.war.deployed</code></pre>
</div>
</div>
<div class="paragraph">
<p>Show the deployment stopping!</p>
</div>
<div class="paragraph">
<p>Start and stop the appserver, show that the deployment really is gone!</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This gives you much more precise control over deployments than before
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="using-eclipse">Using Eclipse</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add a JBoss AS server</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Bring up the Server view</p>
</li>
<li>
<p>Right click in it, and choose <code>New &#8594; Server</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Choose JBoss AS 7.0 and hit Next</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Locate the server on your disc</p>
</li>
<li>
<p>Hit Finish</p>
</li>
</ol>
</div>
</li>
<li>
<p>Start JBoss AS in Eclipse</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select the server</p>
</li>
<li>
<p>Click the Run button</p>
</li>
<li>
<p>Deploy the app</p>
</li>
</ol>
</div>
</li>
<li>
<p>right click on the app, choose <code>Run As &#8594; Run On Server</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select the AS 7 instance you want to use</p>
</li>
<li>
<p>Hit finish</p>
</li>
</ol>
</div>
</li>
<li>
<p>Load the app at <a href="http://localhost:8080/jboss-as-helloworld" class="bare">http://localhost:8080/jboss-as-helloworld</a></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="digging-into-the-app">Digging into the app</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open up the helloworld quickstart in Eclipse, and open up
<code>src/main/webapp</code>.</p>
</li>
<li>
<p>Point out that we don&#8217;t require a <code>web.xml</code> anymore!</p>
</li>
<li>
<p>Show <code>beans.xml</code> and explain it&#8217;s a marker file used to JBoss AS to
enable CDI (open it, show that it is empty)</p>
</li>
<li>
<p>Show <code>index.html</code>, and explain it is just used to kick the user into
the app (open it, show the meta-refresh)</p>
</li>
<li>
<p>Open up the <code>pom.xm</code> - and emphasise that it&#8217;s pretty simple.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>There is no parent pom, everything for the build is <strong>here</strong></p>
</li>
<li>
<p>Show that we are enabling the JBoss Maven repo - explain you can do
this in your POM or in system wide ( <code>settings.xml</code>)</p>
</li>
<li>
<p>Show the <code>dependencyManagement</code> section. Here we import the JBoss AS
7 Web Profile API. Explain that this gives you all the versions for all
of the JBoss AS 7 APIs that are in the web profile. Explain we could
also depend on this directly, which would give us the whole set of APIs,
but that here we&#8217;ve decided to go for slightly tighter control and
specify each dependency ourselves</p>
</li>
<li>
<p>Show the import for CDI, JSR-250 and Servlet API. Show that these
are all provided - we are depending on build in server implementations,
not packaging this stuff!</p>
</li>
<li>
<p>Show the plugin sections - nothing that exciting here, the war
plugin is out of date and requires you to provide <code>web.xml</code> <span class="icon yellow"><i class="fa fa-smile-o"></i></span>
, configure the JBoss AS Maven Plugin, set the Java version to 6.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Open up <code>src/main/java</code> and open up the <code>HelloWorldServlet</code>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Point out the <code>@WebServlet</code> - explain this one annotation removes
about 8 lines of XML - no need to separately map a path either. This is
much more refactor safe</p>
</li>
<li>
<p>Show that we can inject services into a Servlet</p>
</li>
<li>
<p>Show that we use the service (line 41)<br>
#Cmd-click on <code>HelloService</code></p>
</li>
<li>
<p>This is a CDI bean - very simple, no annotations required!</p>
</li>
<li>
<p>Explain injection</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Probably used to string based bean resolution</p>
</li>
<li>
<p>This is typesafe (refactor safe, take advantage of the compiler and
the IDE - we just saw that!)</p>
</li>
<li>
<p>When CDI needs to inject something, the first thing it looks at is
the type - and if the type of the injection point is assignable from a
bean, CDI will inject that bean</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="the-numberguess-quickstart">8.2.4. The numberguess quickstart</h4>
<div class="sect4">
<h5 id="introduction-2">Introduction</h5>
<div class="paragraph">
<p>This quickstart adds in a "complete" view layer into the mix. Java EE
ships with a JSF. JSF is a server side rendering, component orientated
framework, where you write markup using an HTML like language, adding in
dynamic behavior by binding components to beans in the back end. The
quickstart also makes more use of CDI to wire the application together.</p>
</div>
</div>
<div class="sect4">
<h5 id="run-the-app">Run the app</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start JBoss AS in Eclipse</p>
</li>
<li>
<p>Deploy it using Eclipse - just right click on the app, choose
<code>Run As &#8594; Run On Server</code></p>
</li>
<li>
<p>Select the AS 7 instance you want to use</p>
</li>
<li>
<p>Hit finish</p>
</li>
<li>
<p>Load the app at <a href="http://localhost:8080/jboss-as-numberguess" class="bare">http://localhost:8080/jboss-as-numberguess</a></p>
</li>
<li>
<p>Make a few guesses</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deployment-descriptors-srcmainwebappweb-inf">Deployment descriptors src/main/webapp/WEB-INF</h5>
<div class="paragraph">
<p>Emphasize the lack of them!</p>
</div>
<div class="paragraph">
<p>No need to open any of them, just point them out</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>web.xml</code> - don&#8217;t need it!</p>
</li>
<li>
<p><code>beans.xml</code> - as before, marker file</p>
</li>
<li>
<p><code>faces-config.xml</code> - nice feature from AS7 - we can just put
<code>faces-config.xml</code> into the WEB-INF and it enables JSF (inspiration from
CDI)</p>
</li>
<li>
<p><code>pom.xml</code> we saw this before, this time it&#8217;s the same but adds in
JSF API</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="views">Views</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>index.html</code> - same as before, just kicks us into the app</p>
</li>
<li>
<p><code>home.xhtml</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Lines 19 - 25  these are messages output depending on state of
beans (minimise coupling between controller and view layer by
interrogating state, not pushing)</p>
</li>
</ol>
</div>
</li>
<li>
<p>Line 20  output any messages pushed out by the controller</p>
</li>
<li>
<p>Line 39 - 42  the input field is bound to the guess field on the
game bean. We validate the input by calling a method on the game bean.</p>
</li>
<li>
<p>Line 43 - 45  the command button is used to submit the form, and
calls a method on the game bean</p>
</li>
<li>
<p>Line 48, 49, The reset button again calls a method on the game bean</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="beans">Beans</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Game.java</code>  this is the main controller for the game. App has no
persistence etc.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>@Named</code>  As we discussed CDI is typesafe, (beans are injected by
type) but sometimes need to access in a non-typesafe fashion. @Named
exposes the Bean in EL - and allows us to access it from JSF</p>
</li>
<li>
<p><code>@SessionScoped</code>  really simple app, we keep the game data in the
session - to play two concurrent games, need two sessions. This is not a
limitation of CDI, but simply keeps this demo very simple. CDI will
create a bean instance the first time the game bean is accessed, and
then always load that for you</p>
</li>
<li>
<p><code>@Inject maxNumber</code>  here we inject the maximum number we can
guess. This allows us to externalize the config of the game</p>
</li>
<li>
<p><code>@Inject rnadomNumber</code>  here we inject the random number we need to
guess. Two things to discuss here</p>
</li>
<li>
<p>Instance - normally we can inject the object itself, but sometimes
it&#8217;s useful to inject a "provider" of the object (in this case so that
we can get a new random number when the game is reset!). Instance allows
us to <code>get()</code> a new instance when needed</p>
</li>
<li>
<p>Qualifiers - now we have two types of Integer (CDI auto-boxes types
when doing injection) so we need to disambiguate. Explain qualifiers and
development time approach to disambiguation. You will want to open up
<code>@MaxNumber</code> and <code>@Random</code> here.</p>
</li>
<li>
<p><code>@PostConstruct</code>  here is our reset method - we also call it on
startup to set up initial values. Show use of <code>Instance.get()</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p><code>Generator.java</code> This bean acts as our random number generator.</p>
</li>
<li>
<p><code>@ApplicationScoped</code> explain about other scopes available in CDI<br>
extensibility.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>next()</code> Explain about producers being useful for determining bean
instance at runtime</p>
</li>
<li>
<p><code>getMaxNumber()</code> Explain about producers allowing for loose coupling</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="the-login-quickstart">8.2.5. The login quickstart</h4>
<div class="sect4">
<h5 id="introduction-3">Introduction</h5>
<div class="paragraph">
<p>The login quickstart builds on the knowledge of CDI and JSF we have got
from numberguess. New stuff we will learn about is how to use JPA to
store data in a database, how to use JTA to control transactions, and
how to use EJB for declarative TX control.</p>
</div>
</div>
<div class="sect4">
<h5 id="run-the-app-1">Run the app</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start JBoss AS in Eclipse</p>
</li>
<li>
<p>Deploy it using Eclipse - just right click on the app, choose
<code>Run As &#8594; Run On Server</code></p>
</li>
<li>
<p>Select the AS 7 instance you want to use</p>
</li>
<li>
<p>Hit finish</p>
</li>
<li>
<p>Load the app at <a href="http://localhost:8080/jboss-as-login" class="bare">http://localhost:8080/jboss-as-login</a></p>
</li>
<li>
<p>Login as admin/admin</p>
</li>
<li>
<p>Create a new user</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deployment-descriptors">Deployment Descriptors</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Show that we have the same ones we are used in <code>src/main/webapp</code> 
<code>beans.xml</code>, <code>faces-config.xml</code></p>
</li>
<li>
<p>We have a couple of new ones in <code>src/main/resources</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>persistence.xml</code>. Not too exciting. We are using a datasource that
AS7 ships with. It&#8217;s backed by the H2 database and is purely a sample
datasource to use in sample applications. We also tell Hibernate to
auto-create tables - as you always have.</p>
</li>
<li>
<p><code>import.sql</code> Again, the same old thing you are used to in Hibernate</p>
<div class="ulist">
<ul>
<li>
<p>auto-import data when the app starts.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li>
<p><code>pom.xml</code> is the same again, but just adds in dependencies for JPA,
JTA and EJB</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="views-1">Views</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>template.xhtml</code> One of the updates added to JSF 2.0 was templating
ability. We take advantage of that in this app, as we have multiple
views</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Actually nothing too major here, we define the app "title" and we
could easily define a common footer etc. (we can see this done in the
kitchensink app)</p>
</li>
<li>
<p>The <code>ui:insert</code> command inserts the actual content from the
templated page.<br>
# <code>home.xhtml</code></p>
</li>
<li>
<p>Uses the template</p>
</li>
<li>
<p>Has some input fields for the login form, button to login and
logout, link to add users.</p>
</li>
<li>
<p>Binds fields to credentials bean}}</p>
</li>
<li>
<p>Buttons link to login bean which is the controller</p>
</li>
</ol>
</div>
</li>
<li>
<p><code>users.xhtml</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Uses the template</p>
</li>
<li>
<p>Displays all users using a table</p>
</li>
<li>
<p>Has a form with input fields to add users.</p>
</li>
<li>
<p>Binds fields to the newUser bean</p>
</li>
<li>
<p>Methods call on userManager bean</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="beans-1">Beans</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Credentials.java</code> Backing bean for the login form field, pretty
trivial. It&#8217;s request scoped (natural for a login field) and named so we
can get it from JSF.</p>
</li>
<li>
<p><code>Login.java</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Is session scoped (a user is logged in for the length of their
session or until they log out}}</p>
</li>
<li>
<p>Is accessible from EL</p>
</li>
<li>
<p>Injects the current credentials</p>
</li>
<li>
<p>Uses the userManager service to load the user, and sends any
messages to JSF as needed</p>
</li>
<li>
<p>Uses a producer method to expose the @LoggedIn user (producer
methods used as we don&#8217;t know which user at development time)</p>
</li>
</ol>
</div>
</li>
<li>
<p><code>User.java</code> Is a pretty straightforward JPA entity. Mapped with
<code>@Entity</code>, has an natural id.</p>
</li>
<li>
<p><code>UserManager.java</code> This is an interface, and by default we use the
ManagedBean version, which requires manual TX control</p>
</li>
<li>
<p><code>ManagedBeanUserManager.java</code> - accessible from EL, request scoped.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Injects a logger (we&#8217;ll see how that is produced in a minute)</p>
</li>
<li>
<p>Injects the entity manager (again, just a min)</p>
</li>
<li>
<p>Inject the UserTransaction (this is provided by CDI)</p>
</li>
<li>
<p><code>getUsers()</code> standard JPA-QL that we know and love - but lots of
ugly TX handling code.</p>
</li>
<li>
<p>Same for <code>addUser()</code> and <code>findUser()</code> methods - very simple JPA
but&#8230;&#8203;</p>
</li>
<li>
<p>Got a couple of producer methods.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>getUsers()</code> is obvious - loads all the users in the database. No
ambiguity - CDI takes into account generic types when injecting. Also
note that CDI names respect JavaBean naming conventions</p>
</li>
<li>
<p><code>getNewUser()</code> is used to bind the new user form to from the view
layer - very nice as it decreases coupling - we could completely change
the wiring on the server side (different approach to creating the
newUser bean) and no need to change the view layer.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p><code>EJBUserManager.java</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>It&#8217;s an alternative  explain alternatives, and that they allow
selection of beans at deployment time</p>
</li>
<li>
<p>Much simple now we have declarative TX control.</p>
</li>
<li>
<p>Start to see how we can introduce EJB to get useful enterprise
services such as declarative TX control</p>
</li>
</ol>
</div>
</li>
<li>
<p><code>Resources.java</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>{EntityManager}</code> - explain resource producer pattern</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="the-kitchensink-quickstart">8.2.6. The kitchensink quickstart</h4>
<div class="sect4">
<h5 id="introduction-4">Introduction</h5>
<div class="paragraph">
<p>The kitchensink quickstart is generated from an archetype available for
JBoss AS (tell people to check the
<a href="/pages/createpage.action?spaceKey=WFLY&amp;title=Getting+Started+Developing+Applications&amp;linkCreation=true&amp;fromPageId=557131">Getting
Started Developing Applications</a> Guide for details). It demonstrates
CDI, JSF, EJB, JPA (which we&#8217;ve seen before) and JAX-RS and Bean
Validation as well. We add in Arquillian for testing.</p>
</div>
</div>
<div class="sect4">
<h5 id="run-the-app-2">Run the app</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start JBoss AS in Eclipse</p>
</li>
<li>
<p>Deploy it using Eclipse - just right click on the app, choose
<code>Run As &#8594; Run On Server</code></p>
</li>
<li>
<p>Select the AS 7 instance you want to use</p>
</li>
<li>
<p>Hit finish</p>
</li>
<li>
<p>Load the app at <a href="http://localhost:8080/jboss-as-kitchensink" class="bare">http://localhost:8080/jboss-as-kitchensink</a></p>
</li>
<li>
<p>Register a member - make sure to enter an invalid email and phone -
show bean validation at work</p>
</li>
<li>
<p>Click on the member URL and show the output from JAX-RS</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="bean-validation">Bean Validation</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Explain the benefits of bean validation - need your data always
valid (protect your data) AND good errors for your user. BV allows you
to express once, apply often.</p>
</li>
<li>
<p><code>index.xhtml</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Show the input fields  no validators attached</p>
</li>
<li>
<p>Show the message output</p>
</li>
</ol>
</div>
</li>
<li>
<p><code>Member.java</code></p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Hightlight the various validation annotations</p>
</li>
</ol>
</div>
</li>
<li>
<p>Java EE automatically applies the validators in both the persistence
layer and in your views</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="jax-rs">JAX-RS</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>index.xhtml</code> - Show that URL generation is just manual</p>
</li>
<li>
<p><code>JaxRsActivator.java</code> - simply activates JAX-RS</p>
</li>
<li>
<p><code>Member.java</code> - add JAXB annotation to make JAXB process the class properly</p>
</li>
<li>
<p><code>MemberResourceRESTService.java</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>@Path</code> sets the JAX-RS resource</p>
</li>
<li>
<p>JAX-RS services can use injection</p>
</li>
<li>
<p><code>@GET</code> methods are auto transformed to XML using JAXB</p>
</li>
</ol>
</div>
</li>
<li>
<p>And that is it!</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="arquillian">Arquillian</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure JBoss AS is running</p>
</li>
<li>
<p>[source, bash]</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn clean test -Parq-jbossas-remote</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Explain the difference between managed and remote</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Make sure JBoss AS is stopped</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">mvn clean test -Parq-jbossas-managed</code></pre>
</div>
</div>
<div class="paragraph">
<p>Start JBoss AS in Eclipse</p>
</div>
<div class="paragraph">
<p>Update the project to use the <code>arq-jbossas-remote</code> profile</p>
</div>
<div class="paragraph">
<p>Run the test from Eclipse</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Right click on test, <code>Run As &#8594; JUnit Test</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><code>MemberRegistrationTest.java</code></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Discuss micro deployments</p>
</li>
<li>
<p>Explain Arquilian allows you to use injection</p>
</li>
<li>
<p>Explain that Arquillian allows you to concentrate just on your test
logic</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 13.0.0.Final<br>
Last updated 2018-05-30 14:06:26 CDT
</div>
</div>
</body>
</html>