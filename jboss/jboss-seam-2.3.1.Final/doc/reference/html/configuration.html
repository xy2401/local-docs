<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 31. Configuring Seam and packaging Seam applications</title><link rel="stylesheet" href="css/seamframework.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="Seam - Contextual Components"/><link rel="up" href="index.html" title="Seam - Contextual Components"/><link rel="prev" href="search.html" title="Chapter 30. Hibernate Search"/><link rel="next" href="annotations.html" title="Chapter 32. Seam annotations"/></head><body><p id="title"><a href="http://www.seamframework.org" class="site_href"><strong>SeamFramework.org</strong></a><a href="http://www.seamframework.org/Documentation" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="search.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="annotations.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="configuration"/>Chapter 31. Configuring Seam and packaging Seam applications</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="configuration.html#d0e24252">31.1. Basic Seam configuration</a></span></dt><dd><dl><dt><span class="section"><a href="configuration.html#d0e24257">31.1.1. Integrating Seam with JSF and your servlet container</a></span></dt><dt><span class="section"><a href="configuration.html#d0e24307">31.1.2. Seam Resource Servlet</a></span></dt><dt><span class="section"><a href="configuration.html#d0e24317">31.1.3. Seam servlet filters</a></span></dt><dt><span class="section"><a href="configuration.html#config.integration.ejb.container">31.1.4. Integrating Seam with your EJB container</a></span></dt><dt><span class="section"><a href="configuration.html#d0e24776">31.1.5. Don't forget!</a></span></dt></dl></dd><dt><span class="section"><a href="configuration.html#alt-jpa-providers">31.2. Using Alternate JPA Providers</a></span></dt><dt><span class="section"><a href="configuration.html#d0e24854">31.3. Configuring Seam in Java EE 6</a></span></dt><dd><dl><dt><span class="section"><a href="configuration.html#d0e24864">31.3.1. Packaging</a></span></dt></dl></dd><dt><span class="section"><a href="configuration.html#d0e24920">31.4. Configuring Seam without EJB</a></span></dt><dd><dl><dt><span class="section"><a href="configuration.html#d0e24943">31.4.1. Boostrapping Hibernate in Seam</a></span></dt><dt><span class="section"><a href="configuration.html#d0e24966">31.4.2. Boostrapping JPA in Seam</a></span></dt><dt><span class="section"><a href="configuration.html#d0e24989">31.4.3. Packaging</a></span></dt></dl></dd><dt><span class="section"><a href="configuration.html#d0e24998">31.5. Configuring Seam in Java SE</a></span></dt><dt><span class="section"><a href="configuration.html#d0e25014">31.6. Configuring jBPM in Seam</a></span></dt><dd><dl><dt><span class="section"><a href="configuration.html#d0e25036">31.6.1. Packaging</a></span></dt></dl></dd><dt><span class="section"><a href="configuration.html#d0e25043">31.7. Deployment in JBoss AS 7</a></span></dt><dt><span class="section"><a href="configuration.html#d0e25095">31.8. Configuring SFSB and Session Timeouts in JBoss AS 7</a></span></dt><dt><span class="section"><a href="configuration.html#d0e25128">31.9. Running Seam in a Portlet</a></span></dt><dt><span class="section"><a href="configuration.html#d0e25136">31.10. Deploying custom resources</a></span></dt></dl></div><p> Configuration is a very boring topic and an extremely tedious pastime. Unfortunately, several lines of XML
        are required to integrate Seam into your JSF implementation and servlet container. There's no need to be too put
        off by the following sections; you'll never need to type any of this stuff yourself, since you can just use 
        seam-gen to start your application or you can copy and paste from the example applications! </p><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e24252"/>31.1. Basic Seam configuration</h2></div></div></div><p> First, let's look at the basic configuration that is needed whenever we use Seam with JSF. </p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e24257"/>31.1.1. Integrating Seam with JSF and your servlet container</h3></div></div></div><p> Of course, you need a faces servlet! </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">servlet</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">servlet-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">Faces&nbsp;Servlet</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">servlet-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">servlet-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">javax.faces.webapp.FacesServlet</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">servlet-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">load-on-startup</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">1</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">load-on-startup</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">servlet</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">servlet-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">servlet-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">Faces&nbsp;Servlet</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">servlet-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">url-pattern</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">*.seam</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">url-pattern</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">servlet-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p> (You can adjust the URL pattern to suit your taste.) </p><p> In addition, Seam requires the following entry in your <code class="literal">web.xml</code> file: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">listener</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">listener-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.jboss.seam.servlet.SeamListener</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">listener-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">listener</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p> This listener is responsible for bootstrapping Seam, and for destroying session and application
                contexts. </p><p> Some JSF implementations have a broken implementation of server-side state saving that interferes
                with Seam's conversation propagation. If you have problems with conversation propagation during form
                submissions, try switching to client-side state saving. You'll need this in <code class="literal">web.xml</code>: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">context-param</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">param-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">javax.faces.STATE_SAVING_METHOD</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">param-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">param-value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">client</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">param-value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">context-param</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>Warning</h2><p>Setting of <code class="literal">javax.faces.STATE_SAVING_METHOD</code> to <code class="literal">client</code>
                can lead to security issues and it should be set environment entry <code class="literal">com.sun.faces.ClientStateSavingPassword</code>
                in <code class="filename">web.xml</code> like:
                </p><pre class="programlisting">
                &lt;env-entry&gt;
                    &lt;env-entry-name&gt;com.sun.faces.ClientStateSavingPassword&lt;/env-entry-name&gt;
                    &lt;env-entry-type&gt;java.lang.String&lt;/env-entry-type&gt;
                    &lt;env-entry-value&gt;INSERT_YOUR_PASSWORD&lt;/env-entry-value&gt;
                &lt;/env-entry&gt;</pre><p>
                </p></div><p>
                There is a minor gray area in the JSF specification regarding the mutability of view state values. Since
                Seam uses the JSF view state to back its PAGE scope this can become an issue in some cases. If you're
                using server side state saving with the JSF-RI and you want a PAGE scoped bean to keep its exact value
                for a given view of a page you will need to specify the following context-param. Otherwise if a user
                uses the "back" button a PAGE scoped component will have the latest value if it has changed not the
                value of the "back" page. (see
                <a class="ulink" href="http://java.net/jira/browse/JAVASERVERFACES_SPEC_PUBLIC-1127">
                    Spec Issue
                </a>
                ). This setting is not enabled by default because of the performance hit of serializing the JSF view
                with every request.
            </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">context-param</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">param-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">com.sun.faces.serializeServerState</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">param-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">param-value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">true</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">param-value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">context-param</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e24307"/>31.1.2. Seam Resource Servlet</h3></div></div></div><p> The Seam Resource Servlet provides resources used by Seam Remoting, captchas (see the security
                chapter) and some JSF UI controls. Configuring the Seam Resource Servlet requires the following entry in
                    <code class="literal">web.xml</code>: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">servlet</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">servlet-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">Seam&nbsp;Resource&nbsp;Servlet</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">servlet-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">servlet-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.jboss.seam.servlet.SeamResourceServlet</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">servlet-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">servlet</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">servlet-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">servlet-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">Seam&nbsp;Resource&nbsp;Servlet</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">servlet-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">url-pattern</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">/seam/resource/*</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">url-pattern</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">servlet-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e24317"/>31.1.3. Seam servlet filters</h3></div></div></div><p> Seam doesn't need any servlet filters for basic operation. However, there are several features which
                depend upon the use of filters. To make things easier, Seam lets you add and configure
                servlet filters just like you would configure other built-in Seam components. To take advantage of this
                feature, we must first install a master filter in <code class="literal">web.xml</code>: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">filter</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">filter-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">Seam&nbsp;Filter</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">filter-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">filter-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.jboss.seam.servlet.SeamFilter</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">filter-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">filter</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">filter-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">filter-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">Seam&nbsp;Filter</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">filter-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">url-pattern</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">/*</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">url-pattern</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">filter-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>The Seam master filter <span class="emphasis"><em>must</em></span> be the first filter specified in
                <code class="literal">web.xml</code>. This ensures it is run first. </p><p>
               The Seam filters share a number of common attributes, you can set these in 
               <code class="literal">components.xml</code> in addition to any parameters discussed
               below:
            </p><div class="itemizedlist"><ul><li><p>
                     <code class="literal">url-pattern</code> — Used to specify which requests are filtered, the
                         default is all requests. <code class="literal">url-pattern</code> is a Tomcat style pattern
                         which allows a wildcard suffix.
                  </p></li><li><p>
                     <code class="literal">regex-url-pattern</code> — Used to specify which requests are filtered, the
                     default is all requests. <code class="literal">regex-url-pattern</code> is a true regular expression
                     match for request path.
                  </p></li><li><p>
                     <code class="literal">disabled</code> — Used to disable a built in filter.
                  </p></li></ul></div><p>
              Note that the patterns are matched against the URI path of the request (see
              <code class="literal">HttpServletRequest.getURIPath()</code>) and that the name of the servlet context is
              removed before matching.
           </p><p> Adding the master filter enables the following built-in filters. </p><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="exception_handling"/>31.1.3.1. Exception handling</h4></div></div></div><p> This filter provides the exception mapping functionality in <code class="literal">pages.xml</code> (almost
                    all applications will need this). It also takes care of rolling back uncommitted transactions when
                    uncaught exceptions occur. (According to the Java EE specification, the web container should do this
                    automatically, but we've found that this behavior cannot be relied upon in all application servers.
                    And it is certainly not required of plain servlet engines like Tomcat.) </p><p> By default, the exception handling filter will process all requests, however this behavior may be
                    adjusted by adding a <code class="literal">&lt;web:exception-filter&gt;</code> entry to
                        <code class="literal">components.xml</code>, as shown in this example: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">components</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/schema/seam/components&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns:web</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/schema/seam/web&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">web:exception-filter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">url-pattern</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;*.seam&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">components</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e24390"/>31.1.3.2. Conversation propagation with redirects</h4></div></div></div><p> This filter allows Seam to propagate the conversation context across browser redirects. It
                    intercepts any browser redirects and adds a request parameter that specifies the Seam conversation
                    identifier. </p><p> The redirect filter will process all requests by default, but this behavior can also be adjusted
                    in <code class="literal">components.xml</code>: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">web:redirect-filter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">url-pattern</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;*.seam&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="configuration.filters.rewrite"/>31.1.3.3. URL rewriting</h4></div></div></div><p> This filter allows Seam to apply URL rewriting for views based on configuration in the 
                    <code class="literal">pages.xml</code> file.  This filter is not activate by default, but can be 
                    activated
                    by adding the configuration to <code class="literal">components.xml</code>: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">web:rewrite-filter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">view-mapping</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;*.seam&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><p>The <code class="literal">view-mapping</code> parameter must match the servlet mapping defined for the Faces Servlet
                    in the <code class="literal">web.xml</code> file.  If ommitted, the rewrite filter assumes 
                    the pattern <code class="literal">*.seam</code>.
                </p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e24426"/>31.1.3.4. Multipart form submissions</h4></div></div></div><p> This feature is necessary when using the Seam file upload JSF control. It detects multipart form
                    requests and processes them according to the multipart/form-data specification (RFC-2388). To
                    override the default settings, add the following entry to <code class="literal">components.xml</code>: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">web:multipart-filter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">create-temp-files</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">max-request-size</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;1000000&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">url-pattern</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;*.seam&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><div class="itemizedlist"><ul><li><p>
                            <code class="literal">create-temp-files</code> — If set to <code class="literal">true</code>, uploaded
                            files are written to a temporary file (instead of held in memory). This may be an important
                            consideration if large file uploads are expected. The default setting is
                            <code class="literal">false</code>. </p></li><li><p>
                            <code class="literal">max-request-size</code> — If the size of a file upload request
                            (determined by reading the <code class="literal">Content-Length</code> header in the request) exceeds
                            this value, the request will be aborted. The default setting is 0 (no size limit). </p></li></ul></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e24458"/>31.1.3.5. Character encoding</h4></div></div></div><p> Sets the character encoding of submitted form data. </p><p> This filter is not installed by default and requires an entry in
                    <code class="literal">components.xml</code> to enable it: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">web:character-encoding-filter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">encoding</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;UTF-16&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">override-client</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">url-pattern</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;*.seam&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><div class="itemizedlist"><ul><li><p>
                            <code class="literal">encoding</code> — The encoding to use. </p></li><li><p>
                            <code class="literal">override-client</code> — If this is set to <code class="literal">true</code>,
                            the request encoding will be set to whatever is specified by <code class="literal">encoding</code> no
                            matter whether the request already specifies an encoding or not. If set to
                            <code class="literal">false</code>, the request encoding will only be set if the request doesn't
                            already specify an encoding. The default setting is <code class="literal">false</code>. </p></li></ul></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e24495"/>31.1.3.6. RichFaces</h4></div></div></div><p> 
                  If RichFaces is used in your project, Seam will install the
                  RichFaces Ajax filter for you, making sure to install it
                  before all other built-in filters. You don't need to install
                  the RichFaces Ajax filter in <code class="literal">web.xml</code>
                  yourself.
                </p><p>
                  The RichFaces Ajax filter is only installed if the RichFaces
                  jars are present in your project.
                </p><p> To override the default settings, add the following entry to <code class="literal">components.xml</code>.
                    The options are the same as those specified in the RichFaces Developer Guide: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">web:ajax4jsf-filter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">force-parser</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">enable-cache</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">log4j-init-file</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;custom-log4j.xml&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">url-pattern</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;*.seam&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><div class="itemizedlist"><ul><li><p>
                            <code class="literal">force-parser</code> — forces all JSF pages to be validated by
                            Richfaces's XML syntax checker. If <code class="literal">false</code>, only AJAX responses are
                            validated and converted to well-formed XML. Setting <code class="literal">force-parser</code> to
                                <code class="literal">false</code> improves performance, but can provide visual artifacts on AJAX
                            updates. </p></li><li><p>
                            <code class="literal">enable-cache</code> — enables caching of framework-generated resources
                            (e.g. javascript, CSS, images, etc). When developing custom javascript or CSS, setting to
                            true prevents the browser from caching the resource. </p></li><li><p>
                            <code class="literal">log4j-init-file</code> — is used to setup per-application logging. A
                            path, relative to web application context, to the log4j.xml configuration file should be
                            provided. </p></li></ul></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e24540"/>31.1.3.7. Identity Logging</h4></div></div></div><p> 
                    This filter adds the authenticated user name to the log4j mapped diagnostic context so that it 
                    can be included in formatted log output if desired, by adding %X{username} to the pattern.                       
                </p><p> By default, the logging filter will process all requests, however this behavior may be
                     adjusted by adding a <code class="literal">&lt;web:logging-filter&gt;</code> entry to
                     <code class="literal">components.xml</code>, as shown in this example: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">components</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/schema/seam/components&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns:web</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/schema/seam/web&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">web:logging-filter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">url-pattern</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;*.seam&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">components</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e24555"/>31.1.3.8. Context management for custom servlets</h4></div></div></div><p> Requests sent direct to some servlet other than the JSF servlet are not processed through the JSF
                    lifecycle, so Seam provides a servlet filter that can be applied to any other servlet that needs
                    access to Seam components. </p><p> This filter allows custom servlets to interact with the Seam contexts. It sets up the Seam
                    contexts at the beginning of each request, and tears them down at the end of the request. You should
                    make sure that this filter is <span class="emphasis"><em>never</em></span> applied to the JSF
                    <code class="literal">FacesServlet</code>. Seam uses the phase listener for context management in a JSF
                    request. </p><p> This filter is not installed by default and requires an entry in
                    <code class="literal">components.xml</code> to enable it: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">web:context-filter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">url-pattern</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;/media/*&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><p> The context filter expects to find the conversation id of any conversation context in a request
                    parameter named <code class="literal">conversationId</code>. You are responsible for ensuring that it gets
                    sent in the request. </p><p> You are also responsible for ensuring propagation of any new conversation id back to the client.
                    Seam exposes the conversation id as a property of the built in component
                    <code class="literal">conversation</code>. </p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e24585"/>31.1.3.9. Enabling HTTP cache-control headers</h4></div></div></div><p>
                    Seam does <span class="emphasis"><em>not</em></span> automatically add <code class="literal">cache-control</code> HTTP headers to
                    any resources served by the Seam resource servlet, or directly from your view directory by the servlet
                    container. This means that your images, Javascript and CSS files, and resource representations from
                    Seam resource servlet such as Seam Remoting Javascript interfaces are usually not cached by the browser.
                    This is convenient in development but should be changed in production when optimizing the application.
                </p><p>
                    You can configure a Seam filter to enable automatic addition of <code class="literal">cache-control</code> headers
                    depending on the requested URI in <code class="literal">components.xml</code>:
                </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">web:cache-control-filter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;commonTypesCacheControlFilter&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">regex-url-pattern</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;.*(\.gif|\.png|\.jpg|\.jpeg|\.css|\.js)&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">value</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;max-age=86400&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain">&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;1&nbsp;day&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">web:cache-control-filter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;anotherCacheControlFilter&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">url-pattern</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;/my/cachable/resources/*&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">value</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;max-age=432000&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain">&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;5&nbsp;days&nbsp;--&gt;</span><span class="xml_plain"></span><br />
</pre><p>
                    You do not have to name the filters unless you have more than one filter enabled.
                </p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e24608"/>31.1.3.10. Adding custom filters</h4></div></div></div><p> Seam can install your filters for you, allowing you to specify <span class="emphasis"><em>where</em></span> in the
                    chain your filter is placed (the servlet specification doesn't provide a well defined order if you
                    specify your filters in a <code class="literal">web.xml</code>). Just add the <code class="literal">@Filter</code>
                    annotation to your Seam component (which must implement <code class="literal">javax.servlet.Filter</code>): </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Startup</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Scope</span><span class="java_separator">(</span><span class="java_plain">APPLICATION</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Name</span><span class="java_separator">(</span><span class="java_literal">&quot;org.jboss.seam.web.multipartFilter&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">BypassInterceptors</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Filter</span><span class="java_separator">(</span><span class="java_plain">within</span><span class="java_operator">=</span><span class="java_literal">&quot;org.jboss.seam.web.ajax4jsfFilter&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MultipartFilter</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">AbstractFilter</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span></pre><p> Adding the <code class="literal">@Startup</code> annotation means that the component is available during
                    Seam startup; bijection isn't available here (<code class="literal">@BypassInterceptors</code>); and the filter
                    should be further down the chain than the RichFaces filter
                        (<code class="literal">@Filter(within="org.jboss.seam.web.ajax4jsfFilter")</code>). </p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="config.integration.ejb.container"/>31.1.4. Integrating Seam with your EJB container</h3></div></div></div><p> In a Seam application, EJB components have a certain duality, as they are managed by both the EJB
                container and Seam. Actually, it's more that Seam resolves EJB component references, manages the
                lifetime of stateful session bean components, and also participates in each method call via
                interceptors. Let's start with the configuration of the Seam interceptor chain.</p><p> We need to apply the <code class="literal">SeamInterceptor</code> to our Seam EJB components. This interceptor
                delegates to a set of built-in server-side interceptors that handle such concerns as bijection,
                conversation demarcation, and business process signals. The simplest way to do this across an entire
                application is to add the following interceptor configuration in <code class="literal">ejb-jar.xml</code>: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">interceptors</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">interceptor</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">interceptor-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.jboss.seam.ejb.SeamInterceptor</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">interceptor-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">interceptor</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">interceptors</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;</span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">assembly-descriptor</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">interceptor-binding</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">ejb-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">*</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">ejb-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">interceptor-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.jboss.seam.ejb.SeamInterceptor</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">interceptor-class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">interceptor-binding</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">assembly-descriptor</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p> Seam needs to know where to go to find session beans in JNDI. One way to do this is specify the
                    <code class="literal">@JndiName</code> annotation on every session bean Seam component. However, this is quite
                tedious. A better approach is to specify a pattern that Seam can use to calculate the JNDI name from the
                EJB name. Fortunately, new portable JNDI Syntax was introduced in Java EE 6. There are three JNDI namespaces for
                portable JNDI lookups - <code class="literal">java:global</code>, <code class="literal">java:module</code> and <code class="literal">java:app</code>.
                More in <a class="ulink" href="http://docs.oracle.com/javaee/6/tutorial/doc/gipjf.html#girgn">Java EE 6 tutorial</a>
                We usually specify this option in <code class="literal">components.xml</code>. </p><p> For JBoss AS 7, the following pattern is correct: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">core:init</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">jndi-name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;java:app/</span><span class="xml_tag_symbols">&lt;</span><span class="xml_attribute_name">ejb-module-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">/#{ejbName}&quot;&nbsp;/&gt;</span><br />
</pre><p> In this case, <code class="literal">&lt;ejb-module-name&gt;</code> is the name of the EJB module (by default it is filename of ejb jar)
             in which the bean is deployed, Seam replaces <code class="literal">#{ejbName}</code> with the name of the EJB. </p><p> How these JNDI names are resolved and somehow locate an EJB component might appear a bit like black
                magic at this point, so let's dig into the details. First, let's talk about how the EJB components get
                into JNDI.</p><p> EJB components would get assigned a global JNDI name automatically, using the pattern
                described in <a class="ulink" href="http://docs.oracle.com/javaee/6/tutorial/doc/gipjf.html#girgn">Java EE 6 tutorial</a>.
                 The EJB name is the first non-empty value from the following list: </p><div class="itemizedlist"><ul><li><p>The value of the <code class="literal">&lt;ejb-name&gt;</code> element in ejb-jar.xml</p></li><li><p>The value of the <code class="literal">name</code> attribute in the @Stateless or @Stateful annotation</p></li><li><p>The simple name of the bean class</p></li></ul></div><p> Let's look at an example. Assume that you have the following EJB bean and interface defined. </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;com</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">example</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">myapp</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">ejb</span><span class="java_separator">.</span><span class="java_type">Local</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Local</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">Authenticator</span>
<!--  --><br/><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;authenticate</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_keyword">package</span><span class="java_plain">&nbsp;com</span><span class="java_separator">.</span><span class="java_plain">example</span><span class="java_separator">.</span><span class="java_plain">myapp</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">ejb</span><span class="java_separator">.</span><span class="java_type">Stateless</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Stateless</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Name</span><span class="java_separator">(</span><span class="java_literal">&quot;authenticator&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">AuthenticatorBean</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Authenticator</span>
<!--  --><br/><span class="java_separator">{</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;authenticate</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span>
</pre><p> Assuming your EJB bean class is deployed in an EAR named myapp, the global JNDI name 
                myapp/AuthenticatorBean/local will be assigned to it on JBoss AS. As you learned, you can reference this
                EJB component as a Seam component with the name <code class="literal">authenticator</code> and Seam will take care
                of finding it in JNDI according to the JNDI pattern (or <code class="literal">@JndiName</code> annotation).
                </p><p>So what about the rest of the application servers? Well, according to the Java EE spec, which most
                vendors try to adhere to religiously, you have to declare an EJB reference for your EJB in order for it
                to be assigned a JNDI name. That requires some XML. It also means that it is up to you to establish a
                JNDI naming convention so that you can leverage the Seam JNDI pattern. You might find the JBoss
                convention a good one to follow.</p><p>There are two places you have to define the EJB reference when using Seam on non-JBoss application
                servers. If you are going to be looking up the Seam EJB component through JSF (in a JSF view or as a JSF
                action listener) or a Seam JavaBean component, then you must declare the EJB reference in web.xml. Here
                is the EJB reference for the example component just shown: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">ejb-local-ref</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">ejb-ref-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">myapp/AuthenticatorBean</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">ejb-ref-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">ejb-ref-type</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">Session</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">ejb-ref-type</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">local</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.example.vehicles.action.Authenticator</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">local</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">ejb-local-ref</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>This reference will cover most uses of the component in a Seam application. However, if you want to
                be able to inject a Seam EJB component into another Seam EJB component using <code class="literal">@In</code>, you
                need to define this EJB reference in another location. This time, it must be defined in ejb-jar.xml, and
                it's a bit tricker. </p><p>Within the context of an EJB method call, you have to deal with a somewhat sheltered JNDI context.
                When Seam attempts to find another Seam EJB component to satisfy an injection point defined using
                <code class="literal">@In</code>, whether or not it finds it depends on whether an EJB reference exists in
                JNDI. Strictly speaking, you cannot simply resolve JNDI names as you please. You have to define
                the references explicitly. Fortunately, JBoss recognized how aggravating this would be for the
                developer and all versions of JBoss automatically register EJBs so they are always available in
                JNDI, both to the web container and the EJB container. So if you are using JBoss, you can skip the next
                few paragraphs. However, if you are deploying to GlassFish, pay close attention.</p><p>For application servers that stubbornly adhere to the EJB specification, EJB references must always be
                defined explicitly. But unlike with the web context, where a single resource reference covers all
                uses of the EJB from the web environment, you cannot declare EJB references globally in the EJB container.
                Instead, you have to specify the JNDI resources for a given EJB component one-by-one.</p><p> Let's assume that we have an EJB named RegisterAction (the name is resolved using the three steps
                mentioned previously). That EJB has the following Seam injection:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">In</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">create&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">true</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_type">Authenticator</span><span class="java_plain">&nbsp;authenticator</span><span class="java_separator">;</span>
</pre><p> In order for this injection to work, the link must be established in the ejb-jar.xml file as follows: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">ejb-jar</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">enterprise-beans</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">session</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">ejb-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">RegisterAction</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">ejb-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">ejb-local-ref</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">ejb-ref-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">myapp/AuthenticatorAction/local</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">ejb-ref-name</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">ejb-ref-type</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">Session</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">ejb-ref-type</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">local</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">com.example.myapp.Authenticator</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">local</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">ejb-local-ref</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">session</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">enterprise-beans</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;...</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">ejb-jar</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p> Notice that the contents of the <code class="literal">&lt;ejb-local-ref&gt;</code> are identical to what we
                defined in web.xml. What we are doing is bringing the reference into the EJB context where it can be
                used by the RegisterAction bean. You will need to add one of these references for any injection of a
                Seam EJB component into another Seam EJB component using <code class="literal">@In</code>. (You can see an
                example of this setup in the jee5/booking example).</p><p> But what about <code class="literal">@EJB</code>? It's true that you can inject one EJB into another using
                <code class="literal">@EJB</code>. However, by doing so, you are injecting the actual EJB reference rather than the
                Seam EJB component instance. In this case, some Seam features will work, while others won't. That's
                because Seam's interceptor is invoked on any method call to an EJB component. But that only invokes
                Seam's server-side interceptor chain. What you lose is Seam's state management and Seam's client-side
                interceptor chain. Client-side interceptors handle concerns such as security and concurrency. Also, when
                injecting a SFSB, there is no guarantee that you will get the SFSB bound to the active session or
                conversation, whatever the case may be. Thus, you definitely want to inject the Seam EJB component using
                <code class="literal">@In</code>.</p><p>
                Finally, let's talk about transactions. In an EJB environment, we recommend the use of a special
                built-in component for transaction management, that is fully aware of container transactions, and can
                correctly process transaction success events registered with the <code class="literal">Events</code> component. If
                you don't add this line to your <code class="literal">components.xml</code> file, Seam won't know when
                container-managed transactions end: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">transaction:ejb-transaction</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e24776"/>31.1.5. Don't forget!</h3></div></div></div><p> There is one final item you need to know about. You must place a <code class="literal">seam.properties</code>,
                    <code class="literal">META-INF/seam.properties</code> or <code class="literal">META-INF/components.xml</code> file in
                any archive in which your Seam components are deployed (even an empty properties file will do). At
                startup, Seam will scan any archives with <code class="literal">seam.properties</code> files for seam components. </p><p> In a web archive (WAR) file, you must place a <code class="literal">seam.properties</code> file in the
                    <code class="literal">WEB-INF/classes</code> directory if you have any Seam components included here. </p><p> That's why all the Seam examples have an empty <code class="literal">seam.properties</code> file. You can't
                just delete this file and expect everything to still work! </p><p> You might think this is silly and what kind of idiot framework designers would make an empty file
                affect the behavior of their software?? Well, this is a workaround for a limitation of the
                JVM — if we didn't use this mechanism, our next best option would be to force you to list every
                component explicitly in <code class="literal">components.xml</code>, just like some other competing frameworks do!
                I think you'll like our way better. </p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="alt-jpa-providers"/>31.2. Using Alternate JPA Providers</h2></div></div></div><p> Seam comes packaged and configured with Hibernate as the default JPA provider.
        If you require using a different JPA provider you must tell <code class="literal">seam</code>
        about it.  
        </p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>This is a workaround</h2><p>
            Configuration of the JPA provider will be easier in the future and will
            not require configuration changes, unless you are adding a custom persistence provider
            implementation.
            </p></div><p>Telling seam about a different JPA provider can be done in one of two ways:</p><p>Update your application's <code class="literal">components.xml</code>
              so that the generic <code class="literal">PersistenceProvider</code> takes
              precedence over the hibernate version.  Simply add the following
              to the file:                    
        </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">component</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.jboss.seam.persistence.persistenceProvider&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.jboss.seam.persistence.PersistenceProvider&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">scope</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;stateless&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">component</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>If you want to take advantage of your JPA provider's 
        non-standard features you will need to write you own implementation of
        the <code class="literal">PersistenceProvider</code>.  Use 
        <code class="literal">HibernatePersistenceProvider</code> as a starting 
        point (don't forget to give back to the community :).  Then you
        will need to tell <code class="literal">seam</code> to use it as before.
        </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">component</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.jboss.seam.persistence.persistenceProvider&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.your.package.YourPersistenceProvider&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">component</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>All that is left is updating the <code class="literal">persistence.xml</code>
            file with the correct provider class, and what ever properties your
            provider needs.  Don't forget to package your new provider's jar files in the 
            application if they are needed.
        </p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e24854"/>31.3. Configuring Seam in Java EE 6</h2></div></div></div><div class="mediaobject" align="center"><img src="images/ee6.png" align="middle"/></div><p> If you're running in a Java EE environment, this is all the configuration required to start using Seam! </p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e24864"/>31.3.1. Packaging</h3></div></div></div><p> Once you've packaged all this stuff together into an EAR, the archive structure will look something
                like this: </p><pre class="programlisting">my-application.ear/
    jboss-seam.jar
    lib/
        jboss-el.jar
    META-INF/
        MANIFEST.MF
        application.xml
        jboss-deployment-structure.xml
    my-application.war/
        META-INF/
            MANIFEST.MF
        WEB-INF/
            web.xml
            components.xml
            faces-config.xml
            lib/
                jboss-seam-ui.jar
        login.jsp
        register.jsp
        ...
    my-application.jar/
        META-INF/
            MANIFEST.MF
            persistence.xml
        seam.properties
        org/
            jboss/
                myapplication/
                    User.class
                    Login.class
                    LoginBean.class
                    Register.class
                    RegisterBean.class
                    ...</pre><p>
                You should declare <code class="literal">jboss-seam.jar</code> as an ejb module in <code class="literal">META-INF/application.xml</code>; 
               <code class="literal">jboss-el.jar</code> should be placed in the EAR's lib directory (putting it in the EAR classpath.
            </p><p> If you want to use jBPM or Drools, you must include the needed jars in the EAR's lib directory.</p><p> If you want to use the Seam tag library (most Seam applications do), you must include
                    <code class="literal">jboss-seam-ui.jar</code> in the <code class="literal">WEB-INF/lib</code> directory of the WAR. If
                you want to use the PDF or email tag libraries, you need to put <code class="literal">jboss-seam-pdf.jar</code> or
                    <code class="literal">jboss-seam-mail.jar</code> in <code class="literal">WEB-INF/lib</code>. </p><p> If you want to use the Seam debug page (only works for applications using facelets), you must include
                    <code class="literal">jboss-seam-debug.jar</code> in the <code class="literal">WEB-INF/lib</code> directory of the WAR. </p><p> Seam ships with several example applications that are deployable in any Java EE container that
                supports EJB 3.1. </p><p><code class="filename">faces-config.xml</code> is not required in JSF 2, but if you want to set up something non-default 
            you need to place it in <code class="filename">WAR/WEB-INF</code>.</p><p> I really wish that was all there was to say on the topic of configuration but unfortunately we're
                only about a third of the way there. If you're too overwhelmed by all this tedious configuration stuff,
                feel free to skip over the rest of this section and come back to it later. </p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e24920"/>31.4. Configuring Seam without EJB</h2></div></div></div><p> Seam is useful even if you're not yet ready to take the plunge into EJB 3.1. In this case you would use
            Hibernate 4 instead of EJB 3.1 persistence, and plain JavaBeans instead of session beans. You'll miss
            out on some of the nice features of session beans but it will be very easy to migrate to EJB 3.1 when you're
            ready and, in the meantime, you'll be able to take advantage of Seam's unique declarative state management
            architecture. </p><div class="mediaobject" align="center"><img src="images/hibernate-ee6.png" align="middle"/></div><p> Seam JavaBean components do not provide declarative transaction demarcation like session beans do. You
                <span class="emphasis"><em>could</em></span> manage your transactions manually using the JTA
            <code class="literal">UserTransaction</code> or declaratively using Seam's <code class="literal">@Transactional</code>
            annotation. But most applications will just use Seam managed transactions when using Hibernate with
            JavaBeans. </p><p> The Seam distribution includes a version of the booking example application that uses Hibernate and
            JavaBeans instead of EJB, and another version that uses JPA and JavaBeans. These example applications are
            ready to deploy into any Java EE application server. </p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e24943"/>31.4.1. Boostrapping Hibernate in Seam</h3></div></div></div><p> Seam will bootstrap a Hibernate <code class="literal">SessionFactory</code> from your
                    <code class="literal">hibernate.cfg.xml</code> file if you install a built-in component: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">persistence:hibernate-session-factory</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;hibernateSessionFactory&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><p> You will also need to configure a <span class="emphasis"><em>managed session</em></span> if you want a Seam managed
                Hibernate <code class="literal">Session</code> to be available via injection. </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">persistence:managed-hibernate-session</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;hibernateSession&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">session-factory</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;#{hibernateSessionFactory}&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e24966"/>31.4.2. Boostrapping JPA in Seam</h3></div></div></div><p> Seam will bootstrap a JPA <code class="literal">EntityManagerFactory</code> from your
                <code class="literal">persistence.xml</code> file if you install this built-in component: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">persistence:entity-manager-factory</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;entityManagerFactory&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><p> You will also need to configure a <span class="emphasis"><em>managed persistence context</em></span> if you want a
                Seam managed JPA <code class="literal">EntityManager</code> to be available via injection. </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">persistence:managed-persistence-context</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;entityManager&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">entity-manager-factory</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;#{entityManagerFactory}&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e24989"/>31.4.3. Packaging</h3></div></div></div><p> We can package our application as a WAR, in the following structure: </p><pre class="programlisting">my-application.war/
    META-INF/
        MANIFEST.MF
        jboss-deployment-structure.xml
    WEB-INF/
        web.xml
        components.xml
        faces-config.xml
        lib/
            jboss-seam.jar
            jboss-seam-ui.jar
            jboss-el.jar
            hibernate-core.jar
            hibernate-annotations.jar
            hibernate-validator.jar
            ...
            my-application.jar/
                META-INF/
                   MANIFEST.MF
                seam.properties
                hibernate.cfg.xml
                org/
                    jboss/
                        myapplication/
                            User.class
                            Login.class
                            Register.class
                            ...
    login.jsp
    register.jsp
    ...</pre><p> If we want to deploy Hibernate in a non-EE environment like Tomcat or TestNG, we need to do a little
                bit more work. </p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e24998"/>31.5. Configuring Seam in Java SE</h2></div></div></div><p> It is possible to use Seam completely outside of an EE environment. In this case, you need to tell Seam
            how to manage transactions, since there will be no JTA available. If you're using JPA, you can tell
            Seam to use JPA resource-local transactions, ie. <code class="literal">EntityTransaction</code>, like so: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">transaction:entity-transaction</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">entity-manager</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;#{entityManager}&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><p> If you're using Hibernate, you can tell Seam to use the Hibernate transaction API like this: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">transaction:hibernate-transaction</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">session</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;#{session}&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre><p> Of course, you'll also need to define a datasource.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e25014"/>31.6. Configuring jBPM in Seam</h2></div></div></div><p> Seam's jBPM integration is not installed by default, so you'll need to enable jBPM by installing a
            built-in component. You'll also need to explicitly list your process and pageflow definitions. In
                <code class="literal">components.xml</code>: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">bpm:jbpm</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">bpm:pageflow-definitions</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">createDocument.jpdl.xml</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">editDocument.jpdl.xml</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">approveDocument.jpdl.xml</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">bpm:pageflow-definitions</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">bpm:process-definitions</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">documentLifecycle.jpdl.xml</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">bpm:process-definitions</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">bpm:jbpm</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p> No further special configuration is needed if you only have pageflows. If you do have business process
            definitions, you need to provide a jBPM configuration, and a Hibernate configuration for jBPM. The Seam DVD
            Store demo includes example <code class="literal">jbpm.cfg.xml</code> and <code class="literal">hibernate.cfg.xml</code> files
            that will work with Seam: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">jbpm-configuration</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">jbpm-context</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">service</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;persistence&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">factory</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">bean</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.jbpm.persistence.db.DbPersistenceServiceFactory&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">field</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;isTransactionEnabled&quot;</span><span class="xml_tag_symbols">&gt;&lt;</span><span class="xml_tag_name">false</span><span class="xml_tag_symbols">/&gt;&lt;/</span><span class="xml_tag_name">field</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">bean</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">factory</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">service</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">service</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;tx&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">factory</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.jbpm.tx.TxServiceFactory&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">service</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;message&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">factory</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.jbpm.msg.db.DbMessageServiceFactory&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">service</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;scheduler&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">factory</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.jbpm.scheduler.db.DbSchedulerServiceFactory&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">service</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;logging&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">factory</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.jbpm.logging.db.DbLoggingServiceFactory&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">service</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;authentication&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">factory</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.jbpm.security.authentication.DefaultAuthenticationServiceFactory&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">jbpm-context</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">jbpm-configuration</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p> The most important thing to notice here is that jBPM transaction control is disabled. Seam or EJB3 should
            control the JTA transactions. </p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e25036"/>31.6.1. Packaging</h3></div></div></div><p> There is not yet any well-defined packaging format for jBPM configuration and process/pageflow
                definition files. In the Seam examples we've decided to simply package all these files into the root of
                the EAR. In future, we will probably design some other standard packaging format. So the EAR looks
                something like this: </p><pre class="programlisting">my-application.ear/
    jboss-seam.jar
    lib/
       jboss-el.jar
       jbpm-jpdl.jar
    META-INF/
        MANIFEST.MF
        application.xml
        jboss-deployment-structure.xml
    my-application.war/
        META-INF/
            MANIFEST.MF
        WEB-INF/
            web.xml
            components.xml
            faces-config.xml
            lib/
                jboss-seam-ui.jar
        login.jsp
        register.jsp
        ...
    my-application.jar/
        META-INF/
            MANIFEST.MF
            persistence.xml
        seam.properties
        org/
            jboss/
                myapplication/
                    User.class
                    Login.class
                    LoginBean.class
                    Register.class
                    RegisterBean.class
                    ...
    jbpm.cfg.xml
    hibernate.cfg.xml
    createDocument.jpdl.xml
    editDocument.jpdl.xml
    approveDocument.jpdl.xml
    documentLifecycle.jpdl.xml</pre></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e25043"/>31.7. Deployment in JBoss AS 7</h2></div></div></div><p>JBoss AS 7 is default deployment target for all examples in Seam 2.3 distribution.</p><p>Seam 2.3 requires to have setup special deployment metada file <code class="filename">jboss-deployment-structure.xml</code>
         for correct initialization. Minimal content for EAR is: 
         </p><div class="example"><a id="d0e25053"/><p class="title"><b>Example 31.1. jboss-deployment-structure.xml</b></p><div class="example-contents"><pre class="programlisting">&lt;jboss-deployment-structure xmlns="urn:jboss:deployment-structure:1.0"&gt;
  &lt;deployment&gt;
      &lt;dependencies&gt;
          &lt;module name="org.dom4j" export="true"/&gt;
          &lt;module name="org.apache.commons.collections" export="true"/&gt;
          &lt;module name="javax.faces.api" export="true"/&gt;
        &lt;/dependencies&gt;
  &lt;/deployment&gt;  
&lt;/jboss-deployment-structure&gt;</pre></div></div><p><br class="example-break"/>    
            More details about new AS 7 classloading can be found at 
            <a class="ulink" href="https://docs.jboss.org/author/display/AS7/Developer+Guide#DeveloperGuide-ClassloadinginJBossAS7">https://docs.jboss.org/author/display/AS7/Developer+Guide#DeveloperGuide-ClassloadinginJBossAS7</a> 
        </p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>Deployment of multiple modules in one EAR</h2><p>There is a significant enhancement for speed up the application deployment in AS 7. This unfortunatelly can
         cause some issues while you have multiple war/ejb modules in your application.</p><p>
         This situation requires to use and set up new Java EE 6 configuration parameter -
         <span class="emphasis"><em>Module initialization order</em></span>
         - in
         <code class="filename">application.xml</code>
         -
         <code class="literal">initialize-in-order</code>
         to true.
         This causes that initialization will happen in defined order like it is in
         <code class="filename">application.xml</code>.
         Example of <code class="filename">application.xml</code>:
         </p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;application xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  version="6" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/application_6.xsd"&gt;
  &lt;application-name&gt;test-app&lt;/application-name&gt;
  &lt;initialize-in-order&gt;true&lt;/initialize-in-order&gt;
  &lt;module&gt;
    &lt;ejb&gt;jboss-seam.jar&lt;/ejb&gt;
  &lt;/module&gt;
  &lt;module&gt;
    &lt;web&gt;
      &lt;web-uri&gt;test-web1.war&lt;/web-uri&gt;
      &lt;context-root&gt;test&lt;/context-root&gt;
    &lt;/web&gt;
    &lt;web&gt;
      &lt;web-uri&gt;test-web2.war&lt;/web-uri&gt;
      &lt;context-root&gt;test&lt;/context-root&gt;
    &lt;/web&gt;
  &lt;/module&gt;
&lt;/application&gt;</pre><p>
      </p><p>
         If you are using <code class="literal">maven-ear-plugin</code> for generation of your application,
          you can use this plugin configuration:
            </p><pre class="programlisting">&lt;plugin&gt;
    &lt;artifactId&gt;maven-ear-plugin&lt;/artifactId&gt;
    &lt;!-- from version 2.6 the plugin supports Java EE 6 descriptor --&gt;
    &lt;version&gt;2.7&lt;/version&gt;
    &lt;configuration&gt; 
        &lt;version&gt;6&lt;/version&gt;
        &lt;generateApplicationXml&gt;true&lt;/generateApplicationXml&gt; 
        &lt;defaultLibBundleDir&gt;lib&lt;/defaultLibBundleDir&gt;                
        &lt;initializeInOrder&gt;true&lt;/initializeInOrder&gt;
        &lt;modules&gt; 
            &lt;jarModule&gt; 
                &lt;groupId&gt;org.jboss.el&lt;/groupId&gt; 
                &lt;artifactId&gt;jboss-el&lt;/artifactId&gt; 
                &lt;includeInApplicationXml&gt;false&lt;/includeInApplicationXml&gt; 
                &lt;bundleDir&gt;lib&lt;/bundleDir&gt; 
            &lt;/jarModule&gt; 
            &lt;ejbModule&gt; 
                &lt;groupId&gt;org.jboss.seam&lt;/groupId&gt; 
                &lt;artifactId&gt;jboss-seam&lt;/artifactId&gt; 
                &lt;bundleFileName&gt;jboss-seam.jar&lt;/bundleFileName&gt;                         
            &lt;/ejbModule&gt; 
            &lt;ejbModule&gt; 
                &lt;groupId&gt;some.user.module&lt;/groupId&gt; 
                &lt;artifactId&gt;hello-ejbs&lt;/artifactId&gt; 
                &lt;bundleFileName&gt;hello-ejbs.jar&lt;/bundleFileName&gt;                         
            &lt;/ejbModule&gt; 
            &lt;webModule&gt; 
                &lt;groupId&gt;some.user.module&lt;/groupId&gt; 
                &lt;artifactId&gt;hello-web1&lt;/artifactId&gt; 
                &lt;contextRoot&gt;/hello1&lt;/contextRoot&gt; 
                &lt;bundleFileName&gt;hello-web1.war&lt;/bundleFileName&gt; 
            &lt;/webModule&gt; 
            &lt;webModule&gt; 
                &lt;groupId&gt;some.user.module&lt;/groupId&gt; 
                &lt;artifactId&gt;hello-web2&lt;/artifactId&gt; 
                &lt;contextRoot&gt;/hello2&lt;/contextRoot&gt; 
                &lt;bundleFileName&gt;hello-web2.war&lt;/bundleFileName&gt; 
            &lt;/webModule&gt;                                         
        &lt;/modules&gt; 
    &lt;/configuration&gt; 
&lt;/plugin&gt;</pre><p>
      </p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e25095"/>31.8. Configuring SFSB and Session Timeouts in JBoss AS 7</h2></div></div></div><p> It is very important that the timeout for Stateful Session Beans is set higher than the timeout for HTTP
            Sessions, otherwise SFSB's may time out before the user's HTTP session has ended. JBoss Application Server
            has a default session bean timeout of 30 minutes, which is configured in
                <code class="literal">standalone/configuration/standalone.xml</code> (replace <span class="emphasis"><em>standalone.xml</em></span> with your
            standalone-full.xml if you use full profile). </p><p> The default SFSB timeout can be adjusted by modifying the value of <code class="literal">default-access-timeout</code> in
            the EJB subsystem <code class="literal">subsystem xmlns="urn:jboss:domain:ejb3:1.2"</code>: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">subsystem</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;urn:jboss:domain:ejb3:1.2&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">session-bean</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">stateless</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">bean-instance-pool-ref</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">pool-name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;slsb-strict-max-pool&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">stateless</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">stateful</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">default-access-timeout</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;5000&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">cache-ref</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;simple&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">singleton</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">default-access-timeout</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;5000&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">session-bean</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">subsystem</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p> The default HTTP session timeout can't be modified in JBoss AS 7.</p><p> To override default value for your own application, simply include <code class="literal">session-timeout</code> entry in your application's own
                <code class="literal">web.xml</code>: </p><pre class="programlisting">
        &lt;session-config&gt;
            &lt;session-timeout&gt;30&lt;/session-timeout&gt;
        &lt;/session-config&gt;</pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e25128"/>31.9. Running Seam in a Portlet</h2></div></div></div><p>
           If you want to run your Seam application in a portlet, take a look at
           the JBoss Portlet Bridge, an implementation of JSR-301 that supports
           JSF within a portlet, with extensions for Seam and RichFaces. See
           <a class="ulink" href="http://labs.jboss.com/portletbridge">http://labs.jboss.com/portletbridge</a>
           for more.
        </p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e25136"/>31.10. Deploying custom resources</h2></div></div></div><p>
            Seam scans all jars containing <code class="literal">/seam.properties</code>,
            <code class="literal">/META-INF/components.xml</code> or <code class="literal">/META-INF/seam.properties</code>
            on startup for resources. For example, all classes annotated with
            <code class="literal">@Name</code> are registered with Seam as Seam components.
        </p><p>
            You may also want Seam to handle custom resources. A common use case
            is to handle a specific annotation and Seam provides specific 
            support for this. First, tell Seam which annotations to handle in
            <code class="literal">/META-INF/seam-deployment.properties</code>:
        </p><pre class="programlisting"># A colon-separated list of annotation types to handle
org.jboss.seam.deployment.annotationTypes=com.acme.Foo:com.acme.Bar</pre><p>
            Then, during application startup you can get hold of all classes
            annotated with <code class="literal">@Foo</code>:
        </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Name</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;fooStartup&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Scope</span><span class="java_separator">(</span><span class="java_plain">APPLICATION</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Startup</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">FooStartup</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">In</span><span class="java_separator">(</span><span class="java_literal">&quot;#{deploymentStrategy.annotatedClasses['com.acme.Foo']}&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">Class</span><span class="java_operator">&lt;</span><span class="java_type">Object</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;fooClasses</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">In</span><span class="java_separator">(</span><span class="java_literal">&quot;#{hotDeploymentStrategy.annotatedClasses['com.acme.Foo']}&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">Class</span><span class="java_operator">&lt;</span><span class="java_type">Object</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;hotFooClasses</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Create</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;create</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">for</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Class</span><span class="java_plain">&nbsp;clazz</span><span class="java_operator">:</span><span class="java_plain">&nbsp;fooClasses</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handleClass</span><span class="java_separator">(</span><span class="java_plain">clazz</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">for</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Class</span><span class="java_plain">&nbsp;clazz</span><span class="java_operator">:</span><span class="java_plain">&nbsp;hotFooClasses</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handleClass</span><span class="java_separator">(</span><span class="java_plain">clazz</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;handleClass</span><span class="java_separator">(</span><span class="java_type">Class</span><span class="java_plain">&nbsp;clazz</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_separator">}</span></pre><p>    
            You can also handle <span class="emphasis"><em>any</em></span> resource. For example, 
            you process any files with the extension <code class="literal">.foo.xml</code>.
            To do this, we need to write a custom deployment handler:
        </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">FooDeploymentHandler</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">implements</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">DeploymentHandler</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_keyword">static</span><span class="java_plain">&nbsp;</span><span class="java_type">DeploymentMetadata</span><span class="java_plain">&nbsp;FOO_METADATA&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">DeploymentMetadata</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getFileNameSuffix</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;.foo.xml&quot;</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">};</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;fooDeploymentHandler&quot;</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">DeploymentMetadata</span><span class="java_plain">&nbsp;getMetadata</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;FOO_METADATA</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><p>
            Here we are just building a list of any files with the suffix 
            <code class="literal">.foo.xml</code>. 
        </p><p>
            Then, we need to register the deployment handler with Seam in
            <code class="literal">/META-INF/seam-deployment.properties</code>.  
            You can register multiple deployment handler using a comma 
            separated list.
        </p><pre class="programlisting"># For standard deployment
org.jboss.seam.deployment.deploymentHandlers=com.acme.FooDeploymentHandler
# For hot deployment
org.jboss.seam.deployment.hotDeploymentHandlers=com.acme.FooDeploymentHandler</pre><p>

         </p><p>
             Seam uses deployment handlers internally to install components and
             namespaces. You can easily access the deployment handler during an 
             <code class="literal">APPLICATION</code> scoped component's startup: 
         </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Name</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;fooStartup&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Scope</span><span class="java_separator">(</span><span class="java_plain">APPLICATION</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Startup</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">FooStartup</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">In</span><span class="java_separator">(</span><span class="java_literal">&quot;#{deploymentStrategy.deploymentHandlers['fooDeploymentHandler']}&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">FooDeploymentHandler</span><span class="java_plain">&nbsp;myDeploymentHandler</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">In</span><span class="java_separator">(</span><span class="java_literal">&quot;#{hotDeploymentStrategy.deploymentHandlers['fooDeploymentHandler']}&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">FooDeploymentHandler</span><span class="java_plain">&nbsp;myHotDeploymentHandler</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Create</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;create</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">for</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">FileDescriptor</span><span class="java_plain">&nbsp;fd</span><span class="java_operator">:</span><span class="java_plain">&nbsp;myDeploymentHandler</span><span class="java_separator">.</span><span class="java_plain">getResources</span><span class="java_separator">())</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handleFooXml</span><span class="java_separator">(</span><span class="java_plain">fd</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">for</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">FileDescriptor</span><span class="java_plain">&nbsp;f</span><span class="java_operator">:</span><span class="java_plain">&nbsp;myHotDeploymentHandler</span><span class="java_separator">.</span><span class="java_plain">getResources</span><span class="java_separator">())</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handleFooXml</span><span class="java_separator">(</span><span class="java_plain">fd</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;handleFooXml</span><span class="java_separator">(</span><span class="java_type">FileDescriptor</span><span class="java_plain">&nbsp;fd</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="search.html"><strong>Prev</strong>Chapter 30. Hibernate Search</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="annotations.html"><strong>Next</strong>Chapter 32. Seam annotations</a></li></ul></body></html>