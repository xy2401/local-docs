<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<meta name="description" content="Single-page Gradle User Manual for Gradle 4.10.3">
<title>Gradle User Manual: Version 4.10.3</title>
<style>
/*
 * Copyright 2018 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Lato (normal, regular) */
@font-face {
    font-family: Lato;
    font-weight: 400;
    font-style: normal;
    src: url("https://assets.gradle.com/lato/fonts/lato-normal/lato-normal.woff2") format("woff2"),
    url("https://assets.gradle.com/lato/fonts/lato-normal/lato-normal.woff") format("woff");
}
/* Lato (normal, italic) */
@font-face {
    font-display: swap;
    font-family: Lato;
    font-weight: 400;
    font-style: italic;
    src: url("https://assets.gradle.com/lato/fonts/lato-normal-italic/lato-normal-italic.woff2") format("woff2"),
    url("https://assets.gradle.com/lato/fonts/lato-normal-italic/lato-normal-italic.woff") format("woff");
}
/* Lato (bold, regular) */
@font-face {
    font-display: swap;
    font-family: Lato;
    font-weight: 500;
    font-style: normal;
    src: url("https://assets.gradle.com/lato/fonts/lato-semibold/lato-semibold.woff2") format("woff2"),
    url("https://assets.gradle.com/lato/fonts/lato-semibold/lato-semibold.woff") format("woff");
}
/* Lato (bold, regular) */
@font-face {
    font-display: swap;
    font-family: Lato;
    font-weight: 800;
    font-style: normal;
    src: url("https://assets.gradle.com/lato/fonts/lato-heavy/lato-heavy.woff2") format("woff2"),
    url("https://assets.gradle.com/lato/fonts/lato-heavy/lato-heavy.woff") format("woff");
}


/* BEGIN asciidoc.css */

/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: rgba(0, 0, 0, 0.8); padding: 0; margin: 0; font-family: "Noto Serif", "DejaVu Serif", serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.45; color: #7a2518; font-weight: normal; margin-top: 0; margin-bottom: 0.25em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2156a5; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #1d4b8f; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Open Sans", "DejaVu Sans", sans-serif; font-weight: 300; font-style: normal; color: #ba3925; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.0125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddddd8; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace; font-weight: normal; color: rgba(0, 0, 0, 0.9); }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: rgba(0, 0, 0, 0.8); border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.9375em; color: rgba(0, 0, 0, 0.6); }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: rgba(0, 0, 0, 0.6); }

blockquote, blockquote p { line-height: 1.6; color: rgba(0, 0, 0, 0.85); }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; }
    h1 { font-size: 2.75em; }
    h2 { font-size: 2.3125em; }
    h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
    h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dedede; }
table thead, table tfoot { background: #f7f8f7; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f8f8f7; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }

body { tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; word-spacing: -0.05em; }
h1 strong, h2 strong, h3 strong, #toctitle strong, .sidebarblock > .content > .title strong, h4 strong, h5 strong, h6 strong { font-weight: 400; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: 0.9375em; font-style: normal !important; letter-spacing: 0; padding: 0.1em 0.5ex; word-spacing: -0.15em; background-color: #f7f7f8; -webkit-border-radius: 4px; border-radius: 4px; line-height: 1.45; text-rendering: optimizeSpeed; word-wrap: break-word; }
*:not(pre) > code.nobreak { word-wrap: normal; }
*:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.45; color: rgba(0, 0, 0, 0.9); font-family: "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace; font-weight: normal; text-rendering: optimizeSpeed; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: rgba(51, 51, 51, 0.8); }

kbd { font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace; display: inline-block; color: rgba(0, 0, 0, 0.8); font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: rgba(0, 0, 0, 0.8); }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

p a > code:hover { color: rgba(0, 0, 0, 0.9); }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: rgba(0, 0, 0, 0.85); margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddddd8; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddddd8; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddddd8; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: rgba(0, 0, 0, 0.6); display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: rgba(0, 0, 0, 0.85); }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: rgba(0, 0, 0, 0.85); }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: rgba(0, 0, 0, 0.85); border-bottom: 1px solid #ddddd8; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #efefed; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Open Sans", "DejaVu Sans", sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #7a2518; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
    body.toc2 { padding-left: 15em; padding-right: 0; }
    #toc.toc2 { margin-top: 0 !important; background-color: #f8f8f7; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #efefed; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
    #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
    #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
    #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
    #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
    body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
    body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #efefed; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
    #toc.toc2 { width: 20em; }
    #toc.toc2 #toctitle { font-size: 1.375em; }
    #toc.toc2 > ul { font-size: 0.95em; }
    #toc.toc2 ul ul { padding-left: 1.25em; }
    body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f8f8f7; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: rgba(0, 0, 0, 0.8); padding: 1.25em; }

#footer-text { color: rgba(255, 255, 255, 0.8); line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #efefed; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #ba3925; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #a53221; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; font-family: "Noto Serif", "DejaVu Serif", serif; font-size: 1rem; font-style: italic; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: rgba(0, 0, 0, 0.85); }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: initial; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Open Sans", "DejaVu Sans", sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddddd8; color: rgba(0, 0, 0, 0.6); }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f8f8f7; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; text-align: center; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #f7f7f8; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { -webkit-border-radius: 4px; border-radius: 4px; word-wrap: break-word; padding: 1em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #f7f7f8; background-color: rgba(0, 0, 0, 0.9); }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1em; -webkit-border-radius: 4px; border-radius: 4px; }

.listingblock pre.prettyprint { border-width: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.45; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddddd8; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: rgba(0, 0, 0, 0.85); font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #7a2518; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid rgba(0, 0, 0, 0.6); }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: rgba(0, 0, 0, 0.85); font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.9375em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: rgba(0, 0, 0, 0.6); }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dedede; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.6; background: #f7f8f7; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: rgba(0, 0, 0, 0.8); font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1em; font-size: 0.85em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { width: 1em; position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:first-of-type img { max-width: initial; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.05em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #19407c; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: rgba(0, 0, 0, 0.8); -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

dt, th.tableblock, td.content, div.footnote { text-rendering: optimizeLegibility; }

h1, h2, p, td.content, span.alt { letter-spacing: -0.01em; }

p strong, td.content strong, div.footnote strong { letter-spacing: -0.005em; }

p, blockquote, dt, td.content, span.alt { font-size: 1.0625rem; }

p { margin-bottom: 1.25rem; }

.sidebarblock p, .sidebarblock dt, .sidebarblock td.content, p.tableblock { font-size: 1em; }

.exampleblock > .content { background-color: #fffef7; border-color: #e0e0dc; -webkit-box-shadow: 0 1px 4px #e0e0dc; box-shadow: 0 1px 4px #e0e0dc; }

.print-only { display: none !important; }

@media print { @page { margin: 1.25cm 0.75cm; }
    * { -webkit-box-shadow: none !important; box-shadow: none !important; text-shadow: none !important; }
    a { color: inherit !important; text-decoration: underline !important; }
    a.bare, a[href^="#"], a[href^="mailto:"] { text-decoration: none !important; }
    a[href^="http:"]:not(.bare):after, a[href^="https:"]:not(.bare):after { content: "(" attr(href) ")"; display: inline-block; font-size: 0.875em; padding-left: 0.25em; }
    abbr[title]:after { content: " (" attr(title) ")"; }
    pre, blockquote, tr, img, object, svg { page-break-inside: avoid; }
    thead { display: table-header-group; }
    svg { max-width: 100%; }
    p, blockquote, dt, td.content { font-size: 1em; orphans: 3; widows: 3; }
    h2, h3, #toctitle, .sidebarblock > .content > .title, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
    #toc, .sidebarblock, .exampleblock > .content { background: none !important; }
    #toc { border-bottom: 1px solid #ddddd8 !important; padding-bottom: 0 !important; }
    .sect1 { padding-bottom: 0 !important; }
    .sect1 + .sect1 { border: 0 !important; }
    #header > h1:first-child { margin-top: 1.25rem; }
    body.book #header { text-align: center; }
    body.book #header > h1:first-child { border: 0 !important; margin: 2.5em 0 1em 0; }
    body.book #header .details { border: 0 !important; display: block; padding: 0 !important; }
    body.book #header .details span:first-child { margin-left: 0 !important; }
    body.book #header .details br { display: block; }
    body.book #header .details br + span:before { content: none !important; }
    body.book #toc { border: 0 !important; text-align: left !important; padding: 0 !important; margin: 0 !important; }
    body.book #toc, body.book #preamble, body.book h1.sect0, body.book .sect1 > h2 { page-break-before: always; }
    .listingblock code[data-lang]:before { display: block; }
    #footer { background: none !important; padding: 0 0.9375em; }
    #footer-text { color: rgba(0, 0, 0, 0.6) !important; font-size: 0.9em; }
    .hide-on-print { display: none !important; }
    .print-only { display: block !important; }
    .hide-for-print { display: none !important; }
    .show-for-print { display: inherit !important; } }

/* END asciidoc.css */

html,
body {
    margin: 0;
    padding: 0;
}

html {
    font-size: 16px;
    font-weight: 400;
    line-height: 1.5;
}

body {
    color: #02303A;
    background-color: #f7f7f8;
    font-family: "Lato", "Helvetica Neue", Arial, sans-serif;
    line-height: 1.5;
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
}

/* Links */
a {
    color: #1DA2BD;
    text-decoration: none;
}

a:hover,
a:focus {
    text-decoration: underline;
}

#content a[href^='../dsl/'],
#content a[href^='../javadoc/'] {
    font-family: 'Inconsolata', monospace;
    font-style: normal;
    border-bottom: 1px dotted rgba(29, 162, 189, 0.5);
    padding: 0 1px;
}

#content a[href^='../dsl/']:hover,
#content a[href^='../dsl/']:focus,
#content a[href^='../javadoc/']:hover,
#content a[href^='../javadoc/']:focus {
    text-decoration: none;
}

/* Copy */

p {
    font-size: 1rem;
}

pre,
pre > code,
code {
    font-family: 'Inconsolata', monospace;
}

h1,
h2,
h3,
h4,
h5,
h6,
#toctitle,
.sidebarblock > .content > .title {
    font-family: inherit;
    font-weight: 500;
    color: inherit;
}

h1 {
    font-size: 2rem;
}
h2 {
    font-size: 1.5rem;
}
h3 {
    font-size: 1.125rem;
}
h4 {
    font-size: 1.0625rem;
}
h5, h6 {
    font-size: 1rem;
}

b, strong {
    font-weight: 500;
}

dl {
    margin: 0 0 1.25rem 1.5rem;
}

.dlist dt code {
    color: #02303A;
    font-size: 1em;
    font-weight: bold;
}

.dlist p {
    margin-bottom: 0.625rem;
}

/* Layout */
.main-content > .appendix,
.main-content > .book,
.main-content > .chapter,
.main-content > .footer {
    background-color: white;
    border-radius: 5px;
    max-width: 45rem;
    padding: 1.5rem;
}

@media screen and (max-width: 45em) {
    .footer {
        max-width: 100%;
    }
    .main-content > .appendix,
    .main-content > .book,
    .main-content > .chapter {
        margin-top: 0;
        margin-bottom: 0;
    }
}

/* Override asciidoc styles */
#header {
    position: static;
}
#header, #content {
    padding: 0;
}

#header .details {
    /* TODO: Pretty sure there's a way to avoid Asciidoc generating details */
    display: none;
}

p {
    color: #02303A;
}

.subheader,
.admonitionblock td.content > .title,
.audioblock > .title,
.exampleblock > .title,
.imageblock > .title,
.listingblock > .title,
.literalblock > .title,
.stemblock > .title,
.openblock > .title,
.paragraph > .title,
.quoteblock > .title,
table.tableblock > .title,
.verseblock > .title,
.videoblock > .title,
.dlist > .title,
.olist > .title,
.ulist > .title,
.qlist > .title,
.hdlist > .title {
    color: inherit;
    font-family: inherit;
}

.listingblock .title,
.listingblock .title code {
    font-style: normal;
    font-weight: bold;
}

#content .admonitionblock .icon .title {
    color: transparent;
    font-size: 3.5em;
    text-shadow: 0 0 #00c489;
    opacity: 0.7;
}

.admonitionblock td.content > .title {
    font-family: inherit;
    font-style: normal;
    font-size: 1.25em;
    color: #555;
}

.admonitionblock table tr td {
    padding: 0;
}

.imageblock,
.videoblock {
    padding: 0.25em;
}

p.lead,
.paragraph.lead > p,
#preamble > .sectionbody > .paragraph:first-of-type p {
    font-size: 1.0625rem;
}

.paragraph.lead > p,
#preamble > .sectionbody > .paragraph:first-of-type p {
    color: inherit;
}

.sect1 {
    padding-bottom: 0;
}

.sect1 + .sect1 {
    border: 0 none;
}

.admonitionblock .icon .title {
    font-size: 2.3em;
}

.admonitionblock > table td.icon .title {
    font-family: "Lato", Arial, sans-serif;
}

.admonitionblock .content,
.admonitionblock p {
    color: #666;
}

.verseblock pre {
    font-family: "Lato", Arial, sans-serif;
}

td.hdlist1 {
    padding-bottom: 0.625rem;
}

td.hdlist2 p {
    margin-bottom: 0.625rem;
}

body.book #header > h1 {
    border: 0;
}

#header > h1:first-child {
    margin-top: 0;
}

#content a.link {
    color: #02303A;
}

.highlight .com {
    color: #777;
}

.listingblock pre.highlightjs > code {
    overflow-x: auto;
}

.listingblock pre.highlight {
    overflow-x: auto;
}

.listingblock pre.highlight > code {
    white-space: pre;
}

.conum[data-value] {
    font-family: "Lato", Arial, sans-serif;
}

.colist > table tr > td:first-of-type {
    padding-top: 0.25em;
    padding-bottom: 0.25em;
    line-height: 1.4;
    vertical-align: baseline;
}

/*
 * Samples
 */
.exampleblock > .content {
    background-color: inherit;
    border: 0 none;
    box-shadow: none;
    padding: 0;
}

.exampleblock > .content .title {
    background-color: #f7f7f8;
    border-top: 1px solid #ccc;
    font-family: 'Inconsolata', monospace;
    margin: 0;
    padding: 1em 1em 0;
}

.exampleblock .listingblock {
    margin: 0;
}

/* Multi-language selection */
.multi-language-selector .language-option[data-lang='groovy'],
.exampleblock[data-lang=groovy] > .content .title {
    background-image: url('data:image/svg+xml;base64,PHN2Zw0KICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KICAgd2lkdGg9IjYxNC4wNjA4NSINCiAgIGhlaWdodD0iMzAzLjU5ODYiDQogICB2ZXJzaW9uPSIxLjEiPg0KICA8Zw0KICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzUuMzk2NTk5LC0zMC41NTgxOTYpIj4NCiAgICA8cGF0aA0KICAgICAgIGQ9Im0gMTU0Ljk3Njg3LDMzMi42OTE2MiBjIDAsLTAuODA1ODcgMTAuODMxMjMsLTE4LjYyMTcyIDI0LjA2OTQsLTM5LjU5MDc2IDEzLjIzODE5LC0yMC45NjkwNSAyMi42NjA1NywtMzguNjIwNjYgMjAuOTM4NjcsLTM5LjIyNTc3IC0xLjcyMTkxLC0wLjYwNTEgLTcuNjc5OTIsMC40ODU2NyAtMTMuMjQwMDIsMi40MjM5MyAtMTYuNzQ1MjQsNS44Mzc0MyAtMjAuMTg2MDUsNC4yOTAxNiAtMzIuNjkzMDgsLTE0LjcwMTU1IC0xMy41MzI2NSwtMjAuNTQ5MDYgLTE0LjAxNzI0LC0yMi42Njk4MyAtNi45NjE1OCwtMzAuNDY2MjQgNC42MDg3NiwtNS4wOTI1NiA0LjMzMTU5LC02LjI3OTY3IC0zLjIzMTksLTEzLjg0MzE2IC00LjU1MDA5LC00LjU1MDEgLTguMjcyODksLTkuNjQzMDkgLTguMjcyODksLTExLjMxNzc2IDAsLTIuODE2NzkgLTMwLjk5MTQ1LC0xNS41ODkzMyAtNzkuOTg5NDk2LC0zMi45NjYxNSAtMTEuMTA5NjYsLTMuOTM5OTcgLTIwLjE5OTM3NSwtNy44MjkyOCAtMjAuMTk5Mzc1LC04LjY0MjkxIDAsLTAuODEzNjYgMjMuNDcwNzM4LC0xLjAwNDc2IDUyLjE1NzE5MSwtMC40MjQ2OSBsIDUyLjE1NzIxLDEuMDU0NjYgNS4wOTEyNywtOC4wMzAwMSBjIDIxLjUxNjQ0LC0zMy45MzU5MiA1NC4wMDk1MiwtNjQuNTg4MjEyIDY4LjQ2NzA1LC02NC41ODgyMTIgMy4wMTA2LDAgOS4xMjE0MSwyLjg2OTE4IDEzLjU3OTUzLDYuMzc1OTQ1IDcuMjU5NDYsNS43MTAyODMgOC4yNTY1LDkuMjQ4NjMyIDkuNTQ5OTQsMzMuODkxOTY3IDAuNzk0MywxNS4xMzM4MiAyLjQyNDIyLDI4LjQ5NjAxIDMuNjIxOTgsMjkuNjkzNzkgMS4xOTc3NSwxLjE5Nzc2IDQuOTk3NjksLTAuMzc0MjUgOC40NDQzMSwtMy40OTMzOSA0LjQwMTQsLTMuOTgzMjMgOS4wMzQ4NCwtNS4wNjMxMyAxNS41Njc2MSwtMy42MjgzIDYuNzY3NTYsMS40ODY0MSAxMC42MjcxLDAuNDY4OTUgMTQuMTY5MzgsLTMuNzM1NDMgNS4zMTM2LC02LjMwNjY2IDMxLjkwNTk2LC00OC45MzcyMDEgMzEuOTA1OTYsLTUxLjE0ODc0NCAwLC0wLjc1MTU4OCA1LjI2NTA5LC05Ljc1NzMwNiAxMS43MDAyMywtMjAuMDEyNzAzIDYuNDM1MDksLTEwLjI1NTM5NyAxMy44NDY2NCwtMjIuMDgwNjMxIDE2LjQ3MDA3LC0yNi4yNzgyODMgNC42NjU1OCwtNy40NjUyMDEgNS4zOTY2LC02LjU4MTczNSAzMy40MjY5Miw0MC4zOTg3MzYgMjguOTQxMjEsNDguNTA3MTY0IDQ0LjUxNzY3LDY2LjQwNjU1NCA1Mi4zMTU3LDYwLjExNzYzNCA1LjQ0MiwtNC4zODg4OSAzNC4wMDA1NSwtNC42Mzc5NCA0MS45ODI0NiwtMC4zNjYxNCA0LjUzNjY1LDIuNDI3OTMgNy40MTkxNiwyLjM5NjEgOS45MjQ4NCwtMC4xMDk2MiA1LjIwMDA3LC01LjIwMDA2IDE3LjY0OTgyLC00LjI5NDM3IDIwLjkwNDEyLDEuNTIwNzggMi41NjM5Myw0LjU4MTQ2IDMuMjE3ODQsNC41ODE0NiA3LjAyMDE0LDAgMi4zMDYwNiwtMi43Nzg2NyA5LjEzNjE5LC01LjA1MjA4IDE1LjE3ODAzLC01LjA1MjA4IDguNTM4ODQsMCAxMS43OTMzNiwxLjc3MzY3IDE0LjYxNDAzLDcuOTY0MzcgbCAzLjYyODgxLDcuOTY0MzYgNTYuMDkyMDMsLTEuOTg1OCBjIDMwLjg1MDYyLC0xLjA5MjIyIDU2LjA5MjA0LC0xLjI4Njg4IDU2LjA5MjA0LC0wLjQzMjU1IDAsMC44NTQyNyAtMjIuOTA2MDgsMTAuMDcxOTUgLTUwLjkwMjQxLDIwLjQ4MzcxIC0yNy45OTYzMiwxMC40MTE3MiAtNTEuMzY3LDE5LjI0MzA1IC01MS45MzQ4NCwxOS42MjUxMiAtMC41Njc4NSwwLjM4MjA3IDAuNjk4NDcsOS40OTI3MyAyLjgxNDA1LDIwLjI0NTg4IDUuNTA0NTcsMjcuOTc5MTcgMS45MTQ1OCw0Ni42MjU4OSAtMTEuOTI2MjksNjEuOTQ2MDQgLTYuMjA5LDYuODcyNjMgLTE2LjI4MzM4LDE0LjE0Mzk1IC0yMi4zODc1MywxNi4xNTg0OSAtNi4xMDQxNSwyLjAxNDU0IC0xMS4wOTg0NCw0LjM4NjE0IC0xMS4wOTg0NCw1LjI3MDE5IDAsMC44ODQwNiA2LjUxNTI1LDExLjY3ODkzIDE0LjQ3ODM1LDIzLjk4ODU5IDcuOTYzMDksMTIuMzA5NjkgMTMuMjgyOCwyMi4zODEyNSAxMS44MjE1MiwyMi4zODEyNSAtMi4zODUwNCwwIC02MC40Njk4NywtMjIuNDQyMzggLTE1MC43ODg5OCwtNTguMjYwNyAtMTcuODA5LC03LjA2MjU4IC0zNC4wMjY4MywtMTIuODQxMDkgLTM2LjAzOTYxLC0xMi44NDEwOSAtMy43NTM2MywwIC0zNi4xNjY5LDEyLjI4NjYyIC0xMzEuMjI0MjMsNDkuNzQyMDYgLTU1LjEyNTI1LDIxLjcyMTAzIC01Ny4yOTIxNywyMi40NzM0OCAtNTcuMjkyMTcsMTkuODk0NTEgeiBtIDExMy4xMTY0OCwtNTEuMjUyNjUgYyAyOS4zMjk0OSwtMTEuMzk1MDYgNTguNDE2NTcsLTIyLjUzMDggNjQuNjM3OTgsLTI0Ljc0NjA3IDEwLjcwMDY4LC0zLjgxMDE5IDE0LjI3OTE4LC0yLjg1NDkzIDY2LjI1Mzk0LDE3LjY4NjM0IDMwLjIxODI1LDExLjk0Mjc0IDYwLjAzMjUyLDIzLjU3NTg3IDY2LjI1MzkyLDI1Ljg1MTM0IDYuMjIxNDEsMi4yNzU1MiAxOS4wNDMxNyw3LjIyMDU5IDI4LjQ5Mjc1LDEwLjk4OTA4IDEwLjc3NTAzLDQuMjk3MDQgMTYuMjgyNTEsNS4zMzE2NiAxNC43NzEwOCwyLjc3NDg0IC0xNi44ODM3LC0yOC41NjExMyAtMTcuMzk5OCwtMjkuMDM3MTYgLTI5LjEwMDgzLC0yNi44NDIwNSAtMTQuMTEzNjEsMi42NDc3MiAtMjIuODc4OTcsLTAuMDY4NSAtMjcuMzgzNjksLTguNDg1NTQgLTIuOTIxMTIsLTUuNDU4MTYgLTIuMDI5NDQsLTguMTI3NTkgNS4yNTQ0MiwtMTUuNzMwMzEgMTAuODQ4ODcsLTExLjMyMzc3IDkuMTQ0NTcsLTIxLjc0MTQ0IC00Ljg0NDI5LC0yOS42MTA5OSAtNS4zNjc2NCwtMy4wMTk1OSAtMTIuMTQwNTksLTEwLjQ4MzcyIC0xNS4wNTEwMiwtMTYuNTg2OTcgbCAtNS4yOTE2OSwtMTEuMDk2ODIgLTExLjM0NTUxLDcuNjk5MjggYyAtMTMuOTQ0NTgsOS40NjMwNCAtMzAuOTUwNjIsOS45NTA2MyAtNDUuMTQ3NjQsMS4yOTQ0OCBsIC0xMC40NjQ4OCwtNi4zODA2NSAtMTIuMTU4NDEsOC4yNjI4NCBjIC0xMi4xNzQ2Miw4LjI3Mzg2IC0yNi4xOTEwOCw5LjM0MjggLTQwLjQzNzUyLDMuMDgzOTIgLTMuOTI0OTgsLTEuNzI0MzkgLTUuNjU1ODMsLTEuMDU0MTUgLTUuNjU1ODMsMi4xOTAwOCAwLDIuNTcxMTggLTMuNzA0MjksNi4zNjI2NSAtOC4yMzE4MSw4LjQyNTUzIC0xMy41NzQyLDYuMTg0NzkgLTI2LjgyMTA3LDQuNTQyNDcgLTM1LjgwMjI5LC00LjQzODc1IGwgLTguMTg5NDQsLTguMTg5NDQgLTYuNjA5ODIsOC40MDMwMyBjIC0zLjYzNTM5LDQuNjIxNjYgLTEyLjA0OTUyLDExLjgzNjk4IC0xOC42OTgwNSwxNi4wMzM5OCAtOC4yMjk2NSw1LjE5NTE4IC0xOC40MTc0MSwxNy44NzE4MiAtMzEuOTE2NCwzOS43MTM2MSAtMTAuOTA1NDksMTcuNjQ1NDYgLTE5LjgyODE2LDMyLjk4MDQyIC0xOS44MjgxNiwzNC4wNzc3NiAwLDEuMDk3MyA4LjM2MjU1LC0xLjUyNzM2IDE4LjU4MzQyLC01LjgzMjU5IDEwLjIyMDg5LC00LjMwNTIxIDQyLjU4MDI4LC0xNy4xNTA4NyA3MS45MDk3NywtMjguNTQ1OTMgeiBtIDI0OC43NjcyOSwtMTIuMjU4NDYgYyAyMi4yNTU1NywtMTIuNTA4MzMgMjcuNDE0MjQsLTM1LjY0ODA4IDE3LjU3Njg1LC03OC44NDMxOCAtOC4yMjE0LC0zNi4wOTk2MSAtMTIuMzI1NSwtNDcuOTEzMjcgLTE3LjE5NDk0LC00OS40OTU5NyAtMy4zNjkwMiwtMS4wOTUwMyAtMy44ODY3NCwwLjEwNjk5IC0xLjk4ODU4LDQuNjE2MzUgMTIuMzE1MTYsMjkuMjU3NzEgMTIuOTk5NjMsNDMuOTQ2NjIgMi4yNDAyMiw0OC4wNzU0MSAtNy4zOTE1MSwyLjgzNjQyIC0xNS4yMzIzOSwtNy43OTA3NSAtMjEuMzk5MDIsLTI5LjAwMzI2IC00Ljc3NTEyLC0xNi40MjU4NyAtOS43Njg2MSwtMjMuODI4MzcgLTEzLjUzMzg3LC0yMC4wNjMxMSAtMC45MDE1NywwLjkwMTYgMC42Nzg0OCw2LjEyMTE3IDMuNTExMjQsMTEuNTk5MTMgMi44MzI3Myw1LjQ3NzkgNi43MTcyMSwyMS45NzQ1NSA4LjYzMjE3LDM2LjY1OTIgMS45MTQ5NywxNC42ODQ2MiA1LjYxMzg1LDMwLjA2MDczIDguMjE5NzMsMzQuMTY5MTIgNi43NzE5OCwxMC42NzY2MSAxNy41NTEyOCw4LjEwMzYgMjQuNTIzODIsLTUuODUzODQgNi44OTM3MywtMTMuNzk5NzUgNy42NzI4NCwtNC42MDc4MSAwLjk2OTMsMTEuNDM2MDIgLTYuOTYwNzQsMTYuNjU5MzcgLTI3LjYzNDQyLDIxLjY1NDgxIC01MS41ODQxOCwxMi40NjQ0MiAtMy44MzMzLC0xLjQ3MDk2IC01LjEzMDM5LDAuMDUxNSAtNS4xMzAzOSw2LjAyMDk3IDAsNC4zOTQzMSAtMi45MzYxOCwxMS43MjI0NSAtNi41MjQ4OCwxNi4yODQ3IGwgLTYuNTI0ODgsOC4yOTUwNiA4Ljk0ODgxLDEuNTExMjMgYyAxNS40NDk0NSwyLjYwOTA5IDM2LjYzMzI4LC0wLjc3NjQyIDQ5LjI1ODYsLTcuODcyMjUgeiBtIC0zMjAuMzY2NSwtMjcuNTM3MzMgYyA0Ni40NTk2NSwtMTMuMzU0NSA1NC43NjE4OCwtMjguOTMwOTMgMzkuMzI4ODUsLTczLjc4NzgyIC0zLjU4MTg1LC0xMC40MTA3OSAtNi41MTI0MywtMjEuNjA5NzEgLTYuNTEyNDMsLTI0Ljg4NjU0IDAsLTExLjE1NzEyIC01LjYxMTUyLC02LjAwMTYxIC05LjgxNzEzLDkuMDE5NDMgLTUuNTYyMDMsMTkuODY1NjEgLTIyLjI5MTE1LDM2Ljc1MDUzIC0zNi4zNDUxNiwzNi42ODM2NCAtMTIuMjA1NDcsLTAuMDU4MiAtMTYuMTgyNTEsLTIuMjgwMDggLTIxLjIyMzc4LC0xMS44NTc2OCAtOS4wNDc0OCwtMTcuMTg4ODIgMC44MTQ2OSwtNDMuNTY3OTcgMjUuOTY5NTQsLTY5LjQ2MjcyIDE4LjQyNDMxLC0xOC45NjYzMDQgMjguNDg4OTMsLTIwLjY4Mzk2NSAyOC40ODg5MywtNC44NjIwNSAwLDI0LjY3MzIgLTE3LjAxMTM0LDYwLjk5NDcgLTI1Ljk3MzA5LDU1LjQ1NjA0IC00LjM4MjA1LC0yLjcwODI2IC0zLjY3MTM4LC0xNC42Njc1MiAxLjQxNzIyLC0yMy44NTAwOSA0LjMyNzM1LC03LjgwODgyIDMuNDQ4MTQsLTE5LjcwNzcxIC0xLjQ1NjIsLTE5LjcwNzcxIC01LjY4Njg5LDAgLTE2Ljk0NTQ3LDIwLjcxMTk2IC0xOC40MzMxOCwzMy45MTA3NCAtMS4zMTUxNSwxMS42NjgyNiAtMC40OTI4NiwxNC41MDU0NSA1LjA2NjUyLDE3LjQ4MDcyIDE5LjQ4MjQ0LDEwLjQyNjcgNDUuMDA1MzEsLTIxLjM5NTQ1IDQ2LjI5MDgzLC01Ny43MTU4NCAwLjY3NTA0LC0xOS4wNzMxODEgLTMuMDE2NzYsLTI0LjQ0MTEwNSAtMTQuNzc5MDYsLTIxLjQ4ODk1MSAtMTcuMTE4NzksNC4yOTY1NDMgLTYzLjIzNDgzLDYzLjc4NjY0MSAtNjMuMjM0ODMsODEuNTczNDYxIDAsMTMuOTEyOCA2Ljk4NzM3LDIzLjY5NzI4IDE5LjI4ODI3LDI3LjAwOTYgMjAuOTE0MTksNS42MzE2MiA0MS4xMzUzOSwtNC4zNzM4OSA1NS40NjMzLC0yNy40NDMzOCBsIDYuMDIxNzUsLTkuNjk1NzEgMC4wMTMyLDEzLjE3MjIzIGMgMC4wMTYyLDE5LjA3MzggLTEyLjQyNjE5LDI5LjEyNzQgLTUxLjY5ODE3LDQxLjc2NzkzIC05Ljc3NjQ5LDMuMTQ2OCAtMTguMTgzMzIsNi4wNTQ0MSAtMTguNjgxOCw2LjQ2MTM3IC0xLjgyMDU2LDEuNDg2MzIgMTYuNjg3MzksMjcuNDc1NzEgMTkuNTY2NDQsMjcuNDc1NzEgMS42MzI2MiwwIDExLjE5MTE1LC0yLjM2MzU5IDIxLjI0MTIzLC01LjI1MjM4IHogTSA0NzYuNDExLDIxNy45NjMwMSBjIDQuNjYzNDcsLTUuMTUzMSA1LjQ4NTUxLC0xMC43NTEwMyA0LjQ4NTc5LC0zMC41NDgyMyAtMS4wODczOSwtMjEuNTMzMzEgLTIuMjc3NDYsLTI1LjMzODUxIC0xMC42NjE0MywtMzQuMDg5NDkgLTE1LjE0ODgyLC0xNS44MTE5NCAtMzMuODYxMjMsLTExLjc3ODI4IC0yMi45MDgxOSw0LjkzODE0IDUuODIyNTYsOC44ODYzNyAxMi45MjU0LDcuMzY4NjQgMTAuNDE2NDEsLTIuMjI1ODEgLTEuOTk4NjQsLTcuNjQyNzYgMS43Mjk5OCwtNy44NDM1OCA4LjIyODM5LC0wLjQ0MzIyIDEyLjE5MzAxLDEzLjg4NTM3IDkuMTE1MzQsMzMuMTI2OTggLTUuMjk4NiwzMy4xMjY5OCAtOS44NjcxNiwwIC0xMi45NDE5NSwtNC4yMzE3NiAtMTkuMzczNTMsLTI2LjY2MzE4IC0yLjkzMDU5LC0xMC4yMjA4NyAtNi40OTk2NCwtMTguNTgzNDMgLTcuOTMxMjcsLTE4LjU4MzQzIC00Ljc2ODk5LDAgLTYuODkyODcsNC4yMDg3OCAtMy45MjcyMSw3Ljc4MjQgMS42MTA4OCwxLjk0MTEgNi4wNzIxOCwxNS44OTEyNyA5LjkxNDA0LDMxLjAwMDQxIDkuNjY5MDMsMzguMDI1OTYgMjMuMTc2NjYsNTEuMDQxNDUgMzcuMDU1NiwzNS43MDU0MyB6IG0gLTE4My43NzEyNSwwLjYwMzk1IGMgMS45ODk3OCwtMS4zMzUgMi44OTk3NSwtNy42NDg5MyAyLjA3ODY1LC0xNC40MjMgLTEuMzI0NDksLTEwLjkyNzAyIC0yLjA2NjYyLC0xMS43MjQxIC03Ljk3MjcsLTguNTYzMjcgLTguNDg3MzMsNC41NDIyNyAtMTcuNjA4MzksLTQuMDYzNTEgLTIwLjcwMjIyLC0xOS41MzI2IC0yLjM0NzA3LC0xMS43MzUzOCAtMy4wNjUyNiwtMTEuNTA0ODkgMTQuMDI1NzYsLTQuNTAxNDkgMi4xNDI4OCwwLjg3ODA4IDcuNTk2NzEsLTIuMTA0MDIgMTIuMTE5NjMsLTYuNjI2OTQgOC4yNzQwOCwtOC4yNzQwOCAxMC45OTgwMiwtMTguMjEyOTkgNC45OTE1NiwtMTguMjEyOTkgLTEuNzc3NTQsMCAtMy4yMzE5LDEuNDU0MzYgLTMuMjMxOSwzLjIzMTkgMCw0LjY0OTIzIC04Ljg0MjMxLDMuOTg5ODIgLTEwLjgzNDY1LC0wLjgwNzk3IC0xLjE2MjI0LC0yLjc5ODc5IC0zLjYzODA3LC0xLjgwNTkxIC04LjA1OTE1LDMuMjMxOSAtMy41MDk4NSwzLjk5OTQ4IC03Ljc5NjczLDcuMjcxNzggLTkuNTI2NDEsNy4yNzE3OCAtMS43Mjk2OSwwIC00LjA2NTYsLTMuMjcyMyAtNS4xOTA4OCwtNy4yNzE3OCAtMS45NzE5NSwtNy4wMDg1NiAtMi4yMTM2NiwtNy4wNTI3NyAtNi42NzczNywtMS4yMjE2OSAtMy45MTA2LDUuMTA4NTQgLTMuOTQ1NTcsNi43MzU4MyAtMC4yMjQ2MSwxMC40NTY2MSAzLjk0MDYyLDMuOTQwNjQgMTEuNDI2MTUsMzAuODcxMDIgMTEuNDI2MTUsNDEuMTA3NDQgMCwxMi43Mjg2NyAxNy41MjkzMywyMi43MzgzMiAyNy43NzgzLDE1Ljg2MjEgeiBtIDU4Ljk0MzA5LC0xNi44NzUzMSBjIDEyLjE0NTY3LC0xMi4xNDU2NyAxNS43NDQ1MiwtMzAuMzUxNDMgOS4xMjk0MywtNDYuMTgzNTcgLTUuMTcwMTYsLTEyLjM3Mzk3IC0xNC4xNDQ2NiwtMTcuMDA1MTYgLTI2Ljc5ODc4LC0xMy44MjkxOCAtOS40MDI2MywyLjM1OTkxIC0yMy43MjMxMSwyOS43NzY1OSAtMjMuNzczODcsNDUuNTE1MzYgLTAuMDc5MiwyNC41MjkwMiAyMy4yNTA1MywzMi42OTAwNSA0MS40NDMyMiwxNC40OTczOSB6IG0gLTIyLjA4MzQxLC0xOS40MzQwNyBjIC0zLjU1NTEsLTMuNTU1MSAtNi40MTc1NSwtMTAuNDYzMjggLTYuMzYxMDIsLTE1LjM1MTUzIDAuMDkzNCwtOC4wNzk2NSAwLjQ5MzE1LC04LjM3MzUgNC4zOTYxOSwtMy4yMzE5IDQuODI0NjQsNi4zNTU2OSAxMy4zOTc5Nyw3LjQ1NjY2IDE2LjY4MjQxLDIuMTQyMzIgMS4xOTQzMiwtMS45MzI0MSAwLjU1Mjk1LC01LjEzMjAyIC0xLjQyNTIsLTcuMTEwMTcgLTUuMDgxMzIsLTUuMDgxMzIgLTQuNDY1NjEsLTExLjk5OTYzIDEuMDY3OTIsLTExLjk5OTYzIDYuMTUxMzcsMCAxNC43MjY3OSwxMi41MTQ3NyAxNC43MjY3OSwyMS40OTE5MSAwLDYuNjA2NzQgLTEzLjQ0NDQsMjAuNTIyOCAtMTkuODI3MjQsMjAuNTIyOCAtMS41Mzc4NSwwIC01LjcwNDc2LC0yLjkwODcyIC05LjI1OTg1LC02LjQ2MzggeiBtIDg2LjM0ODk3LDE4LjU4MzQxIGMgMTMuNDEwNzQsLTE0LjYwMjYzIDEyLjEwMzc2LC0zNy4wOTggLTMuMDk4MjUsLTUzLjMyNjM0IC03Ljg1MDU3LC04LjM4MDYgLTI1LjI5Mjk4LC05LjgyNTUyIC0zMi40MzE4NSwtMi42ODY2NCAtNi41ODc2MSw2LjU4NzYxIC0xMy4xNjQ2NSwzMi40OTMwMyAtMTAuNzIxMjIsNDIuMjI4NDEgNS4yMTEyMiwyMC43NjMxOCAzMi40MDA0MSwyOC44NjY1MiA0Ni4yNTEzMiwxMy43ODQ1NyB6IG0gLTI3LjQ1NTY1LC0yMy42MTQ1MiBjIC01LjMwNjIzLC0zLjcxNjY0IC03LjEyOTQxLC04LjE0OTc0IC02Ljk3ODA2LC0xNi45Njc0NyAwLjE2OTM1LC05Ljg2MDMzIDAuNjg0MywtMTAuNzQ5ODEgMi45NjE0NSwtNS4xMTQxNSAzLjM0NTczLDguMjgwMzIgMTAuMzYyOTIsMTEuNDA3MzQgMTYuNTE4MTQsNy4zNjA5IDMuODE3NTMsLTIuNTA5NjMgMy42MzkyOSwtMy42OTU5NyAtMS4xMDEwNCwtNy4zMjkwNyAtNi4zMjE4OSwtNC44NDUyMyAtNy41NTUwOCwtMTEuNzAxOTEgLTIuMTA0NjUsLTExLjcwMTkxIDQuODczNjQsMCAyMi4zMDQwMiwxOS4wNjY2NiAyMi4zMDQwMiwyNC4zOTc3OCAwLDUuMjAzMTYgLTEyLjM3NzM5LDE0LjM4NTAzIC0xOS4zOTEzOSwxNC4zODUwMyAtMi43NjQwNSwwIC04LjI1NzksLTIuMjY0MDIgLTEyLjIwODQ3LC01LjAzMTExIHogbSAxODkuOTYyOTIsLTE0LjI4ODg3IDMzLjkzNDk1LC0xMi43MzY4MiAtMzYuMzU4ODgsLTAuMTMxMjUgYyAtMzIuNTM5MiwtMC4xMTczNiAtMzYuMzU0MjQsMC40NjMwNyAtMzYuMzE0NzUsNS41MjQ3NSAwLjA0MDEsNS4xMjc1NyAzLjMzMDczLDIwLjI4Mzk1IDQuMzcyNywyMC4xMzk2NyAwLjIzNzIyLC0wLjAzMjkgMTUuNzAxNzcsLTUuNzkxMjQgMzQuMzY1OTgsLTEyLjc5NjQ4IHogbSAtNDQzLjQ5MzQzLC0yLjI3OTMgMy40NjgyNSwtMTAuMjg3NjEgLTMwLjQ2Njg2LC0xLjAyNDA0IGMgLTE2Ljc1Njc0NCwtMC41NjMyMiAtMzAuNDYzNTg0LC0wLjEzMjEzIC0zMC40NTk1OCwwLjk1ODA0IDAuMDA1OCwxLjU5NTEzIDUyLjUwNjU3LDIyLjEwNzA3IDUzLjY2MTc0LDIwLjk2NTUyIDAuMTgwMzUsLTAuMTc4NCAxLjg4ODkyLC00Ljk1MzcyIDMuNzk2NDUsLTEwLjYxMTkxIHogbSAyMDguOTA5MiwtMzEuODg2OTUgYyA3LjE2NjY3LDEuMTQ2IDE1LjI0OTgxLDQuMDc5MjQgMTcuOTYyNTYsNi41MTgzNSA0LjIxMjc5LDMuNzg3ODMgNi4wNDUyOCwzLjUyOTY2IDEyLjU2MjA3LC0xLjc2OTg1IDQuMTk2NDMsLTMuNDEyNSA5LjY1MDI2LC02LjIwNDU3IDEyLjExOTYzLC02LjIwNDU3IDIuNDY5MzksMCA0LjQ4OTgyLC0wLjcxMzA4IDQuNDg5ODIsLTEuNTg0NjcgMCwtMy4wMDkxOCAtNDYuNTM5NTQsLTc5LjIxMjUyIC00OC4zMTQ0NywtNzkuMTA5NjEgLTIuMDg1LDAuMTIwODcyIC00OS43ODYwMyw4MC4wODc5OCAtNTEuMjU0NjQsODUuOTI0MzcgLTAuNjE2MzQsMi40NDk1MiAxLjMxODA0LDMuMzUzNzEgNS4wNzM2NCwyLjM3MTYgMy4zMzgzNiwtMC44NzMgNy45NTQxNiwwLjY4MzI2IDEwLjI1NzI3LDMuNDU4MzYgMy43MzU0LDQuNTAwODcgNS4yNjEwOCw0LjE0MjI5IDE0LjEzMDY4LC0zLjMyMDk3IDguNDI2NDcsLTcuMDkwNDEgMTEuOTMwOCwtOC4wNDg4IDIyLjk3MzQ0LC02LjI4MzAxIHoiDQogICAgICAgc3R5bGU9ImZpbGw6IzMzMzMzMztmaWxsLW9wYWNpdHk6MSIgLz4NCiAgICA8cGF0aA0KICAgICAgIHN0eWxlPSJmaWxsOiM2Mzk4YWE7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmUiDQogICAgICAgZD0ibSAzMDkuNTQ1NzksMTQwLjg3OTIyIGMgLTAuNTAwNzUsLTAuMjMzMTEgLTEuMTE4MDQsLTAuNzY3OTkgLTIuNTI3OCwtMi4xOTAzNSAtMS45MTE4OCwtMS45Mjg5NyAtMi42NzE4OCwtMi40OTAxMyAtNC4yNjEwOCwtMy4xNDYyOCAtMi4wODc5MSwtMC44NjIwNCAtNC4zNTQ5LC0xLjA5NDIzIC02LjQ4MjMxLC0wLjY2MzkxIC0xLjg5ODA4LDAuMzgzOTMgLTIuNDI0MzUsMC40MjUyNyAtMy4yODI0MiwwLjI1NzggLTEuNDMyMjQsLTAuMjc5NTMgLTEuOTQxNTcsLTEuMTQ5MjkgLTEuNTM1ODMsLTIuNjIyNzIgMC41MDU3MywtMS44MzY1NyA0LjMzNjkzLC04Ljk0MjU1IDEyLjAwODk5LC0yMi4yNzM4NyAxNS41ODM3LC0yNy4wNzg5ODggMzYuNTM2MjQsLTYxLjIyMDk2OCAzOC44NTA1NiwtNjMuMzA2NjYyIDAuMjU2MzEsLTAuMjMwOTk0IDAuMjY1LC0wLjIzMDk5NCAwLjUyMjQ4LDAgMS4zNzc2OCwxLjIzNTk3NiA5LjQ3NjIsMTMuNzI1ODg5IDIwLjU0MDM2LDMxLjY3ODI5OCAxNC45NjY5NiwyNC4yODUwMDQgMjcuNDExMDIsNDUuNjQzNzE0IDI3LjQxMTAyLDQ3LjA0NzcwNCAwLDAuODU3MjkgLTEuMzE2MDgsMS4zNzIxNSAtNC4wODU5MSwxLjU5ODQ1IC0zLjQ0MjI2LDAuMjgxMjQgLTcuNDI0NzgsMi4zMDE4OCAtMTIuODY4ODcsNi41MjkzNiAtMi41ODcxMiwyLjAwODk4IC0zLjY5MTI2LDIuNzU5MzMgLTQuOTUwNjIsMy4zNjQzOCAtMS4wNDkyOCwwLjUwNDExIC0xLjEzNjkyLDAuNTI0MzcgLTIuMjY4NTQsMC41MjQzNyAtMS4xMTM2OCwwIC0xLjIyNjYxLC0wLjAyNDkgLTIuMDk2MjMsLTAuNDYxMjggLTAuNTEyMTMsLTAuMjU3MDIgLTEuNTA0NjksLTAuOTQ5MyAtMi4yNDE1NSwtMS41NjM0MiAtMi4xNzg0OCwtMS44MTU2MSAtNC43OTkxOCwtMy4xMzYxNCAtOS4wNzE5NywtNC41NzEyNCAtNS40Mjk5NywtMS44MjM3NiAtMTEuMjQ0NTQsLTIuOTE4NCAtMTYuMTk1NTEsLTMuMDQ4OTYgLTMuOTA5MzQsLTAuMTAzMDggLTUuNzEyMDEsMC4yNDc5OCAtOC42NzYwMiwxLjY4OTYzIC0yLjQxOTg4LDEuMTc2OTggLTMuNTg2MjEsMi4wMTMxMSAtOS4xMjQ3NSw2LjU0MTQ1IC01LjYzMzc2LDQuNjA2MTcgLTcuNjM0NDIsNS41NjIwNSAtOS42NjQsNC42MTcyNSB6IiAvPg0KICAgIDxwYXRoDQogICAgICAgc3R5bGU9ImZpbGw6IzYzOThhYTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZSINCiAgICAgICBkPSJtIDEyOC42Mzc4NiwxNzAuNzM5IGMgLTEwLjE1OSwtMi45NjA3IC00NS41MDMxNzEsLTE2LjkxOTYyIC01MC40NTA5MjQsLTE5LjkyNTIzIC0wLjY4MjkxNiwtMC40MTQ4NCAtMC43MzgwOTgsLTAuNDc3ODcgLTAuNTQzMjA3LC0wLjYyMDM4IDEuMTMxNTYzLC0wLjgyNzQxIDEyLjMzNzk4MywtMS4yMzkwMSAyNS4wMDQwMzEsLTAuOTE4MzYgNS4wNTEzMSwwLjEyNzg4IDM1LjUwMTMyLDEuMTMzMjMgMzUuNTUwOSwxLjE3Mzc3IDAuMDk5NywwLjA4MTUgLTYuNTIxNjQsMTkuMjg4OCAtNy4wMzA1MSwyMC4zOTQzMyAtMC4yMTI1MSwwLjQ2MTcgLTAuNjUwNjMsMC40NDM2NyAtMi41MzAyOSwtMC4xMDQxMyB6IiAvPg0KICAgIDxwYXRoDQogICAgICAgc3R5bGU9ImZpbGw6IzYzOThhYTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZSINCiAgICAgICBkPSJtIDU0My42OTQxMywxNzUuMzEwNTUgYyAtMS4zODYyLC0yLjcxMjg3IC0zLjg4NzY5LC0xNC45NzA2NyAtMy45NjA3OCwtMTkuNDA4NTggLTAuMDI4NCwtMS43MjQyNCAwLjE4NjY3LC0yLjQyNzQxIDAuOTYwNiwtMy4xNDA4IDEuNzczNzgsLTEuNjM1MDEgNS4zNzkzOCwtMi4yMjMyIDE1LjI5MDE3LC0yLjQ5NDM0IDUuMDAzNDcsLTAuMTM2ODkgMjguMTAxOSwtMC4xNTc5NiA0NC40MTEyNywtMC4wNDA1IGwgMTEuNDI4NTksMC4wODIzIC0yNy41MTc3LDEwLjMxNDI3IGMgLTI1LjA5MjkyLDkuNDA1NCAtMzkuNjg0NzMsMTQuODQxMjYgLTQwLjIyNDkxLDE0Ljk4NDkgLTAuMTM1MTcsMC4wMzYgLTAuMjY5ODEsLTAuMDY3NCAtMC4zODcyNCwtMC4yOTcyMyBsIDAsMCB6IiAvPg0KICAgIDxwYXRoDQogICAgICAgc3R5bGU9ImZpbGw6IzYzOThhYTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZSINCiAgICAgICBkPSJtIDE3OC4wODgzNSwzMTUuNTE0MzMgYyAwLC0wLjc3MDc4IDMuMjY4OSwtNi41MzMxIDExLjU1Mzk1LC0yMC4zNjY5OCAxOS44NTExOCwtMzMuMTQ2MzEgMjguOTI3MTUsLTQ1LjE2MDEyIDQwLjA3MjkyLC01My4wNDQyOSA5Ljk3MTI3LC03LjA1MzM3IDE1LjMwMjc5LC0xMS45Mjk0IDIxLjI0NTM5LC0xOS40MzAzMyBsIDMuNjY0MDksLTQuNjI0OTIgNC45Mzk5LDQuODU2NTIgYyA4LjY0Nzg0LDguNTAxODkgMTMuODYxMywxMC45NjY2OCAyMy4yOTcxNywxMS4wMTQzMiAxMS41NDA1OCwwLjA1ODMgMjQuMTc4NDksLTYuMzg4MSAyNC4xNzg0OSwtMTIuMzMyOTkgMCwtMS4zMzk4IDAuOTU0MDQsLTIuNzIyMzYgMS44Nzg1NywtMi43MjIzNiAwLjM5MTMyLDAgMi42MTY4NiwwLjY4MzY1IDQuOTQ1NjUsMS41MTkyMyA2LjA2OTkyLDIuMTc3OSA5LjYzMDI4LDIuOTY1NDggMTQuNjA5MTIsMy4yMzE2NSA0LjkzOTk4LDAuMjY0MDkgOC41NDg0OCwtMC4xNzA0IDEzLjM1ODE3LC0xLjYwODQxIDQuNzI1NjEsLTEuNDEyODggNy40NDcwOSwtMi44NTkwNSAxNS41OTgzMywtOC4yODg4MiA0LjEwNzYsLTIuNzM2MTggNy41OTk1NCwtNC45NzQ4NyA3Ljc1OTg4LC00Ljk3NDg3IDAuMTYwMzMsMCAzLjEyNTM0LDEuNzE4OTYgNi41ODg5LDMuODE5OTEgMy40NjM1NiwyLjEwMDk1IDcuNjI1NDIsNC4zODEzMyA5LjI0ODU5LDUuMDY3NTEgMTEuMDY4NjIsNC42NzkxOCAyMy4wMjQ0NSw0LjM3MzkgMzMuOTcxMjYsLTAuODY3NDEgMS45NTc5NSwtMC45Mzc0NyA2LjU2NzkzLC0zLjczMDc0IDEwLjI0NDQsLTYuMjA3MjcgMy42NzY0OCwtMi40NzY1MyA2LjczNjEzLC00LjQ0NTc2IDYuNzk5MjMsLTQuMzc2MDYgMC4wNjMxLDAuMDY5NyAxLjQ1NjA1LDIuOTIwOCAzLjA5NTQ0LDYuMzM1NzggMS42Mzk0LDMuNDE0OTggMy42OTg5NSw3LjI2NjcgNC41NzY3OSw4LjU1OTM3IDMuODAwMDEsNS41OTU3OCA4LjE3NTg4LDkuNzUxNDEgMTQuMDgzNDMsMTMuMzc0NjQgNi4wODEyMiwzLjcyOTc1IDkuODMyMDYsOC42ODY4IDEwLjIxODgyLDEzLjUwNTA3IDAuMzgzNjcsNC43Nzk2OCAtMS43MDMyOSw5LjAxOTM5IC03LjcyMTg5LDE1LjY4NzIxIC00LjY5NzQ3LDUuMjA0MTkgLTUuODczMyw3LjIzNTQgLTUuODYxMTMsMTAuMTI0OTEgMC4wMTIyLDIuODkyNjIgMS43MDEwMyw2LjIyODU0IDQuNjY5NjQsOS4yMjM3OSA0LjgwNTMzLDQuODQ4NDQgMTIuMzQ2MDUsNi4yODc3NyAyMy40MzUzNCw0LjQ3MzE5IDIuNDc0MDgsLTAuNDA0ODQgNS41OTQ3OSwtMC43Mzc1NyA2LjkzNDkxLC0wLjczOTM4IDQuMjg1NTEsLTAuMDA2IDYuOTAzMTksMi4wOTU5NSAxMS44OTI1MSw5LjU0ODU5IDMuNDQzNTEsNS4xNDM2NSAxMC45NzM5NiwxNy43NTUwOCAxMC45NzM5NiwxOC4zNzgzNiAwLDAuMzI0MDcgLTAuMzUxNDUsMC41NTIwOCAtMC44NTA5NywwLjU1MjA4IC0xLjA1MTA5LDAgLTUuNjIzMTQsLTEuMjQzOCAtOC45MzIxNCwtMi40Mjk5NCAtNC4zNDg1LC0xLjU1ODc1IC01Ny4yNzIzOCwtMjIuMDA1MjYgLTc0Ljc0Nzg2LC0yOC44Nzc5NSAtNDYuNjYzNSwtMTguMzUxNjIgLTYyLjAyODA1LC0yNC4yMTI0NiAtNjkuNTM2NTcsLTI2LjUyNDg5IC04LjExNDE3LC0yLjQ5ODk1IC0xMy42NDAyOSwtMy4wODUyMiAtMTguMTI2NjEsLTEuOTIzMDYgLTUuNTc5OTYsMS40NDU0NiAtODEuNzIwNjcsMzAuODY4ODggLTEyNi4xMzI0NSw0OC43NDE5NSAtMjEuOTMxMTksOC44MjYgLTI0LjY3NzQ5LDkuODc1NzcgLTI4Ljc4MTE2LDExLjAwMTU5IC0zLjI2MzAzLDAuODk1MjEgLTMuMTQ0MDcsMC44ODI5NCAtMy4xNDQwNywwLjMyNDI2IHoiIC8+DQogIDwvZz4NCjwvc3ZnPg==');
    background-position: 16px 80%;
    background-repeat: no-repeat;
    background-size: 20px 12px;
    padding-left: 2.5em;
}

.multi-language-selector .language-option[data-lang='kotlin'],
.exampleblock[data-lang=kotlin] > .content .title {
    background-image: url('data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCA2MCA2MCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNjAgNjA7Ij4NCjxnPg0KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iWE1MSURfM18iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iMTUuOTU5NCIgeTE9Ii0xMy4wMTQzIiB4Mj0iNDQuMzA2OCIgeTI9IjE1LjMzMzIiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgMCA2MSkiPg0KCQk8c3RvcCAgb2Zmc2V0PSI5LjY3NzAwMGUtMDIiIHN0eWxlPSJzdG9wLWNvbG9yOiMwMDk1RDUiLz4NCgkJPHN0b3AgIG9mZnNldD0iMC4zMDA3IiBzdHlsZT0ic3RvcC1jb2xvcjojMjM4QUQ5Ii8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuNjIxMSIgc3R5bGU9InN0b3AtY29sb3I6IzU1N0JERSIvPg0KCQk8c3RvcCAgb2Zmc2V0PSIwLjg2NDMiIHN0eWxlPSJzdG9wLWNvbG9yOiM3NDcyRTIiLz4NCgkJPHN0b3AgIG9mZnNldD0iMSIgc3R5bGU9InN0b3AtY29sb3I6IzgwNkVFMyIvPg0KCTwvbGluZWFyR3JhZGllbnQ+DQoJPHBvbHlnb24gaWQ9IlhNTElEXzJfIiBzdHlsZT0iZmlsbDp1cmwoI1hNTElEXzNfKTsiIHBvaW50cz0iMCw2MCAzMC4xLDI5LjkgNjAsNjAgCSIvPg0KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMV8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iNC4yMDkyIiB5MT0iNDguOTQwOSIgeDI9IjIwLjY3MzQiIHkyPSI2NS40MDUiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgMCA2MSkiPg0KCQk8c3RvcCAgb2Zmc2V0PSIwLjExODMiIHN0eWxlPSJzdG9wLWNvbG9yOiMwMDk1RDUiLz4NCgkJPHN0b3AgIG9mZnNldD0iMC40MTc4IiBzdHlsZT0ic3RvcC1jb2xvcjojM0M4M0RDIi8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuNjk2MiIgc3R5bGU9InN0b3AtY29sb3I6IzZENzRFMSIvPg0KCQk8c3RvcCAgb2Zmc2V0PSIwLjgzMzMiIHN0eWxlPSJzdG9wLWNvbG9yOiM4MDZFRTMiLz4NCgk8L2xpbmVhckdyYWRpZW50Pg0KCTxwb2x5Z29uIHN0eWxlPSJmaWxsOnVybCgjU1ZHSURfMV8pOyIgcG9pbnRzPSIwLDAgMzAuMSwwIDAsMzIuNSAJIi8+DQogICAgPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8yXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSItMTAuMTAxNyIgeTE9IjUuODM2MiIgeDI9IjQ1LjczMTUiIHkyPSI2MS42Njk0IiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIC0xIDAgNjEpIj4NCgkJPHN0b3AgIG9mZnNldD0iMC4xMDc1IiBzdHlsZT0ic3RvcC1jb2xvcjojQzc1N0JDIi8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuMjEzOCIgc3R5bGU9InN0b3AtY29sb3I6I0QwNjA5QSIvPg0KCQk8c3RvcCAgb2Zmc2V0PSIwLjQyNTQiIHN0eWxlPSJzdG9wLWNvbG9yOiNFMTcyNUMiLz4NCgkJPHN0b3AgIG9mZnNldD0iMC42MDQ4IiBzdHlsZT0ic3RvcC1jb2xvcjojRUU3RTJGIi8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuNzQzIiBzdHlsZT0ic3RvcC1jb2xvcjojRjU4NjEzIi8+DQoJCTxzdG9wICBvZmZzZXQ9IjAuODIzMiIgc3R5bGU9InN0b3AtY29sb3I6I0Y4ODkwOSIvPg0KCTwvbGluZWFyR3JhZGllbnQ+DQoJPHBvbHlnb24gc3R5bGU9ImZpbGw6dXJsKCNTVkdJRF8yXyk7IiBwb2ludHM9IjMwLjEsMCAwLDMxLjcgMCw2MCAzMC4xLDI5LjkgNjAsMCAJIi8+DQo8L2c+DQo8L3N2Zz4=');
    background-position: 17px 80%;
    background-repeat: no-repeat;
    background-size: 11px 11px;
    padding-left: 2.3em;
}

.multi-language-selector {
    display: block;
}

.multi-language-selector .language-option[data-lang='groovy'] {
    background-position: 20px center;
    padding-left: 32px;
}

.multi-language-selector .language-option[data-lang='kotlin'] {
    background-position: 30px center;
    padding-left: 27px;
}

.multi-language-selector .language-option {
    background-color: white;
    border: 1px solid #f7f7f8;
    border-radius: 4px 4px 0 0;
    cursor: pointer;
    display: inline-block;
    font-weight: normal;
    font-family: 'Lato', Arial, sans-serif;
    margin: 0;
    padding: 4px 20px;
    min-width: 130px;
    max-width: 320px;
    text-align: center;
    filter: grayscale(1);
    -webkit-filter: grayscale(1);
    opacity: 0.7;
}

.multi-language-selector .language-option.selected {
    background-color: #f7f7f8;
    color: #02303a;
    filter: none;
    -webkit-filter: none;
    opacity: 1;
}

.multi-language-text.hidden,
.multi-language-selector ~ .multi-language-sample.hidden {
    display: none;
}

.multi-language-sample {
    border-radius: 0 0 4px 4px;
}

/*
 * Ensure that blocks of code do not wrap by applying the behavior of `[listing%nowrap]` by default.
 *
 * These styles are copied from a CSS ruleset in asciidoctor.css that has the same group of
 * selectors except that they end with `.nowrap`.
 */
.literalblock pre,
.literalblock pre[class],
.listingblock pre,
.listingblock pre[class] {
    overflow-x: auto;
    white-space: pre;
    word-wrap: normal;
}

/*
 * This CSS ruleset solves: https://github.com/gradle/guides/issues/113#issuecomment-314826749.
 */
.literalblock pre::after,
.literalblock pre[class]::after,
.listingblock pre::after,
.listingblock pre[class]::after {
    content: "";
}

.quoteblock blockquote,
.quoteblock blockquote p {
    text-align: left;
    text-align: start;
}

div.screenshot {
    box-shadow: 0 0 20px 1px rgba(0,0,0,0.2);
    margin-left: auto;
    margin-right: auto;
    width: 90%;
}

.inset {
    box-shadow: 0 0 1px 1px rgba(0,0,0,0.1);
    padding: 1em;
}

.image.inline-icon img {
    vertical-align: sub;
}

/* TOC */
#header > h1:first-child + #toc {
    background: none;
    border: 0 none;
    margin-top: 0;
}

#header #toctitle {
    margin-bottom: 0.625rem;
}

#toc,
#content #toc {
    border: 0 none;
}

#toc > ul {
    margin-left: 0;
    font-family: inherit;
}

#toc > ul > li {
    line-height: 1.0;
    margin-top: 0;
    padding-bottom: 0.425rem;
}
#toc > ul > li:last-of-type {
    padding-bottom: 0;
}

#toc a {
    font-style: normal;
}

#toc a:hover,
#toc a:focus,
#toc a:hover code,
#toc a:focus code {
    color: #1DA2BD;
}

#toc a:active {
    text-decoration: none;
}

@media screen and (min-width: 75rem) and (min-height: 48rem) {
    #header #toc {
        font-size: 1rem;
        background: #f7f7f8;
        border-radius: 0;
        margin-bottom: 0;
        padding: 15px 0 0;
    }

    #header #toctitle {
        font-size: 1rem;
        font-weight: 700;
        margin: 0.4rem 0 0.625rem 0;
    }

    #toc a {
        color: #02303A;
    }

    #toc a.active {
        color: #1BA8C4;
    }
}

/* Site header specific styles */
.hamburger {
    background-color: transparent;
    background-image: none;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin-left: auto;
    padding: 11px 10px;
}

.hamburger:focus {
    outline: 0;
}

.hamburger__bar {
    display: block;
    width: 22px;
    height: 2px;
    background-color: black;
    border-radius: 1px;
}

.hamburger__bar + .hamburger__bar {
    margin-top: 4px;
}

.site-header {
    background-color: white;
}

/* Override javadoc styles */
.site-header div {
    font-family: 'Lato', Arial, sans-serif;
}
.site-header__navigation-header a {
    align-self: center;
    border-bottom: 0 none;
    height: 36px;
}

.site-header .site-header-version {
    align-self: center;
    color: #1da2bd;
    font-size: 20px;
    padding-left: 1px;
}

.site-header__navigation {
    display: flex;
    flex-direction: column;
}

.site-header__navigation-header {
    display: flex;
    flex: 0 0 auto;
    margin-left: 12px;
}

.site-header__navigation-collapsible {
    flex: 1 1 auto;
    height: 210px;
    overflow: visible;
    transition: height 0.3s ease;
}

.site-header__navigation-items {
    display: flex;
    flex-direction: column;
    flex-wrap: wrap;
    align-items: flex-start;
    max-height: 170px;
    margin: 0 20px;
    padding-top: 12px;
    padding-left: 0;
    list-style-type: none;
}

.site-header__navigation-item {
    flex: 0 1 auto;
    font-size: 16px;
    width: 250px;
}

.site-header__navigation-item .site-header__navigation-link {
    position: relative;
    display: inline-block;
    cursor: pointer;
    width: 100%;
    padding: 5px;
    line-height: 20px;
    border: 0 none;
    color: #02303A;
    text-decoration: none;
    transition: none;
    -o-transition: none;
    -moz-transition: none;
    -webkit-transition: none;
}

.site-header__navigation-item .site-header__navigation-link:hover {
    color: #1DA2BD;
}

.site-header__navigation-item .site-header__navigation-link.active {
    font-weight: 500;
}

/* Navigation submenu styles */
.site-header__navigation-submenu-section {
    position: relative;
}

.site-header__navigation-submenu-section .site-header__down-arrow {
    width: 8px;
    height: 8px;
    margin-left: 2px;
    margin-top: 0;
}

.site-header__navigation-submenu-section .site-header__navigation-link:hover {
    color: #02303A;
}

.site-header__navigation-submenu-section .site-header__navigation-link:hover path {
    fill: none;
}

.site-header__navigation-submenu-section .site-header__navigation-submenu .site-header__navigation-submenu-item-link:hover {
    color: #1DA2BD;
}

.site-header__navigation-submenu-section .site-header__navigation-submenu {
    display: none;
    width: 170px;
    background-color: white;
    top: 40px;
    left: 21px; /* NOTE: This must match the padding of .site-header__navigation-link */
    padding: 3px 10px 6px 10px;
    z-index: 100;
}

.site-header__navigation-submenu-section .site-header__navigation-submenu .site-header__navigation-submenu-item-link {
    width: 100%;
    color: #02303A;
    white-space: nowrap;
    display: inline-block;
    padding-top: 3px;
    border: 0 none;
    transition: none;
    -o-transition: none;
    -moz-transition: none;
    -webkit-transition: none;
}

.site-header__navigation-submenu-section .site-header__navigation-submenu .site-header__navigation-submenu-item-link .site-header__navigation-submenu-item-link-text {
    display: inline-block;
    font-size: 16px;
}

.site-header__navigation-submenu-section.open .site-header__navigation-submenu {
    display: block;
}

/* Top navigation mobile styles */
@media (max-width: 1023px) {
    .site-header__navigation-collapsible--collapse {
        height: 0;
        overflow-y: hidden;
    }

    .site-header__navigation-submenu-section .site-header__navigation-submenu {
        display: block;
        top: 30px !important;
        left: 0 !important;
    }

    .site-header__navigation-item,
    .site-header__navigation-submenu-section .site-header__navigation-submenu .site-header__navigation-submenu-item-link .site-header__navigation-submenu-item-link-text {
        font-size: 18px;
    }

    .site-header-version {
        display: none;
    }

    .site-footer__navigation {
        flex-direction: column;
    }

    .site-footer__links {
        flex-wrap: wrap;
    }

    .site-footer__link-group {
        margin-bottom: 1rem;
    }
}

/* Top navigation desktop styles */
@media (min-width: 1024px) {
    .site-header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        -webkit-box-shadow: 0 2px 4px 0 rgba(0,0,0,.15);
        -moz-box-shadow: 0 2px 4px 0 rgba(0,0,0,.15);
        box-shadow: 0 2px 4px 0 rgba(0,0,0,.15);
        z-index: 1;
    }

    /*
      Pushes the section headings to just below the top nav bar when a user
      navigates directly to section anchors.
     */
    #content h2[id], #content h3[id], #content h4[id] {
        padding-top: 60px;
    }
    #content h2[id] {
        /* Little extra room above h2s */
        margin-top: -44px;
    }
    #content h3[id], #content h4[id] {
        margin-top: -60px;
    }

    .site-header__navigation {
        flex-direction: row;
    }

    .site-header__navigation-button {
        display: none;
    }

    .site-header__navigation-items {
        flex-direction: row;
        align-items: center;
        float: right;
        width: auto;
        padding-top: 0;
    }

    .site-header__navigation-item {
        width: auto;
    }

    .site-header__navigation-item .site-header__navigation-link {
        padding: 15px 18px;
    }

    .site-header__navigation-item:last-of-type .site-header__navigation-link {
        padding-right: 0;
    }

    .site-header__navigation-link--button {
        padding: 6px 12px;
    }

    .site-header__navigation-collapsible {
        height: auto;
    }

    .site-header__navigation-submenu-section .site-header__navigation-submenu {
        position: absolute;
        border: 1px solid #9a9a9a;
        border-radius: 3px;
    }

    .site-header__navigation-submenu-section:hover .site-header__navigation-submenu {
        display: block;
    }

    /*
      Pushes the section headings to just below the top nav bar when a user
      navigates directly to section anchors. It doesn't work if you try
      to apply the padding and margin to the `h` elements directly.
     */
    .chapter a[name],
    .chapter .anchor {
        padding-top: 60px;
        margin-top: -60px;
        text-decoration: none;
        border: none;
        display: inline-block;
    }
}

/* Side Navigation styles */
/* Docs Navigation */
.docs-navigation {
    display: none;
    overflow: hidden;
    padding-left: 5px;
    position: relative;
}

.docs-navigation a {
    color: #02303A;
    display: block;
    font-size: 1rem;
    line-height: 1.0;
}

.docs-navigation a code {
    color: #02303A;
    overflow-wrap: break-word;
    padding: 0;
    word-break: break-all;
}

.docs-navigation a.active {
    color: #1BA8C4;
}

.docs-navigation ul {
    list-style-type: none;
    margin: 0.625em 0;
    padding: 0;
}
.docs-navigation ul:last-of-type {
    margin-bottom: 0;
}

.docs-navigation li {
    margin-bottom: 0.625em;
}
.docs-navigation li:last-of-type {
    margin-bottom: 0;
}

.docs-navigation .nav-dropdown {
    background: transparent url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAiIGhlaWdodD0iNiIgdmlld0JveD0iMCAwIDE5IDExIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIHRyYW5zZm9ybT0icm90YXRlKC0xODAgOS4zNzQgNS40OTQpIiBkPSJNMTcuOTk5MSAxMC40MjI4MjVMOS4zNzQxIDAuNTY1NTc1IDAuNzQ5MSAxMC40MjI4MjUiIHN0cm9rZT0iIzAyMzAzQSIgb3BhY2l0eT0iMC43IiBzdHJva2Utd2lkdGg9IjEuNSIgZmlsbD0ibm9uZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+PC9zdmc+') no-repeat center right;
}

.docs-navigation > ul ul,
.docs-navigation > ul ul ul {
    display: none;
    height: 0;
    margin-left: 1rem;
}

.docs-navigation > ul ul:target,
.docs-navigation > ul ul:target ul,
.docs-navigation > ul .nav-dropdown.expanded ~ ul {
    display: block;
    height: auto;
}

.docs-navigation h3 {
    font-size: 1rem;
    font-weight: 700;
    line-height: 1.5;
    margin: 1.5em 0 0;
}

.docs-navigation .pdf-link-container {
    display: inline-block;
    position: absolute;
    top: 0.75em;
    right: 0;
}

.docs-navigation .pdf-link-container a {
    color: #999;
    font-size: 12px;
}

.docs-navigation .pdf-link-container svg {
    fill: #999;
    height: 12px;
    vertical-align: bottom;
}

@media screen and (min-width: 45rem) {
    .main-content {
        display: flex;
        justify-content: center;
    }
}

/* User guide navigation appears for desktops */
@media screen and (min-width: 64rem) {
    .main-content {
        padding-top: 75px;
    }

    .docs-navigation {
        display: block;
        flex: 0 0 auto;
        width: 13.75rem;
    }

    .main-content > .appendix,
    .main-content > .book,
    .main-content > .chapter {
        flex: 0 0 45rem;
        margin: 0 20px;
    }
}

/* Fixed intra-chapter navigation for desktops */
@media screen and (min-width: 75rem) and (min-height: 48rem) {
    .appendix #header #toc,
    .book #header #toc,
    .chapter #header #toc {
        position: fixed;
        left: calc(50% + 380px);
        top: 50px;
        width: 13.75rem;
        padding-top: 15px;
        font-size: 1rem;
        background-color: #F7F7F8;
    }

    .appendix #toc a,
    .book #toc a,
    .chapter #toc a {
        color: #02303A;
        display: inline-block;
        margin-bottom: 0.2rem;
    }

    .appendix #toc a.active,
    .book #toc a.active,
    .chapter #toc a.active {
        color: #1BA8C4;
    }

    .docs-navigation {
        flex-basis: 13.75rem;
    }

    /* Sneaky way to make room for TOC */
    .secondary-navigation {
        flex: 0 0 13.75rem;
    }
}

@media screen and (min-width: 84.375rem) and (min-height: 48rem) {
    .appendix #header #toc,
    .book #header #toc,
    .chapter #header #toc {
        left: calc(50% + 26.25rem);
    }
}

@media screen and (min-width: 93.75rem) and (min-height: 48rem) {
    .appendix #header #toc,
    .book #header #toc,
    .chapter #header #toc {
        left: calc(50% + 31.25rem);
    }
}

/* Userguide Meta */
.chapter-meta {
    float: right;
    text-align: right;
}

.chapter-meta .edit-link {
    color: #999;
    font-size: 0.9em;
    padding-right: 3px;
}

.chapter-meta .edit-link svg {
    margin-right: 1px;
}

/* Clever use of RTL to fill in all stars to left of hover position */
.rating {
    direction: rtl;
}
.rating > .star {
    cursor: pointer;
    display: table-cell;
    padding: 3px;
}
.rating > .star:hover > svg > g,
.rating > .star:hover ~ .star > svg > g,
.rating > .star.selected > svg > g,
.rating > .star.selected ~ .star > svg > g {
    fill: #999;
}

/* Footer styles */
.site-footer {
}

.site-footer__navigation {
    display: flex;
    max-width: 75rem;
    margin: 3rem auto 2.5rem auto;
    padding: 0.5rem 0.75rem;
}

.site-footer__links {
    display: flex;
    flex: 1 1 auto;
}

.site-footer__links .site-footer__links-list {
    list-style-type: none;
    margin: 0;
}

.site-footer__links .site-footer__links-list a {
    color: #666;
}

.site-footer__link-group {
    flex: 1 1 auto;
    flex-basis: 175px;
}

.site-footer__link-group header {
    color: #555;
}

.site-footer__subscribe-newsletter {
    flex: 0 0 350px;
}

.site-footer__subscribe-newsletter p {
    font-size: 0.875rem;
    margin: 2px 0 0 2px;
    opacity: 0.7;
}

.site-footer__subscribe-newsletter .disclaimer {
    font-size: 0.75rem;
    opacity: 0.55;
}

.site-footer__subscribe-newsletter .newsletter-form {
    padding-top: 6px;
    display: flex;
    justify-content: flex-start;
}

.site-footer__subscribe-newsletter .email,
.site-footer__subscribe-newsletter .submit {
    height: 40px;
}

.site-footer__subscribe-newsletter .email {
    line-height: 40px;
    width: 250px;
    color: #1DA2BD;
    font-size: 16px;
    padding-left: 20px;
    border-top-left-radius: 4px;
    border-bottom-left-radius: 4px;
    border-style: none;
}

.site-footer__subscribe-newsletter .submit {
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
    width: 100px;
    background-color: #1BA8CB;
    color: white;
    font-weight: 500;
    border-top-right-radius: 4px;
    border-bottom-right-radius: 4px;
    border-style: none;
    cursor: pointer;
    transition: all .3s ease;
}

/* Secondary footer (below) */
.site-footer-secondary {
    background-color: white;
}

.site-footer-secondary__contents {
    display: flex;
    align-items: center;
    justify-content: space-between;
    max-width: 75rem;
    margin-left: auto;
    margin-right: auto;
    font-size: 0.875rem;
    padding: 0.5rem 0.75rem;
}

/*
 * 1. Value is the largest computed width among 'site-footer__copy' and 'site-footer__links'.
 */
.site-footer__copy,
.site-footer__secondary-links {
    flex-grow: 0;
    flex-basis: 280px;
    /* 1. */
}

/*
 * 1. 'flex-shrink: 1' is applied to the element with the smallest computed width among
 *    'site-footer__copy' and 'site-footer__links'.
 */
.site-footer__copy {
    flex-shrink: 1;
    /* 1. */
}

.site-footer__logo {
    flex: 0 0 auto;
    margin-right: 10px;
    margin-left: 10px;
}

.site-footer__logo svg {
    width: 35px;
    height: 35px;
}

/*
 * 1. 'flex-shrink: 0' is applied to the element with the largest computed width among
 *    'site-footer__copy' and 'site-footer__links'.
 */
.site-footer__secondary-links {
    flex-shrink: 0;
    /* 1 */
    text-align: right;
    white-space: nowrap;
}

.site-footer-secondary a {
    color: #999;
}

.site-footer-secondary__links a:not(:last-child) {
    padding-right: 10px;
}

.site-footer-secondary__links a:not(:first-child) {
    padding-left: 10px;
}

@media all and (max-width: 29.99rem) {
    .site-footer__rights,
    .site-footer-secondary__links {
        display: none;
    }

    .site-footer__logo {
        order: 1;
        text-align: left;
    }

    .site-footer__copy {
        order: 2;
        text-align: right;
    }
}

/* Avoid the footer taking up much of the screen on short displays */
@media all and (max-height: 56.25rem) {
    .site-footer__navigation {
        margin: 1.5rem auto 1.5rem auto;
        padding-top: 0;
        padding-bottom: 0;
    }
}

@media screen and (min-width: 84.375rem) {
    .ui-logos .ui-logo {
        box-shadow: 0 6px 15px 1px rgba(0, 0, 0, 0.56);
    }

    .main-content > .appendix,
    .main-content > .book,
    .main-content > .chapter {
        flex-basis: 50rem;
        max-width: 50rem;
    }
}

@media screen and (min-width: 93.75rem) {
    .main-content > .appendix,
    .main-content > .book,
    .main-content > .chapter {
        flex-basis: 60rem;
        max-width: 60rem;
    }
}

/* User Manual Home */
.technology-logos,
.ui-logos {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: space-around;
}

.technology-logo,
.ui-logo {
    flex: 0 1 auto;
}

.ui-logo {
    width: 224px;
    height: 135px;
    margin: 12px;
}

</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<meta name="robots" content="noindex">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@gradle">
<meta name="twitter:creator" content="@gradle">
<meta name="twitter:title" content="Gradle User Manual: Version {gradleVersion}">
<meta name="twitter:description" content="Single-page Gradle User Manual for Gradle 4.10.3">
<meta name="twitter:url" content="https://docs.gradle.org/4.10.3/userguide/userguide_single.html">
<meta name="twitter:image" content="https://gradle.org/images/gradle-256x256.png">

<link crossorigin href="//assets.gradle.com" rel="preconnect">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" rel="stylesheet"/>
<script type="text/javascript">
    // Polyfill Element.matches()
    if (!Element.prototype.matches) {
        Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
    }
    // Polyfill Element.closest()
    if (!Element.prototype.closest) {
        Element.prototype.closest = function (s) {
            var el = this;
            if (!document.documentElement.contains(el)) return null;
            do {
                if (typeof el.matches === "function" && el.matches(s)) return el;
                el = el.parentElement || el.parentNode;
            } while (el !== null);
            return null;
        };
    }

    [].forEach.call(document.querySelectorAll(".docs-navigation a[href$='"+ window.location.pathname +"']"), function(link) {
        // Add "active" to all links same as current URL
        link.classList.add("active");

        // Expand all parent navigation
        var parentListEl = link.closest("li");
        while (parentListEl !== null) {
            var dropDownEl = parentListEl.querySelector(".nav-dropdown");
            if (dropDownEl !== null) {
                dropDownEl.classList.add("expanded");
            }
            parentListEl = parentListEl.parentNode.closest("li");
        }
    });

    // Expand/contract multi-level side navigation
    [].forEach.call(document.querySelectorAll(".docs-navigation .nav-dropdown"), function registerSideNavActions(collapsibleElement) {
        collapsibleElement.addEventListener("click", function toggleExpandedSideNav(evt) {
            evt.preventDefault();
            evt.target.classList.toggle("expanded");
            evt.target.setAttribute("aria-expanded", evt.target.classList.contains("expanded").toString());
            return false;
        }, false);
    });
</script>

</head>
<body class="book">
<header class="site-layout__header site-header" itemscope="itemscope" itemtype="https://schema.org/WPHeader">
    <nav class="site-header__navigation" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement">
        <div class="site-header__navigation-header">
            <a target="_top" class="logo" href="https://docs.gradle.org" title="Gradle Docs">
                <svg width="160px" height="36px" viewBox="0 0 191 43" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <g>
                            <path d="M46.678556,7.70171633 C45.120512,4.8834998 42.335823,4.04123121 40.3684979,4.00130115 C37.9547479,3.9523229 35.9723457,5.29706115 36.3472787,6.1798499 C36.427757,6.36937016 36.8802727,7.35867186 37.1580527,7.76702066 C37.5601446,8.35790689 38.2799562,7.90392373 38.5320749,7.76908601 C39.2849364,7.36653985 40.0895198,7.23622623 41.0021397,7.34323092 C41.8745205,7.44551482 43.033468,7.9864393 43.8109923,9.4893242 C45.6407254,13.0263802 39.9923667,20.3060435 32.9221581,15.2649224 C25.8518496,10.2238013 18.9763466,11.8941761 15.8634538,12.9102289 C12.7506609,13.9260851 11.3198246,14.9477439 12.5498645,17.3104037 C14.2214368,20.5211347 13.6673747,19.5359637 15.2882237,22.1937715 C17.8627305,26.4150478 23.4981089,20.2511642 23.4981089,20.2511642 C19.3000571,26.4766148 15.7013989,24.9724514 14.3210861,22.7961647 C13.0771672,20.8346742 12.1106287,18.5733148 12.1106287,18.5733148 C1.47790725,22.3458205 4.35465711,39 4.35465711,39 L9.63497235,39 C10.9812366,32.8678834 15.794558,33.0939899 16.6195105,39 L20.6486178,39 C24.2119295,27.0258991 33.2432725,39 33.2432725,39 L38.4954303,39 C37.0244547,30.8318437 41.4498627,28.2655996 44.2387454,23.4777295 C47.0279277,18.6894661 49.6699325,12.8318441 46.678556,7.70171633 L46.678556,7.70171633 Z M33.1312419,23.4719269 C30.3544409,22.5602233 31.347639,19.7803632 31.347639,19.7803632 C31.347639,19.7803632 33.772672,20.5692278 37.0530115,21.6459626 C36.864197,22.5081962 35.2324645,24.1619498 33.1312419,23.4719269 L33.1312419,23.4719269 Z" id="Fill-9" fill="#02303A"></path>
                            <path d="M35.9919757,21.336932 C36.0769161,22.1603228 35.477836,22.9008903 34.6537814,22.990975 C33.8297268,23.0810597 33.0929635,22.486564 33.0080231,21.663068 C32.9230827,20.8396772 33.5222651,20.0991097 34.3462175,20.009025 C35.1702721,19.9189403 35.9071376,20.513436 35.9919757,21.336932" id="Fill-10" fill="#00303A"></path>
                            <path d="M72.236,22.3 L72.236,29.32 C71.3559956,29.9680032 70.418005,30.4419985 69.422,30.742 C68.425995,31.0420015 67.3600057,31.192 66.224,31.192 C64.8079929,31.192 63.5260057,30.9720022 62.378,30.532 C61.2299943,30.0919978 60.2500041,29.4800039 59.438,28.696 C58.6259959,27.9119961 58.0000022,26.9760054 57.56,25.888 C57.1199978,24.7999946 56.9,23.6120064 56.9,22.324 C56.9,21.0199935 57.1119979,19.8240054 57.536,18.736 C57.9600021,17.6479946 58.5619961,16.7120039 59.342,15.928 C60.1220039,15.1439961 61.0679944,14.5360022 62.18,14.104 C63.2920056,13.6719978 64.5399931,13.456 65.924,13.456 C66.6280035,13.456 67.2859969,13.5119994 67.898,13.624 C68.5100031,13.7360006 69.0779974,13.889999 69.602,14.086 C70.1260026,14.282001 70.6039978,14.5199986 71.036,14.8 C71.4680022,15.0800014 71.8639982,15.3879983 72.224,15.724 L71.3,17.188 C71.1559993,17.4200012 70.9680012,17.5619997 70.736,17.614 C70.5039988,17.6660003 70.2520014,17.6080008 69.98,17.44 L69.188,16.984 C68.9239987,16.8319992 68.6300016,16.7000006 68.306,16.588 C67.9819984,16.4759994 67.618002,16.3840004 67.214,16.312 C66.809998,16.2399996 66.3440026,16.204 65.816,16.204 C64.9599957,16.204 64.1860035,16.3479986 63.494,16.636 C62.8019965,16.9240014 62.2120024,17.3359973 61.724,17.872 C61.2359976,18.4080027 60.8600013,19.0519962 60.596,19.804 C60.3319987,20.5560038 60.2,21.3959954 60.2,22.324 C60.2,23.316005 60.3419986,24.2019961 60.626,24.982 C60.9100014,25.7620039 61.3099974,26.4219973 61.826,26.962 C62.3420026,27.5020027 62.9639964,27.9139986 63.692,28.198 C64.4200036,28.4820014 65.2319955,28.624 66.128,28.624 C66.7680032,28.624 67.3399975,28.5560007 67.844,28.42 C68.3480025,28.2839993 68.8399976,28.1000012 69.32,27.868 L69.32,24.724 L67.136,24.724 C66.927999,24.724 66.7660006,24.6660006 66.65,24.55 C66.5339994,24.4339994 66.476,24.2920008 66.476,24.124 L66.476,22.3 L72.236,22.3 Z M77.504,20.824 C77.8880019,20.0879963 78.3439974,19.5100021 78.872,19.09 C79.4000026,18.6699979 80.0239964,18.46 80.744,18.46 C81.3120028,18.46 81.7679983,18.5839988 82.112,18.832 L81.92,21.052 C81.8799998,21.1960007 81.8220004,21.2979997 81.746,21.358 C81.6699996,21.4180003 81.5680006,21.448 81.44,21.448 C81.3199994,21.448 81.1420012,21.4280002 80.906,21.388 C80.6699988,21.3479998 80.4400011,21.328 80.216,21.328 C79.8879984,21.328 79.5960013,21.3759995 79.34,21.472 C79.0839987,21.5680005 78.854001,21.7059991 78.65,21.886 C78.445999,22.0660009 78.2660008,22.2839987 78.11,22.54 C77.9539992,22.7960013 77.8080007,23.0879984 77.672,23.416 L77.672,31 L74.708,31 L74.708,18.688 L76.448,18.688 C76.7520015,18.688 76.9639994,18.7419995 77.084,18.85 C77.2040006,18.9580005 77.2839998,19.1519986 77.324,19.432 L77.504,20.824 Z M90.008,25.744 C89.1519957,25.7840002 88.4320029,25.8579995 87.848,25.966 C87.2639971,26.0740005 86.7960018,26.2119992 86.444,26.38 C86.0919982,26.5480008 85.8400008,26.7439989 85.688,26.968 C85.5359992,27.1920011 85.46,27.4359987 85.46,27.7 C85.46,28.2200026 85.6139985,28.5919989 85.922,28.816 C86.2300015,29.0400011 86.6319975,29.152 87.128,29.152 C87.736003,29.152 88.2619978,29.0420011 88.706,28.822 C89.1500022,28.6019989 89.5839979,28.2680022 90.008,27.82 L90.008,25.744 Z M83.216,20.404 C84.6320071,19.1079935 86.33599,18.46 88.328,18.46 C89.0480036,18.46 89.6919972,18.5779988 90.26,18.814 C90.8280028,19.0500012 91.307998,19.3779979 91.7,19.798 C92.092002,20.2180021 92.389999,20.7199971 92.594,21.304 C92.798001,21.8880029 92.9,22.5279965 92.9,23.224 L92.9,31 L91.556,31 C91.2759986,31 91.0600008,30.9580004 90.908,30.874 C90.7559992,30.7899996 90.6360004,30.6200013 90.548,30.364 L90.284,29.476 C89.9719984,29.7560014 89.6680015,30.0019989 89.372,30.214 C89.0759985,30.4260011 88.7680016,30.6039993 88.448,30.748 C88.1279984,30.8920007 87.7860018,31.0019996 87.422,31.078 C87.0579982,31.1540004 86.6560022,31.192 86.216,31.192 C85.6959974,31.192 85.2160022,31.1220007 84.776,30.982 C84.3359978,30.8419993 83.9560016,30.6320014 83.636,30.352 C83.3159984,30.0719986 83.0680009,29.7240021 82.892,29.308 C82.7159991,28.8919979 82.628,28.4080028 82.628,27.856 C82.628,27.5439984 82.6799995,27.2340015 82.784,26.926 C82.8880005,26.6179985 83.0579988,26.3240014 83.294,26.044 C83.5300012,25.7639986 83.8359981,25.5000012 84.212,25.252 C84.5880019,25.0039988 85.0499973,24.7880009 85.598,24.604 C86.1460027,24.4199991 86.7839964,24.2700006 87.512,24.154 C88.2400036,24.0379994 89.0719953,23.9680001 90.008,23.944 L90.008,23.224 C90.008,22.3999959 89.8320018,21.790002 89.48,21.394 C89.1279982,20.997998 88.6200033,20.8 87.956,20.8 C87.4759976,20.8 87.0780016,20.8559994 86.762,20.968 C86.4459984,21.0800006 86.1680012,21.2059993 85.928,21.346 C85.6879988,21.4860007 85.470001,21.6119994 85.274,21.724 C85.077999,21.8360006 84.8600012,21.892 84.62,21.892 C84.411999,21.892 84.2360007,21.8380005 84.092,21.73 C83.9479993,21.6219995 83.8320004,21.4960007 83.744,21.352 L83.216,20.404 Z M103.412,21.832 C103.075998,21.423998 102.710002,21.1360008 102.314,20.968 C101.917998,20.7999992 101.492002,20.716 101.036,20.716 C100.587998,20.716 100.184002,20.7999992 99.824,20.968 C99.4639982,21.1360008 99.1560013,21.3899983 98.9,21.73 C98.6439987,22.0700017 98.4480007,22.5019974 98.312,23.026 C98.1759993,23.5500026 98.108,24.1679964 98.108,24.88 C98.108,25.6000036 98.1659994,26.2099975 98.282,26.71 C98.3980006,27.2100025 98.5639989,27.6179984 98.78,27.934 C98.9960011,28.2500016 99.2599984,28.4779993 99.572,28.618 C99.8840016,28.7580007 100.231998,28.828 100.616,28.828 C101.232003,28.828 101.755998,28.7000013 102.188,28.444 C102.620002,28.1879987 103.027998,27.8240024 103.412,27.352 L103.412,21.832 Z M106.376,13.168 L106.376,31 L104.564,31 C104.171998,31 103.924001,30.8200018 103.82,30.46 L103.568,29.272 C103.071998,29.8400028 102.502003,30.2999982 101.858,30.652 C101.213997,31.0040018 100.464004,31.18 99.608,31.18 C98.9359966,31.18 98.3200028,31.0400014 97.76,30.76 C97.1999972,30.4799986 96.718002,30.0740027 96.314,29.542 C95.909998,29.0099973 95.5980011,28.3520039 95.378,27.568 C95.1579989,26.7839961 95.048,25.888005 95.048,24.88 C95.048,23.9679954 95.1719988,23.1200039 95.42,22.336 C95.6680012,21.5519961 96.0239977,20.8720029 96.488,20.296 C96.9520023,19.7199971 97.5079968,19.2700016 98.156,18.946 C98.8040032,18.6219984 99.531996,18.46 100.34,18.46 C101.028003,18.46 101.615998,18.5679989 102.104,18.784 C102.592002,19.0000011 103.027998,19.2919982 103.412,19.66 L103.412,13.168 L106.376,13.168 Z M112.304,13.168 L112.304,31 L109.34,31 L109.34,13.168 L112.304,13.168 Z M123.2,23.428 C123.2,23.0439981 123.146001,22.6820017 123.038,22.342 C122.929999,22.0019983 122.768001,21.7040013 122.552,21.448 C122.335999,21.1919987 122.062002,20.9900007 121.73,20.842 C121.397998,20.6939993 121.012002,20.62 120.572,20.62 C119.715996,20.62 119.042002,20.8639976 118.55,21.352 C118.057998,21.8400024 117.744001,22.5319955 117.608,23.428 L123.2,23.428 Z M117.548,25.216 C117.596,25.8480032 117.707999,26.3939977 117.884,26.854 C118.060001,27.3140023 118.291999,27.6939985 118.58,27.994 C118.868001,28.2940015 119.209998,28.5179993 119.606,28.666 C120.002002,28.8140007 120.439998,28.888 120.92,28.888 C121.400002,28.888 121.813998,28.8320006 122.162,28.72 C122.510002,28.6079994 122.813999,28.4840007 123.074,28.348 C123.334001,28.2119993 123.561999,28.0880006 123.758,27.976 C123.954001,27.8639994 124.143999,27.808 124.328,27.808 C124.576001,27.808 124.759999,27.8999991 124.88,28.084 L125.732,29.164 C125.403998,29.5480019 125.036002,29.8699987 124.628,30.13 C124.219998,30.3900013 123.794002,30.5979992 123.35,30.754 C122.905998,30.9100008 122.454002,31.0199997 121.994,31.084 C121.533998,31.1480003 121.088002,31.18 120.656,31.18 C119.799996,31.18 119.004004,31.0380014 118.268,30.754 C117.531996,30.4699986 116.892003,30.0500028 116.348,29.494 C115.803997,28.9379972 115.376002,28.2500041 115.064,27.43 C114.751998,26.6099959 114.596,25.6600054 114.596,24.58 C114.596,23.7399958 114.731999,22.9500037 115.004,22.21 C115.276001,21.4699963 115.665997,20.8260027 116.174,20.278 C116.682003,19.7299973 117.301996,19.2960016 118.034,18.976 C118.766004,18.6559984 119.591995,18.496 120.512,18.496 C121.288004,18.496 122.003997,18.6199988 122.66,18.868 C123.316003,19.1160012 123.879998,19.4779976 124.352,19.954 C124.824002,20.4300024 125.193999,21.0139965 125.462,21.706 C125.730001,22.3980035 125.864,23.1879956 125.864,24.076 C125.864,24.5240022 125.816,24.8259992 125.72,24.982 C125.624,25.1380008 125.440001,25.216 125.168,25.216 L117.548,25.216 Z M149.576,22.504 C149.576,23.8160066 149.380002,24.9959948 148.988,26.044 C148.595998,27.0920052 148.044004,27.9839963 147.332,28.72 C146.619996,29.4560037 145.766005,30.019998 144.77,30.412 C143.773995,30.804002 142.676006,31 141.476,31 L135.272,31 L135.272,14.02 L141.476,14.02 C142.676006,14.02 143.773995,14.215998 144.77,14.608 C145.766005,15.000002 146.619996,15.5639963 147.332,16.3 C148.044004,17.0360037 148.595998,17.9279948 148.988,18.976 C149.380002,20.0240052 149.576,21.1999935 149.576,22.504 Z M148.304,22.504 C148.304,21.3199941 148.140002,20.2640046 147.812,19.336 C147.483998,18.4079954 147.020003,17.6240032 146.42,16.984 C145.819997,16.3439968 145.100004,15.8560017 144.26,15.52 C143.419996,15.1839983 142.492005,15.016 141.476,15.016 L136.508,15.016 L136.508,30.004 L141.476,30.004 C142.492005,30.004 143.419996,29.8360017 144.26,29.5 C145.100004,29.1639983 145.819997,28.6760032 146.42,28.036 C147.020003,27.3959968 147.483998,26.6120046 147.812,25.684 C148.140002,24.7559954 148.304,23.696006 148.304,22.504 Z M157.52,18.868 C158.376004,18.868 159.141997,19.0139985 159.818,19.306 C160.494003,19.5980015 161.063998,20.0119973 161.528,20.548 C161.992002,21.0840027 162.345999,21.7299962 162.59,22.486 C162.834001,23.2420038 162.956,24.0879953 162.956,25.024 C162.956,25.9600047 162.834001,26.8039962 162.59,27.556 C162.345999,28.3080038 161.992002,28.9519973 161.528,29.488 C161.063998,30.0240027 160.494003,30.4359986 159.818,30.724 C159.141997,31.0120014 158.376004,31.156 157.52,31.156 C156.663996,31.156 155.898003,31.0120014 155.222,30.724 C154.545997,30.4359986 153.974002,30.0240027 153.506,29.488 C153.037998,28.9519973 152.682001,28.3080038 152.438,27.556 C152.193999,26.8039962 152.072,25.9600047 152.072,25.024 C152.072,24.0879953 152.193999,23.2420038 152.438,22.486 C152.682001,21.7299962 153.037998,21.0840027 153.506,20.548 C153.974002,20.0119973 154.545997,19.5980015 155.222,19.306 C155.898003,19.0139985 156.663996,18.868 157.52,18.868 Z M157.52,30.256 C158.232004,30.256 158.853997,30.1340012 159.386,29.89 C159.918003,29.6459988 160.361998,29.2960023 160.718,28.84 C161.074002,28.3839977 161.339999,27.8340032 161.516,27.19 C161.692001,26.5459968 161.78,25.824004 161.78,25.024 C161.78,24.231996 161.692001,23.5120032 161.516,22.864 C161.339999,22.2159968 161.074002,21.6620023 160.718,21.202 C160.361998,20.7419977 159.918003,20.3880012 159.386,20.14 C158.853997,19.8919988 158.232004,19.768 157.52,19.768 C156.807996,19.768 156.186003,19.8919988 155.654,20.14 C155.121997,20.3880012 154.678002,20.7419977 154.322,21.202 C153.965998,21.6620023 153.698001,22.2159968 153.518,22.864 C153.337999,23.5120032 153.248,24.231996 153.248,25.024 C153.248,25.824004 153.337999,26.5459968 153.518,27.19 C153.698001,27.8340032 153.965998,28.3839977 154.322,28.84 C154.678002,29.2960023 155.121997,29.6459988 155.654,29.89 C156.186003,30.1340012 156.807996,30.256 157.52,30.256 Z M174.212,20.656 C174.172,20.6960002 174.134,20.7299999 174.098,20.758 C174.062,20.7860001 174.012,20.8 173.948,20.8 C173.868,20.8 173.760001,20.7460005 173.624,20.638 C173.487999,20.5299995 173.304001,20.4120006 173.072,20.284 C172.839999,20.1559994 172.550002,20.0380005 172.202,19.93 C171.853998,19.8219995 171.432002,19.768 170.936,19.768 C170.247997,19.768 169.638003,19.8899988 169.106,20.134 C168.573997,20.3780012 168.124002,20.7279977 167.756,21.184 C167.387998,21.6400023 167.110001,22.1919968 166.922,22.84 C166.733999,23.4880032 166.64,24.215996 166.64,25.024 C166.64,25.8640042 166.737999,26.6079968 166.934,27.256 C167.130001,27.9040032 167.407998,28.4499978 167.768,28.894 C168.128002,29.3380022 168.563997,29.6759988 169.076,29.908 C169.588003,30.1400012 170.155997,30.256 170.78,30.256 C171.356003,30.256 171.837998,30.1880007 172.226,30.052 C172.614002,29.9159993 172.933999,29.7680008 173.186,29.608 C173.438001,29.4479992 173.635999,29.3000007 173.78,29.164 C173.924001,29.0279993 174.044,28.96 174.14,28.96 C174.236,28.96 174.316,28.9999996 174.38,29.08 L174.68,29.464 C174.495999,29.7040012 174.264001,29.927999 173.984,30.136 C173.703999,30.344001 173.388002,30.5239992 173.036,30.676 C172.683998,30.8280008 172.302002,30.9459996 171.89,31.03 C171.477998,31.1140004 171.048002,31.156 170.6,31.156 C169.839996,31.156 169.146003,31.0180014 168.518,30.742 C167.889997,30.4659986 167.350002,30.0660026 166.898,29.542 C166.445998,29.0179974 166.094001,28.3760038 165.842,27.616 C165.589999,26.8559962 165.464,25.9920048 165.464,25.024 C165.464,24.1119954 165.583999,23.2800038 165.824,22.528 C166.064001,21.7759962 166.415998,21.1280027 166.88,20.584 C167.344002,20.0399973 167.909997,19.6180015 168.578,19.318 C169.246003,19.0179985 170.011996,18.868 170.876,18.868 C171.652004,18.868 172.339997,18.9919988 172.94,19.24 C173.540003,19.4880012 174.063998,19.8239979 174.512,20.248 L174.212,20.656 Z M184.064,20.536 C184,20.6480006 183.908001,20.704 183.788,20.704 C183.7,20.704 183.588001,20.6540005 183.452,20.554 C183.315999,20.4539995 183.134001,20.3420006 182.906,20.218 C182.677999,20.0939994 182.396002,19.9820005 182.06,19.882 C181.723998,19.7819995 181.316002,19.732 180.836,19.732 C180.403998,19.732 180.010002,19.7939994 179.654,19.918 C179.297998,20.0420006 178.994001,20.207999 178.742,20.416 C178.489999,20.624001 178.296001,20.8659986 178.16,21.142 C178.023999,21.4180014 177.956,21.7079985 177.956,22.012 C177.956,22.3880019 178.051999,22.6999988 178.244,22.948 C178.436001,23.1960012 178.685998,23.4079991 178.994,23.584 C179.302002,23.7600009 179.655998,23.9119994 180.056,24.04 C180.456002,24.1680006 180.861998,24.2959994 181.274,24.424 C181.686002,24.5520006 182.091998,24.6939992 182.492,24.85 C182.892002,25.0060008 183.245998,25.1999988 183.554,25.432 C183.862002,25.6640012 184.111999,25.9479983 184.304,26.284 C184.496001,26.6200017 184.592,27.0279976 184.592,27.508 C184.592,28.0280026 184.500001,28.5119978 184.316,28.96 C184.131999,29.4080022 183.862002,29.7959984 183.506,30.124 C183.149998,30.4520016 182.712003,30.711999 182.192,30.904 C181.671997,31.096001 181.076003,31.192 180.404,31.192 C179.563996,31.192 178.840003,31.0580013 178.232,30.79 C177.623997,30.5219987 177.080002,30.1720022 176.6,29.74 L176.864,29.332 C176.904,29.2679997 176.95,29.2200002 177.002,29.188 C177.054,29.1559998 177.124,29.14 177.212,29.14 C177.316001,29.14 177.441999,29.2039994 177.59,29.332 C177.738001,29.4600006 177.935999,29.5979993 178.184,29.746 C178.432001,29.8940007 178.737998,30.0319994 179.102,30.16 C179.466002,30.2880006 179.915997,30.352 180.452,30.352 C180.956003,30.352 181.399998,30.2820007 181.784,30.142 C182.168002,30.0019993 182.487999,29.8120012 182.744,29.572 C183.000001,29.3319988 183.193999,29.0500016 183.326,28.726 C183.458001,28.4019984 183.524,28.0600018 183.524,27.7 C183.524,27.299998 183.428001,26.9680013 183.236,26.704 C183.043999,26.4399987 182.792002,26.2160009 182.48,26.032 C182.167998,25.8479991 181.814002,25.6920006 181.418,25.564 C181.021998,25.4359994 180.616002,25.3080006 180.2,25.18 C179.783998,25.0519994 179.378002,24.9120008 178.982,24.76 C178.585998,24.6079992 178.232002,24.4160012 177.92,24.184 C177.607998,23.9519988 177.356001,23.6700017 177.164,23.338 C176.971999,23.0059983 176.876,22.5920025 176.876,22.096 C176.876,21.6719979 176.967999,21.264002 177.152,20.872 C177.336001,20.479998 177.597998,20.1360015 177.938,19.84 C178.278002,19.5439985 178.691998,19.3080009 179.18,19.132 C179.668002,18.9559991 180.215997,18.868 180.824,18.868 C181.552004,18.868 182.197997,18.971999 182.762,19.18 C183.326003,19.388001 183.839998,19.7079978 184.304,20.14 L184.064,20.536 Z" fill="#02303A"></path>
                        </g>
                    </g>
                </svg></a>
            <div class="site-header-version"></div>
            <button type="button" aria-label="Navigation Menu" class="site-header__navigation-button hamburger">
                <span class="hamburger__bar"></span>
                <span class="hamburger__bar"></span>
                <span class="hamburger__bar"></span>
            </button>
        </div>
        <div class="site-header__navigation-collapsible site-header__navigation-collapsible--collapse">
            <ul class="site-header__navigation-items">
                <li class="site-header__navigation-item site-header__navigation-submenu-section" tabindex="0">
                            <span class="site-header__navigation-link">
                                Docs
                                <svg class="site-header__down-arrow site-header__icon-light" width="19" height="11" viewBox="0 0 19 11" xmlns="http://www.w3.org/2000/svg"><title>Open Docs Menu</title><path transform="rotate(-180 9.374 5.494)" d="M17.9991 10.422825L9.3741 0.565575 0.7491 10.422825" stroke="#02303A" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
                            </span>
                    <div class="site-header__navigation-submenu">
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="/userguide/userguide.html" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">User Manual</span>
                            </a>
                        </div>
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="https://guides.gradle.org" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">Guides and Tutorials</span>
                            </a>
                        </div>
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="/dsl/" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">DSL Reference</span>
                            </a>
                        </div>
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="/javadoc/" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">Javadoc</span>
                            </a>
                        </div>
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="/release-notes.html" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">Release Notes</span>
                            </a>
                        </div>
                    </div>
                </li>
                <li class="site-header__navigation-item" itemprop="name">
                    <a target="_top" class="site-header__navigation-link" href="https://discuss.gradle.org/" itemprop="url">Forums</a>
                </li>
                <li class="site-header__navigation-item" itemprop="name">
                    <a target="_top" class="site-header__navigation-link" href="https://gradle.org/training/" itemprop="url">Training</a>
                </li>
                <li class="site-header__navigation-item" itemprop="name">
                    <a target="_top" class="site-header__navigation-link" href="https://gradle.com/enterprise" itemprop="url">Try Gradle Enterprise</a>
                </li>
            </ul>
        </div>
    </nav>
</header>

<main class="main-content">
    <!-- Primary Navigation -->
    <nav class="docs-navigation">
        <div class="pdf-link-container">
            <a href="/userguide/userguide.pdf">
                <svg width="10px" height="12px" viewBox="0 0 10 12" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M6.01302083,0.857142857 C6.2421875,0.857142857 6.4296875,1.05 6.4296875,1.28571429 L6.4296875,5.14285714 L8.875,5.14285714 C9.05989583,5.14285714 9.15364583,5.37321429 9.0234375,5.50714286 L5.29427083,9.35357143 C5.13020833,9.52232143 4.8671875,9.52232143 4.703125,9.35357143 L0.979166667,5.50714286 C0.848958333,5.37321429 0.940104167,5.14285714 1.12760417,5.14285714 L3.57291667,5.14285714 L3.57291667,1.28571429 C3.57291667,1.05 3.76041667,0.857142857 3.98958333,0.857142857 L6.01302083,0.857142857 Z M6.01302083,0 L3.98958333,0 C3.29947917,0 2.73958333,0.575892857 2.73958333,1.28571429 L2.73958333,4.28571429 L1.12760417,4.28571429 C0.203125,4.28571429 -0.265625,5.4375 0.390625,6.1125 L4.11458333,9.95892857 C4.60416667,10.4625 5.39583333,10.4625 5.88541667,9.95892857 L9.61197917,6.11517857 C10.265625,5.44285714 9.80208333,4.28839286 8.875,4.28839286 L7.26302083,4.28839286 L7.26302083,1.28571429 C7.26302083,0.575892857 6.70052083,0 6.01302083,0 Z M10,11.6785714 L10,11.4642857 C10,11.2875 9.859375,11.1428571 9.6875,11.1428571 L0.3125,11.1428571 C0.140625,11.1428571 0,11.2875 0,11.4642857 L0,11.6785714 C0,11.8553571 0.140625,12 0.3125,12 L9.6875,12 C9.859375,12 10,11.8553571 10,11.6785714 Z"></path></svg>
                PDF
            </a>
        </div>
        <ul>
            <li><a href="/userguide/userguide.html">User Manual Home</a></li>
            <li><a href="/release-notes.html">Release Notes</a></li>
            <li><a href="/userguide/installation.html">Installing Gradle</a></li>
            <li id="tutorials"><a href="https://guides.gradle.org/">Tutorials</a></li>
        </ul>
        <h3 id="reference">Reference</h3>
        <ul>
            <li><a href="/dsl/">Groovy DSL Reference</a></li>
            <li><a href="/javadoc/">Gradle API Javadoc</a></li>
            <li><a href="/userguide/plugin_reference.html">Core Plugins</a></li>
            <li id="third-party-integration"><a href="/userguide/third_party_integration.html">Gradle &amp; Third-party Tools</a></li>
        </ul>

        <h3 id="getting-started">Getting Started</h3>
        <ul>
            <li><a href="https://guides.gradle.org/creating-new-gradle-builds/">Creating New Gradle Builds</a></li>
            <li><a href="https://guides.gradle.org/creating-build-scans/">Creating Build Scans</a></li>
            <li><a href="https://guides.gradle.org/migrating-from-maven/">Migrating From Maven</a></li>
        </ul>

        <h3 id="using-gradle-builds">Running Gradle Builds</h3>
        <ul>
            <li><a href="/userguide/command_line_interface.html">Command-Line Interface</a></li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#customizing-execution" aria-expanded="false" aria-controls="customizing-execution">Customizing Execution</a>
                <ul id="customizing-execution">
                    <li><a href="/userguide/build_environment.html">Configuring the Build Environment</a></li>
                    <li><a href="/userguide/gradle_daemon.html">Configuring the Gradle Daemon</a></li>
                    <li><a href="/userguide/init_scripts.html">Initialization Scripts</a></li>
                </ul>
            </li>
            <li><a href="/userguide/directory_layout.html">Directory Layout</a></li>
            <li><a href="/userguide/intro_multi_project_builds.html">Executing Multi-Project Builds</a></li>
            <li><a href="/userguide/gradle_wrapper.html">Gradle Wrapper</a></li>
            <li><a href="/userguide/troubleshooting.html">Troubleshooting</a></li>
            <li><a href="https://docs.gradle.com/build-scan-plugin">Using Build Scans</a></li>
            <li><a href="/userguide/build_cache.html">Enabling and Configuring the Build Cache</a></li>
            <li><a href="/userguide/composite_builds.html">Integrating Separate Gradle Builds (Composite Builds)</a></li>
        </ul>

        <h3 id="authoring-gradle-builds">Authoring Gradle Builds</h3>
        <ul>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#authoring-build-scripts" aria-expanded="false" aria-controls="authoring-build-scripts">Fundamentals</a>
                <ul id="authoring-build-scripts">
                    <li><a href="/userguide/tutorial_using_tasks.html">Introducing the Basics of Build Scripts</a></li>
                    <li><a href="/userguide/more_about_tasks.html">Working with Tasks</a></li>
                    <li><a href="/userguide/writing_build_scripts.html">Learning More About Build Scripts</a></li>
                    <li><a href="/userguide/working_with_files.html">Working with Files</a></li>
                    <li><a href="/userguide/custom_tasks.html">Creating Custom Task Types</a></li>
                    <li><a href="/userguide/plugins.html">Using Gradle Plugins</a></li>
                    <li><a href="/userguide/standard_plugins.html">The Standard Gradle Plugins</a></li>
                    <li><a href="/userguide/build_lifecycle.html">Understanding the Build Lifecycle</a></li>
                    <li><a href="/userguide/logging.html">Working with Logging</a></li>
                    <li><a href="/userguide/multi_project_builds.html">Configuring Multi-Project Builds</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#best-practices" aria-expanded="false" aria-controls="best-practices">Best Practices</a>
                <ul id="best-practices">
                    <li><a href="/userguide/authoring_maintainable_build_scripts.html">Authoring Maintainable Build Scripts</a></li>
                    <li><a href="/userguide/organizing_gradle_projects.html">Organizing Gradle Projects</a></li>
                    <li><a href="https://guides.gradle.org/performance/">Optimizing Build Performance</a></li>
                    <li><a href="https://guides.gradle.org/using-build-cache/">Using the Build Cache</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#dependency-management" aria-expanded="false" aria-controls="dependency-management">Dependency Management</a>
                <ul id="dependency-management">
                    <li><a href="/userguide/introduction_dependency_management.html">Introduction to Dependency Management</a></li>
                    <li><a href="/userguide/dependency_management_terminology.html">Dependency Management Terminology</a></li>
                    <li><a href="/userguide/dependency_types.html">Dependency Types</a></li>
                    <li><a href="/userguide/repository_types.html">Repository Types</a></li>
                    <li><p></p></li>
                    <li><a href="/userguide/declaring_dependencies.html">Declaring Dependencies</a></li>
                    <li><a href="/userguide/declaring_repositories.html">Declaring Repositories</a></li>
                    <li><a href="/userguide/inspecting_dependencies.html">Inspecting Dependencies</a></li>
                    <li><a href="/userguide/managing_dependency_configurations.html">Managing Dependency Configurations</a></li>
                    <li><a href="/userguide/managing_transitive_dependencies.html">Managing Transitive Dependencies</a></li>
                    <li><a href="/userguide/dependency_locking.html">Dependency Locking</a></li>
                    <li><a href="/userguide/troubleshooting_dependency_resolution.html">Troubleshooting Dependency Resolution</a></li>
                    <li><p></p></li>
                    <li><a href="/userguide/customizing_dependency_resolution_behavior.html">Customizing Dependency Resolution Behavior</a></li>
                    <li><a href="/userguide/dependency_cache.html">Dependency Cache Internals</a></li>
                    <li><a href="/userguide/working_with_dependencies.html">Working with Dependencies</a></li>
                </ul>
            </li>
            <li><p></p></li>
            <li><a href="/userguide/artifact_management.html">Publishing Artifacts</a></li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#cpp-projects" aria-expanded="false" aria-controls="cpp-projects">C++ Projects</a>
                <ul id="cpp-projects">
                    <li><a href="/userguide/native_software.html">Building Native Software</a></li>
                    <li><a href="/userguide/software_model_concepts.html">Software Model Concepts</a></li>
                    <li><a href="/userguide/software_model.html">Rule-based Model Configuration</a></li>
                    <li><a href="/userguide/rule_source.html">Implementing Model Rules in a Plugin</a></li>
                    <li><a href="/userguide/software_model_extend.html">Extending the Software Model</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#java-projects" aria-expanded="false" aria-controls="java-projects">Java Projects</a>
                <ul id="java-projects">
                    <li><a href="/userguide/building_java_projects.html">Building Java &amp; JVM projects</a></li>
                    <li><a href="/userguide/java_testing.html">Testing Java &amp; JVM projects</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#advanced-techniques" aria-expanded="false" aria-controls="advanced-techniques">Advanced Techniques</a>
                <ul id="advanced-techniques">
                    <li><a href="/userguide/lazy_configuration.html">Configuring Tasks Lazily</a></li>
                    <li><a href="https://guides.gradle.org/using-the-worker-api/">Developing Parallel Tasks</a></li>
                    <li><a href="/userguide/test_kit.html">Testing Your Build with TestKit</a></li>
                    <li><a href="/userguide/ant.html">Using Ant from Gradle</a></li>
                </ul>
            </li>
            <li><a class="nav-dropdown" data-toggle="collapse" href="#sample-gradle-builds" aria-expanded="false" aria-controls="sample-gradle-builds">Sample Gradle builds</a>
                <ul id="sample-gradle-builds">
                    <li><a href="https://github.com/gradle/gradle/tree/master/subprojects/docs/src/samples">Groovy DSL Samples</a></li>
                    <li><a href="https://github.com/gradle/kotlin-dsl/tree/master/samples">Kotlin DSL Samples</a></li>
                </ul>
            </li>
        </ul>

        <h3 id="developing-gradle-plugins">Extending Gradle</h3>
        <ul>
            <li><a href="/userguide/custom_plugins.html">Writing Custom Plugins</a></li>
            <li><a href="https://gradle.org/guides/?q=Plugin%20Development">Plugin Development Guides</a></li>
        </ul>
    </nav>
    <!-- End Primary Navigation -->
    <div class="chapter">
        <aside class="chapter-meta js-chapter-meta">
            <div class="rating js-rating-widget">
                <!--NOTE: These are "backwards" because we use a right-to-left trick for hover state-->
                <i class="star js-analytics-event js-rating" title="Excellent Documentation" data-action="rating" data-label="5"><svg width="16px" height="15px" viewBox="0 0 16 15" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="#999999" transform="translate(-33.000000, -11.000000)" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M40.9955595,22.8514234 L36.7915654,24.9948806 L36.7915654,24.9948806 C36.7423632,25.019967 36.6821404,25.0004172 36.657054,24.951215 C36.6471785,24.931846 36.6438844,24.9097862 36.6476706,24.8883772 L37.4490484,20.357021 L37.4490484,20.357021 C37.4549065,20.3238963 37.4437179,20.2900458 37.419273,20.2669371 L34.0268385,17.0599455 L34.0268385,17.0599455 C33.9867045,17.0220055 33.984926,16.9587139 34.0228661,16.91858 C34.0384357,16.9021101 34.0591382,16.8914177 34.0815807,16.888255 L38.7752895,16.2268062 L38.7752895,16.2268062 C38.8076013,16.2222528 38.8356591,16.2022207 38.8504587,16.1731387 L40.9518588,12.0437603 L40.9518588,12.0437603 C40.9769072,11.9945387 41.0371149,11.9749424 41.0863365,11.9999908 C41.1051882,12.0095843 41.1205124,12.0249085 41.1301059,12.0437603 L43.2315061,16.1731387 L43.2315061,16.1731387 C43.2463056,16.2022207 43.2743635,16.2222528 43.3066753,16.2268062 L48.0003841,16.888255 L48.0003841,16.888255 C48.0550722,16.8959618 48.0931581,16.9465428 48.0854513,17.001231 C48.0822887,17.0236735 48.0715962,17.044376 48.0551263,17.0599455 L44.6626917,20.2669371 L44.6626917,20.2669371 C44.6382468,20.2900458 44.6270582,20.3238963 44.6329164,20.357021 L45.4342941,24.8883772 L45.4342941,24.8883772 C45.4439121,24.9427617 45.4076217,24.9946461 45.3532371,25.0042641 C45.3318281,25.0080503 45.3097683,25.0047561 45.2903993,24.9948806 L41.0864052,22.8514234 L41.0864052,22.8514234 C41.0578708,22.8368748 41.024094,22.8368748 40.9955595,22.8514234 Z"></path></g></svg></i>
                <i class="star js-analytics-event js-rating" title="Good Documentation" data-action="rating" data-label="4"><svg width="16px" height="15px" viewBox="0 0 16 15" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="#999999" transform="translate(-33.000000, -11.000000)" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M40.9955595,22.8514234 L36.7915654,24.9948806 L36.7915654,24.9948806 C36.7423632,25.019967 36.6821404,25.0004172 36.657054,24.951215 C36.6471785,24.931846 36.6438844,24.9097862 36.6476706,24.8883772 L37.4490484,20.357021 L37.4490484,20.357021 C37.4549065,20.3238963 37.4437179,20.2900458 37.419273,20.2669371 L34.0268385,17.0599455 L34.0268385,17.0599455 C33.9867045,17.0220055 33.984926,16.9587139 34.0228661,16.91858 C34.0384357,16.9021101 34.0591382,16.8914177 34.0815807,16.888255 L38.7752895,16.2268062 L38.7752895,16.2268062 C38.8076013,16.2222528 38.8356591,16.2022207 38.8504587,16.1731387 L40.9518588,12.0437603 L40.9518588,12.0437603 C40.9769072,11.9945387 41.0371149,11.9749424 41.0863365,11.9999908 C41.1051882,12.0095843 41.1205124,12.0249085 41.1301059,12.0437603 L43.2315061,16.1731387 L43.2315061,16.1731387 C43.2463056,16.2022207 43.2743635,16.2222528 43.3066753,16.2268062 L48.0003841,16.888255 L48.0003841,16.888255 C48.0550722,16.8959618 48.0931581,16.9465428 48.0854513,17.001231 C48.0822887,17.0236735 48.0715962,17.044376 48.0551263,17.0599455 L44.6626917,20.2669371 L44.6626917,20.2669371 C44.6382468,20.2900458 44.6270582,20.3238963 44.6329164,20.357021 L45.4342941,24.8883772 L45.4342941,24.8883772 C45.4439121,24.9427617 45.4076217,24.9946461 45.3532371,25.0042641 C45.3318281,25.0080503 45.3097683,25.0047561 45.2903993,24.9948806 L41.0864052,22.8514234 L41.0864052,22.8514234 C41.0578708,22.8368748 41.024094,22.8368748 40.9955595,22.8514234 Z"></path></g></svg></i>
                <i class="star js-analytics-event js-rating" title="OK Documentation" data-action="rating" data-label="3"><svg width="16px" height="15px" viewBox="0 0 16 15" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="#999999" transform="translate(-33.000000, -11.000000)" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M40.9955595,22.8514234 L36.7915654,24.9948806 L36.7915654,24.9948806 C36.7423632,25.019967 36.6821404,25.0004172 36.657054,24.951215 C36.6471785,24.931846 36.6438844,24.9097862 36.6476706,24.8883772 L37.4490484,20.357021 L37.4490484,20.357021 C37.4549065,20.3238963 37.4437179,20.2900458 37.419273,20.2669371 L34.0268385,17.0599455 L34.0268385,17.0599455 C33.9867045,17.0220055 33.984926,16.9587139 34.0228661,16.91858 C34.0384357,16.9021101 34.0591382,16.8914177 34.0815807,16.888255 L38.7752895,16.2268062 L38.7752895,16.2268062 C38.8076013,16.2222528 38.8356591,16.2022207 38.8504587,16.1731387 L40.9518588,12.0437603 L40.9518588,12.0437603 C40.9769072,11.9945387 41.0371149,11.9749424 41.0863365,11.9999908 C41.1051882,12.0095843 41.1205124,12.0249085 41.1301059,12.0437603 L43.2315061,16.1731387 L43.2315061,16.1731387 C43.2463056,16.2022207 43.2743635,16.2222528 43.3066753,16.2268062 L48.0003841,16.888255 L48.0003841,16.888255 C48.0550722,16.8959618 48.0931581,16.9465428 48.0854513,17.001231 C48.0822887,17.0236735 48.0715962,17.044376 48.0551263,17.0599455 L44.6626917,20.2669371 L44.6626917,20.2669371 C44.6382468,20.2900458 44.6270582,20.3238963 44.6329164,20.357021 L45.4342941,24.8883772 L45.4342941,24.8883772 C45.4439121,24.9427617 45.4076217,24.9946461 45.3532371,25.0042641 C45.3318281,25.0080503 45.3097683,25.0047561 45.2903993,24.9948806 L41.0864052,22.8514234 L41.0864052,22.8514234 C41.0578708,22.8368748 41.024094,22.8368748 40.9955595,22.8514234 Z"></path></g></svg></i>
                <i class="star js-analytics-event js-rating" title="Poor Documentation" data-action="rating" data-label="2"><svg width="16px" height="15px" viewBox="0 0 16 15" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="#999999" transform="translate(-33.000000, -11.000000)" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M40.9955595,22.8514234 L36.7915654,24.9948806 L36.7915654,24.9948806 C36.7423632,25.019967 36.6821404,25.0004172 36.657054,24.951215 C36.6471785,24.931846 36.6438844,24.9097862 36.6476706,24.8883772 L37.4490484,20.357021 L37.4490484,20.357021 C37.4549065,20.3238963 37.4437179,20.2900458 37.419273,20.2669371 L34.0268385,17.0599455 L34.0268385,17.0599455 C33.9867045,17.0220055 33.984926,16.9587139 34.0228661,16.91858 C34.0384357,16.9021101 34.0591382,16.8914177 34.0815807,16.888255 L38.7752895,16.2268062 L38.7752895,16.2268062 C38.8076013,16.2222528 38.8356591,16.2022207 38.8504587,16.1731387 L40.9518588,12.0437603 L40.9518588,12.0437603 C40.9769072,11.9945387 41.0371149,11.9749424 41.0863365,11.9999908 C41.1051882,12.0095843 41.1205124,12.0249085 41.1301059,12.0437603 L43.2315061,16.1731387 L43.2315061,16.1731387 C43.2463056,16.2022207 43.2743635,16.2222528 43.3066753,16.2268062 L48.0003841,16.888255 L48.0003841,16.888255 C48.0550722,16.8959618 48.0931581,16.9465428 48.0854513,17.001231 C48.0822887,17.0236735 48.0715962,17.044376 48.0551263,17.0599455 L44.6626917,20.2669371 L44.6626917,20.2669371 C44.6382468,20.2900458 44.6270582,20.3238963 44.6329164,20.357021 L45.4342941,24.8883772 L45.4342941,24.8883772 C45.4439121,24.9427617 45.4076217,24.9946461 45.3532371,25.0042641 C45.3318281,25.0080503 45.3097683,25.0047561 45.2903993,24.9948806 L41.0864052,22.8514234 L41.0864052,22.8514234 C41.0578708,22.8368748 41.024094,22.8368748 40.9955595,22.8514234 Z"></path></g></svg></i>
                <i class="star js-analytics-event js-rating" title="Unusable Documentation" data-action="rating" data-label="1"><svg width="16px" height="15px" viewBox="0 0 16 15" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="#999999" transform="translate(-33.000000, -11.000000)" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M40.9955595,22.8514234 L36.7915654,24.9948806 L36.7915654,24.9948806 C36.7423632,25.019967 36.6821404,25.0004172 36.657054,24.951215 C36.6471785,24.931846 36.6438844,24.9097862 36.6476706,24.8883772 L37.4490484,20.357021 L37.4490484,20.357021 C37.4549065,20.3238963 37.4437179,20.2900458 37.419273,20.2669371 L34.0268385,17.0599455 L34.0268385,17.0599455 C33.9867045,17.0220055 33.984926,16.9587139 34.0228661,16.91858 C34.0384357,16.9021101 34.0591382,16.8914177 34.0815807,16.888255 L38.7752895,16.2268062 L38.7752895,16.2268062 C38.8076013,16.2222528 38.8356591,16.2022207 38.8504587,16.1731387 L40.9518588,12.0437603 L40.9518588,12.0437603 C40.9769072,11.9945387 41.0371149,11.9749424 41.0863365,11.9999908 C41.1051882,12.0095843 41.1205124,12.0249085 41.1301059,12.0437603 L43.2315061,16.1731387 L43.2315061,16.1731387 C43.2463056,16.2022207 43.2743635,16.2222528 43.3066753,16.2268062 L48.0003841,16.888255 L48.0003841,16.888255 C48.0550722,16.8959618 48.0931581,16.9465428 48.0854513,17.001231 C48.0822887,17.0236735 48.0715962,17.044376 48.0551263,17.0599455 L44.6626917,20.2669371 L44.6626917,20.2669371 C44.6382468,20.2900458 44.6270582,20.3238963 44.6329164,20.357021 L45.4342941,24.8883772 L45.4342941,24.8883772 C45.4439121,24.9427617 45.4076217,24.9946461 45.3532371,25.0042641 C45.3318281,25.0080503 45.3097683,25.0047561 45.2903993,24.9948806 L41.0864052,22.8514234 L41.0864052,22.8514234 C41.0578708,22.8368748 41.024094,22.8368748 40.9955595,22.8514234 Z"></path></g></svg></i>
            </div>

            <div class="quick-edit">
                <a class="edit-link js-edit-link" href="https://github.com/gradle/gradle/edit/master/subprojects/docs/src/docs/userguide/">
                    <svg width="11px" height="12px" viewBox="0 0 11 12" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <g stroke="#999999" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="9 5.11724219 9 11.5 0.5 11.5 0.5 2.5 5 2.5"></polyline>
                            <polygon fill="#999999" points="9.59427002 0.565307617 4.31427002 5.84530762 4.31427002 6.56530762 5.03427002 6.56530762 10.31427 1.28530762"></polygon>
                        </g>
                    </svg>
                    Edit this page
                </a>
            </div>
        </aside>
<div id="header">
<h1>Gradle User Manual: Version 4.10.3</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#about_gradle">About Gradle</a>
<ul class="sectlevel2">
<li><a href="#overview">Overview</a></li>
</ul>
</li>
<li><a href="#getting_started">Getting Started</a>
<ul class="sectlevel2">
<li><a href="#installation">Installing Gradle</a></li>
</ul>
</li>
<li><a href="#using_gradle_builds">Using Gradle Builds</a>
<ul class="sectlevel2">
<li><a href="#command_line_interface">Command-Line Interface</a></li>
<li><a href="#build_environment">Build Environment</a></li>
<li><a href="#directory_layout">Directory Layout</a></li>
<li><a href="#gradle_daemon">The Gradle Daemon</a></li>
<li><a href="#init_scripts">Initialization Scripts</a></li>
<li><a href="#intro_multi_project_builds">Executing Multi-Project Builds</a></li>
<li><a href="#gradle_wrapper">The Gradle Wrapper</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li><a href="#authoring_gradle_builds">Authoring Gradle Builds</a>
<ul class="sectlevel2">
<li><a href="#feature_lifecycle">The Feature Lifecycle</a></li>
<li><a href="#authoring_maintainable_build_scripts">Authoring Maintainable Build Scripts</a></li>
<li><a href="#organizing_gradle_projects">Organizing Gradle Projects</a></li>
<li><a href="#build_cache">Build Cache</a></li>
<li><a href="#build_init_plugin">Build Init Plugin</a></li>
<li><a href="#build_lifecycle">Build Lifecycle</a></li>
<li><a href="#tutorial_using_tasks">Build Script Basics</a></li>
<li><a href="#composite_builds">Composite builds</a></li>
<li><a href="#multi_project_builds">Authoring Multi-Project Builds</a></li>
<li><a href="#more_about_tasks">Authoring Tasks</a></li>
<li><a href="#logging">Logging</a></li>
<li><a href="#standard_plugins">Standard Gradle plugins</a></li>
<li><a href="#test_kit">Testing Build Logic with TestKit</a></li>
<li><a href="#plugins">Using Gradle Plugins</a></li>
<li><a href="#working_with_files">Working With Files</a></li>
<li><a href="#writing_build_scripts">Writing Build Scripts</a></li>
<li><a href="#custom_tasks">Writing Custom Task Classes</a></li>
<li><a href="#base_plugin">The Base Plugin</a></li>
</ul>
</li>
<li><a href="#dependency_management">Dependency Management</a>
<ul class="sectlevel2">
<li><a href="#introduction_dependency_management">Introduction to Dependency Management</a></li>
<li><a href="#dependency_management_terminology">Dependency Management Terminology</a></li>
<li><a href="#dependency_types">Dependency Types</a></li>
<li><a href="#repository_types">Repository Types</a></li>
<li><a href="#declaring_dependencies">Declaring Dependencies</a></li>
<li><a href="#declaring_repositories">Declaring Repositories</a></li>
<li><a href="#inspecting_dependencies">Inspecting Dependencies</a></li>
<li><a href="#managing_dependency_configurations">Managing Dependency Configurations</a></li>
<li><a href="#managing_transitive_dependencies">Managing Transitive Dependencies</a></li>
<li><a href="#dependency_locking">Dependency Locking</a></li>
<li><a href="#troubleshooting_dependency_resolution">Troubleshooting Dependency Resolution</a></li>
<li><a href="#customizing_dependency_resolution_behavior">Customizing Dependency Resolution Behavior</a></li>
<li><a href="#dependency_cache">The Dependency Cache</a></li>
<li><a href="#working_with_dependencies">Working with Dependencies</a></li>
</ul>
</li>
<li><a href="#publishing_artifacts">Publishing Artifacts</a>
<ul class="sectlevel2">
<li><a href="#publishing_overview">Publishing</a></li>
<li><a href="#publishing_maven">Maven Publish Plugin</a></li>
<li><a href="#publishing_ivy">Ivy Publish Plugin</a></li>
<li><a href="#artifact_management">Legacy publishing</a></li>
<li><a href="#maven_plugin">Maven Plugin</a></li>
<li><a href="#signing_plugin">The Signing Plugin</a></li>
<li><a href="#distribution_plugin">The Distribution Plugin</a></li>
</ul>
</li>
<li><a href="#native_projects">Native Projects</a>
<ul class="sectlevel2">
<li><a href="#native_software">Building native software</a></li>
<li><a href="#software_model_concepts">Software model concepts</a></li>
<li><a href="#software_model">Rule based model configuration</a></li>
<li><a href="#rule_source">Implementing model rules in a plugin</a></li>
<li><a href="#software_model_extend">Extending the software model</a></li>
</ul>
</li>
<li><a href="#groovy_projects">Groovy Projects</a>
<ul class="sectlevel2">
<li><a href="#tutorial_groovy_projects">Groovy Quickstart</a></li>
<li><a href="#groovy_plugin">The Groovy Plugin</a></li>
<li><a href="#codenarc_plugin">The CodeNarc Plugin</a></li>
</ul>
</li>
<li><a href="#java_projects">Java Projects</a>
<ul class="sectlevel2">
<li><a href="#tutorial_java_projects">Java Quickstart</a></li>
<li><a href="#building_java_projects">Building Java &amp; JVM projects</a></li>
<li><a href="#java_testing">Testing in Java &amp; JVM projects</a></li>
<li><a href="#java_plugin">The Java Plugin</a></li>
<li><a href="#java_library_plugin">The Java Library Plugin</a></li>
<li><a href="#java_library_distribution_plugin">The Java Library Distribution Plugin</a></li>
<li><a href="#dependency_management_for_java_projects">Dependency Management for Java Projects</a></li>
<li><a href="#ant">Using Ant from Gradle</a></li>
<li><a href="#antlr_plugin">The ANTLR Plugin</a></li>
<li><a href="#application_plugin">The Application Plugin</a></li>
<li><a href="#checkstyle_plugin">The Checkstyle Plugin</a></li>
<li><a href="#findbugs_plugin">The FindBugs Plugin</a></li>
<li><a href="#jacoco_plugin">The JaCoCo Plugin</a></li>
<li><a href="#jdepend_plugin">The JDepend Plugin</a></li>
<li><a href="#osgi_plugin">The OSGi Plugin</a></li>
<li><a href="#pmd_plugin">The PMD Plugin</a></li>
</ul>
</li>
<li><a href="#java_web_projects">Java Web Projects</a>
<ul class="sectlevel2">
<li><a href="#ear_plugin">The Ear Plugin</a></li>
<li><a href="#play_plugin">Building Play applications</a></li>
<li><a href="#war_plugin">The War Plugin</a></li>
</ul>
</li>
<li><a href="#scala_projects">Scala Projects</a>
<ul class="sectlevel2">
<li><a href="#scala_plugin">The Scala Plugin</a></li>
</ul>
</li>
<li><a href="#integrating_gradle">Integrating Gradle</a>
<ul class="sectlevel2">
<li><a href="#eclipse_plugin">The Eclipse Plugins</a></li>
<li><a href="#idea_plugin">The IDEA Plugin</a></li>
<li><a href="#embedding">Embedding Gradle using the Tooling API</a></li>
</ul>
</li>
<li><a href="#extending_gradle">Extending Gradle</a>
<ul class="sectlevel2">
<li><a href="#custom_plugins">Writing Custom Plugins</a></li>
<li><a href="#java_gradle_plugin">Gradle Plugin Development Plugin</a></li>
<li><a href="#lazy_configuration">Lazy Configuration</a></li>
</ul>
</li>
<li><a href="#licenses">Licenses</a></li>
<li><a href="#documentation_licenses">Documentation licenses</a>
<ul class="sectlevel2">
<li><a href="#sec:gradle_documentation">Gradle Documentation</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="about_gradle"><a class="anchor" href="#about_gradle"></a><a class="link" href="#about_gradle">About Gradle</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="overview"><a class="anchor" href="#overview"></a><a class="link" href="#overview">Overview</a></h3>
<div class="sect3">
<h4 id="sec:special_feature_of_gradle"><a class="anchor" href="#sec:special_feature_of_gradle"></a><a class="link" href="#sec:special_feature_of_gradle">Features</a></h4>
<div class="paragraph">
<p>Here is a list of some of Gradle&#8217;s features.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Declarative builds and build-by-convention</dt>
<dd>
<p>At the heart of Gradle lies a rich extensible Domain Specific Language (DSL) based on Groovy. Gradle pushes declarative builds to the next level by providing declarative language elements that you can assemble as you like. Those elements also provide build-by-convention support for Java, Groovy, OSGi, Web and Scala projects. Even more, this declarative language is extensible. Add your own new language elements or enhance the existing ones, thus providing concise, maintainable and comprehensible builds.</p>
</dd>
<dt class="hdlist1">Language for dependency based programming</dt>
<dd>
<p>The declarative language lies on top of a general purpose task graph, which you can fully leverage in your builds. It provides utmost flexibility to adapt Gradle to your unique needs.</p>
</dd>
<dt class="hdlist1">Structure your build</dt>
<dd>
<p>The suppleness and richness of Gradle finally allows you to apply common design principles to your build. For example, it is very easy to compose your build from reusable pieces of build logic. Inline stuff where unnecessary indirections would be inappropriate. Don&#8217;t be forced to tear apart what belongs together (e.g. in your project hierarchy). Avoid smells like shotgun changes or divergent change that turn your build into a maintenance nightmare. At last you can create a well structured, easily maintained, comprehensible build.</p>
</dd>
<dt class="hdlist1">Deep API</dt>
<dd>
<p>From being a pleasure to be used embedded to its many hooks over the whole lifecycle of build execution, Gradle allows you to monitor and customize its configuration and execution behavior to its very core.</p>
</dd>
<dt class="hdlist1">Gradle scales</dt>
<dd>
<p>Gradle scales very well. It significantly increases your productivity, from simple single project builds up to huge enterprise multi-project builds. This is true for structuring the build. With the state-of-art incremental build function, this is also true for tackling the performance pain many large enterprise builds suffer from.</p>
</dd>
<dt class="hdlist1">Multi-project builds</dt>
<dd>
<p>Gradle&#8217;s support for multi-project build is outstanding. Project dependencies are first class citizens. We allow you to model the project relationships in a multi-project build as they really are for your problem domain. Gradle follows your layout not vice versa.</p>
<div class="paragraph">
<p>Gradle provides partial builds. If you build a single subproject Gradle takes care of building all the subprojects that subproject depends on. You can also choose to rebuild the subprojects that depend on a particular subproject. Together with incremental builds this is a big time saver for larger builds.</p>
</div>
</dd>
<dt class="hdlist1">Many ways to manage your dependencies</dt>
<dd>
<p>Different teams prefer different ways to manage their external dependencies. Gradle provides convenient support for any strategy. From transitive dependency management with remote Maven and Ivy repositories to jars or directories on the local file system.</p>
</dd>
<dt class="hdlist1">Gradle is the first build integration tool</dt>
<dd>
<p>Ant tasks are first class citizens. Even more interesting, Ant projects are first class citizens as well. Gradle provides a deep import for any Ant project, turning Ant targets into native Gradle tasks at runtime. You can depend on them from Gradle, you can enhance them from Gradle, you can even declare dependencies on Gradle tasks in your build.xml. The same integration is provided for properties, paths, etc &#8230;&#8203;</p>
<div class="paragraph">
<p>Gradle fully supports your existing Maven or Ivy repository infrastructure for publishing and retrieving dependencies. Gradle also provides a converter for turning a Maven <code>pom.xml</code> into a Gradle script. Runtime imports of Maven projects will come soon.</p>
</div>
</dd>
<dt class="hdlist1">Ease of migration</dt>
<dd>
<p>Gradle can adapt to any structure you have. Therefore you can always develop your Gradle build in the same branch where your production build lives and both can evolve in parallel. We usually recommend to write tests that make sure that the produced artifacts are similar. That way migration is as less disruptive and as reliable as possible. This is following the best-practices for refactoring by applying baby steps.</p>
</dd>
<dt class="hdlist1">Groovy</dt>
<dd>
<p>Gradle&#8217;s build scripts are written in Groovy or Kotlin, not XML. But unlike other approaches this is not for simply exposing the raw scripting power of a dynamic language. That would just lead to a very difficult to maintain build. The whole design of Gradle is oriented towards being used as a language, not as a rigid framework. And Groovy is our glue that allows you to tell your individual story with the abstractions Gradle (or you) provide. Gradle provides some standard stories but they are not privileged in any form. This is for us a major distinguishing feature compared to other declarative build systems. Our Groovy support is not just sugar coating. The whole Gradle API is fully Groovy-ized. Adding Groovy results in an enjoyable and productive experience.</p>
</dd>
<dt class="hdlist1">The Gradle wrapper</dt>
<dd>
<p>The Gradle Wrapper allows you to execute Gradle builds on machines where Gradle is not installed. This is useful for example for some continuous integration servers. It is also useful for an open source project to keep the barrier low for building it. The wrapper is also very interesting for the enterprise. It is a zero administration approach for the client machines. It also enforces the usage of a particular Gradle version thus minimizing support issues.</p>
</dd>
<dt class="hdlist1">Free and open source</dt>
<dd>
<p>Gradle is an open source project, and is licensed under the <a href="https://github.com/gradle/gradle/blob/master/LICENSE">Apache License 2.0</a>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:why_groovy"><a class="anchor" href="#sec:why_groovy"></a><a class="link" href="#sec:why_groovy">Why Groovy?</a></h4>
<div class="paragraph">
<p>We think the advantages of an internal DSL (based on a dynamic language) over XML are tremendous when used in <em>build scripts</em>. There are a couple of dynamic languages out there. Why Groovy? The answer lies in the context Gradle is operating in. Although Gradle is a general purpose build tool at its core, its main focus are Java projects. In such projects the team members will be very familiar with Java. We think a build should be as transparent as possible to <em>all</em> team members.</p>
</div>
<div class="paragraph">
<p>In that case, you might argue why we don&#8217;t just use Java as the language for build scripts. We think this is a valid question. It would have the highest transparency for your team and the lowest learning curve, but because of the limitations of Java, such a build language would not be as nice, expressive and powerful as it could be.<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> Languages like Python, Groovy or Ruby do a much better job here. We have chosen Groovy as it offers by far the greatest transparency for Java people. Its base syntax is the same as Java&#8217;s as well as its type system, its package structure and other things. Groovy provides much more on top of that, but with the common foundation of Java.</p>
</div>
<div class="paragraph">
<p>For Java developers with Python or Ruby knowledge or the desire to learn them, the above arguments don&#8217;t apply. The Gradle design is well-suited for creating another build script engine in JRuby or Jython. It just doesn&#8217;t have the highest priority for us at the moment. We happily support any community effort to create additional build script engines.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting_started"><a class="anchor" href="#getting_started"></a><a class="link" href="#getting_started">Getting Started</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="installation"><a class="anchor" href="#installation"></a><a class="link" href="#installation">Installing Gradle</a></h3>
<div class="paragraph">
<p>You can install the Gradle build tool on Linux, macOS, or Windows.
This document covers installing using a package manager like SDKMAN!, Homebrew, or Scoop, as well as manual installation.</p>
</div>
<div class="paragraph">
<p>Use of the <a href="#sec:upgrading_wrapper">Gradle Wrapper</a> is the recommended way to upgrade Gradle.</p>
</div>
<div class="paragraph">
<p>You can find all releases and their checksums on the <a href="https://gradle.org/releases">releases page</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:prerequisites"><a class="anchor" href="#sec:prerequisites"></a><a class="link" href="#sec:prerequisites">Prerequisites</a></h4>
<div class="paragraph">
<p>Gradle runs on all major operating systems and requires only a <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java JDK</a> version 7 or higher to run. To check, run <code>java -version</code>. You should see something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> java -version
java version "1.8.0_151"
Java(TM) SE Runtime Environment (build 1.8.0_151-b12)
Java HotSpot(TM) 64-Bit Server VM (build 25.151-b12, mixed mode)</pre>
</div>
</div>
<div class="paragraph">
<p>Gradle ships with its own Groovy library, therefore Groovy does not need to be installed. Any existing Groovy installation is ignored by Gradle.</p>
</div>
<div class="paragraph">
<p>Gradle uses whatever JDK it finds in your path. Alternatively, you can set the <code>JAVA_HOME</code> environment variable to point to the installation directory of the desired JDK.</p>
</div>
</div>
<div class="sect3">
<h4 id="installing_with_a_package_manager"><a class="anchor" href="#installing_with_a_package_manager"></a><a class="link" href="#installing_with_a_package_manager">Installing with a package manager</a></h4>
<div class="paragraph">
<p><a href="http://sdkman.io">SDKMAN!</a> is a tool for managing parallel versions of multiple Software Development Kits on most Unix-based systems.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> sdk install gradle</pre>
</div>
</div>
<div class="paragraph">
<p><a href="http://brew.sh">Homebrew</a> is "the missing package manager for macOS".</p>
</div>
<div class="listingblock">
<div class="content">
<pre> brew install gradle</pre>
</div>
</div>
<div class="paragraph">
<p><a href="http://scoop.sh">Scoop</a> is a command-line installer for Windows inspired by Homebrew.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> scoop install gradle</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://chocolatey.org">Chocolatey</a> is "the package manager for Windows".</p>
</div>
<div class="listingblock">
<div class="content">
<pre> choco install gradle</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://www.macports.org">MacPorts</a> is a system for managing tools on macOS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> sudo port install gradle</pre>
</div>
</div>
<div class="paragraph">
<p><a href="#sec:installation_next_steps"> Proceed to next steps</a></p>
</div>
</div>
<div class="sect3">
<h4 id="installing_manually"><a class="anchor" href="#installing_manually"></a><a class="link" href="#installing_manually">Installing manually</a></h4>
<div class="sect4">
<h5 id="step_1_download_the_latest_gradle_distribution"><a class="anchor" href="#step_1_download_the_latest_gradle_distribution"></a><a class="link" href="#step_1_download_the_latest_gradle_distribution">Step 1. <a href="https://gradle.org/releases">Download</a> the latest Gradle distribution</a></h5>
<div class="paragraph">
<p>The distribution ZIP file comes in two flavors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Binary-only (bin)</p>
</li>
<li>
<p>Complete (all) with docs and sources</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Need to work with an older version? See the <a href="https://gradle.org/releases">releases page</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="step_2_unpack_the_distribution"><a class="anchor" href="#step_2_unpack_the_distribution"></a><a class="link" href="#step_2_unpack_the_distribution">Step 2. Unpack the distribution</a></h5>
<div class="sect5">
<h6 id="linux_macos_users"><a class="anchor" href="#linux_macos_users"></a><a class="link" href="#linux_macos_users">Linux &amp; MacOS users</a></h6>
<div class="paragraph">
<p>Unzip the distribution zip file in the directory of your choosing, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> mkdir /opt/gradle
 unzip -d /opt/gradle gradle-4.10.3-bin.zip
 ls /opt/gradle/gradle-4.10.3
LICENSE  NOTICE  bin  getting-started.html  init.d  lib  media</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="microsoft_windows_users"><a class="anchor" href="#microsoft_windows_users"></a><a class="link" href="#microsoft_windows_users">Microsoft Windows users</a></h6>
<div class="paragraph">
<p>Create a new directory <code>C:\Gradle</code> with <strong>File Explorer</strong>.</p>
</div>
<div class="paragraph">
<p>Open a second <strong>File Explorer</strong> window and go to the directory where the Gradle distribution was downloaded. Double-click the ZIP archive to expose the content. Drag the content folder <code>gradle-4.10.3</code> to your newly created <code>C:\Gradle</code> folder.</p>
</div>
<div class="paragraph">
<p>Alternatively you can unpack the Gradle distribution ZIP into <code>C:\Gradle</code> using an archiver tool of your choice.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="step_3_configure_your_system_environment"><a class="anchor" href="#step_3_configure_your_system_environment"></a><a class="link" href="#step_3_configure_your_system_environment">Step 3. Configure your system environment</a></h5>
<div class="paragraph">
<p>For running Gradle, firstly add the environment variable <code>GRADLE_HOME</code>. This should point to the unpacked files from the Gradle website. Next add <code><em>GRADLE_HOME</em>/bin</code> to your <code>PATH</code> environment variable. Usually, this is sufficient to run Gradle.</p>
</div>
<div class="sect5">
<h6 id="linux_macos_users_2"><a class="anchor" href="#linux_macos_users_2"></a><a class="link" href="#linux_macos_users_2">Linux &amp; MacOS users</a></h6>
<div class="paragraph">
<p>Configure your <code>PATH</code> environment variable to include the <code>bin</code> directory of the unzipped distribution, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> export PATH=$PATH:/opt/gradle/gradle-4.10.3/bin</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="microsoft_windows_users_2"><a class="anchor" href="#microsoft_windows_users_2"></a><a class="link" href="#microsoft_windows_users_2">Microsoft Windows users</a></h6>
<div class="paragraph">
<p>In <strong>File Explorer</strong> right-click on the <code>This PC</code> (or <code>Computer</code>) icon, then click <code>Properties</code> &#8594; <code>Advanced System Settings</code> &#8594; <code>Environmental Variables</code>.</p>
</div>
<div class="paragraph">
<p>Under <code>System Variables</code> select <code>Path</code>, then click <code>Edit</code>. Add an entry for <code>C:\Gradle\gradle-4.10.3\bin</code>. Click OK to save.</p>
</div>
<div class="paragraph">
<p><a href="#sec:installation_next_steps"> Proceed to next steps</a></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:running_and_testing_your_installation"><a class="anchor" href="#sec:running_and_testing_your_installation"></a><a class="link" href="#sec:running_and_testing_your_installation">Verifying installation</a></h4>
<div class="paragraph">
<p>Open a console (or a Windows command prompt) and run <code>gradle -v</code> to run gradle and display the version, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle -v

------------------------------------------------------------
Gradle 4.10.3
------------------------------------------------------------

Build time:   2018-02-21 15:28:42 UTC
Revision:     819e0059da49f469d3e9b2896dc4e72537c4847d

Groovy:       2.4.15
Ant:          Apache Ant(TM) version 1.9.9 compiled on February 2 2017
JVM:          1.8.0_151 (Oracle Corporation 25.151-b12)
OS:           Mac OS X 10.13.3 x86_64</pre>
</div>
</div>
<div class="paragraph">
<p>If you run into any trouble, see the <a href="#sec:troubleshooting_installation">section on troubleshooting installation</a>.</p>
</div>
<div class="paragraph">
<p>You can verify the integrity of the Gradle distribution by downloading the SHA-256 file (available from the <a href="https://gradle.org/releases">releases page</a>) and following these <a href="#sec:verification">verification instructions</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:installation_next_steps"><a class="anchor" href="#sec:installation_next_steps"></a><a class="link" href="#sec:installation_next_steps">Next steps</a></h4>
<div class="paragraph">
<p>Now that you have Gradle installed, use these resources for getting started:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create your first Gradle project by following the <a href="https://guides.gradle.org/creating-new-gradle-builds/">Creating New Gradle Builds</a> tutorial.</p>
</li>
<li>
<p>Sign up for a <a href="https://gradle.org/training/intro-to-gradle/">live introductory Gradle training</a> with a core engineer.</p>
</li>
<li>
<p>Learn how to achieve common tasks through the <a href="#command_line_interface">command-line interface</a>.</p>
</li>
<li>
<p><a href="#build_environment">Configure Gradle execution</a>, such as use of an HTTP proxy for downloading dependencies.</p>
</li>
<li>
<p>Subscribe to the <a href="https://newsletter.gradle.com/">Gradle Newsletter</a> for monthly release and community updates.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using_gradle_builds"><a class="anchor" href="#using_gradle_builds"></a><a class="link" href="#using_gradle_builds">Using Gradle Builds</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="command_line_interface"><a class="anchor" href="#command_line_interface"></a><a class="link" href="#command_line_interface">Command-Line Interface</a></h3>
<div class="paragraph lead">
<p>The command-line interface is one of the primary methods of interacting with Gradle. The following serves as a reference of executing and customizing Gradle use of a command-line or when writing scripts or configuring continuous integration.</p>
</div>
<div class="paragraph">
<p>Use of the <a href="#gradle_wrapper">Gradle Wrapper</a> is highly encouraged. You should substitute <code>./gradlew</code> or <code>gradlew.bat</code> for <code>gradle</code> in all following examples when using the Wrapper.</p>
</div>
<div class="paragraph">
<p>Executing Gradle on the command-line conforms to the following structure. Options are allowed before and after task names.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gradle [taskName...] [--option-name...]</pre>
</div>
</div>
<div class="paragraph">
<p>If multiple tasks are specified, they should be separated with a space.</p>
</div>
<div class="paragraph">
<p>Options that accept values can be specified with or without <code>=</code> between the option and argument; however, use of <code>=</code> is recommended.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>--console=plain</pre>
</div>
</div>
<div class="paragraph">
<p>Options that enable behavior have long-form options with inverses specified with <code>--no-</code>. The following are opposites.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>--build-cache
--no-build-cache</pre>
</div>
</div>
<div class="paragraph">
<p>Many long-form options, have short option equivalents. The following are equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>--help
-h</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Many command-line flags can be specified in <code>gradle.properties</code> to avoid needing to be typed. See the <a href="#sec:gradle_configuration_properties">configuring build environment guide</a> for details.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following sections describe use of the Gradle command-line interface, grouped roughly by user goal. Some plugins also add their own command line options, for example <a href="#test_filtering"><code>--tests</code> for Java test filtering</a>. For more information on exposing command line options for your own tasks, see <a href="#sec:declaring_and_using_command_line_options">Declaring and using command-line options</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:command_line_executing_tasks"><a class="anchor" href="#sec:command_line_executing_tasks"></a><a class="link" href="#sec:command_line_executing_tasks">Executing tasks</a></h4>
<div class="paragraph">
<p>You can run a task and all of its <a href="#sec:task_dependencies">dependencies</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle myTask</pre>
</div>
</div>
<div class="paragraph">
<p>You can learn about what projects and tasks are available in the <a href="#sec:command_line_project_reporting">project reporting section</a>.</p>
</div>
<div class="sect4">
<h5 id="executing_tasks_in_multi_project_builds"><a class="anchor" href="#executing_tasks_in_multi_project_builds"></a><a class="link" href="#executing_tasks_in_multi_project_builds">Executing tasks in multi-project builds</a></h5>
<div class="paragraph">
<p>In a <a href="#intro_multi_project_builds">multi-project build</a>, subproject tasks can be executed with ":" separating subproject name and task name. The following are equivalent <em>when run from the root project</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle :mySubproject:taskName
 gradle mySubproject:taskName</pre>
</div>
</div>
<div class="paragraph">
<p>You can also run a task for all subprojects using the task name only. For example, this will run the "test" task for all subprojects when invoked from the root project directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle test</pre>
</div>
</div>
<div class="paragraph">
<p>When invoking Gradle from within a subproject, the project name should be omitted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> cd mySubproject
 gradle taskName</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>When executing the Gradle Wrapper from subprojects, one must reference <code>gradlew</code> relatively. For example: <code>../gradlew taskName</code>. The community <a href="http://www.gdub.rocks/">gdub project</a> aims to make this more convenient.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="executing_multiple_tasks"><a class="anchor" href="#executing_multiple_tasks"></a><a class="link" href="#executing_multiple_tasks">Executing multiple tasks</a></h5>
<div class="paragraph">
<p>You can also specify multiple tasks. For example, the following will execute the <code>test</code> and <code>deploy</code> tasks in the order that they are listed on the command-line and will also execute the dependencies for each task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle test deploy</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:excluding_tasks_from_the_command_line"><a class="anchor" href="#sec:excluding_tasks_from_the_command_line"></a><a class="link" href="#sec:excluding_tasks_from_the_command_line">Excluding tasks from execution</a></h5>
<div class="paragraph">
<p>You can exclude a task from being executed using the <code>-x</code> or <code>--exclude-task</code> command-line option and providing the name of the task to exclude.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/commandLineTutorialTasks.png" alt="commandLineTutorialTasks">
</div>
<div class="title">Figure 1. Example Task Graph</div>
</div>
<div class="sect5">
<h6 id="example_excluding_tasks"><a class="anchor" href="#example_excluding_tasks"></a><a class="link" href="#example_excluding_tasks">Example: Excluding tasks</a></h6>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle dist --exclude-task test</code></strong></div>
<div class="content">
<pre>&gt; gradle dist --exclude-task test

&gt; Task :compile
compiling source

&gt; Task :dist
building the distribution

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You can see that the <code>test</code> task is not executed, even though it is a dependency of the <code>dist</code> task. The <code>test</code> task&#8217;s dependencies such as <code>compileTest</code> are not executed either. Those dependencies of <code>test</code> that are required by another task, such as <code>compile</code>, are still executed.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:rerun_tasks"><a class="anchor" href="#sec:rerun_tasks"></a><a class="link" href="#sec:rerun_tasks">Forcing tasks to execute</a></h5>
<div class="paragraph">
<p>You can force Gradle to execute all tasks ignoring <a href="#sec:up_to_date_checks">up-to-date checks</a> using the <code>--rerun-tasks</code> option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle test --rerun-tasks</pre>
</div>
</div>
<div class="paragraph">
<p>This will force <code>test</code> and <em>all</em> task dependencies of <code>test</code> to execute. It&#8217;s a little like running <code>gradle clean test</code>, but without the build&#8217;s generated output being deleted.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:continue_build_on_failure"><a class="anchor" href="#sec:continue_build_on_failure"></a><a class="link" href="#sec:continue_build_on_failure">Continuing the build when a failure occurs</a></h5>
<div class="paragraph">
<p>By default, Gradle will abort execution and fail the build as soon as any task fails. This allows the build to complete sooner, but hides other failures that would have occurred. In order to discover as many failures as possible in a single build execution, you can use the <code>--continue</code> option.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle test --continue</pre>
</div>
</div>
<div class="paragraph">
<p>When executed with <code>--continue</code>, Gradle will execute <em>every</em> task to be executed where all of the dependencies for that task completed without failure, instead of stopping as soon as the first failure is encountered. Each of the encountered failures will be reported at the end of the build.</p>
</div>
<div class="paragraph">
<p>If a task fails, any subsequent tasks that were depending on it will not be executed. For example, tests will not run if there is a compilation failure in the code under test; because the test task will depend on the compilation task (either directly or indirectly).</p>
</div>
</div>
<div class="sect4">
<h5 id="task_name_abbreviation"><a class="anchor" href="#task_name_abbreviation"></a><a class="link" href="#task_name_abbreviation">Task name abbreviation</a></h5>
<div class="paragraph">
<p>When you specify tasks on the command-line, you dont have to provide the full name of the task. You only need to provide enough of the task name to uniquely identify the task. For example, it&#8217;s likely <code>gradle che</code> is enough for Gradle to identify the <code>check</code> task.</p>
</div>
<div class="paragraph">
<p>You can also abbreviate each word in a camel case task name. For example, you can execute task <code>compileTest</code> by running <code>gradle compTest</code> or even <code>gradle cT</code>.</p>
</div>
<div class="sect5">
<h6 id="example_abbreviated_camel_case_task_name"><a class="anchor" href="#example_abbreviated_camel_case_task_name"></a><a class="link" href="#example_abbreviated_camel_case_task_name">Example: Abbreviated camel case task name</a></h6>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle cT</code></strong></div>
<div class="content">
<pre>&gt; gradle cT

&gt; Task :compile
compiling source

&gt; Task :compileTest
compiling unit tests

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You can also use these abbreviations with the -x command-line option.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="common_tasks"><a class="anchor" href="#common_tasks"></a><a class="link" href="#common_tasks">Common tasks</a></h4>
<div class="paragraph">
<p>The following are task conventions applied by built-in and most major Gradle plugins.</p>
</div>
<div class="sect4">
<h5 id="computing_all_outputs"><a class="anchor" href="#computing_all_outputs"></a><a class="link" href="#computing_all_outputs">Computing all outputs</a></h5>
<div class="paragraph">
<p>It is common in Gradle builds for the <code>build</code> task to designate assembling all outputs and running all checks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle build</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running_applications"><a class="anchor" href="#running_applications"></a><a class="link" href="#running_applications">Running applications</a></h5>
<div class="paragraph">
<p>It is common for applications to be run with the <code>run</code> task, which assembles the application and executes some script or binary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle run</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running_all_checks"><a class="anchor" href="#running_all_checks"></a><a class="link" href="#running_all_checks">Running all checks</a></h5>
<div class="paragraph">
<p>It is common for <em>all</em> verification tasks, including tests and linting, to be executed using the <code>check</code> task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle check</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="cleaning_outputs"><a class="anchor" href="#cleaning_outputs"></a><a class="link" href="#cleaning_outputs">Cleaning outputs</a></h5>
<div class="paragraph">
<p>You can delete the contents of the build directory using the <code>clean</code> task, though doing so will cause pre-computed outputs to be lost, causing significant additional build time for the subsequent task execution.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle clean</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_project_reporting"><a class="anchor" href="#sec:command_line_project_reporting"></a><a class="link" href="#sec:command_line_project_reporting">Project reporting</a></h4>
<div class="paragraph">
<p>Gradle provides several built-in tasks which show particular details of your build. This can be useful for understanding the structure and dependencies of your build, and for debugging problems.</p>
</div>
<div class="paragraph">
<p>You can get basic help about available reporting options using <code>gradle help</code>.</p>
</div>
<div class="sect4">
<h5 id="listing_projects"><a class="anchor" href="#listing_projects"></a><a class="link" href="#listing_projects">Listing projects</a></h5>
<div class="paragraph">
<p>Running <code>gradle projects</code> gives you a list of the sub-projects of the selected project, displayed in a hierarchy.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle projects</pre>
</div>
</div>
<div class="paragraph">
<p>You also get a project report within build scans. Learn more about <a href="https://guides.gradle.org/creating-build-scans/">creating build scans</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:listing_tasks"><a class="anchor" href="#sec:listing_tasks"></a><a class="link" href="#sec:listing_tasks">Listing tasks</a></h5>
<div class="paragraph">
<p>Running <code>gradle tasks</code> gives you a list of the main tasks of the selected project. This report shows the default tasks for the project, if any, and a description for each task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle tasks</pre>
</div>
</div>
<div class="paragraph">
<p>By default, this report shows only those tasks which have been assigned to a task group. You can obtain more information in the task listing using the <code>--all</code> option.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle tasks --all</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:show_task_details"><a class="anchor" href="#sec:show_task_details"></a><a class="link" href="#sec:show_task_details">Show task usage details</a></h5>
<div class="paragraph">
<p>Running <code>gradle help --task someTask</code> gives you detailed information about a specific task.</p>
</div>
<div class="sect5">
<h6 id="example_obtaining_detailed_help_for_tasks"><a class="anchor" href="#example_obtaining_detailed_help_for_tasks"></a><a class="link" href="#example_obtaining_detailed_help_for_tasks">Example: Obtaining detailed help for tasks</a></h6>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q help --task libs</code></strong></div>
<div class="content">
<pre>&gt; gradle -q help --task libs
Detailed task information for libs

Paths
     :api:libs
     :webapp:libs

Type
     Task (org.gradle.api.Task)

Description
     Builds the JAR

Group
     build</pre>
</div>
</div>
<div class="paragraph">
<p>This information includes the full task path, the task type, possible command line options and the description of the given task.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="reporting_dependencies"><a class="anchor" href="#reporting_dependencies"></a><a class="link" href="#reporting_dependencies">Reporting dependencies</a></h5>
<div class="paragraph">
<p>Build scans give a full, visual report of what dependencies exist on which configurations, transitive dependencies, and dependency version selection.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle myTask --scan</pre>
</div>
</div>
<div class="paragraph">
<p>This will give you a link to a web-based report, where you can find dependency information like this.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/gradle-core-test-build-scan-dependencies.png" alt="Build Scan dependencies report">
</div>
</div>
<div class="paragraph">
<p>Learn more in <a href="#inspecting_dependencies">Inspecting Dependencies</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="listing_project_dependencies"><a class="anchor" href="#listing_project_dependencies"></a><a class="link" href="#listing_project_dependencies">Listing project dependencies</a></h5>
<div class="paragraph">
<p>Running <code>gradle dependencies</code> gives you a list of the dependencies of the selected project, broken down by configuration. For each configuration, the direct and transitive dependencies of that configuration are shown in a tree. Below is an example of this report:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle dependencies</pre>
</div>
</div>
<div class="paragraph">
<p>Concrete examples of build scripts and output available in the <a href="#inspecting_dependencies">Inspecting Dependencies</a>.</p>
</div>
<div class="paragraph">
<p>Running <code>gradle buildEnvironment</code> visualises the buildscript dependencies of the selected project, similarly to how <code>gradle dependencies</code> visualizes the dependencies of the software being built.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle buildEnvironment</pre>
</div>
</div>
<div class="paragraph">
<p>Running <code>gradle dependencyInsight</code> gives you an insight into a particular dependency (or dependencies) that match specified input.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle dependencyInsight</pre>
</div>
</div>
<div class="paragraph">
<p>Since a dependency report can get large, it can be useful to restrict the report to a particular configuration. This is achieved with the optional <code>--configuration</code> parameter:</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:listing_properties"><a class="anchor" href="#sec:listing_properties"></a><a class="link" href="#sec:listing_properties">Listing project properties</a></h5>
<div class="paragraph">
<p>Running <code>gradle properties</code> gives you a list of the properties of the selected project.</p>
</div>
<div class="sect5">
<h6 id="example_information_about_properties"><a class="anchor" href="#example_information_about_properties"></a><a class="link" href="#example_information_about_properties">Example: Information about properties</a></h6>
<div class="listingblock">
<div class="title">Output of <code>gradle -q api:properties</code></div>
<div class="content">
<pre>&gt; gradle -q api:properties

------------------------------------------------------------
Project :api - The shared API for the application
------------------------------------------------------------

allprojects: [project ':api']
ant: org.gradle.api.internal.project.DefaultAntBuilder@12345
antBuilderFactory: org.gradle.api.internal.project.DefaultAntBuilderFactory@12345
artifacts: org.gradle.api.internal.artifacts.dsl.DefaultArtifactHandler_Decorated@12345
asDynamicObject: DynamicObject for project ':api'
baseClassLoaderScope: org.gradle.api.internal.initialization.DefaultClassLoaderScope@12345</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="software_model_reports"><a class="anchor" href="#software_model_reports"></a><a class="link" href="#software_model_reports">Software Model reports</a></h5>
<div class="paragraph">
<p>You can get a hierarchical view of elements for <a href="#software_model">software model</a> projects using the <code>model</code> task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle model</pre>
</div>
</div>
<div class="paragraph">
<p>Learn more about <a href="#model-report">the model report</a> in the software model documentation.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_completion"><a class="anchor" href="#sec:command_line_completion"></a><a class="link" href="#sec:command_line_completion">Command-line completion</a></h4>
<div class="paragraph">
<p>Gradle provides bash and zsh tab completion support for tasks, options, and Gradle properties through <a href="https://github.com/gradle/gradle-completion">gradle-completion</a>, installed separately.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_debugging"><a class="anchor" href="#sec:command_line_debugging"></a><a class="link" href="#sec:command_line_debugging">Debugging options</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-?</code>, <code>-h</code>, <code>--help</code></dt>
<dd>
<p>Shows a help message with all available CLI options.</p>
</dd>
<dt class="hdlist1"><code>-v</code>, <code>--version</code></dt>
<dd>
<p>Prints Gradle, Groovy, Ant, JVM, and operating system version information.</p>
</dd>
<dt class="hdlist1"><code>-S</code>, <code>--full-stacktrace</code></dt>
<dd>
<p>Print out the full (very verbose) stacktrace for any exceptions. See also <a href="#sec:command_line_logging">logging options</a>.</p>
</dd>
<dt class="hdlist1"><code>-s</code>, <code>--stacktrace</code></dt>
<dd>
<p>Print out the stacktrace also for user exceptions (e.g. compile error).  See also <a href="#sec:command_line_logging">logging options</a>.</p>
</dd>
<dt class="hdlist1"><code>--scan</code></dt>
<dd>
<p>Create a <a href="https://gradle.com/build-scans">build scan</a> with fine-grained information about all aspects of your Gradle build.</p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.debug=true</code></dt>
<dd>
<p>Debug Gradle client (non-Daemon) process. Gradle will wait for you to attach a debugger at <code>localhost:5005</code> by default.</p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.daemon.debug=true</code></dt>
<dd>
<p>Debug <a href="#gradle_daemon">Gradle Daemon</a> process.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_performance"><a class="anchor" href="#sec:command_line_performance"></a><a class="link" href="#sec:command_line_performance">Performance options</a></h4>
<div class="paragraph">
<p>Try these options when optimizing build performance. Learn more about <a href="https://guides.gradle.org/performance/">improving performance of Gradle builds here</a>.</p>
</div>
<div class="paragraph">
<p>Many of these options can be specified in <code>gradle.properties</code> so command-line flags are not necessary. See the <a href="#sec:gradle_configuration_properties">configuring build environment guide</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--build-cache</code>, <code>--no-build-cache</code></dt>
<dd>
<p>Toggles the <a href="#build_cache">Gradle build cache</a>. Gradle will try to reuse outputs from previous builds. <em>Default is off</em>.</p>
</dd>
<dt class="hdlist1"><code>--configure-on-demand</code>, <code>--no-configure-on-demand</code></dt>
<dd>
<p>Toggles <a href="#sec:configuration_on_demand">Configure-on-demand</a>. Only relevant projects are configured in this build run. <em>Default is off</em>.</p>
</dd>
<dt class="hdlist1"><code>--max-workers</code></dt>
<dd>
<p>Sets maximum number of workers that Gradle may use. <em>Default is number of processors</em>.</p>
</dd>
<dt class="hdlist1"><code>--parallel</code>, <code>--no-parallel</code></dt>
<dd>
<p>Build projects in parallel. For limitations of this option, see <a href="#sec:parallel_execution">Parallel Project Execution</a>. <em>Default is off</em>.</p>
</dd>
<dt class="hdlist1"><code>--profile</code></dt>
<dd>
<p>Generates a high-level performance report in the <code>$buildDir/reports/profile</code> directory. <code>--scan</code> is preferred.</p>
</dd>
<dt class="hdlist1"><code>--scan</code></dt>
<dd>
<p>Generate a build scan with detailed performance diagnostics.</p>
</dd>
</dl>
</div>
<div class="imageblock">
<div class="content">
<img src="img/gradle-core-test-build-scan-performance.png" alt="Build Scan performance report">
</div>
</div>
<div class="sect4">
<h5 id="gradle_daemon_options"><a class="anchor" href="#gradle_daemon_options"></a><a class="link" href="#gradle_daemon_options">Gradle daemon options</a></h5>
<div class="paragraph">
<p>You can manage the <a href="#gradle_daemon">Gradle Daemon</a> through the following command line options.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--daemon</code>, <code>--no-daemon</code></dt>
<dd>
<p>Use the <a href="#gradle_daemon">Gradle Daemon</a> to run the build. Starts the daemon if not running or existing daemon busy. <em>Default is on</em>.</p>
</dd>
<dt class="hdlist1"><code>--foreground</code></dt>
<dd>
<p>Starts the Gradle Daemon in a foreground process.</p>
</dd>
<dt class="hdlist1"><code>--status</code> (Standalone command)</dt>
<dd>
<p>Run <code>gradle --status</code> to list running and recently stopped Gradle daemons. Only displays daemons of the same Gradle version.</p>
</dd>
<dt class="hdlist1"><code>--stop</code> (Standalone command)</dt>
<dd>
<p>Run <code>gradle --stop</code> to stop all Gradle Daemons of the same version.</p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.daemon.idletimeout=(number of milliseconds)</code></dt>
<dd>
<p>Gradle Daemon will stop itself after this number of milliseconds of idle time. <em>Default is 10800000</em> (3 hours).</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_logging"><a class="anchor" href="#sec:command_line_logging"></a><a class="link" href="#sec:command_line_logging">Logging options</a></h4>
<div class="sect4">
<h5 id="setting_log_level"><a class="anchor" href="#setting_log_level"></a><a class="link" href="#setting_log_level">Setting log level</a></h5>
<div class="paragraph">
<p>You can customize the verbosity of Gradle logging with the following options, ordered from least verbose to most verbose. Learn more in the <a href="#logging">logging documentation</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-Dorg.gradle.logging.level=(quiet,warn,lifecycle,info,debug)</code></dt>
<dd>
<p>Set logging level via Gradle properties.</p>
</dd>
<dt class="hdlist1"><code>-q</code>, <code>--quiet</code></dt>
<dd>
<p>Log errors only.</p>
</dd>
<dt class="hdlist1"><code>-w</code>, <code>--warn</code></dt>
<dd>
<p>Set log level to warn.</p>
</dd>
<dt class="hdlist1"><code>-i</code>, <code>--info</code></dt>
<dd>
<p>Set log level to info.</p>
</dd>
<dt class="hdlist1"><code>-d</code>, <code>--debug</code></dt>
<dd>
<p>Log in debug mode (includes normal stacktrace).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Lifecycle is the default log level.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:command_line_customizing_log_format"><a class="anchor" href="#sec:command_line_customizing_log_format"></a><a class="link" href="#sec:command_line_customizing_log_format">Customizing log format</a></h5>
<div class="paragraph">
<p>You can control the use of rich output (colors and font variants) by specifying the "console" mode in the following ways:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-Dorg.gradle.console=(auto,plain,rich,verbose)</code></dt>
<dd>
<p>Specify console mode via Gradle properties. Different modes described immediately below.</p>
</dd>
<dt class="hdlist1"><code>--console=(auto,plain,rich,verbose)</code></dt>
<dd>
<p>Specifies which type of console output to generate.</p>
<div class="paragraph">
<p>Set to <code>plain</code> to generate plain text only. This option disables all color and other rich output in the console output. This is the default when Gradle is <em>not</em> attached to a terminal.</p>
</div>
<div class="paragraph">
<p>Set to <code>auto</code> (the default) to enable color and other rich output in the console output when the build process is attached to a console, or to generate plain text only when not attached to a console. <em>This is the default when Gradle is attached to a terminal.</em></p>
</div>
<div class="paragraph">
<p>Set to <code>rich</code> to enable color and other rich output in the console output, regardless of whether the build process is not attached to a console. When not attached to a console, the build output will use ANSI control characters to generate the rich output.</p>
</div>
<div class="paragraph">
<p>Set to <code>verbose</code> to enable color and other rich output like the <code>rich</code>, but output task names and outcomes at the lifecycle log level, as is done by default in Gradle 3.5 and earlier.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="sec:command_line_warnings"><a class="anchor" href="#sec:command_line_warnings"></a><a class="link" href="#sec:command_line_warnings">Showing or hiding warnings</a></h5>
<div class="paragraph">
<p>By default, Gradle won&#8217;t display all warnings (e.g. deprecation warnings). Instead, Gradle will collect them and render a summary at the end of the build like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Deprecated Gradle features were used in this build, making it incompatible with Gradle 5.0.</pre>
</div>
</div>
<div class="paragraph">
<p>You can control the verbosity of warnings on the console with the following options:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-Dorg.gradle.warning.mode=(all,none,summary)</code></dt>
<dd>
<p>Specify warning mode via <a href="#sec:gradle_configuration_properties">Gradle properties</a>. Different modes described immediately below.</p>
</dd>
<dt class="hdlist1"><code>--warning-mode=(all,none,summary)</code></dt>
<dd>
<p>Specifies how to log warnings. Default is <code>summary</code>.</p>
<div class="paragraph">
<p>Set to <code>all</code> to log all warnings.</p>
</div>
<div class="paragraph">
<p>Set to <code>summary</code> to suppress all warnings and log a summary at the end of the build.</p>
</div>
<div class="paragraph">
<p>Set to <code>none</code> to suppress all warnings, including the summary at the end of the build.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="rich_console"><a class="anchor" href="#rich_console"></a><a class="link" href="#rich_console">Rich Console</a></h5>
<div class="paragraph">
<p>Gradle&#8217;s rich console displays extra information while builds are running.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/rich-cli.png" alt="Gradle Rich Console">
</div>
</div>
<div class="paragraph">
<p>Features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Progress bar and timer visually describe overall status</p>
</li>
<li>
<p>Parallel work-in-progress lines below describe what is happening now</p>
</li>
<li>
<p>Colors and fonts are used to highlight important output and errors</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_execution_options"><a class="anchor" href="#sec:command_line_execution_options"></a><a class="link" href="#sec:command_line_execution_options">Execution options</a></h4>
<div class="paragraph">
<p>The following options affect how builds are executed, by changing what is built or how dependencies are resolved.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--include-build</code></dt>
<dd>
<p>Run the build as a composite, including the specified build. See <a href="#composite_builds">Composite Builds</a>.</p>
</dd>
<dt class="hdlist1"><code>--offline</code></dt>
<dd>
<p>Specifies that the build should operate without accessing network resources. Learn more about <a href="#sec:controlling_dependency_caching_command_line">options to override dependency caching</a>.</p>
</dd>
<dt class="hdlist1"><code>--refresh-dependencies</code></dt>
<dd>
<p>Refresh the state of dependencies. Learn more about how to use this in the <a href="#sec:controlling_dependency_caching_command_line">dependency management docs</a>.</p>
</dd>
<dt class="hdlist1"><code>--dry-run</code></dt>
<dd>
<p>Run Gradle with all task actions disabled. Use this to show which task would have executed.</p>
</dd>
<dt class="hdlist1"><code>--write-locks</code></dt>
<dd>
<p>Indicates that all resolved configurations that are <em>lockable</em> should have their lock state persisted.
Learn more about this in <a href="#dependency_locking">dependency locking</a>.</p>
</dd>
<dt class="hdlist1"><code>--update-locks &lt;group:name&gt;[,&lt;group:name&gt;]*</code></dt>
<dd>
<p>Indicates that versions for the specified modules have to be updated in the lock file.
This flag also implies <code>--write-locks</code>.
Learn more about this in <a href="#dependency_locking">dependency locking</a>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="environment_options"><a class="anchor" href="#environment_options"></a><a class="link" href="#environment_options">Environment options</a></h4>
<div class="paragraph">
<p>You can customize many aspects about where build scripts, settings, caches, and so on through the options below. Learn more about customizing your <a href="#build_environment">build environment</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-b</code>, <code>--build-file</code></dt>
<dd>
<p>Specifies the build file. For example: <code>gradle --build-file=foo.gradle</code>. The default is <code>build.gradle</code>, then <code>build.gradle.kts</code>, then <code>myProjectName.gradle</code>.</p>
</dd>
<dt class="hdlist1"><code>-c</code>, <code>--settings-file</code></dt>
<dd>
<p>Specifies the settings file. For example: <code>gradle --settings-file=somewhere/else/settings.gradle</code></p>
</dd>
<dt class="hdlist1"><code>-g</code>, <code>--gradle-user-home</code></dt>
<dd>
<p>Specifies the Gradle user home directory. The default is the <code>.gradle</code> directory in the user&#8217;s home directory.</p>
</dd>
<dt class="hdlist1"><code>-p</code>, <code>--project-dir</code></dt>
<dd>
<p>Specifies the start directory for Gradle. Defaults to current directory.</p>
</dd>
<dt class="hdlist1"><code>--project-cache-dir</code></dt>
<dd>
<p>Specifies the project-specific cache directory. Default value is <code>.gradle</code> in the root project directory.</p>
</dd>
<dt class="hdlist1"><code>-u</code>, <code>--no-search-upward</code> (deprecated)</dt>
<dd>
<p>Don&#8217;t search in parent directories for a <code>settings.gradle</code> file.</p>
</dd>
<dt class="hdlist1"><code>-D</code>, <code>--system-prop</code></dt>
<dd>
<p>Sets a system property of the JVM, for example <code>-Dmyprop=myvalue</code>. See <a href="#sec:gradle_system_properties">System Properties</a>.</p>
</dd>
<dt class="hdlist1"><code>-I</code>, <code>--init-script</code></dt>
<dd>
<p>Specifies an initialization script. See <a href="#init_scripts">Init Scripts</a>.</p>
</dd>
<dt class="hdlist1"><code>-P</code>, <code>--project-prop</code></dt>
<dd>
<p>Sets a project property of the root project, for example <code>-Pmyprop=myvalue</code>. See <a href="#sec:project_properties">System Properties</a>.</p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.jvmargs</code></dt>
<dd>
<p>Set JVM arguments.</p>
</dd>
<dt class="hdlist1"><code>-Dorg.gradle.java.home</code></dt>
<dd>
<p>Set JDK home dir.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:command_line_bootstrapping_projects"><a class="anchor" href="#sec:command_line_bootstrapping_projects"></a><a class="link" href="#sec:command_line_bootstrapping_projects">Bootstrapping new projects</a></h4>
<div class="sect4">
<h5 id="creating_new_gradle_builds"><a class="anchor" href="#creating_new_gradle_builds"></a><a class="link" href="#creating_new_gradle_builds">Creating new Gradle builds</a></h5>
<div class="paragraph">
<p>Use the built-in <code>gradle init</code> task to create a new Gradle builds, with new or existing projects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle init</pre>
</div>
</div>
<div class="paragraph">
<p>Most of the time you&#8217;ll want to specify a project type. Available types include <code>basic</code> (default), <code>java-library</code>, <code>java-application</code>, and more. See <a href="#build_init_plugin">init plugin documentation</a> for details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle init --type java-library</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="standardize_and_provision_gradle"><a class="anchor" href="#standardize_and_provision_gradle"></a><a class="link" href="#standardize_and_provision_gradle">Standardize and provision Gradle</a></h5>
<div class="paragraph">
<p>The built-in <code>gradle wrapper</code> task generates a script, <code>gradlew</code>, that invokes a declared version of Gradle, downloading it beforehand if necessary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle wrapper --gradle-version=4.4</pre>
</div>
</div>
<div class="paragraph">
<p>You can also specify <code>--distribution-type=(bin|all)</code>, <code>--gradle-distribution-url</code>, <code>--gradle-distribution-sha256-sum</code> in addition to <code>--gradle-version</code>. Full details on how to use these options are documented in the <a href="#gradle_wrapper">Gradle wrapper section</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:continuous_build"><a class="anchor" href="#sec:continuous_build"></a><a class="link" href="#sec:continuous_build">Continuous Build</a></h4>
<div class="paragraph">
<p>Continuous Build allows you to automatically re-execute the requested tasks when task inputs change.</p>
</div>
<div class="paragraph">
<p>For example, you can continuously run the <code>test</code> task and all dependent tasks by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle test --continuous</pre>
</div>
</div>
<div class="paragraph">
<p>Gradle will behave as if you ran <code>gradle test</code> after a change to sources or tests that contribute to the requested tasks. This means that unrelated changes (such as changes to build scripts) will not trigger a rebuild. In order to incorporate build logic changes, the continuous build must be restarted manually.</p>
</div>
<div class="sect4">
<h5 id="terminating_continuous_build"><a class="anchor" href="#terminating_continuous_build"></a><a class="link" href="#terminating_continuous_build">Terminating Continuous Build</a></h5>
<div class="paragraph">
<p>If Gradle is attached to an interactive input source, such as a terminal, the continuous build can be exited by pressing <code>CTRL-D</code> (On Microsoft Windows, it is required to also press <code>ENTER</code> or <code>RETURN</code> after <code>CTRL-D</code>). If Gradle is not attached to an interactive input source (e.g. is running as part of a script), the build process must be terminated (e.g. using the <code>kill</code> command or similar). If the build is being executed via the Tooling API, the build can be cancelled using the Tooling API&#8217;s cancellation mechanism.</p>
</div>
</div>
<div class="sect4">
<h5 id="continuous_build_limitations"><a class="anchor" href="#continuous_build_limitations"></a><a class="link" href="#continuous_build_limitations">Limitations and quirks</a></h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Continuous build is an <a href="#feature_lifecycle">incubating</a> feature.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are several issues to be aware with the current implementation of continuous build. These are likely to be addressed in future Gradle releases.</p>
</div>
<div class="sect5">
<h6 id="sec:build_cycles"><a class="anchor" href="#sec:build_cycles"></a><a class="link" href="#sec:build_cycles">Build cycles</a></h6>
<div class="paragraph">
<p>Gradle starts watching for changes just before a task executes. If a task modifies its own inputs while executing, Gradle will detect the change and trigger a new build. If every time the task executes, the inputs are modified again, the build will be triggered again. This isn&#8217;t unique to continuous build. A task that modifies its own inputs will never be considered up-to-date when run "normally" without continuous build.</p>
</div>
<div class="paragraph">
<p>If your build enters a build cycle like this, you can track down the task by looking at the list of files reported changed by Gradle. After identifying the file(s) that are changed during each build, you should look for a task that has that file as an input. In some cases, it may be obvious (e.g., a Java file is compiled with <code>compileJava</code>). In other cases, you can use <code>--info</code> logging to find the task that is out-of-date due to the identified files.</p>
</div>
</div>
<div class="sect5">
<h6 id="sec:continuous_build_limitations_jdk9"><a class="anchor" href="#sec:continuous_build_limitations_jdk9"></a><a class="link" href="#sec:continuous_build_limitations_jdk9">Restrictions with Java 9</a></h6>
<div class="paragraph">
<p>Due to class access restrictions related to Java 9, Gradle cannot set some operating system specific options, which means that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On macOS, Gradle will poll for file changes every 10 seconds instead of every 2 seconds.</p>
</li>
<li>
<p>On Windows, Gradle must use individual file watches (like on Linux/Mac OS), which may cause continuous build to no longer work on very large projects.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="sec:performance_and_stability"><a class="anchor" href="#sec:performance_and_stability"></a><a class="link" href="#sec:performance_and_stability">Performance and stability</a></h6>
<div class="paragraph">
<p>The JDK file watching facility relies on inefficient file system polling on macOS (see: <a href="https://bugs.openjdk.java.net/browse/JDK-7133447">JDK-7133447</a>). This can significantly delay notification of changes on large projects with many source files.</p>
</div>
<div class="paragraph">
<p>Additionally, the watching mechanism may deadlock under <em>heavy</em> load on macOS (see: <a href="https://bugs.openjdk.java.net/browse/JDK-8079620">JDK-8079620</a>). This will manifest as Gradle appearing not to notice file changes. If you suspect this is occurring, exit continuous build and start again.</p>
</div>
<div class="paragraph">
<p>On Linux, OpenJDK&#8217;s implementation of the file watch service can sometimes miss file system events (see: <a href="https://bugs.openjdk.java.net/browse/JDK-8145981">JDK-8145981</a>).</p>
</div>
</div>
<div class="sect5">
<h6 id="sec:changes_to_symbolic_links"><a class="anchor" href="#sec:changes_to_symbolic_links"></a><a class="link" href="#sec:changes_to_symbolic_links">Changes to symbolic links</a></h6>
<div class="ulist">
<ul>
<li>
<p>Creating or removing symbolic link to files will initiate a build.</p>
</li>
<li>
<p>Modifying the target of a symbolic link will not cause a rebuild.</p>
</li>
<li>
<p>Creating or removing symbolic links to directories will not cause rebuilds.</p>
</li>
<li>
<p>Creating new files in the target directory of a symbolic link will not cause a rebuild.</p>
</li>
<li>
<p>Deleting the target directory will not cause a rebuild.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="sec:changes_to_build_logic_are_not_considered"><a class="anchor" href="#sec:changes_to_build_logic_are_not_considered"></a><a class="link" href="#sec:changes_to_build_logic_are_not_considered">Changes to build logic are not considered</a></h6>
<div class="paragraph">
<p>The current implementation does not recalculate the build model on subsequent builds. This means that changes to task configuration, or any other change to the build model, are effectively ignored.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="build_environment"><a class="anchor" href="#build_environment"></a><a class="link" href="#build_environment">Build Environment</a></h3>
<div class="paragraph lead">
<p>Gradle provides multiple mechanisms for configuring behavior of Gradle itself and specific projects. The following is a reference for using these mechanisms.</p>
</div>
<div class="paragraph">
<p>When configuring Gradle behavior you can use these methods, listed in order of highest to lowest precedence (first one wins):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#command_line_interface">Command-line flags</a> such as <code>--build-cache</code>. These have precedence over properties and environment variables.</p>
</li>
<li>
<p><a href="#sec:gradle_system_properties">System properties</a> such as <code>systemProp.http.proxyHost=somehost.org</code> stored in a <code>gradle.properties</code> file.</p>
</li>
<li>
<p><a href="#sec:gradle_configuration_properties">Gradle properties</a> such as <code>org.gradle.caching=true</code> that are typically stored in a <code>gradle.properties</code> file in a project root directory or <code>GRADLE_USER_HOME</code> environment variable.</p>
</li>
<li>
<p><a href="#sec:gradle_environment_variables">Environment variables</a> such as <code>GRADLE_OPTS</code> sourced by the environment that executes Gradle.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Aside from configuring the build environment, you can configure a given project build using <a href="#sec:project_properties">Project properties</a> such as <code>-PreleaseType=final</code>.</p>
</div>
<div class="sect3">
<h4 id="sec:gradle_configuration_properties"><a class="anchor" href="#sec:gradle_configuration_properties"></a><a class="link" href="#sec:gradle_configuration_properties">Gradle properties</a></h4>
<div class="paragraph">
<p>Gradle provides several options that make it easy to configure the Java process that will be used to execute your build. While it&#8217;s possible to configure these in your local environment via <code>GRADLE_OPTS</code> or <code>JAVA_OPTS</code>, it is useful to store certain settings like JVM memory configuration and Java home location in version control so that an entire team can work with a consistent environment.</p>
</div>
<div class="paragraph">
<p>Setting up a consistent environment for your build is as simple as placing these settings into a <code>gradle.properties</code> file. The configuration is applied in following order (if an option is configured in multiple locations the <em>last one wins</em>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>gradle.properties</code> in project root directory.</p>
</li>
<li>
<p><code>gradle.properties</code> in <code>GRADLE_USER_HOME</code> directory.</p>
</li>
<li>
<p>system properties, e.g. when <code>-Dgradle.user.home</code> is set on the command line.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following properties can be used to configure the Gradle build environment:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.gradle.caching=(true,false)</code></dt>
<dd>
<p>When set to true, Gradle will reuse task outputs from any previous build, when possible, resulting is much faster builds. Learn more about <a href="#build_cache">using the build cache</a>.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.caching.debug=(true,false)</code></dt>
<dd>
<p>When set to true, individual input property hashes and the build cache key for each task are logged on the console. Learn more about <a href="#sec:task_output_caching">task output caching</a>.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.configureondemand=(true,false)</code></dt>
<dd>
<p>Enables incubating <a href="#sec:configuration_on_demand">configuration on demand</a>, where Gradle will attempt to configure only necessary projects.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.console=(auto,plain,rich,verbose)</code></dt>
<dd>
<p>Customize console output coloring or verbosity. Default depends on how Gradle is invoked. See <a href="#sec:command_line_logging">command-line logging</a> for additional details.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.daemon=(true,false)</code></dt>
<dd>
<p>When set to <code>true</code> the <a href="#gradle_daemon">Gradle Daemon</a> is used to run the build. Default is <code>true</code>.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.daemon.idletimeout=(# of idle millis)</code></dt>
<dd>
<p>Gradle Daemon will terminate itself after specified number of idle milliseconds. Default is <code>10800000</code> (3 hours).</p>
</dd>
<dt class="hdlist1"><code>org.gradle.debug=(true,false)</code></dt>
<dd>
<p>When set to <code>true</code>, Gradle will run the build with remote debugging enabled, listening on port 5005. Note that this is the equivalent of adding <code>-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=5005</code> to the JVM command line and will suspend the virtual machine until a debugger is attached. Default is <code>false</code>.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.java.home=(path to JDK home)</code></dt>
<dd>
<p>Specifies the Java home for the Gradle build process. The value can be set to either a <code>jdk</code> or <code>jre</code> location, however, depending on what your build does, using a JDK is safer. A reasonable default is used if the setting is unspecified.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.jvmargs=(JVM arguments)</code></dt>
<dd>
<p>Specifies the JVM arguments used for the Gradle Daemon. The setting is particularly useful for <a href="#sec:configuring_jvm_memory">configuring JVM memory settings</a> for build performance.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.logging.level=(quiet,warn,lifecycle,info,debug)</code></dt>
<dd>
<p>When set to quiet, warn, lifecycle, info, or debug, Gradle will use this log level. The values are not case sensitive. The <code>lifecycle</code> level is the default. See <a href="#sec:choosing_a_log_level">Choosing a log level</a>.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.parallel=(true,false)</code></dt>
<dd>
<p>When configured, Gradle will fork up to <code>org.gradle.workers.max</code> JVMs to execute projects in parallel. To learn more about parallel task execution, see <a href="https://guides.gradle.org/performance/#parallel_execution">the Gradle performance guide</a>.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.warning.mode=(all,none,summary)</code></dt>
<dd>
<p>When set to <code>all</code>, <code>summary</code> or <code>none</code>, Gradle will use different warning type display. See <a href="#sec:command_line_logging">Command-line logging options</a> for details.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.workers.max=(max # of worker processes)</code></dt>
<dd>
<p>When configured, Gradle will use a maximum of the given number of workers. Default is number of CPU processors. See also <a href="#sec:command_line_performance">performance command-line options</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following example demonstrates usage of various properties.</p>
</div>
<div class="sect4">
<h5 id="example_setting_properties_with_a_gradle_properties_file"><a class="anchor" href="#example_setting_properties_with_a_gradle_properties_file"></a><a class="link" href="#example_setting_properties_with_a_gradle_properties_file">Example: Setting properties with a gradle.properties file</a></h5>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">gradlePropertiesProp=gradlePropertiesValue
sysProp=shouldBeOverWrittenBySysProp
systemProp.system=systemValue</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task printProps {
    doLast {
        println commandLineProjectProp
        println gradlePropertiesProp
        println systemProjectProp
        println <span class="predefined-type">System</span>.properties[<span class="string"><span class="delimiter">'</span><span class="content">system</span><span class="delimiter">'</span></span>]
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q -PcommandLineProjectProp=commandLineProjectPropValue -Dorg.gradle.project.systemProjectProp=systemPropertyValue printProps</code></div>
<div class="content">
<pre>&gt; gradle -q -PcommandLineProjectProp=commandLineProjectPropValue -Dorg.gradle.project.systemProjectProp=systemPropertyValue printProps
commandLineProjectPropValue
gradlePropertiesValue
systemPropertyValue
systemValue</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:gradle_system_properties"><a class="anchor" href="#sec:gradle_system_properties"></a><a class="link" href="#sec:gradle_system_properties">System properties</a></h4>
<div class="paragraph">
<p>Using the <code>-D</code> command-line option, you can pass a system property to the JVM which runs Gradle. The <code>-D</code> option of the <code>gradle</code> command has the same effect as the <code>-D</code> option of the <code>java</code> command.</p>
</div>
<div class="paragraph">
<p>You can also set system properties in <code>gradle.properties</code> files with the prefix <code>systemProp.</code></p>
</div>
<div class="sect4">
<h5 id="example_specifying_system_properties_in_gradle_properties"><a class="anchor" href="#example_specifying_system_properties_in_gradle_properties"></a><a class="link" href="#example_specifying_system_properties_in_gradle_properties">Example: Specifying system properties in <code>gradle.properties</code></a></h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">systemProp.gradle.wrapperUser=myuser
systemProp.gradle.wrapperPassword=mypassword</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following system properties are available. Note that command-line options take precedence over system properties.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>gradle.wrapperUser=(myuser)</code></dt>
<dd>
<p>Specify user name to download Gradle distributions from servers using HTTP Basic Authentication. Learn more in <a href="#sec:authenticated_download">Authenticated wrapper downloads</a>.</p>
</dd>
<dt class="hdlist1"><code>gradle.wrapperPassword=(mypassword)</code></dt>
<dd>
<p>Specify password for downloading a Gradle distribution using the Gradle wrapper.</p>
</dd>
<dt class="hdlist1"><code>gradle.user.home=(path to directory)</code></dt>
<dd>
<p>Specify the Gradle user home directory.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In a multi project build, <code>systemProp.</code> properties set in any project except the root will be ignored. That is, only the root project&#8217;s <code>gradle.properties</code> file will be checked for properties that begin with the <code>systemProp.</code> prefix.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:gradle_environment_variables"><a class="anchor" href="#sec:gradle_environment_variables"></a><a class="link" href="#sec:gradle_environment_variables">Environment variables</a></h4>
<div class="paragraph">
<p>The following environment variables are available for the <code>gradle</code> command. Note that command-line options and system properties take precedence over environment variables.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>GRADLE_OPTS</code></dt>
<dd>
<p>Specifies <a href="#command_line_interface">command-line arguments</a> to use when starting the Gradle client. This can be useful for setting the properties to use when running Gradle.</p>
</dd>
<dt class="hdlist1"><code>GRADLE_USER_HOME</code></dt>
<dd>
<p>Specifies the Gradle user home directory (which defaults to <code>$USER_HOME/.gradle</code> if not set).</p>
</dd>
<dt class="hdlist1"><code>JAVA_HOME</code></dt>
<dd>
<p>Specifies the JDK installation directory to use.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:project_properties"><a class="anchor" href="#sec:project_properties"></a><a class="link" href="#sec:project_properties">Project properties</a></h4>
<div class="paragraph">
<p>You can add properties directly to your <a href="../dsl/org.gradle.api.Project.html">Project</a> object via the <code>-P</code> command line option.</p>
</div>
<div class="paragraph">
<p>Gradle can also set project properties when it sees specially-named system properties or environment variables. If the environment variable name looks like <code>ORG_GRADLE_PROJECT<em>_prop</em>=somevalue</code>, then Gradle will set a <code>prop</code> property on your project object, with the value of <code>somevalue</code>. Gradle also supports this for system properties, but with a different naming pattern, which looks like <code>org.gradle.project.<em>prop</em></code>. Both of the following will set the <code>foo</code> property on your Project object to <code>"bar"</code>.</p>
</div>
<div class="sect4">
<h5 id="example_setting_a_project_property_via_gradle_properties"><a class="anchor" href="#example_setting_a_project_property_via_gradle_properties"></a><a class="link" href="#example_setting_a_project_property_via_gradle_properties">Example: Setting a project property via gradle.properties</a></h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">org.gradle.project.foo=bar</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_setting_a_project_property_via_environment_variable"><a class="anchor" href="#example_setting_a_project_property_via_environment_variable"></a><a class="link" href="#example_setting_a_project_property_via_environment_variable">Example: Setting a project property via environment variable</a></h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">ORG_GRADLE_PROJECT_foo=bar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The properties file in the user&#8217;s home directory has precedence over property files in the project directories.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This feature is very useful when you don&#8217;t have admin rights to a continuous integration server and you need to set property values that should not be easily visible. Since you cannot use the <code>-P</code> option in that scenario, nor change the system-level configuration files, the correct strategy is to change the configuration of your continuous integration build job, adding an environment variable setting that matches an expected pattern. This won&#8217;t be visible to normal users on the system.</p>
</div>
<div class="paragraph">
<p>You can access a project property in your build script simply by using its name as you would use a variable.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If a project property is referenced but does not exist, an exception will be thrown and the build will fail.</p>
</div>
<div class="paragraph">
<p>You should check for existence of optional project properties before you access them using the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:hasProperty(java.lang.String)">Project.hasProperty(java.lang.String)</a> method.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring_jvm_memory"><a class="anchor" href="#sec:configuring_jvm_memory"></a><a class="link" href="#sec:configuring_jvm_memory">Configuring JVM memory</a></h4>
<div class="paragraph">
<p>Gradle defaults to 1024 megabytes maximum heap per JVM process (<code>-Xmx1024m</code>), however, that may be too much or too little depending on the size of your project. There are many JVM options (this <a href="https://dzone.com/articles/java-performance-tuning">blog post on Java performance tuning</a> and <a href="http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html">this reference</a> may be helpful).</p>
</div>
<div class="paragraph">
<p>You can adjust JVM options for Gradle in the following ways:</p>
</div>
<div class="paragraph">
<p>The <code>JAVA_OPTS</code> environment variable is used for the Gradle client, but not forked JVMs.</p>
</div>
<div class="sect4">
<h5 id="example_changing_jvm_settings_for_gradle_client_jvm"><a class="anchor" href="#example_changing_jvm_settings_for_gradle_client_jvm"></a><a class="link" href="#example_changing_jvm_settings_for_gradle_client_jvm">Example: Changing JVM settings for Gradle client JVM</a></h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">JAVA_OPTS=&quot;-Xmx2g -XX:MaxPermSize=256m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You need to use the <code>org.gradle.jvmargs</code> Gradle property to configure JVM settings for the <a href="#gradle_daemon">Gradle Daemon</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_changing_jvm_settings_for_forked_gradle_jvms"><a class="anchor" href="#example_changing_jvm_settings_for_forked_gradle_jvms"></a><a class="link" href="#example_changing_jvm_settings_for_forked_gradle_jvms">Example: Changing JVM settings for forked Gradle JVMs</a></h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">org.gradle.jvmargs=-Xmx2g -XX:MaxPermSize=256m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Many settings (like the Java version and maximum heap size) can only be specified when launching a new JVM for the build process. This means that Gradle must launch a separate JVM process to execute the build after parsing the various <code>gradle.properties</code> files.</p>
</div>
<div class="paragraph">
<p>When running with the <a href="#gradle_daemon">Gradle Daemon</a>, a JVM with the correct parameters is started once and reused for each daemon build execution. When Gradle is executed without the daemon, then a new JVM must be launched for every build execution, unless the JVM launched by the Gradle start script happens to have the same parameters.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Certain tasks in Gradle also fork additional JVM processes, like the <code>test</code> task when using <a href="../javadoc/org/gradle/api/tasks/testing/Test.html#setMaxParallelForks-int-">Test.setMaxParallelForks(int)</a> for JUnit or TestNG tests. You must configure these through the tasks themselves.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_set_java_compile_options_for_javacompile_tasks"><a class="anchor" href="#example_set_java_compile_options_for_javacompile_tasks"></a><a class="link" href="#example_set_java_compile_options_for_javacompile_tasks">Example: Set Java compile options for <a href="../dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a> tasks</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">java</span><span class="delimiter">&quot;</span></span>

tasks.withType(JavaCompile) {
    options.compilerArgs += [<span class="string"><span class="delimiter">&quot;</span><span class="content">-Xdoclint:none</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">-Xlint:none</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">-nowarn</span><span class="delimiter">&quot;</span></span>]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See other examples in the <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a> API documentation and <a href="#sec:test_execution">test execution in the Java plugin reference</a>.</p>
</div>
<div class="paragraph">
<p><a href="https://scans.gradle.com">Build scans</a> will tell you information about the JVM that executed the build when you use the <code>--scan</code> option.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://scans.gradle.com/s/sample/cpp-parallel/infrastructure"><img src="img/build-scan-infrastructure.png" alt="Build Environment in build scan"></a>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring_task_using_project_properties"><a class="anchor" href="#sec:configuring_task_using_project_properties"></a><a class="link" href="#sec:configuring_task_using_project_properties">Configuring a task using project properties</a></h4>
<div class="paragraph">
<p>It&#8217;s possible to change the behavior of a task based on project properties specified at invocation time.</p>
</div>
<div class="paragraph">
<p>Suppose you&#8217;d like to ensure release builds are only triggered by CI. A simple way to handle this is through an <code>isCI</code> project property.</p>
</div>
<div class="sect4">
<h5 id="example_prevent_releasing_outside_of_ci"><a class="anchor" href="#example_prevent_releasing_outside_of_ci"></a><a class="link" href="#example_prevent_releasing_outside_of_ci">Example: Prevent releasing outside of CI</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task performRelease {
    doLast {
        <span class="keyword">if</span> (project.hasProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">isCI</span><span class="delimiter">&quot;</span></span>)) {
            println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Performing release actions</span><span class="delimiter">&quot;</span></span>)
        } <span class="keyword">else</span> {
            <span class="keyword">throw</span> <span class="keyword">new</span> InvalidUserDataException(<span class="string"><span class="delimiter">&quot;</span><span class="content">Cannot perform release outside of CI</span><span class="delimiter">&quot;</span></span>)
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle performRelease -PisCI=true --quiet</code></strong></div>
<div class="content">
<pre>&gt; gradle performRelease -PisCI=true --quiet
Performing release actions</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:accessing_the_web_via_a_proxy"><a class="anchor" href="#sec:accessing_the_web_via_a_proxy"></a><a class="link" href="#sec:accessing_the_web_via_a_proxy">Accessing the web through a HTTP proxy</a></h4>
<div class="paragraph">
<p>Configuring an HTTP or HTTPS proxy (for downloading dependencies, for example) is done via standard JVM system properties. These properties can be set directly in the build script; for example, setting the HTTP proxy host would be done with <code>System.setProperty('http.proxyHost', 'www.somehost.org')</code>. Alternatively, the properties can be <a href="#sec:gradle_configuration_properties">specified in gradle.properties</a>.</p>
</div>
<div class="listingblock">
<div class="title">Configuring an HTTP proxy using <code>gradle.properties</code></div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">systemProp.http.proxyHost=www.somehost.org
systemProp.http.proxyPort=8080
systemProp.http.proxyUser=userid
systemProp.http.proxyPassword=password
systemProp.http.nonProxyHosts=*.nonproxyrepos.com|localhost</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are separate settings for HTTPS.</p>
</div>
<div class="listingblock">
<div class="title">Configuring an HTTPS proxy using <code>gradle.properties</code></div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">systemProp.https.proxyHost=www.somehost.org
systemProp.https.proxyPort=8080
systemProp.https.proxyUser=userid
systemProp.https.proxyPassword=password
systemProp.https.nonProxyHosts=*.nonproxyrepos.com|localhost</code></pre>
</div>
</div>
<div class="paragraph">
<p>You may need to set other properties to access other networks. Here are 2 references that may be helpful:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://git-wip-us.apache.org/repos/asf?p=ant.git;a=blob;f=src/main/org/apache/tools/ant/util/ProxySetup.java;hb=HEAD">ProxySetup.java in the Ant codebase</a></p>
</li>
<li>
<p><a href="http://download.oracle.com/javase/7/docs/technotes/guides/net/properties.html">JDK 7 Networking Properties</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="ntlm_authentication"><a class="anchor" href="#ntlm_authentication"></a><a class="link" href="#ntlm_authentication">NTLM Authentication</a></h5>
<div class="paragraph">
<p>If your proxy requires NTLM authentication, you may need to provide the authentication domain as well as the username and password. There are 2 ways that you can provide the domain for authenticating to a NTLM proxy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the <code>http.proxyUser</code> system property to a value like <code><em>domain</em>/<em>username</em></code>.</p>
</li>
<li>
<p>Provide the authentication domain via the <code>http.auth.ntlm.domain</code> system property.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="directory_layout"><a class="anchor" href="#directory_layout"></a><a class="link" href="#directory_layout">Directory Layout</a></h3>
<div class="paragraph">
<p>Gradle uses two main directories to perform and manage its work: the <a href="#dir:gradle_user_home">Gradle user home directory</a> and the <a href="#dir:project_root">Project root directory</a>. The following two sections describe what is stored in each of them and how transient files and directories are cleaned up.</p>
</div>
<div class="sect3">
<h4 id="dir:gradle_user_home"><a class="anchor" href="#dir:gradle_user_home"></a><a class="link" href="#dir:gradle_user_home">Gradle user home directory</a></h4>
<div class="paragraph">
<p>The Gradle user home directory (<code>$USER_HOME/.gradle</code> by default) is used to store global configuration properties and initialization scripts as well as caches and log files. It is roughly structured as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> caches <b class="conum">(1)</b>
  4.8 <b class="conum">(2)</b>
  4.9 <b class="conum">(2)</b>
  
  jars-3 <b class="conum">(3)</b>
  modules-2 <b class="conum">(3)</b>
 daemon <b class="conum">(4)</b>
  
  4.8
  4.9
 init.d <b class="conum">(5)</b>
  my-setup.gradle
 wrapper
    dists <b class="conum">(6)</b>
        
        gradle-4.8-bin
        gradle-4.9-all
        gradle-4.9-bin
 gradle.properties <b class="conum">(7)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Global cache directory (for everything that&#8217;s not project-specific)</p>
</li>
<li>
<p>Version-specific caches (e.g. to support incremental builds)</p>
</li>
<li>
<p>Shared caches (e.g. for artifacts of dependencies)</p>
</li>
<li>
<p>Registry and logs of the <a href="#gradle_daemon">Gradle Daemon</a></p>
</li>
<li>
<p>Global <a href="#init_scripts">initialization scripts</a></p>
</li>
<li>
<p>Distributions downloaded by the <a href="#gradle_wrapper">Gradle Wrapper</a></p>
</li>
<li>
<p>Global <a href="#sec:gradle_configuration_properties">Gradle configuration properties</a></p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="dir:gradle_user_home:cache_cleanup"><a class="anchor" href="#dir:gradle_user_home:cache_cleanup"></a><a class="link" href="#dir:gradle_user_home:cache_cleanup">Cleanup of caches and distributions</a></h5>
<div class="paragraph">
<p>From version 4.10 onwards, Gradle automatically cleans its user home directory. The cleanup runs in the background when the Gradle daemon is stopped or shuts down. If using <code>--no-daemon</code>, it runs in the foreground after the build session with a visual progress indicator.</p>
</div>
<div class="paragraph">
<p>The following cleanup strategies are applied periodically (at most every 24 hours):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Version-specific caches in <code>caches/&lt;gradle-version&gt;/</code> are checked for whether they are still in use. If not, directories for release versions are deleted after 30 days of inactivity, snapshot versions after 7 days of inactivity.</p>
</li>
<li>
<p>Shared caches in <code>caches/</code> (e.g. <code>jars-*</code>) are checked for whether they are still in use. If there&#8217;s no Gradle version that still uses them, they are deleted.</p>
</li>
<li>
<p>Files in shared caches used by the current Gradle version in <code>caches/</code> (e.g. <code>jars-3</code> or <code>modules-2</code>) are checked for when they were last accessed. Depending on whether the file can be recreated locally or would have to be downloaded from a remote repository again, it will be deleted after 7 or 30 days of not being accessed, respectively.</p>
</li>
<li>
<p>Gradle distributions in <code>wrapper/dists/</code> are checked for whether they are still in use, i.e. whether there&#8217;s a corresponding version-specific cache directory. Unused distributions are deleted.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dir:project_root"><a class="anchor" href="#dir:project_root"></a><a class="link" href="#dir:project_root">Project root directory</a></h4>
<div class="paragraph">
<p>The project root directory contains all source files that are part of your project. In addition, it contains files and directories that are generated by Gradle such as <code>.gradle</code> and <code>build</code>. While the former are usually checked in to source control, the latter are transient files used by Gradle to support features like incremental builds. Overall, the anatomy of a typical project root directory looks roughly as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> .gradle <b class="conum">(1)</b>
  4.8 <b class="conum">(2)</b>
  4.9 <b class="conum">(2)</b>
  
 build <b class="conum">(3)</b>
 gradle
  wrapper  <b class="conum">(4)</b>
 build.gradle <em>or</em> build.gradle.kts <b class="conum">(5)</b>
 gradle.properties <b class="conum">(6)</b>
 gradlew <b class="conum">(7)</b>
 gradlew.bat <b class="conum">(7)</b>
 settings.gradle <em>or</em> settings.gradle.kts <b class="conum">(8)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Project-specific cache directory generated by Gradle</p>
</li>
<li>
<p>Version-specific caches (e.g. to support incremental builds)</p>
</li>
<li>
<p>The build directory of this project into which Gradle generates all build artifacts.</p>
</li>
<li>
<p>Contains the JAR file and configuration of the <a href="#gradle_wrapper">Gradle Wrapper</a></p>
</li>
<li>
<p>The project&#8217;s Gradle build script</p>
</li>
<li>
<p>Project-specific <a href="#sec:gradle_configuration_properties">Gradle configuration properties</a></p>
</li>
<li>
<p>Scripts for executing builds using the <a href="#gradle_wrapper">Gradle Wrapper</a></p>
</li>
<li>
<p>The project&#8217;s <a href="#sec:settings_file">settings file</a></p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="dir:project_root:cache_cleanup"><a class="anchor" href="#dir:project_root:cache_cleanup"></a><a class="link" href="#dir:project_root:cache_cleanup">Project cache cleanup</a></h5>
<div class="paragraph">
<p>From version 4.10 onwards, Gradle automatically cleans the project-specific cache directory. After building the project, version-specific cache directories in <code>.gradle/&lt;gradle-version&gt;/</code> are checked periodically (at most every 24 hours) for whether they are still in use. They are deleted if they haven&#8217;t been used for 7 days.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="gradle_daemon"><a class="anchor" href="#gradle_daemon"></a><a class="link" href="#gradle_daemon">The Gradle Daemon</a></h3>
<div class="quoteblock">
<blockquote>
A daemon is a computer program that runs as a background process, rather than being under the direct control of an interactive user.
</blockquote>
<div class="attribution">
&#8212; Wikipedia
</div>
</div>
<div class="paragraph">
<p>Gradle runs on the Java Virtual Machine (JVM) and uses several supporting libraries that require a non-trivial initialization time. As a result, it can sometimes seem a little slow to start. The solution to this problem is the Gradle <em>Daemon</em>: a long-lived background process that executes your builds much more quickly than would otherwise be the case. We accomplish this by avoiding the expensive bootstrapping process as well as leveraging caching, by keeping data about your project in memory. Running Gradle builds with the Daemon is no different than without. Simply configure whether you want to use it or not - everything else is handled transparently by Gradle.</p>
</div>
<div class="sect3">
<h4 id="sec:why_the_daemon"><a class="anchor" href="#sec:why_the_daemon"></a><a class="link" href="#sec:why_the_daemon">Why the Gradle Daemon is important for performance</a></h4>
<div class="paragraph">
<p>The Daemon is a long-lived process, so not only are we able to avoid the cost of JVM startup for every build, but we are able to cache information about project structure, files, tasks, and more in memory.</p>
</div>
<div class="paragraph">
<p>The reasoning is simple: improve build speed by reusing computations from previous builds. However, the benefits are dramatic: we typically measure build times reduced by 15-75% on subsequent builds. We recommend profiling your build by using <code>--profile</code> to get a sense of how much impact the Gradle Daemon can have for you.</p>
</div>
<div class="paragraph">
<p>The Gradle Daemon is enabled by default starting with Gradle 3.0, so you don&#8217;t have to do anything to benefit from it.</p>
</div>
<div class="paragraph">
<p>If you run CI builds in ephemeral environments (such as containers) that do not reuse any processes, use of the Daemon will slightly decrease performance (due to caching additional information) for no benefit, and may be disabled.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:status"><a class="anchor" href="#sec:status"></a><a class="link" href="#sec:status">Running Daemon Status</a></h4>
<div class="paragraph">
<p>To get a list of running Gradle Daemons and their statuses use the <code>--status</code> command.</p>
</div>
<div class="paragraph">
<p>Sample output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>    PID VERSION                 STATUS
  28411 3.0                     IDLE
  34247 3.0                     BUSY</code></pre>
</div>
</div>
<div class="paragraph">
<p>Currently, a given Gradle version can only connect to daemons of the same version. This means the status output will only show Daemons for the version of Gradle being invoked and not for any other versions. Future versions of Gradle will lift this constraint and will show the running Daemons for all versions of Gradle.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:disabling_the_daemon"><a class="anchor" href="#sec:disabling_the_daemon"></a><a class="link" href="#sec:disabling_the_daemon">Disabling the Daemon</a></h4>
<div class="paragraph">
<p>The Gradle Daemon is enabled by default, and we recommend always enabling it. There are several ways to disable the Daemon, but the most common one is to add the line</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>org.gradle.daemon=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>to the file <code>USER_HOME/.gradle/gradle.properties</code>, where <code>USER_HOME</code> is your home directory. Thats typically one of the following, depending on your platform:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>C:\Users\&lt;username&gt;</code> (Windows Vista &amp; 7+)</p>
</li>
<li>
<p><code>/Users/&lt;username&gt;</code> (macOS)</p>
</li>
<li>
<p><code>/home/&lt;username&gt;</code> (Linux)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If that file doesnt exist, just create it using a text editor. You can find details of other ways to disable (and enable) the Daemon in <a href="#daemon_faq">Daemon FAQ</a> further down. That section also contains more detailed information on how the Daemon works.</p>
</div>
<div class="paragraph">
<p>Note that having the Daemon enabled, all your builds will take advantage of the speed boost, regardless of the version of Gradle a particular build uses.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">Continuous integration</div>
<div class="paragraph">
<p>Since Gradle 3.0, we enable Daemon by default and recommend using it for both developers' machines and Continuous Integration servers. However, if you suspect that Daemon makes your CI builds unstable, you can disable it to use a fresh runtime for each build since the runtime is <em>completely</em> isolated from any previous builds.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:stopping_an_existing_daemon"><a class="anchor" href="#sec:stopping_an_existing_daemon"></a><a class="link" href="#sec:stopping_an_existing_daemon">Stopping an existing Daemon</a></h4>
<div class="paragraph">
<p>As mentioned, the Daemon is a background process. You neednt worry about a build up of Gradle processes on your machine, though. Every Daemon monitors its memory usage compared to total system memory and will stop itself if idle when available system memory is low. If you want to explicitly stop running Daemon processes for any reason, just use the command <code>gradle --stop</code>.</p>
</div>
<div class="paragraph">
<p>This will terminate all Daemon processes that were started with the same version of Gradle used to execute the command. If you have the Java Development Kit (JDK) installed, you can easily verify that a Daemon has stopped by running the <code>jps</code> command. Youll see any running Daemons listed with the name <code>GradleDaemon</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="daemon_faq"><a class="anchor" href="#daemon_faq"></a><a class="link" href="#daemon_faq">FAQ</a></h4>
<div class="sect4">
<h5 id="sec:ways_to_disable_gradle_daemon"><a class="anchor" href="#sec:ways_to_disable_gradle_daemon"></a><a class="link" href="#sec:ways_to_disable_gradle_daemon">How do I disable the Gradle Daemon?</a></h5>
<div class="paragraph">
<p>There are two recommended ways to disable the Daemon persistently for an environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Via environment variables: add the flag <code>-Dorg.gradle.daemon=false</code> to the <code>GRADLE_OPTS</code> environment variable</p>
</li>
<li>
<p>Via properties file: add <code>org.gradle.daemon=false</code> to the <code>GRADLE_USER_HOME/gradle.properties</code> file</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Note, <code>GRADLE_USER_HOME</code> defaults to <code>USER_HOME/.gradle</code>, where <code>USER_HOME</code> is the home directory of the current user. This location can be configured via the <code>-g</code> and <code>--gradle-user-home</code> command line switches, as well as by the <code>GRADLE_USER_HOME</code> environment variable and <code>org.gradle.user.home</code> JVM system property.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Both approaches have the same effect. Which one to use is up to personal preference. Most Gradle users choose the second option and add the entry to the user <code>gradle.properties</code> file.</p>
</div>
<div class="paragraph">
<p>On Windows, this command will disable the Daemon for the current user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>(if not exist "%USERPROFILE%/.gradle" mkdir "%USERPROFILE%/.gradle") &amp;&amp; (echo. &gt;&gt; "%USERPROFILE%/.gradle/gradle.properties" &amp;&amp; echo org.gradle.daemon=false &gt;&gt; "%USERPROFILE%/.gradle/gradle.properties")</code></pre>
</div>
</div>
<div class="paragraph">
<p>On UNIX-like operating systems, the following Bash shell command will disable the Daemon for the current user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">mkdir -p ~/.gradle &amp;&amp; echo &quot;org.gradle.daemon=false&quot; &gt;&gt; ~/.gradle/gradle.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the Daemon is disabled for a build environment in this way, a Gradle Daemon will not be started unless explicitly requested using the <code>--daemon</code> option.</p>
</div>
<div class="paragraph">
<p>The <code>--daemon</code> and <code>--no-daemon</code> command line options enable and disable usage of the Daemon for individual build invocations when using the Gradle command line interface. These command line options have the <em>highest</em> precedence when considering the build environment. Typically, it is more convenient to enable the Daemon for an environment (e.g. a user account) so that all builds use the Daemon without requiring to remember to supply the <code>--daemon</code> option.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:why_is_there_more_than_one_daemon_process_on_my_machine"><a class="anchor" href="#sec:why_is_there_more_than_one_daemon_process_on_my_machine"></a><a class="link" href="#sec:why_is_there_more_than_one_daemon_process_on_my_machine">Why is there more than one Daemon process on my machine?</a></h5>
<div class="paragraph">
<p>There are several reasons why Gradle will create a new Daemon, instead of using one that is already running. The basic rule is that Gradle will start a new Daemon if there are no existing idle or compatible Daemons available. Gradle will kill any Daemon that has been idle for 3 hours or more, so you don&#8217;t have to worry about cleaning them up manually.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">idle</dt>
<dd>
<p>An idle Daemon is one that is not currently executing a build or doing other useful work.</p>
</dd>
<dt class="hdlist1">compatible</dt>
<dd>
<p>A compatible Daemon is one that can (or can be made to) meet the requirements of the requested build environment. The Java runtime used to execute the build is an example aspect of the build environment. Another example is the set of JVM system properties required by the build runtime.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Some aspects of the requested build environment may not be met by an Daemon. If the Daemon is running with a Java 7 runtime, but the requested environment calls for Java 8, then the Daemon is not compatible and another must be started. Moreover, certain properties of a Java runtime cannot be changed once the JVM has started. For example, it is not possible to change the memory allocation (e.g. <code>-Xmx1024m</code>), default text encoding, default locale, etc of a running JVM.</p>
</div>
<div class="paragraph">
<p>The requested build environment is typically constructed implicitly from aspects of the build clients (e.g. Gradle command line client, IDE etc.) environment and explicitly via command line switches and settings. See <a href="#build_environment">Build Environment</a> for details on how to specify and control the build environment.</p>
</div>
<div class="paragraph">
<p>The following JVM system properties are effectively immutable. If the requested build environment requires any of these properties, with a different value than a Daemons JVM has for this property, the Daemon is not compatible.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>file.encoding</p>
</li>
<li>
<p>user.language</p>
</li>
<li>
<p>user.country</p>
</li>
<li>
<p>user.variant</p>
</li>
<li>
<p>java.io.tmpdir</p>
</li>
<li>
<p>javax.net.ssl.keyStore</p>
</li>
<li>
<p>javax.net.ssl.keyStorePassword</p>
</li>
<li>
<p>javax.net.ssl.keyStoreType</p>
</li>
<li>
<p>javax.net.ssl.trustStore</p>
</li>
<li>
<p>javax.net.ssl.trustStorePassword</p>
</li>
<li>
<p>javax.net.ssl.trustStoreType</p>
</li>
<li>
<p>com.sun.management.jmxremote</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following JVM attributes, controlled by startup arguments, are also effectively immutable. The corresponding attributes of the requested build environment and the Daemons environment must match exactly in order for a Daemon to be compatible.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The maximum heap size (i.e. the -Xmx JVM argument)</p>
</li>
<li>
<p>The minimum heap size (i.e. the -Xms JVM argument)</p>
</li>
<li>
<p>The boot classpath (i.e. the -Xbootclasspath argument)</p>
</li>
<li>
<p>The assertion status (i.e. the -ea argument)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The required Gradle version is another aspect of the requested build environment. Daemon processes are coupled to a specific Gradle runtime. Working on multiple Gradle projects during a session that use different Gradle versions is a common reason for having more than one running Daemon process.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:how_much_memory_does_the_daemon_use_and_can_i_give_it_more"><a class="anchor" href="#sec:how_much_memory_does_the_daemon_use_and_can_i_give_it_more"></a><a class="link" href="#sec:how_much_memory_does_the_daemon_use_and_can_i_give_it_more">How much memory does the Daemon use and can I give it more?</a></h5>
<div class="paragraph">
<p>If the requested build environment does not specify a maximum heap size, the Daemon will use up to 1GB of heap. It will use the JVM&#8217;s default minimum heap size. 1GB is more than enough for most builds. Larger builds with hundreds of subprojects, lots of configuration, and source code may require, or perform better, with more memory.</p>
</div>
<div class="paragraph">
<p>To increase the amount of memory the Daemon can use, specify the appropriate flags as part of the requested build environment. Please see <a href="#build_environment">Build Environment</a> for details.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:how_can_i_stop_a_daemon"><a class="anchor" href="#sec:how_can_i_stop_a_daemon"></a><a class="link" href="#sec:how_can_i_stop_a_daemon">How can I stop a Daemon?</a></h5>
<div class="paragraph">
<p>Daemon processes will automatically terminate themselves after 3 hours of inactivity or less. If you wish to stop a Daemon process before this, you can either kill the process via your operating system or run the <code>gradle --stop</code> command. The <code>--stop</code> switch causes Gradle to request that <em>all</em> running Daemon processes, <em>of the same Gradle version used to run the command</em>, terminate themselves.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:what_can_go_wrong_with_daemon"><a class="anchor" href="#sec:what_can_go_wrong_with_daemon"></a><a class="link" href="#sec:what_can_go_wrong_with_daemon">What can go wrong with Daemon?</a></h5>
<div class="paragraph">
<p>Considerable engineering effort has gone into making the Daemon robust, transparent and unobtrusive during day to day development. However, Daemon processes can occasionally be corrupted or exhausted. A Gradle build executes arbitrary code from multiple sources. While Gradle itself is designed for and heavily tested with the Daemon, user build scripts and third party plugins can destabilize the Daemon process through defects such as memory leaks or global state corruption.</p>
</div>
<div class="paragraph">
<p>It is also possible to destabilize the Daemon (and build environment in general) by running builds that do not release resources correctly. This is a particularly poignant problem when using Microsoft Windows as it is less forgiving of programs that fail to close files after reading or writing.</p>
</div>
<div class="paragraph">
<p>Gradle actively monitors heap usage and attempts to detect when a leak is starting to exhaust the available heap space in the daemon. When it detects a problem, the Gradle daemon will finish the currently running build and proactively restart the daemon on the next build. This monitoring is enabled by default, but can be disabled by setting the <code>org.gradle.daemon.performance.enable-monitoring</code> system property to false.</p>
</div>
<div class="paragraph">
<p>If it is suspected that the Daemon process has become unstable, it can simply be killed. Recall that the <code>--no-daemon</code> switch can be specified for a build to prevent use of the Daemon. This can be useful to diagnose whether or not the Daemon is actually the culprit of a problem.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:tools_and_ides"><a class="anchor" href="#sec:tools_and_ides"></a><a class="link" href="#sec:tools_and_ides">Tools &amp; IDEs</a></h4>
<div class="paragraph">
<p>The <a href="#embedding">Gradle Tooling API</a> that is used by IDEs and other tools to integrate with Gradle <em>always</em> uses the Gradle Daemon to execute builds. If you are executing Gradle builds from within your IDE you are using the Gradle Daemon and do not need to enable it for your environment.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:how_does_the_gradle_daemon_make_builds_faster"><a class="anchor" href="#sec:how_does_the_gradle_daemon_make_builds_faster"></a><a class="link" href="#sec:how_does_the_gradle_daemon_make_builds_faster">How does the Gradle Daemon make builds faster?</a></h4>
<div class="paragraph">
<p>The Gradle Daemon is a <em>long lived</em> build process. In between builds it waits idly for the next build. This has the obvious benefit of only requiring Gradle to be loaded into memory once for multiple builds, as opposed to once for each build. This in itself is a significant performance optimization, but that&#8217;s not where it stops.</p>
</div>
<div class="paragraph">
<p>A significant part of the story for modern JVM performance is runtime code optimization. For example, HotSpot (the JVM implementation provided by Oracle and used as the basis of OpenJDK) applies optimization to code while it is running. The optimization is progressive and not instantaneous. That is, the code is progressively optimized during execution which means that subsequent builds can be faster purely due to this optimization process. Experiments with HotSpot have shown that it takes somewhere between 5 and 10 builds for optimization to stabilize. The difference in perceived build time between the first build and the 10th for a Daemon can be quite dramatic.</p>
</div>
<div class="paragraph">
<p>The Daemon also allows more effective in memory caching across builds. For example, the classes needed by the build (e.g. plugins, build scripts) can be held in memory between builds. Similarly, Gradle can maintain in-memory caches of build data such as the hashes of task inputs and outputs, used for incremental building.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="init_scripts"><a class="anchor" href="#init_scripts"></a><a class="link" href="#init_scripts">Initialization Scripts</a></h3>
<div class="paragraph">
<p>Gradle provides a powerful mechanism to allow customizing the build based on the current environment. This mechanism also supports tools that wish to integrate with Gradle.</p>
</div>
<div class="paragraph">
<p>Note that this is completely different from the <code>init</code> task provided by the <code>build-init</code> incubating plugin (see <a href="#build_init_plugin">Build Init Plugin</a>).</p>
</div>
<div class="sect3">
<h4 id="sec:basic_usage"><a class="anchor" href="#sec:basic_usage"></a><a class="link" href="#sec:basic_usage">Basic usage</a></h4>
<div class="paragraph">
<p>Initialization scripts (a.k.a. <em>init scripts</em>) are similar to other scripts in Gradle. These scripts, however, are run before the build starts. Here are several possible uses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set up enterprise-wide configuration, such as where to find custom plugins.</p>
</li>
<li>
<p>Set up properties based on the current environment, such as a developer&#8217;s machine vs. a continuous integration server.</p>
</li>
<li>
<p>Supply personal information about the user that is required by the build, such as repository or database authentication credentials.</p>
</li>
<li>
<p>Define machine specific details, such as where JDKs are installed.</p>
</li>
<li>
<p>Register build listeners. External tools that wish to listen to Gradle events might find this useful.</p>
</li>
<li>
<p>Register build loggers. You might wish to customize how Gradle logs the events that it generates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>One main limitation of init scripts is that they cannot access classes in the <code>buildSrc</code> project (see <a href="#sec:build_sources">Using buildSrc to extract imperative logic</a> for details of this feature).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:using_an_init_script"><a class="anchor" href="#sec:using_an_init_script"></a><a class="link" href="#sec:using_an_init_script">Using an init script</a></h4>
<div class="paragraph">
<p>There are several ways to use an init script:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify a file on the command line. The command line option is <code>-I</code> or <code>--init-script</code> followed by the path to the script. The command line option can appear more than once, each time adding another init script. The build will fail if any of the files specified on the command line does not exist.</p>
</li>
<li>
<p>Put a file called <code>init.gradle</code> in the <code><em>USER_HOME</em>/.gradle/</code> directory.</p>
</li>
<li>
<p>Put a file that ends with <code>.gradle</code> in the <code><em>USER_HOME</em>/.gradle/init.d/</code> directory.</p>
</li>
<li>
<p>Put a file that ends with <code>.gradle</code> in the <code><em>GRADLE_HOME</em>/init.d/</code> directory, in the Gradle distribution. This allows you to package up a custom Gradle distribution containing some custom build logic and plugins. You can combine this with the <a href="#gradle_wrapper">Gradle wrapper</a> as a way to make custom logic available to all builds in your enterprise.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If more than one init script is found they will all be executed, in the order specified above. Scripts in a given directory are executed in alphabetical order. This allows, for example, a tool to specify an init script on the command line and the user to put one in their home directory for defining the environment and both scripts will run when Gradle is executed.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:writing_an_init_script"><a class="anchor" href="#sec:writing_an_init_script"></a><a class="link" href="#sec:writing_an_init_script">Writing an init script</a></h4>
<div class="paragraph">
<p>Similar to a Gradle build script, an init script is a Groovy script. Each init script has a <a href="../dsl/org.gradle.api.invocation.Gradle.html">Gradle</a> instance associated with it. Any property reference and method call in the init script will delegate to this <code>Gradle</code> instance.</p>
</div>
<div class="paragraph">
<p>Each init script also implements the <a href="../dsl/org.gradle.api.Script.html">Script</a> interface.</p>
</div>
<div class="sect4">
<h5 id="sec:configuring_projects_from_an_init_script"><a class="anchor" href="#sec:configuring_projects_from_an_init_script"></a><a class="link" href="#sec:configuring_projects_from_an_init_script">Configuring projects from an init script</a></h5>
<div class="paragraph">
<p>You can use an init script to configure the projects in the build. This works in a similar way to configuring projects in a multi-project build. The following sample shows how to perform extra configuration from an init script <em>before</em> the projects are evaluated. This sample uses this feature to configure an extra repository to be used only for certain environments.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_init_script_to_perform_extra_configuration_before_projects_are_evaluated"><a class="anchor" href="#example_using_init_script_to_perform_extra_configuration_before_projects_are_evaluated"></a><a class="link" href="#example_using_init_script_to_perform_extra_configuration_before_projects_are_evaluated">Example: Using init script to perform extra configuration before projects are evaluated</a></h5>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    mavenCentral()
}

task showRepos {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">All repos:</span><span class="delimiter">&quot;</span></span>
        println repositories.collect { <span class="local-variable">it</span>.name }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">init.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">allprojects {
    repositories {
        mavenLocal()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle --init-script init.gradle -q showRepos</code></div>
<div class="content">
<pre>&gt; gradle --init-script init.gradle -q showRepos
All repos:
[MavenLocal, MavenRepo]</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:custom_classpath"><a class="anchor" href="#sec:custom_classpath"></a><a class="link" href="#sec:custom_classpath">External dependencies for the init script</a></h4>
<div class="paragraph">
<p>In <a href="#sec:build_script_external_dependencies">External dependencies for the build script</a> it was explained how to add external dependencies to a build script. Init scripts can also declare dependencies. You do this with the <code>initscript()</code> method, passing in a closure which declares the init script classpath.</p>
</div>
<div class="sect4">
<h5 id="example_declaring_external_dependencies_for_an_init_script"><a class="anchor" href="#example_declaring_external_dependencies_for_an_init_script"></a><a class="link" href="#example_declaring_external_dependencies_for_an_init_script">Example: Declaring external dependencies for an init script</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">init.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">initscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.apache.commons</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">commons-math</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">2.0</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The closure passed to the <code>initscript()</code> method configures a <a href="../javadoc/org/gradle/api/initialization/dsl/ScriptHandler.html">ScriptHandler</a> instance. You declare the init script classpath by adding dependencies to the <code>classpath</code> configuration. This is the same way you declare, for example, the Java compilation classpath. You can use any of the dependency types described in <a href="#declaring_dependencies">Declaring Dependencies</a>, except project dependencies.</p>
</div>
<div class="paragraph">
<p>Having declared the init script classpath, you can use the classes in your init script as you would any other classes on the classpath. The following example adds to the previous example, and uses classes from the init script classpath.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_an_init_script_with_external_dependencies"><a class="anchor" href="#example_an_init_script_with_external_dependencies"></a><a class="link" href="#example_an_init_script_with_external_dependencies">Example: An init script with external dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">init.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.apache.commons.math.fraction.Fraction</span>

initscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.apache.commons</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">commons-math</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">2.0</span><span class="delimiter">'</span></span>
    }
}

println Fraction.ONE_FIFTH.multiply(<span class="integer">2</span>)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle --init-script init.gradle -q doNothing</code></strong></div>
<div class="content">
<pre>&gt; gradle --init-script init.gradle -q doNothing
2 / 5</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:init_script_plugins"><a class="anchor" href="#sec:init_script_plugins"></a><a class="link" href="#sec:init_script_plugins">Init script plugins</a></h4>
<div class="paragraph">
<p>Similar to a Gradle build script or a Gradle settings file, plugins can be applied on init scripts.</p>
</div>
<div class="sect4">
<h5 id="example_using_plugins_in_init_scripts"><a class="anchor" href="#example_using_plugins_in_init_scripts"></a><a class="link" href="#example_using_plugins_in_init_scripts">Example: Using plugins in init scripts</a></h5>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">init.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>:EnterpriseRepositoryPlugin

<span class="type">class</span> <span class="class">EnterpriseRepositoryPlugin</span> <span class="directive">implements</span> Plugin&lt;Gradle&gt; {

    <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">String</span> ENTERPRISE_REPOSITORY_URL = <span class="string"><span class="delimiter">&quot;</span><span class="content">https://repo.gradle.org/gradle/repo</span><span class="delimiter">&quot;</span></span>

    <span class="type">void</span> apply(Gradle gradle) {
        <span class="comment">// ONLY USE ENTERPRISE REPO FOR DEPENDENCIES</span>
        gradle.allprojects{ project -&gt;
            project.repositories {

                <span class="comment">// Remove all repositories not pointing to the enterprise repository url</span>
                all { ArtifactRepository repo -&gt;
                    <span class="keyword">if</span> (!(repo <span class="keyword">instanceof</span> MavenArtifactRepository) ||
                          repo.url.toString() != ENTERPRISE_REPOSITORY_URL) {
                        project.logger.lifecycle <span class="string"><span class="delimiter">&quot;</span><span class="content">Repository </span><span class="inline"><span class="inline-delimiter">${</span>repo.url<span class="inline-delimiter">}</span></span><span class="content"> removed. Only </span><span class="inline"><span class="inline-delimiter">$</span>ENTERPRISE_REPOSITORY_URL</span><span class="content"> is allowed</span><span class="delimiter">&quot;</span></span>
                        remove repo
                    }
                }

                <span class="comment">// add the enterprise repository</span>
                maven {
                    name <span class="string"><span class="delimiter">&quot;</span><span class="content">STANDARD_ENTERPRISE_REPO</span><span class="delimiter">&quot;</span></span>
                    url ENTERPRISE_REPOSITORY_URL
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories{
    mavenCentral()
}

 task showRepositories {
     doLast {
         repositories.each {
             println <span class="string"><span class="delimiter">&quot;</span><span class="content">repository: </span><span class="inline"><span class="inline-delimiter">${</span><span class="local-variable">it</span>.name<span class="inline-delimiter">}</span></span><span class="content"> ('</span><span class="inline"><span class="inline-delimiter">${</span><span class="local-variable">it</span>.url<span class="inline-delimiter">}</span></span><span class="content">')</span><span class="delimiter">&quot;</span></span>
         }
     }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle --init-script init.gradle -q showRepositories</code></div>
<div class="content">
<pre>&gt; gradle --init-script init.gradle -q showRepositories
repository: STANDARD_ENTERPRISE_REPO ('https://repo.gradle.org/gradle/repo')</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The plugin in the init script ensures that only a specified repository is used when running the build.</p>
</div>
<div class="paragraph">
<p>When applying plugins within the init script, Gradle instantiates the plugin and calls the plugin instance&#8217;s <a href="../javadoc/org/gradle/api/Plugin.html#apply-T-">Plugin.apply(T)</a> method. The <code>gradle</code> object is passed as a parameter, which can be used to configure all aspects of a build. Of course, the applied plugin can be resolved as an external dependency as described in <a href="#sec:custom_classpath">External dependencies for the init script</a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="intro_multi_project_builds"><a class="anchor" href="#intro_multi_project_builds"></a><a class="link" href="#intro_multi_project_builds">Executing Multi-Project Builds</a></h3>
<div class="paragraph">
<p>Only the smallest of projects has a single build file and source tree, unless it happens to be a massive, monolithic application. Its often much easier to digest and understand a project that has been split into smaller, inter-dependent modules. The word inter-dependent is important, though, and is why you typically want to link the modules together through a single build.</p>
</div>
<div class="paragraph">
<p>Gradle supports this scenario through <em>multi-project</em> builds.</p>
</div>
<div class="sect3">
<h4 id="sec:structure_of_a_multiproject_build"><a class="anchor" href="#sec:structure_of_a_multiproject_build"></a><a class="link" href="#sec:structure_of_a_multiproject_build">Structure of a multi-project build</a></h4>
<div class="paragraph">
<p>Such builds come in all shapes and sizes, but they do have some common characteristics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>settings.gradle</code> file in the root or <code>master</code> directory of the project</p>
</li>
<li>
<p>A <code>build.gradle</code> file in the root or <code>master</code> directory</p>
</li>
<li>
<p>Child directories that have their own <code>*.gradle</code> build files (some multi-project builds may omit child project build scripts)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>settings.gradle</code> file tells Gradle how the project and subprojects are structured. Fortunately, you dont have to read this file simply to learn what the project structure is as you can run the command <code>gradle projects</code>. Here&#8217;s the output from using that command on the Java <em>multiproject</em> build in the Gradle samples:</p>
</div>
<div class="sect4">
<h5 id="example_listing_the_projects_in_a_build"><a class="anchor" href="#example_listing_the_projects_in_a_build"></a><a class="link" href="#example_listing_the_projects_in_a_build">Example: Listing the projects in a build</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q projects</code></strong></div>
<div class="content">
<pre>&gt; gradle -q projects

------------------------------------------------------------
Root project
------------------------------------------------------------

Root project 'multiproject'
+--- Project ':api'
+--- Project ':services'
|    +--- Project ':services:shared'
|    \--- Project ':services:webservice'
\--- Project ':shared'

To see a list of the tasks of a project, run gradle &lt;project-path&gt;:tasks
For example, try running gradle :api:tasks</pre>
</div>
</div>
<div class="paragraph">
<p>This tells you that <em>multiproject</em> has three immediate child projects: <em>api</em>, <em>services</em> and <em>shared</em>. The <em>services</em> project then has its own children, <em>shared</em> and <em>webservice</em>. These map to the directory structure, so its easy to find them. For example, you can find <em>webservice</em> in <code>&lt;root&gt;/services/webservice</code>.</p>
</div>
<div class="paragraph">
<p>By default, Gradle uses the name of the directory it finds the <code>settings.gradle</code> as the name of the root project. This usually doesn&#8217;t cause problems since all developers check out the same directory name when working on a project. On Continuous Integration servers, like Jenkins, the directory name may be auto-generated and not match the name in your VCS. For that reason, it&#8217;s recommended that you always set the root project name to something predictable, even in single project builds. You can configure the root project name by setting <code>rootProject.name</code>.</p>
</div>
<div class="paragraph">
<p>Each project will usually have its own build file, but that&#8217;s not necessarily the case. In the above example, the <em>services</em> project is just a container or grouping of other subprojects. There is no build file in the corresponding directory. However, <em>multiproject</em> does have one for the root project.</p>
</div>
<div class="paragraph">
<p>The root <code>build.gradle</code> is often used to share common configuration between the child projects, for example by applying the same sets of plugins and dependencies to all the child projects. It can also be used to configure individual subprojects when it is preferable to have all the configuration in one place. This means you should always check the root build file when discovering how a particular subproject is being configured.</p>
</div>
<div class="paragraph">
<p>Another thing to bear in mind is that the build files might not be called <code>build.gradle</code>. Many projects will name the build files after the subproject names, such as <code>api.gradle</code> and <code>services.gradle</code> from the previous example. Such an approach helps a lot in IDEs because its tough to work out which <code>build.gradle</code> file out of twenty possibilities is the one you want to open. This little piece of magic is handled by the <code>settings.gradle</code> file, but as a build user you dont need to know the details of how its done. Just have a look through the child project directories to find the files with the <code>.gradle</code> suffix.</p>
</div>
<div class="paragraph">
<p>Once you know what subprojects are available, the key question for a build user is how to execute the tasks within the project.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:executing_a_multiproject_build"><a class="anchor" href="#sec:executing_a_multiproject_build"></a><a class="link" href="#sec:executing_a_multiproject_build">Executing a multi-project build</a></h4>
<div class="paragraph">
<p>From a user&#8217;s perspective, multi-project builds are still collections of tasks you can run. The difference is that you may want to control <em>which</em> project&#8217;s tasks get executed. You have two options here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change to the directory corresponding to the subproject youre interested in and just execute <code>gradle &lt;task&gt;</code> as normal.</p>
</li>
<li>
<p>Use a qualified task name from any directory, although this is usually done from the root. For example: <code>gradle :services:webservice:build</code> will build the <em>webservice</em> subproject and any subprojects it depends on.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first approach is similar to the single-project use case, but Gradle works slightly differently in the case of a multi-project build. The command <code>gradle test</code> will execute the <code>test</code> task in any subprojects, relative to the current working directory, that have that task. So if you run the command from the root project directory, youll run <code>test</code> in <em>api</em>, <em>shared</em>, <em>services:shared</em> and <em>services:webservice</em>. If you run the command from the services project directory, youll only execute the task in <em>services:shared</em> and <em>services:webservice</em>.</p>
</div>
<div class="paragraph">
<p>For more control over what gets executed, use qualified names (the second approach mentioned). These are paths just like directory paths, but use : instead of / or \. If the path begins with a :, then the path is resolved relative to the root project. In other words, the leading : represents the root project itself. All other colons are path separators.</p>
</div>
<div class="paragraph">
<p>This approach works for any task, so if you want to know what tasks are in a particular subproject, just use the <code>tasks</code> task, e.g. <code>gradle :services:webservice:tasks</code> .</p>
</div>
<div class="paragraph">
<p>Regardless of which technique you use to execute tasks, Gradle will take care of building any subprojects that the target depends on. You dont have to worry about the inter-project dependencies yourself. If youre interested in how this is configured, you can read about writing multi-project builds <a href="#multi_project_builds">later in the user guide</a>.</p>
</div>
<div class="paragraph">
<p>Theres one last thing to note. When youre using the Gradle wrapper, the first approach doesnt work well because you have to specify the path to the wrapper script if youre not in the project root. For example, if youre in the <em>webservice</em> subproject directory, you would have to run <code>../../gradlew build</code>.</p>
</div>
<div class="paragraph">
<p>Thats all you really need to know about multi-project builds as a build user. You can now identify whether a build is a multi-project one and you can discover its structure. And finally, you can execute tasks within specific subprojects.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="gradle_wrapper"><a class="anchor" href="#gradle_wrapper"></a><a class="link" href="#gradle_wrapper">The Gradle Wrapper</a></h3>
<div class="paragraph">
<p>The recommended way to execute any Gradle build is with the help of the Gradle Wrapper (in short just Wrapper). The Wrapper is a script that invokes a declared version of Gradle, downloading it beforehand if necessary. As a result, developers can get up and running with a Gradle project quickly without having to follow manual installation processes saving your company time and money.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/wrapper-workflow.png" alt="wrapper workflow">
</div>
<div class="title">Figure 2. The Wrapper workflow</div>
</div>
<div class="paragraph">
<p><strong>In a nutshell you gain the following benefits:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standardizes a project on a given Gradle version, leading to more reliable and robust builds.</p>
</li>
<li>
<p>Provisioning a new Gradle version to different users and execution environment (e.g. IDEs or Continuous Integration servers) is as simple as changing the Wrapper definition.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>So how does it work? For a user there are typically three different workflows:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>You set up a new Gradle project and want to <a href="#sec:adding_wrapper">add the Wrapper</a> to it.</p>
</li>
<li>
<p>You want to <a href="#sec:using_wrapper">run a project with the Wrapper</a> that already provides it.</p>
</li>
<li>
<p>You want to <a href="#sec:upgrading_wrapper">upgrade the Wrapper</a> to a new version of Gradle.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sections explain each of these use cases in more detail.</p>
</div>
<div class="sect3">
<h4 id="sec:adding_wrapper"><a class="anchor" href="#sec:adding_wrapper"></a><a class="link" href="#sec:adding_wrapper">Adding the Gradle Wrapper</a></h4>
<div class="paragraph">
<p>Generating the Wrapper files requires an installed version of the Gradle runtime on your machine as described in <a href="#installation">Installation</a>. Thankfully, generating the initial Wrapper files is a one-time process.</p>
</div>
<div class="paragraph">
<p>Every vanilla Gradle build comes with a built-in task called <code>wrapper</code>. Youll be able to find the task listed under the group "Build Setup tasks" when <a href="#sec:listing_tasks">listing the tasks</a>. Executing the <code>wrapper</code> task generates the necessary Wrapper files in the project directory.</p>
</div>
<div class="sect4">
<h5 id="example_running_the_wrapper_task"><a class="anchor" href="#example_running_the_wrapper_task"></a><a class="link" href="#example_running_the_wrapper_task">Example: Running the Wrapper task</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle wrapper</code></strong></div>
<div class="content">
<pre>&gt; gradle wrapper
&gt; Task :wrapper

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>To make the Wrapper files available to other developers and execution environments youll need to check them into version control. All Wrapper files including the JAR file are very small in size. Adding the JAR file to version control is expected. Some organizations do not allow projects to submit binary files to version control. At the moment there are no alternative options to the approach.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The generated Wrapper properties file, <code>gradle/wrapper/gradle-wrapper.properties</code>, stores the information about the Gradle distribution.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The server hosting the Gradle distribution.</p>
</li>
<li>
<p>The type of Gradle distribution. By default thats the <code>-bin</code> distribution containing only the runtime but no sample code and documentation.</p>
</li>
<li>
<p>The Gradle version used for executing the build. By default the <code>wrapper</code> task picks the exact same Gradle version that was used to generate the Wrapper files.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title"><code>gradle/wrapper/gradle-wrapper.properties</code></div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">distributionUrl=https\://services.gradle.org/distributions/gradle-4.3.1-bin.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p>All of those aspects are configurable at the time of generating the Wrapper files with the help of the following command line options.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--gradle-version</code></dt>
<dd>
<p>The Gradle version used for downloading and executing the Wrapper.</p>
</dd>
<dt class="hdlist1"><code>--distribution-type</code></dt>
<dd>
<p>The Gradle distribution type used for the Wrapper. Available options are <code>bin</code> and <code>all</code>. The default value is <code>bin</code>.</p>
</dd>
<dt class="hdlist1"><code>--gradle-distribution-url</code></dt>
<dd>
<p>The full URL pointing to Gradle distribution ZIP file. Using this option makes <code>--gradle-version</code> and <code>--distribution-type</code> obsolete as the URL already contains this information. This option is extremely valuable if you want to host the Gradle distribution inside your companys network.</p>
</dd>
<dt class="hdlist1"><code>--gradle-distribution-sha256-sum</code></dt>
<dd>
<p>The SHA256 hash sum used for <a href="#sec:verification">verifying the downloaded Gradle distribution</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Lets assume the following use case to illustrate the use of the command line options. You would like to generate the Wrapper with version 4.0 and use the <code>-all</code> distribution to enable your IDE to enable code-completion and being able to navigate to the Gradle source code. Those requirements are captured by the following command line execution:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_providing_options_to_wrapper_task"><a class="anchor" href="#example_providing_options_to_wrapper_task"></a><a class="link" href="#example_providing_options_to_wrapper_task">Example: Providing options to Wrapper task</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle wrapper --gradle-version 4.0 --distribution-type all</code></strong></div>
<div class="content">
<pre>&gt; gradle wrapper --gradle-version 4.0 --distribution-type all
&gt; Task :wrapper

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>As a result you can find the desired information in the Wrapper properties file.</p>
</div>
<div class="listingblock">
<div class="title"><code>gradle/wrapper/gradle-wrapper.properties</code></div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">distributionUrl=https\://services.gradle.org/distributions/gradle-4.0-all.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p>Lets have a look at the following project layout to illustrate the expected Wrapper files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.
 build.gradle
 settings.gradle
 gradle
    wrapper
        gradle-wrapper.jar
        gradle-wrapper.properties
 gradlew
 gradlew.bat</pre>
</div>
</div>
<div class="paragraph">
<p>A Gradle project typically provides a <code>build.gradle</code> and a <code>settings.gradle</code> file. The Wrapper files live alongside in the <code>gradle</code> directory and the root directory of the project. The following list explains their purpose.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>gradle-wrapper.jar</code></dt>
<dd>
<p>The Wrapper JAR file containing code for downloading the Gradle distribution.</p>
</dd>
<dt class="hdlist1"><code>gradle-wrapper.properties</code></dt>
<dd>
<p>A properties file responsible for configuring the Wrapper runtime behavior e.g. the Gradle version compatible with this version.</p>
</dd>
<dt class="hdlist1"><code>gradlew</code>, <code>gradlew.bat</code></dt>
<dd>
<p>A shell script and a Windows batch script for executing the build with the Wrapper.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>You can go ahead and <a href="#sec:using_wrapper">execute the build with the Wrapper</a> without having to install the Gradle runtime. If the project you are working on does not contain those Wrapper files then youll need to <a href="#sec:adding_wrapper">generate them</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:using_wrapper"><a class="anchor" href="#sec:using_wrapper"></a><a class="link" href="#sec:using_wrapper">Using the Gradle Wrapper</a></h4>
<div class="paragraph">
<p>It is recommended to always execute a build with the Wrapper to ensure a reliable, controlled and standardized execution of the build. Using the Wrapper looks almost exactly like running the build with a Gradle installation. Depending on the operating system you either run <code>gradlew</code> or <code>gradlew.bat</code> instead of the <code>gradle</code> command. The following console output demonstrate the use of the Wrapper on a Windows machine for a Java-based project.</p>
</div>
<div class="sect4">
<h5 id="example_executing_the_build_with_the_wrapper_batch_file"><a class="anchor" href="#example_executing_the_build_with_the_wrapper_batch_file"></a><a class="link" href="#example_executing_the_build_with_the_wrapper_batch_file">Example: Executing the build with the Wrapper batch file</a></h5>
<div class="listingblock">
<div class="title">Output of <code>gradlew.bat build</code></div>
<div class="content">
<pre>&gt; gradlew.bat build
Downloading https://services.gradle.org/distributions/gradle-4.0-all.zip
.....................................................................................
Unzipping C:\Documents and Settings\Claudia\.gradle\wrapper\dists\gradle-4.0-all\ac27o8rbd0ic8ih41or9l32mv\gradle-4.0-all.zip to C:\Documents and Settings\Claudia\.gradle\wrapper\dists\gradle-4.0-al\ac27o8rbd0ic8ih41or9l32mv
Set executable permissions for: C:\Documents and Settings\Claudia\.gradle\wrapper\dists\gradle-4.0-all\ac27o8rbd0ic8ih41or9l32mv\gradle-4.0\bin\gradle

BUILD SUCCESSFUL in 12s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>In case the Gradle distribution is not available on the machine, the Wrapper will download it and store in the local file system. Any subsequent build invocation is going to reuse the existing local distribution as long as the distribution URL in the Gradle properties doesn&#8217;t change.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The Wrapper shell script and batch file reside in the root directory of a single or multi-project Gradle build. You will need to reference the correct path to those files in case you want to execute the build from a subproject directory e.g. <code>../../gradlew tasks</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:upgrading_wrapper"><a class="anchor" href="#sec:upgrading_wrapper"></a><a class="link" href="#sec:upgrading_wrapper">Upgrading the Gradle Wrapper</a></h4>
<div class="paragraph">
<p>Projects will typically want to keep up with the times and upgrade their Gradle version to benefit from new features and improvements. One way to upgrade the Gradle version is manually change the <code>distributionUrl</code> property in the Wrapper property file. The better and recommended option is to run the <code>wrapper</code> task and provide the target Gradle version as described in <a href="#sec:adding_wrapper">Adding the Gradle Wrapper</a>. Using the <code>wrapper</code> task ensures that any optimizations made to the Wrapper shell script or batch file with that specific Gradle version are applied to the project. As usual youd commit the changes to the Wrapper files to version control.</p>
</div>
<div class="paragraph">
<p>Use the Gradle <code>wrapper</code> task to generate the wrapper, specifying a version. The default is the current version, which you can check by executing <code>./gradlew --version</code>.</p>
</div>
<div class="sect4">
<h5 id="example_upgrading_the_wrapper_version"><a class="anchor" href="#example_upgrading_the_wrapper_version"></a><a class="link" href="#example_upgrading_the_wrapper_version">Example: Upgrading the Wrapper version</a></h5>
<div class="listingblock">
<div class="title">Output of <code>./gradlew wrapper --gradle-version 4.2.1</code></div>
<div class="content">
<pre>&gt; ./gradlew wrapper --gradle-version 4.2.1

BUILD SUCCESSFUL in 4s
1 actionable task: 1 executed</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_checking_the_wrapper_version_after_upgrading"><a class="anchor" href="#example_checking_the_wrapper_version_after_upgrading"></a><a class="link" href="#example_checking_the_wrapper_version_after_upgrading">Example: Checking the Wrapper version after upgrading</a></h5>
<div class="listingblock">
<div class="title">Output of <code>./gradlew -v</code></div>
<div class="content">
<pre>&gt; ./gradlew -v
Downloading https://services.gradle.org/distributions/gradle-4.2.1-bin.zip
...................................................................
Unzipping /Users/claudia/.gradle/wrapper/dists/gradle-4.2.1-bin/dajvke9o8kmaxbu0kc5gcgeju/gradle-4.2.1-bin.zip to /Users/claudia/.gradle/wrapper/dists/gradle-4.2.1-bin/dajvke9o8kmaxbu0kc5gcgeju
Set executable permissions for: /Users/claudia/.gradle/wrapper/dists/gradle-4.2.1-bin/dajvke9o8kmaxbu0kc5gcgeju/gradle-4.2.1/bin/gradle

------------------------------------------------------------
Gradle 4.2.1
------------------------------------------------------------

Build time:   2017-10-02 15:36:21 UTC
Revision:     a88ebd6be7840c2e59ae4782eb0f27fbe3405ddf

Groovy:       2.4.12
Ant:          Apache Ant(TM) version 1.9.6 compiled on June 29 2015
JVM:          1.8.0_60 (Oracle Corporation 25.60-b23)
OS:           Mac OS X 10.13.1 x86_64</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="customizing_wrapper"><a class="anchor" href="#customizing_wrapper"></a><a class="link" href="#customizing_wrapper">Customizing the Gradle Wrapper</a></h4>
<div class="paragraph">
<p>Most users of Gradle are happy with the default runtime behavior of the Wrapper. However, organizational policies, security constraints or personal preferences might require you to dive deeper into customizing the Wrapper. Thankfully, the built-in <code>wrapper</code> task exposes numerous options to bend the runtime behavior to your needs. Most configuration options are exposed by the underlying task type <a href="../dsl/org.gradle.api.tasks.wrapper.Wrapper.html">Wrapper</a>.</p>
</div>
<div class="paragraph">
<p>Lets assume you grew tired of defining the <code>-all</code> distribution type on the command line every time you upgrade the Wrapper. You can save yourself some keyboard strokes by re-configuring the <code>wrapper</code> task.</p>
</div>
<div class="sect4">
<h5 id="example_customizing_the_wrapper_task"><a class="anchor" href="#example_customizing_the_wrapper_task"></a><a class="link" href="#example_customizing_the_wrapper_task">Example: Customizing the Wrapper task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">wrapper {
    distributionType = Wrapper.DistributionType.ALL
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the configuration in place running <code>./gradlew wrapper --gradle-version 4.1</code> is enough to produce a <code>distributionUrl</code> value in the Wrapper properties file that will request the <code>-all</code> distribution.</p>
</div>
<div class="listingblock">
<div class="title"><code>gradle/wrapper/gradle-wrapper.properties</code></div>
<div class="content">
<pre>distributionUrl=https\://services.gradle.org/distributions/gradle-4.1-all.zip</pre>
</div>
</div>
<div class="paragraph">
<p>Check out the API documentation for more detail descriptions of the available configuration options. You can also find various samples for configuring the Wrapper in the Gradle distribution.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:authenticated_download"><a class="anchor" href="#sec:authenticated_download"></a><a class="link" href="#sec:authenticated_download">Authenticated Gradle distribution download</a></h5>
<div class="paragraph">
<p>The Gradle <code>Wrapper</code> can download Gradle distributions from servers using HTTP Basic Authentication. This enables you to host the Gradle distribution on a private protected server. You can specify a username and password in two different ways depending on your use case: as system properties or directly embedded in the <code>distributionUrl</code>. Credentials in system properties take precedence over the ones embedded in <code>distributionUrl</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">Security Warning</div>
<div class="paragraph">
<p>HTTP Basic Authentication should only be used with <code>HTTPS</code> URLs and not plain <code>HTTP</code> ones. With Basic Authentication, the user credentials are sent in clear text.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using system properties can be done in the <code>.gradle/gradle.properties</code> file in the user&#8217;s home directory, or by other means, see <a href="#sec:gradle_configuration_properties">Gradle Configuration Properties</a>.</p>
</div>
<div class="listingblock">
<div class="title"><code>gradle.properties</code></div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">systemProp.gradle.wrapperUser=username
systemProp.gradle.wrapperPassword=password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Embedding credentials in the <code>distributionUrl</code> in the <code>gradle/wrapper/gradle-wrapper.properties</code> file also works. Please note that this file is to be committed into your source control system. Shared credentials embedded in <code>distributionUrl</code> should only be used in a controlled environment.</p>
</div>
<div class="listingblock">
<div class="title"><code>gradle/wrapper/gradle-wrapper.properties</code></div>
<div class="content">
<pre>distributionUrl=https://username:password@somehost/path/to/gradle-distribution.zip</pre>
</div>
</div>
<div class="paragraph">
<p>This can be used in conjunction with a proxy, authenticated or not. See <a href="#sec:accessing_the_web_via_a_proxy">Accessing the web via a proxy</a> for more information on how to configure the <code>Wrapper</code> to use a proxy.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:verification"><a class="anchor" href="#sec:verification"></a><a class="link" href="#sec:verification">Verification of downloaded Gradle distributions</a></h5>
<div class="paragraph">
<p>The Gradle Wrapper allows for verification of the downloaded Gradle distribution via SHA-256 hash sum comparison. This increases security against targeted attacks by preventing a man-in-the-middle attacker from tampering with the downloaded Gradle distribution.</p>
</div>
<div class="paragraph">
<p>To enable this feature, download the <code>.sha256</code> file associated with the Gradle distribution you want to verify.</p>
</div>
<div class="sect5">
<h6 id="downloading_the_sha_256_file"><a class="anchor" href="#downloading_the_sha_256_file"></a><a class="link" href="#downloading_the_sha_256_file">Downloading the SHA-256 file</a></h6>
<div class="paragraph">
<p>You can download the <code>.sha256</code> file from the <a href="https://services.gradle.org/distributions/">stable releases</a> or <a href="https://services.gradle.org/distributions-snapshots/">release candidate and nightly releases</a>. The format of the file is a single line of text that is the SHA-256 hash of the corresponding zip file.</p>
</div>
</div>
<div class="sect5">
<h6 id="configuring_checksum_verification"><a class="anchor" href="#configuring_checksum_verification"></a><a class="link" href="#configuring_checksum_verification">Configuring checksum verification</a></h6>
<div class="paragraph">
<p>Add the downloaded hash sum to <code>gradle-wrapper.properties</code> using the <code>distributionSha256Sum</code> property or use <code>--gradle-distribution-sha256-sum</code> on the command-line.</p>
</div>
<div class="listingblock">
<div class="title"><code>gradle/wrapper/gradle-wrapper.properties</code></div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">distributionSha256Sum=371cb9fbebbe9880d147f59bab36d61eee122854ef8c9ee1ecf12b82368bcf10</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle will report a build failure in case the configured checksum does not match the checksum found on the server for hosting the distribution. Checksum Verification is only performed if the configured Wrapper distribution hasn&#8217;t been downloaded yet.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="troubleshooting"><a class="anchor" href="#troubleshooting"></a><a class="link" href="#troubleshooting">Troubleshooting</a></h3>
<div class="paragraph">
<p>The following is a collection of common issues and suggestions for addressing them. You can get other tips and search the <a href="https://discuss.gradle.org/c/help-discuss">Gradle forums</a> and <a href="https://stackoverflow.com/questions/tagged/gradle">StackOverflow #gradle</a> answers, as well as Gradle documentation from <a href="https://help.gradle.org/">help.gradle.org</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:troubleshooting_installation"><a class="anchor" href="#sec:troubleshooting_installation"></a><a class="link" href="#sec:troubleshooting_installation">Troubleshooting Gradle installation</a></h4>
<div class="paragraph">
<p>If you followed the <a href="#installation">installation instructions</a>, and arent able to execute your Gradle build, here are some tips that may help.</p>
</div>
<div class="paragraph">
<p>If you installed Gradle outside of just invoking the <a href="#gradle_wrapper">Gradle Wrapper</a>, you can check your Gradle installation by running <code>gradle --version</code> in a terminal.</p>
</div>
<div class="paragraph">
<p>You should see something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle --version

-----------------------------------------------------------
Gradle 4.6
------------------------------------------------------------

Build time:   2018-02-21 15:28:42 UTC
Revision:     819e0059da49f469d3e9b2896dc4e72537c4847d

Groovy:       2.4.12
Ant:          Apache Ant(TM) version 1.9.9 compiled on February 2 2017
JVM:          1.8.0_151 (Oracle Corporation 25.151-b12)
OS:           Mac OS X 10.13.3 x86_64</pre>
</div>
</div>
<div class="paragraph">
<p>If not, here are some things you might see instead.</p>
</div>
<div class="sect4">
<h5 id="command_not_found_gradle"><a class="anchor" href="#command_not_found_gradle"></a><a class="link" href="#command_not_found_gradle">Command not found: gradle</a></h5>
<div class="paragraph">
<p>If you get "command not found: gradle", you need to ensure that Gradle is properly added to your <code>PATH</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="java_home_is_set_to_an_invalid_directory"><a class="anchor" href="#java_home_is_set_to_an_invalid_directory"></a><a class="link" href="#java_home_is_set_to_an_invalid_directory">JAVA_HOME is set to an invalid directory</a></h5>
<div class="paragraph">
<p>If you get something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ERROR: JAVA_HOME is set to an invalid directory

Please set the JAVA_HOME variable in your environment to match the location of your Java installation.</pre>
</div>
</div>
<div class="paragraph">
<p>Youll need to ensure that a <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java Development Kit</a> version 7 or higher is <a href="https://www.java.com/en/download/help/index_installing.xml">properly installed</a>, the <code>JAVA_HOME</code> environment variable is set, and <a href="https://www.java.com/en/download/help/path.xml">Java is added to your <code>PATH</code></a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="permission_denied"><a class="anchor" href="#permission_denied"></a><a class="link" href="#permission_denied">Permission denied</a></h5>
<div class="paragraph">
<p>If you get "permission denied", that means that Gradle likely exists in the correct place, but it is not executable.
You can fix this using <code>chmod +x path/to/executable</code> on *nix-based systems.</p>
</div>
</div>
<div class="sect4">
<h5 id="other_installation_failures"><a class="anchor" href="#other_installation_failures"></a><a class="link" href="#other_installation_failures">Other installation failures</a></h5>
<div class="paragraph">
<p>If <code>gradle --version</code> works, but all of your builds fail with the same error, it is possible there is a problem with one of your Gradle build configuration scripts.</p>
</div>
<div class="paragraph">
<p>You can verify the problem is with Gradle scripts by running <code>gradle help</code> which executes configuration scripts, but no Gradle tasks. If the error persists, build configuration is problematic.
If not, then the problem exists within the execution of one or more of the requested tasks (Gradle executes configuration scripts first, and then executes build steps).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:troubleshooting_dependency_resolution"><a class="anchor" href="#sec:troubleshooting_dependency_resolution"></a><a class="link" href="#sec:troubleshooting_dependency_resolution">Debugging dependency resolution</a></h4>
<div class="paragraph">
<p>Common dependency resolution issues such as resolving version conflicts are covered in <a href="#troubleshooting_dependency_resolution">Troubleshooting Dependency Resolution</a>.</p>
</div>
<div class="paragraph">
<p>You can see a dependency tree and see which resolved dependency versions differed from what was requested by clicking the <em>Dependencies</em> view and using the search functionality, specifying the resolution reason.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/troubleshooting-dependency-management-build-scan.png" alt="troubleshooting dependency management build scan">
</div>
<div class="title">Figure 3. Debugging dependency conflicts with build scans</div>
</div>
<div class="paragraph">
<p>The <a href="https://scans.gradle.com/s/sample/troubleshooting-userguide/dependencies?expandAll&amp;filters=WzFd&amp;toggled=W1swXSxbMF0sWzAsMF0sWzAsMV1d">actual build scan</a> with filtering criteria is available for exploration.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:troubleshooting_performance"><a class="anchor" href="#sec:troubleshooting_performance"></a><a class="link" href="#sec:troubleshooting_performance">Troubleshooting slow Gradle builds</a></h4>
<div class="paragraph">
<p>For build performance issues (including slow sync time), see the guide to <a href="https://guides.gradle.org/performance/">Improving the Performance of Gradle Builds</a>.</p>
</div>
<div class="paragraph">
<p>Android developers should watch a presentation by the Android SDK Tools team about <a href="https://youtu.be/7ll-rkLCtyk">Speeding Up Your Android Gradle Builds</a>.
Many tips are also covered in the Android Studio user guide <a href="https://developer.android.com/studio/build/optimize-your-build.html">on optimizing build speed</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:troubleshooting_build_logic"><a class="anchor" href="#sec:troubleshooting_build_logic"></a><a class="link" href="#sec:troubleshooting_build_logic">Debugging build logic</a></h4>
<div class="sect4">
<h5 id="attaching_a_debugger_to_your_build"><a class="anchor" href="#attaching_a_debugger_to_your_build"></a><a class="link" href="#attaching_a_debugger_to_your_build">Attaching a debugger to your build</a></h5>
<div class="paragraph">
<p>You can set breakpoints and debug <a href="#sec:packaging_a_plugin">buildSrc and standalone plugins</a> in your Gradle build itself by setting the <code>org.gradle.debug</code> property to true and then attaching a remote debugger to port 5005.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle help -Dorg.gradle.debug=true --no-daemon</pre>
</div>
</div>
<div class="paragraph">
<p>In addition, if youve adopted the Kotlin DSL, you can also debug build scripts themselves.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You must either stop running Gradle Daemons or run with <code>--no-daemon</code> when using debug mode.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="adding_and_changing_logging"><a class="anchor" href="#adding_and_changing_logging"></a><a class="link" href="#adding_and_changing_logging">Adding and changing logging</a></h5>
<div class="paragraph">
<p>In addition to <a href="#sec:command_line_logging">controlling logging verbosity</a>, you can also control display of task outcomes (e.g. UP-TO-DATE) in lifecycle logging using the <a href="#sec:command_line_customizing_log_format"><code>--console=verbose</code> flag</a>.</p>
</div>
<div class="paragraph">
<p>You can also replace much of Gradles logging with your own by registering various event listeners. One example of a <a href="#sec:changing_what_gradle_logs">custom event logger is explained in the logging documentation</a>. You can also <a href="#sec:external_tools">control logging from external tools</a>, making them more verbose in order to debug their execution.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Additional logs from the <a href="#gradle_daemon">Gradle Daemon</a> can be found under <code>GRADLE_USER_HOME/daemon/&lt;gradle-version&gt;/</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="task_executed_when_it_should_have_been_up_to_date"><a class="anchor" href="#task_executed_when_it_should_have_been_up_to_date"></a><a class="link" href="#task_executed_when_it_should_have_been_up_to_date">Task executed when it should have been UP-TO-DATE</a></h5>
<div class="paragraph">
<p><code>--info</code> logs explain why a task was executed, though build scans do this in a searchable, visual way by going to the <em>Timeline</em> view and clicking on the task you want to inspect.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/troubleshooting-task-execution-build-scan.png" alt="troubleshooting task execution build scan">
</div>
<div class="title">Figure 4. Debugging incremental build with a build scan</div>
</div>
<div class="paragraph">
<p>You can learn what the task outcomes mean from <a href="#sec:task_outcomes">this listing</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:troubleshooting_ide_integration"><a class="anchor" href="#sec:troubleshooting_ide_integration"></a><a class="link" href="#sec:troubleshooting_ide_integration">Debugging IDE integration</a></h4>
<div class="paragraph">
<p>Many infrequent errors within IDEs can be solved by "refreshing" Gradle.
See also more documentation on working with Gradle <a href="https://www.jetbrains.com/help/idea/gradle.html">in IntelliJ IDEA</a> and <a href="http://www.vogella.com/tutorials/EclipseGradle/article.html">in Eclipse</a>.</p>
</div>
<div class="sect4">
<h5 id="refreshing_intellij_idea"><a class="anchor" href="#refreshing_intellij_idea"></a><a class="link" href="#refreshing_intellij_idea">Refreshing IntelliJ IDEA</a></h5>
<div class="paragraph">
<p><strong>NOTE:</strong> This only works for Gradle projects <a href="https://www.jetbrains.com/help/idea/gradle.html#link_gradle_project">linked to IntelliJ</a>.</p>
</div>
<div class="paragraph">
<p>From the main menu, go to <code>View</code> &gt; <code>Tool Windows</code> &gt; <code>Gradle</code>. Then click on the <em>Refresh</em> icon.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/troubleshooting-refresh-intellij.png" alt="troubleshooting refresh intellij">
</div>
<div class="title">Figure 5. Refreshing a Gradle project in IntelliJ IDEA</div>
</div>
</div>
<div class="sect4">
<h5 id="refreshing_eclipse_using_buildship"><a class="anchor" href="#refreshing_eclipse_using_buildship"></a><a class="link" href="#refreshing_eclipse_using_buildship">Refreshing Eclipse (using Buildship)</a></h5>
<div class="paragraph">
<p>If you&#8217;re using <a href="https://projects.eclipse.org/projects/tools.buildship">Buildship</a> for the Eclipse IDE, you can re-synchronize your Gradle build by opening the "Gradle Tasks" view and clicking the "Refresh" icon, or by executing the <code>Gradle</code> &gt; <code>Refresh Gradle Project</code> command from the context menu while editing a Gradle script.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/troubleshooting-refresh-eclipse.png" alt="troubleshooting refresh eclipse">
</div>
<div class="title">Figure 6. Refreshing a Gradle project in Eclipse Buildship</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="getting_additional_help"><a class="anchor" href="#getting_additional_help"></a><a class="link" href="#getting_additional_help">Getting additional help</a></h4>
<div class="paragraph">
<p>If you didn&#8217;t find a fix for your issue here, please reach out to the Gradle community on the <a href="https://discuss.gradle.org/c/help-discuss">help forum</a> or search relevant developer resources using <a href="https://help.gradle.org/">help.gradle.org</a>.</p>
</div>
<div class="paragraph">
<p>If you believe you&#8217;ve found a bug in Gradle, please <a href="https://github.com/gradle/gradle/issues">file an issue</a> on GitHub.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="authoring_gradle_builds"><a class="anchor" href="#authoring_gradle_builds"></a><a class="link" href="#authoring_gradle_builds">Authoring Gradle Builds</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="feature_lifecycle"><a class="anchor" href="#feature_lifecycle"></a><a class="link" href="#feature_lifecycle">The Feature Lifecycle</a></h3>
<div class="paragraph">
<p>Gradle is under constant development and improvement. New versions are delivered on a regular and frequent basis (approximately every 6 weeks). Continuous improvement combined with frequent delivery allows new features to be made available to users early and for invaluable real world feedback to be incorporated into the development process. Getting new functionality into the hands of users regularly is a core value of the Gradle platform. At the same time, API and feature stability is taken very seriously and is also considered a core value of the Gradle platform. This is something that is engineered into the development process by design choices and automated testing, and is formalised by <a href="#backwards_compatibility">the section on backwards compatibility</a>.</p>
</div>
<div class="paragraph">
<p>The Gradle <em>feature lifecycle</em> has been designed to meet these goals. It also serves to clearly communicate to users of Gradle what the state of a feature is. The term <em>feature</em> typically means an API or DSL method or property in this context, but it is not restricted to this definition. Command line arguments and modes of execution (e.g. the Build Daemon) are two examples of other kinds of features.</p>
</div>
<div class="sect3">
<h4 id="sec:states"><a class="anchor" href="#sec:states"></a><a class="link" href="#sec:states">States</a></h4>
<div class="paragraph">
<p>Features can be in one of 4 states:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Internal</p>
</li>
<li>
<p>Incubating</p>
</li>
<li>
<p>Public</p>
</li>
<li>
<p>Deprecated</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="sec:internal"><a class="anchor" href="#sec:internal"></a><a class="link" href="#sec:internal">Internal</a></h5>
<div class="paragraph">
<p>Internal features are not designed for public use and are only intended to be used by Gradle itself. They can change in any way at any point in time without any notice. Therefore, we recommend avoiding the use of such features. Internal features are not documented. If it appears in this User Guide, the DSL Reference or the API Reference documentation then the feature is not internal.</p>
</div>
<div class="paragraph">
<p>Internal features may evolve into public features.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:incubating_state"><a class="anchor" href="#sec:incubating_state"></a><a class="link" href="#sec:incubating_state">Incubating</a></h5>
<div class="paragraph">
<p>Features are introduced in the <em>incubating</em> state to allow real world feedback to be incorporated into the feature before it is made public and locked down to provide backwards compatibility. It also gives users who are willing to accept potential future changes early access to the feature so they can put it into use immediately.</p>
</div>
<div class="paragraph">
<p>A feature in an incubating state may change in future Gradle versions until it is no longer incubating. Changes to incubating features for a Gradle release will be highlighted in the release notes for that release. The incubation period for new features varies depending on the scope, complexity and nature of the feature.</p>
</div>
<div class="paragraph">
<p>Features in incubation are clearly indicated to be so. In the source code, all methods/properties/classes that are incubating are annotated with <a href="../javadoc/org/gradle/api/Incubating.html">Incubating</a>, which is also used to specially mark them in the DSL and API references. If an incubating feature is discussed in this User Guide, it will be explicitly said to be in the incubating state.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:public"><a class="anchor" href="#sec:public"></a><a class="link" href="#sec:public">Public</a></h5>
<div class="paragraph">
<p>The default state for a non-internal feature is <em>public</em>. Anything that is documented in the User Guide, DSL Reference or API references that is not explicitly said to be incubating or deprecated is considered public. Features are said to be <em>promoted</em> from an incubating state to public. The release notes for each release indicate which previously incubating features are being promoted by the release.</p>
</div>
<div class="paragraph">
<p>A public feature will <em>never</em> be removed or intentionally changed without undergoing deprecation. All public features are subject to the backwards compatibility policy.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:deprecated"><a class="anchor" href="#sec:deprecated"></a><a class="link" href="#sec:deprecated">Deprecated</a></h5>
<div class="paragraph">
<p>Some features will become superseded or irrelevant due to the natural evolution of Gradle. Such features will eventually be removed from Gradle after being <em>deprecated</em>. A deprecated feature will <em>never</em> be changed, until it is finally removed according to the backwards compatibility policy.</p>
</div>
<div class="paragraph">
<p>Deprecated features are clearly indicated to be so. In the source code, all methods/properties/classes that are deprecated are annotated with <code>@java.lang.Deprecated</code> which is reflected in the DSL and API references. In most cases, there is a replacement for the deprecated element, and this will be described in the documentation. Using a deprecated feature will also result in a runtime warning in Gradle&#8217;s output.</p>
</div>
<div class="paragraph">
<p>Use of deprecated features should be avoided. The release notes for each release indicate any features that are being deprecated by the release.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="backwards_compatibility"><a class="anchor" href="#backwards_compatibility"></a><a class="link" href="#backwards_compatibility">Backwards Compatibility Policy</a></h4>
<div class="paragraph">
<p>Gradle provides backwards compatibility across major versions (e.g. <code>1.x</code>, <code>2.x</code>, etc.). Once a public feature is introduced or promoted in a Gradle release it will remain indefinitely or until it is deprecated. Once deprecated, it may be removed in the next major release. Deprecated features may be supported across major releases, but this is not guaranteed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="authoring_maintainable_build_scripts"><a class="anchor" href="#authoring_maintainable_build_scripts"></a><a class="link" href="#authoring_maintainable_build_scripts">Authoring Maintainable Build Scripts</a></h3>
<div class="paragraph">
<p>Gradle build scripts combine the qualities of declarative build logic, expressiveness as well as flexibility and rigidity as needed.
As a build script author it is easy to fall into the trap of striking the wrong balance or applying poor coding habits.
This chapter describes best practices for writing your build script in a meaningful, yet flexible and efficient way.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The third-party <a href="https://github.com/nebula-plugins/gradle-lint-plugin">Gradle lint plugin</a> helps with enforcing a desired code style in a build script if you are looking for appropriate linting automation.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec:avoid_imperative_logic_in_scripts"><a class="anchor" href="#sec:avoid_imperative_logic_in_scripts"></a><a class="link" href="#sec:avoid_imperative_logic_in_scripts">Avoiding imperative logic in scripts</a></h4>
<div class="paragraph">
<p>The Gradle runtime does not enforce a specific style for build logic.
For that very reason, it&#8217;s easy to end up with a build script that mixes declarative DSL elements with imperative, procedural code.
Let&#8217;s talk about some concrete examples.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Declarative code:</em> Built-in, language-agnostic DSL elements (e.g. <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:dependencies(groovy.lang.Closure)">Project.dependencies{}</a> or <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:repositories(groovy.lang.Closure)">Project.repositories{}</a>) or DSLs exposed by plugins</p>
</li>
<li>
<p><em>Imperative code:</em> Conditional logic or very complex task action implementations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The end goal of every build script should be to only contain declarative language elements which makes the code easier to understand and maintain.
Imperative logic should live in binary plugins and which in turn is applied to the build script.
As a side product, you automatically enable your team to <a href="https://guides.gradle.org/designing-gradle-plugins/#reusable_logic_should_be_written_as_binary_plugin">reuse the plugin logic in other projects</a> if you publish the artifact to a binary repository.</p>
</div>
<div class="paragraph">
<p>The following sample build shows a negative example of using conditional logic directly in the build script.
While this code snippet is small, it is easy to imagine a full-blown build script using numerous procedural statements and the impact it would have on readability and maintainability.
By moving the code into a class <a href="https://guides.gradle.org/testing-gradle-plugins/">testability</a> also becomes a valid option.</p>
</div>
<div class="sect4">
<h5 id="example_a_build_script_using_conditional_logic_to_create_a_task"><a class="anchor" href="#example_a_build_script_using_conditional_logic_to_create_a_task"></a><a class="link" href="#example_a_build_script_using_conditional_logic_to_create_a_task">Example: A build script using conditional logic to create a task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">if</span> (project.findProperty(<span class="string"><span class="delimiter">'</span><span class="content">releaseEngineer</span><span class="delimiter">'</span></span>)) {
    task release {
        doLast {
            logger.quiet <span class="string"><span class="delimiter">'</span><span class="content">Releasing to production...</span><span class="delimiter">'</span></span>

            <span class="comment">// release the artifact to production</span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s compare the build script with the same logic implemented as a binary plugin.
The code might look more involved at first but clearly looks more like typical application code.
This particular plugin class lives in the <a href="#sec:build_sources"><code>buildSrc</code> directory</a> which makes it available to the build script automatically.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_binary_plugin_implementing_imperative_logic"><a class="anchor" href="#example_a_binary_plugin_implementing_imperative_logic"></a><a class="link" href="#example_a_binary_plugin_implementing_imperative_logic">Example: A binary plugin implementing imperative logic</a></h5>
<div class="listingblock">
<div class="title">ReleasePlugin.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.enterprise</span>;

<span class="keyword">import</span> <span class="include">org.gradle.api.Action</span>;
<span class="keyword">import</span> <span class="include">org.gradle.api.Plugin</span>;
<span class="keyword">import</span> <span class="include">org.gradle.api.Project</span>;
<span class="keyword">import</span> <span class="include">org.gradle.api.Task</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">ReleasePlugin</span> <span class="directive">implements</span> Plugin&lt;Project&gt; {
    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> RELEASE_ENG_ROLE_PROP = <span class="string"><span class="delimiter">&quot;</span><span class="content">releaseEngineer</span><span class="delimiter">&quot;</span></span>;
    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> RELEASE_TASK_NAME = <span class="string"><span class="delimiter">&quot;</span><span class="content">release</span><span class="delimiter">&quot;</span></span>;

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> apply(Project project) {
        <span class="keyword">if</span> (project.findProperty(RELEASE_ENG_ROLE_PROP) != <span class="predefined-constant">null</span>) {
            Task task = project.getTasks().create(RELEASE_TASK_NAME);

            task.doLast(<span class="keyword">new</span> <span class="predefined-type">Action</span>&lt;Task&gt;() {
                <span class="annotation">@Override</span>
                <span class="directive">public</span> <span class="type">void</span> execute(Task task) {
                    task.getLogger().quiet(<span class="string"><span class="delimiter">&quot;</span><span class="content">Releasing to production...</span><span class="delimiter">&quot;</span></span>);

                    <span class="comment">// release the artifact to production</span>
                }
            });
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that the build logic has been translated into a plugin, you can apply it in the build script.
The build script has been shrunk from 8 lines of code to a one liner.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_build_script_applying_a_plugin_that_encapsulates_imperative_logic"><a class="anchor" href="#example_a_build_script_applying_a_plugin_that_encapsulates_imperative_logic"></a><a class="link" href="#example_a_build_script_applying_a_plugin_that_encapsulates_imperative_logic">Example: A build script applying a plugin that encapsulates imperative logic</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">com.enterprise.release</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:avoiding_gradle_internal_apis"><a class="anchor" href="#sec:avoiding_gradle_internal_apis"></a><a class="link" href="#sec:avoiding_gradle_internal_apis">Avoiding Gradle internal APIs</a></h4>
<div class="paragraph">
<p>Use of Gradle internal APIs in plugins and build scripts has the potential to break builds when either Gradle or plugins change.</p>
</div>
<div class="paragraph">
<p>The following packages are listed in the <a href="https://github.com/gradle/gradle/blob/180b9d3fa84b91768364c603380e82947437eda1/buildSrc/subprojects/configuration/src/main/kotlin/org/gradle/gradlebuild/public-api.kt">Gradle public API definition</a>, with the exception of any subpackage with <code>internal</code> in the name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org/gradle/*
org/gradle/api/**
org/gradle/authentication/**
org/gradle/buildinit/**
org/gradle/caching/**
org/gradle/concurrent/**
org/gradle/deployment/**
org/gradle/external/javadoc/**
org/gradle/ide/**
org/gradle/includedbuild/**
org/gradle/ivy/**
org/gradle/jvm/**
org/gradle/language/**
org/gradle/maven/**
org/gradle/nativeplatform/**
org/gradle/normalization/**
org/gradle/platform/**
org/gradle/play/**
org/gradle/plugin/devel/**
org/gradle/plugin/repository/*
org/gradle/plugin/use/*
org/gradle/plugin/management/*
org/gradle/plugins/**
org/gradle/process/**
org/gradle/testfixtures/**
org/gradle/testing/jacoco/**
org/gradle/tooling/**
org/gradle/swiftpm/**
org/gradle/model/**
org/gradle/testkit/**
org/gradle/testing/**
org/gradle/vcs/**
org/gradle/workers/**</pre>
</div>
</div>
<div class="sect4">
<h5 id="alternatives_for_oft_used_internal_apis"><a class="anchor" href="#alternatives_for_oft_used_internal_apis"></a><a class="link" href="#alternatives_for_oft_used_internal_apis">Alternatives for oft-used internal APIs</a></h5>
<div class="paragraph">
<p>To provide a nested DSL for your custom task, don&#8217;t use <code>org.gradle.internal.reflect.Instantiator</code>; use <a href="../javadoc/org/gradle/api/model/ObjectFactory.html">ObjectFactory</a> instead.
It may also be helpful to read <a href="#lazy_configuration">the chapter on lazy configuration</a>.</p>
</div>
<div class="paragraph">
<p>Don&#8217;t use <code>org.gradle.api.internal.ConventionMapping</code>.
Use <a href="../javadoc/org/gradle/api/provider/Provider.html">Provider</a> and/or <a href="../javadoc/org/gradle/api/provider/Property.html">Property</a>.
You can find an example for capturing user input to configure runtime behavior in the <a href="https://guides.gradle.org/implementing-gradle-plugins/#capturing_user_input_to_configure_plugin_runtime_behavior">implementing plugins guide</a>.</p>
</div>
<div class="paragraph">
<p>Instead of <code>org.gradle.internal.os.OperatingSystem</code>, use another method to detect operating system, such as <a href="https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/SystemUtils.html">Apache commons-lang SystemUtils</a> or <code>System.getProperty("os.name")</code>.</p>
</div>
<div class="paragraph">
<p>Use other collections or I/O frameworks instead of <code>org.gradle.util.CollectionUtils</code>, <code>org.gradle.util.GFileUtils</code>, and other classes under <code>org.gradle.util.*</code>.</p>
</div>
<div class="paragraph">
<p>Gradle plugin authors may find the Designing Gradle Plugins subsection on <a href="https://guides.gradle.org/designing-gradle-plugins/#restricting_the_plugin_implementation_to_gradle_s_public_api">restricting the plugin implementation to Gradle&#8217;s public API</a> helpful.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring_tasks"><a class="anchor" href="#sec:declaring_tasks"></a><a class="link" href="#sec:declaring_tasks">Declaring tasks in a build script</a></h4>
<div class="paragraph">
<p>The task API gives a build author a lot of flexibility to declare tasks in a build script.
For optimal readability and maintainability follow these rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The task type should be the only key-value pair that belongs within the parentheses after the task name.</p>
</li>
<li>
<p>Any other configuration logic for a task should be defined as part of <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:task(java.lang.String,%20groovy.lang.Closure)">Project.task(java.lang.String, groovy.lang.Closure)</a> if possible.</p>
</li>
<li>
<p><a href="#sec:hello_world">Task actions</a> should only be declared with the methods <a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:doFirst(org.gradle.api.Action)">Task.doFirst{}</a> or <a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:doLast(org.gradle.api.Action)">Task.doLast{}</a>.</p>
</li>
<li>
<p><a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:doLast(org.gradle.api.Action)">Task.doLast{}</a> should be used if the task only defines a single action.</p>
</li>
<li>
<p>A task should <a href="#sec:improving_task_discoverability">define a group and description</a>.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="example_definition_of_tasks_following_best_practices"><a class="anchor" href="#example_definition_of_tasks_following_best_practices"></a><a class="link" href="#example_definition_of_tasks_following_best_practices">Example: Definition of tasks following best practices</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">com.enterprise.DocsGenerate</span>

task generateHtmlDocs(<span class="key">type</span>: DocsGenerate) {
    group = JavaBasePlugin.DOCUMENTATION_GROUP
    description = <span class="string"><span class="delimiter">'</span><span class="content">Generates the HTML documentation for this project.</span><span class="delimiter">'</span></span>
    title = <span class="string"><span class="delimiter">'</span><span class="content">Project docs</span><span class="delimiter">'</span></span>
    outputDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/docs</span><span class="delimiter">&quot;</span></span>)
}

task allDocs {
    group = JavaBasePlugin.DOCUMENTATION_GROUP
    description = <span class="string"><span class="delimiter">'</span><span class="content">Generates all documentation for this project.</span><span class="delimiter">'</span></span>
    dependsOn generateHtmlDocs

    doLast {
        logger.quiet(<span class="string"><span class="delimiter">'</span><span class="content">Generating all documentation...</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:improving_task_discoverability"><a class="anchor" href="#sec:improving_task_discoverability"></a><a class="link" href="#sec:improving_task_discoverability">Improving task discoverability</a></h4>
<div class="paragraph">
<p>Even new users to a build should to be able to find crucial information quickly and effortlessly.
In Gradle you can declare a <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:group">group</a> and a <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:description">description</a> for any task of the build.
The <a href="#sec:listing_tasks">tasks report</a> uses the assigned values to organize and render the task for easy discoverability.
Assigning a group and description is most helpful for any task that you expect build users to invoke.</p>
</div>
<div class="paragraph">
<p>The example task <code>generateDocs</code> generates documentation for a project in the form of HTML pages.
The task should be organized underneath the bucket <code>Documentation</code>.
The description should express its intent.</p>
</div>
<div class="sect4">
<h5 id="example_a_task_declaring_the_group_and_description"><a class="anchor" href="#example_a_task_declaring_the_group_and_description"></a><a class="link" href="#example_a_task_declaring_the_group_and_description">Example: A task declaring the group and description</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task generateDocs {
    group = <span class="string"><span class="delimiter">'</span><span class="content">Documentation</span><span class="delimiter">'</span></span>
    description = <span class="string"><span class="delimiter">'</span><span class="content">Generates the HTML documentation for this project.</span><span class="delimiter">'</span></span>

    doLast {
        <span class="comment">// action implementation</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output of the tasks report reflects the assigned values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; gradle tasks

&gt; Task :tasks

Documentation tasks
-------------------
generateDocs - Generates the HTML documentation for this project.</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:minimize_logic_executed_configuration_phase"><a class="anchor" href="#sec:minimize_logic_executed_configuration_phase"></a><a class="link" href="#sec:minimize_logic_executed_configuration_phase">Minimize logic executed during the configuration phase</a></h4>
<div class="paragraph">
<p>It&#8217;s important for every build script developer to understand the different phases of the <a href="#build_lifecycle">build lifecycle</a> and their implications on performance and evaluation order of build logic.
During the configuration phase the project and its domain objects should be <em>configured</em>, whereas the execution phase only executes the actions of the task(s) requested on the command line plus their dependencies.
Be aware that any code that is not part of a task action will be executed with <em>every single run</em> of the build.
A <a href="https://scans.gradle.com/get-started">build scan</a> can help you with identifying the time spent during each of the lifecycle phases.
It&#8217;s an invaluable tool for diagnosing common performance issues.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s consider the following incantation of the anti-pattern described above.
In the build script you can see that the dependencies assigned to the configuration <code>printArtifactNames</code> are resolved outside of the task action.</p>
</div>
<div class="sect4">
<h5 id="example_executing_logic_during_configuration_should_be_avoided"><a class="anchor" href="#example_executing_logic_during_configuration_should_be_avoided"></a><a class="link" href="#example_executing_logic_during_configuration_should_be_avoided">Example: Executing logic during configuration should be avoided</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">log4j:log4j:1.2.17</span><span class="delimiter">'</span></span>
}

task printArtifactNames {
    <span class="comment">// always executed</span>
    <span class="keyword">def</span> libraryNames = configurations.compileClasspath.collect { <span class="local-variable">it</span>.name }

    doLast {
        logger.quiet libraryNames
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code for resolving the dependencies should be moved into the task action to avoid the performance impact of resolving the dependencies before they are actually needed.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_executing_logic_during_execution_phase_is_preferred"><a class="anchor" href="#example_executing_logic_during_execution_phase_is_preferred"></a><a class="link" href="#example_executing_logic_during_execution_phase_is_preferred">Example: Executing logic during execution phase is preferred</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">log4j:log4j:1.2.17</span><span class="delimiter">'</span></span>
}

task printArtifactNames {
    doLast {
        <span class="keyword">def</span> libraryNames = configurations.compileClasspath.collect { <span class="local-variable">it</span>.name }
        logger.quiet libraryNames
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:avoiding_use_of_gradlebuild"><a class="anchor" href="#sec:avoiding_use_of_gradlebuild"></a><a class="link" href="#sec:avoiding_use_of_gradlebuild">Avoiding the use of <code>GradleBuild</code></a></h4>
<div class="paragraph">
<p>The <a href="../dsl/org.gradle.api.tasks.GradleBuild.html">GradleBuild</a> task type allows a build script to define a task that invokes another Gradle build.
The use of this type is generally discouraged.
There are some corner cases where the invoked build doesn&#8217;t expose the same runtime behavior as from the command line or through the Tooling API leading to unexpected results.</p>
</div>
<div class="paragraph">
<p>Usually, there&#8217;s a better way to model the requirement.
The appropriate approach depends on the problem at hand. Here&#8217;re some options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Model the build as <a href="#multi_project_builds">multi-project build</a> if the intention is to execute tasks from different modules as unified build.</p>
</li>
<li>
<p>Use <a href="#composite_builds">composite builds</a> for projects that are physically separated but should occasionally be built as a single unit.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:avoiding_inter_project_configuration"><a class="anchor" href="#sec:avoiding_inter_project_configuration"></a><a class="link" href="#sec:avoiding_inter_project_configuration">Avoiding inter-project configuration</a></h4>
<div class="paragraph">
<p>Gradle does not restrict build script authors from reaching into the domain model from one project into another one in a <a href="#multi_project_builds">multi-project build</a>.
Strongly-coupled projects hurts <a href="#sec:parallel_execution">build execution performance</a> as well as readability and maintainability of code.</p>
</div>
<div class="paragraph">
<p>The following practices should be avoided:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Explicitly depending on a task from another project via <a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:dependsOn(java.lang.Object[])">Task.dependsOn(java.lang.Object...)</a>.</p>
</li>
<li>
<p>Setting property values or calling methods on domain objects from another project.</p>
</li>
<li>
<p>Executing another portion of the build with <a href="#sec:avoiding_use_of_gradlebuild">GradleBuild</a>.</p>
</li>
<li>
<p>Declaring unnecessary <a href="#sec:declaring_project_dependency">project dependencies</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:avoiding_passwords_in_plain_text"><a class="anchor" href="#sec:avoiding_passwords_in_plain_text"></a><a class="link" href="#sec:avoiding_passwords_in_plain_text">Avoiding passwords in plain text</a></h4>
<div class="paragraph">
<p>Most builds need to consume one or many passwords.
The reasons for this need may vary.
Some builds need a password for publishing artifacts to a secured binary repository, other builds need a password for downloading binary files.
Passwords should always kept safe to prevent fraud.
Under no circumstance should you add the password to the build script as property in plain text or declare it in a <code>gradle.properties</code>.
Those files usually live in a version control repository and can be viewed by anyone that has access to it.</p>
</div>
<div class="paragraph">
<p>Passwords should be stored in encrypted fashion. At the moment Gradle does not provide a built-in mechanism for encrypting, storing and accessing passwords.
A good solution for solving this problem is the <a href="https://github.com/etiennestuder/gradle-credentials-plugin">Gradle Credentials plugin</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="organizing_gradle_projects"><a class="anchor" href="#organizing_gradle_projects"></a><a class="link" href="#organizing_gradle_projects">Organizing Gradle Projects</a></h3>
<div class="paragraph">
<p>Source code and build logic of every software project should be organized in a meaningful way.
This page lays out the best practices that lead to readable, maintainable projects.
The following sections also touch on common problems and how to avoid them.</p>
</div>
<div class="sect3">
<h4 id="sec:separate_language_source_files"><a class="anchor" href="#sec:separate_language_source_files"></a><a class="link" href="#sec:separate_language_source_files">Separate language-specific source files</a></h4>
<div class="paragraph">
<p>Gradle&#8217;s language plugins establish conventions for discovering and compiling source code.
For example, a project applying the <a href="#java_plugin">Java plugin</a> will automatically compile the code in the directory <code>src/main/java</code>.
Other language plugins follow the same pattern.
The last portion of the directory path usually indicates the expected language of the source files.</p>
</div>
<div class="paragraph">
<p>Some compilers are capable of cross-compiling multiple languages in the same source directory.
The Groovy compiler can handle the scenario of mixing Java and Groovy source files located in <code>src/main/groovy</code>.
Gradle recommends that you place sources in directories according to their language, because builds are more performant and both the user and build can make stronger assumptions.</p>
</div>
<div class="paragraph">
<p>The following source tree contains Java and Kotlin source files. Java source files live in <code>src/main/java</code>, whereas Kotlin source files live in <code>src/main/kotlin</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.
 build.gradle
 settings.gradle
 src
     main
         java
          HelloWorld.java
         kotlin
             Utils.kt</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:separate_test_type_source_files"><a class="anchor" href="#sec:separate_test_type_source_files"></a><a class="link" href="#sec:separate_test_type_source_files">Separate source files per test type</a></h4>
<div class="paragraph">
<p>It&#8217;s very common that a project defines and executes different types of tests e.g. unit tests, integration tests, functional tests or smoke tests.
Optimally, the test source code for each test type should be stored in dedicated source directories.
Separated test source code has a positive impact on maintainability and separation of concerns as you can run test types independent from each other.</p>
</div>
<div class="paragraph">
<p>The following source tree demonstrates how to separate unit from integration tests in a Java-based project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.
 build.gradle
 gradle
  integration-test.gradle
 settings.gradle
 src
     integTest
      java
          DefaultFileReaderIntegrationTest.java
     main
      java
          DefaultFileReader.java
          FileReader.java
          StringUtils.java
     test
         java
             StringUtilsTest.java</pre>
</div>
</div>
<div class="paragraph">
<p>Gradle models source code directories with the help of the <a href="#sec:java_source_sets">source set concept</a>.
By pointing an instance of a source set to one or many source code directories, Gradle will automatically create a corresponding compilation task out-of-the-box.</p>
</div>
<div class="sect4">
<h5 id="example_integration_test_source_set"><a class="anchor" href="#example_integration_test_source_set"></a><a class="link" href="#example_integration_test_source_set">Example: Integration test source set</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">gradle/integration-test.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sourceSets {
    integTest {
        java.srcDir file(<span class="string"><span class="delimiter">'</span><span class="content">src/integTest/java</span><span class="delimiter">'</span></span>)
        resources.srcDir file(<span class="string"><span class="delimiter">'</span><span class="content">src/integTest/resources</span><span class="delimiter">'</span></span>)
        compileClasspath += sourceSets.main.output + configurations.testRuntimeClasspath
        runtimeClasspath += output + compileClasspath
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Source sets are only responsible for compiling source code, but do not deal with executing the byte code.
For the purpose of test execution, a corresponding task of type <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a> needs to be established.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_integration_test_task"><a class="anchor" href="#example_integration_test_task"></a><a class="link" href="#example_integration_test_task">Example: Integration test task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">gradle/integration-test.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task integTest(<span class="key">type</span>: Test) {
    description = <span class="string"><span class="delimiter">'</span><span class="content">Runs the integration tests.</span><span class="delimiter">'</span></span>
    group = <span class="string"><span class="delimiter">'</span><span class="content">verification</span><span class="delimiter">'</span></span>
    testClassesDirs = sourceSets.integTest.output.classesDirs
    classpath = sourceSets.integTest.runtimeClasspath
    mustRunAfter test
}

check.dependsOn integTest</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:use_standard_conventions"><a class="anchor" href="#sec:use_standard_conventions"></a><a class="link" href="#sec:use_standard_conventions">Use standard conventions as much as possible</a></h4>
<div class="paragraph">
<p>All Gradle core plugins follow the software engineering paradigm <a href="https://en.wikipedia.org/wiki/Convention_over_configuration">convention over configuration</a>.
The plugin logic provides users with sensible defaults and standards, the conventions, in a certain context.
Lets take the <a href="#java_plugin">Java plugin</a> as an example.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It defines the directory <code>src/main/java</code> as the default source directory for compilation.</p>
</li>
<li>
<p>The output directory for compiled source code and other artifacts (like the JAR file) is <code>build</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By sticking to the default conventions, new developers to the project immediately know how to find their way around.
While those conventions can be reconfigured, it makes it harder to build script users and authors to manage the build logic and its outcome.
Try to stick to the default conventions as much as possible except if you need to adapt to the layout of a legacy project.
Refer to the reference page of the relevant plugin to learn about its default conventions.</p>
</div>
</div>
<div class="sect3">
<h4 id="always_define_a_settings_file"><a class="anchor" href="#always_define_a_settings_file"></a><a class="link" href="#always_define_a_settings_file">Always define a settings file</a></h4>
<div class="paragraph">
<p>Gradle tries to locate a <code>settings.gradle</code> (Groovy DSL) or a <code>settings.gradle.kts</code> (Kotlin DSL) file with every invocation of the build.
For that purpose, the runtime walks the hierarchy of the directory tree up to the root directory.
The algorithm stops searching as soon as it finds the settings file.</p>
</div>
<div class="paragraph">
<p>Always add a <code>settings.gradle</code> to the root directory of your build to avoid the initial performance impact.
This recommendation applies to single project builds as well as multi-project builds.
The file can either be empty or define the desired name of the project.</p>
</div>
<div class="paragraph">
<p>A typical Gradle project with a settings file look as such:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.
 build.gradle
 settings.gradle</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_sources"><a class="anchor" href="#sec:build_sources"></a><a class="link" href="#sec:build_sources">Use <code>buildSrc</code> to abstract imperative logic</a></h4>
<div class="paragraph">
<p>Complex build logic is usually a good candidate for being encapsulated either as custom task or binary plugin.
Custom task and plugin implementations should not live in the build script.
It is very convenient to use <code>buildSrc</code> for that purpose as long as the code does not need to be shared among multiple, independent projects.</p>
</div>
<div class="paragraph">
<p>The directory <code>buildSrc</code> is treated as an <a href="#composite_build_intro">included build</a>. Upon discovery of the directory, Gradle automatically compiles and tests this code and puts it in the classpath of your build script.
For multi-project builds there can be only one <code>buildSrc</code> directory, which has to sit in the root project directory.
<code>buildSrc</code> should be preferred over <a href="#sec:script_plugins">script plugins</a> as it is easier to maintain, refactor and test the code.</p>
</div>
<div class="paragraph">
<p><code>buildSrc</code> uses the same <a href="#javalayout">source code conventions</a> applicable to Java and Groovy projects.
It also provides direct access to the Gradle API. Additional dependencies can be declared in a dedicated <code>build.gradle</code> under <code>buildSrc</code>.</p>
</div>
<div class="sect4">
<h5 id="example_custom_buildsrc_build_script"><a class="anchor" href="#example_custom_buildsrc_build_script"></a><a class="link" href="#example_custom_buildsrc_build_script">Example: Custom buildSrc build script</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">buildSrc/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    testCompile <span class="string"><span class="delimiter">'</span><span class="content">junit:junit:4.12</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A typical project including <code>buildSrc</code> has the following layout.
Any code under <code>buildSrc</code> should use a package similar to application code.
Optionally, the <code>buildSrc</code> directory can host a build script if additional configuration is needed (e.g. to apply plugins or to declare dependencies).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.
 build.gradle
 buildSrc
  build.gradle
  src
      main
       java
           com
               enterprise
                   Deploy.java
                   DeploymentPlugin.java
      test
          java
              com
                  enterprise
                      DeploymentPluginTest.java
 settings.gradle</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="declare_properties_in_gradle_properties_file"><a class="anchor" href="#declare_properties_in_gradle_properties_file"></a><a class="link" href="#declare_properties_in_gradle_properties_file">Declare properties in <code>gradle.properties</code> file</a></h4>
<div class="paragraph">
<p>In Gradle, properties can be define in the build script, in a <code>gradle.properties</code> file or as parameters on the command line.</p>
</div>
<div class="paragraph">
<p>It&#8217;s common to declare properties on the command line for ad-hoc scenarios.
For example you may want to pass in a specific property value to control runtime behavior just for this one invocation of the build.
Properties in a build script can easily become a maintenance headache and convolute the build script logic.
The <code>gradle.properties</code> helps with keeping properties separate from the build script and should be explored as viable option.
It&#8217;s a good location for placing <a href="#sec:gradle_configuration_properties">properties that control the build environment</a>.</p>
</div>
<div class="paragraph">
<p>A typical project setup places the <code>gradle.properties</code> file in the root directory of the build.
Alternatively, the file can also live in the <code>GRADLE_USER_HOME</code> directory if you want to it apply to all builds on your machine.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.
 build.gradle
 gradle.properties
 settings.gradle</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="avoid_overlapping_task_outputs"><a class="anchor" href="#avoid_overlapping_task_outputs"></a><a class="link" href="#avoid_overlapping_task_outputs">Avoid overlapping task outputs</a></h4>
<div class="paragraph">
<p>Tasks should define inputs and outputs to get the performance benefits of <a href="#sec:up_to_date_checks">incremental build functionality</a>.
When declaring the outputs of a task, make sure that the directory for writing outputs is unique among all the tasks in your project.</p>
</div>
<div class="paragraph">
<p>Intermingling or overwriting output files produced by different tasks compromises up-to-date checking causing slower builds.
In turn, these filesystem changes may prevent Gradle&#8217;s <a href="#build_cache">build cache</a> from properly identifying and caching what would otherwise be cacheable tasks.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:custom_gradle_distribution"><a class="anchor" href="#sec:custom_gradle_distribution"></a><a class="link" href="#sec:custom_gradle_distribution">Standardizing builds with a custom Gradle distribution</a></h4>
<div class="paragraph">
<p>Often enterprises want to standardize the build platform for all projects in the organization by defining common conventions or rules.
You can achieve that with the help of initialization scripts.
<a href="#init_scripts">Initialization scripts</a> make it extremely easy to apply build logic across all projects on a single machine.
For example, to declare a in-house repository and its credentials.</p>
</div>
<div class="paragraph">
<p>There are some drawbacks to the approach.
First of all, you will have to communicate the setup process across all developers in the company.
Furthermore, updating the initialization script logic uniformly can prove challenging.</p>
</div>
<div class="paragraph">
<p>Custom Gradle distributions are a practical solution to this very problem.
A custom Gradle distribution is comprised of the standard Gradle distribution plus one or many custom initialization scripts.
The initialization scripts come bundled with the distribution and are applied every time the build is run.
Developers only need to point their checked-in <a href="#gradle_wrapper">Wrapper</a> files to the URL of the custom Gradle distribution.</p>
</div>
<div class="paragraph">
<p>The following steps are typical for creating a custom Gradle distribution:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Implement logic for downloading and repackaging a Gradle distribution.</p>
</li>
<li>
<p>Define one or many initialization scripts with the desired logic.</p>
</li>
<li>
<p>Bundle the initialization scripts with the Gradle distribution.</p>
</li>
<li>
<p>Upload the Gradle distribution archive to a HTTP server.</p>
</li>
<li>
<p>Change the Wrapper files of all projects to point to the URL of the custom Gradle distribution.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can find a sample project that covers steps one to three in the <code>samples</code> directory of the standard <code>-all</code> Gradle distribution.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="build_cache"><a class="anchor" href="#build_cache"></a><a class="link" href="#build_cache">Build Cache</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The build cache feature described here is different from the <a href="https://developer.android.com/studio/build/build-cache.html">Android plugin build cache</a>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec:build_cache_intro"><a class="anchor" href="#sec:build_cache_intro"></a><a class="link" href="#sec:build_cache_intro">Overview</a></h4>
<div class="paragraph">
<p>The Gradle <em>build cache</em> is a cache mechanism that aims to save time by reusing outputs produced by other builds.
The build cache works by storing (locally or remotely) build outputs and allowing builds to fetch these outputs from the cache when it is determined that inputs have not changed, avoiding the expensive work of regenerating them.</p>
</div>
<div class="paragraph">
<p>A first feature using the build cache is <em>task output caching</em>.
Essentially, task output caching leverages the same intelligence as <a href="#sec:up_to_date_checks">up-to-date checks</a> that Gradle uses to avoid work when a previous local build has already produced a set of task outputs.
But instead of being limited to the previous build in the same workspace, task output caching allows Gradle to reuse task outputs from any earlier build in any location on the local machine.
When using a shared build cache for task output caching this even works across developer machines and build agents.</p>
</div>
<div class="paragraph">
<p>Apart from task output caching, we expect other features to use the build cache in the future.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A complete guide is available about <a href="https://guides.gradle.org/using-build-cache/">using the build cache</a>. It covers the different scenarios caching can improve, and detailed discussions of the different caveats you need to be aware of when enabling caching for a build.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_cache_enable"><a class="anchor" href="#sec:build_cache_enable"></a><a class="link" href="#sec:build_cache_enable">Enable the Build Cache</a></h4>
<div class="paragraph">
<p>By default, the build cache is not enabled. You can enable the build cache in a couple of ways:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Run with <code>--build-cache</code> on the command-line</dt>
<dd>
<p>Gradle will use the build cache for this build only.</p>
</dd>
<dt class="hdlist1">Put <code>org.gradle.caching=true</code> in your <code>gradle.properties</code></dt>
<dd>
<p>Gradle will try to reuse outputs from previous builds for all builds, unless explicitly disabled with <code>--no-build-cache</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>When the build cache is enabled, it will store build outputs in the Gradle user home.
For configuring this directory or different kinds of build caches see <a href="#sec:build_cache_configure">Configure the Build Cache</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:task_output_caching"><a class="anchor" href="#sec:task_output_caching"></a><a class="link" href="#sec:task_output_caching">Task Output Caching</a></h4>
<div class="paragraph">
<p>Beyond incremental builds described in <a href="#sec:up_to_date_checks">up-to-date checks</a>, Gradle can save time by reusing outputs from previous executions of a task by matching inputs to the task.
Task outputs can be reused between builds on one computer or even between builds running on different computers via a build cache.</p>
</div>
<div class="paragraph">
<p>We have focused on the use case where users have an organization-wide remote build cache that is populated regularly by continuous integration builds.
Developers and other continuous integration agents should load cache entries from the remote build cache.
We expect that developers will not be allowed to populate the remote build cache, and all continuous integration builds populate the build cache after running the <code>clean</code> task.</p>
</div>
<div class="paragraph">
<p>For your build to play well with task output caching it must work well with the <a href="#sec:up_to_date_checks">incremental build</a> feature.
For example, when running your build twice in a row all tasks with outputs should be <code>UP-TO-DATE</code>.
You cannot expect faster builds or correct builds when enabling task output caching when this prerequisite is not met.</p>
</div>
<div class="paragraph">
<p>Task output caching is automatically enabled when you enable the build cache, see <a href="#sec:build_cache_enable">Enable the Build Cache</a>.</p>
</div>
<div class="sect4">
<h5 id="sec:task_output_caching_example"><a class="anchor" href="#sec:task_output_caching_example"></a><a class="link" href="#sec:task_output_caching_example">What does it look like</a></h5>
<div class="paragraph">
<p>Let us start with a project using the Java plugin which has a few Java source files. We run the build the first time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; gradle --build-cache compileJava
:compileJava
:processResources
:classes
:jar
:assemble

BUILD SUCCESSFUL</pre>
</div>
</div>
<div class="paragraph">
<p>We see the directory used by the local build cache in the output. Apart from that the build was the same as without the build cache.
Let&#8217;s clean and run the build again.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; gradle clean
:clean

BUILD SUCCESSFUL</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; gradle --build-cache assemble
:compileJava FROM-CACHE
:processResources
:classes
:jar
:assemble

BUILD SUCCESSFUL</pre>
</div>
</div>
<div class="paragraph">
<p>Now we see that, instead of executing the <code>:compileJava</code> task, the outputs of the task have been loaded from the build cache.
The other tasks have not been loaded from the build cache since they are not cacheable. This is due to
<code>:classes</code> and <code>:assemble</code> being <a href="#sec:lifecycle_tasks">lifecycle tasks</a> and <code>:processResources</code>
and <code>:jar</code> being Copy-like tasks which are not cacheable since it is generally faster to execute them.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:task_output_caching_details"><a class="anchor" href="#sec:task_output_caching_details"></a><a class="link" href="#sec:task_output_caching_details">Cacheable tasks</a></h4>
<div class="paragraph">
<p>Since a task describes all of its inputs and outputs, Gradle can compute a <em>build cache key</em> that uniquely defines the task&#8217;s outputs based on its inputs.
That build cache key is used to request previous outputs from a build cache or store new outputs in the build cache.
If the previous build outputs have been already stored in the cache by someone else, e.g. your continuous integration server or other developers, you can avoid executing most tasks locally.</p>
</div>
<div class="paragraph">
<p>The following inputs contribute to the build cache key for a task in the same way that they do for <a href="#sec:how_does_it_work">up-to-date checks</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The task type and its classpath</p>
</li>
<li>
<p>The names of the output properties</p>
</li>
<li>
<p>The names and values of properties annotated as described in <a href="#sec:task_input_output_annotations">the section called "Custom task types"</a></p>
</li>
<li>
<p>The names and values of properties added by the DSL via <a href="../javadoc/org/gradle/api/tasks/TaskInputs.html">TaskInputs</a></p>
</li>
<li>
<p>The classpath of the Gradle distribution, buildSrc and plugins</p>
</li>
<li>
<p>The content of the build script when it affects execution of the task</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Task types need to opt-in to task output caching using the <a href="../javadoc/org/gradle/api/tasks/CacheableTask.html">@CacheableTask</a> annotation.
Note that <a href="../javadoc/org/gradle/api/tasks/CacheableTask.html">@CacheableTask</a> is not inherited by subclasses.
Custom task types are <em>not</em> cacheable by default.</p>
</div>
<div class="sect4">
<h5 id="sec:task_output_caching_cacheable_tasks"><a class="anchor" href="#sec:task_output_caching_cacheable_tasks"></a><a class="link" href="#sec:task_output_caching_cacheable_tasks">Built-in cacheable tasks</a></h5>
<div class="paragraph">
<p>Currently, the following built-in Gradle tasks are cacheable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java toolchain:
<a href="../dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a>,
<a href="../dsl/org.gradle.api.tasks.javadoc.Javadoc.html">Javadoc</a></p>
</li>
<li>
<p>Groovy toolchain:
<a href="../dsl/org.gradle.api.tasks.compile.GroovyCompile.html">GroovyCompile</a>,
<a href="../dsl/org.gradle.api.tasks.javadoc.Groovydoc.html">Groovydoc</a></p>
</li>
<li>
<p>Scala toolchain:
<a href="../dsl/org.gradle.api.tasks.scala.ScalaCompile.html">ScalaCompile</a>,
<a href="../javadoc/org/gradle/language/scala/tasks/PlatformScalaCompile.html">PlatformScalaCompile</a>,
<a href="../dsl/org.gradle.api.tasks.scala.ScalaDoc.html">ScalaDoc</a></p>
</li>
<li>
<p>Native toolchain:
<a href="../javadoc/org/gradle/language/cpp/tasks/CppCompile.html">CppCompile</a>,
<a href="../javadoc/org/gradle/language/c/tasks/CCompile.html">CCompile</a>,
<a href="../javadoc/org/gradle/language/swift/tasks/SwiftCompile.html">SwiftCompile</a></p>
</li>
<li>
<p>Testing:
<a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a></p>
</li>
<li>
<p>Code quality tasks:
<a href="../dsl/org.gradle.api.plugins.quality.Checkstyle.html">Checkstyle</a>,
<a href="../dsl/org.gradle.api.plugins.quality.CodeNarc.html">CodeNarc</a>,
<a href="../dsl/org.gradle.api.plugins.quality.FindBugs.html">FindBugs</a>,
<a href="../dsl/org.gradle.api.plugins.quality.JDepend.html">JDepend</a>,
<a href="../dsl/org.gradle.api.plugins.quality.Pmd.html">Pmd</a></p>
</li>
<li>
<p>JaCoCo:
<a href="../dsl/org.gradle.testing.jacoco.tasks.JacocoMerge.html">JacocoMerge</a>,
<a href="../dsl/org.gradle.testing.jacoco.tasks.JacocoReport.html">JacocoReport</a></p>
</li>
<li>
<p>Other tasks:
<a href="../dsl/org.gradle.api.plugins.antlr.AntlrTask.html">AntlrTask</a>,
<a href="../javadoc/org/gradle/plugin/devel/tasks/ValidateTaskProperties.html">ValidateTaskProperties</a>,
<a href="../dsl/org.gradle.api.tasks.WriteProperties.html">WriteProperties</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All other built-in tasks are currently not cacheable.</p>
</div>
<div class="paragraph">
<p>Some tasks, like <a href="../dsl/org.gradle.api.tasks.Copy.html">Copy</a> or <a href="../dsl/org.gradle.api.tasks.bundling.Jar.html">Jar</a>, usually do not make sense to make cacheable because Gradle is only copying files from one location to another.
It also doesn&#8217;t make sense to make tasks cacheable that do not produce outputs or have no task actions.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:task_output_caching_cacheable_3rd_party"><a class="anchor" href="#sec:task_output_caching_cacheable_3rd_party"></a><a class="link" href="#sec:task_output_caching_cacheable_3rd_party">Third party plugins</a></h5>
<div class="paragraph">
<p>There are third party plugins that work well with the build cache.
The most prominent examples are the <a href="https://developer.android.com/studio/releases/gradle-plugin.html">Android plugin 3.1+</a> and the <a href="https://blog.gradle.org/kotlin-build-cache-use">Kotlin plugin 1.2.21+</a>.
For other third party plugins, check their documentation to find out whether they support the build cache.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:task_output_caching_inputs"><a class="anchor" href="#sec:task_output_caching_inputs"></a><a class="link" href="#sec:task_output_caching_inputs">Declaring task inputs and outputs</a></h5>
<div class="paragraph">
<p>It is very important that a cacheable task has a complete picture of its inputs and outputs, so that the results from one build can be safely re-used somewhere else.</p>
</div>
<div class="paragraph">
<p>Missing task inputs can cause incorrect cache hits, where different results are treated as identical because the same cache key is used by both executions.
Missing task outputs can cause build failures if Gradle does not completely capture all outputs for a given task.
Wrongly declared task inputs can lead to cache misses especially when containing volatile data or absolute paths.
(See <a href="#sec:task_inputs_outputs">the section called "Task inputs and outputs"</a> on what should be declared as inputs and outputs.)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The task path is <em>not</em> an input to the build cache key.
This means that tasks with different task paths can re-use each other&#8217;s outputs as long as Gradle determines that executing them yields the same result.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to ensure that the inputs and outputs are properly declared use integration tests (for example using TestKit) to check that a task produces the same outputs for identical inputs and captures all output files for the task.
We suggest adding tests to ensure that the task inputs are relocatable, i.e. that the task can be loaded from the cache into a different build directory (see <a href="../javadoc/org/gradle/api/tasks/PathSensitive.html">@PathSensitive</a>).</p>
</div>
<div class="paragraph">
<p>In order to handle volatile inputs for your tasks consider <a href="#sec:configure_input_normalization">configuring input normalization</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_cache_configure"><a class="anchor" href="#sec:build_cache_configure"></a><a class="link" href="#sec:build_cache_configure">Configure the Build Cache</a></h4>
<div class="paragraph">
<p>You can configure the build cache by using the <a href="../dsl/org.gradle.api.initialization.Settings.html#org.gradle.api.initialization.Settings:buildCache(org.gradle.api.Action)">Settings.buildCache(org.gradle.api.Action)</a> block in <code>settings.gradle</code>.</p>
</div>
<div class="paragraph">
<p>Gradle supports a <code>local</code> and a <code>remote</code> build cache that can be configured separately.
When both build caches are enabled, Gradle tries to load build outputs from the local build cache first, and then tries the remote build cache if no build outputs are found.
If outputs are found in the remote cache, they are also stored in the local cache, so next time they will be found locally.
Gradle stores ("pushes") build outputs in any build cache that is enabled and has <a href="../javadoc//org/gradle/caching/configuration/BuildCache.html#isPush--">BuildCache.isPush()</a> set to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>By default, the local build cache has push enabled, and the remote build cache has push disabled.</p>
</div>
<div class="paragraph">
<p>The local build cache is pre-configured to be a <a href="../dsl/org.gradle.caching.local.DirectoryBuildCache.html">DirectoryBuildCache</a> and enabled by default.
The remote build cache can be configured by specifying the type of build cache to connect to (<a href="../dsl/org.gradle.caching.configuration.BuildCacheConfiguration.html#org.gradle.caching.configuration.BuildCacheConfiguration:remote(java.lang.Class)">BuildCacheConfiguration.remote(java.lang.Class)</a>).</p>
</div>
<div class="sect4">
<h5 id="sec:build_cache_configure_local"><a class="anchor" href="#sec:build_cache_configure_local"></a><a class="link" href="#sec:build_cache_configure_local">Built-in local build cache</a></h5>
<div class="paragraph">
<p>The built-in local build cache, <a href="../dsl/org.gradle.caching.local.DirectoryBuildCache.html">DirectoryBuildCache</a>, uses a directory to store build cache artifacts.
By default, this directory resides in the Gradle user home directory, but its location is configurable.</p>
</div>
<div class="paragraph">
<p>Gradle will periodically clean-up the local cache directory by removing entries that have not been used recently to conserve disk space.</p>
</div>
<div class="paragraph">
<p>For more details on the configuration options refer to the DSL documentation of <a href="../dsl/org.gradle.caching.local.DirectoryBuildCache.html">DirectoryBuildCache</a>.
Here is an example of the configuration.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configure_the_local_cache"><a class="anchor" href="#example_configure_the_local_cache"></a><a class="link" href="#example_configure_the_local_cache">Example: Configure the local cache</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">buildCache {
    local(DirectoryBuildCache) {
        directory = <span class="keyword">new</span> <span class="predefined-type">File</span>(rootDir, <span class="string"><span class="delimiter">'</span><span class="content">build-cache</span><span class="delimiter">'</span></span>)
        removeUnusedEntriesAfterDays = <span class="integer">30</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:build_cache_configure_remote"><a class="anchor" href="#sec:build_cache_configure_remote"></a><a class="link" href="#sec:build_cache_configure_remote">Remote HTTP build cache</a></h5>
<div class="paragraph">
<p>Gradle has built-in support for connecting to a remote build cache backend via HTTP.
For more details on what the protocol looks like see <a href="../dsl/org.gradle.caching.http.HttpBuildCache.html">HttpBuildCache</a>.
Note that by using the following configuration the local build cache will be used for storing build outputs while the local and the remote build cache will be used for retrieving build outputs.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_load_from_httpbuildcache"><a class="anchor" href="#example_load_from_httpbuildcache"></a><a class="link" href="#example_load_from_httpbuildcache">Example: Load from HttpBuildCache</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">buildCache {
    remote(HttpBuildCache) {
        url = <span class="string"><span class="delimiter">'</span><span class="content">https://example.com:8123/cache/</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can configure the credentials the <a href="../dsl/org.gradle.caching.http.HttpBuildCache.html">HttpBuildCache</a> uses to access the build cache server as shown in the following example.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configure_remote_http_cache"><a class="anchor" href="#example_configure_remote_http_cache"></a><a class="link" href="#example_configure_remote_http_cache">Example: Configure remote HTTP cache</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">buildCache {
    remote(HttpBuildCache) {
        url = <span class="string"><span class="delimiter">'</span><span class="content">http://example.com:8123/cache/</span><span class="delimiter">'</span></span>
        credentials {
            username = <span class="string"><span class="delimiter">'</span><span class="content">build-cache-user</span><span class="delimiter">'</span></span>
            password = <span class="string"><span class="delimiter">'</span><span class="content">some-complicated-password</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You may encounter problems with an untrusted SSL certificate when you try to use a build cache backend with an HTTPS URL.
The ideal solution is for someone to add a valid SSL certificate to the build cache backend, but we recognize that you may not be able to do that.
In that case, set <a href="../dsl/org.gradle.caching.http.HttpBuildCache.html#org.gradle.caching.http.HttpBuildCache:allowUntrustedServer">HttpBuildCache.isAllowUntrustedServer()</a> to <code>true</code>:</p>
</div>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">buildCache {
    remote(HttpBuildCache) {
        url = <span class="string"><span class="delimiter">'</span><span class="content">https://example.com:8123/cache/</span><span class="delimiter">'</span></span>
        allowUntrustedServer = <span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a convenient workaround, but you shouldnt use it as a long-term solution.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:build_cache_configure_use_cases"><a class="anchor" href="#sec:build_cache_configure_use_cases"></a><a class="link" href="#sec:build_cache_configure_use_cases">Configuration use cases</a></h5>
<div class="paragraph">
<p>The recommended use case for the build cache is that your continuous integration server populates the remote build cache from clean builds while developers load from the remote build cache and store in the local build cache.
The configuration would then look as follows.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_recommended_setup_for_ci_push_use_case"><a class="anchor" href="#example_recommended_setup_for_ci_push_use_case"></a><a class="link" href="#example_recommended_setup_for_ci_push_use_case">Example: Recommended setup for CI push use case</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ext.isCiServer = <span class="predefined-type">System</span>.getenv().containsKey(<span class="string"><span class="delimiter">&quot;</span><span class="content">CI</span><span class="delimiter">&quot;</span></span>)

buildCache {
    local {
        enabled = !isCiServer
    }
    remote(HttpBuildCache) {
        url = <span class="string"><span class="delimiter">'</span><span class="content">https://example.com:8123/cache/</span><span class="delimiter">'</span></span>
        push = isCiServer
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you use a <code>buildSrc</code> directory, you should make sure that it uses the same build cache configuration as the main build.
This can be achieved by applying the same script to <code>buildSrc/settings.gradle</code> and <code>settings.gradle</code> as shown in the following example.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_consistent_setup_for_buildsrc_and_main_build"><a class="anchor" href="#example_consistent_setup_for_buildsrc_and_main_build"></a><a class="link" href="#example_consistent_setup_for_buildsrc_and_main_build">Example: Consistent setup for buildSrc and main build</a></h5>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">from</span>: <span class="keyword">new</span> <span class="predefined-type">File</span>(settingsDir, <span class="string"><span class="delimiter">'</span><span class="content">gradle/buildCacheSettings.gradle</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">gradle/buildCacheSettings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ext.isCiServer = <span class="predefined-type">System</span>.getenv().containsKey(<span class="string"><span class="delimiter">&quot;</span><span class="content">CI</span><span class="delimiter">&quot;</span></span>)

buildCache {
    local {
        enabled = !isCiServer
    }
    remote(HttpBuildCache) {
        url = <span class="string"><span class="delimiter">'</span><span class="content">https://example.com:8123/cache/</span><span class="delimiter">'</span></span>
        push = isCiServer
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">buildSrc/settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">from</span>: <span class="keyword">new</span> <span class="predefined-type">File</span>(settingsDir, <span class="string"><span class="delimiter">'</span><span class="content">../gradle/buildCacheSettings.gradle</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>It is also possible to configure the build cache from an <a href="#sec:using_an_init_script">init script</a>, which can be used from the command line, added to your Gradle user home or be a part of your custom Gradle distribution.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_init_script_to_configure_the_build_cache"><a class="anchor" href="#example_init_script_to_configure_the_build_cache"></a><a class="link" href="#example_init_script_to_configure_the_build_cache">Example: Init script to configure the build cache</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">init.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">gradle.settingsEvaluated { settings -&gt;
    settings.buildCache {
        <span class="comment">// vvv Your custom configuration goes here</span>
        remote(HttpBuildCache) {
            url = <span class="string"><span class="delimiter">'</span><span class="content">https://example.com:8123/cache/</span><span class="delimiter">'</span></span>
        }
        <span class="comment">// ^^^ Your custom configuration goes here</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:build_cache_composite"><a class="anchor" href="#sec:build_cache_composite"></a><a class="link" href="#sec:build_cache_composite">Build cache and composite builds</a></h5>
<div class="paragraph">
<p>Gradle&#8217;s <a href="#composite_builds">composite build feature</a> allows including other complete Gradle builds into another.
Such included builds will inherit the build cache configuration from the top level build,
regardless of whether the included builds define build cache configuration themselves or not.</p>
</div>
<div class="paragraph">
<p>The build cache configuration present for any included build is effectively ignored, in favour of the top level build&#8217;s configuration.
This also applies to any <code>buildSrc</code> projects of any included builds.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_cache_setup_http_backend"><a class="anchor" href="#sec:build_cache_setup_http_backend"></a><a class="link" href="#sec:build_cache_setup_http_backend">How to set up an HTTP build cache backend</a></h4>
<div class="paragraph">
<p>Gradle provides a Docker image for a <a href="https://hub.docker.com/r/gradle/build-cache-node/">build cache node</a>, which can connect with Gradle Enterprise for centralized management.
The cache node can also be used without a Gradle Enterprise installation with restricted functionality.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_cache_implement"><a class="anchor" href="#sec:build_cache_implement"></a><a class="link" href="#sec:build_cache_implement">Implement your own Build Cache</a></h4>
<div class="paragraph">
<p>Using a different build cache backend to store build outputs (which is not covered by the built-in support for connecting to an HTTP backend) requires implementing
your own logic for connecting to your custom build cache backend.
To this end, custom build cache types can be registered via <a href="../javadoc/org/gradle/caching/configuration/BuildCacheConfiguration.html#registerBuildCacheService-java.lang.Class-java.lang.Class-">BuildCacheConfiguration.registerBuildCacheService(java.lang.Class, java.lang.Class)</a>.</p>
</div>
<div class="paragraph">
<p><a href="https://gradle.com/build-cache">Gradle Enterprise</a> includes a high-performance, easy to install and operate, shared build cache backend.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="build_init_plugin"><a class="anchor" href="#build_init_plugin"></a><a class="link" href="#build_init_plugin">Build Init Plugin</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The Build Init plugin is currently <a href="#feature_lifecycle">incubating</a>. Please be aware that the DSL and other configuration may change in later Gradle versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Gradle Build Init plugin can be used to bootstrap the process of creating a new Gradle build. It supports creating brand new projects of different types as well as converting existing builds (e.g. An Apache Maven build) to be Gradle builds.</p>
</div>
<div class="paragraph">
<p>Gradle plugins typically need to be <em>applied</em> to a project before they can be used (see <a href="#sec:using_plugins">Using plugins</a>). The Build Init plugin is an automatically applied plugin, which means you do not need to apply it explicitly. To use the plugin, simply execute the task named <code>init</code> where you would like to create the Gradle build. There is no need to create a stub <code>build.gradle</code> file in order to apply the plugin.</p>
</div>
<div class="paragraph">
<p>It also leverages the <code>wrapper</code> task to <a href="#sec:adding_wrapper">generate the Gradle Wrapper files</a> for the project.</p>
</div>
<div class="sect3">
<h4 id="sec:build_init_tasks"><a class="anchor" href="#sec:build_init_tasks"></a><a class="link" href="#sec:build_init_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The plugin adds the following tasks to the project:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>init</code>  <a href="../dsl/org.gradle.buildinit.tasks.InitBuild.html">InitBuild</a></dt>
<dd>
<p><em>Depends on</em>: <code>wrapper</code></p>
<div class="paragraph">
<p>Generates a Gradle project.</p>
</div>
</dd>
<dt class="hdlist1"><code>wrapper</code>  <a href="../dsl/org.gradle.api.tasks.wrapper.Wrapper.html">Wrapper</a></dt>
<dd>
<p>Generates Gradle wrapper files.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:what_to_set_up"><a class="anchor" href="#sec:what_to_set_up"></a><a class="link" href="#sec:what_to_set_up">What to set up</a></h4>
<div class="paragraph">
<p>The <code>init</code> supports different build setup <em>types</em>. The type is specified by supplying a <code>--type</code> argument value. For example, to create a Java library project simply execute: <code>gradle init --type java-library</code>.</p>
</div>
<div class="paragraph">
<p>If a <code>--type</code> parameter is not supplied, Gradle will attempt to infer the type from the environment. For example, it will infer a type value of <code>pom</code> if it finds a <code>pom.xml</code> to convert to a Gradle build.</p>
</div>
<div class="paragraph">
<p>If the type could not be inferred, the type <code>basic</code> will be used.</p>
</div>
<div class="paragraph">
<p>The <code>init</code> plugin also supports generating build scripts using either the Gradle Groovy DSL or the Gradle Kotlin DSL. The build script DSL to use defaults to the Groovy DSL and is specified by supplying a <code>--dsl</code> argument value. For example, to create a Java library project with Kotlin DSL build scripts simply execute: <code>gradle init --type java-library --dsl kotlin</code>.</p>
</div>
<div class="paragraph">
<p>All build setup types include the setup of the Gradle Wrapper.</p>
</div>
<div class="paragraph">
<p>Note that the migration from Maven builds only supports the Groovy DSL for generated build scripts.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_init_types"><a class="anchor" href="#sec:build_init_types"></a><a class="link" href="#sec:build_init_types">Build init types</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>As this plugin is currently <a href="#feature_lifecycle">incubating</a>, only a few build init types are currently supported. More types will be added in future Gradle releases.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="sec:pom_maven_conversion_"><a class="anchor" href="#sec:pom_maven_conversion_"></a><a class="link" href="#sec:pom_maven_conversion_"><code>pom</code> (Maven conversion)</a></h5>
<div class="paragraph">
<p>The <code>pom</code> type can be used to convert an Apache Maven build to a Gradle build. This works by converting the POM to one or more Gradle files. It is only able to be used if there is a valid <code>pom.xml</code> file in the directory that the <code>init</code> task is invoked in or, if invoked via the &#8220;-p&#8221; <a href="#command_line_interface">command line option</a>, in the specified project directory. This <code>pom</code> type will be automatically inferred if such a file exists.</p>
</div>
<div class="paragraph">
<p>The Maven conversion implementation was inspired by the <a href="https://github.com/jbaruch/maven2gradle">maven2gradle tool</a> that was originally developed by Gradle community members.</p>
</div>
<div class="paragraph">
<p>The conversion process has the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Uses effective POM and effective settings (support for POM inheritance, dependency management, properties)</p>
</li>
<li>
<p>Supports both single module and multimodule projects</p>
</li>
<li>
<p>Supports custom module names (that differ from directory names)</p>
</li>
<li>
<p>Generates general metadata - id, description and version</p>
</li>
<li>
<p>Applies maven, java and war plugins (as needed)</p>
</li>
<li>
<p>Supports packaging war projects as jars if needed</p>
</li>
<li>
<p>Generates dependencies (both external and inter-module)</p>
</li>
<li>
<p>Generates download repositories (inc. local Maven repository)</p>
</li>
<li>
<p>Adjusts Java compiler settings</p>
</li>
<li>
<p>Supports packaging of sources and tests</p>
</li>
<li>
<p>Supports TestNG runner</p>
</li>
<li>
<p>Generates global exclusions from Maven enforcer plugin settings</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sec:javaapplication_"><a class="anchor" href="#sec:javaapplication_"></a><a class="link" href="#sec:javaapplication_"><code>java-application</code></a></h5>
<div class="paragraph">
<p>The <code>java-application</code> build init type is not inferable. It must be explicitly specified.</p>
</div>
<div class="paragraph">
<p>It has the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Uses the <code>application</code> plugin to produce a command-line application implemented using Java</p>
</li>
<li>
<p>Uses the <code>jcenter</code> dependency repository</p>
</li>
<li>
<p>Uses <a href="http://junit.org">JUnit</a> for testing</p>
</li>
<li>
<p>Has directories in the conventional locations for source code</p>
</li>
<li>
<p>Contains a sample class and unit test, if there are no existing source or test files</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternative test framework can be specified by supplying a <code>--test-framework</code> argument value. To use a different test framework, execute one of the following commands:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>gradle init --type java-application --test-framework spock</code>: Uses <a href="http://code.google.com/p/spock/">Spock</a> for testing instead of JUnit</p>
</li>
<li>
<p><code>gradle init --type java-application --test-framework testng</code>: Uses <a href="http://testng.org/doc/index.html">TestNG</a> for testing instead of JUnit</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sec:javalibrary_"><a class="anchor" href="#sec:javalibrary_"></a><a class="link" href="#sec:javalibrary_"><code>java-library</code></a></h5>
<div class="paragraph">
<p>The <code>java-library</code> build init type is not inferable. It must be explicitly specified.</p>
</div>
<div class="paragraph">
<p>It has the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Uses the <code>java</code> plugin to produce a library Jar</p>
</li>
<li>
<p>Uses the <code>jcenter</code> dependency repository</p>
</li>
<li>
<p>Uses <a href="http://junit.org">JUnit</a> for testing</p>
</li>
<li>
<p>Has directories in the conventional locations for source code</p>
</li>
<li>
<p>Contains a sample class and unit test, if there are no existing source or test files</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternative test framework can be specified by supplying a <code>--test-framework</code> argument value. To use a different test framework, execute one of the following commands:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>gradle init --type java-library --test-framework spock</code>: Uses <a href="http://code.google.com/p/spock/">Spock</a> for testing instead of JUnit</p>
</li>
<li>
<p><code>gradle init --type java-library --test-framework testng</code>: Uses <a href="http://testng.org/doc/index.html">TestNG</a> for testing instead of JUnit</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sec:scalalibrary_"><a class="anchor" href="#sec:scalalibrary_"></a><a class="link" href="#sec:scalalibrary_"><code>scala-library</code></a></h5>
<div class="paragraph">
<p>The <code>scala-library</code> build init type is not inferable. It must be explicitly specified.</p>
</div>
<div class="paragraph">
<p>It has the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Uses the <code>scala</code> plugin to produce a library Jar</p>
</li>
<li>
<p>Uses the <code>jcenter</code> dependency repository</p>
</li>
<li>
<p>Uses Scala 2.10</p>
</li>
<li>
<p>Uses <a href="http://www.scalatest.org">ScalaTest</a> for testing</p>
</li>
<li>
<p>Has directories in the conventional locations for source code</p>
</li>
<li>
<p>Contains a sample scala class and an associated ScalaTest test suite, if there are no existing source or test files</p>
</li>
<li>
<p>Uses the Zinc Scala compiler by default</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sec:groovylibrary_"><a class="anchor" href="#sec:groovylibrary_"></a><a class="link" href="#sec:groovylibrary_"><code>groovy-library</code></a></h5>
<div class="paragraph">
<p>The <code>groovy-library</code> build init type is not inferable. It must be explicitly specified.</p>
</div>
<div class="paragraph">
<p>It has the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Uses the <code>groovy</code> plugin to produce a library Jar</p>
</li>
<li>
<p>Uses the <code>jcenter</code> dependency repository</p>
</li>
<li>
<p>Uses Groovy 2.x</p>
</li>
<li>
<p>Uses <a href="http://spockframework.org">Spock testing framework</a> for testing</p>
</li>
<li>
<p>Has directories in the conventional locations for source code</p>
</li>
<li>
<p>Contains a sample Groovy class and an associated Spock specification, if there are no existing source or test files</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sec:groovyapplication_"><a class="anchor" href="#sec:groovyapplication_"></a><a class="link" href="#sec:groovyapplication_"><code>groovy-application</code></a></h5>
<div class="paragraph">
<p>The <code>groovy-application</code> build init type is not inferable. It must be explicitly specified.</p>
</div>
<div class="paragraph">
<p>It has the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Uses the <code>groovy</code> plugin</p>
</li>
<li>
<p>Uses the <code>application</code> plugin to produce a command-line application implemented using Groovy</p>
</li>
<li>
<p>Uses the <code>jcenter</code> dependency repository</p>
</li>
<li>
<p>Uses Groovy 2.x</p>
</li>
<li>
<p>Uses <a href="http://spockframework.org">Spock testing framework</a> for testing</p>
</li>
<li>
<p>Has directories in the conventional locations for source code</p>
</li>
<li>
<p>Contains a sample Groovy class and an associated Spock specification, if there are no existing source or test files</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sec:basic"><a class="anchor" href="#sec:basic"></a><a class="link" href="#sec:basic"><code>basic</code></a></h5>
<div class="paragraph">
<p>The <code>basic</code> build init type is useful for creating a fresh new Gradle project. It creates a sample <code>build.gradle</code> file, with comments and links to help get started.</p>
</div>
<div class="paragraph">
<p>This type is used when no type was explicitly specified, and no type could be inferred.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="build_lifecycle"><a class="anchor" href="#build_lifecycle"></a><a class="link" href="#build_lifecycle">Build Lifecycle</a></h3>
<div class="paragraph">
<p>We said earlier that the core of Gradle is a language for dependency based programming. In Gradle terms this means that you can define tasks and dependencies between tasks. Gradle guarantees that these tasks are executed in the order of their dependencies, and that each task is executed only once. These tasks form a <a href="http://en.wikipedia.org/wiki/Directed_acyclic_graph">Directed Acyclic Graph</a>. There are build tools that build up such a dependency graph as they execute their tasks. Gradle builds the complete dependency graph <em>before</em> any task is executed. This lies at the heart of Gradle and makes many things possible which would not be possible otherwise.</p>
</div>
<div class="paragraph">
<p>Your build scripts configure this dependency graph. Therefore they are strictly speaking <em>build configuration scripts</em>.</p>
</div>
<div class="sect3">
<h4 id="sec:build_phases"><a class="anchor" href="#sec:build_phases"></a><a class="link" href="#sec:build_phases">Build phases</a></h4>
<div class="paragraph">
<p>A Gradle build has three distinct phases.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Initialization</dt>
<dd>
<p>Gradle supports single and multi-project builds. During the initialization phase, Gradle determines which projects are going to take part in the build, and creates a <a href="../dsl/org.gradle.api.Project.html">Project</a> instance for each of these projects.</p>
</dd>
<dt class="hdlist1">Configuration</dt>
<dd>
<p>During this phase the project objects are configured. The build scripts of <em>all</em> projects which are part of the build are executed.</p>
</dd>
<dt class="hdlist1">Execution</dt>
<dd>
<p>Gradle determines the subset of the tasks, created and configured during the configuration phase, to be executed. The subset is determined by the task name arguments passed to the <code>gradle</code> command and the current directory. Gradle then executes each of the selected tasks.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:settings_file"><a class="anchor" href="#sec:settings_file"></a><a class="link" href="#sec:settings_file">Settings file</a></h4>
<div class="paragraph">
<p>Beside the build script files, Gradle defines a settings file. The settings file is determined by Gradle via a naming convention. The default name for this file is <code>settings.gradle</code>. Later in this chapter we explain how Gradle looks for a settings file.</p>
</div>
<div class="paragraph">
<p>The settings file is executed during the initialization phase. A multi-project build must have a <code>settings.gradle</code> file in the root project of the multi-project hierarchy. It is required because the settings file defines which projects are taking part in the multi-project build (see <a href="#multi_project_builds">Authoring Multi-Project Builds</a>). For a single-project build, a settings file is optional. Besides defining the included projects, you might need it to add libraries to your build script classpath (see <a href="#organizing_gradle_projects">Organizing Gradle Projects</a>). Let&#8217;s first do some introspection with a single project build:</p>
</div>
<div class="sect4">
<h5 id="example_single_project_build"><a class="anchor" href="#example_single_project_build"></a><a class="link" href="#example_single_project_build">Example: Single project build</a></h5>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="string"><span class="delimiter">'</span><span class="content">This is executed during the initialization phase.</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="string"><span class="delimiter">'</span><span class="content">This is executed during the configuration phase.</span><span class="delimiter">'</span></span>

task configured {
    println <span class="string"><span class="delimiter">'</span><span class="content">This is also executed during the configuration phase.</span><span class="delimiter">'</span></span>
}

task test {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">This is executed during the execution phase.</span><span class="delimiter">'</span></span>
    }
}

task testBoth {
        doFirst {
          println <span class="string"><span class="delimiter">'</span><span class="content">This is executed first during the execution phase.</span><span class="delimiter">'</span></span>
        }
        doLast {
          println <span class="string"><span class="delimiter">'</span><span class="content">This is executed last during the execution phase.</span><span class="delimiter">'</span></span>
        }
        println <span class="string"><span class="delimiter">'</span><span class="content">This is executed during the configuration phase as well.</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle test testBoth</code></div>
<div class="content">
<pre>&gt; gradle test testBoth
This is executed during the initialization phase.

&gt; Configure project :
This is executed during the configuration phase.
This is also executed during the configuration phase.
This is executed during the configuration phase as well.

&gt; Task :test
This is executed during the execution phase.

&gt; Task :testBoth
This is executed first during the execution phase.
This is executed last during the execution phase.

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>For a build script, the property access and method calls are delegated to a project object. Similarly property access and method calls within the settings file is delegated to a settings object. Look at the <a href="../dsl/org.gradle.api.initialization.Settings.html">Settings</a> class in the API documentation for more information.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:multi_project_builds"><a class="anchor" href="#sec:multi_project_builds"></a><a class="link" href="#sec:multi_project_builds">Multi-project builds</a></h4>
<div class="paragraph">
<p>A multi-project build is a build where you build more than one project during a single execution of Gradle. You have to declare the projects taking part in the multi-project build in the settings file. There is much more to say about multi-project builds in the chapter dedicated to this topic (see <a href="#multi_project_builds">Authoring Multi-Project Builds</a>).</p>
</div>
<div class="sect4">
<h5 id="sub:project_locations"><a class="anchor" href="#sub:project_locations"></a><a class="link" href="#sub:project_locations">Project locations</a></h5>
<div class="paragraph">
<p>Multi-project builds are always represented by a tree with a single root. Each element in the tree represents a project. A project has a path which denotes the position of the project in the multi-project build tree. In most cases the project path is consistent with the physical location of the project in the file system. However, this behavior is configurable. The project tree is created in the <code>settings.gradle</code> file. By default it is assumed that the location of the settings file is also the location of the root project. But you can redefine the location of the root project in the settings file.</p>
</div>
</div>
<div class="sect4">
<h5 id="sub:building_the_tree"><a class="anchor" href="#sub:building_the_tree"></a><a class="link" href="#sub:building_the_tree">Building the tree</a></h5>
<div class="paragraph">
<p>In the settings file you can use a set of methods to build the project tree. Hierarchical and flat physical layouts get special support.</p>
</div>
<div class="sect5">
<h6 id="sec:hierarchical_layouts"><a class="anchor" href="#sec:hierarchical_layouts"></a><a class="link" href="#sec:hierarchical_layouts">Hierarchical layouts</a></h6>

</div>
</div>
<div class="sect4">
<h5 id="example_hierarchical_layout"><a class="anchor" href="#example_hierarchical_layout"></a><a class="link" href="#example_hierarchical_layout">Example: Hierarchical layout</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">include <span class="string"><span class="delimiter">'</span><span class="content">project1</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">project2:child</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">project3:child1</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>include</code> method takes project paths as arguments. The project path is assumed to be equal to the relative physical file system path. For example, a path 'services:api' is mapped by default to a folder 'services/api' (relative from the project root). You only need to specify the leaves of the tree. This means that the inclusion of the path 'services:hotels:api' will result in creating 3 projects: 'services', 'services:hotels' and 'services:hotels:api'.
More examples of how to work with the project path can be found in the DSL documentation of <a href="../dsl/org.gradle.api.initialization.Settings.html#org.gradle.api.initialization.Settings:include(java.lang.String[])">Settings.include(java.lang.String[])</a>.</p>
</div>
<div class="sect5">
<h6 id="sec:flat_layouts"><a class="anchor" href="#sec:flat_layouts"></a><a class="link" href="#sec:flat_layouts">Flat layouts</a></h6>

</div>
</div>
<div class="sect4">
<h5 id="example_flat_layout"><a class="anchor" href="#example_flat_layout"></a><a class="link" href="#example_flat_layout">Example: Flat layout</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">includeFlat <span class="string"><span class="delimiter">'</span><span class="content">project3</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">project4</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>includeFlat</code> method takes directory names as an argument. These directories need to exist as siblings of the root project directory. The location of these directories are considered as child projects of the root project in the multi-project tree.</p>
</div>
</div>
<div class="sect4">
<h5 id="sub:modifying_element_of_the_project_tree"><a class="anchor" href="#sub:modifying_element_of_the_project_tree"></a><a class="link" href="#sub:modifying_element_of_the_project_tree">Modifying elements of the project tree</a></h5>
<div class="paragraph">
<p>The multi-project tree created in the settings file is made up of so called <em>project descriptors</em>. You can modify these descriptors in the settings file at any time. To access a descriptor you can do:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_lookup_of_elements_of_the_project_tree"><a class="anchor" href="#example_lookup_of_elements_of_the_project_tree"></a><a class="link" href="#example_lookup_of_elements_of_the_project_tree">Example: Lookup of elements of the project tree</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println rootProject.name
println project(<span class="string"><span class="delimiter">'</span><span class="content">:projectA</span><span class="delimiter">'</span></span>).name</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using this descriptor you can change the name, project directory and build file of a project.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_modification_of_elements_of_the_project_tree"><a class="anchor" href="#example_modification_of_elements_of_the_project_tree"></a><a class="link" href="#example_modification_of_elements_of_the_project_tree">Example: Modification of elements of the project tree</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">rootProject.name = <span class="string"><span class="delimiter">'</span><span class="content">main</span><span class="delimiter">'</span></span>
project(<span class="string"><span class="delimiter">'</span><span class="content">:projectA</span><span class="delimiter">'</span></span>).projectDir = <span class="keyword">new</span> <span class="predefined-type">File</span>(settingsDir, <span class="string"><span class="delimiter">'</span><span class="content">../my-project-a</span><span class="delimiter">'</span></span>)
project(<span class="string"><span class="delimiter">'</span><span class="content">:projectA</span><span class="delimiter">'</span></span>).buildFileName = <span class="string"><span class="delimiter">'</span><span class="content">projectA.gradle</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Look at the <a href="../javadoc/org/gradle/api/initialization/ProjectDescriptor.html">ProjectDescriptor</a> class in the API documentation for more information.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:initialization"><a class="anchor" href="#sec:initialization"></a><a class="link" href="#sec:initialization">Initialization</a></h4>
<div class="paragraph">
<p>How does Gradle know whether to do a single or multi-project build? If you trigger a multi-project build from a directory with a settings file, things are easy. But Gradle also allows you to execute the build from within any subproject taking part in the build.<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup> If you execute Gradle from within a project with no <code>settings.gradle</code> file, Gradle looks for a <code>settings.gradle</code> file in the following way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It looks in a directory called <code>master</code> which has the same nesting level as the current dir.</p>
</li>
<li>
<p>If not found yet, it searches parent directories.</p>
</li>
<li>
<p>If not found yet, the build is executed as a single project build.</p>
</li>
<li>
<p>If a <code>settings.gradle</code> file is found, Gradle checks if the current project is part of the multi-project hierarchy defined in the found <code>settings.gradle</code> file. If not, the build is executed as a single project build. Otherwise a multi-project build is executed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>What is the purpose of this behavior? Gradle needs to determine whether the project you are in is a subproject of a multi-project build or not. Of course, if it is a subproject, only the subproject and its dependent projects are built, but Gradle needs to create the build configuration for the whole multi-project build (see <a href="#multi_project_builds">Authoring Multi-Project Builds</a>). You can use the <code>-u</code> command line option to tell Gradle not to look in the parent hierarchy for a <code>settings.gradle</code> file. The current project is then always built as a single project build. If the current project contains a <code>settings.gradle</code> file, the <code>-u</code> option has no meaning. Such a build is always executed as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a single project build, if the <code>settings.gradle</code> file does not define a multi-project hierarchy</p>
</li>
<li>
<p>a multi-project build, if the <code>settings.gradle</code> file does define a multi-project hierarchy.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The automatic search for a <code>settings.gradle</code> file only works for multi-project builds with a physical hierarchical or flat layout. For a flat layout you must additionally follow the naming convention described above (<code>master</code>). Gradle supports arbitrary physical layouts for a multi-project build, but for such arbitrary layouts you need to execute the build from the directory where the settings file is located. For information on how to run partial builds from the root, see <a href="#sec:running_partial_build_from_the_root">Running tasks by their absolute path</a>.</p>
</div>
<div class="paragraph">
<p>Gradle creates a Project object for every project taking part in the build. For a multi-project build these are the projects specified in the Settings object (plus the root project). Each project object has by default a name equal to the name of its top level directory, and every project except the root project has a parent project. Any project may have child projects.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuration_and_execution_of_a_single_project_build"><a class="anchor" href="#sec:configuration_and_execution_of_a_single_project_build"></a><a class="link" href="#sec:configuration_and_execution_of_a_single_project_build">Configuration and execution of a single project build</a></h4>
<div class="paragraph">
<p>For a single project build, the workflow of the <em>after initialization</em> phases are pretty simple. The build script is executed against the project object that was created during the initialization phase. Then Gradle looks for tasks with names equal to those passed as command line arguments. If these task names exist, they are executed as a separate build in the order you have passed them. The configuration and execution for multi-project builds is discussed in <a href="#multi_project_builds">Authoring Multi-Project Builds</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="build_lifecycle_events"><a class="anchor" href="#build_lifecycle_events"></a><a class="link" href="#build_lifecycle_events">Responding to the lifecycle in the build script</a></h4>
<div class="paragraph">
<p>Your build script can receive notifications as the build progresses through its lifecycle. These notifications generally take two forms: You can either implement a particular listener interface, or you can provide a closure to execute when the notification is fired. The examples below use closures. For details on how to use the listener interfaces, refer to the API documentation.</p>
</div>
<div class="sect4">
<h5 id="sec:project_evaluation"><a class="anchor" href="#sec:project_evaluation"></a><a class="link" href="#sec:project_evaluation">Project evaluation</a></h5>
<div class="paragraph">
<p>You can receive a notification immediately before and after a project is evaluated. This can be used to do things like performing additional configuration once all the definitions in a build script have been applied, or for some custom logging or profiling.</p>
</div>
<div class="paragraph">
<p>Below is an example which adds a <code>test</code> task to each project which has a <code>hasTests</code> property value of true.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_of_test_task_to_each_project_which_has_certain_property_set"><a class="anchor" href="#example_adding_of_test_task_to_each_project_which_has_certain_property_set"></a><a class="link" href="#example_adding_of_test_task_to_each_project_which_has_certain_property_set">Example: Adding of test task to each project which has certain property set</a></h5>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">allprojects {
    afterEvaluate { project -&gt;
        <span class="keyword">if</span> (project.hasTests) {
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">Adding test task to </span><span class="inline"><span class="inline-delimiter">$</span>project</span><span class="delimiter">&quot;</span></span>
            project.task(<span class="string"><span class="delimiter">'</span><span class="content">test</span><span class="delimiter">'</span></span>) {
                doLast {
                    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Running tests for </span><span class="inline"><span class="inline-delimiter">$</span>project</span><span class="delimiter">&quot;</span></span>
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">projectA.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">hasTests = <span class="predefined-constant">true</span></code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q test</code></div>
<div class="content">
<pre>&gt; gradle -q test
Adding test task to project ':projectA'
Running tests for project ':projectA'</pre>
</div>
</div>
<div class="paragraph">
<p>This example uses method <code>Project.afterEvaluate()</code> to add a closure which is executed after the project is evaluated.</p>
</div>
<div class="paragraph">
<p>It is also possible to receive notifications when any project is evaluated. This example performs some custom logging of project evaluation. Notice that the <code>afterProject</code> notification is received regardless of whether the project evaluates successfully or fails with an exception.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_notifications"><a class="anchor" href="#example_notifications"></a><a class="link" href="#example_notifications">Example: Notifications</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">gradle.afterProject {project, projectState -&gt;
    <span class="keyword">if</span> (projectState.failure) {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Evaluation of </span><span class="inline"><span class="inline-delimiter">$</span>project</span><span class="content"> FAILED</span><span class="delimiter">&quot;</span></span>
    } <span class="keyword">else</span> {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Evaluation of </span><span class="inline"><span class="inline-delimiter">$</span>project</span><span class="content"> succeeded</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q test</code></strong></div>
<div class="content">
<pre>&gt; gradle -q test
Evaluation of root project 'buildProjectEvaluateEvents' succeeded
Evaluation of project ':projectA' succeeded
Evaluation of project ':projectB' FAILED

FAILURE: Build failed with an exception.

* Where:
Build file '/home/user/gradle/samples/projectB.gradle' line: 1

* What went wrong:
A problem occurred evaluating project ':projectB'.
&gt; broken

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.

* Get more help at https://help.gradle.org

BUILD FAILED in 0s</pre>
</div>
</div>
<div class="paragraph">
<p>You can also add a <a href="../javadoc/org/gradle/api/ProjectEvaluationListener.html">ProjectEvaluationListener</a> to the <a href="../dsl/org.gradle.api.invocation.Gradle.html">Gradle</a> to receive these events.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:task_creation"><a class="anchor" href="#sec:task_creation"></a><a class="link" href="#sec:task_creation">Task creation</a></h5>
<div class="paragraph">
<p>You can receive a notification immediately after a task is added to a project. This can be used to set some default values or add behaviour before the task is made available in the build file.</p>
</div>
<div class="paragraph">
<p>The following example sets the <code>srcDir</code> property of each task as it is created.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_setting_of_certain_property_to_all_tasks"><a class="anchor" href="#example_setting_of_certain_property_to_all_tasks"></a><a class="link" href="#example_setting_of_certain_property_to_all_tasks">Example: Setting of certain property to all tasks</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.whenTaskAdded { task -&gt;
    task.ext.srcDir = <span class="string"><span class="delimiter">'</span><span class="content">src/main/java</span><span class="delimiter">'</span></span>
}

task a

println <span class="string"><span class="delimiter">&quot;</span><span class="content">source dir is </span><span class="inline"><span class="inline-delimiter">$</span>a</span><span class="content">.srcDir</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q a</code></strong></div>
<div class="content">
<pre>&gt; gradle -q a
source dir is src/main/java</pre>
</div>
</div>
<div class="paragraph">
<p>You can also add an <a href="../javadoc/org/gradle/api/Action.html">Action</a> to a <a href="../javadoc/org/gradle/api/tasks/TaskContainer.html">TaskContainer</a> to receive these events.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:task_execution_graph_ready"><a class="anchor" href="#sec:task_execution_graph_ready"></a><a class="link" href="#sec:task_execution_graph_ready">Task execution graph ready</a></h5>
<div class="paragraph">
<p>You can receive a notification immediately after the task execution graph has been populated (See <a href="#configure-by-dag">Configure by DAG</a>).</p>
</div>
<div class="paragraph">
<p>You can also add a <a href="../javadoc/org/gradle/api/execution/TaskExecutionGraphListener.html">TaskExecutionGraphListener</a> to the <a href="../javadoc/org/gradle/api/execution/TaskExecutionGraph.html">TaskExecutionGraph</a> to receive these events.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:task_execution"><a class="anchor" href="#sec:task_execution"></a><a class="link" href="#sec:task_execution">Task execution</a></h5>
<div class="paragraph">
<p>You can receive a notification immediately before and after any task is executed.</p>
</div>
<div class="paragraph">
<p>The following example logs the start and end of each task execution. Notice that the <code>afterTask</code> notification is received regardless of whether the task completes successfully or fails with an exception.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_logging_of_start_and_end_of_each_task_execution"><a class="anchor" href="#example_logging_of_start_and_end_of_each_task_execution"></a><a class="link" href="#example_logging_of_start_and_end_of_each_task_execution">Example: Logging of start and end of each task execution</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task ok

task broken(<span class="key">dependsOn</span>: ok) {
    doLast {
        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(<span class="string"><span class="delimiter">'</span><span class="content">broken</span><span class="delimiter">'</span></span>)
    }
}

gradle.taskGraph.beforeTask { Task task -&gt;
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">executing </span><span class="inline"><span class="inline-delimiter">$</span>task</span><span class="content"> ...</span><span class="delimiter">&quot;</span></span>
}

gradle.taskGraph.afterTask { Task task, TaskState state -&gt;
    <span class="keyword">if</span> (state.failure) {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">FAILED</span><span class="delimiter">&quot;</span></span>
    }
    <span class="keyword">else</span> {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">done</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q broken</code></strong></div>
<div class="content">
<pre>&gt; gradle -q broken
executing task ':ok' ...
done
executing task ':broken' ...
FAILED

FAILURE: Build failed with an exception.

* Where:
Build file '/home/user/gradle/samples/build.gradle' line: 5

* What went wrong:
Execution failed for task ':broken'.
&gt; broken

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.

* Get more help at https://help.gradle.org

BUILD FAILED in 0s</pre>
</div>
</div>
<div class="paragraph">
<p>You can also use a <a href="../javadoc/org/gradle/api/execution/TaskExecutionListener.html">TaskExecutionListener</a> to the <a href="../javadoc/org/gradle/api/execution/TaskExecutionGraph.html">TaskExecutionGraph</a> to receive these events.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tutorial_using_tasks"><a class="anchor" href="#tutorial_using_tasks"></a><a class="link" href="#tutorial_using_tasks">Build Script Basics</a></h3>
<div class="sect3">
<h4 id="sec:projects_and_tasks"><a class="anchor" href="#sec:projects_and_tasks"></a><a class="link" href="#sec:projects_and_tasks">Projects and tasks</a></h4>
<div class="paragraph">
<p>Everything in Gradle sits on top of two basic concepts: <em>projects</em> and <em>tasks</em>.</p>
</div>
<div class="paragraph">
<p>Every Gradle build is made up of one or more <em>projects</em>. What a project represents depends on what it is that you are doing with Gradle. For example, a project might represent a library JAR or a web application. It might represent a distribution ZIP assembled from the JARs produced by other projects. A project does not necessarily represent a thing to be built. It might represent a thing to be done, such as deploying your application to staging or production environments. Don&#8217;t worry if this seems a little vague for now. Gradle&#8217;s build-by-convention support adds a more concrete definition for what a project is.</p>
</div>
<div class="paragraph">
<p>Each project is made up of one or more <em>tasks</em>. A task represents some atomic piece of work which a build performs. This might be compiling some classes, creating a JAR, generating Javadoc, or publishing some archives to a repository.</p>
</div>
<div class="paragraph">
<p>For now, we will look at defining some simple tasks in a build with one project. Later chapters will look at working with multiple projects and more about working with projects and tasks.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:hello_world"><a class="anchor" href="#sec:hello_world"></a><a class="link" href="#sec:hello_world">Hello world</a></h4>
<div class="paragraph">
<p>You run a Gradle build using the <code>gradle</code> command. The <code>gradle</code> command looks for a file called <code>build.gradle</code> in the current directory.<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup> We call this <code>build.gradle</code> file a <em>build script</em>, although strictly speaking it is a build configuration script, as we will see later. The build script defines a project and its tasks.</p>
</div>
<div class="paragraph">
<p>To try this out, create the following build script named <code>build.gradle</code>.</p>
</div>
<div class="sect4">
<h5 id="example_your_first_build_script"><a class="anchor" href="#example_your_first_build_script"></a><a class="link" href="#example_your_first_build_script">Example: Your first build script</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task hello {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">Hello world!</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In a command-line shell, move to the containing directory and execute the build script with <code>gradle -q hello</code>:</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">What does <code>-q</code> do?</div>
<div class="paragraph">
<p>Most of the examples in this user guide are run with the <code>-q</code> command-line option. This suppresses Gradle&#8217;s log messages, so that only the output of the tasks is shown. This keeps the example output in this user guide a little clearer. You don&#8217;t need to use this option if you don&#8217;t want to. See <a href="#logging">Logging</a> for more details about the command-line options which affect Gradle&#8217;s output.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="example_execution_of_a_build_script"><a class="anchor" href="#example_execution_of_a_build_script"></a><a class="link" href="#example_execution_of_a_build_script">Example: Execution of a build script</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
Hello world!</pre>
</div>
</div>
<div class="paragraph">
<p>What&#8217;s going on here? This build script defines a single task, called <code>hello</code>, and adds an action to it. When you run <code>gradle hello</code>, Gradle executes the <code>hello</code> task, which in turn executes the action you&#8217;ve provided. The action is simply a closure containing some Groovy code to execute.</p>
</div>
<div class="paragraph">
<p>If you think this looks similar to Ant&#8217;s targets, you would be right. Gradle tasks are the equivalent to Ant targets, but as you will see, they are much more powerful. We have used a different terminology than Ant as we think the word <em>task</em> is more expressive than the word <em>target</em>. Unfortunately this introduces a terminology clash with Ant, as Ant calls its commands, such as <code>javac</code> or <code>copy</code>, tasks. So when we talk about tasks, we <em>always</em> mean Gradle tasks, which are the equivalent to Ant&#8217;s targets. If we talk about Ant tasks (Ant commands), we explicitly say <em>Ant task</em>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:a_shortcut_task_definition"><a class="anchor" href="#sec:a_shortcut_task_definition"></a><a class="link" href="#sec:a_shortcut_task_definition">A shortcut task definition</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This functionality is deprecated and will be removed in Gradle 5.0 without replacement. Use the methods <a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:doFirst(org.gradle.api.Action)">Task.doFirst(org.gradle.api.Action)</a> and <a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:doLast(org.gradle.api.Action)">Task.doLast(org.gradle.api.Action)</a> to define an action instead, as demonstrated by the rest of the examples in this chapter.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There is a shorthand way to define a task like our <code>hello</code> task above, which is more concise.</p>
</div>
<div class="sect4">
<h5 id="example_a_task_definition_shortcut"><a class="anchor" href="#example_a_task_definition_shortcut"></a><a class="link" href="#example_a_task_definition_shortcut">Example: A task definition shortcut</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task hello &lt;&lt; {
    println <span class="string"><span class="delimiter">'</span><span class="content">Hello world!</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, this defines a task called <code>hello</code> with a single closure to execute. The <code>&lt;&lt;</code> operator is simply an alias for <code>doLast</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_scripts_are_code"><a class="anchor" href="#sec:build_scripts_are_code"></a><a class="link" href="#sec:build_scripts_are_code">Build scripts are code</a></h4>
<div class="paragraph">
<p>Gradle&#8217;s build scripts give you the full power of Groovy. As an appetizer, have a look at this:</p>
</div>
<div class="sect4">
<h5 id="example_using_groovy_in_gradles_tasks"><a class="anchor" href="#example_using_groovy_in_gradles_tasks"></a><a class="link" href="#example_using_groovy_in_gradles_tasks">Example: Using Groovy in Gradle&#8217;s tasks</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task upper {
    doLast {
        <span class="predefined-type">String</span> someString = <span class="string"><span class="delimiter">'</span><span class="content">mY_nAmE</span><span class="delimiter">'</span></span>
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Original: </span><span class="delimiter">&quot;</span></span> + someString
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Upper case: </span><span class="delimiter">&quot;</span></span> + someString.toUpperCase()
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q upper</code></strong></div>
<div class="content">
<pre>&gt; gradle -q upper
Original: mY_nAmE
Upper case: MY_NAME</pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_groovy_in_gradles_tasks_2"><a class="anchor" href="#example_using_groovy_in_gradles_tasks_2"></a><a class="link" href="#example_using_groovy_in_gradles_tasks_2">Example: Using Groovy in Gradle&#8217;s tasks</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task count {
    doLast {
        <span class="integer">4</span>.times { print <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span><span class="local-variable">it</span></span><span class="content"> </span><span class="delimiter">&quot;</span></span> }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q count</code></strong></div>
<div class="content">
<pre>&gt; gradle -q count
0 1 2 3</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:task_dependencies"><a class="anchor" href="#sec:task_dependencies"></a><a class="link" href="#sec:task_dependencies">Task dependencies</a></h4>
<div class="paragraph">
<p>As you probably have guessed, you can declare tasks that depend on other tasks.</p>
</div>
<div class="sect4">
<h5 id="example_declaration_of_task_that_depends_on_other_task"><a class="anchor" href="#example_declaration_of_task_that_depends_on_other_task"></a><a class="link" href="#example_declaration_of_task_that_depends_on_other_task">Example: Declaration of task that depends on other task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task hello {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">Hello world!</span><span class="delimiter">'</span></span>
    }
}
task intro(<span class="key">dependsOn</span>: hello) {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm Gradle</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q intro</code></strong></div>
<div class="content">
<pre>&gt; gradle -q intro
Hello world!
I'm Gradle</pre>
</div>
</div>
<div class="paragraph">
<p>To add a dependency, the corresponding task does not need to exist.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_lazy_dependson_the_other_task_does_not_exist_yet"><a class="anchor" href="#example_lazy_dependson_the_other_task_does_not_exist_yet"></a><a class="link" href="#example_lazy_dependson_the_other_task_does_not_exist_yet">Example: Lazy dependsOn - the other task does not exist (yet)</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task taskX(<span class="key">dependsOn</span>: <span class="string"><span class="delimiter">'</span><span class="content">taskY</span><span class="delimiter">'</span></span>) {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskX</span><span class="delimiter">'</span></span>
    }
}
task taskY {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskY</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q taskX</code></strong></div>
<div class="content">
<pre>&gt; gradle -q taskX
taskY
taskX</pre>
</div>
</div>
<div class="paragraph">
<p>The dependency of <code>taskX</code> to <code>taskY</code> is declared before <code>taskY</code> is defined. This is very important for multi-project builds. Task dependencies are discussed in more detail in <a href="#sec:adding_dependencies_to_tasks">Adding dependencies to a task</a>.</p>
</div>
<div class="paragraph">
<p>Please notice that you can&#8217;t use <a href="#sec:shortcut_notations">shortcut notation</a> when referring to a task that is not yet defined.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:dynamic_tasks"><a class="anchor" href="#sec:dynamic_tasks"></a><a class="link" href="#sec:dynamic_tasks">Dynamic tasks</a></h4>
<div class="paragraph">
<p>The power of Groovy can be used for more than defining what a task does. For example, you can also use it to dynamically create tasks.</p>
</div>
<div class="sect4">
<h5 id="example_dynamic_creation_of_a_task"><a class="anchor" href="#example_dynamic_creation_of_a_task"></a><a class="link" href="#example_dynamic_creation_of_a_task">Example: Dynamic creation of a task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="integer">4</span>.times { counter -&gt;
    task <span class="string"><span class="delimiter">&quot;</span><span class="content">task</span><span class="inline"><span class="inline-delimiter">$</span>counter</span><span class="delimiter">&quot;</span></span> {
        doLast {
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm task number </span><span class="inline"><span class="inline-delimiter">$</span>counter</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q task1</code></strong></div>
<div class="content">
<pre>&gt; gradle -q task1
I'm task number 1</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:manipulating_existing_tasks"><a class="anchor" href="#sec:manipulating_existing_tasks"></a><a class="link" href="#sec:manipulating_existing_tasks">Manipulating existing tasks</a></h4>
<div class="paragraph">
<p>Once tasks are created they can be accessed via an <em>API</em>. For instance, you could use this to dynamically add dependencies to a task, at runtime. Ant doesn&#8217;t allow anything like this.</p>
</div>
<div class="sect4">
<h5 id="example_accessing_a_task_via_api_adding_a_dependency"><a class="anchor" href="#example_accessing_a_task_via_api_adding_a_dependency"></a><a class="link" href="#example_accessing_a_task_via_api_adding_a_dependency">Example: Accessing a task via API - adding a dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="integer">4</span>.times { counter -&gt;
    task <span class="string"><span class="delimiter">&quot;</span><span class="content">task</span><span class="inline"><span class="inline-delimiter">$</span>counter</span><span class="delimiter">&quot;</span></span> {
        doLast {
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm task number </span><span class="inline"><span class="inline-delimiter">$</span>counter</span><span class="delimiter">&quot;</span></span>
        }
    }
}
task0.dependsOn task2, task3</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q task0</code></strong></div>
<div class="content">
<pre>&gt; gradle -q task0
I'm task number 2
I'm task number 3
I'm task number 0</pre>
</div>
</div>
<div class="paragraph">
<p>Or you can add behavior to an existing task.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_accessing_a_task_via_api_adding_behaviour"><a class="anchor" href="#example_accessing_a_task_via_api_adding_behaviour"></a><a class="link" href="#example_accessing_a_task_via_api_adding_behaviour">Example: Accessing a task via API - adding behaviour</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task hello {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">Hello Earth</span><span class="delimiter">'</span></span>
    }
}
hello.doFirst {
    println <span class="string"><span class="delimiter">'</span><span class="content">Hello Venus</span><span class="delimiter">'</span></span>
}
hello.doLast {
    println <span class="string"><span class="delimiter">'</span><span class="content">Hello Mars</span><span class="delimiter">'</span></span>
}
hello {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">Hello Jupiter</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
Hello Venus
Hello Earth
Hello Mars
Hello Jupiter</pre>
</div>
</div>
<div class="paragraph">
<p>The calls <code>doFirst</code> and <code>doLast</code> can be executed multiple times. They add an action to the beginning or the end of the task&#8217;s actions list. When the task executes, the actions in the action list are executed in order.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:shortcut_notations"><a class="anchor" href="#sec:shortcut_notations"></a><a class="link" href="#sec:shortcut_notations">Shortcut notations</a></h4>
<div class="paragraph">
<p>There is a convenient notation for accessing an <em>existing</em> task. Each task is available as a property of the build script:</p>
</div>
<div class="sect4">
<h5 id="example_accessing_task_as_a_property_of_the_build_script"><a class="anchor" href="#example_accessing_task_as_a_property_of_the_build_script"></a><a class="link" href="#example_accessing_task_as_a_property_of_the_build_script">Example: Accessing task as a property of the build script</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task hello {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">Hello world!</span><span class="delimiter">'</span></span>
    }
}
hello.doLast {
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Greetings from the </span><span class="inline"><span class="inline-delimiter">$</span>hello</span><span class="content">.name task.</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
Hello world!
Greetings from the hello task.</pre>
</div>
</div>
<div class="paragraph">
<p>This enables very readable code, especially when using the tasks provided by the plugins, like the <code>compile</code> task.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:extra_task_properties"><a class="anchor" href="#sec:extra_task_properties"></a><a class="link" href="#sec:extra_task_properties">Extra task properties</a></h4>
<div class="paragraph">
<p>You can add your own properties to a task. To add a property named <code>myProperty</code>, set <code>ext.myProperty</code> to an initial value. From that point on, the property can be read and set like a predefined task property.</p>
</div>
<div class="sect4">
<h5 id="example_adding_extra_properties_to_a_task"><a class="anchor" href="#example_adding_extra_properties_to_a_task"></a><a class="link" href="#example_adding_extra_properties_to_a_task">Example: Adding extra properties to a task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task myTask {
    ext.myProperty = <span class="string"><span class="delimiter">&quot;</span><span class="content">myValue</span><span class="delimiter">&quot;</span></span>
}

task printTaskProperties {
    doLast {
        println myTask.myProperty
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q printTaskProperties</code></strong></div>
<div class="content">
<pre>&gt; gradle -q printTaskProperties
myValue</pre>
</div>
</div>
<div class="paragraph">
<p>Extra properties aren&#8217;t limited to tasks. You can read more about them in <a href="#sec:extra_properties">Extra properties</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:using_ant_tasks_tutorial"><a class="anchor" href="#sec:using_ant_tasks_tutorial"></a><a class="link" href="#sec:using_ant_tasks_tutorial">Using Ant Tasks</a></h4>
<div class="paragraph">
<p>Ant tasks are first-class citizens in Gradle. Gradle provides excellent integration for Ant tasks by simply relying on Groovy. Groovy is shipped with the fantastic <code>AntBuilder</code>. Using Ant tasks from Gradle is as convenient and more powerful than using Ant tasks from a <code>build.xml</code> file. From the example below, you can learn how to execute Ant tasks and how to access Ant properties:</p>
</div>
<div class="sect4">
<h5 id="example_using_antbuilder_to_execute_ant_loadfile_target"><a class="anchor" href="#example_using_antbuilder_to_execute_ant_loadfile_target"></a><a class="link" href="#example_using_antbuilder_to_execute_ant_loadfile_target">Example: Using AntBuilder to execute ant.loadfile target</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task loadfile {
    doLast {
        <span class="keyword">def</span> files = file(<span class="string"><span class="delimiter">'</span><span class="content">./antLoadfileResources</span><span class="delimiter">'</span></span>).listFiles().sort()
        files.each { <span class="predefined-type">File</span> file -&gt;
            <span class="keyword">if</span> (file.isFile()) {
                ant.loadfile(<span class="key">srcFile</span>: file, <span class="key">property</span>: file.name)
                println <span class="string"><span class="delimiter">&quot;</span><span class="content"> *** </span><span class="inline"><span class="inline-delimiter">$</span>file</span><span class="content">.name ***</span><span class="delimiter">&quot;</span></span>
                println <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>ant.properties[file.name]<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q loadfile</code></strong></div>
<div class="content">
<pre>&gt; gradle -q loadfile
 *** agile.manifesto.txt ***
Individuals and interactions over processes and tools
Working software over comprehensive documentation
Customer collaboration  over contract negotiation
Responding to change over following a plan
 *** gradle.manifesto.txt ***
Make the impossible possible, make the possible easy and make the easy elegant.
(inspired by Moshe Feldenkrais)</pre>
</div>
</div>
<div class="paragraph">
<p>There is lots more you can do with Ant in your build scripts. You can find out more in <a href="#ant">Ant</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:using_methods"><a class="anchor" href="#sec:using_methods"></a><a class="link" href="#sec:using_methods">Using methods</a></h4>
<div class="paragraph">
<p>Gradle scales in how you can organize your build logic. The first level of organizing your build logic for the example above, is extracting a method.</p>
</div>
<div class="sect4">
<h5 id="example_using_methods_to_organize_your_build_logic"><a class="anchor" href="#example_using_methods_to_organize_your_build_logic"></a><a class="link" href="#example_using_methods_to_organize_your_build_logic">Example: Using methods to organize your build logic</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task checksum {
    doLast {
        fileList(<span class="string"><span class="delimiter">'</span><span class="content">./antLoadfileResources</span><span class="delimiter">'</span></span>).each { <span class="predefined-type">File</span> file -&gt;
            ant.checksum(<span class="key">file</span>: file, <span class="key">property</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">cs_</span><span class="inline"><span class="inline-delimiter">$</span>file</span><span class="content">.name</span><span class="delimiter">&quot;</span></span>)
            println <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>file</span><span class="content">.name Checksum: </span><span class="inline"><span class="inline-delimiter">${</span>ant.properties[<span class="string"><span class="delimiter">&quot;</span><span class="content">cs_</span><span class="inline"><span class="inline-delimiter">$</span>file</span><span class="content">.name</span><span class="delimiter">&quot;</span></span>]<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
        }
    }
}

task loadfile {
    doLast {
        fileList(<span class="string"><span class="delimiter">'</span><span class="content">./antLoadfileResources</span><span class="delimiter">'</span></span>).each { <span class="predefined-type">File</span> file -&gt;
            ant.loadfile(<span class="key">srcFile</span>: file, <span class="key">property</span>: file.name)
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm fond of </span><span class="inline"><span class="inline-delimiter">$</span>file</span><span class="content">.name</span><span class="delimiter">&quot;</span></span>
        }
    }
}

<span class="predefined-type">File</span><span class="type">[]</span> fileList(<span class="predefined-type">String</span> dir) {
    file(dir).listFiles({file -&gt; file.isFile() } <span class="keyword">as</span> <span class="predefined-type">FileFilter</span>).sort()
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q loadfile</code></strong></div>
<div class="content">
<pre>&gt; gradle -q loadfile
I'm fond of agile.manifesto.txt
I'm fond of gradle.manifesto.txt</pre>
</div>
</div>
<div class="paragraph">
<p>Later you will see that such methods can be shared among subprojects in multi-project builds. If your build logic becomes more complex, Gradle offers you other very convenient ways to organize it. We have devoted a whole chapter to this. See <a href="#organizing_gradle_projects">Organizing Gradle Projects</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:default_tasks"><a class="anchor" href="#sec:default_tasks"></a><a class="link" href="#sec:default_tasks">Default tasks</a></h4>
<div class="paragraph">
<p>Gradle allows you to define one or more default tasks that are executed if no other tasks are specified.</p>
</div>
<div class="sect4">
<h5 id="example_defining_a_default_task"><a class="anchor" href="#example_defining_a_default_task"></a><a class="link" href="#example_defining_a_default_task">Example: Defining a default task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">defaultTasks <span class="string"><span class="delimiter">'</span><span class="content">clean</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">run</span><span class="delimiter">'</span></span>

task clean {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">Default Cleaning!</span><span class="delimiter">'</span></span>
    }
}

task run {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">Default Running!</span><span class="delimiter">'</span></span>
    }
}

task other {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm not a default task!</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q</code></strong></div>
<div class="content">
<pre>&gt; gradle -q
Default Cleaning!
Default Running!</pre>
</div>
</div>
<div class="paragraph">
<p>This is equivalent to running <code>gradle clean run</code>. In a multi-project build every subproject can have its own specific default tasks. If a subproject does not specify default tasks, the default tasks of the parent project are used (if defined).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configure-by-dag"><a class="anchor" href="#configure-by-dag"></a><a class="link" href="#configure-by-dag">Configure by DAG</a></h4>
<div class="paragraph">
<p>As we later describe in full detail (see <a href="#build_lifecycle">Build Lifecycle</a>), Gradle has a configuration phase and an execution phase. After the configuration phase, Gradle knows all tasks that should be executed. Gradle offers you a hook to make use of this information. A use-case for this would be to check if the release task is among the tasks to be executed. Depending on this, you can assign different values to some variables.</p>
</div>
<div class="paragraph">
<p>In the following example, execution of the <code>distribution</code> and <code>release</code> tasks results in different value of the <code>version</code> variable.</p>
</div>
<div class="sect4">
<h5 id="example_different_outcomes_of_build_depending_on_chosen_tasks"><a class="anchor" href="#example_different_outcomes_of_build_depending_on_chosen_tasks"></a><a class="link" href="#example_different_outcomes_of_build_depending_on_chosen_tasks">Example: Different outcomes of build depending on chosen tasks</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task distribution {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">We build the zip with version=</span><span class="inline"><span class="inline-delimiter">$</span>version</span><span class="delimiter">&quot;</span></span>
    }
}

task release(<span class="key">dependsOn</span>: <span class="string"><span class="delimiter">'</span><span class="content">distribution</span><span class="delimiter">'</span></span>) {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">We release now</span><span class="delimiter">'</span></span>
    }
}

gradle.taskGraph.whenReady {taskGraph -&gt;
    <span class="keyword">if</span> (taskGraph.hasTask(release)) {
        version = <span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>
    } <span class="keyword">else</span> {
        version = <span class="string"><span class="delimiter">'</span><span class="content">1.0-SNAPSHOT</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q distribution</code></div>
<div class="content">
<pre>&gt; gradle -q distribution
We build the zip with version=1.0-SNAPSHOT</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q release</code></div>
<div class="content">
<pre>&gt; gradle -q release
We build the zip with version=1.0
We release now</pre>
</div>
</div>
<div class="paragraph">
<p>The important thing is that <code>whenReady</code> affects the release task <em>before</em> the release task is executed. This works even when the release task is not the <em>primary</em> task (i.e., the task passed to the <code>gradle</code> command).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:build_script_external_dependencies"><a class="anchor" href="#sec:build_script_external_dependencies"></a><a class="link" href="#sec:build_script_external_dependencies">External dependencies for the build script</a></h4>
<div class="paragraph">
<p>If your build script needs to use external libraries, you can add them to the script&#8217;s classpath in the build script itself. You do this using the <code>buildscript()</code> method, passing in a closure which declares the build script classpath.</p>
</div>
<div class="sect4">
<h5 id="example_declaring_external_dependencies_for_the_build_script"><a class="anchor" href="#example_declaring_external_dependencies_for_the_build_script"></a><a class="link" href="#example_declaring_external_dependencies_for_the_build_script">Example: Declaring external dependencies for the build script</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">commons-codec</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">commons-codec</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">1.2</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The closure passed to the <code>buildscript()</code> method configures a <a href="../javadoc/org/gradle/api/initialization/dsl/ScriptHandler.html">ScriptHandler</a> instance. You declare the build script classpath by adding dependencies to the <code>classpath</code> configuration. This is the same way you declare, for example, the Java compilation classpath. You can use any of the <a href="#dependency_types">dependency types</a> except project dependencies.</p>
</div>
<div class="paragraph">
<p>Having declared the build script classpath, you can use the classes in your build script as you would any other classes on the classpath. The following example adds to the previous example, and uses classes from the build script classpath.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_build_script_with_external_dependencies"><a class="anchor" href="#example_a_build_script_with_external_dependencies"></a><a class="link" href="#example_a_build_script_with_external_dependencies">Example: A build script with external dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.apache.commons.codec.binary.Base64</span>

buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">commons-codec</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">commons-codec</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">1.2</span><span class="delimiter">'</span></span>
    }
}

task encode {
    doLast {
        <span class="keyword">def</span> <span class="type">byte</span><span class="type">[]</span> encodedString = <span class="keyword">new</span> Base64().encode(<span class="string"><span class="delimiter">'</span><span class="content">hello world\n</span><span class="delimiter">'</span></span>.getBytes())
        println <span class="keyword">new</span> <span class="predefined-type">String</span>(encodedString)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q encode</code></strong></div>
<div class="content">
<pre>&gt; gradle -q encode
aGVsbG8gd29ybGQK</pre>
</div>
</div>
<div class="paragraph">
<p>For multi-project builds, the dependencies declared with a project&#8217;s <code>buildscript()</code> method are available to the build scripts of all its sub-projects.</p>
</div>
<div class="paragraph">
<p>Build script dependencies may be Gradle plugins. Please consult <a href="#plugins">Using Gradle Plugins</a> for more information on Gradle plugins.</p>
</div>
<div class="paragraph">
<p>Every project automatically has a <code>buildEnvironment</code> task of type <a href="../dsl/org.gradle.api.tasks.diagnostics.BuildEnvironmentReportTask.html">BuildEnvironmentReportTask</a> that can be invoked to report on the resolution of the build script dependencies.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:tasks_tutorial_where_to_next"><a class="anchor" href="#sec:tasks_tutorial_where_to_next"></a><a class="link" href="#sec:tasks_tutorial_where_to_next">Where to next?</a></h4>
<div class="paragraph">
<p>In this chapter, we have had a first look at tasks. But this is not the end of the story for tasks. If you want to jump into more of the details, have a look at <a href="#more_about_tasks">More About Tasks</a>.</p>
</div>
<div class="paragraph">
<p>Otherwise, continue on to <a href="#tutorial_java_projects">the tutorials</a> and <a href="#dependency_management_for_java_projects">Dependency Management for Java Projects</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="composite_builds"><a class="anchor" href="#composite_builds"></a><a class="link" href="#composite_builds">Composite builds</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Composite build is an <a href="#feature_lifecycle">incubating</a> feature. While useful for many use cases, there are bugs to be discovered, rough edges to smooth, and enhancements we plan to make. Thanks for trying it out!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="composite_build_intro"><a class="anchor" href="#composite_build_intro"></a><a class="link" href="#composite_build_intro">What is a composite build?</a></h4>
<div class="paragraph">
<p>A composite build is simply a build that includes other builds. In many ways a composite build is similar to a Gradle multi-project build, except that instead of including single <code>projects</code>, complete <code>builds</code> are included.</p>
</div>
<div class="paragraph">
<p>Composite builds allow you to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>combine builds that are usually developed independently, for instance when trying out a bug fix in a library that your application uses</p>
</li>
<li>
<p>decompose a large multi-project build into smaller, more isolated chunks that can be worked in independently or together as needed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A build that is included in a composite build is referred to, naturally enough, as an "included build". Included builds do not share any configuration with the composite build, or the other included builds. Each included build is configured and executed in isolation.</p>
</div>
<div class="paragraph">
<p>Included builds interact with other builds via <code>dependency substitution</code>. If any build in the composite has a dependency that can be satisfied by the included build, then that dependency will be replaced by a project dependency on the included build.</p>
</div>
<div class="paragraph">
<p>By default, Gradle will attempt to determine the dependencies that can be substituted by an included build. However for more flexibility, it is possible to explicitly declare these substitutions if the default ones determined by Gradle are not correct for the composite. See <a href="#included_build_declaring_substitutions">Declaring substitutions</a>.</p>
</div>
<div class="paragraph">
<p>As well as consuming outputs via project dependencies, a composite build can directly declare task dependencies on included builds. Included builds are isolated, and are not able to declare task dependencies on the composite build or on other included builds. See <a href="#included_build_task_dependencies">Depending on tasks in an included build</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="defining_composite_builds"><a class="anchor" href="#defining_composite_builds"></a><a class="link" href="#defining_composite_builds">Defining a composite build</a></h4>
<div class="paragraph">
<p>The following examples demonstrate the various ways that 2 Gradle builds that are normally developed separately can be combined into a composite build. For these examples, the <code>my-utils</code> multi-project build produces 2 different java libraries (<code>number-utils</code> and <code>string-utils</code>), and the <code>my-app</code> build produces an executable using functions from those libraries.</p>
</div>
<div class="paragraph">
<p>The <code>my-app</code> build does not have direct dependencies on <code>my-utils</code>. Instead, it declares binary dependencies on the libraries produced by <code>my-utils</code>.</p>
</div>
<div class="sect4">
<h5 id="example_dependencies_of_my_app"><a class="anchor" href="#example_dependencies_of_my_app"></a><a class="link" href="#example_dependencies_of_my_app">Example: Dependencies of my-app</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">my-app/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">application</span><span class="delimiter">'</span></span>
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">idea</span><span class="delimiter">'</span></span>

group <span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample</span><span class="delimiter">&quot;</span></span>
version <span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span>

mainClassName = <span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample.myapp.Main</span><span class="delimiter">&quot;</span></span>

dependencies {
    compile <span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample:number-utils:1.0</span><span class="delimiter">&quot;</span></span>
    compile <span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample:string-utils:1.0</span><span class="delimiter">&quot;</span></span>
}

repositories {
    jcenter()
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/compositeBuilds/basic</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="command_line_composite"><a class="anchor" href="#command_line_composite"></a><a class="link" href="#command_line_composite">Defining a composite build via <code>--include-build</code></a></h5>
<div class="paragraph">
<p>The <code>--include-build</code> command-line argument turns the executed build into a composite, substituting dependencies from the included build into the executed build.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_a_command_line_composite"><a class="anchor" href="#example_declaring_a_command_line_composite"></a><a class="link" href="#example_declaring_a_command_line_composite">Example: Declaring a command-line composite</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle --include-build ../my-utils run</code></strong></div>
<div class="content">
<pre>&gt; gradle --include-build ../my-utils run
&gt; Task :processResources NO-SOURCE
&gt; Task :my-utils:string-utils:compileJava
&gt; Task :my-utils:string-utils:processResources NO-SOURCE
&gt; Task :my-utils:string-utils:classes
&gt; Task :my-utils:string-utils:jar
&gt; Task :my-utils:number-utils:compileJava
&gt; Task :my-utils:number-utils:processResources NO-SOURCE
&gt; Task :my-utils:number-utils:classes
&gt; Task :my-utils:number-utils:jar
&gt; Task :compileJava
&gt; Task :classes

&gt; Task :run
The answer is 42


BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="settings_defined_composite"><a class="anchor" href="#settings_defined_composite"></a><a class="link" href="#settings_defined_composite">Defining a composite build via <code>settings.gradle</code></a></h5>
<div class="paragraph">
<p>It&#8217;s possible to make the above arrangement persistent, by using <a href="../dsl/org.gradle.api.initialization.Settings.html#org.gradle.api.initialization.Settings:includeBuild(java.lang.Object)">Settings.includeBuild(java.lang.Object)</a> to declare the included build in the <code>settings.gradle</code> file. The <code>settings.gradle</code> file can be used to add subprojects and included builds at the same time. Included builds are added by location. See the examples below for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="separate_composite"><a class="anchor" href="#separate_composite"></a><a class="link" href="#separate_composite">Defining a separate composite build</a></h5>
<div class="paragraph">
<p>One downside of the above approach is that it requires you to modify an existing build, rendering it less useful as a standalone build. One way to avoid this is to define a separate composite build, whose only purpose is to combine otherwise separate builds.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_a_separate_composite"><a class="anchor" href="#example_declaring_a_separate_composite"></a><a class="link" href="#example_declaring_a_separate_composite">Example: Declaring a separate composite</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">rootProject.name=<span class="string"><span class="delimiter">'</span><span class="content">adhoc</span><span class="delimiter">'</span></span>

includeBuild <span class="string"><span class="delimiter">'</span><span class="content">../my-app</span><span class="delimiter">'</span></span>
includeBuild <span class="string"><span class="delimiter">'</span><span class="content">../my-utils</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this scenario, the 'main' build that is executed is the composite, and it doesn&#8217;t define any useful tasks to execute itself. In order to execute the 'run' task in the 'my-app' build, the composite build must define a delegating task.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_depending_on_task_from_included_build"><a class="anchor" href="#example_depending_on_task_from_included_build"></a><a class="link" href="#example_depending_on_task_from_included_build">Example: Depending on task from included build</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task run {
    dependsOn gradle.includedBuild(<span class="string"><span class="delimiter">'</span><span class="content">my-app</span><span class="delimiter">'</span></span>).task(<span class="string"><span class="delimiter">'</span><span class="content">:run</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>More details tasks that depend on included build tasks below.</p>
</div>
</div>
<div class="sect4">
<h5 id="included_builds"><a class="anchor" href="#included_builds"></a><a class="link" href="#included_builds">Restrictions on included builds</a></h5>
<div class="paragraph">
<p>Most builds can be included into a composite, including other composite builds. However there are some limitations.</p>
</div>
<div class="paragraph">
<p>Every included build:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>must not have a <code>rootProject.name</code> the same as another included build.</p>
</li>
<li>
<p>must not have a <code>rootProject.name</code> the same as a top-level project of the composite build.</p>
</li>
<li>
<p>must not have a <code>rootProject.name</code> the same as the composite build <code>rootProject.name</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="interacting_with_composite_builds"><a class="anchor" href="#interacting_with_composite_builds"></a><a class="link" href="#interacting_with_composite_builds">Interacting with a composite build</a></h4>
<div class="paragraph">
<p>In general, interacting with a composite build is much the same as a regular multi-project build. Tasks can be executed, tests can be run, and builds can be imported into the IDE.</p>
</div>
<div class="sect4">
<h5 id="composite_build_executing_tasks"><a class="anchor" href="#composite_build_executing_tasks"></a><a class="link" href="#composite_build_executing_tasks">Executing tasks</a></h5>
<div class="paragraph">
<p>Tasks from the composite build can be executed from the command line, or from you IDE. Executing a task will result in direct task dependencies being executed, as well as those tasks required to build dependency artifacts from included builds.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>There is not (yet) any means to directly execute a task from an included build via the command line. Included build tasks are automatically executed in order to generate required dependency artifacts, or the <a href="#included_build_task_dependencies">including build can declare a dependency on a task from an included build</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="composite_build_ide_integration"><a class="anchor" href="#composite_build_ide_integration"></a><a class="link" href="#composite_build_ide_integration">Importing into the IDE</a></h5>
<div class="paragraph">
<p>One of the most useful features of composite builds is IDE integration. By applying the <a href="#idea_plugin">idea</a> or <a href="#eclipse_plugin">eclipse</a> plugin to your build, it is possible to generate a single IDEA or Eclipse project that permits all builds in the composite to be developed together.</p>
</div>
<div class="paragraph">
<p>In addition to these Gradle plugins, recent versions of <a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a> and <a href="https://projects.eclipse.org/projects/tools.buildship">Eclipse Buildship</a> support direct import of a composite build.</p>
</div>
<div class="paragraph">
<p>Importing a composite build permits sources from separate Gradle builds to be easily developed together. For every included build, each sub-project is included as an IDEA Module or Eclipse Project. Source dependencies are configured, providing cross-build navigation and refactoring.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="included_build_declaring_substitutions"><a class="anchor" href="#included_build_declaring_substitutions"></a><a class="link" href="#included_build_declaring_substitutions">Declaring the dependencies substituted by an included build</a></h4>
<div class="paragraph">
<p>By default, Gradle will configure each included build in order to determine the dependencies it can provide. The algorithm for doing this is very simple: Gradle will inspect the group and name for the projects in the included build, and substitute project dependencies for any external dependency matching <code>${project.group}:${project.name}</code>.</p>
</div>
<div class="paragraph">
<p>There are cases when the default substitutions determined by Gradle are not sufficient, or they are not correct for a particular composite. For these cases it is possible to explicitly declare the substitutions for an included build. Take for example a single-project build 'unpublished', that produces a java utility library but does not declare a value for the group attribute:</p>
</div>
<div class="sect4">
<h5 id="example_build_that_does_not_declare_group_attribute"><a class="anchor" href="#example_build_that_does_not_declare_group_attribute"></a><a class="link" href="#example_build_that_does_not_declare_group_attribute">Example: Build that does not declare group attribute</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When this build is included in a composite, it will attempt to substitute for the dependency module "undefined:unpublished" ("undefined" being the default value for <code>project.group</code>, and 'unpublished' being the root project name). Clearly this isn&#8217;t going to be very useful in a composite build. To use the unpublished library unmodified in a composite build, the composing build can explicitly declare the substitutions that it provides:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_the_substitutions_for_an_included_build"><a class="anchor" href="#example_declaring_the_substitutions_for_an_included_build"></a><a class="link" href="#example_declaring_the_substitutions_for_an_included_build">Example: Declaring the substitutions for an included build</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">rootProject.name = <span class="string"><span class="delimiter">'</span><span class="content">app</span><span class="delimiter">'</span></span>

includeBuild(<span class="string"><span class="delimiter">'</span><span class="content">../anonymous-library</span><span class="delimiter">'</span></span>) {
    dependencySubstitution {
        substitute module(<span class="string"><span class="delimiter">'</span><span class="content">org.sample:number-utils</span><span class="delimiter">'</span></span>) with project(<span class="string"><span class="delimiter">'</span><span class="content">:</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this configuration, the "my-app" composite build will substitute any dependency on <code>org.sample:number-utils</code> with a dependency on the root project of "unpublished".</p>
</div>
</div>
<div class="sect4">
<h5 id="included_build_substitution_requirements"><a class="anchor" href="#included_build_substitution_requirements"></a><a class="link" href="#included_build_substitution_requirements">Cases where included build substitutions must be declared</a></h5>
<div class="paragraph">
<p>Many builds that use the <code>uploadArchives</code> task to publish artifacts will function automatically as an included build, without declared substitutions. Here are some common cases where declared substitutions are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When the <code>archivesBaseName</code> property is used to set the name of the published artifact.</p>
</li>
<li>
<p>When a configuration other than <code>default</code> is published: this usually means a task other than <code>uploadArchives</code> is used.</p>
</li>
<li>
<p>When the <code>MavenPom.addFilter()</code> is used to publish artifacts that don&#8217;t match the project name.</p>
</li>
<li>
<p>When the <code>maven-publish</code> or <code>ivy-publish</code> plugins are used for publishing, and the publication coordinates don&#8217;t match <code>${project.group}:${project.name}</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="included_build_substitution_limitations"><a class="anchor" href="#included_build_substitution_limitations"></a><a class="link" href="#included_build_substitution_limitations">Cases where composite build substitutions won&#8217;t work</a></h5>
<div class="paragraph">
<p>Some builds won&#8217;t function correctly when included in a composite, even when dependency substitutions are explicitly declared. This limitation is due to the fact that a project dependency that is substituted will always point to the <code>default</code> configuration of the target project. Any time that the artifacts and dependencies specified for the default configuration of a project don&#8217;t match what is actually published to a repository, then the composite build may exhibit different behaviour.</p>
</div>
<div class="paragraph">
<p>Here are some cases where the publish module metadata may be different from the project default configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When a configuration other than <code>default</code> is published.</p>
</li>
<li>
<p>When the <code>maven-publish</code> or <code>ivy-publish</code> plugins are used.</p>
</li>
<li>
<p>When the <code>POM</code> or <code>ivy.xml</code> file is tweaked as part of publication.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Builds using these features function incorrectly when included in a composite build. We plan to improve this in the future.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="included_build_task_dependencies"><a class="anchor" href="#included_build_task_dependencies"></a><a class="link" href="#included_build_task_dependencies">Depending on tasks in an included build</a></h4>
<div class="paragraph">
<p>While included builds are isolated from one another and cannot declare direct dependencies, a composite build is able to declare task dependencies on its included builds. The included builds are accessed using <a href="../dsl/org.gradle.api.invocation.Gradle.html#org.gradle.api.invocation.Gradle:includedBuilds">Gradle.getIncludedBuilds()</a> or <a href="../dsl/org.gradle.api.invocation.Gradle.html#org.gradle.api.invocation.Gradle:includedBuild(java.lang.String)">Gradle.includedBuild(java.lang.String)</a>, and a task reference is obtained via the <a href="../dsl/org.gradle.api.initialization.IncludedBuild.html#org.gradle.api.initialization.IncludedBuild:task(java.lang.String)">IncludedBuild.task(java.lang.String)</a> method.</p>
</div>
<div class="paragraph">
<p>Using these APIs, it is possible to declare a dependency on a task in a particular included build, or tasks with a certain path in all or some of the included builds.</p>
</div>
<div class="sect4">
<h5 id="example_depending_on_a_single_task_from_an_included_build"><a class="anchor" href="#example_depending_on_a_single_task_from_an_included_build"></a><a class="link" href="#example_depending_on_a_single_task_from_an_included_build">Example: Depending on a single task from an included build</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task run {
    dependsOn gradle.includedBuild(<span class="string"><span class="delimiter">'</span><span class="content">my-app</span><span class="delimiter">'</span></span>).task(<span class="string"><span class="delimiter">'</span><span class="content">:run</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_depending_on_a_tasks_with_path_in_all_included_builds"><a class="anchor" href="#example_depending_on_a_tasks_with_path_in_all_included_builds"></a><a class="link" href="#example_depending_on_a_tasks_with_path_in_all_included_builds">Example: Depending on a tasks with path in all included builds</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task publishDeps {
    dependsOn gradle.includedBuilds*.task(<span class="string"><span class="delimiter">'</span><span class="content">:uploadArchives</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="current_limitations_and_future_work"><a class="anchor" href="#current_limitations_and_future_work"></a><a class="link" href="#current_limitations_and_future_work">Current limitations and future plans for composite builds</a></h4>
<div class="paragraph">
<p>We think composite builds are pretty useful already. However, there are some things that don&#8217;t yet work the way we&#8217;d like, and other improvements that we think will make things work even better.</p>
</div>
<div class="paragraph">
<p>Limitations of the current implementation include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No support for included builds that have publications that don&#8217;t mirror the project default configuration. See <a href="#included_build_substitution_limitations">Cases where composite builds won&#8217;t work</a>.</p>
</li>
<li>
<p>Native builds are not supported. (Binary dependencies are not yet supported for native builds).</p>
</li>
<li>
<p>Substituting plugins only works with the <code>buildscript</code> block but not with the <code>plugins</code> block.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Improvements we have planned for upcoming releases include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Better detection of dependency substitution, for build that publish with custom coordinates, builds that produce multiple components, etc. This will reduce the cases where dependency substitution needs to be explicitly declared for an included build.</p>
</li>
<li>
<p>The ability to target a task or tasks in an included build directly from the command line. We are currently exploring syntax options for allowing this functionality, which will remove many cases where a delegating task is required in the composite.</p>
</li>
<li>
<p>Make the <code>plugins {}</code> block consider included builds when locating plugins and their dependencies.</p>
</li>
<li>
<p>Making the implicit <code>buildSrc</code> project an included build.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="multi_project_builds"><a class="anchor" href="#multi_project_builds"></a><a class="link" href="#multi_project_builds">Authoring Multi-Project Builds</a></h3>
<div class="paragraph">
<p>The powerful support for multi-project builds is one of Gradle&#8217;s unique selling points. This topic is also the most intellectually challenging.</p>
</div>
<div class="paragraph">
<p>A multi-project build in gradle consists of one root project, and one or more subprojects that may also have subprojects.</p>
</div>
<div class="sect3">
<h4 id="sec:cross_project_configuration"><a class="anchor" href="#sec:cross_project_configuration"></a><a class="link" href="#sec:cross_project_configuration">Cross project configuration</a></h4>
<div class="paragraph">
<p>While each subproject could configure itself in complete isolation of the other subprojects, it is common that subprojects share common traits. It is then usually preferable to share configurations among projects, so the same configuration affects several subprojects.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with a very simple multi-project build. Gradle is a general purpose build tool at its core, so the projects don&#8217;t have to be Java projects. Our first examples are about marine life.</p>
</div>
<div class="sect4">
<h5 id="sec:configuration_and_execution"><a class="anchor" href="#sec:configuration_and_execution"></a><a class="link" href="#sec:configuration_and_execution">Configuration and execution</a></h5>
<div class="paragraph">
<p><a href="#sec:build_phases">Build phases</a> describes the phases of every Gradle build. Let&#8217;s zoom into the configuration and execution phases of a multi-project build. Configuration here means executing the <code>build.gradle</code> file of a project, which implies e.g. downloading all plugins that were declared using &#8216;<code>apply plugin</code>&#8217;. By default, the configuration of all projects happens before any task is executed. This means that when a single task, from a single project is requested, <em>all</em> projects of multi-project build are configured first. The reason every project needs to be configured is to support the flexibility of accessing and changing any part of the Gradle project model.</p>
</div>
<div class="sect5">
<h6 id="sec:configuration_on_demand"><a class="anchor" href="#sec:configuration_on_demand"></a><a class="link" href="#sec:configuration_on_demand">Configuration on demand</a></h6>
<div class="paragraph">
<p>The <em>Configuration injection</em> feature and access to the complete project model are possible because every project is configured before the execution phase. Yet, this approach may not be the most efficient in a very large multi-project build. There are Gradle builds with a hierarchy of hundreds of subprojects. The configuration time of huge multi-project builds may become noticeable. Scalability is an important requirement for Gradle. Hence, starting from version 1.4 a new incubating 'configuration on demand' mode is introduced.</p>
</div>
<div class="paragraph">
<p>Configuration on demand mode attempts to configure only projects that are relevant for requested tasks, i.e. it only executes the <code>build.gradle</code> file of projects that are participating in the build. This way, the configuration time of a large multi-project build can be reduced. In the long term, this mode will become the default mode, possibly the only mode for Gradle build execution. The configuration on demand feature is incubating so not every build is guaranteed to work correctly. The feature should work very well for multi-project builds that have <a href="#sec:decoupled_projects">decoupled projects</a>. In configuration on demand mode, projects are configured as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The root project is always configured. This way the typical common configuration is supported (allprojects or subprojects script blocks).</p>
</li>
<li>
<p>The project in the directory where the build is executed is also configured, but only when Gradle is executed without any tasks. This way the default tasks behave correctly when projects are configured on demand.</p>
</li>
<li>
<p>The standard project dependencies are supported and makes relevant projects configured. If project A has a compile dependency on project B then building A causes configuration of both projects.</p>
</li>
<li>
<p>The task dependencies declared via task path are supported and cause relevant projects to be configured. Example: someTask.dependsOn(":someOtherProject:someOtherTask")</p>
</li>
<li>
<p>A task requested via task path from the command line (or Tooling API) causes the relevant project to be configured. For example, building 'projectA:projectB:someTask' causes configuration of projectB.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Eager to try out this new feature? To configure on demand with every build run see <a href="#sec:gradle_configuration_properties">Gradle properties</a>. To configure on demand just for a given build, see <a href="#sec:command_line_performance">command-line performance-oriented options</a>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:defining_common_behavior"><a class="anchor" href="#sec:defining_common_behavior"></a><a class="link" href="#sec:defining_common_behavior">Defining common behavior</a></h5>
<div class="paragraph">
<p>Let&#8217;s look at some examples with the following project tree. This is a multi-project build with a root project named <code>water</code> and a subproject named <code>bluewhale</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_multi_project_tree_water_bluewhale_projects"><a class="anchor" href="#example_multi_project_tree_water_bluewhale_projects"></a><a class="link" href="#example_multi_project_tree_water_bluewhale_projects">Example: Multi-project tree - water &amp; bluewhale projects</a></h5>
<div class="listingblock">
<div class="title">Project layout</div>
<div class="content">
<pre>.
 bluewhale/
 build.gradle
 settings.gradle</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/userguide/multiproject/firstExample/water</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">rootProject.name = <span class="string"><span class="delimiter">'</span><span class="content">water</span><span class="delimiter">'</span></span>
include <span class="string"><span class="delimiter">'</span><span class="content">bluewhale</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And where is the build script for the <code>bluewhale</code> project? In Gradle build scripts are optional. Obviously for a single project build, a project without a build script doesn&#8217;t make much sense. For multiproject builds the situation is different. Let&#8217;s look at the build script for the <code>water</code> project and execute it:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_build_script_of_water_parent_project"><a class="anchor" href="#example_build_script_of_water_parent_project"></a><a class="link" href="#example_build_script_of_water_parent_project">Example: Build script of water (parent) project</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Closure cl = { task -&gt; println <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm </span><span class="inline"><span class="inline-delimiter">$</span>task</span><span class="content">.project.name</span><span class="delimiter">&quot;</span></span> }
task(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>).doLast(cl)
project(<span class="string"><span class="delimiter">'</span><span class="content">:bluewhale</span><span class="delimiter">'</span></span>) {
    task(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>).doLast(cl)
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
I'm water
I'm bluewhale</pre>
</div>
</div>
<div class="paragraph">
<p>Gradle allows you to access any project of the multi-project build from any build script. The Project API provides a method called <code>project()</code>, which takes a path as an argument and returns the Project object for this path. The capability to configure a project build from any build script we call <em>cross project configuration</em>. Gradle implements this via <em>configuration injection</em>.</p>
</div>
<div class="paragraph">
<p>We are not that happy with the build script of the <code>water</code> project. It is inconvenient to add the task explicitly for every project. We can do better. Let&#8217;s first add another project called <code>krill</code> to our multi-project build.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_multi_project_tree_water_bluewhale_krill_projects"><a class="anchor" href="#example_multi_project_tree_water_bluewhale_krill_projects"></a><a class="link" href="#example_multi_project_tree_water_bluewhale_krill_projects">Example: Multi-project tree - water, bluewhale  &amp; krill projects</a></h5>
<div class="listingblock">
<div class="title">Project layout</div>
<div class="content">
<pre>.
 bluewhale/
 build.gradle
 krill/
 settings.gradle</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/userguide/multiproject/addKrill/water</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">rootProject.name = <span class="string"><span class="delimiter">'</span><span class="content">water</span><span class="delimiter">'</span></span>

include <span class="string"><span class="delimiter">'</span><span class="content">bluewhale</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">krill</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we rewrite the <code>water</code> build script and boil it down to a single line.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_water_project_build_script"><a class="anchor" href="#example_water_project_build_script"></a><a class="link" href="#example_water_project_build_script">Example: Water project build script</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">allprojects {
    task hello {
        doLast { task -&gt;
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm </span><span class="inline"><span class="inline-delimiter">$</span>task</span><span class="content">.project.name</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
I'm water
I'm bluewhale
I'm krill</pre>
</div>
</div>
<div class="paragraph">
<p>Is this cool or is this cool? And how does this work? The Project API provides a property <code>allprojects</code> which returns a list with the current project and all its subprojects underneath it. If you call <code>allprojects</code> with a closure, the statements of the closure are delegated to the projects associated with <code>allprojects</code>. You could also do an iteration via <code>allprojects.each</code>, but that would be more verbose.</p>
</div>
<div class="paragraph">
<p>Other build systems use inheritance as the primary means for defining common behavior. We also offer inheritance for projects as you will see later. But Gradle uses configuration injection as the usual way of defining common behavior. We think it provides a very powerful and flexible way of configuring multiproject builds.</p>
</div>
<div class="paragraph">
<p>Another possibility for sharing configuration is to use a common external script.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:subproject_configuration"><a class="anchor" href="#sec:subproject_configuration"></a><a class="link" href="#sec:subproject_configuration">Subproject configuration</a></h4>
<div class="paragraph">
<p>The Project API also provides a property for accessing the subprojects only.</p>
</div>
<div class="sect4">
<h5 id="sec:defining_common_behavior_subprojects"><a class="anchor" href="#sec:defining_common_behavior_subprojects"></a><a class="link" href="#sec:defining_common_behavior_subprojects">Defining common behavior</a></h5>

</div>
<div class="sect4">
<h5 id="example_defining_common_behavior_of_all_projects_and_subprojects"><a class="anchor" href="#example_defining_common_behavior_of_all_projects_and_subprojects"></a><a class="link" href="#example_defining_common_behavior_of_all_projects_and_subprojects">Example: Defining common behavior of all projects and subprojects</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">allprojects {
    task hello {
        doLast { task -&gt;
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm </span><span class="inline"><span class="inline-delimiter">$</span>task</span><span class="content">.project.name</span><span class="delimiter">&quot;</span></span>
        }
    }
}
subprojects {
    hello {
        doLast {
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">- I depend on water</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
I'm water
I'm bluewhale
- I depend on water
I'm krill
- I depend on water</pre>
</div>
</div>
<div class="paragraph">
<p>You may notice that there are two code snippets referencing the <code>hello</code> task. The first one, which uses the <code>task</code> keyword, constructs the task and provides it&#8217;s base configuration. The second piece doesn&#8217;t use the <code>task</code> keyword, as it is further configuring the existing <code>hello</code> task. You may only construct a task once in a project, but you may add any number of code blocks providing additional configuration.</p>
</div>
</div>
<div class="sect4">
<h5 id="sub:adding_specific_behavior"><a class="anchor" href="#sub:adding_specific_behavior"></a><a class="link" href="#sub:adding_specific_behavior">Adding specific behavior</a></h5>
<div class="paragraph">
<p>You can add specific behavior on top of the common behavior. Usually we put the project specific behavior in the build script of the project where we want to apply this specific behavior. But as we have already seen, we don&#8217;t have to do it this way. We could add project specific behavior for the <code>bluewhale</code> project like this:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_specific_behaviour_for_particular_project"><a class="anchor" href="#example_defining_specific_behaviour_for_particular_project"></a><a class="link" href="#example_defining_specific_behaviour_for_particular_project">Example: Defining specific behaviour for particular project</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">allprojects {
    task hello {
        doLast { task -&gt;
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm </span><span class="inline"><span class="inline-delimiter">$</span>task</span><span class="content">.project.name</span><span class="delimiter">&quot;</span></span>
        }
    }
}
subprojects {
    hello {
        doLast {
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">- I depend on water</span><span class="delimiter">&quot;</span></span>
        }
    }
}
project(<span class="string"><span class="delimiter">'</span><span class="content">:bluewhale</span><span class="delimiter">'</span></span>).hello {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">- I'm the largest animal that has ever lived on this planet.</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
I'm water
I'm bluewhale
- I depend on water
- I'm the largest animal that has ever lived on this planet.
I'm krill
- I depend on water</pre>
</div>
</div>
<div class="paragraph">
<p>As we have said, we usually prefer to put project specific behavior into the build script of this project. Let&#8217;s refactor and also add some project specific behavior to the <code>krill</code> project.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_specific_behaviour_for_project_krill"><a class="anchor" href="#example_defining_specific_behaviour_for_project_krill"></a><a class="link" href="#example_defining_specific_behaviour_for_project_krill">Example: Defining specific behaviour for project krill</a></h5>
<div class="listingblock">
<div class="title">Project layout</div>
<div class="content">
<pre>.
 bluewhale
  build.gradle
 build.gradle
 krill
  build.gradle
 settings.gradle</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/userguide/multiproject/spreadSpecifics/water</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">rootProject.name = <span class="string"><span class="delimiter">'</span><span class="content">water</span><span class="delimiter">'</span></span>
include <span class="string"><span class="delimiter">'</span><span class="content">bluewhale</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">krill</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">bluewhale/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">hello.doLast {
  println <span class="string"><span class="delimiter">&quot;</span><span class="content">- I'm the largest animal that has ever lived on this planet.</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">krill/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">hello.doLast {
  println <span class="string"><span class="delimiter">&quot;</span><span class="content">- The weight of my species in summer is twice as heavy as all human beings.</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">allprojects {
    task hello {
        doLast { task -&gt;
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm </span><span class="inline"><span class="inline-delimiter">$</span>task</span><span class="content">.project.name</span><span class="delimiter">&quot;</span></span>
        }
    }
}
subprojects {
    hello {
        doLast {
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">- I depend on water</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q hello</code></div>
<div class="content">
<pre>&gt; gradle -q hello
I'm water
I'm bluewhale
- I depend on water
- I'm the largest animal that has ever lived on this planet.
I'm krill
- I depend on water
- The weight of my species in summer is twice as heavy as all human beings.</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sub:project_filtering"><a class="anchor" href="#sub:project_filtering"></a><a class="link" href="#sub:project_filtering">Project filtering</a></h5>
<div class="paragraph">
<p>To show more of the power of configuration injection, let&#8217;s add another project called <code>tropicalFish</code> and add more behavior to the build via the build script of the <code>water</code> project.</p>
</div>
<div class="sect5">
<h6 id="ssub:filtering_by_name"><a class="anchor" href="#ssub:filtering_by_name"></a><a class="link" href="#ssub:filtering_by_name">Filtering by name</a></h6>

</div>
</div>
<div class="sect4">
<h5 id="example_adding_custom_behaviour_to_some_projects_filtered_by_project_name"><a class="anchor" href="#example_adding_custom_behaviour_to_some_projects_filtered_by_project_name"></a><a class="link" href="#example_adding_custom_behaviour_to_some_projects_filtered_by_project_name">Example: Adding custom behaviour to some projects (filtered by project name)</a></h5>
<div class="listingblock">
<div class="title">Project layout</div>
<div class="content">
<pre>.
 bluewhale/
  build.gradle
 build.gradle
 krill/
  build.gradle
 settings.gradle
 tropicalFish/</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/userguide/multiproject/addTropical/water</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">rootProject.name = <span class="string"><span class="delimiter">'</span><span class="content">water</span><span class="delimiter">'</span></span>
include <span class="string"><span class="delimiter">'</span><span class="content">bluewhale</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">krill</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">tropicalFish</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">allprojects {
    task hello {
        doLast { task -&gt;
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm </span><span class="inline"><span class="inline-delimiter">$</span>task</span><span class="content">.project.name</span><span class="delimiter">&quot;</span></span>
        }
    }
}
subprojects {
    hello {
        doLast {
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">- I depend on water</span><span class="delimiter">&quot;</span></span>
        }
    }
}
configure(subprojects.findAll {<span class="local-variable">it</span>.name != <span class="string"><span class="delimiter">'</span><span class="content">tropicalFish</span><span class="delimiter">'</span></span>}) {
    hello {
        doLast {
            println <span class="string"><span class="delimiter">'</span><span class="content">- I love to spend time in the arctic waters.</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q hello</code></div>
<div class="content">
<pre>&gt; gradle -q hello
I'm water
I'm bluewhale
- I depend on water
- I love to spend time in the arctic waters.
- I'm the largest animal that has ever lived on this planet.
I'm krill
- I depend on water
- I love to spend time in the arctic waters.
- The weight of my species in summer is twice as heavy as all human beings.
I'm tropicalFish
- I depend on water</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>configure()</code> method takes a list as an argument and applies the configuration to the projects in this list.</p>
</div>
<div class="sect5">
<h6 id="ssub:filtering_by_properties"><a class="anchor" href="#ssub:filtering_by_properties"></a><a class="link" href="#ssub:filtering_by_properties">Filtering by properties</a></h6>
<div class="paragraph">
<p>Using the project name for filtering is one option. Using <a href="#sec:extra_properties">extra project properties</a> is another. for more information on extra properties.)</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_custom_behaviour_to_some_projects_filtered_by_project_properties"><a class="anchor" href="#example_adding_custom_behaviour_to_some_projects_filtered_by_project_properties"></a><a class="link" href="#example_adding_custom_behaviour_to_some_projects_filtered_by_project_properties">Example: Adding custom behaviour to some projects (filtered by project properties)</a></h5>
<div class="listingblock">
<div class="title">Project layout</div>
<div class="content">
<pre>.
 bluewhale
  build.gradle
 build.gradle
 krill
  build.gradle
 settings.gradle
 tropicalFish
     build.gradle</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/userguide/multiproject/tropicalWithProperties/water</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">rootProject.name = <span class="string"><span class="delimiter">'</span><span class="content">water</span><span class="delimiter">'</span></span>
include <span class="string"><span class="delimiter">'</span><span class="content">bluewhale</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">krill</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">tropicalFish</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">bluewhale/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ext.arctic = <span class="predefined-constant">true</span>
hello.doLast {
  println <span class="string"><span class="delimiter">&quot;</span><span class="content">- I'm the largest animal that has ever lived on this planet.</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">krill/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ext.arctic = <span class="predefined-constant">true</span>
hello.doLast {
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">- The weight of my species in summer is twice as heavy as all human beings.</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">allprojects {
    task hello {
        doLast { task -&gt;
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">I'm </span><span class="inline"><span class="inline-delimiter">$</span>task</span><span class="content">.project.name</span><span class="delimiter">&quot;</span></span>
        }
    }
}
subprojects {
    hello {
        doLast {println <span class="string"><span class="delimiter">&quot;</span><span class="content">- I depend on water</span><span class="delimiter">&quot;</span></span>}
        afterEvaluate { Project project -&gt;
            <span class="keyword">if</span> (project.arctic) { doLast {
                println <span class="string"><span class="delimiter">'</span><span class="content">- I love to spend time in the arctic waters.</span><span class="delimiter">'</span></span> }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">tropicalFish/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ext.arctic = <span class="predefined-constant">false</span></code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q hello</code></div>
<div class="content">
<pre>&gt; gradle -q hello
I'm water
I'm bluewhale
- I depend on water
- I'm the largest animal that has ever lived on this planet.
- I love to spend time in the arctic waters.
I'm krill
- I depend on water
- The weight of my species in summer is twice as heavy as all human beings.
- I love to spend time in the arctic waters.
I'm tropicalFish
- I depend on water</pre>
</div>
</div>
<div class="paragraph">
<p>In the build file of the <code>water</code> project we use an <code>afterEvaluate</code> notification. This means that the closure we are passing gets evaluated <em>after</em> the build scripts of the subproject are evaluated. As the property <code>arctic</code> is set in those build scripts, we have to do it this way. You will find more on this topic in <a href="#sec:dependencies_which_dependencies">Dependencies  Which Dependencies?</a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:execution_rules_for_multi_project_builds"><a class="anchor" href="#sec:execution_rules_for_multi_project_builds"></a><a class="link" href="#sec:execution_rules_for_multi_project_builds">Execution rules for multi-project builds</a></h4>
<div class="paragraph">
<p>When we executed the <code>hello</code> task from the root project dir, things behaved in an intuitive way. All the <code>hello</code> tasks of the different projects were executed. Let&#8217;s switch to the <code>bluewhale</code> dir and see what happens if we execute Gradle from there.</p>
</div>
<div class="sect4">
<h5 id="example_running_build_from_subproject"><a class="anchor" href="#example_running_build_from_subproject"></a><a class="link" href="#example_running_build_from_subproject">Example: Running build from subproject</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
I'm bluewhale
- I depend on water
- I'm the largest animal that has ever lived on this planet.
- I love to spend time in the arctic waters.</pre>
</div>
</div>
<div class="paragraph">
<p>The basic rule behind Gradle&#8217;s behavior is simple. Gradle looks down the hierarchy, starting with the <em>current dir</em>, for tasks with the name <code>hello</code> and executes them. One thing is very important to note. Gradle <em>always</em> evaluates <em>every</em> project of the multi-project build and creates all existing task objects. Then, according to the task name arguments and the current dir, Gradle filters the tasks which should be executed. Because of Gradle&#8217;s cross project configuration <em>every</em> project has to be evaluated before <em>any</em> task gets executed. We will have a closer look at this in the next section. Let&#8217;s now have our last marine example. Let&#8217;s add a task to <code>bluewhale</code> and <code>krill</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_evaluation_and_execution_of_projects"><a class="anchor" href="#example_evaluation_and_execution_of_projects"></a><a class="link" href="#example_evaluation_and_execution_of_projects">Example: Evaluation and execution of projects</a></h5>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">bluewhale/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ext.arctic = <span class="predefined-constant">true</span>
hello {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">- I'm the largest animal that has ever lived on this planet.</span><span class="delimiter">&quot;</span></span>
    }
}

task distanceToIceberg {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">20 nautical miles</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">krill/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ext.arctic = <span class="predefined-constant">true</span>
hello {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">- The weight of my species in summer is twice as heavy as all human beings.</span><span class="delimiter">&quot;</span></span>
    }
}

task distanceToIceberg {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">5 nautical miles</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q distanceToIceberg</code></div>
<div class="content">
<pre>&gt; gradle -q distanceToIceberg
20 nautical miles
5 nautical miles</pre>
</div>
</div>
<div class="paragraph">
<p>Here&#8217;s the output without the <code>-q</code> option:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_evaluation_and_execution_of_projects_2"><a class="anchor" href="#example_evaluation_and_execution_of_projects_2"></a><a class="link" href="#example_evaluation_and_execution_of_projects_2">Example: Evaluation and execution of projects</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle distanceToIceberg</code></strong></div>
<div class="content">
<pre>&gt; gradle distanceToIceberg

&gt; Task :bluewhale:distanceToIceberg
20 nautical miles

&gt; Task :krill:distanceToIceberg
5 nautical miles

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>The build is executed from the <code>water</code> project. Neither <code>water</code> nor <code>tropicalFish</code> have a task with the name <code>distanceToIceberg</code>. Gradle does not care. The simple rule mentioned already above is: Execute all tasks down the hierarchy which have this name. Only complain if there is <em>no</em> such task!</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:running_partial_build_from_the_root"><a class="anchor" href="#sec:running_partial_build_from_the_root"></a><a class="link" href="#sec:running_partial_build_from_the_root">Running tasks by their absolute path</a></h4>
<div class="paragraph">
<p>As we have seen, you can run a multi-project build by entering any subproject dir and execute the build from there. All matching task names of the project hierarchy starting with the current dir are executed. But Gradle also offers to execute tasks by their absolute path (see also <a href="#sec:project_and_task_paths">Project and task paths</a>):</p>
</div>
<div class="sect4">
<h5 id="example_running_tasks_by_their_absolute_path"><a class="anchor" href="#example_running_tasks_by_their_absolute_path"></a><a class="link" href="#example_running_tasks_by_their_absolute_path">Example: Running tasks by their absolute path</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q :hello :krill:hello hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q :hello :krill:hello hello
I'm water
I'm krill
- I depend on water
- The weight of my species in summer is twice as heavy as all human beings.
- I love to spend time in the arctic waters.
I'm tropicalFish
- I depend on water</pre>
</div>
</div>
<div class="paragraph">
<p>The build is executed from the <code>tropicalFish</code> project. We execute the <code>hello</code> tasks of the <code>water</code>, the <code>krill</code> and the <code>tropicalFish</code> project. The first two tasks are specified by their absolute path, the last task is executed using the name matching mechanism described above.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:project_and_task_paths"><a class="anchor" href="#sec:project_and_task_paths"></a><a class="link" href="#sec:project_and_task_paths">Project and task paths</a></h4>
<div class="paragraph">
<p>A project path has the following pattern: It starts with an optional colon, which denotes the root project. The root project is the only project in a path that is not specified by its name. The rest of a project path is a colon-separated sequence of project names, where the next project is a subproject of the previous project.</p>
</div>
<div class="paragraph">
<p>The path of a task is simply its project path plus the task name, like <code>:bluewhale:hello</code>. Within a project you can address a task of the same project just by its name. This is interpreted as a relative path.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:dependencies_which_dependencies"><a class="anchor" href="#sec:dependencies_which_dependencies"></a><a class="link" href="#sec:dependencies_which_dependencies">Dependencies - Which dependencies?</a></h4>
<div class="paragraph">
<p>The examples from the last section were special, as the projects had no <em>Execution Dependencies</em>. They had only <em>Configuration Dependencies</em>. The following sections illustrate the differences between these two types of dependencies.</p>
</div>
<div class="sect4">
<h5 id="sub:execution_time_dependencies"><a class="anchor" href="#sub:execution_time_dependencies"></a><a class="link" href="#sub:execution_time_dependencies">Execution dependencies</a></h5>
<div class="sect5">
<h6 id="ssub:dependencies_and_execution_order"><a class="anchor" href="#ssub:dependencies_and_execution_order"></a><a class="link" href="#ssub:dependencies_and_execution_order">Dependencies and execution order</a></h6>
<div class="sect6">
<h7 id="example_dependencies_and_execution_order"><a class="anchor" href="#example_dependencies_and_execution_order"></a><a class="link" href="#example_dependencies_and_execution_order">Example: Dependencies and execution order</a></h7>
<div class="listingblock">
<div class="title">Project layout</div>
<div class="content">
<pre>.
 build.gradle
 consumer
  build.gradle
 producer
  build.gradle
 settings.gradle</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/userguide/multiproject/dependencies/firstMessages/messages</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ext.producerMessage = <span class="predefined-constant">null</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">include <span class="string"><span class="delimiter">'</span><span class="content">consumer</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">producer</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task action {
    doLast {
        println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Consuming message: </span><span class="inline"><span class="inline-delimiter">${</span>rootProject.producerMessage<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">producer/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task action {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Producing message:</span><span class="delimiter">&quot;</span></span>
        rootProject.producerMessage = <span class="string"><span class="delimiter">'</span><span class="content">Watch the order of execution.</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q action</code></div>
<div class="content">
<pre>&gt; gradle -q action
Consuming message: null
Producing message:</pre>
</div>
</div>
<div class="paragraph">
<p>This didn&#8217;t quite do what we want. If nothing else is defined, Gradle executes the task in alphanumeric order. Therefore, Gradle will execute <code>:consumer:action</code> before <code>:producer:action</code>. Let&#8217;s try to solve this with a hack and rename the producer project to <code>aProducer</code>.</p>
</div>
</div>
<div class="sect6">
<h7 id="example_dependencies_and_execution_order_2"><a class="anchor" href="#example_dependencies_and_execution_order_2"></a><a class="link" href="#example_dependencies_and_execution_order_2">Example: Dependencies and execution order</a></h7>
<div class="listingblock">
<div class="title">Project layout</div>
<div class="content">
<pre>.
 aProducer
  build.gradle
 build.gradle
 consumer
  build.gradle
 settings.gradle</pre>
</div>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ext.producerMessage = <span class="predefined-constant">null</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">include <span class="string"><span class="delimiter">'</span><span class="content">consumer</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">aProducer</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">aProducer/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task action {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Producing message:</span><span class="delimiter">&quot;</span></span>
        rootProject.producerMessage = <span class="string"><span class="delimiter">'</span><span class="content">Watch the order of execution.</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">consumer/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task action {
    doLast {
        println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Consuming message: </span><span class="inline"><span class="inline-delimiter">${</span>rootProject.producerMessage<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q action</code></div>
<div class="content">
<pre>&gt; gradle -q action
Producing message:
Consuming message: Watch the order of execution.</pre>
</div>
</div>
<div class="paragraph">
<p>We can show where this hack doesn&#8217;t work if we now switch to the <code>consumer</code> dir and execute the build.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_dependencies_and_execution_order_3"><a class="anchor" href="#example_dependencies_and_execution_order_3"></a><a class="link" href="#example_dependencies_and_execution_order_3">Example: Dependencies and execution order</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q action</code></strong></div>
<div class="content">
<pre>&gt; gradle -q action
Consuming message: null</pre>
</div>
</div>
<div class="paragraph">
<p>The problem is that the two <code>action</code> tasks are unrelated. If you execute the build from the <code>messages</code> project Gradle executes them both because they have the same name and they are down the hierarchy. In the last example only one <code>action</code> task was down the hierarchy and therefore it was the only task that was executed. We need something better than this hack.</p>
</div>
</div>
<div class="sect4">
<h5 id="sub:real_life_examples"><a class="anchor" href="#sub:real_life_examples"></a><a class="link" href="#sub:real_life_examples">Real life examples</a></h5>
<div class="paragraph">
<p>Gradle&#8217;s multi-project features are driven by real life use cases. One good example consists of two web application projects and a parent project that creates a distribution including the two web applications.<sup class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup> For the example we use only one build script and do <em>cross project configuration</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_dependencies_real_life_example_crossproject_configuration"><a class="anchor" href="#example_dependencies_real_life_example_crossproject_configuration"></a><a class="link" href="#example_dependencies_real_life_example_crossproject_configuration">Example: Dependencies - real life example - crossproject configuration</a></h5>
<div class="listingblock">
<div class="title">Project layout</div>
<div class="content">
<pre>.
 build.gradle
 date
  src
      main
          java
           org
               gradle
                   sample
                       DateServlet.java
          webapp
              web.xml
 hello
  src
      main
          java
           org
               gradle
                   sample
                       HelloServlet.java
          webapp
              web.xml
 settings.gradle</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/userguide/multiproject/dependencies/webDist</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">include <span class="string"><span class="delimiter">'</span><span class="content">date</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">allprojects {
    apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
    group = <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample</span><span class="delimiter">'</span></span>
    version = <span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>
}

subprojects {
    apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">war</span><span class="delimiter">'</span></span>
    repositories {
        mavenCentral()
    }
    dependencies {
        compile <span class="string"><span class="delimiter">&quot;</span><span class="content">javax.servlet:servlet-api:2.5</span><span class="delimiter">&quot;</span></span>
    }
}

task explodedDist(<span class="key">type</span>: Copy) {
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/explodedDist</span><span class="delimiter">&quot;</span></span>
    subprojects {
        from tasks.withType(War)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We have an interesting set of dependencies. Obviously the <code>date</code> and <code>hello</code> projects have a <em>configuration</em> dependency on <code>webDist</code>, as all the build logic for the webapp projects is injected by <code>webDist</code>. The <em>execution</em> dependency is in the other direction, as <code>webDist</code> depends on the build artifacts of <code>date</code> and <code>hello</code>. There is even a third dependency. <code>webDist</code> has a <em>configuration</em> dependency on <code>date</code> and <code>hello</code> because it needs to know the <code>archivePath</code>. But it asks for this information at <em>execution time</em>. Therefore we have no circular dependency.</p>
</div>
<div class="paragraph">
<p>Such dependency patterns are daily bread in the problem space of multi-project builds. If a build system does not support these patterns, you either can&#8217;t solve your problem or you need to do ugly hacks which are hard to maintain and massively impair your productivity as a build master.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:project_jar_dependencies"><a class="anchor" href="#sec:project_jar_dependencies"></a><a class="link" href="#sec:project_jar_dependencies">Project lib dependencies</a></h4>
<div class="paragraph">
<p>What if one project needs the jar produced by another project in its compile path, and not just the jar but also the transitive dependencies of this jar? Obviously this is a very common use case for Java multi-project builds. As mentioned in <a href="#sub:project_dependencies">Project dependencies</a>, Gradle offers project lib dependencies for this.</p>
</div>
<div class="listingblock">
<div class="title">Project lib dependencies</div>
<div class="content">
<pre>.
 api
  src
      main
       java
           org
               gradle
                   sample
                       api
                        Person.java
                       apiImpl
                           PersonImpl.java
      test
          java
              org
                  gradle
                      PersonTest.java
 build.gradle
 services
  personService
      src
          main
           java
               org
                   gradle
                       sample
                           services
                               PersonService.java
          test
              java
                  org
                      gradle
                          sample
                              services
                                  PersonServiceTest.java
 settings.gradle
 shared
     src
         main
             java
                 org
                     gradle
                         sample
                             shared
                                 Helper.java</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/userguide/multiproject/dependencies/java</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We have the projects <code>shared</code>, <code>api</code> and <code>personService</code>. The <code>personService</code> project has a lib dependency on the other two projects. The <code>api</code> project has a lib dependency on the <code>shared</code> project.
<code>services</code> is also a project, but we use it just as a container. It has no build script and gets nothing injected by another build script. We use the <code>:</code> separator to define a project path. Consult the DSL documentation of <a href="../dsl/org.gradle.api.initialization.Settings.html#org.gradle.api.initialization.Settings:include(java.lang.String[])">Settings.include(java.lang.String[])</a> for more information about defining project paths.</p>
</div>
<div class="sect4">
<h5 id="javadependencies_2"><a class="anchor" href="#javadependencies_2"></a><a class="link" href="#javadependencies_2">Example: Project lib dependencies</a></h5>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">include <span class="string"><span class="delimiter">'</span><span class="content">api</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">shared</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">services:personService</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">subprojects {
    apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
    group = <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample</span><span class="delimiter">'</span></span>
    version = <span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>
    repositories {
        mavenCentral()
    }
    dependencies {
        testCompile <span class="string"><span class="delimiter">&quot;</span><span class="content">junit:junit:4.12</span><span class="delimiter">&quot;</span></span>
    }
}

project(<span class="string"><span class="delimiter">'</span><span class="content">:api</span><span class="delimiter">'</span></span>) {
    dependencies {
        compile project(<span class="string"><span class="delimiter">'</span><span class="content">:shared</span><span class="delimiter">'</span></span>)
    }
}

project(<span class="string"><span class="delimiter">'</span><span class="content">:services:personService</span><span class="delimiter">'</span></span>) {
    dependencies {
        compile project(<span class="string"><span class="delimiter">'</span><span class="content">:shared</span><span class="delimiter">'</span></span>), project(<span class="string"><span class="delimiter">'</span><span class="content">:api</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>All the build logic is in the <code>build.gradle</code> file of the root project.<sup class="footnote">[<a id="_footnoteref_5" class="footnote" href="#_footnotedef_5" title="View footnote.">5</a>]</sup> A <em>lib</em> dependency is a special form of an execution dependency. It causes the other project to be built first and adds the jar with the classes of the other project to the classpath. It also adds the dependencies of the other project to the classpath. So you can enter the <code>api</code> directory and trigger a <code>gradle compile</code>. First the <code>shared</code> project is built and then the <code>api</code> project is built. Project dependencies enable partial multi-project builds.</p>
</div>
<div class="paragraph">
<p>If you come from Maven land you might be perfectly happy with this. If you come from Ivy land, you might expect some more fine grained control. Gradle offers this to you:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_fine_grained_control_over_dependencies"><a class="anchor" href="#example_fine_grained_control_over_dependencies"></a><a class="link" href="#example_fine_grained_control_over_dependencies">Example: Fine grained control over dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">subprojects {
    apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
    group = <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample</span><span class="delimiter">'</span></span>
    version = <span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>
}

project(<span class="string"><span class="delimiter">'</span><span class="content">:api</span><span class="delimiter">'</span></span>) {
    configurations {
        spi
    }
    dependencies {
        compile project(<span class="string"><span class="delimiter">'</span><span class="content">:shared</span><span class="delimiter">'</span></span>)
    }
    task spiJar(<span class="key">type</span>: Jar) {
        baseName = <span class="string"><span class="delimiter">'</span><span class="content">api-spi</span><span class="delimiter">'</span></span>
        from sourceSets.main.output
        include(<span class="string"><span class="delimiter">'</span><span class="content">org/gradle/sample/api/**</span><span class="delimiter">'</span></span>)
    }
    artifacts {
        spi spiJar
    }
}

project(<span class="string"><span class="delimiter">'</span><span class="content">:services:personService</span><span class="delimiter">'</span></span>) {
    dependencies {
        compile project(<span class="string"><span class="delimiter">'</span><span class="content">:shared</span><span class="delimiter">'</span></span>)
        compile project(<span class="key">path</span>: <span class="string"><span class="delimiter">'</span><span class="content">:api</span><span class="delimiter">'</span></span>, <span class="key">configuration</span>: <span class="string"><span class="delimiter">'</span><span class="content">spi</span><span class="delimiter">'</span></span>)
        testCompile <span class="string"><span class="delimiter">&quot;</span><span class="content">junit:junit:4.12</span><span class="delimiter">&quot;</span></span>, project(<span class="string"><span class="delimiter">'</span><span class="content">:api</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Java plugin adds per default a jar to your project libraries which contains all the classes. In this example we create an <em>additional</em> library containing only the interfaces of the <code>api</code> project. We assign this library to a new <em>dependency configuration</em>. For the person service we declare that the project should be compiled only against the <code>api</code> interfaces but tested with all classes from <code>api</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:depending_on_output_of_another_project"><a class="anchor" href="#sec:depending_on_output_of_another_project"></a><a class="link" href="#sec:depending_on_output_of_another_project">Depending on the task output produced by another project</a></h4>
<div class="paragraph">
<p><a href="#sec:project_jar_dependencies">Project dependencies</a> model dependencies between modules. Effectively, you are saying that you depend on the main output of another project. In a Java-based project that&#8217;s usually a JAR file.</p>
</div>
<div class="paragraph">
<p>Sometimes you may want to depend on an output produced by another task. In turn you&#8217;ll want to make sure that the task is executed beforehand to produce that very output. Declaring a task dependency from one project to another is a poor way to model this kind of relationship and introduces unnecessary coupling. The recommended way to model such a dependency is to produce the output, mark it as an "outgoing" artifact or add it to the output of the <code>main</code> source set which you can depend on in the consuming project.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you are working in a multi-project build with the two subprojects <code>producer</code> and <code>consumer</code>. The subproject <code>producer</code> defines a task named <code>buildInfo</code> that generates a properties file containing build information e.g. the project version. The attribute <code>builtBy</code> takes care of establishing an inferred task dependency. For more information on <code>builtBy</code>, see <a href="../dsl/org.gradle.api.tasks.SourceSetOutput.html">SourceSetOutput</a>.</p>
</div>
<div class="sect4">
<h5 id="example_task_generating_a_property_file_containing_build_information"><a class="anchor" href="#example_task_generating_a_property_file_containing_build_information"></a><a class="link" href="#example_task_generating_a_property_file_containing_build_information">Example: Task generating a property file containing build information</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task buildInfo(<span class="key">type</span>: BuildInfo) {
    version = project.version
    outputFile = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/generated-resources/build-info.properties</span><span class="delimiter">&quot;</span></span>)
}

sourceSets {
    main {
        output.dir(buildInfo.outputFile.parentFile, <span class="key">builtBy</span>: buildInfo)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The consuming project is supposed to be able to read the properties file at runtime. Declaring a project dependency on the producing project takes care of creating the properties beforehand and making it available to the runtime classpath.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_a_project_dependency_on_the_project_producing_the_properties_file"><a class="anchor" href="#example_declaring_a_project_dependency_on_the_project_producing_the_properties_file"></a><a class="link" href="#example_declaring_a_project_dependency_on_the_project_producing_the_properties_file">Example: Declaring a project dependency on the project producing the properties file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    runtime project(<span class="string"><span class="delimiter">'</span><span class="content">:producer</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, the consumer now declares a dependency on the outputs of the <code>producer</code> project.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:parallel_execution"><a class="anchor" href="#sec:parallel_execution"></a><a class="link" href="#sec:parallel_execution">Parallel project execution</a></h4>
<div class="paragraph">
<p>With more and more CPU cores available on developer desktops and CI servers, it is important that Gradle is able to fully utilise these processing resources. More specifically, parallel execution attempts to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reduce total build time for a multi-project build where execution is IO bound or otherwise does not consume all available CPU resources.</p>
</li>
<li>
<p>Provide faster feedback for execution of small projects without awaiting completion of other projects.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although Gradle already offers parallel test execution via <a href="../javadoc/org/gradle/api/tasks/testing/Test.html#setMaxParallelForks-int-">Test.setMaxParallelForks(int)</a> the feature described in this section is parallel execution at a project level. Parallel execution is an incubating feature. Please use it and let us know how it works for you.</p>
</div>
<div class="paragraph">
<p>Parallel project execution allows the separate projects in a decoupled multi-project build to be executed in parallel (see also <a href="#sec:decoupled_projects">Decoupled projects</a>). While parallel execution does not strictly require decoupling at configuration time, the long-term goal is to provide a powerful set of features that will be available for fully decoupled projects. Such features include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#sec:configuration_on_demand">Configuration on-demand</a>.</p>
</li>
<li>
<p>Configuration of projects in parallel.</p>
</li>
<li>
<p>Re-use of configuration for unchanged projects.</p>
</li>
<li>
<p>Project-level up-to-date checks.</p>
</li>
<li>
<p>Using pre-built artifacts in the place of building dependent projects.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>How does parallel execution work? First, you need to tell Gradle to use parallel mode. You can use the <a href="#sec:command_line_performance"><code>--parallel</code> command line argument</a> or configure your build environment (<a href="#sec:gradle_configuration_properties">Gradle properties</a>). Unless you provide a specific number of parallel threads, Gradle attempts to choose the right number based on available CPU cores. Every parallel worker exclusively owns a given project while executing a task. Task dependencies are fully supported and parallel workers will start executing upstream tasks first. Bear in mind that the alphabetical ordering of decoupled tasks, as can be seen during sequential execution, is not guaranteed in parallel mode. In other words, in parallel mode tasks will run as soon as their dependencies complete <em>and a task worker is available to run them</em>, which may be earlier than they would start during a sequential build. You should make sure that task dependencies and task inputs/outputs are declared correctly to avoid ordering issues.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:decoupled_projects"><a class="anchor" href="#sec:decoupled_projects"></a><a class="link" href="#sec:decoupled_projects">Decoupled Projects</a></h4>
<div class="paragraph">
<p>Gradle allows any project to access any other project during both the configuration and execution phases. While this provides a great deal of power and flexibility to the build author, it also limits the flexibility that Gradle has when building those projects. For instance, this effectively prevents Gradle from correctly building multiple projects in parallel, configuring only a subset of projects, or from substituting a pre-built artifact in place of a project dependency.</p>
</div>
<div class="paragraph">
<p>Two projects are said to be <em>decoupled</em> if they do not directly access each other&#8217;s project model. Decoupled projects may only interact in terms of declared dependencies: <a href="#sub:project_dependencies">project dependencies</a> and/or <a href="#sec:task_dependencies">task dependencies</a>. Any other form of project interaction (i.e. by modifying another project object or by reading a value from another project object) causes the projects to be coupled. The consequence of coupling during the configuration phase is that if gradle is invoked with the 'configuration on demand' option, the result of the build can be flawed in several ways. The consequence of coupling during execution phase is that if gradle is invoked with the parallel option, one project task runs too late to influence a task of a project building in parallel. Gradle does not attempt to detect coupling and warn the user, as there are too many possibilities to introduce coupling.</p>
</div>
<div class="paragraph">
<p>A very common way for projects to be coupled is by using <a href="#sec:cross_project_configuration">configuration injection</a>. It may not be immediately apparent, but using key Gradle features like the <code>allprojects</code> and <code>subprojects</code> keywords automatically cause your projects to be coupled. This is because these keywords are used in a <code>build.gradle</code> file, which defines a project. Often this is a root project that does nothing more than define common configuration, but as far as Gradle is concerned this root project is still a fully-fledged project, and by using <code>allprojects</code> that project is effectively coupled to all other projects. Coupling of the root project to subprojects does not impact 'configuration on demand', but using the <code>allprojects</code> and <code>subprojects</code> in any subproject&#8217;s <code>build.gradle</code> file will have an impact.</p>
</div>
<div class="paragraph">
<p>This means that using any form of shared build script logic or configuration injection (<code>allprojects</code>, <code>subprojects</code>, etc.) will cause your projects to be coupled. As we extend the concept of project decoupling and provide features that take advantage of decoupled projects, we will also introduce new features to help you to solve common use cases (like configuration injection) without causing your projects to be coupled.</p>
</div>
<div class="paragraph">
<p>In order to make good use of cross project configuration without running into issues for parallel and 'configuration on demand' options, follow these recommendations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Avoid a subproject&#8217;s <code>build.gradle</code> referencing other subprojects; preferring cross configuration from the root project.</p>
</li>
<li>
<p>Avoid changing the configuration of other projects at execution time.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:multiproject_build_and_test"><a class="anchor" href="#sec:multiproject_build_and_test"></a><a class="link" href="#sec:multiproject_build_and_test">Multi-Project Building and Testing</a></h4>
<div class="paragraph">
<p>The <code>build</code> task of the Java plugin is typically used to compile, test, and perform code style checks (if the CodeQuality plugin is used) of a single project. In multi-project builds you may often want to do all of these tasks across a range of projects. The <code>buildNeeded</code> and <code>buildDependents</code> tasks can help with this.</p>
</div>
<div class="paragraph">
<p>In <a href="#javadependencies_2">this example</a>, the <code>:services:personservice</code> project depends on both the <code>:api</code> and <code>:shared</code> projects. The <code>:api</code> project also depends on the <code>:shared</code> project.</p>
</div>
<div class="paragraph">
<p>Assume you are working on a single project, the <code>:api</code> project. You have been making changes, but have not built the entire project since performing a clean. You want to build any necessary supporting jars, but only perform code quality and unit tests on the project you have changed. The <code>build</code> task does this.</p>
</div>
<div class="sect4">
<h5 id="example_build_and_test_single_project"><a class="anchor" href="#example_build_and_test_single_project"></a><a class="link" href="#example_build_and_test_single_project">Example: Build and Test Single Project</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle :api:build</code></strong></div>
<div class="content">
<pre>&gt; gradle :api:build
&gt; Task :shared:compileJava
&gt; Task :shared:processResources
&gt; Task :shared:classes
&gt; Task :shared:jar
&gt; Task :api:compileJava
&gt; Task :api:processResources
&gt; Task :api:classes
&gt; Task :api:jar
&gt; Task :api:assemble
&gt; Task :api:compileTestJava
&gt; Task :api:processTestResources
&gt; Task :api:testClasses
&gt; Task :api:test
&gt; Task :api:check
&gt; Task :api:build

BUILD SUCCESSFUL in 0s
9 actionable tasks: 9 executed</pre>
</div>
</div>
<div class="paragraph">
<p>If you have just gotten the latest version of source from your version control system which included changes in other projects that <code>:api</code> depends on, you might want to not only build all the projects you depend on, but test them as well. The <code>buildNeeded</code> task also tests all the projects from the project lib dependencies of the testRuntime configuration.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_build_and_test_depended_on_projects"><a class="anchor" href="#example_build_and_test_depended_on_projects"></a><a class="link" href="#example_build_and_test_depended_on_projects">Example: Build and Test Depended On Projects</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle :api:buildNeeded</code></strong></div>
<div class="content">
<pre>&gt; gradle :api:buildNeeded
&gt; Task :shared:compileJava
&gt; Task :shared:processResources
&gt; Task :shared:classes
&gt; Task :shared:jar
&gt; Task :api:compileJava
&gt; Task :api:processResources
&gt; Task :api:classes
&gt; Task :api:jar
&gt; Task :api:assemble
&gt; Task :api:compileTestJava
&gt; Task :api:processTestResources
&gt; Task :api:testClasses
&gt; Task :api:test
&gt; Task :api:check
&gt; Task :api:build
&gt; Task :shared:assemble
&gt; Task :shared:compileTestJava
&gt; Task :shared:processTestResources
&gt; Task :shared:testClasses
&gt; Task :shared:test
&gt; Task :shared:check
&gt; Task :shared:build
&gt; Task :shared:buildNeeded
&gt; Task :api:buildNeeded

BUILD SUCCESSFUL in 0s
12 actionable tasks: 12 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You also might want to refactor some part of the <code>:api</code> project that is used in other projects. If you make these types of changes, it is not sufficient to test just the <code>:api</code> project, you also need to test all projects that depend on the <code>:api</code> project. The <code>buildDependents</code> task also tests all the projects that have a project lib dependency (in the testRuntime configuration) on the specified project.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_build_and_test_dependent_projects"><a class="anchor" href="#example_build_and_test_dependent_projects"></a><a class="link" href="#example_build_and_test_dependent_projects">Example: Build and Test Dependent Projects</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle :api:buildDependents</code></strong></div>
<div class="content">
<pre>&gt; gradle :api:buildDependents
&gt; Task :shared:compileJava
&gt; Task :shared:processResources
&gt; Task :shared:classes
&gt; Task :shared:jar
&gt; Task :api:compileJava
&gt; Task :api:processResources
&gt; Task :api:classes
&gt; Task :api:jar
&gt; Task :api:assemble
&gt; Task :api:compileTestJava
&gt; Task :api:processTestResources
&gt; Task :api:testClasses
&gt; Task :api:test
&gt; Task :api:check
&gt; Task :api:build
&gt; Task :services:personService:compileJava
&gt; Task :services:personService:processResources
&gt; Task :services:personService:classes
&gt; Task :services:personService:jar
&gt; Task :services:personService:assemble
&gt; Task :services:personService:compileTestJava
&gt; Task :services:personService:processTestResources
&gt; Task :services:personService:testClasses
&gt; Task :services:personService:test
&gt; Task :services:personService:check
&gt; Task :services:personService:build
&gt; Task :services:personService:buildDependents
&gt; Task :api:buildDependents

BUILD SUCCESSFUL in 0s
17 actionable tasks: 17 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, you may want to build and test everything in all projects. Any task you run in the root project folder will cause that same named task to be run on all the children. So you can just run <code>gradle build</code> to build and test all projects.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:multi_project_and_buildsrc"><a class="anchor" href="#sec:multi_project_and_buildsrc"></a><a class="link" href="#sec:multi_project_and_buildsrc">Multi Project and buildSrc</a></h4>
<div class="paragraph">
<p><a href="#sec:build_sources">Using buildSrc to organize build logic</a> tells us that we can place build logic to be compiled and tested in the special <code>buildSrc</code> directory. In a multi project build, there can only be one <code>buildSrc</code> directory which must be located in the root directory.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="more_about_tasks"><a class="anchor" href="#more_about_tasks"></a><a class="link" href="#more_about_tasks">Authoring Tasks</a></h3>
<div class="paragraph">
<p>In the <a href="#tutorial_using_tasks">introductory tutorial</a> you learned how to create simple tasks. You also learned how to add additional behavior to these tasks later on, and you learned how to create dependencies between tasks. This was all about simple tasks, but Gradle takes the concept of tasks further. Gradle supports <em>enhanced tasks</em>, which are tasks that have their own properties and methods. This is really different from what you are used to with Ant targets. Such enhanced tasks are either provided by you or built into Gradle.</p>
</div>
<div class="sect3">
<h4 id="sec:task_outcomes"><a class="anchor" href="#sec:task_outcomes"></a><a class="link" href="#sec:task_outcomes">Task outcomes</a></h4>
<div class="paragraph">
<p>When Gradle executes a task, it can label the task with different outcomes in the console UI and via the <a href="#embedding">Tooling API</a>. These labels are based on if a task has actions to execute, if it should execute those actions, if it did execute those actions and if those actions made any changes.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>(no label)</code> or <code>EXECUTED</code></dt>
<dd>
<p>Task executed its actions.</p>
<div class="ulist">
<ul>
<li>
<p>Task has actions and Gradle has determined they should be executed as part of a build.</p>
</li>
<li>
<p>Task has no actions and some dependencies, and any of the dependencies are executed. See also <a href="#sec:lifecycle_tasks">Lifecycle Tasks</a>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>UP-TO-DATE</code></dt>
<dd>
<p>Task&#8217;s outputs did not change.</p>
<div class="ulist">
<ul>
<li>
<p>Task has outputs and inputs and they have not changed. See <a href="#sec:up_to_date_checks">Incremental Builds</a>.</p>
</li>
<li>
<p>Task has actions, but the task tells Gradle it did not change its outputs.</p>
</li>
<li>
<p>Task has no actions and some dependencies, but all of the dependencies are up-to-date, skipped or from cache. See also <a href="#sec:lifecycle_tasks">Lifecycle Tasks</a>.</p>
</li>
<li>
<p>Task has no actions and no dependencies.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>FROM-CACHE</code></dt>
<dd>
<p>Task&#8217;s outputs could be found from a previous execution.</p>
<div class="ulist">
<ul>
<li>
<p>Task has outputs restored from the build cache. See <a href="#build_cache">Build Cache</a>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>SKIPPED</code></dt>
<dd>
<p>Task did not execute its actions.</p>
<div class="ulist">
<ul>
<li>
<p>Task has been explicitly excluded from the command-line. See <a href="#sec:excluding_tasks_from_the_command_line">Excluding tasks from execution</a>.</p>
</li>
<li>
<p>Task has an <code>onlyIf</code> predicate return false. See <a href="#sec:using_a_predicate">Using a predicate</a>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>NO-SOURCE</code></dt>
<dd>
<p>Task did not need to execute its actions.</p>
<div class="ulist">
<ul>
<li>
<p>Task has inputs and outputs, but <a href="#skip-when-empty">no sources</a>. For example, source files are <code>.java</code> files for <a href="../dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:defining_tasks"><a class="anchor" href="#sec:defining_tasks"></a><a class="link" href="#sec:defining_tasks">Defining tasks</a></h4>
<div class="paragraph">
<p>We have already seen how to define tasks using a keyword style in <a href="#tutorial_using_tasks">this chapter</a>. There are a few variations on this style, which you may need to use in certain situations. For example, the keyword style does not work in expressions.</p>
</div>
<div class="sect4">
<h5 id="example_defining_tasks"><a class="anchor" href="#example_defining_tasks"></a><a class="link" href="#example_defining_tasks">Example: Defining tasks</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task(hello) {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>
    }
}

task(copy, <span class="key">type</span>: Copy) {
    from(file(<span class="string"><span class="delimiter">'</span><span class="content">srcDir</span><span class="delimiter">'</span></span>))
    into(buildDir)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also use strings for the task names:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_tasks_using_strings_for_task_names"><a class="anchor" href="#example_defining_tasks_using_strings_for_task_names"></a><a class="link" href="#example_defining_tasks_using_strings_for_task_names">Example: Defining tasks - using strings for task names</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>) {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>
    }
}

task(<span class="string"><span class="delimiter">'</span><span class="content">copy</span><span class="delimiter">'</span></span>, <span class="key">type</span>: Copy) {
    from(file(<span class="string"><span class="delimiter">'</span><span class="content">srcDir</span><span class="delimiter">'</span></span>))
    into(buildDir)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is an alternative syntax for defining tasks, which you may prefer to use:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_tasks_with_alternative_syntax"><a class="anchor" href="#example_defining_tasks_with_alternative_syntax"></a><a class="link" href="#example_defining_tasks_with_alternative_syntax">Example: Defining tasks with alternative syntax</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.create(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>) {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>
    }
}

tasks.create(<span class="string"><span class="delimiter">'</span><span class="content">copy</span><span class="delimiter">'</span></span>, Copy) {
    from(file(<span class="string"><span class="delimiter">'</span><span class="content">srcDir</span><span class="delimiter">'</span></span>))
    into(buildDir)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we add tasks to the <code>tasks</code> collection. Have a look at <a href="../javadoc/org/gradle/api/tasks/TaskContainer.html">TaskContainer</a> for more variations of the <code>create()</code> method.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:locating_tasks"><a class="anchor" href="#sec:locating_tasks"></a><a class="link" href="#sec:locating_tasks">Locating tasks</a></h4>
<div class="paragraph">
<p>You often need to locate the tasks that you have defined in the build file, for example, to configure them or use them for dependencies. There are a number of ways of doing this. Firstly, each task is available as a property of the project, using the task name as the property name:</p>
</div>
<div class="sect4">
<h5 id="example_accessing_tasks_as_properties"><a class="anchor" href="#example_accessing_tasks_as_properties"></a><a class="link" href="#example_accessing_tasks_as_properties">Example: Accessing tasks as properties</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task hello

println hello.name
println project.hello.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tasks are also available through the <code>tasks</code> collection.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_accessing_tasks_via_tasks_collection"><a class="anchor" href="#example_accessing_tasks_via_tasks_collection"></a><a class="link" href="#example_accessing_tasks_via_tasks_collection">Example: Accessing tasks via tasks collection</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task hello

println tasks.hello.name
println tasks[<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>].name</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can access tasks from any project using the task&#8217;s path using the <code>tasks.getByPath()</code> method. You can call the <code>getByPath()</code> method with a task name, or a relative path, or an absolute path.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_accessing_tasks_by_path"><a class="anchor" href="#example_accessing_tasks_by_path"></a><a class="link" href="#example_accessing_tasks_by_path">Example: Accessing tasks by path</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">project(<span class="string"><span class="delimiter">'</span><span class="content">:projectA</span><span class="delimiter">'</span></span>) {
    task hello
}

task hello

println tasks.getByPath(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>).path
println tasks.getByPath(<span class="string"><span class="delimiter">'</span><span class="content">:hello</span><span class="delimiter">'</span></span>).path
println tasks.getByPath(<span class="string"><span class="delimiter">'</span><span class="content">projectA:hello</span><span class="delimiter">'</span></span>).path
println tasks.getByPath(<span class="string"><span class="delimiter">'</span><span class="content">:projectA:hello</span><span class="delimiter">'</span></span>).path</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
:hello
:hello
:projectA:hello
:projectA:hello</pre>
</div>
</div>
<div class="paragraph">
<p>Have a look at <a href="../javadoc/org/gradle/api/tasks/TaskContainer.html">TaskContainer</a> for more options for locating tasks.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring_tasks"><a class="anchor" href="#sec:configuring_tasks"></a><a class="link" href="#sec:configuring_tasks">Configuring tasks</a></h4>
<div class="paragraph">
<p>As an example, let&#8217;s look at the <code>Copy</code> task provided by Gradle. To create a <code>Copy</code> task for your build, you can declare in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_creating_a_copy_task"><a class="anchor" href="#example_creating_a_copy_task"></a><a class="link" href="#example_creating_a_copy_task">Example: Creating a copy task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task myCopy(<span class="key">type</span>: Copy)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This creates a copy task with no default behavior. The task can be configured using its API (see <a href="../dsl/org.gradle.api.tasks.Copy.html">Copy</a>). The following examples show several different ways to achieve the same configuration.</p>
</div>
<div class="paragraph">
<p>Just to be clear, realize that the name of this task is <code>myCopy</code>, but it is of <em>type</em> <code>Copy</code>. You can have multiple tasks of the same <em>type</em>, but with different names. You&#8217;ll find this gives you a lot of power to implement cross-cutting concerns across all tasks of a particular type.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_a_task_various_ways"><a class="anchor" href="#example_configuring_a_task_various_ways"></a><a class="link" href="#example_configuring_a_task_various_ways">Example: Configuring a task - various ways</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Copy myCopy = task(myCopy, <span class="key">type</span>: Copy)
myCopy.from <span class="string"><span class="delimiter">'</span><span class="content">resources</span><span class="delimiter">'</span></span>
myCopy.into <span class="string"><span class="delimiter">'</span><span class="content">target</span><span class="delimiter">'</span></span>
myCopy.include(<span class="string"><span class="delimiter">'</span><span class="content">**/*.txt</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.xml</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.properties</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is similar to the way we would configure objects in Java. You have to repeat the context (<code>myCopy</code>) in the configuration statement every time. This is a redundancy and not very nice to read.</p>
</div>
<div class="paragraph">
<p>There is another way of configuring a task. It also preserves the context and it is arguably the most readable. It is usually our favorite.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_a_task_with_closure"><a class="anchor" href="#example_configuring_a_task_with_closure"></a><a class="link" href="#example_configuring_a_task_with_closure">Example: Configuring a task - with closure</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task myCopy(<span class="key">type</span>: Copy)

myCopy {
   from <span class="string"><span class="delimiter">'</span><span class="content">resources</span><span class="delimiter">'</span></span>
   into <span class="string"><span class="delimiter">'</span><span class="content">target</span><span class="delimiter">'</span></span>
   include(<span class="string"><span class="delimiter">'</span><span class="content">**/*.txt</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.xml</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.properties</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This works for <em>any</em> task. Line 3 of the example is just a shortcut for the <code>tasks.getByName()</code> method. It is important to note that if you pass a closure to the <code>getByName()</code> method, this closure is applied to <em>configure</em> the task, not when the task executes.</p>
</div>
<div class="paragraph">
<p>You can also use a configuration closure when you define a task.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_a_task_with_closure"><a class="anchor" href="#example_defining_a_task_with_closure"></a><a class="link" href="#example_defining_a_task_with_closure">Example: Defining a task with closure</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copy(<span class="key">type</span>: Copy) {
   from <span class="string"><span class="delimiter">'</span><span class="content">resources</span><span class="delimiter">'</span></span>
   into <span class="string"><span class="delimiter">'</span><span class="content">target</span><span class="delimiter">'</span></span>
   include(<span class="string"><span class="delimiter">'</span><span class="content">**/*.txt</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.xml</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.properties</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">Don&#8217;t forget about the build phases</div>
<div class="paragraph">
<p>A task has both configuration and actions. When using the <code>doLast</code>, you are simply using a shortcut to define an action. Code defined in the configuration section of your task will get executed during the configuration phase of the build regardless of what task was targeted. See <a href="#build_lifecycle">Build Lifecycle</a> for more details about the build lifecycle.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:passing_arguments_to_a_task_constructor"><a class="anchor" href="#sec:passing_arguments_to_a_task_constructor"></a><a class="link" href="#sec:passing_arguments_to_a_task_constructor">Passing arguments to a task constructor</a></h4>
<div class="paragraph">
<p>As opposed to configuring the mutable properties of a <code>Task</code> after creation, you can pass argument values to the <code>Task</code> class&#8217;s constructor.
In order to pass values to the <code>Task</code> constructor, you must annotate the relevant constructor with <code>@javax.inject.Inject</code>.</p>
</div>
<div class="sect4">
<h5 id="example_task_class_with_inject_constructor"><a class="anchor" href="#example_task_class_with_inject_constructor"></a><a class="link" href="#example_task_class_with_inject_constructor">Example: Task class with @Inject constructor</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">CustomTask</span> <span class="directive">extends</span> DefaultTask {
    <span class="directive">final</span> <span class="predefined-type">String</span> message
    <span class="directive">final</span> <span class="type">int</span> number

    <span class="annotation">@Inject</span>
    CustomTask(<span class="predefined-type">String</span> message, <span class="type">int</span> number) {
        <span class="local-variable">this</span>.message = message
        <span class="local-variable">this</span>.number = number
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then create a task, passing the constructor arguments at the end of the parameter list.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_creating_a_task_with_constructor_arguments_using_taskcontainer"><a class="anchor" href="#example_creating_a_task_with_constructor_arguments_using_taskcontainer"></a><a class="link" href="#example_creating_a_task_with_constructor_arguments_using_taskcontainer">Example: Creating a task with constructor arguments using TaskContainer</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.create(<span class="string"><span class="delimiter">'</span><span class="content">myTask</span><span class="delimiter">'</span></span>, CustomTask, <span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>, <span class="integer">42</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In a Groovy build script, you can create the task using <code>constructorArgs</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_creating_a_task_with_constructor_arguments_using_map"><a class="anchor" href="#example_creating_a_task_with_constructor_arguments_using_map"></a><a class="link" href="#example_creating_a_task_with_constructor_arguments_using_map">Example: Creating a task with constructor arguments using Map</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task myTask(<span class="key">type</span>: CustomTask, <span class="key">constructorArgs</span>: [<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>, <span class="integer">42</span>])</code></pre>
</div>
</div>
<div class="paragraph">
<p>In a Kotlin build script, you can pass constructor arguments using the reified extension function on the <code>tasks</code> <code>TaskContainer</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_creating_a_task_with_constructor_arguments_using_kotlin_dsl"><a class="anchor" href="#example_creating_a_task_with_constructor_arguments_using_kotlin_dsl"></a><a class="link" href="#example_creating_a_task_with_constructor_arguments_using_kotlin_dsl">Example: Creating a task with constructor arguments using Kotlin DSL</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle.kts</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">open <span class="type">class</span> <span class="class">CustomTask</span> <span class="annotation">@Inject</span> constructor(<span class="directive">private</span> val <span class="key">message</span>: <span class="predefined-type">String</span>, <span class="directive">private</span> val <span class="key">number</span>: Int) : DefaultTask() {
    <span class="annotation">@TaskAction</span> fun run() = println(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>message</span><span class="content"> </span><span class="inline"><span class="inline-delimiter">$</span>number</span><span class="delimiter">&quot;</span></span>)
}

tasks.create&lt;CustomTask&gt;(<span class="string"><span class="delimiter">&quot;</span><span class="content">myTask</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>, <span class="integer">42</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In all circumstances, the values passed as constructor arguments must be non-null.
If you attempt to pass a <code>null</code> value, Gradle will throw a <code>NullPointerException</code> indicating which runtime value is <code>null</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:adding_dependencies_to_tasks"><a class="anchor" href="#sec:adding_dependencies_to_tasks"></a><a class="link" href="#sec:adding_dependencies_to_tasks">Adding dependencies to a task</a></h4>
<div class="paragraph">
<p>There are several ways you can define the dependencies of a task. In <a href="#sec:task_dependencies">Task dependencies</a> you were introduced to defining dependencies using task names. Task names can refer to tasks in the same project as the task, or to tasks in other projects. To refer to a task in another project, you prefix the name of the task with the path of the project it belongs to. The following is an example which adds a dependency from <code>projectA:taskX</code> to <code>projectB:taskY</code>:</p>
</div>
<div class="sect4">
<h5 id="example_adding_dependency_on_task_from_another_project"><a class="anchor" href="#example_adding_dependency_on_task_from_another_project"></a><a class="link" href="#example_adding_dependency_on_task_from_another_project">Example: Adding dependency on task from another project</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">project(<span class="string"><span class="delimiter">'</span><span class="content">projectA</span><span class="delimiter">'</span></span>) {
    task taskX(<span class="key">dependsOn</span>: <span class="string"><span class="delimiter">'</span><span class="content">:projectB:taskY</span><span class="delimiter">'</span></span>) {
        doLast {
            println <span class="string"><span class="delimiter">'</span><span class="content">taskX</span><span class="delimiter">'</span></span>
        }
    }
}

project(<span class="string"><span class="delimiter">'</span><span class="content">projectB</span><span class="delimiter">'</span></span>) {
    task taskY {
        doLast {
            println <span class="string"><span class="delimiter">'</span><span class="content">taskY</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q taskX</code></strong></div>
<div class="content">
<pre>&gt; gradle -q taskX
taskY
taskX</pre>
</div>
</div>
<div class="paragraph">
<p>Instead of using a task name, you can define a dependency using a <code>Task</code> object, as shown in this example:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_dependency_using_task_object"><a class="anchor" href="#example_adding_dependency_using_task_object"></a><a class="link" href="#example_adding_dependency_using_task_object">Example: Adding dependency using task object</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task taskX {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskX</span><span class="delimiter">'</span></span>
    }
}

task taskY {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskY</span><span class="delimiter">'</span></span>
    }
}

taskX.dependsOn taskY</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q taskX</code></strong></div>
<div class="content">
<pre>&gt; gradle -q taskX
taskY
taskX</pre>
</div>
</div>
<div class="paragraph">
<p>For more advanced uses, you can define a task dependency using a closure. When evaluated, the closure is passed the task whose dependencies are being calculated. The closure should return a single <code>Task</code> or collection of <code>Task</code> objects, which are then treated as dependencies of the task. The following example adds a dependency from <code>taskX</code> to all the tasks in the project whose name starts with <code>lib</code>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_dependency_using_closure"><a class="anchor" href="#example_adding_dependency_using_closure"></a><a class="link" href="#example_adding_dependency_using_closure">Example: Adding dependency using closure</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task taskX {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskX</span><span class="delimiter">'</span></span>
    }
}

taskX.dependsOn {
    tasks.findAll { task -&gt; task.name.startsWith(<span class="string"><span class="delimiter">'</span><span class="content">lib</span><span class="delimiter">'</span></span>) }
}

task lib1 {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">lib1</span><span class="delimiter">'</span></span>
    }
}

task lib2 {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">lib2</span><span class="delimiter">'</span></span>
    }
}

task notALib {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">notALib</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q taskX</code></strong></div>
<div class="content">
<pre>&gt; gradle -q taskX
lib1
lib2
taskX</pre>
</div>
</div>
<div class="paragraph">
<p>For more information about task dependencies, see the <a href="../dsl/org.gradle.api.Task.html">Task</a> API.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:ordering_tasks"><a class="anchor" href="#sec:ordering_tasks"></a><a class="link" href="#sec:ordering_tasks">Ordering tasks</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Task ordering is an <a href="#feature_lifecycle">incubating</a> feature. Please be aware that this feature may change in later Gradle versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In some cases it is useful to control the <em>order</em> in which 2 tasks will execute, without introducing an explicit dependency between those tasks. The primary difference between a task <em>ordering</em> and a task <em>dependency</em> is that an ordering rule does not influence which tasks will be executed, only the order in which they will be executed.</p>
</div>
<div class="paragraph">
<p>Task ordering can be useful in a number of scenarios:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enforce sequential ordering of tasks: e.g. 'build' never runs before 'clean'.</p>
</li>
<li>
<p>Run build validations early in the build: e.g. validate I have the correct credentials before starting the work for a release build.</p>
</li>
<li>
<p>Get feedback faster by running quick verification tasks before long verification tasks: e.g. unit tests should run before integration tests.</p>
</li>
<li>
<p>A task that aggregates the results of all tasks of a particular type: e.g. test report task combines the outputs of all executed test tasks.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are two ordering rules available: <em>must run after</em> and <em>should run after</em>.</p>
</div>
<div class="paragraph">
<p>When you use the must run after ordering rule you specify that <code>taskB</code> must always run after <code>taskA</code>, whenever both <code>taskA</code> and <code>taskB</code> will be run. This is expressed as <code>taskB.mustRunAfter(taskA)</code>. The should run after ordering rule is similar but less strict as it will be ignored in two situations. Firstly if using that rule introduces an ordering cycle. Secondly when using parallel execution and all dependencies of a task have been satisfied apart from the should run after task, then this task will be run regardless of whether its should run after dependencies have been run or not. You should use should run after where the ordering is helpful but not strictly required.</p>
</div>
<div class="paragraph">
<p>With these rules present it is still possible to execute <code>taskA</code> without <code>taskB</code> and vice-versa.</p>
</div>
<div class="sect4">
<h5 id="example_adding_a_must_run_after_task_ordering"><a class="anchor" href="#example_adding_a_must_run_after_task_ordering"></a><a class="link" href="#example_adding_a_must_run_after_task_ordering">Example: Adding a 'must run after' task ordering</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task taskX {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskX</span><span class="delimiter">'</span></span>
    }
}
task taskY {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskY</span><span class="delimiter">'</span></span>
    }
}
taskY.mustRunAfter taskX</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q taskY taskX</code></strong></div>
<div class="content">
<pre>&gt; gradle -q taskY taskX
taskX
taskY</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_a_should_run_after_task_ordering"><a class="anchor" href="#example_adding_a_should_run_after_task_ordering"></a><a class="link" href="#example_adding_a_should_run_after_task_ordering">Example: Adding a 'should run after' task ordering</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task taskX {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskX</span><span class="delimiter">'</span></span>
    }
}
task taskY {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskY</span><span class="delimiter">'</span></span>
    }
}
taskY.shouldRunAfter taskX</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q taskY taskX</code></strong></div>
<div class="content">
<pre>&gt; gradle -q taskY taskX
taskX
taskY</pre>
</div>
</div>
<div class="paragraph">
<p>In the examples above, it is still possible to execute <code>taskY</code> without causing <code>taskX</code> to run:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_task_ordering_does_not_imply_task_execution"><a class="anchor" href="#example_task_ordering_does_not_imply_task_execution"></a><a class="link" href="#example_task_ordering_does_not_imply_task_execution">Example: Task ordering does not imply task execution</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q taskY</code></strong></div>
<div class="content">
<pre>&gt; gradle -q taskY
taskY</pre>
</div>
</div>
<div class="paragraph">
<p>To specify a must run after or should run after ordering between 2 tasks, you use the <a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:mustRunAfter(java.lang.Object[])">Task.mustRunAfter(java.lang.Object...)</a> and <a href="../javadoc/org/gradle/api/Task.html#shouldRunAfter-java.lang.Object...-">Task.shouldRunAfter(java.lang.Object...)</a> methods.
These methods accept a task instance, a task name or any other input accepted by <a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:dependsOn(java.lang.Object[])">Task.dependsOn(java.lang.Object...)</a>.</p>
</div>
<div class="paragraph">
<p>Note that <code>B.mustRunAfter(A)</code> or <code>B.shouldRunAfter(A)</code> does not imply any execution dependency between the tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is possible to execute tasks <code>A</code> and <code>B</code> independently. The ordering rule only has an effect when both tasks are scheduled for execution.</p>
</li>
<li>
<p>When run with <code>--continue</code>, it is possible for <code>B</code> to execute in the event that <code>A</code> fails.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As mentioned before, the should run after ordering rule will be ignored if it introduces an ordering cycle:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_should_run_after_task_ordering_is_ignored_if_it_introduces_an_ordering_cycle"><a class="anchor" href="#example_a_should_run_after_task_ordering_is_ignored_if_it_introduces_an_ordering_cycle"></a><a class="link" href="#example_a_should_run_after_task_ordering_is_ignored_if_it_introduces_an_ordering_cycle">Example: A 'should run after' task ordering is ignored if it introduces an ordering cycle</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task taskX {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskX</span><span class="delimiter">'</span></span>
    }
}
task taskY {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskY</span><span class="delimiter">'</span></span>
    }
}
task taskZ {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskZ</span><span class="delimiter">'</span></span>
    }
}
taskX.dependsOn taskY
taskY.dependsOn taskZ
taskZ.shouldRunAfter taskX</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q taskX</code></strong></div>
<div class="content">
<pre>&gt; gradle -q taskX
taskZ
taskY
taskX</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:adding_a_description_to_a_task"><a class="anchor" href="#sec:adding_a_description_to_a_task"></a><a class="link" href="#sec:adding_a_description_to_a_task">Adding a description to a task</a></h4>
<div class="paragraph">
<p>You can add a description to your task. This description is displayed when executing <code>gradle tasks</code>.</p>
</div>
<div class="sect4">
<h5 id="example_adding_a_description_to_a_task"><a class="anchor" href="#example_adding_a_description_to_a_task"></a><a class="link" href="#example_adding_a_description_to_a_task">Example: Adding a description to a task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copy(<span class="key">type</span>: Copy) {
   description <span class="string"><span class="delimiter">'</span><span class="content">Copies the resource directory to the target directory.</span><span class="delimiter">'</span></span>
   from <span class="string"><span class="delimiter">'</span><span class="content">resources</span><span class="delimiter">'</span></span>
   into <span class="string"><span class="delimiter">'</span><span class="content">target</span><span class="delimiter">'</span></span>
   include(<span class="string"><span class="delimiter">'</span><span class="content">**/*.txt</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.xml</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.properties</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:replacing_tasks"><a class="anchor" href="#sec:replacing_tasks"></a><a class="link" href="#sec:replacing_tasks">Replacing tasks</a></h4>
<div class="paragraph">
<p>Sometimes you want to replace a task. For example, if you want to exchange a task added by the Java plugin with a custom task of a different type. You can achieve this with:</p>
</div>
<div class="sect4">
<h5 id="example_overwriting_a_task"><a class="anchor" href="#example_overwriting_a_task"></a><a class="link" href="#example_overwriting_a_task">Example: Overwriting a task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copy(<span class="key">type</span>: Copy)

task copy(<span class="key">overwrite</span>: <span class="predefined-constant">true</span>) {
    doLast {
        println(<span class="string"><span class="delimiter">'</span><span class="content">I am the new one.</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q copy</code></strong></div>
<div class="content">
<pre>&gt; gradle -q copy
I am the new one.</pre>
</div>
</div>
<div class="paragraph">
<p>This will replace a task of type <code>Copy</code> with the task you&#8217;ve defined, because it uses the same name. When you define the new task, you have to set the <code>overwrite</code> property to true. Otherwise Gradle throws an exception, saying that a task with that name already exists.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:skipping_tasks"><a class="anchor" href="#sec:skipping_tasks"></a><a class="link" href="#sec:skipping_tasks">Skipping tasks</a></h4>
<div class="paragraph">
<p>Gradle offers multiple ways to skip the execution of a task.</p>
</div>
<div class="sect4">
<h5 id="sec:using_a_predicate"><a class="anchor" href="#sec:using_a_predicate"></a><a class="link" href="#sec:using_a_predicate">Using a predicate</a></h5>
<div class="paragraph">
<p>You can use the <code>onlyIf()</code> method to attach a predicate to a task. The task&#8217;s actions are only executed if the predicate evaluates to true. You implement the predicate as a closure. The closure is passed the task as a parameter, and should return true if the task should execute and false if the task should be skipped. The predicate is evaluated just before the task is due to be executed.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_skipping_a_task_using_a_predicate"><a class="anchor" href="#example_skipping_a_task_using_a_predicate"></a><a class="link" href="#example_skipping_a_task_using_a_predicate">Example: Skipping a task using a predicate</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task hello {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">hello world</span><span class="delimiter">'</span></span>
    }
}

hello.onlyIf { !project.hasProperty(<span class="string"><span class="delimiter">'</span><span class="content">skipHello</span><span class="delimiter">'</span></span>) }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle hello -PskipHello</code></strong></div>
<div class="content">
<pre>&gt; gradle hello -PskipHello
&gt; Task :hello SKIPPED

BUILD SUCCESSFUL in 0s</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_stopexecutionexception"><a class="anchor" href="#sec:using_stopexecutionexception"></a><a class="link" href="#sec:using_stopexecutionexception">Using StopExecutionException</a></h5>
<div class="paragraph">
<p>If the logic for skipping a task can&#8217;t be expressed with a predicate, you can use the <a href="../javadoc/org/gradle/api/tasks/StopExecutionException.html">StopExecutionException</a>. If this exception is thrown by an action, the further execution of this action as well as the execution of any following action of this task is skipped. The build continues with executing the next task.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_skipping_tasks_with_stopexecutionexception"><a class="anchor" href="#example_skipping_tasks_with_stopexecutionexception"></a><a class="link" href="#example_skipping_tasks_with_stopexecutionexception">Example: Skipping tasks with StopExecutionException</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task compile {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">We are doing the compile.</span><span class="delimiter">'</span></span>
    }
}

compile.doFirst {
    <span class="comment">// Here you would put arbitrary conditions in real life.</span>
    <span class="comment">// But this is used in an integration test so we want defined behavior.</span>
    <span class="keyword">if</span> (<span class="predefined-constant">true</span>) { <span class="keyword">throw</span> <span class="keyword">new</span> StopExecutionException() }
}
task myTask(<span class="key">dependsOn</span>: <span class="string"><span class="delimiter">'</span><span class="content">compile</span><span class="delimiter">'</span></span>) {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">I am not affected</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q myTask</code></strong></div>
<div class="content">
<pre>&gt; gradle -q myTask
I am not affected</pre>
</div>
</div>
<div class="paragraph">
<p>This feature is helpful if you work with tasks provided by Gradle. It allows you to add <em>conditional</em> execution of the built-in actions of such a task.<sup class="footnote">[<a id="_footnoteref_6" class="footnote" href="#_footnotedef_6" title="View footnote.">6</a>]</sup></p>
</div>
</div>
<div class="sect4">
<h5 id="sec:enabling_and_disabling_tasks"><a class="anchor" href="#sec:enabling_and_disabling_tasks"></a><a class="link" href="#sec:enabling_and_disabling_tasks">Enabling and disabling tasks</a></h5>
<div class="paragraph">
<p>Every task has an <code>enabled</code> flag which defaults to <code>true</code>. Setting it to <code>false</code> prevents the execution of any of the task&#8217;s actions. A disabled task will be labelled SKIPPED.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_enabling_and_disabling_tasks"><a class="anchor" href="#example_enabling_and_disabling_tasks"></a><a class="link" href="#example_enabling_and_disabling_tasks">Example: Enabling and disabling tasks</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task disableMe {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">This should not be printed if the task is disabled.</span><span class="delimiter">'</span></span>
    }
}
disableMe.enabled = <span class="predefined-constant">false</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle disableMe</code></strong></div>
<div class="content">
<pre>&gt; gradle disableMe
&gt; Task :disableMe SKIPPED

BUILD SUCCESSFUL in 0s</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:up_to_date_checks"><a class="anchor" href="#sec:up_to_date_checks"></a><a class="link" href="#sec:up_to_date_checks">Up-to-date checks (AKA Incremental Build)</a></h4>
<div class="paragraph">
<p>An important part of any build tool is the ability to avoid doing work that has already been done. Consider the process of compilation. Once your source files have been compiled, there should be no need to recompile them unless something has changed that affects the output, such as the modification of a source file or the removal of an output file. And compilation can take a significant amount of time, so skipping the step when its not needed saves a lot of time.</p>
</div>
<div class="paragraph">
<p>Gradle supports this behavior out of the box through a feature it calls incremental build. You have almost certainly already seen it in action: its active nearly every time the <code>UP-TO-DATE</code> text appears next to the name of a task when you run a build. Task outcomes are described in <a href="#sec:task_outcomes">Task outcomes</a>.</p>
</div>
<div class="paragraph">
<p>How does incremental build work? And what does it take to make use of it in your own tasks? Lets take a look.</p>
</div>
<div class="sect4">
<h5 id="sec:task_inputs_outputs"><a class="anchor" href="#sec:task_inputs_outputs"></a><a class="link" href="#sec:task_inputs_outputs">Task inputs and outputs</a></h5>
<div class="paragraph">
<p>In the most common case, a task takes some inputs and generates some outputs. If we use the compilation example from earlier, we can see that the source files are the inputs and, in the case of Java, the generated class files are the outputs. Other inputs might include things like whether debug information should be included.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/taskInputsOutputs.png" alt="taskInputsOutputs">
</div>
<div class="title">Figure 7. Example task inputs and outputs</div>
</div>
<div class="paragraph">
<p>An important characteristic of an input is that it affects one or more outputs, as you can see from the previous figure. Different bytecode is generated depending on the content of the source files and the minimum version of the Java runtime you want to run the code on. That makes them task inputs. But whether compilation has 500MB or 600MB of maximum memory available, determined by the <code>memoryMaximumSize</code> property, has no impact on what bytecode gets generated. In Gradle terminology, <code>memoryMaximumSize</code> is just an internal task property.</p>
</div>
<div class="paragraph">
<p>As part of incremental build, Gradle tests whether any of the task inputs or outputs have changed since the last build. If they havent, Gradle can consider the task up to date and therefore skip executing its actions. Also note that incremental build wont work unless a task has at least one task output, although tasks usually have at least one input as well.</p>
</div>
<div class="paragraph">
<p>What this means for build authors is simple: you need to tell Gradle which task properties are inputs and which are outputs. If a task property affects the output, be sure to register it as an input, otherwise the task will be considered up to date when its not. Conversely, dont register properties as inputs if they dont affect the output, otherwise the task will potentially execute when it doesnt need to. Also be careful of non-deterministic tasks that may generate different output for exactly the same inputs: these should not be configured for incremental build as the up-to-date checks wont work.</p>
</div>
<div class="paragraph">
<p>Lets now look at how you can register task properties as inputs and outputs.</p>
</div>
<div class="sect5">
<h6 id="sec:task_input_output_annotations"><a class="anchor" href="#sec:task_input_output_annotations"></a><a class="link" href="#sec:task_input_output_annotations">Custom task types</a></h6>
<div class="paragraph">
<p>If youre implementing a custom task as a class, then it takes just two steps to make it work with incremental build:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create typed properties (via getter methods) for each of your task inputs and outputs</p>
</li>
<li>
<p>Add the appropriate annotation to each of those properties</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Annotations must be placed on getters or on Groovy properties. Annotations placed on setters, or on a Java field without a corresponding annotated getter are ignored.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Gradle supports three main categories of inputs and outputs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Simple values</p>
<div class="paragraph">
<p>Things like strings and numbers. More generally, a simple value can have any type that implements <code>Serializable</code>.</p>
</div>
</li>
<li>
<p>Filesystem types</p>
<div class="paragraph">
<p>These consist of the standard <code>File</code> class but also derivatives of Gradles <a href="../javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a> type and anything else that can be passed to either the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a> method - for single file/directory properties - or the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:files(java.lang.Object[])">Project.files(java.lang.Object...)</a>, <a href="../javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-">ProjectLayout.files(java.lang.Object&#8230;&#8203;)</a>, and <a href="../javadoc/org/gradle/api/file/ProjectLayout.html#configurableFiles-java.lang.Object...-">ProjectLayout.configurableFiles(java.lang.Object&#8230;&#8203;)</a> methods.</p>
</div>
</li>
<li>
<p>Nested values</p>
<div class="paragraph">
<p>Custom types that dont conform to the other two categories but have their own properties that are inputs or outputs. In effect, the task inputs or outputs are nested inside these custom types.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>As an example, imagine you have a task that processes templates of varying types, such as FreeMarker, Velocity, Moustache, etc. It takes template source files and combines them with some model data to generate populated versions of the template files.</p>
</div>
<div class="paragraph">
<p>This task will have three inputs and one output:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Template source files</p>
</li>
<li>
<p>Model data</p>
</li>
<li>
<p>Template engine</p>
</li>
<li>
<p>Where the output files are written</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When youre writing a custom task class, its easy to register properties as inputs or outputs via annotations. To demonstrate, here is a skeleton task implementation with some suitable inputs and outputs, along with their annotations:</p>
</div>
<div class="sect6">
<h7 id="example_custom_task_class"><a class="anchor" href="#example_custom_task_class"></a><a class="link" href="#example_custom_task_class">Example: Custom task class</a></h7>
<div class="listingblock">
<div class="title">buildSrc/src/main/java/org/example/ProcessTemplates.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.example</span>;

<span class="keyword">import</span> <span class="include">java.io.File</span>;
<span class="keyword">import</span> <span class="include">java.util.HashMap</span>;
<span class="keyword">import</span> <span class="include">org.gradle.api</span>.*;
<span class="keyword">import</span> <span class="include">org.gradle.api.file</span>.*;
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">ProcessTemplates</span> <span class="directive">extends</span> DefaultTask {
    <span class="directive">private</span> TemplateEngineType templateEngine;
    <span class="directive">private</span> FileCollection sourceFiles;
    <span class="directive">private</span> TemplateData templateData;
    <span class="directive">private</span> <span class="predefined-type">File</span> outputDir;

    <span class="annotation">@Input</span>
    <span class="directive">public</span> TemplateEngineType getTemplateEngine() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.templateEngine;
    }

    <span class="annotation">@InputFiles</span>
    <span class="directive">public</span> FileCollection getSourceFiles() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.sourceFiles;
    }

    <span class="annotation">@Nested</span>
    <span class="directive">public</span> TemplateData getTemplateData() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.templateData;
    }

    <span class="annotation">@OutputDirectory</span>
    <span class="directive">public</span> <span class="predefined-type">File</span> getOutputDir() { <span class="keyword">return</span> <span class="local-variable">this</span>.outputDir; }

    <span class="comment">// + setter methods for the above - assume weve defined them</span>

    <span class="annotation">@TaskAction</span>
    <span class="directive">public</span> <span class="type">void</span> processTemplates() {
        <span class="comment">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">buildSrc/src/main/java/org/example/TemplateData.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.example</span>;

<span class="keyword">import</span> <span class="include">java.util.HashMap</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.Input</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">TemplateData</span> {
    <span class="directive">private</span> <span class="predefined-type">String</span> name;
    <span class="directive">private</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; variables;

    <span class="directive">public</span> TemplateData(<span class="predefined-type">String</span> name, <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; variables) {
        <span class="local-variable">this</span>.name = name;
        <span class="local-variable">this</span>.variables = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;(variables);
    }

    <span class="annotation">@Input</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getName() { <span class="keyword">return</span> <span class="local-variable">this</span>.name; }

    <span class="annotation">@Input</span>
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; getVariables() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.variables;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle processTemplates</code></div>
<div class="content">
<pre>&gt; gradle processTemplates
&gt; Task :processTemplates


BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle processTemplates</code> (run again)</div>
<div class="content">
<pre>&gt; gradle processTemplates
&gt; Task :processTemplates UP-TO-DATE

BUILD SUCCESSFUL in 0s
1 actionable task: 1 up-to-date</pre>
</div>
</div>
<div class="paragraph">
<p>Theres plenty to talk about in this example, so lets work through each of the input and output properties in turn:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>templateEngine</code></p>
<div class="paragraph">
<p>Represents which engine to use when processing the source templates, e.g. FreeMarker, Velocity, etc. You could implement this as a string, but in this case we have gone for a custom enum as it provides greater type information and safety. Since enums implement <code>Serializable</code> automatically, we can treat this as a simple value and use the <code>@Input</code> annotation, just as we would with a <code>String</code> property.</p>
</div>
</li>
<li>
<p><code>sourceFiles</code></p>
<div class="paragraph">
<p>The source templates that the task will be processing. Single files and collections of files need their own special annotations. In this case, were dealing with a collection of input files and so we use the <code>@InputFiles</code> annotation. Youll see more file-oriented annotations in a table later.</p>
</div>
</li>
<li>
<p><code>templateData</code></p>
<div class="paragraph">
<p>For this example, were using a custom class to represent the model data. However, it does not implement <code>Serializable</code>, so we cant use the <code>@Input</code> annotation. Thats not a problem as the properties within <code>TemplateData</code> - a string and a hash map with serializable type parameters - are serializable and can be annotated with <code>@Input</code>. We use <code>@Nested</code> on <code>templateData</code> to let Gradle know that this is a value with nested input properties.</p>
</div>
</li>
<li>
<p><code>outputDir</code></p>
<div class="paragraph">
<p>The directory where the generated files go. As with input files, there are several annotations for output files and directories. A property representing a single directory requires <code>@OutputDirectory</code>. Youll learn about the others soon.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>These annotated properties mean that Gradle will skip the task if none of the source files, template engine, model data or generated files have changed since the previous time Gradle executed the task. This will often save a significant amount of time. You can learn how Gradle detects <a href="#sec:how_does_it_work">changes later</a>.</p>
</div>
<div class="paragraph">
<p>This example is particularly interesting because it works with collections of source files. What happens if only one source file changes? Does the task process all the source files again or just the modified one? That depends on the task implementation. If the latter, then the task itself is incremental, but thats a different feature to the one were discussing here. Gradle does help task implementers with this via its <a href="#incremental_tasks">incremental task inputs</a> feature.</p>
</div>
<div class="paragraph">
<p>Now that you have seen some of the input and output annotations in practice, lets take a look at all the annotations available to you and when you should use them. The table below lists the available annotations and the corresponding property type you can use with each one.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Incremental build property type annotations</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Annotation</th>
<th class="tableblock halign-left valign-top">Expected property type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/Input.html">Input</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Any <code>Serializable</code> type</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A simple input value</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/InputFile.html">InputFile</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>File</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A single input file (not directory)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/InputDirectory.html">InputDirectory</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>File</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A single input directory (not file)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/InputFiles.html">InputFiles</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Iterable&lt;File&gt;</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An iterable of input files and directories</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/Classpath.html">Classpath</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Iterable&lt;File&gt;</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An iterable of input files and directories that represent a Java classpath. This allows the task to ignore irrelevant changes to the property, such as different names for the same files. It is similar to annotating the property <code>@PathSensitive(RELATIVE)</code> but it will ignore the names of JAR files directly added to the classpath, and it will consider changes in the order of the files as a change in the classpath. Gradle will inspect the contents of jar files on the classpath and ignore changes that do not affect the semantics of the classpath (such as file dates and entry order). See also <a href="#sec:task_input_using_classpath_annotations">Using the classpath annotations</a>.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> The <code>@Classpath</code> annotation was introduced in Gradle 3.2. To stay compatible with earlier Gradle versions, classpath properties should also be annotated with <code>@InputFiles</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/CompileClasspath.html">CompileClasspath</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Iterable&lt;File&gt;</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An iterable of input files and directories that represent a Java compile classpath. This allows the task to ignore irrelevant changes that do not affect the API of the classes in classpath. See also <a href="#sec:task_input_using_classpath_annotations">Using the classpath annotations</a>.</p>
</div>
<div class="paragraph">
<p>The following kinds of changes to the classpath will be ignored:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Changes to the path of jar or top level directories.</p>
</li>
<li>
<p>Changes to timestamps and the order of entries in Jars.</p>
</li>
<li>
<p>Changes to resources and Jar manifests, including adding or removing resources.</p>
</li>
<li>
<p>Changes to private class elements, such as private fields, methods and inner classes.</p>
</li>
<li>
<p>Changes to code, such as method bodies, static initializers and field initializers (except for constants).</p>
</li>
<li>
<p>Changes to debug information, for example when a change to a comment affects the line numbers in class debug information.</p>
</li>
<li>
<p>Changes to directories, including directory entries in Jars.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>@CompileClasspath</code> annotation was introduced in Gradle 3.4. To stay compatible with Gradle 3.3 and 3.2, compile classpath properties should also be annotated with <code>@Classpath</code>. For compatibility with Gradle versions before 3.2 the property should also be annotated with <code>@InputFiles</code>.</p>
</div>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/OutputFile.html">OutputFile</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>File</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A single output file (not directory)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/OutputDirectory.html">OutputDirectory</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>File</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A single output directory (not file)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/OutputFiles.html">OutputFiles</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Map&lt;String, File&gt;</code>** or <code>Iterable&lt;File&gt;</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An iterable of output files (no directories). The task outputs can only be <a href="#sec:task_output_caching">cached</a> if a <code>Map</code> is provided.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/OutputDirectories.html">OutputDirectories</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Map&lt;String, File&gt;</code>** or <code>Iterable&lt;File&gt;</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An iterable of output directories (no files). The task outputs can only be <a href="#sec:task_output_caching">cached</a> if a <code>Map</code> is provided.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/Destroys.html">Destroys</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>File</code> or <code>Iterable&lt;File&gt;</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies one or more files that are removed by this task.  Note that a task can define either inputs/outputs or destroyables, but not both.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/LocalState.html">LocalState</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>File</code> or <code>Iterable&lt;File&gt;</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies one or more files that represent the <a href="#sec:storing_incremental_task_state">local state of the task</a>. These files are removed when the task is loaded from cache.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/Nested.html">Nested</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Any custom type</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A custom type that may not implement <code>Serializable</code> but does have at least one field or property marked with one of the annotations in this table. It could even be another <code>@Nested</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/Console.html">Console</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Any type</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Indicates that the property is neither an input nor an output. It simply affects the console output of the task in some way, such as increasing or decreasing the verbosity of the task.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/Internal.html">Internal</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Any type</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Indicates that the property is used internally but is neither an input nor an output.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code id="skip-when-empty">@<a href="../javadoc/org/gradle/api/tasks/SkipWhenEmpty.html">SkipWhenEmpty</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>File</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Used with <code>@InputFiles</code> or <code>@InputDirectory</code> to tell Gradle to skip the task if the corresponding files or directory are empty, along with all other input files declared with this annotation. Tasks that have been skipped due to all of their input files that were declared with this annotation being empty will result in a distinct no source outcome. For example, <code>NO-SOURCE</code> will be emitted in the console output.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/Optional.html">Optional</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Any type</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Used with any of the property type annotations listed in the <a href="../javadoc/org/gradle/api/tasks/Optional.html">Optional</a> API documentation. This annotation disables validation checks on the corresponding property. See <a href="#sec:task_input_output_validation">the section on validation</a> for more details.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>@<a href="../javadoc/org/gradle/api/tasks/PathSensitive.html">PathSensitive</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>File</code>*</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="inputs_path_sensitivity"></a>Used with any input file property to tell Gradle to only consider the given part of the file paths as important. For example, if a property is annotated with <code>@PathSensitive(PathSensitivity.NAME_ONLY)</code>, then moving the files around without changing their contents will not make the task out-of-date.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
*
</td>
<td class="hdlist2">
<p>In fact, <code>File</code> can be any type accepted by <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a> and <code>Iterable&lt;File&gt;</code> can be any type accepted by <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:files(java.lang.Object[])">Project.files(java.lang.Object&#8230;&#8203;)</a>, <a href="../javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-">ProjectLayout.files(java.lang.Object...)</a>, or <a href="../javadoc/org/gradle/api/file/ProjectLayout.html#configurableFiles-java.lang.Object...-">ProjectLayout.configurableFiles(java.lang.Object...)</a>.
This includes instances of <code>Callable</code>, such as closures, allowing for lazy evaluation of the property values.
Be aware that the types <code>FileCollection</code> and <code>FileTree</code> are <code>Iterable&lt;File&gt;</code>s.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
**
</td>
<td class="hdlist2">
<p>Similar to the above, <code>File</code> can be any type accepted by <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a>. The <code>Map</code> itself can be wrapped in <code>Callable</code>s, such as closures.</p>
</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Annotations are inherited from all parent types including implemented interfaces. Property type annotations override any other property type annotation declared in a parent type. This way an <code>@InputFile</code> property can be turned into an <code>@InputDirectory</code> property in a child task type.</p>
</div>
<div class="paragraph">
<p>Annotations on a property declared in a type override similar annotations declared by the superclass and in any implemented interfaces. Superclass annotations take precedence over annotations declared in implemented interfaces.</p>
</div>
<div class="paragraph">
<p>The <a href="../javadoc/org/gradle/api/tasks/Console.html">Console</a> and <a href="../javadoc/org/gradle/api/tasks/Internal.html">Internal</a> annotations in the table are special cases as they dont declare either task inputs or task outputs. So why use them? It&#8217;s so that you can take advantage of the <a href="#java_gradle_plugin">Java Gradle Plugin Development plugin</a> to help you develop and publish your own plugins. This plugin checks whether any properties of your custom task classes lack an incremental build annotation. This protects you from forgetting to add an appropriate annotation during development.</p>
</div>
</div>
<div class="sect6">
<h7 id="sec:task_input_using_classpath_annotations"><a class="anchor" href="#sec:task_input_using_classpath_annotations"></a><a class="link" href="#sec:task_input_using_classpath_annotations">Using the classpath annotations</a></h7>
<div class="paragraph">
<p>Besides <code>@InputFiles</code>, for JVM-related tasks Gradle understands the concept of classpath inputs. Both runtime and compile classpaths are treated differently when Gradle is looking for changes.</p>
</div>
<div class="paragraph">
<p>As opposed to input properties annotated with <code>@<a href="../javadoc/org/gradle/api/tasks/InputFiles.html">InputFiles</a></code>, for classpath properties the order of the entries in the file collection matter.
On the other hand, the names and paths of the directories and jar files on the classpath itself are ignored.
Timestamps and the order of class files and resources inside jar files on a classpath are ignored, too, thus recreating a jar file with different file dates will not make the task out of date.</p>
</div>
<div class="paragraph">
<p>Runtime classpaths are marked with <code>@<a href="../javadoc/org/gradle/api/tasks/Classpath.html">Classpath</a></code>, and they offer further customization via <a href="#sec:configure_input_normalization">classpath normalization</a>.</p>
</div>
<div class="paragraph">
<p>Input properties annotated with <code>@<a href="../javadoc/org/gradle/api/tasks/CompileClasspath.html">CompileClasspath</a></code> are considered Java compile classpaths.
Additionally to the aforementioned general classpath rules, compile classpaths ignore changes to everything but class files. Gradle uses the same class analysis described in <a href="#sec:java_compile_avoidance">Java compile avoidance</a> to further filter changes that don&#8217;t affect the class' ABIs.
This means that changes which only touch the implementation of classes do not make the task out of date.</p>
</div>
</div>
<div class="sect6">
<h7 id="sec:task_input_nested_inputs"><a class="anchor" href="#sec:task_input_nested_inputs"></a><a class="link" href="#sec:task_input_nested_inputs">Nested inputs</a></h7>
<div class="paragraph">
<p>When analyzing <code>@<a href="../javadoc/org/gradle/api/tasks/Nested.html">Nested</a></code> task properties for declared input and output sub-properties Gradle uses the type of the actual value.
Hence it can discover all sub-properties declared by a runtime sub-type.</p>
</div>
<div class="paragraph">
<p>When adding <code>@<a href="../javadoc/org/gradle/api/tasks/Nested.html">Nested</a></code> to a <code>@<a href="../javadoc/org/gradle/api/provider/Provider.html">Provider</a></code>, the value of the <code>Provider</code> is treated as a nested input.</p>
</div>
<div class="paragraph">
<p>When adding <code>@<a href="../javadoc/org/gradle/api/tasks/Nested.html">Nested</a></code> to an iterable, each element is treated as a separate nested input.
Each nested input in the iterable is assigned a name, which by default is the dollar sign followed by the index in the iterable, e.g. <code>$2</code>.
If an element of the iterable implements <code><a href="../javadoc/org/gradle/api/Named.html">Named</a></code>, then the name is used as property name.
The ordering of the elements in the iterable is crucial for for reliable up-to-date checks and caching if not all of the elements implement <code><a href="../javadoc/org/gradle/api/Named.html">Named</a></code>.
Multiple elements which have the same name are not allowed.</p>
</div>
<div class="paragraph">
<p>When adding <code>@<a href="../javadoc/org/gradle/api/tasks/Nested.html">Nested</a></code> to a map, then for each value a nested input is added, using the key as name.</p>
</div>
<div class="paragraph">
<p>The type and classpath of nested inputs is tracked, too.
This ensures that changes to the implementation of a nested input causes the build to be out of date.
By this it is also possible to add user provided code as an input, e.g. by annotating an <code>@<a href="../javadoc/org/gradle/api/Action.html">Action</a></code> property with <code>@<a href="../javadoc/org/gradle/api/tasks/Nested.html">Nested</a></code>.
Note that any inputs to such actions should be tracked, either by annotated properties on the action or by manually registering them with the task.</p>
</div>
<div class="paragraph">
<p>Using nested inputs allows richer modeling and extensibility for tasks, as e.g. shown by <a href="../dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:jvmArgumentProviders">Test.getJvmArgumentProviders()</a>.</p>
</div>
<div class="paragraph">
<p>This allows us to <a href="https://github.com/gradle/gradle/blob/7b047c7cbb4932743243a76123f5347be6d07856/subprojects/jacoco/src/main/java/org/gradle/testing/jacoco/plugins/JacocoPluginExtension.java#L138-L157">model the JaCoCo Java agent</a>, thus declaring the necessary JVM arguments and providing the inputs and outputs to Gradle:</p>
</div>
<div class="listingblock">
<div class="title">JacocoAgent.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">JacocoAgent</span> <span class="directive">implements</span> CommandLineArgumentProvider {
    <span class="directive">private</span> <span class="directive">final</span> JacocoTaskExtension jacoco;

    <span class="directive">public</span> JacocoAgent(JacocoTaskExtension jacoco) {
        <span class="local-variable">this</span>.jacoco = jacoco;
    }

    <span class="annotation">@Nested</span>
    <span class="annotation">@Optional</span>
    <span class="directive">public</span> JacocoTaskExtension getJacoco() {
        <span class="keyword">return</span> jacoco.isEnabled() ? jacoco : <span class="predefined-constant">null</span>;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Iterable</span>&lt;<span class="predefined-type">String</span>&gt; asArguments() {
        <span class="keyword">return</span> jacoco.isEnabled() ? ImmutableList.of(jacoco.getAsJvmArg()) : <span class="predefined-type">Collections</span>.&lt;<span class="predefined-type">String</span>&gt;emptyList();
    }
}

test.getJvmArgumentProviders().add(<span class="keyword">new</span> JacocoAgent(extension));</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this to work, <code><a href="../dsl/org.gradle.testing.jacoco.plugins.JacocoTaskExtension.html">JacocoTaskExtension</a></code> needs to have the correct input and output annotations.</p>
</div>
<div class="paragraph">
<p>The approach works for Test JVM arguments, since <code><a href="../dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:jvmArgumentProviders">Test.getJvmArgumentProviders()</a></code> is an <code>Iterable</code> annotated with <code>@<a href="../javadoc/org/gradle/api/tasks/Nested.html">Nested</a></code>.</p>
</div>
<div class="paragraph">
<p>There are other task types where this kind of nested inputs are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../dsl/org.gradle.api.tasks.JavaExec.html#org.gradle.api.tasks.JavaExec:argumentProviders">JavaExec.getArgumentProviders()</a> - model e.g. custom tools</p>
</li>
<li>
<p><a href="../dsl/org.gradle.api.tasks.JavaExec.html#org.gradle.api.tasks.JavaExec:jvmArgumentProviders">JavaExec.getJvmArgumentProviders()</a> - used for Jacoco Java agent</p>
</li>
<li>
<p><a href="../dsl/org.gradle.api.tasks.compile.CompileOptions.html#org.gradle.api.tasks.compile.CompileOptions:compilerArgumentProviders">CompileOptions.getCompilerArgumentProviders()</a> - model e.g annotation processors</p>
</li>
<li>
<p><a href="../dsl/org.gradle.api.tasks.Exec.html#org.gradle.api.tasks.Exec:argumentProviders">Exec.getArgumentProviders()</a> - model e.g custom tools</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the same way, this kind of modelling is available to custom tasks.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:task_input_output_runtime_api"><a class="anchor" href="#sec:task_input_output_runtime_api"></a><a class="link" href="#sec:task_input_output_runtime_api">Runtime API</a></h6>
<div class="paragraph">
<p>Custom task classes are an easy way to bring your own build logic into the arena of incremental build, but you dont always have that option. That&#8217;s why Gradle also provides an alternative API that can be used with any tasks, which we look at next.</p>
</div>
<div class="paragraph">
<p>When you dont have access to the source for a custom task class, there is no way to add any of the annotations we covered in the previous section. Fortunately, Gradle provides a runtime API for scenarios just like that. It can also be used for ad-hoc tasks, as you&#8217;ll see next.</p>
</div>
<div class="sect6">
<h7 id="sec:runtime_api_for_adhoc"><a class="anchor" href="#sec:runtime_api_for_adhoc"></a><a class="link" href="#sec:runtime_api_for_adhoc">Using it for ad-hoc tasks</a></h7>
<div class="paragraph">
<p>This runtime API is provided through a couple of aptly named properties that are available on every Gradle task:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:inputs">Task.getInputs()</a> of type <a href="../javadoc/org/gradle/api/tasks/TaskInputs.html">TaskInputs</a></p>
</li>
<li>
<p><a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:outputs">Task.getOutputs()</a> of type <a href="../javadoc/org/gradle/api/tasks/TaskOutputs.html">TaskOutputs</a></p>
</li>
<li>
<p><a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:destroyables">Task.getDestroyables()</a> of type <a href="../javadoc/org/gradle/api/tasks/TaskDestroyables.html">TaskDestroyables</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These objects have methods that allow you to specify files, directories and values which constitute the tasks inputs and outputs. In fact, the runtime API has almost feature parity with the annotations. All it lacks is validation of whether declared files are actually files and declared directories are directories. Nor will it create output directories if they don&#8217;t exist. But that&#8217;s it.</p>
</div>
<div class="paragraph">
<p>Lets take the template processing example from before and see how it would look as an ad-hoc task that uses the runtime API:</p>
</div>
</div>
<div class="sect6">
<h7 id="example_ad_hoc_task"><a class="anchor" href="#example_ad_hoc_task"></a><a class="link" href="#example_ad_hoc_task">Example: Ad-hoc task</a></h7>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task processTemplatesAdHoc {
    inputs.property(<span class="string"><span class="delimiter">&quot;</span><span class="content">engine</span><span class="delimiter">&quot;</span></span>, TemplateEngineType.FREEMARKER)
    inputs.files(fileTree(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/templates</span><span class="delimiter">&quot;</span></span>))
    inputs.property(<span class="string"><span class="delimiter">&quot;</span><span class="content">templateData.name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">docs</span><span class="delimiter">&quot;</span></span>)
    inputs.property(<span class="string"><span class="delimiter">&quot;</span><span class="content">templateData.variables</span><span class="delimiter">&quot;</span></span>, [<span class="key">year</span>: <span class="integer">2013</span>])
    outputs.dir(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/genOutput2</span><span class="delimiter">&quot;</span></span>)

    doLast {
        <span class="comment">// Process the templates here</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle processTemplatesAdHoc</code></strong></div>
<div class="content">
<pre>&gt; gradle processTemplatesAdHoc
&gt; Task :processTemplatesAdHoc

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>As before, theres much to talk about. To begin with, you should really write a custom task class for this as its a non-trivial implementation that has several configuration options. In this case, there are no task properties to store the root source folder, the location of the output directory or any of the other settings. Thats deliberate to highlight the fact that the runtime API doesnt require the task to have any state. In terms of incremental build, the above ad-hoc task will behave the same as the custom task class.</p>
</div>
<div class="paragraph">
<p>All the input and output definitions are done through the methods on <code>inputs</code> and <code>outputs</code>, such as <code>property()</code>, <code>files()</code>, and <code>dir()</code>. Gradle performs up-to-date checks on the argument values to determine whether the task needs to run again or not. Each method corresponds to one of the incremental build annotations, for example <code>inputs.property()</code> maps to <code>@Input</code> and <code>outputs.dir()</code> maps to <code>@OutputDirectory</code>. The only difference is that the <code>file()</code>, <code>files()</code>, <code>dir()</code> and <code>dirs()</code> methods dont validate the type of file object at the given path (file or directory), unlike the annotations.</p>
</div>
<div class="paragraph">
<p>The files that a task removes can be specified through <code>destroyables.register()</code>.</p>
</div>
</div>
<div class="sect6">
<h7 id="example_ad_hoc_task_declaring_a_destroyable"><a class="anchor" href="#example_ad_hoc_task_declaring_a_destroyable"></a><a class="link" href="#example_ad_hoc_task_declaring_a_destroyable">Example: Ad-hoc task declaring a destroyable</a></h7>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task removeTempDir {
    destroyables.register(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>projectDir</span><span class="content">/tmpDir</span><span class="delimiter">&quot;</span></span>)
    doLast {
        delete(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>projectDir</span><span class="content">/tmpDir</span><span class="delimiter">&quot;</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>One notable difference between the runtime API and the annotations is the lack of a method that corresponds directly to <code>@Nested</code>. Thats why the example uses two <code>property()</code> declarations for the template data, one for each <code>TemplateData</code> property. You should utilize the same technique when using the runtime API with nested values.  Any given task can either declare destroyables or inputs/outputs, but cannot declare both.</p>
</div>
</div>
<div class="sect6">
<h7 id="sec:runtime_api_for_custom_tasks"><a class="anchor" href="#sec:runtime_api_for_custom_tasks"></a><a class="link" href="#sec:runtime_api_for_custom_tasks">Using it for custom task types</a></h7>
<div class="paragraph">
<p>Another type of example involves adding input and output definitions to instances of a custom task class that lacks the requisite annotations. For example, imagine that the <code>ProcessTemplates</code> task is provided by a plugin and that its missing the incremental build annotations. In order to make up for that deficiency, you can use the runtime API:</p>
</div>
</div>
<div class="sect6">
<h7 id="example_using_runtime_api_with_custom_task_type"><a class="anchor" href="#example_using_runtime_api_with_custom_task_type"></a><a class="link" href="#example_using_runtime_api_with_custom_task_type">Example: Using runtime API with custom task type</a></h7>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task processTemplatesRuntime(<span class="key">type</span>: ProcessTemplatesNoAnnotations) {
    templateEngine = TemplateEngineType.FREEMARKER
    sourceFiles = fileTree(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/templates</span><span class="delimiter">&quot;</span></span>)
    templateData = <span class="keyword">new</span> TemplateData(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>, [<span class="key">year</span>: <span class="integer">2014</span>])
    outputDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/genOutput3</span><span class="delimiter">&quot;</span></span>)

    inputs.property(<span class="string"><span class="delimiter">&quot;</span><span class="content">engine</span><span class="delimiter">&quot;</span></span>,templateEngine)
    inputs.files(sourceFiles)
    inputs.property(<span class="string"><span class="delimiter">&quot;</span><span class="content">templateData.name</span><span class="delimiter">&quot;</span></span>, templateData.name)
    inputs.property(<span class="string"><span class="delimiter">&quot;</span><span class="content">templateData.variables</span><span class="delimiter">&quot;</span></span>, templateData.variables)
    outputs.dir(outputDir)
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle processTemplatesRuntime</code></div>
<div class="content">
<pre>&gt; gradle processTemplatesRuntime
&gt; Task :processTemplatesRuntime


BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle processTemplatesRuntime</code> (run again)</div>
<div class="content">
<pre>&gt; gradle processTemplatesRuntime
&gt; Task :processTemplatesRuntime UP-TO-DATE


BUILD SUCCESSFUL in 0s
1 actionable task: 1 up-to-date</pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, we can both configure the tasks properties and use those properties as arguments to the incremental build runtime API. Using the runtime API like this is a little like using <code>doLast()</code> and <code>doFirst()</code> to attach extra actions to a task, except in this case were attaching information about inputs and outputs. Note that if the task type is already using the incremental build annotations, the runtime API will add inputs and outputs rather than replace them.</p>
</div>
</div>
<div class="sect6">
<h7 id="sec:runtime_api_configuration"><a class="anchor" href="#sec:runtime_api_configuration"></a><a class="link" href="#sec:runtime_api_configuration">Fine-grained configuration</a></h7>
<div class="paragraph">
<p>The runtime API methods only allow you to declare your inputs and outputs in themselves. However, the file-oriented ones return a builder - of type <a href="../javadoc/org/gradle/api/tasks/TaskInputFilePropertyBuilder.html">TaskInputFilePropertyBuilder</a> - that lets you provide additional information about those inputs and outputs.</p>
</div>
<div class="paragraph">
<p>You can learn about all the options provided by the builder in its API documentation, but well show you a simple example here to give you an idea of what you can do.</p>
</div>
<div class="paragraph">
<p>Lets say we dont want to run the <code>processTemplates</code> task if there are no source files, regardless of whether its a clean build or not. After all, if there are no source files, theres nothing for the task to do. The builder allows us to configure this like so:</p>
</div>
</div>
<div class="sect6">
<h7 id="example_using_skipwhenempty_via_the_runtime_api"><a class="anchor" href="#example_using_skipwhenempty_via_the_runtime_api"></a><a class="link" href="#example_using_skipwhenempty_via_the_runtime_api">Example: Using skipWhenEmpty() via the runtime API</a></h7>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task processTemplatesRuntimeConf(<span class="key">type</span>: ProcessTemplatesNoAnnotations) {
    <span class="comment">// ...</span>
    sourceFiles = fileTree(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/templates</span><span class="delimiter">&quot;</span></span>) {
        include <span class="string"><span class="delimiter">&quot;</span><span class="content">**/*.fm</span><span class="delimiter">&quot;</span></span>
    }

    inputs.files(sourceFiles).skipWhenEmpty()
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle clean processTemplatesRuntimeConf</code></strong></div>
<div class="content">
<pre>&gt; gradle clean processTemplatesRuntimeConf
&gt; Task :processTemplatesRuntimeConf NO-SOURCE


BUILD SUCCESSFUL in 0s
1 actionable task: 1 up-to-date</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>TaskInputs.files()</code> method returns a builder that has a <code>skipWhenEmpty()</code> method. Invoking this method is equivalent to annotating to the property with <a href="#skip-when-empty"><code>@SkipWhenEmpty</code></a>.</p>
</div>
<div class="paragraph">
<p>Prior to Gradle 3.0, you had to use the <code>TaskInputs.source()</code> and <code>TaskInputs.sourceDir()</code> methods to get the same behavior as with <code>skipWhenEmpty()</code>. These methods are now deprecated and should not be used with Gradle 3.0 and above.</p>
</div>
<div class="paragraph">
<p>Now that you have seen both the annotations and the runtime API, you may be wondering which API you should be using. Our recommendation is to use the annotations wherever possible, and its sometimes worth creating a custom task class just so that you can make use of them. The runtime API is more for situations in which you cant use the annotations.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:task_input_output_side_effects"><a class="anchor" href="#sec:task_input_output_side_effects"></a><a class="link" href="#sec:task_input_output_side_effects">Important beneficial side effects</a></h6>
<div class="paragraph">
<p>Once you declare a tasks formal inputs and outputs, Gradle can then infer things about those properties. For example, if an input of one task is set to the output of another, that means the first task depends on the second, right? Gradle knows this and can act upon it.</p>
</div>
<div class="paragraph">
<p>Well look at this feature next and also some other features that come from Gradle knowing things about inputs and outputs.</p>
</div>
<div class="sect6">
<h7 id="sec:inferred_task_dependencies"><a class="anchor" href="#sec:inferred_task_dependencies"></a><a class="link" href="#sec:inferred_task_dependencies">Inferred task dependencies</a></h7>
<div class="paragraph">
<p>Consider an archive task that packages the output of the <code>processTemplates</code> task. A build author will see that the archive task obviously requires <code>processTemplates</code> to run first and so may add an explicit <code>dependsOn</code>. However, if you define the archive task like so:</p>
</div>
</div>
<div class="sect6">
<h7 id="example_inferred_task_dependency_via_task_outputs"><a class="anchor" href="#example_inferred_task_dependency_via_task_outputs"></a><a class="link" href="#example_inferred_task_dependency_via_task_outputs">Example: Inferred task dependency via task outputs</a></h7>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task packageFiles(<span class="key">type</span>: Zip) {
    from processTemplates.outputs
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle clean packageFiles</code></strong></div>
<div class="content">
<pre>&gt; gradle clean packageFiles
&gt; Task :processTemplates
&gt; Task :packageFiles


BUILD SUCCESSFUL in 0s
3 actionable tasks: 2 executed, 1 up-to-date</pre>
</div>
</div>
<div class="paragraph">
<p>Gradle will automatically make <code>packageFiles</code> depend on <code>processTemplates</code>. It can do this because its aware that one of the inputs of packageFiles requires the output of the processTemplates task. We call this an inferred task dependency.</p>
</div>
<div class="paragraph">
<p>The above example can also be written as</p>
</div>
</div>
<div class="sect6">
<h7 id="example_inferred_task_dependency_via_a_task_argument"><a class="anchor" href="#example_inferred_task_dependency_via_a_task_argument"></a><a class="link" href="#example_inferred_task_dependency_via_a_task_argument">Example: Inferred task dependency via a task argument</a></h7>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task packageFiles2(<span class="key">type</span>: Zip) {
    from processTemplates
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle clean packageFiles2</code></strong></div>
<div class="content">
<pre>&gt; gradle clean packageFiles2
&gt; Task :processTemplates
&gt; Task :packageFiles2


BUILD SUCCESSFUL in 0s
3 actionable tasks: 2 executed, 1 up-to-date</pre>
</div>
</div>
<div class="paragraph">
<p>This is because the <code>from()</code> method can accept a task object as an argument. Behind the scenes, <code>from()</code> uses the <code>project.files()</code> method to wrap the argument, which in turn exposes the tasks formal outputs as a file collection. In other words, its a special case!</p>
</div>
</div>
<div class="sect6">
<h7 id="sec:task_input_output_validation"><a class="anchor" href="#sec:task_input_output_validation"></a><a class="link" href="#sec:task_input_output_validation">Input and output validation</a></h7>
<div class="paragraph">
<p>The incremental build annotations provide enough information for Gradle to perform some basic validation on the annotated properties. In particular, it does the following for each property before the task executes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@InputFile</code> - verifies that the property has a value and that the path corresponds to a file (not a directory) that exists.</p>
</li>
<li>
<p><code>@InputDirectory</code> - same as for <code>@InputFile</code>, except the path must correspond to a directory.</p>
</li>
<li>
<p><code>@OutputDirectory</code> - verifies that the path doesnt match a file and also creates the directory if it doesnt already exist.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Such validation improves the robustness of the build, allowing you to identify issues related to inputs and outputs quickly.</p>
</div>
<div class="paragraph">
<p>You will occasionally want to disable some of this validation, specifically when an input file may validly not exist. Thats why Gradle provides the <code>@Optional</code> annotation: you use it to tell Gradle that a particular input is optional and therefore the build should not fail if the corresponding file or directory doesnt exist.</p>
</div>
</div>
<div class="sect6">
<h7 id="sec:task_input_output_continuous_build"><a class="anchor" href="#sec:task_input_output_continuous_build"></a><a class="link" href="#sec:task_input_output_continuous_build">Continuous build</a></h7>
<div class="paragraph">
<p>Another benefit of defining task inputs and outputs is continuous build. Since Gradle knows what files a task depends on, it can automatically run a task again if any of its inputs change. By activating continuous build when you run Gradle - through the <code>--continuous</code> or <code>-t</code> options - you will put Gradle into a state in which it continually checks for changes and executes the requested tasks when it encounters such changes.</p>
</div>
<div class="paragraph">
<p>You can find out more about this feature in <a href="#sec:continuous_build">Continuous build</a>.</p>
</div>
</div>
<div class="sect6">
<h7 id="sec:task_input_output_parallelism"><a class="anchor" href="#sec:task_input_output_parallelism"></a><a class="link" href="#sec:task_input_output_parallelism">Task parallelism</a></h7>
<div class="paragraph">
<p>One last benefit of defining task inputs and outputs is that Gradle can use this information to make decisions about how to run tasks when the "--parallel" option is used.  For instance, Gradle will inspect the outputs of tasks when selecting the  next task to run and will avoid concurrent execution of tasks that write to the same output directory.  Similarly, Gradle will use the information about what files a task destroys (e.g. specified by the <code>Destroys</code> annotation) and avoid running a task that removes a set of files while another task is running that consumes or creates those same files (and vice versa).  It can also determine that a task that creates a set of files has already run and that a task that consumes those files has yet to run and will avoid running a task that removes those files in between.  By providing task input and output information in this way, Gradle can infer creation/consumption/destruction relationships between tasks and can ensure that task execution does not violate those relationships.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:how_does_it_work"><a class="anchor" href="#sec:how_does_it_work"></a><a class="link" href="#sec:how_does_it_work">How does it work?</a></h5>
<div class="paragraph">
<p>Before a task is executed for the first time, Gradle takes a snapshot of the inputs. This snapshot contains the paths of input files and a hash of the contents of each file. Gradle then executes the task. If the task completes successfully, Gradle takes a snapshot of the outputs. This snapshot contains the set of output files and a hash of the contents of each file. Gradle persists both snapshots for the next time the task is executed.</p>
</div>
<div class="paragraph">
<p>Each time after that, before the task is executed, Gradle takes a new snapshot of the inputs and outputs. If the new snapshots are the same as the previous snapshots, Gradle assumes that the outputs are up to date and skips the task. If they are not the same, Gradle executes the task. Gradle persists both snapshots for the next time the task is executed.</p>
</div>
<div class="paragraph">
<p>Gradle also considers the <em>code</em> of the task as part of the inputs to the task. When a task, its actions, or its dependencies change between executions, Gradle considers the task as out-of-date.</p>
</div>
<div class="paragraph">
<p>Gradle understands if a file property (e.g. one holding a Java classpath) is order-sensitive. When comparing the snapshot of such a property, even a change in the order of the files will result in the task becoming out-of-date.</p>
</div>
<div class="paragraph">
<p>Note that if a task has an output directory specified, any files added to that directory since the last time it was executed are ignored and will NOT cause the task to be out of date. This is so unrelated tasks may share an output directory without interfering with each other. If this is not the behaviour you want for some reason, consider using <a href="../javadoc/org/gradle/api/tasks/TaskOutputs.html#upToDateWhen-groovy.lang.Closure-">TaskOutputs.upToDateWhen(groovy.lang.Closure)</a></p>
</div>
<div class="paragraph">
<p>The inputs for the task are also used to calculate the <a href="#build_cache">build cache</a> key used to load task outputs when enabled. For more details see <a href="#sec:task_output_caching">Task output caching</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:advanced_inc_build"><a class="anchor" href="#sec:advanced_inc_build"></a><a class="link" href="#sec:advanced_inc_build">Advanced techniques</a></h5>
<div class="paragraph">
<p>Everything youve seen so far in this section will cover most of the use cases youll encounter, but there are some scenarios that need special treatment. Well present a few of those next with the appropriate solutions.</p>
</div>
<div class="sect5">
<h6 id="sec:add_cached_input_output_methods"><a class="anchor" href="#sec:add_cached_input_output_methods"></a><a class="link" href="#sec:add_cached_input_output_methods">Adding your own cached input/output methods</a></h6>
<div class="paragraph">
<p>Have you ever wondered how the <code>from()</code> method of the <code>Copy</code> task works? Its not annotated with <code>@InputFiles</code> and yet any files passed to it are treated as formal inputs of the task. Whats happening?</p>
</div>
<div class="paragraph">
<p>The implementation is quite simple and you can use the same technique for your own tasks to improve their APIs. Write your methods so that they add files directly to the appropriate annotated property. As an example, heres how to add a <code>sources()</code> method to the custom <code>ProcessTemplates</code> class we introduced earlier:</p>
</div>
<div class="sect6">
<h7 id="example_declaring_a_method_to_add_task_inputs"><a class="anchor" href="#example_declaring_a_method_to_add_task_inputs"></a><a class="link" href="#example_declaring_a_method_to_add_task_inputs">Example: Declaring a method to add task inputs</a></h7>
<div class="listingblock">
<div class="title">ProcessTemplates.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ProcessTemplates</span> <span class="directive">extends</span> DefaultTask {
    <span class="comment">// ...</span>
    <span class="directive">private</span> FileCollection sourceFiles = getProject().getLayout().files();

    <span class="annotation">@SkipWhenEmpty</span>
    <span class="annotation">@InputFiles</span>
    <span class="annotation">@PathSensitive</span>(PathSensitivity.NONE)
    <span class="directive">public</span> FileCollection getSourceFiles() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.sourceFiles;
    }

    <span class="directive">public</span> <span class="type">void</span> sources(FileCollection sourceFiles) {
        <span class="local-variable">this</span>.sourceFiles = <span class="local-variable">this</span>.sourceFiles.plus(sourceFiles);
    }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task processTemplates(<span class="key">type</span>: ProcessTemplates) {
    templateEngine = TemplateEngineType.FREEMARKER
    templateData = <span class="keyword">new</span> TemplateData(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>, [<span class="key">year</span>: <span class="integer">2012</span>])
    outputDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/genOutput</span><span class="delimiter">&quot;</span></span>)

    sources fileTree(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/templates</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle processTemplates</code></div>
<div class="content">
<pre>&gt; gradle processTemplates
&gt; Task :processTemplates


BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>In other words, as long as you add values and files to formal task inputs and outputs during the configuration phase, they will be treated as such regardless from where in the build you add them.</p>
</div>
<div class="paragraph">
<p>If we want to support tasks as arguments as well and treat their outputs as the inputs, we can use the <code>project.layout.files()</code> method like so:</p>
</div>
</div>
<div class="sect6">
<h7 id="example_declaring_a_method_to_add_a_task_as_an_input"><a class="anchor" href="#example_declaring_a_method_to_add_a_task_as_an_input"></a><a class="link" href="#example_declaring_a_method_to_add_a_task_as_an_input">Example: Declaring a method to add a task as an input</a></h7>
<div class="listingblock">
<div class="title">ProcessTemplates.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="comment">// ...</span>
    <span class="directive">public</span> <span class="type">void</span> sources(Task inputTask) {
        <span class="local-variable">this</span>.sourceFiles = <span class="local-variable">this</span>.sourceFiles.plus(getProject().getLayout().files(inputTask));
    }
    <span class="comment">// ...</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyTemplates(<span class="key">type</span>: Copy) {
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/tmp</span><span class="delimiter">&quot;</span></span>
    from <span class="string"><span class="delimiter">&quot;</span><span class="content">src/templates</span><span class="delimiter">&quot;</span></span>
}

task processTemplates2(<span class="key">type</span>: ProcessTemplates) {
    <span class="comment">// ...</span>
    sources copyTemplates
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle processTemplates2</code></div>
<div class="content">
<pre>&gt; gradle processTemplates2
&gt; Task :copyTemplates
&gt; Task :processTemplates2


BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>This technique can make your custom task easier to use and result in cleaner build files.
As an added benefit, our use of <code>getProject().getLayout().files()</code> means that our custom method can set up an inferred task dependency.</p>
</div>
<div class="paragraph">
<p>One last thing to note: if you are developing a task that takes collections of source files as inputs, like this example, consider using the built-in <a href="../dsl/org.gradle.api.tasks.SourceTask.html">SourceTask</a>. It will save you having to implement some of the plumbing that we put into <code>ProcessTemplates</code>.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:link_output_dir_to_input_files"><a class="anchor" href="#sec:link_output_dir_to_input_files"></a><a class="link" href="#sec:link_output_dir_to_input_files">Linking an <code>@OutputDirectory</code> to an <code>@InputFiles</code></a></h6>
<div class="paragraph">
<p>When you want to link the output of one task to the input of another, the types often match and a simple property assignment will provide that link. For example, a <code>File</code> output property can be assigned to a <code>File</code> input.</p>
</div>
<div class="paragraph">
<p>Unfortunately, this approach breaks down when you want the files in a tasks <code>@OutputDirectory</code> (of type <code>File</code>) to become the source for another tasks <code>@InputFiles</code> property (of type <code>FileCollection</code>). Since the two have different types, property assignment wont work.</p>
</div>
<div class="paragraph">
<p>As an example, imagine you want to use the output of a Java compilation task - via the <code>destinationDir</code> property - as the input of a custom task that instruments a set of files containing Java bytecode. This custom task, which well call <code>Instrument</code>, has a <code>classFiles</code> property annotated with <code>@InputFiles</code>. You might initially try to configure the task like so:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_failed_attempt_at_setting_up_an_inferred_task_dependency"><a class="anchor" href="#example_failed_attempt_at_setting_up_an_inferred_task_dependency"></a><a class="link" href="#example_failed_attempt_at_setting_up_an_inferred_task_dependency">Example: Failed attempt at setting up an inferred task dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">java</span><span class="delimiter">&quot;</span></span>

task badInstrumentClasses(<span class="key">type</span>: <span class="predefined-type">Instrument</span>) {
    classFiles = fileTree(compileJava.destinationDir)
    destinationDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/instrumented</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle clean badInstrumentClasses</code></strong></div>
<div class="content">
<pre>&gt; gradle clean badInstrumentClasses
&gt; Task :clean UP-TO-DATE
&gt; Task :badInstrumentClasses NO-SOURCE


BUILD SUCCESSFUL in 0s
1 actionable task: 1 up-to-date</pre>
</div>
</div>
<div class="paragraph">
<p>Theres nothing obviously wrong with this code, but you can see from the console output that the compilation task is missing. In this case you would need to add an explicit task dependency between <code>instrumentClasses</code> and <code>compileJava</code> via <code>dependsOn</code>. The use of <code>fileTree()</code> means that Gradle cant infer the task dependency itself.</p>
</div>
<div class="paragraph">
<p>One solution is to use the <code>TaskOutputs.files</code> property, as demonstrated by the following example:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_setting_up_an_inferred_task_dependency_between_output_dir_and_input_files"><a class="anchor" href="#example_setting_up_an_inferred_task_dependency_between_output_dir_and_input_files"></a><a class="link" href="#example_setting_up_an_inferred_task_dependency_between_output_dir_and_input_files">Example: Setting up an inferred task dependency between output dir and input files</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task instrumentClasses(<span class="key">type</span>: <span class="predefined-type">Instrument</span>) {
    classFiles = compileJava.outputs.files
    destinationDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/instrumented</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle clean instrumentClasses</code></strong></div>
<div class="content">
<pre>&gt; gradle clean instrumentClasses
&gt; Task :clean UP-TO-DATE
&gt; Task :compileJava
&gt; Task :instrumentClasses


BUILD SUCCESSFUL in 0s
3 actionable tasks: 2 executed, 1 up-to-date</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can get Gradle to access the appropriate property itself by using one of <code>project.files()</code>, <code>project.layout.files()</code> or <code>project.layout.configurableFiles()</code> in place of <code>project.fileTree()</code>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_setting_up_an_inferred_task_dependency_with_filesfor"><a class="anchor" href="#example_setting_up_an_inferred_task_dependency_with_filesfor"></a><a class="link" href="#example_setting_up_an_inferred_task_dependency_with_filesfor">Example: Setting up an inferred task dependency with filesFor()</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task instrumentClasses2(<span class="key">type</span>: <span class="predefined-type">Instrument</span>) {
    classFiles = layout.files(compileJava)
    destinationDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/instrumented</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle clean instrumentClasses2</code></strong></div>
<div class="content">
<pre>&gt; gradle clean instrumentClasses2
&gt; Task :clean UP-TO-DATE
&gt; Task :compileJava
&gt; Task :instrumentClasses2


BUILD SUCCESSFUL in 0s
3 actionable tasks: 2 executed, 1 up-to-date</pre>
</div>
</div>
<div class="paragraph">
<p>Remember that <code>files()</code>, <code>layout.files()</code> and <code>layout.configurableFiles()</code> can take tasks as arguments, whereas <code>fileTree()</code> cannot.</p>
</div>
<div class="paragraph">
<p>The downside of this approach is that all file outputs of the source task become the input files of the target - <code>instrumentClasses</code> in this case. Thats fine as long as the source task only has a single file-based output, like the <code>JavaCompile</code> task. But if you have to link just one output property among several, then you need to explicitly tell Gradle which task generates the input files using the <code>builtBy</code> method:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_setting_up_an_inferred_task_dependency_with_builtby"><a class="anchor" href="#example_setting_up_an_inferred_task_dependency_with_builtby"></a><a class="link" href="#example_setting_up_an_inferred_task_dependency_with_builtby">Example: Setting up an inferred task dependency with builtBy()</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task instrumentClassesBuiltBy(<span class="key">type</span>: <span class="predefined-type">Instrument</span>) {
    classFiles = fileTree(compileJava.destinationDir) {
        builtBy compileJava
    }
    destinationDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/instrumented</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle clean instrumentClassesBuiltBy</code></strong></div>
<div class="content">
<pre>&gt; gradle clean instrumentClassesBuiltBy
&gt; Task :clean UP-TO-DATE
&gt; Task :compileJava
&gt; Task :instrumentClassesBuiltBy


BUILD SUCCESSFUL in 0s
3 actionable tasks: 2 executed, 1 up-to-date</pre>
</div>
</div>
<div class="paragraph">
<p>You can of course just add an explicit task dependency via <code>dependsOn</code>, but the above approach provides more semantic meaning, explaining why <code>compileJava</code> has to run beforehand.</p>
</div>
<div class="sect5">
<h6 id="sec:custom_up_to_date_logic"><a class="anchor" href="#sec:custom_up_to_date_logic"></a><a class="link" href="#sec:custom_up_to_date_logic">Providing custom up-to-date logic</a></h6>
<div class="paragraph">
<p>Gradle automatically handles up-to-date checks for output files and directories, but what if the task output is something else entirely? Perhaps its an update to a web service or a database table. Gradle has no way of knowing how to check whether the task is up to date in such cases.</p>
</div>
<div class="paragraph">
<p>Thats where the <code>upToDateWhen()</code> method on <code>TaskOutputs</code> comes in. This takes a predicate function that is used to determine whether a task is up to date or not. One use case is to disable up-to-date checks completely for a task, like so:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_ignoring_up_to_date_checks"><a class="anchor" href="#example_ignoring_up_to_date_checks"></a><a class="link" href="#example_ignoring_up_to_date_checks">Example: Ignoring up-to-date checks</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task alwaysInstrumentClasses(<span class="key">type</span>: <span class="predefined-type">Instrument</span>) {
    classFiles = layout.files(compileJava)
    destinationDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/instrumented</span><span class="delimiter">&quot;</span></span>)
    outputs.upToDateWhen { <span class="predefined-constant">false</span> }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle clean alwaysInstrumentClasses</code></div>
<div class="content">
<pre>&gt; gradle clean alwaysInstrumentClasses
&gt; Task :compileJava
&gt; Task :alwaysInstrumentClasses


BUILD SUCCESSFUL in 0s
3 actionable tasks: 2 executed, 1 up-to-date</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle alwaysInstrumentClasses</code></div>
<div class="content">
<pre>&gt; gradle alwaysInstrumentClasses
&gt; Task :compileJava UP-TO-DATE
&gt; Task :alwaysInstrumentClasses


BUILD SUCCESSFUL in 0s
2 actionable tasks: 1 executed, 1 up-to-date</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>{ false }</code> closure ensures that <code>copyResources</code> will always perform the copy, irrespective of whether there is no change in the inputs or outputs.</p>
</div>
<div class="paragraph">
<p>You can of course put more complex logic into the closure. You could check whether a particular record in a database table exists or has changed for example. Just be aware that up-to-date checks should <em>save</em> you time. Dont add checks that cost as much or more time than the standard execution of the task. In fact, if a task ends up running frequently anyway, because its rarely up to date, then it may not be worth having an up-to-date check at all. Remember that your checks will always run if the task is in the execution task graph.</p>
</div>
<div class="paragraph">
<p>One common mistake is to use <code>upToDateWhen()</code> instead of <code>Task.onlyIf()</code>. If you want to skip a task on the basis of some condition unrelated to the task inputs and outputs, then you should use <code>onlyIf()</code>. For example, in cases where you want to skip a task when a particular property is set or not set.</p>
</div>
<div class="sect5">
<h6 id="sec:configure_input_normalization"><a class="anchor" href="#sec:configure_input_normalization"></a><a class="link" href="#sec:configure_input_normalization">Configure input normalization</a></h6>
<div class="paragraph">
<p>For up to date checks and the <a href="#build_cache">build cache</a> Gradle needs to determine if two task input properties have the same value.
In order to do so, Gradle first normalizes both inputs and then compares the result.
For example, for a compile classpath, Gradle extracts the ABI signature from the classes on the classpath and then compares signatures between the last Gradle run and the current Gradle run as described in <a href="#sec:java_compile_avoidance">Java compile avoidance</a>.</p>
</div>
<div class="paragraph">
<p>It is possible to customize Gradle&#8217;s built-in strategy for runtime classpath normalization.
All inputs annotated with <code>@<a href="../javadoc/org/gradle/api/tasks/Classpath.html">Classpath</a></code> are considered to be runtime classpaths.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you want to add a file <code>build-info.properties</code> to all your produced jar files which contains information about the build, e.g. the timestamp when the build started or some ID to identify the CI job that published the artifact.
This file is only for auditing purposes, and has no effect on the outcome of running tests.
Nonetheless, this file is part of the runtime classpath for the <code>test</code> task and changes on every build invocation.
Therefore, the <code>test</code> would be never up-to-date or pulled from the build cache.
In order to benefit from incremental builds again, you are able tell Gradle to ignore this file on the runtime classpath at the project level by using <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:normalization(org.gradle.api.Action)">Project.normalization(org.gradle.api.Action)</a>:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_runtime_classpath_normalization"><a class="anchor" href="#example_runtime_classpath_normalization"></a><a class="link" href="#example_runtime_classpath_normalization">Example: Runtime classpath normalization</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">normalization {
    runtimeClasspath {
        ignore <span class="string"><span class="delimiter">'</span><span class="content">build-info.properties</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The effect of this configuration would be that changes to <code>build-info.properties</code> would be ignored for up-to-date checks and <a href="#build_cache">build cache</a> key calculations.
Note that this will not change the runtime behavior of the <code>test</code> task - i.e. any test is still able to load <code>build-info.properties</code> and the runtime classpath is still the same as before.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:stale_task_outputs"><a class="anchor" href="#sec:stale_task_outputs"></a><a class="link" href="#sec:stale_task_outputs">Stale task outputs</a></h5>
<div class="paragraph">
<p>When the Gradle version changes, Gradle detects that outputs from tasks that ran with older versions of Gradle need to be removed to ensure that the newest version of the tasks are starting from a known clean state.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Automatic clean-up of stale output directories has only been implemented for the output of source sets (Java/Groovy/Scala compilation).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:task_rules"><a class="anchor" href="#sec:task_rules"></a><a class="link" href="#sec:task_rules">Task rules</a></h4>
<div class="paragraph">
<p>Sometimes you want to have a task whose behavior depends on a large or infinite number value range of parameters. A very nice and expressive way to provide such tasks are task rules:</p>
</div>
<div class="sect4">
<h5 id="example_task_rule"><a class="anchor" href="#example_task_rule"></a><a class="link" href="#example_task_rule">Example: Task rule</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.addRule(<span class="string"><span class="delimiter">&quot;</span><span class="content">Pattern: ping&lt;ID&gt;</span><span class="delimiter">&quot;</span></span>) { <span class="predefined-type">String</span> taskName -&gt;
    <span class="keyword">if</span> (taskName.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">ping</span><span class="delimiter">&quot;</span></span>)) {
        task(taskName) {
            doLast {
                println <span class="string"><span class="delimiter">&quot;</span><span class="content">Pinging: </span><span class="delimiter">&quot;</span></span> + (taskName - <span class="string"><span class="delimiter">'</span><span class="content">ping</span><span class="delimiter">'</span></span>)
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q pingServer1</code></strong></div>
<div class="content">
<pre>&gt; gradle -q pingServer1
Pinging: Server1</pre>
</div>
</div>
<div class="paragraph">
<p>The String parameter is used as a description for the rule, which is shown with <code>gradle tasks</code>.</p>
</div>
<div class="paragraph">
<p>Rules are not only used when calling tasks from the command line. You can also create dependsOn relations on rule based tasks:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_dependency_on_rule_based_tasks"><a class="anchor" href="#example_dependency_on_rule_based_tasks"></a><a class="link" href="#example_dependency_on_rule_based_tasks">Example: Dependency on rule based tasks</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.addRule(<span class="string"><span class="delimiter">&quot;</span><span class="content">Pattern: ping&lt;ID&gt;</span><span class="delimiter">&quot;</span></span>) { <span class="predefined-type">String</span> taskName -&gt;
    <span class="keyword">if</span> (taskName.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">ping</span><span class="delimiter">&quot;</span></span>)) {
        task(taskName) {
            doLast {
                println <span class="string"><span class="delimiter">&quot;</span><span class="content">Pinging: </span><span class="delimiter">&quot;</span></span> + (taskName - <span class="string"><span class="delimiter">'</span><span class="content">ping</span><span class="delimiter">'</span></span>)
            }
        }
    }
}

task groupPing {
    dependsOn pingServer1, pingServer2
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q groupPing</code></strong></div>
<div class="content">
<pre>&gt; gradle -q groupPing
Pinging: Server1
Pinging: Server2</pre>
</div>
</div>
<div class="paragraph">
<p>If you run <code>gradle -q tasks</code> you won&#8217;t find a task named <code>pingServer1</code> or <code>pingServer2</code>, but this script is executing logic based on the request to run those tasks.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:finalizer_tasks"><a class="anchor" href="#sec:finalizer_tasks"></a><a class="link" href="#sec:finalizer_tasks">Finalizer tasks</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Finalizers tasks are an <em>incubating</em> feature (see <a href="#sec:incubating_state">more about the Gradle feature lifecycle</a>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finalizer tasks are automatically added to the task graph when the finalized task is scheduled to run.</p>
</div>
<div class="sect4">
<h5 id="example_adding_a_task_finalizer"><a class="anchor" href="#example_adding_a_task_finalizer"></a><a class="link" href="#example_adding_a_task_finalizer">Example: Adding a task finalizer</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task taskX {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskX</span><span class="delimiter">'</span></span>
    }
}
task taskY {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskY</span><span class="delimiter">'</span></span>
    }
}

taskX.finalizedBy taskY</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q taskX</code></strong></div>
<div class="content">
<pre>&gt; gradle -q taskX
taskX
taskY</pre>
</div>
</div>
<div class="paragraph">
<p>Finalizer tasks will be executed even if the finalized task fails.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_task_finalizer_for_a_failing_task"><a class="anchor" href="#example_task_finalizer_for_a_failing_task"></a><a class="link" href="#example_task_finalizer_for_a_failing_task">Example: Task finalizer for a failing task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task taskX {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskX</span><span class="delimiter">'</span></span>
        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>()
    }
}
task taskY {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">taskY</span><span class="delimiter">'</span></span>
    }
}

taskX.finalizedBy taskY</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q taskX</code></strong></div>
<div class="content">
<pre>&gt; gradle -q taskX
taskX
taskY

FAILURE: Build failed with an exception.

* Where:
Build file '/home/user/gradle/samples/build.gradle' line: 4

* What went wrong:
Execution failed for task ':taskX'.
&gt; java.lang.RuntimeException (no error message)

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.

* Get more help at https://help.gradle.org

BUILD FAILED in 0s</pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, finalizer tasks are not executed if the finalized task didn&#8217;t do any work, for example if it is considered up to date or if a dependent task fails.</p>
</div>
<div class="paragraph">
<p>Finalizer tasks are useful in situations where the build creates a resource that has to be cleaned up regardless of the build failing or succeeding. An example of such a resource is a web container that is started before an integration test task and which should be always shut down, even if some of the tests fail.</p>
</div>
<div class="paragraph">
<p>To specify a finalizer task you use the <a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:finalizedBy(java.lang.Object[])">Task.finalizedBy(java.lang.Object&#8230;&#8203;)</a> method. This method accepts a task instance, a task name, or any other input accepted by <a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:dependsOn(java.lang.Object[])">Task.dependsOn(java.lang.Object&#8230;&#8203;)</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:lifecycle_tasks"><a class="anchor" href="#sec:lifecycle_tasks"></a><a class="link" href="#sec:lifecycle_tasks">Lifecycle tasks</a></h4>
<div class="paragraph">
<p>Lifecycle tasks are tasks that do not do work themselves. They typically do not have any task actions. Lifecycle tasks can represent several concepts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a work-flow step (e.g., run all checks with <code>check</code>)</p>
</li>
<li>
<p>a buildable thing (e.g., create a debug 32-bit executable for native components with <code>debug32MainExecutable</code>)</p>
</li>
<li>
<p>a convenience task to execute many of the same logical tasks (e.g., run all compilation tasks with <code>compileAll</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Many Gradle plug-ins define their own lifecycle tasks to make it convenient to do specific things. When developing your own plugins, you should consider using your own lifecycle tasks or hooking into some of the tasks already provided by Gradle. See the Java plugin <a href="#sec:java_tasks">tasks</a> for an example.</p>
</div>
<div class="paragraph">
<p>Unless a lifecycle task has actions, its outcome is determined by its dependencies. If any of the task&#8217;s dependencies are executed, the lifecycle task will be considered executed. If all of the task&#8217;s dependencies are up-to-date, skipped or from cache, the lifecycle task will be considered up-to-date.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:the_idea_behind_gradle_tasks"><a class="anchor" href="#sec:the_idea_behind_gradle_tasks"></a><a class="link" href="#sec:the_idea_behind_gradle_tasks">Summary</a></h4>
<div class="paragraph">
<p>If you are coming from Ant, an enhanced Gradle task like <em>Copy</em> seems like a cross between an Ant target and an Ant task. Although Ant&#8217;s tasks and targets are really different entities, Gradle combines these notions into a single entity. Simple Gradle tasks are like Ant&#8217;s targets, but enhanced Gradle tasks also include aspects of Ant tasks. All of Gradle&#8217;s tasks share a common API and you can create dependencies between them. These tasks are much easier to configure than an Ant task. They make full use of the type system, and are more expressive and easier to maintain.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="logging"><a class="anchor" href="#logging"></a><a class="link" href="#logging">Logging</a></h3>
<div class="paragraph">
<p>The log is the main 'UI' of a build tool. If it is too verbose, real warnings and problems are easily hidden by this. On the other hand you need relevant information for figuring out if things have gone wrong. Gradle defines 6 log levels, as shown in <a href="#logLevels">Log levels</a>. There are two Gradle-specific log levels, in addition to the ones you might normally see. Those levels are <em>QUIET</em> and <em>LIFECYCLE</em>. The latter is the default, and is used to report build progress.</p>
</div>
<div class="sect3">
<h4 id="logLevels"><a class="anchor" href="#logLevels"></a><a class="link" href="#logLevels">Log levels</a></h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
ERROR
</td>
<td class="hdlist2">
<p>Error messages</p>
</td>
</tr>
<tr>
<td class="hdlist1">
QUIET
</td>
<td class="hdlist2">
<p>Important information messages</p>
</td>
</tr>
<tr>
<td class="hdlist1">
WARNING
</td>
<td class="hdlist2">
<p>Warning messages</p>
</td>
</tr>
<tr>
<td class="hdlist1">
LIFECYCLE
</td>
<td class="hdlist2">
<p>Progress information messages</p>
</td>
</tr>
<tr>
<td class="hdlist1">
INFO
</td>
<td class="hdlist2">
<p>Information messages</p>
</td>
</tr>
<tr>
<td class="hdlist1">
DEBUG
</td>
<td class="hdlist2">
<p>Debug messages</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The rich components of the console (build status and work in progress area) are displayed regardless of the log level used. Before Gradle 4.0 those rich components were only displayed at log level <code>LIFECYCLE</code> or below.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:choosing_a_log_level"><a class="anchor" href="#sec:choosing_a_log_level"></a><a class="link" href="#sec:choosing_a_log_level">Choosing a log level</a></h4>
<div class="paragraph">
<p>You can use the command line switches shown in <a href="#logLevelCommandLineOptions">Log level command-line options</a> to choose different log levels. You can also configure the log level using <code>gradle.properties</code>, see <a href="#sec:gradle_configuration_properties">Gradle properties</a>. In <a href="#stacktraces">Stacktrace command-line options</a> you find the command line switches which affect stacktrace logging.</p>
</div>
<table id="logLevelCommandLineOptions" class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 2. Log level command-line options</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Outputs Log Levels</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">no logging options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIFECYCLE and higher</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-q</code> or <code>--quiet</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QUIET and higher</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-w</code> or <code>--warn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WARN and higher</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-i</code> or <code>--info</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO and higher</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-d</code> or <code>--debug</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEBUG and higher (that is, all log messages)</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="stacktraces"><a class="anchor" href="#stacktraces"></a><a class="link" href="#stacktraces">Stacktrace command-line options</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-s</code> or <code>--stacktrace</code></dt>
<dd>
<p>Truncated stacktraces are printed. We recommend this over full stacktraces. Groovy full stacktraces are extremely verbose (Due to the underlying dynamic invocation mechanisms. Yet they usually do not contain relevant information for what has gone wrong in <em>your</em> code.) This option renders stacktraces for deprecation warnings.</p>
</dd>
<dt class="hdlist1"><code>-S</code> or <code>--full-stacktrace</code></dt>
<dd>
<p>The full stacktraces are printed out. This option renders stacktraces for deprecation warnings.</p>
</dd>
<dt class="hdlist1">&lt;No stacktrace options&gt;</dt>
<dd>
<p>No stacktraces are printed to the console in case of a build error (e.g. a compile error). Only in case of internal exceptions will stacktraces be printed. If the <code>DEBUG</code> log level is chosen, truncated stacktraces are always printed.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:sending_your_own_log_messages"><a class="anchor" href="#sec:sending_your_own_log_messages"></a><a class="link" href="#sec:sending_your_own_log_messages">Writing your own log messages</a></h4>
<div class="paragraph">
<p>A simple option for logging in your build file is to write messages to standard output. Gradle redirects anything written to standard output to its logging system at the <code>QUIET</code> log level.</p>
</div>
<div class="sect4">
<h5 id="example_using_stdout_to_write_log_messages"><a class="anchor" href="#example_using_stdout_to_write_log_messages"></a><a class="link" href="#example_using_stdout_to_write_log_messages">Example: Using stdout to write log messages</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="string"><span class="delimiter">'</span><span class="content">A message which is logged at QUIET level</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle also provides a <code>logger</code> property to a build script, which is an instance of <a href="../javadoc/org/gradle/api/logging/Logger.html">Logger</a>. This interface extends the SLF4J <code>Logger</code> interface and adds a few Gradle specific methods to it. Below is an example of how this is used in the build script:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_writing_your_own_log_messages"><a class="anchor" href="#example_writing_your_own_log_messages"></a><a class="link" href="#example_writing_your_own_log_messages">Example: Writing your own log messages</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">logger.quiet(<span class="string"><span class="delimiter">'</span><span class="content">An info log message which is always logged.</span><span class="delimiter">'</span></span>)
logger.error(<span class="string"><span class="delimiter">'</span><span class="content">An error log message.</span><span class="delimiter">'</span></span>)
logger.warn(<span class="string"><span class="delimiter">'</span><span class="content">A warning log message.</span><span class="delimiter">'</span></span>)
logger.lifecycle(<span class="string"><span class="delimiter">'</span><span class="content">A lifecycle info log message.</span><span class="delimiter">'</span></span>)
logger.info(<span class="string"><span class="delimiter">'</span><span class="content">An info log message.</span><span class="delimiter">'</span></span>)
logger.debug(<span class="string"><span class="delimiter">'</span><span class="content">A debug log message.</span><span class="delimiter">'</span></span>)
logger.trace(<span class="string"><span class="delimiter">'</span><span class="content">A trace log message.</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the <a href="https://www.slf4j.org/manual.html#typical_usage">typical SLF4J pattern</a> to replace a placeholder with an actual value as part of the log message.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_writing_a_log_message_with_placeholder"><a class="anchor" href="#example_writing_a_log_message_with_placeholder"></a><a class="link" href="#example_writing_a_log_message_with_placeholder">Example: Writing a log message with placeholder</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">logger.info(<span class="string"><span class="delimiter">'</span><span class="content">A {} log message</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">info</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also hook into Gradle&#8217;s logging system from within other classes used in the build (classes from the <code>buildSrc</code> directory for example). Simply use an SLF4J logger. You can use this logger the same way as you use the provided logger in the build script.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_slf4j_to_write_log_messages"><a class="anchor" href="#example_using_slf4j_to_write_log_messages"></a><a class="link" href="#example_using_slf4j_to_write_log_messages">Example: Using SLF4J to write log messages</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.slf4j.Logger</span>
<span class="keyword">import</span> <span class="include">org.slf4j.LoggerFactory</span>

<span class="predefined-type">Logger</span> slf4jLogger = LoggerFactory.getLogger(<span class="string"><span class="delimiter">'</span><span class="content">some-logger</span><span class="delimiter">'</span></span>)
slf4jLogger.info(<span class="string"><span class="delimiter">'</span><span class="content">An info log message logged using SLF4j</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:external_tools"><a class="anchor" href="#sec:external_tools"></a><a class="link" href="#sec:external_tools">Logging from external tools and libraries</a></h4>
<div class="paragraph">
<p>Internally, Gradle uses Ant and Ivy. Both have their own logging system. Gradle redirects their logging output into the Gradle logging system. There is a 1:1 mapping from the Ant/Ivy log levels to the Gradle log levels, except the Ant/Ivy <code>TRACE</code> log level, which is mapped to Gradle <code>DEBUG</code> log level. This means the default Gradle log level will not show any Ant/Ivy output unless it is an error or a warning.</p>
</div>
<div class="paragraph">
<p>There are many tools out there which still use standard output for logging. By default, Gradle redirects standard output to the <code>QUIET</code> log level and standard error to the <code>ERROR</code> level. This behavior is configurable. The project object provides a <a href="../javadoc/org/gradle/api/logging/LoggingManager.html">LoggingManager</a>, which allows you to change the log levels that standard out or error are redirected to when your build script is evaluated.</p>
</div>
<div class="sect4">
<h5 id="example_configuring_standard_output_capture"><a class="anchor" href="#example_configuring_standard_output_capture"></a><a class="link" href="#example_configuring_standard_output_capture">Example: Configuring standard output capture</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">logging.captureStandardOutput LogLevel.INFO
println <span class="string"><span class="delimiter">'</span><span class="content">A message which is logged at INFO level</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To change the log level for standard out or error during task execution, tasks also provide a <a href="../javadoc/org/gradle/api/logging/LoggingManager.html">LoggingManager</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_standard_output_capture_for_a_task"><a class="anchor" href="#example_configuring_standard_output_capture_for_a_task"></a><a class="link" href="#example_configuring_standard_output_capture_for_a_task">Example: Configuring standard output capture for a task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task logInfo {
    logging.captureStandardOutput LogLevel.INFO
    doFirst {
        println <span class="string"><span class="delimiter">'</span><span class="content">A task message which is logged at INFO level</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle also provides integration with the Java Util Logging, Jakarta Commons Logging and Log4j logging toolkits. Any log messages which your build classes write using these logging toolkits will be redirected to Gradle&#8217;s logging system.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:changing_what_gradle_logs"><a class="anchor" href="#sec:changing_what_gradle_logs"></a><a class="link" href="#sec:changing_what_gradle_logs">Changing what Gradle logs</a></h4>
<div class="paragraph">
<p>You can replace much of Gradle&#8217;s logging UI with your own. You might do this, for example, if you want to customize the UI in some way - to log more or less information, or to change the formatting. You replace the logging using the <a href="../dsl/org.gradle.api.invocation.Gradle.html#org.gradle.api.invocation.Gradle:useLogger(java.lang.Object)">Gradle.useLogger(java.lang.Object)</a> method. This is accessible from a build script, or an init script, or via the embedding API. Note that this completely disables Gradle&#8217;s default output. Below is an example init script which changes how task execution and build completion is logged.</p>
</div>
<div class="sect4">
<h5 id="example_customizing_what_gradle_logs"><a class="anchor" href="#example_customizing_what_gradle_logs"></a><a class="link" href="#example_customizing_what_gradle_logs">Example: Customizing what Gradle logs</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">init.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">useLogger(<span class="keyword">new</span> CustomEventLogger())

<span class="type">class</span> <span class="class">CustomEventLogger</span> <span class="directive">extends</span> BuildAdapter <span class="directive">implements</span> TaskExecutionListener {

    <span class="directive">public</span> <span class="type">void</span> beforeExecute(Task task) {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">[</span><span class="inline"><span class="inline-delimiter">$</span>task</span><span class="content">.name]</span><span class="delimiter">&quot;</span></span>
    }

    <span class="directive">public</span> <span class="type">void</span> afterExecute(Task task, TaskState state) {
        println()
    }

    <span class="directive">public</span> <span class="type">void</span> buildFinished(BuildResult result) {
        println <span class="string"><span class="delimiter">'</span><span class="content">build completed</span><span class="delimiter">'</span></span>
        <span class="keyword">if</span> (result.failure != <span class="predefined-constant">null</span>) {
            result.failure.printStackTrace()
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -I init.gradle build</code></strong></div>
<div class="content">
<pre>&gt; gradle -I init.gradle build

&gt; Task :compile
[compile]
compiling source


&gt; Task :testCompile
[testCompile]
compiling test source


&gt; Task :test
[test]
running unit tests


&gt; Task :build
[build]

build completed
3 actionable tasks: 3 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Your logger can implement any of the listener interfaces listed below. When you register a logger, only the logging for the interfaces that it implements is replaced. Logging for the other interfaces is left untouched. You can find out more about the listener interfaces in <a href="#build_lifecycle_events">Build lifecycle events</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../javadoc/org/gradle/BuildListener.html">BuildListener</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/ProjectEvaluationListener.html">ProjectEvaluationListener</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/execution/TaskExecutionGraphListener.html">TaskExecutionGraphListener</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/execution/TaskExecutionListener.html">TaskExecutionListener</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/execution/TaskActionListener.html">TaskActionListener</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="standard_plugins"><a class="anchor" href="#standard_plugins"></a><a class="link" href="#standard_plugins">Standard Gradle plugins</a></h3>
<div class="paragraph">
<p>There are a number of plugins included in the Gradle distribution. These are listed below.</p>
</div>
<div class="sect3">
<h4 id="sec:language_plugins"><a class="anchor" href="#sec:language_plugins"></a><a class="link" href="#sec:language_plugins">Language plugins</a></h4>
<div class="paragraph">
<p>These plugins add support for various languages which can be compiled for and executed in the JVM.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Plugin Id</th>
<th class="tableblock halign-left valign-top">Automatically applies</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#java_plugin"><code>java</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java-base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds Java compilation, testing and bundling capabilities to a project. It serves as the basis for many of the other Gradle plugins. See also <a href="#tutorial_java_projects">this tutorial on Java projects</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#groovy_plugin"><code>groovy</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java</code>, <code>groovy-base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds support for building Groovy projects. See also <a href="#tutorial_groovy_projects">this tutorial for Groovy projects</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#scala_plugin"><code>scala</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java</code>, <code>scala-base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds support for building Scala projects.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#antlr_plugin"><code>antlr</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds support for generating parsers using <a href="http://www.antlr.org/">Antlr</a>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:incubating_language_plugins"><a class="anchor" href="#sec:incubating_language_plugins"></a><a class="link" href="#sec:incubating_language_plugins">Incubating language plugins</a></h4>
<div class="paragraph">
<p>These plugins add support for various languages:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Plugin Id</th>
<th class="tableblock halign-left valign-top">Automatically applies</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#native_software"><code>assembler</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds native assembly language capabilities to a project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#native_software"><code>c</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds C source compilation capabilities to a project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#native_software"><code>cpp</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds C++ source compilation capabilities to a project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#native_software"><code>objective-c</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds Objective-C source compilation capabilities to a project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#native_software"><code>objective-cpp</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds Objective-C++ source compilation capabilities to a project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#native_software"><code>windows-resources</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds support for including Windows resources in native binaries.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:integration_plugins"><a class="anchor" href="#sec:integration_plugins"></a><a class="link" href="#sec:integration_plugins">Integration plugins</a></h4>
<div class="paragraph">
<p>These plugins provide some integration with various runtime technologies.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Plugin Id</th>
<th class="tableblock halign-left valign-top">Automatically applies</th>
<th class="tableblock halign-left valign-top">Works with</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#application_plugin"><code>application</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java</code>, <code>distribution</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds tasks for running and bundling a Java project as a command-line application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#ear_plugin"><code>ear</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds support for building J2EE applications.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#publishing_ivy"><code>ivy-publish</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application</code>, <code>distribution</code>, <code>java</code>, <code>war</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides a new DSL to support publishing artifacts to Ivy repositories, which improves on the existing DSL.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#publishing_maven"><code>maven-publish</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application</code>, <code>distribution</code>, <code>java</code>, <code>war</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides a new DSL to support publishing artifacts to Maven repositories, which improves on the existing DSL.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#maven_plugin"><code>maven</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java</code>, <code>war</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds support for publishing artifacts to Maven repositories using the <em>original</em> publishing mechanism available in Gradle 1.0. See also <a href="#artifact_management">Legacy Publishing</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#osgi_plugin"><code>osgi</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java-base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds support for building OSGi bundles.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#war_plugin"><code>war</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds support for assembling web application WAR files.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:incubating_integration_plugins"><a class="anchor" href="#sec:incubating_integration_plugins"></a><a class="link" href="#sec:incubating_integration_plugins">Incubating integration plugins</a></h4>
<div class="paragraph">
<p>These plugins provide some integration with various runtime technologies.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Plugin Id</th>
<th class="tableblock halign-left valign-top">Automatically applies</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#distribution_plugin"><code>distribution</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds support for building ZIP and TAR distributions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#java_library_distribution_plugin"><code>java-library-distribution</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java</code>, <code>distribution</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds support for building ZIP and TAR distributions for a Java library.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:software_development_plugins"><a class="anchor" href="#sec:software_development_plugins"></a><a class="link" href="#sec:software_development_plugins">Software development plugins</a></h4>
<div class="paragraph">
<p>These plugins provide help with your software development process.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Plugin Id</th>
<th class="tableblock halign-left valign-top">Automatically applies</th>
<th class="tableblock halign-left valign-top">Works with</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="announce_plugin.html#announce_plugin"><code>announce</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Publish messages to your favourite platforms, such as Twitter or Growl.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="build_announcements_plugin.html#build_announcements_plugin"><code>build-announcements</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">announce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sends local announcements to your desktop about interesting events in the build lifecycle.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#checkstyle_plugin"><code>checkstyle</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java-base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs quality checks on your project&#8217;s Java source files using <a href="http://checkstyle.sourceforge.net/index.html">Checkstyle</a> and generates reports from these checks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#codenarc_plugin"><code>codenarc</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>groovy-base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs quality checks on your project&#8217;s Groovy source files using <a href="http://codenarc.sourceforge.net/index.html">CodeNarc</a> and generates reports from these checks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#eclipse_plugin"><code>eclipse</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java</code>,<code>groovy</code>, <code>scala</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generates files that are used by <a href="http://eclipse.org">Eclipse IDE</a>, thus making it possible to import the project into Eclipse. See also <a href="#tutorial_java_projects">this tutorial for Java projects</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#eclipse_plugin"><code>eclipse-wtp</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ear</code>, <code>war</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Does the same as the eclipse plugin plus generates eclipse WTP (Web Tools Platform) configuration files. After importing to eclipse your war/ear projects should be configured to work with WTP. See also <a href="#tutorial_java_projects">this tutorial for Java projects</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#findbugs_plugin"><code>findbugs</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java-base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs quality checks on your project&#8217;s Java source files using <a href="http://findbugs.sourceforge.net">FindBugs</a> and generates reports from these checks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#idea_plugin"><code>idea</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generates files that are used by <a href="http://www.jetbrains.com/idea/index.html">Intellij IDEA IDE</a>, thus making it possible to import the project into IDEA.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#jdepend_plugin"><code>jdepend</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java-base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs quality checks on your project&#8217;s source files using <a href="http://clarkware.com/software/JDepend.html">JDepend</a> and generates reports from these checks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#pmd_plugin"><code>pmd</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java-base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs quality checks on your project&#8217;s Java source files using <a href="http://pmd.sourceforge.net">PMD</a> and generates reports from these checks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="project_report_plugin.html#project_report_plugin"><code>project-report</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reporting-base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generates reports containing useful information about your Gradle build.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#signing_plugin"><code>signing</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">base</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds the ability to digitally sign built files and artifacts.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:incubating_software_development_plugins"><a class="anchor" href="#sec:incubating_software_development_plugins"></a><a class="link" href="#sec:incubating_software_development_plugins">Incubating software development plugins</a></h4>
<div class="paragraph">
<p>These plugins provide help with your software development process.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 3. Software development plugins</caption>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Plugin Id</th>
<th class="tableblock halign-left valign-top">Automatically applies</th>
<th class="tableblock halign-left valign-top">Works with</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="build_dashboard_plugin.html#build_dashboard_plugin"><code>build-dashboard</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reporting-base</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generates build dashboard report.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#native_software"><code>cunit</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds support for running <a href="http://cunit.sourceforge.net">CUnit</a> tests.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#jacoco_plugin"><code>jacoco</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reporting-base</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides integration with the <a href="http://www.eclemma.org/jacoco/">JaCoCo</a> code coverage library for Java.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#native_software"><code>visual-studio</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">native language plugins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds integration with Visual Studio.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#java_gradle_plugin"><code>java-gradle-plugin</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assists with development of Gradle plugins by providing standard plugin build configuration and validation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:base_plugins"><a class="anchor" href="#sec:base_plugins"></a><a class="link" href="#sec:base_plugins">Base plugins</a></h4>
<div class="paragraph">
<p>These plugins form the basic building blocks which the other plugins are assembled from. They are available for you to use in your build files, and are listed here for completeness. However, be aware that they are not yet considered part of Gradle&#8217;s public API. As such, these plugins are not documented in the user guide. You might refer to their API documentation to learn more about them.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Plugin Id</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">base</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds the standard lifecycle tasks and configures reasonable defaults for the archive tasks. See <a href="#base_plugin">Base Plugin</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java-base</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds the source sets concept to the project. Does not add any particular source sets.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groovy-base</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds the Groovy source sets concept to the project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala-base</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds the Scala source sets concept to the project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reporting-base</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds some shared convention properties to the project, relating to report generation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:third_party_plugins"><a class="anchor" href="#sec:third_party_plugins"></a><a class="link" href="#sec:third_party_plugins">Third party plugins</a></h4>
<div class="paragraph">
<p>You can find a list of external plugins at the <a href="http://plugins.gradle.org/">Gradle Plugins site</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="test_kit"><a class="anchor" href="#test_kit"></a><a class="link" href="#test_kit">Testing Build Logic with TestKit</a></h3>
<div class="paragraph">
<p>The Gradle TestKit (a.k.a. just TestKit) is a library that aids in testing Gradle plugins and build logic generally. At this time, it is focused on <em>functional</em> testing. That is, testing build logic by exercising it as part of a programmatically executed build. Over time, the TestKit will likely expand to facilitate other kinds of tests.</p>
</div>
<div class="sect3">
<h4 id="sec:testkit_usage"><a class="anchor" href="#sec:testkit_usage"></a><a class="link" href="#sec:testkit_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the TestKit, include the following in your plugin&#8217;s build:</p>
</div>
<div class="sect4">
<h5 id="example_declaring_the_testkit_dependency"><a class="anchor" href="#example_declaring_the_testkit_dependency"></a><a class="link" href="#example_declaring_the_testkit_dependency">Example: Declaring the TestKit dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    testCompile gradleTestKit()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>gradleTestKit()</code> encompasses the classes of the TestKit, as well as the <a href="#embedding">Gradle Tooling API client</a>. It does not include a version of <a href="http://junit.org">JUnit</a>, <a href="http://testng.org">TestNG</a>, or any other test execution framework. Such a dependency must be explicitly declared.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_the_junit_dependency"><a class="anchor" href="#example_declaring_the_junit_dependency"></a><a class="link" href="#example_declaring_the_junit_dependency">Example: Declaring the JUnit dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    testCompile <span class="string"><span class="delimiter">'</span><span class="content">junit:junit:4.12</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:functional_testing_with_the_gradle_runner"><a class="anchor" href="#sec:functional_testing_with_the_gradle_runner"></a><a class="link" href="#sec:functional_testing_with_the_gradle_runner">Functional testing with the Gradle runner</a></h4>
<div class="paragraph">
<p>The <a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html">GradleRunner</a> facilitates programmatically executing Gradle builds, and inspecting the result.</p>
</div>
<div class="paragraph">
<p>A contrived build can be created (e.g. programmatically, or from a template) that exercises the logic under test. The build can then be executed, potentially in a variety of ways (e.g. different combinations of tasks and arguments). The correctness of the logic can then be verified by asserting the following, potentially in combination:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The build&#8217;s output;</p>
</li>
<li>
<p>The build&#8217;s logging (i.e. console output);</p>
</li>
<li>
<p>The set of tasks executed by the build and their results (e.g. FAILED, UP-TO-DATE etc.).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After creating and configuring a runner instance, the build can be executed via the <a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html#build--">GradleRunner.build()</a> or <a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html#buildAndFail--">GradleRunner.buildAndFail()</a> methods depending on the anticipated outcome.</p>
</div>
<div class="paragraph">
<p>The following demonstrates the usage of Gradle runner in a Java JUnit test:</p>
</div>
<div class="sect4">
<h5 id="example_using_gradlerunner_with_junit"><a class="anchor" href="#example_using_gradlerunner_with_junit"></a><a class="link" href="#example_using_gradlerunner_with_junit">Example: Using GradleRunner with JUnit</a></h5>
<div class="listingblock">
<div class="title">BuildLogicFunctionalTest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.gradle.testkit.runner.BuildResult</span>;
<span class="keyword">import</span> <span class="include">org.gradle.testkit.runner.GradleRunner</span>;
<span class="keyword">import</span> <span class="include">org.junit.Before</span>;
<span class="keyword">import</span> <span class="include">org.junit.Rule</span>;
<span class="keyword">import</span> <span class="include">org.junit.Test</span>;
<span class="keyword">import</span> <span class="include">org.junit.rules.TemporaryFolder</span>;

<span class="keyword">import</span> <span class="include">java.io.BufferedWriter</span>;
<span class="keyword">import</span> <span class="include">java.io.File</span>;
<span class="keyword">import</span> <span class="include">java.io.FileWriter</span>;
<span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="keyword">import</span> <span class="include">java.util.Collections</span>;

<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.Assert.assertEquals</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.Assert.assertTrue</span>;

<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.gradle.testkit.runner.TaskOutcome</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">BuildLogicFunctionalTest</span> {
    <span class="annotation">@Rule</span> <span class="directive">public</span> <span class="directive">final</span> TemporaryFolder testProjectDir = <span class="keyword">new</span> TemporaryFolder();
    <span class="directive">private</span> <span class="predefined-type">File</span> buildFile;

    <span class="annotation">@Before</span>
    <span class="directive">public</span> <span class="type">void</span> setup() <span class="directive">throws</span> <span class="exception">IOException</span> {
        buildFile = testProjectDir.newFile(<span class="string"><span class="delimiter">&quot;</span><span class="content">build.gradle</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="annotation">@Test</span>
    <span class="directive">public</span> <span class="type">void</span> testHelloWorldTask() <span class="directive">throws</span> <span class="exception">IOException</span> {
        <span class="predefined-type">String</span> buildFileContent = <span class="string"><span class="delimiter">&quot;</span><span class="content">task helloWorld {</span><span class="delimiter">&quot;</span></span> +
                                  <span class="string"><span class="delimiter">&quot;</span><span class="content">    doLast {</span><span class="delimiter">&quot;</span></span> +
                                  <span class="string"><span class="delimiter">&quot;</span><span class="content">        println 'Hello world!'</span><span class="delimiter">&quot;</span></span> +
                                  <span class="string"><span class="delimiter">&quot;</span><span class="content">    }</span><span class="delimiter">&quot;</span></span> +
                                  <span class="string"><span class="delimiter">&quot;</span><span class="content">}</span><span class="delimiter">&quot;</span></span>;
        writeFile(buildFile, buildFileContent);

        BuildResult result = GradleRunner.create()
            .withProjectDir(testProjectDir.getRoot())
            .withArguments(<span class="string"><span class="delimiter">&quot;</span><span class="content">helloWorld</span><span class="delimiter">&quot;</span></span>)
            .build();

        assertTrue(result.getOutput().contains(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello world!</span><span class="delimiter">&quot;</span></span>));
        assertEquals(SUCCESS, result.task(<span class="string"><span class="delimiter">&quot;</span><span class="content">:helloWorld</span><span class="delimiter">&quot;</span></span>).getOutcome());
    }

    <span class="directive">private</span> <span class="type">void</span> writeFile(<span class="predefined-type">File</span> destination, <span class="predefined-type">String</span> content) <span class="directive">throws</span> <span class="exception">IOException</span> {
        <span class="predefined-type">BufferedWriter</span> output = <span class="predefined-constant">null</span>;
        <span class="keyword">try</span> {
            output = <span class="keyword">new</span> <span class="predefined-type">BufferedWriter</span>(<span class="keyword">new</span> <span class="predefined-type">FileWriter</span>(destination));
            output.write(content);
        } <span class="keyword">finally</span> {
            <span class="keyword">if</span> (output != <span class="predefined-constant">null</span>) {
                output.close();
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any test execution framework can be used.</p>
</div>
<div class="paragraph">
<p>As Gradle build scripts are written in the Groovy programming language, and as many plugins are implemented in Groovy, it is often a productive choice to write Gradle functional tests in Groovy. Furthermore, it is recommended to use the (Groovy based) <a href="https://code.google.com/p/spock/">Spock test execution framework</a> as it offers many compelling features over the use of JUnit.</p>
</div>
<div class="paragraph">
<p>The following demonstrates the usage of Gradle runner in a Groovy Spock test:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_gradlerunner_with_spock"><a class="anchor" href="#example_using_gradlerunner_with_spock"></a><a class="link" href="#example_using_gradlerunner_with_spock">Example: Using GradleRunner with Spock</a></h5>
<div class="listingblock">
<div class="title">BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.gradle.testkit.runner.GradleRunner</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.gradle.testkit.runner.TaskOutcome.*</span>
<span class="keyword">import</span> <span class="include">org.junit.Rule</span>
<span class="keyword">import</span> <span class="include">org.junit.rules.TemporaryFolder</span>
<span class="keyword">import</span> <span class="include">spock.lang.Specification</span>

<span class="type">class</span> <span class="class">BuildLogicFunctionalTest</span> <span class="directive">extends</span> Specification {
    <span class="annotation">@Rule</span> <span class="directive">final</span> TemporaryFolder testProjectDir = <span class="keyword">new</span> TemporaryFolder()
    <span class="predefined-type">File</span> buildFile

    <span class="keyword">def</span> <span class="function">setup</span>() {
        buildFile = testProjectDir.newFile(<span class="string"><span class="delimiter">'</span><span class="content">build.gradle</span><span class="delimiter">'</span></span>)
    }

    <span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello world task prints hello world</span><span class="delimiter">&quot;</span></span>() {
        <span class="key">given</span>:
        buildFile &lt;&lt; <span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">
            task helloWorld {
                doLast {
                    println 'Hello world!'
                }
            }
        </span><span class="delimiter">&quot;&quot;&quot;</span></span>

        <span class="key">when</span>:
        <span class="keyword">def</span> result = GradleRunner.create()
            .withProjectDir(testProjectDir.root)
            .withArguments(<span class="string"><span class="delimiter">'</span><span class="content">helloWorld</span><span class="delimiter">'</span></span>)
            .build()

        <span class="key">then</span>:
        result.output.contains(<span class="string"><span class="delimiter">'</span><span class="content">Hello world!</span><span class="delimiter">'</span></span>)
        result.task(<span class="string"><span class="delimiter">&quot;</span><span class="content">:helloWorld</span><span class="delimiter">&quot;</span></span>).outcome == SUCCESS
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is a common practice to implement any custom build logic (like plugins and task types) that is more complex in nature as external classes in a standalone project. The main driver behind this approach is bundle the compiled code into a JAR file, publish it to a binary repository and reuse it across various projects.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:test-kit-classpath-injection"><a class="anchor" href="#sub:test-kit-classpath-injection"></a><a class="link" href="#sub:test-kit-classpath-injection">Getting the plugin-under-test into the test build</a></h4>
<div class="paragraph">
<p>The GradleRunner uses the <a href="#embedding">Tooling API</a> to execute builds. An implication of this is that the builds are executed in a separate process (i.e. not the same process executing the tests). Therefore, the test build does not share the same classpath or classloaders as the test process and the code under test is not implicitly available to the test build.</p>
</div>
<div class="paragraph">
<p>Starting with version 2.13, Gradle provides a <a href="#sub:test-kit-automatic-classpath-injection">conventional mechanism to inject the code under test into the test build</a>.</p>
</div>
<div class="paragraph">
<p>For earlier versions of Gradle (before 2.13), it is possible to manually make the code under test available via some extra configuration. The following example demonstrates having the build generate a file containing the implementation classpath of the code under test, and making it available at test runtime.</p>
</div>
<div class="sect4">
<h5 id="example_making_the_code_under_test_classpath_available_to_the_tests"><a class="anchor" href="#example_making_the_code_under_test_classpath_available_to_the_tests"></a><a class="link" href="#example_making_the_code_under_test_classpath_available_to_the_tests">Example: Making the code under test classpath available to the tests</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// Write the plugin's classpath to a file to share with the tests</span>
task createClasspathManifest {
    <span class="keyword">def</span> outputDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>name</span><span class="delimiter">&quot;</span></span>)

    inputs.files sourceSets.main.runtimeClasspath
    outputs.dir outputDir

    doLast {
        outputDir.mkdirs()
        file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>outputDir</span><span class="content">/plugin-classpath.txt</span><span class="delimiter">&quot;</span></span>).text = sourceSets.main.runtimeClasspath.join(<span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>)
    }
}

<span class="comment">// Add the classpath file to the test runtime classpath</span>
dependencies {
    testRuntime files(createClasspathManifest)
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/testKit/gradleRunner/manualClasspathInjection</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The tests can then read this value, and inject the classpath into the test build by using the method <a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html#withPluginClasspath-java.lang.Iterable-">GradleRunner.withPluginClasspath(java.lang.Iterable)</a>. This classpath is then available to use to locate plugins in a test build via the plugins DSL (see <a href="#plugins">Plugins</a>). Applying plugins with the plugins DSL requires the definition of a plugin identifier. The following is an example (in Groovy) of doing this from within a Spock Framework <code>setup()</code> method, which is analogous to a JUnit <code>@Before</code> method.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_injecting_the_code_under_test_classes_into_test_builds"><a class="anchor" href="#example_injecting_the_code_under_test_classes_into_test_builds"></a><a class="link" href="#example_injecting_the_code_under_test_classes_into_test_builds">Example: Injecting the code under test classes into test builds</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">src/test/groovy/org/gradle/sample/BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="predefined-type">List</span>&lt;<span class="predefined-type">File</span>&gt; pluginClasspath

    <span class="keyword">def</span> <span class="function">setup</span>() {
        buildFile = testProjectDir.newFile(<span class="string"><span class="delimiter">'</span><span class="content">build.gradle</span><span class="delimiter">'</span></span>)

        <span class="keyword">def</span> pluginClasspathResource = getClass().classLoader.findResource(<span class="string"><span class="delimiter">&quot;</span><span class="content">plugin-classpath.txt</span><span class="delimiter">&quot;</span></span>)
        <span class="keyword">if</span> (pluginClasspathResource == <span class="predefined-constant">null</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalStateException</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Did not find plugin classpath resource, run `testClasses` build task.</span><span class="delimiter">&quot;</span></span>)
        }

        pluginClasspath = pluginClasspathResource.readLines().collect { <span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="local-variable">it</span>) }
    }

    <span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello world task prints hello world</span><span class="delimiter">&quot;</span></span>() {
        <span class="key">given</span>:
        buildFile &lt;&lt; <span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">
            plugins {
                id 'org.gradle.sample.helloworld'
            }
        </span><span class="delimiter">&quot;&quot;&quot;</span></span>

        <span class="key">when</span>:
        <span class="keyword">def</span> result = GradleRunner.create()
            .withProjectDir(testProjectDir.root)
            .withArguments(<span class="string"><span class="delimiter">'</span><span class="content">helloWorld</span><span class="delimiter">'</span></span>)
            .withPluginClasspath(pluginClasspath)
            .build()

        <span class="key">then</span>:
        result.output.contains(<span class="string"><span class="delimiter">'</span><span class="content">Hello world!</span><span class="delimiter">'</span></span>)
        result.task(<span class="string"><span class="delimiter">&quot;</span><span class="content">:helloWorld</span><span class="delimiter">&quot;</span></span>).outcome == SUCCESS
    }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/testKit/gradleRunner/manualClasspathInjection</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This approach works well when executing the functional tests as part of the Gradle build. When executing the functional tests from an IDE, there are extra considerations. Namely, the classpath manifest file points to the class files etc. generated by Gradle and not the IDE. This means that after making a change to the source of the code under test, the source must be recompiled by Gradle. Similarly, if the effective classpath of the code under test changes, the manifest must be regenerated. In either case, executing the <code>testClasses</code> task of the build will ensure that things are up to date.</p>
</div>
<div class="paragraph">
<p>Some IDEs provide a convenience option to delegate the "test classpath generation and execution" to the build. In IntelliJ you can find this option under Preferences&#8230;&#8203; &gt; Build, Execution, Deployment &gt; Build Tools &gt; Gradle &gt; Runner &gt; Delegate IDE build/run actions to gradle. Please consult the documentation of your IDE for more information.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:working_with_gradle_versions_prior_to_28"><a class="anchor" href="#sec:working_with_gradle_versions_prior_to_28"></a><a class="link" href="#sec:working_with_gradle_versions_prior_to_28">Working with Gradle versions prior to 2.8</a></h5>
<div class="paragraph">
<p>The <a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html#withPluginClasspath-java.lang.Iterable-">GradleRunner.withPluginClasspath(java.lang.Iterable)</a> method will not work when executing the build with a Gradle version earlier than 2.8 (see <a href="#sub:gradle-runner-gradle-version">The version used to test</a>), as this feature is not supported on such Gradle versions.</p>
</div>
<div class="paragraph">
<p>Instead, the code must be injected via the build script itself. The following sample demonstrates how this can be done.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_injecting_the_code_under_test_classes_into_test_builds_for_gradle_versions_prior_to_2_8"><a class="anchor" href="#example_injecting_the_code_under_test_classes_into_test_builds_for_gradle_versions_prior_to_2_8"></a><a class="link" href="#example_injecting_the_code_under_test_classes_into_test_builds_for_gradle_versions_prior_to_2_8">Example: Injecting the code under test classes into test builds for Gradle versions prior to 2.8</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">src/test/groovy/org/gradle/sample/BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="predefined-type">List</span>&lt;<span class="predefined-type">File</span>&gt; pluginClasspath

    <span class="keyword">def</span> <span class="function">setup</span>() {
        buildFile = testProjectDir.newFile(<span class="string"><span class="delimiter">'</span><span class="content">build.gradle</span><span class="delimiter">'</span></span>)

        <span class="keyword">def</span> pluginClasspathResource = getClass().classLoader.findResource(<span class="string"><span class="delimiter">&quot;</span><span class="content">plugin-classpath.txt</span><span class="delimiter">&quot;</span></span>)
        <span class="keyword">if</span> (pluginClasspathResource == <span class="predefined-constant">null</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalStateException</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Did not find plugin classpath resource, run `testClasses` build task.</span><span class="delimiter">&quot;</span></span>)
        }

        pluginClasspath = pluginClasspathResource.readLines().collect { <span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="local-variable">it</span>) }
    }

    <span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello world task prints hello world with pre Gradle 2.8</span><span class="delimiter">&quot;</span></span>() {
        <span class="key">given</span>:
        <span class="keyword">def</span> classpathString = pluginClasspath
            .collect { <span class="local-variable">it</span>.absolutePath.replace(<span class="string"><span class="delimiter">'</span><span class="char">\\</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="char">\\</span><span class="char">\\</span><span class="delimiter">'</span></span>) } <span class="comment">// escape backslashes in Windows paths</span>
            .collect { <span class="string"><span class="delimiter">&quot;</span><span class="content">'</span><span class="inline"><span class="inline-delimiter">$</span><span class="local-variable">it</span></span><span class="content">'</span><span class="delimiter">&quot;</span></span> }
            .join(<span class="string"><span class="delimiter">&quot;</span><span class="content">, </span><span class="delimiter">&quot;</span></span>)

        buildFile &lt;&lt; <span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">
            buildscript {
                dependencies {
                    classpath files(</span><span class="inline"><span class="inline-delimiter">$</span>classpathString</span><span class="content">)
                }
            }
            apply plugin: &quot;org.gradle.sample.helloworld&quot;
        </span><span class="delimiter">&quot;&quot;&quot;</span></span>

        <span class="key">when</span>:
        <span class="keyword">def</span> result = GradleRunner.create()
            .withProjectDir(testProjectDir.root)
            .withArguments(<span class="string"><span class="delimiter">'</span><span class="content">helloWorld</span><span class="delimiter">'</span></span>)
            .withGradleVersion(<span class="string"><span class="delimiter">&quot;</span><span class="content">2.7</span><span class="delimiter">&quot;</span></span>)
            .build()

        <span class="key">then</span>:
        result.output.contains(<span class="string"><span class="delimiter">'</span><span class="content">Hello world!</span><span class="delimiter">'</span></span>)
        result.task(<span class="string"><span class="delimiter">&quot;</span><span class="content">:helloWorld</span><span class="delimiter">&quot;</span></span>).outcome == SUCCESS
    }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/testKit/gradleRunner/manualClasspathInjection</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sub:test-kit-automatic-classpath-injection"><a class="anchor" href="#sub:test-kit-automatic-classpath-injection"></a><a class="link" href="#sub:test-kit-automatic-classpath-injection">Automatic injection with the Java Gradle Plugin Development plugin</a></h5>
<div class="paragraph">
<p>The <a href="#java_gradle_plugin">Java Gradle Plugin development plugin</a> can be used to assist in the development of Gradle plugins. Starting with Gradle version 2.13, the plugin provides a direct integration with TestKit. When applied to a project, the plugin automatically adds the <code>gradleTestKit()</code> dependency to the test compile configuration. Furthermore, it automatically generates the classpath for the code under test and injects it via <a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html#withPluginClasspath--">GradleRunner.withPluginClasspath()</a> for any <code>GradleRunner</code> instance created by the user. It&#8217;s important to note that the mechanism currently <em>only</em> works if the plugin under test is applied using the <a href="#sec:plugins_block">plugins DSL</a>. If the <a href="#sub:gradle-runner-gradle-version">target Gradle version</a> is prior to 2.8, automatic plugin classpath injection is not performed.</p>
</div>
<div class="paragraph">
<p>The plugin uses the following conventions for applying the TestKit dependency and injecting the classpath:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Source set containing code under test: <code>sourceSets.main</code></p>
</li>
<li>
<p>Source set used for injecting the plugin classpath: <code>sourceSets.test</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any of these conventions can be reconfigured with the help of the class<a href="../javadoc/org/gradle/plugin/devel/GradlePluginDevelopmentExtension.html">GradlePluginDevelopmentExtension</a>.</p>
</div>
<div class="paragraph">
<p>The following Groovy-based sample demonstrates how to automatically inject the plugin classpath by using the standard conventions applied by the Java Gradle Plugin Development plugin.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_the_java_gradle_development_plugin_for_generating_the_plugin_metadata"><a class="anchor" href="#example_using_the_java_gradle_development_plugin_for_generating_the_plugin_metadata"></a><a class="link" href="#example_using_the_java_gradle_development_plugin_for_generating_the_plugin_metadata">Example: Using the Java Gradle Development plugin for generating the plugin metadata</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">groovy</span><span class="delimiter">'</span></span>
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java-gradle-plugin</span><span class="delimiter">'</span></span>

dependencies {
    testCompile(<span class="string"><span class="delimiter">'</span><span class="content">org.spockframework:spock-core:1.1-groovy-2.4</span><span class="delimiter">'</span></span>) {
        exclude <span class="key">module</span>: <span class="string"><span class="delimiter">'</span><span class="content">groovy-all</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/testKit/gradleRunner/automaticClasspathInjectionQuickstart</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="example_automatically_injecting_the_code_under_test_classes_into_test_builds"><a class="anchor" href="#example_automatically_injecting_the_code_under_test_classes_into_test_builds"></a><a class="link" href="#example_automatically_injecting_the_code_under_test_classes_into_test_builds">Example: Automatically injecting the code under test classes into test builds</a></h5>
<div class="listingblock">
<div class="title">src/test/groovy/org/gradle/sample/BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello world task prints hello world</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">given</span>:
    buildFile &lt;&lt; <span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">
        plugins {
            id 'org.gradle.sample.helloworld'
        }
    </span><span class="delimiter">&quot;&quot;&quot;</span></span>

    <span class="key">when</span>:
    <span class="keyword">def</span> result = GradleRunner.create()
        .withProjectDir(testProjectDir.root)
        .withArguments(<span class="string"><span class="delimiter">'</span><span class="content">helloWorld</span><span class="delimiter">'</span></span>)
        .withPluginClasspath()
        .build()

    <span class="key">then</span>:
    result.output.contains(<span class="string"><span class="delimiter">'</span><span class="content">Hello world!</span><span class="delimiter">'</span></span>)
    result.task(<span class="string"><span class="delimiter">&quot;</span><span class="content">:helloWorld</span><span class="delimiter">&quot;</span></span>).outcome == SUCCESS
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/testKit/gradleRunner/automaticClasspathInjectionQuickstart</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following build script demonstrates how to reconfigure the conventions provided by the Java Gradle Plugin Development plugin for a project that uses a custom <code>Test</code> source set.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_reconfiguring_the_classpath_generation_conventions_of_the_java_gradle_development_plugin"><a class="anchor" href="#example_reconfiguring_the_classpath_generation_conventions_of_the_java_gradle_development_plugin"></a><a class="link" href="#example_reconfiguring_the_classpath_generation_conventions_of_the_java_gradle_development_plugin">Example: Reconfiguring the classpath generation conventions of the Java Gradle Development plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">groovy</span><span class="delimiter">'</span></span>
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java-gradle-plugin</span><span class="delimiter">'</span></span>

sourceSets {
    functionalTest {
        groovy {
            srcDir file(<span class="string"><span class="delimiter">'</span><span class="content">src/functionalTest/groovy</span><span class="delimiter">'</span></span>)
        }
        resources {
            srcDir file(<span class="string"><span class="delimiter">'</span><span class="content">src/functionalTest/resources</span><span class="delimiter">'</span></span>)
        }
        compileClasspath += sourceSets.main.output + configurations.testRuntime
        runtimeClasspath += output + compileClasspath
    }
}

task functionalTest(<span class="key">type</span>: Test) {
    testClassesDirs = sourceSets.functionalTest.output.classesDirs
    classpath = sourceSets.functionalTest.runtimeClasspath
}

check.dependsOn functionalTest

gradlePlugin {
    testSourceSets sourceSets.functionalTest
}

dependencies {
    functionalTestCompile(<span class="string"><span class="delimiter">'</span><span class="content">org.spockframework:spock-core:1.1-groovy-2.4</span><span class="delimiter">'</span></span>) {
        exclude <span class="key">module</span>: <span class="string"><span class="delimiter">'</span><span class="content">groovy-all</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/testKit/gradleRunner/automaticClasspathInjectionCustomTestSourceSet</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:controlling_the_build_environment"><a class="anchor" href="#sec:controlling_the_build_environment"></a><a class="link" href="#sec:controlling_the_build_environment">Controlling the build environment</a></h4>
<div class="paragraph">
<p>The runner executes the test builds in an isolated environment by specifying a dedicated "working directory" in a directory inside the JVM&#8217;s temp directory (i.e. the location specified by the <code>java.io.tmpdir</code> system property, typically <code>/tmp</code>). Any configuration in the default Gradle user home directory (e.g. <code>~/.gradle/gradle.properties</code>) is not used for test execution. The TestKit does not expose a mechanism for fine grained control of environment variables etc. Future versions of the TestKit will provide improved configuration options.</p>
</div>
<div class="paragraph">
<p>The TestKit uses dedicated daemon processes that are automatically shut down after test execution.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:gradle-runner-gradle-version"><a class="anchor" href="#sub:gradle-runner-gradle-version"></a><a class="link" href="#sub:gradle-runner-gradle-version">The Gradle version used to test</a></h4>
<div class="paragraph">
<p>The Gradle runner requires a Gradle distribution in order to execute the build. The TestKit does not depend on all of Gradle&#8217;s implementation.</p>
</div>
<div class="paragraph">
<p>By default, the runner will attempt to find a Gradle distribution based on where the <code>GradleRunner</code> class was loaded from. That is, it is expected that the class was loaded from a Gradle distribution, as is the case when using the <code>gradleTestKit()</code> dependency declaration.</p>
</div>
<div class="paragraph">
<p>When using the runner as part of tests <em>being executed by Gradle</em> (e.g. executing the <code>test</code> task of a plugin project), the same distribution used to execute the tests will be used by the runner. When using the runner as part of tests <em>being executed by an IDE</em>, the same distribution of Gradle that was used when importing the project will be used. This means that the plugin will effectively be tested with the same version of Gradle that it is being built with.</p>
</div>
<div class="paragraph">
<p>Alternatively, a different and specific version of Gradle to use can be specified by the any of the following <code>GradleRunner</code> methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html#withGradleVersion-java.lang.String-">GradleRunner.withGradleVersion(java.lang.String)</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html#withGradleInstallation-java.io.File-">GradleRunner.withGradleInstallation(java.io.File)</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html#withGradleDistribution-java.net.URI-">GradleRunner.withGradleDistribution(java.net.URI)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This can potentially be used to test build logic across Gradle versions. The following demonstrates a cross-version compatibility test written as Groovy Spock test:</p>
</div>
<div class="sect4">
<h5 id="example_specifying_a_gradle_version_for_test_execution"><a class="anchor" href="#example_specifying_a_gradle_version_for_test_execution"></a><a class="link" href="#example_specifying_a_gradle_version_for_test_execution">Example: Specifying a Gradle version for test execution</a></h5>
<div class="listingblock">
<div class="title">BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.gradle.testkit.runner.GradleRunner</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.gradle.testkit.runner.TaskOutcome.*</span>
<span class="keyword">import</span> <span class="include">org.junit.Rule</span>
<span class="keyword">import</span> <span class="include">org.junit.rules.TemporaryFolder</span>
<span class="keyword">import</span> <span class="include">spock.lang.Specification</span>
<span class="keyword">import</span> <span class="include">spock.lang.Unroll</span>

<span class="type">class</span> <span class="class">BuildLogicFunctionalTest</span> <span class="directive">extends</span> Specification {
    <span class="annotation">@Rule</span> <span class="directive">final</span> TemporaryFolder testProjectDir = <span class="keyword">new</span> TemporaryFolder()
    <span class="predefined-type">File</span> buildFile

    <span class="keyword">def</span> <span class="function">setup</span>() {
        buildFile = testProjectDir.newFile(<span class="string"><span class="delimiter">'</span><span class="content">build.gradle</span><span class="delimiter">'</span></span>)
    }

    <span class="annotation">@Unroll</span>
    <span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">can execute hello world task with Gradle version #gradleVersion</span><span class="delimiter">&quot;</span></span>() {
        <span class="key">given</span>:
        buildFile &lt;&lt; <span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">
            task helloWorld {
                doLast {
                    logger.quiet 'Hello world!'
                }
            }
        </span><span class="delimiter">&quot;&quot;&quot;</span></span>

        <span class="key">when</span>:
        <span class="keyword">def</span> result = GradleRunner.create()
            .withGradleVersion(gradleVersion)
            .withProjectDir(testProjectDir.root)
            .withArguments(<span class="string"><span class="delimiter">'</span><span class="content">helloWorld</span><span class="delimiter">'</span></span>)
            .build()

        <span class="key">then</span>:
        result.output.contains(<span class="string"><span class="delimiter">'</span><span class="content">Hello world!</span><span class="delimiter">'</span></span>)
        result.task(<span class="string"><span class="delimiter">&quot;</span><span class="content">:helloWorld</span><span class="delimiter">&quot;</span></span>).outcome == SUCCESS

        <span class="key">where</span>:
        gradleVersion &lt;&lt; [<span class="string"><span class="delimiter">'</span><span class="content">2.6</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">2.7</span><span class="delimiter">'</span></span>]
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sub:test-kit-compatibility"><a class="anchor" href="#sub:test-kit-compatibility"></a><a class="link" href="#sub:test-kit-compatibility">Feature support when testing with different Gradle versions</a></h5>
<div class="paragraph">
<p>It is possible to use the GradleRunner to execute builds with Gradle 1.0 and later. However, some runner features are not supported on earlier versions. In such cases, the runner will throw an exception when attempting to use the feature.</p>
</div>
<div class="paragraph">
<p>The following table lists the features that are sensitive to the Gradle version being used.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 4. Gradle version compatibility</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">Minimum Version</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inspecting executed tasks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inspecting the executed tasks, using <a href="../javadoc/org/gradle/testkit/runner/BuildResult.html#getTasks--">BuildResult.getTasks()</a> and similar methods.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sub:test-kit-classpath-injection">Plugin classpath injection</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Injecting the code under test via<a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html#withPluginClasspath-java.lang.Iterable-">GradleRunner.withPluginClasspath(java.lang.Iterable)</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sub:test-kit-debug">Inspecting build output in debug mode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inspecting the build&#8217;s text output when run in debug mode, using <a href="../javadoc/org/gradle/testkit/runner/BuildResult.html#getOutput--">BuildResult.getOutput()</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#sub:test-kit-automatic-classpath-injection">Automatic plugin classpath injection</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Injecting the code under test automatically via <a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html#withPluginClasspath--">GradleRunner.withPluginClasspath()</a> by applying the Java Gradle Plugin Development plugin.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sub:test-kit-debug"><a class="anchor" href="#sub:test-kit-debug"></a><a class="link" href="#sub:test-kit-debug">Debugging build logic</a></h4>
<div class="paragraph">
<p>The runner uses the <a href="#embedding">Tooling API</a> to execute builds. An implication of this is that the builds are executed in a separate process (i.e. not the same process executing the tests). Therefore, executing your <em>tests</em> in debug mode does not allow you to debug your build logic as you may expect. Any breakpoints set in your IDE will be not be tripped by the code being exercised by the test build.</p>
</div>
<div class="paragraph">
<p>The TestKit provides two different ways to enable the debug mode:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Setting <code>org.gradle.testkit.debug</code> system property to <code>true</code> for the JVM <em>using</em> the <code>GradleRunner</code> (i.e. not the build being executed with the runner);</p>
</li>
<li>
<p>Calling the <a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html#withDebug-boolean-">GradleRunner.withDebug(boolean)</a> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The system property approach can be used when it is desirable to enable debugging support without making an adhoc change to the runner configuration. Most IDEs offer the capability to set JVM system properties for test execution, and such a feature can be used to set this system property.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:test-kit-build-cache"><a class="anchor" href="#sub:test-kit-build-cache"></a><a class="link" href="#sub:test-kit-build-cache">Testing with the Build Cache</a></h4>
<div class="paragraph">
<p>To enable the <a href="#build_cache">Build Cache</a> in your tests, you can pass the <code>--build-cache</code> argument to <a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html">GradleRunner</a> or use one of the other methods described in <a href="#sec:build_cache_enable">Enable the build cache</a>. You can then check for the task outcome <a href="../javadoc/org/gradle/testkit/runner/TaskOutcome.html#FROM_CACHE">TaskOutcome.FROM_CACHE</a> when your plugin&#8217;s custom task is cached. This outcome is only valid for Gradle 3.5 and newer.</p>
</div>
<div class="sect4">
<h5 id="example_testing_cacheable_tasks"><a class="anchor" href="#example_testing_cacheable_tasks"></a><a class="link" href="#example_testing_cacheable_tasks">Example: Testing cacheable tasks</a></h5>
<div class="listingblock">
<div class="title">BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">cacheableTask is loaded from cache</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">given</span>:
    buildFile &lt;&lt; <span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">
        plugins {
            id 'org.gradle.sample.helloworld'
        }
    </span><span class="delimiter">&quot;&quot;&quot;</span></span>

    <span class="key">when</span>:
    <span class="keyword">def</span> result = runner()
        .withArguments( <span class="string"><span class="delimiter">'</span><span class="content">--build-cache</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">cacheableTask</span><span class="delimiter">'</span></span>)
        .build()

    <span class="key">then</span>:
    result.task(<span class="string"><span class="delimiter">&quot;</span><span class="content">:cacheableTask</span><span class="delimiter">&quot;</span></span>).outcome == SUCCESS

    <span class="key">when</span>:
    <span class="keyword">new</span> <span class="predefined-type">File</span>(testProjectDir.root, <span class="string"><span class="delimiter">'</span><span class="content">build</span><span class="delimiter">'</span></span>).deleteDir()
    result = runner()
        .withArguments( <span class="string"><span class="delimiter">'</span><span class="content">--build-cache</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">cacheableTask</span><span class="delimiter">'</span></span>)
        .build()

    <span class="key">then</span>:
    result.task(<span class="string"><span class="delimiter">&quot;</span><span class="content">:cacheableTask</span><span class="delimiter">&quot;</span></span>).outcome == FROM_CACHE
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that TestKit re-uses a Gradle user home between tests (see <a href="../javadoc/org/gradle/testkit/runner/GradleRunner.html#withTestKitDir-java.io.File-">GradleRunner.withTestKitDir(java.io.File)</a>) which contains the default location for the local build cache.
For testing with the build cache, the build cache directory should be cleaned between tests.
The easiest way to accomplish this is to configure the local build cache to use a temporary directory.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_clean_build_cache_between_tests"><a class="anchor" href="#example_clean_build_cache_between_tests"></a><a class="link" href="#example_clean_build_cache_between_tests">Example: Clean build cache between tests</a></h5>
<div class="listingblock">
<div class="title">BuildLogicFunctionalTest.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Rule</span> <span class="directive">final</span> TemporaryFolder testProjectDir = <span class="keyword">new</span> TemporaryFolder()
<span class="predefined-type">File</span> buildFile
<span class="predefined-type">File</span> localBuildCacheDirectory

<span class="keyword">def</span> <span class="function">setup</span>() {
    localBuildCacheDirectory = testProjectDir.newFolder(<span class="string"><span class="delimiter">'</span><span class="content">local-cache</span><span class="delimiter">'</span></span>)
    testProjectDir.newFile(<span class="string"><span class="delimiter">'</span><span class="content">settings.gradle</span><span class="delimiter">'</span></span>) &lt;&lt; <span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">
        buildCache {
            local {
                directory '</span><span class="inline"><span class="inline-delimiter">${</span>localBuildCacheDirectory.toURI()<span class="inline-delimiter">}</span></span><span class="content">'
            }
        }
    </span><span class="delimiter">&quot;&quot;&quot;</span></span>
    buildFile = testProjectDir.newFile(<span class="string"><span class="delimiter">'</span><span class="content">build.gradle</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="plugins"><a class="anchor" href="#plugins"></a><a class="link" href="#plugins">Using Gradle Plugins</a></h3>
<div class="paragraph">
<p>Gradle at its core intentionally provides very little for real world automation. All of the useful features, like the ability to compile Java code, are added by <em>plugins</em>. Plugins add new tasks (e.g. <a href="../dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a>), domain objects (e.g. <a href="../dsl/org.gradle.api.tasks.SourceSet.html">SourceSet</a>), conventions (e.g. Java source is located at <code>src/main/java</code>) as well as extending core objects and objects from other plugins.</p>
</div>
<div class="paragraph">
<p>In this chapter we discuss how to use plugins and the terminology and concepts surrounding plugins.</p>
</div>
<div class="sect3">
<h4 id="sec:what_plugins_do"><a class="anchor" href="#sec:what_plugins_do"></a><a class="link" href="#sec:what_plugins_do">What plugins do</a></h4>
<div class="paragraph">
<p>Applying a plugin to a project allows the plugin to extend the project&#8217;s capabilities. It can do things such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Extend the Gradle model (e.g. add new DSL elements that can be configured)</p>
</li>
<li>
<p>Configure the project according to conventions (e.g. add new tasks or configure sensible defaults)</p>
</li>
<li>
<p>Apply specific configuration (e.g. add organizational repositories or enforce standards)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By applying plugins, rather than adding logic to the project build script, we can reap a number of benefits. Applying plugins:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Promotes reuse and reduces the overhead of maintaining similar logic across multiple projects</p>
</li>
<li>
<p>Allows a higher degree of modularization, enhancing comprehensibility and organization</p>
</li>
<li>
<p>Encapsulates imperative logic and allows build scripts to be as declarative as possible</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:types_of_plugins"><a class="anchor" href="#sec:types_of_plugins"></a><a class="link" href="#sec:types_of_plugins">Types of plugins</a></h4>
<div class="paragraph">
<p>There are two general types of plugins in Gradle, <em>script</em> plugins and <em>binary</em> plugins. Script plugins are additional build scripts that further configure the build and usually implement a declarative approach to manipulating the build. They are typically used within a build although they can be externalized and accessed from a remote location. Binary plugins are classes that implement the <a href="../javadoc/org/gradle/api/Plugin.html">Plugin</a> interface and adopt a programmatic approach to manipulating the build. Binary plugins can reside within a build script, within the project hierarchy or externally in a plugin jar.</p>
</div>
<div class="paragraph">
<p>A plugin often starts out as a script plugin (because they are easy to write) and then, as the code becomes more valuable, it&#8217;s migrated to a binary plugin that can be easily tested and shared between multiple projects or organizations.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:using_plugins"><a class="anchor" href="#sec:using_plugins"></a><a class="link" href="#sec:using_plugins">Using plugins</a></h4>
<div class="paragraph">
<p>To use the build logic encapsulated in a plugin, Gradle needs to perform two steps. First, it needs to <em>resolve</em> the plugin, and then it needs to <em>apply</em> the plugin to the target, usually a <a href="../dsl/org.gradle.api.Project.html">Project</a>.</p>
</div>
<div class="paragraph">
<p><em>Resolving</em> a plugin means finding the correct version of the jar which contains a given plugin and adding it the script classpath. Once a plugin is resolved, its API can be used in a build script. Script plugins are self-resolving in that they are resolved from the specific file path or URL provided when applying them. Core binary plugins provided as part of the Gradle distribution are automatically resolved.</p>
</div>
<div class="paragraph">
<p><em>Applying</em> a plugin means actually executing the plugin&#8217;s <a href="../javadoc/org/gradle/api/Plugin.html#apply-T-">Plugin.apply(T)</a> on the Project you want to enhance with the plugin. Applying plugins is <em>idempotent</em>. That is, you can safely apply any plugin multiple times without side effects.</p>
</div>
<div class="paragraph">
<p>The most common use case for using a plugin is to both resolve the plugin and apply it to the current project. Since this is such a common use case, it&#8217;s recommended that build authors use the <a href="#sec:plugins_block">plugins DSL</a> to both resolve and apply plugins in one step. The feature is technically still incubating, but it works well, and should be used by most users.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:script_plugins"><a class="anchor" href="#sec:script_plugins"></a><a class="link" href="#sec:script_plugins">Script plugins</a></h4>
<div class="sect4">
<h5 id="example_applying_a_script_plugin"><a class="anchor" href="#example_applying_a_script_plugin"></a><a class="link" href="#example_applying_a_script_plugin">Example: Applying a script plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">from</span>: <span class="string"><span class="delimiter">'</span><span class="content">other.gradle</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Script plugins are automatically resolved and can be applied from a script on the local filesystem or at a remote location. Filesystem locations are relative to the project directory, while remote script locations are specified with an HTTP URL. Multiple script plugins (of either form) can be applied to a given target.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:binary_plugins"><a class="anchor" href="#sec:binary_plugins"></a><a class="link" href="#sec:binary_plugins">Binary plugins</a></h4>
<div class="paragraph">
<p>You apply plugins by their <em>plugin id</em>, which is a globally unique identifier, or name, for plugins. Core Gradle plugins are special in that they provide short names, such as <code>'java'</code> for the core <a href="../javadoc/org/gradle/api/plugins/JavaPlugin.html">JavaPlugin</a>. All other binary plugins must use the fully qualified form of the plugin id (e.g. <code>com.github.foo.bar</code>), although some legacy plugins may still utilize a short, unqualified form. Where you put the plugin id depends on whether you are using the <a href="#sec:plugins_block">plugins DSL</a> or the <a href="#sec:old_plugin_application">buildscript block.</a></p>
</div>
<div class="sect4">
<h5 id="sec:binary_plugin_locations"><a class="anchor" href="#sec:binary_plugin_locations"></a><a class="link" href="#sec:binary_plugin_locations">Locations of binary plugins</a></h5>
<div class="paragraph">
<p>A plugin is simply any class that implements the <a href="../javadoc/org/gradle/api/Plugin.html">Plugin</a> interface. Gradle provides the core plugins (e.g. <code>JavaPlugin</code>) as part of its distribution which means they are automatically resolved. However, non-core binary plugins need to be resolved before they can be applied. This can be achieved in a number of ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Including the plugin from the plugin portal or a <a href="#sec:custom_plugin_repositories">custom repository</a> using the plugins DSL (see <a href="#sec:plugins_block">Applying plugins using the plugins DSL</a>).</p>
</li>
<li>
<p>Including the plugin from an external jar defined as a buildscript dependency (see see <a href="#sec:applying_plugins_buildscript">Applying plugins using the buildscript block</a>).</p>
</li>
<li>
<p>Defining the plugin as a source file under the buildSrc directory in the project (see <a href="#sec:build_sources">Using buildSrc to extract functional logic</a>).</p>
</li>
<li>
<p>Defining the plugin as an inline class declaration inside a build script.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more on defining your own plugins, see <a href="#custom_plugins">Custom Plugins</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:plugins_block"><a class="anchor" href="#sec:plugins_block"></a><a class="link" href="#sec:plugins_block">Applying plugins with the plugins DSL</a></h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The plugins DSL is currently <a href="#feature_lifecycle">incubating</a>. Please be aware that the DSL and other configuration may change in later Gradle versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The new plugins DSL provides a succinct and convenient way to declare plugin dependencies. It works with the <a href="http://plugins.gradle.org">Gradle plugin portal</a> to provide easy access to both core and community plugins. The plugins DSL block configures an instance of <a href="../javadoc/org/gradle/plugin/use/PluginDependenciesSpec.html">PluginDependenciesSpec</a>.</p>
</div>
<div class="paragraph">
<p>To apply a core plugin, the short name can be used:</p>
</div>
<div class="sect5">
<h6 id="example_applying_a_core_plugin"><a class="anchor" href="#example_applying_a_core_plugin"></a><a class="link" href="#example_applying_a_core_plugin">Example: Applying a core plugin</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To apply a community plugin from the portal, the fully qualified plugin id must be used:</p>
</div>
</div>
<div class="sect5">
<h6 id="example_applying_a_community_plugin"><a class="anchor" href="#example_applying_a_community_plugin"></a><a class="link" href="#example_applying_a_community_plugin">Example: Applying a community plugin</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">com.jfrog.bintray</span><span class="delimiter">'</span></span> version <span class="string"><span class="delimiter">'</span><span class="content">0.4.1</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="../javadoc/org/gradle/plugin/use/PluginDependenciesSpec.html">PluginDependenciesSpec</a> for more information on using the Plugin DSL.</p>
</div>
</div>
<div class="sect5">
<h6 id="plugins_dsl_limitations"><a class="anchor" href="#plugins_dsl_limitations"></a><a class="link" href="#plugins_dsl_limitations">Limitations of the plugins DSL</a></h6>
<div class="paragraph">
<p>This way of adding plugins to a project is much more than a more convenient syntax. The plugins DSL is processed in a way which allows Gradle to determine the plugins in use very early and very quickly. This allows Gradle to do smart things such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Optimize the loading and reuse of plugin classes.</p>
</li>
<li>
<p>Allow different plugins to use different versions of dependencies.</p>
</li>
<li>
<p>Provide editors detailed information about the potential properties and values in the buildscript for editing assistance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This requires that plugins be specified in a way that Gradle can easily and quickly extract, before executing the rest of the build script. It also requires that the definition of plugins to use be somewhat static.</p>
</div>
<div class="paragraph">
<p>There are some key differences between the new plugin mechanism and the traditional <code>apply()</code> method mechanism. There are also some constraints, some of which are temporary limitations while the mechanism is still being developed and some are inherent to the new approach.</p>
</div>
<div class="sect6">
<h7 id="sec:constrained_syntax"><a class="anchor" href="#sec:constrained_syntax"></a><a class="link" href="#sec:constrained_syntax">Constrained Syntax</a></h7>
<div class="paragraph">
<p>The new <code>plugins {}</code> block does not support arbitrary Groovy code. It is constrained, in order to be idempotent (produce the same result every time) and side effect free (safe for Gradle to execute at any time).</p>
</div>
<div class="paragraph">
<p>The form is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="error"></span>plugin id<span class="error"></span> version <span class="error"></span>plugin version<span class="error"></span> [apply <span class="error"></span><span class="predefined-constant">false</span><span class="error"></span>]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>plugin version</code> and <code>plugin id</code> must be constant, literal, strings and the <code>apply</code> statement with a <code>boolean</code> can be used to disable the default behavior of applying the plugin immediately (e.g. you want to apply it only in <code>subprojects</code>). No other statements are allowed; their presence will cause a compilation error.</p>
</div>
<div class="paragraph">
<p>The <code>plugins {}</code> block must also be a top level statement in the buildscript. It cannot be nested inside another construct (e.g. an if-statement or for-loop).</p>
</div>
</div>
<div class="sect6">
<h7 id="sec:build_scripts_only"><a class="anchor" href="#sec:build_scripts_only"></a><a class="link" href="#sec:build_scripts_only">Can only be used in build scripts</a></h7>
<div class="paragraph">
<p>The <code>plugins {}</code> block can currently only be used in a project&#8217;s build script. It cannot be used in script plugins, the settings.gradle file or init scripts.</p>
</div>
<div class="paragraph">
<p><em>Future versions of Gradle will remove this restriction.</em></p>
</div>
<div class="paragraph">
<p>If the restrictions of the new syntax are prohibitive, the recommended approach is to apply plugins using the <a href="#sec:applying_plugins_buildscript">buildscript {} block</a>.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:subprojects_plugins_dsl"><a class="anchor" href="#sec:subprojects_plugins_dsl"></a><a class="link" href="#sec:subprojects_plugins_dsl">Applying plugins to subprojects</a></h6>
<div class="paragraph">
<p>If you have a <a href="#multi_project_builds">multi-project build</a>, you probably want to apply plugins to some or all of the subprojects in your build, but not to the <code>root</code> or <code>master</code> project. The default behavior of the <code>plugins {}</code> block is to immediately <code>resolve</code> <em>and</em>  <code>apply</code> the plugins. But, you can use the <code>apply false</code> syntax to tell Gradle not to apply the plugin to the current project and then use <code>apply plugin: plugin id</code> in the <code>subprojects</code> block:</p>
</div>
<div class="sect6">
<h7 id="example_applying_plugins_only_on_certain_subprojects"><a class="anchor" href="#example_applying_plugins_only_on_certain_subprojects"></a><a class="link" href="#example_applying_plugins_only_on_certain_subprojects">Example: Applying plugins only on certain subprojects.</a></h7>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">include <span class="string"><span class="delimiter">'</span><span class="content">helloA</span><span class="delimiter">'</span></span>
include <span class="string"><span class="delimiter">'</span><span class="content">helloB</span><span class="delimiter">'</span></span>
include <span class="string"><span class="delimiter">'</span><span class="content">goodbyeC</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
  id <span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.sample.hello</span><span class="delimiter">&quot;</span></span> version <span class="string"><span class="delimiter">&quot;</span><span class="content">1.0.0</span><span class="delimiter">&quot;</span></span> apply <span class="predefined-constant">false</span>
  id <span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.sample.goodbye</span><span class="delimiter">&quot;</span></span> version <span class="string"><span class="delimiter">&quot;</span><span class="content">1.0.0</span><span class="delimiter">&quot;</span></span> apply <span class="predefined-constant">false</span>
}

subprojects { subproject -&gt;
    <span class="keyword">if</span> (subproject.name.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>)) {
        apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample.hello</span><span class="delimiter">'</span></span>
    }
    <span class="keyword">if</span> (subproject.name.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">goodbye</span><span class="delimiter">&quot;</span></span>)) {
        apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample.goodbye</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you then run <code>gradle hello</code> you&#8217;ll see that only the helloA and helloB subprojects had the hello plugin applied.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gradle/subprojects/docs/src/samples/plugins/multiproject $&gt; gradle hello
Parallel execution is an incubating feature.
:helloA:hello
:helloB:hello
Hello!
Hello!

BUILD SUCCEEDED</pre>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:buildsrc_plugins_dsl"><a class="anchor" href="#sec:buildsrc_plugins_dsl"></a><a class="link" href="#sec:buildsrc_plugins_dsl">Applying plugins from the <em>buildSrc</em> directory</a></h6>
<div class="paragraph">
<p>You can apply plugins that reside in a project&#8217;s <em>buildSrc</em> directory as long as they have a defined ID. The following example shows how to tie a plugin implementation class  <code>my.MyPlugin</code>  defined in <em>buildSrc</em> to the ID "my-plugin":</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. Defining a buildSrc plugin with an ID</div>
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">buildSrc/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
    id <span class="string"><span class="delimiter">'</span><span class="content">java-gradle-plugin</span><span class="delimiter">'</span></span>
}

gradlePlugin {
    plugins {
        myPlugins {
            id = <span class="string"><span class="delimiter">'</span><span class="content">my-plugin</span><span class="delimiter">'</span></span>
            implementationClass = <span class="string"><span class="delimiter">'</span><span class="content">my.MyPlugin</span><span class="delimiter">'</span></span>
        }
    }
}

dependencies {
    compileOnly gradleApi()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The plugin can then be applied by ID as normal:</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Applying a plugin from buildSrc</div>
<div class="content">
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">my-plugin</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:plugin_management"><a class="anchor" href="#sec:plugin_management"></a><a class="link" href="#sec:plugin_management">Plugin Management</a></h6>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>pluginManagement {}</code> DSL is currently <a href="#feature_lifecycle">incubating</a>. Please be aware that the DSL and other configuration may change in later Gradle versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>pluginManagement {}</code> block may only appear in either the <code>settings.gradle</code> file, where it must be the first block in the file, or in an <a href="#init_scripts">Initialization Script</a>.</p>
</div>
<div class="sect6">
<h7 id="example_configuring_pluginmanagement_per_project_and_globally"><a class="anchor" href="#example_configuring_pluginmanagement_per_project_and_globally"></a><a class="link" href="#example_configuring_pluginmanagement_per_project_and_globally">Example: Configuring pluginManagement per-project and globally</a></h7>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">pluginManagement {
    resolutionStrategy {
    }
    repositories {
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">init.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">settingsEvaluated { settings -&gt;
    settings.pluginManagement {
        resolutionStrategy {
        }
        repositories {
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect6">
<h7 id="sec:custom_plugin_repositories"><a class="anchor" href="#sec:custom_plugin_repositories"></a><a class="link" href="#sec:custom_plugin_repositories">Custom Plugin Repositories</a></h7>
<div class="paragraph">
<p>By default, the <code>plugins {}</code> DSL resolves plugins from the public <a href="https://plugins.gradle.org">Gradle Plugin Portal.</a> Many build authors would also like to resolve plugins from private Maven or Ivy repositories because the plugins contain proprietary implementation details, or just to have more control over what plugins are available to their builds.</p>
</div>
<div class="paragraph">
<p>To specify custom plugin repositories, use the <code>repositories {}</code> block inside <code>pluginManagement {}</code>:</p>
</div>
<div class="sect7">
<h8 id="example_using_plugins_from_custom_plugin_repositories"><a class="anchor" href="#example_using_plugins_from_custom_plugin_repositories"></a><a class="link" href="#example_using_plugins_from_custom_plugin_repositories">Example: Using plugins from custom plugin repositories.</a></h8>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">pluginManagement {
  repositories {
      maven {
        url <span class="string"><span class="delimiter">'</span><span class="content">maven-repo</span><span class="delimiter">'</span></span>
      }
      gradlePluginPortal()
      ivy {
        url <span class="string"><span class="delimiter">'</span><span class="content">ivy-repo</span><span class="delimiter">'</span></span>
      }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This tells Gradle to first look in the Maven repository at <code>maven-repo</code> when resolving plugins and then to check the Gradle Plugin Portal if the plugins are not found in the Maven repository. If you don&#8217;t want the Gradle Plugin Portal to be searched, omit the <code>gradlePluginPortal()</code> line. Finally, the Ivy repository at <code>ivy-repo</code> will be checked.</p>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:plugin_resolution_rules"><a class="anchor" href="#sec:plugin_resolution_rules"></a><a class="link" href="#sec:plugin_resolution_rules">Plugin Resolution Rules</a></h6>
<div class="paragraph">
<p>Plugin resolution rules allow you to modify plugin requests made in <code>plugins {}</code> blocks, e.g. changing the requested version or explicitly specifying the implementation artifact coordinates.</p>
</div>
<div class="paragraph">
<p>To add resolution rules, use the <code>resolutionStrategy {}</code> inside the <code>pluginManagement {}</code> block:</p>
</div>
<div class="sect6">
<h7 id="example_plugin_resolution_strategy"><a class="anchor" href="#example_plugin_resolution_strategy"></a><a class="link" href="#example_plugin_resolution_strategy">Example: Plugin resolution strategy.</a></h7>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">pluginManagement {
  resolutionStrategy {
      eachPlugin {
          <span class="keyword">if</span> (requested.id.namespace == <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample</span><span class="delimiter">'</span></span>) {
              useModule(<span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample:sample-plugins:1.0.0</span><span class="delimiter">'</span></span>)
          }
      }
  }
  repositories {
      maven {
        url <span class="string"><span class="delimiter">'</span><span class="content">maven-repo</span><span class="delimiter">'</span></span>
      }
      gradlePluginPortal()
      ivy {
        url <span class="string"><span class="delimiter">'</span><span class="content">ivy-repo</span><span class="delimiter">'</span></span>
      }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This tells Gradle to use the specified plugin implementation artifact instead of using its built-in default mapping from plugin ID to Maven/Ivy coordinates.</p>
</div>
<div class="paragraph">
<p>Custom Maven and Ivy plugin repositories must contain <a href="#sec:plugin_markers">plugin marker artifacts</a> in addition to the artifacts which actually implement the plugin. For more information on publishing plugins to custom repositories read <a href="#java_gradle_plugin">Gradle Plugin Development Plugin</a>.</p>
</div>
<div class="paragraph">
<p>See <a href="../javadoc/org/gradle/plugin/management/PluginManagementSpec.html">PluginManagementSpec</a> for complete documentation for using the <code>pluginManagement {}</code> block.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:plugin_markers"><a class="anchor" href="#sec:plugin_markers"></a><a class="link" href="#sec:plugin_markers">Plugin Marker Artifacts</a></h6>
<div class="paragraph">
<p>Since the <code>plugins {}</code> DSL block only allows for declaring plugins by their globally unique plugin <code>id</code> and <code>version</code> properties, Gradle needs a way to look up the coordinates of the plugin implementation artifact. To do so, Gradle will look for a Plugin Marker Artifact with the coordinates <code>plugin.id:plugin.id.gradle.plugin:plugin.version</code>. This marker needs to have a dependency on the actual plugin implementation. Publishing these markers is automated by the <a href="#java_gradle_plugin">java-gradle-plugin</a>.</p>
</div>
<div class="paragraph">
<p>For example, the following complete sample from the <code>sample-plugins</code> project shows how to publish a <code>org.gradle.sample.hello</code> plugin and a <code>org.gradle.sample.goodbye</code> plugin to both an Ivy and Maven repository using the combination of the <a href="#java_gradle_plugin">java-gradle-plugin</a>, the <a href="#publishing_maven">maven-publish</a> plugin, and the <a href="#publishing_ivy">ivy-publish</a> plugin.</p>
</div>
<div class="sect6">
<h7 id="example_complete_plugin_publishing_sample"><a class="anchor" href="#example_complete_plugin_publishing_sample"></a><a class="link" href="#example_complete_plugin_publishing_sample">Example: Complete Plugin Publishing Sample</a></h7>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
  id <span class="string"><span class="delimiter">'</span><span class="content">java-gradle-plugin</span><span class="delimiter">'</span></span>
  id <span class="string"><span class="delimiter">'</span><span class="content">maven-publish</span><span class="delimiter">'</span></span>
  id <span class="string"><span class="delimiter">'</span><span class="content">ivy-publish</span><span class="delimiter">'</span></span>
}

group <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample</span><span class="delimiter">'</span></span>
version <span class="string"><span class="delimiter">'</span><span class="content">1.0.0</span><span class="delimiter">'</span></span>

gradlePlugin {
  plugins {
    hello {
      id = <span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.sample.hello</span><span class="delimiter">&quot;</span></span>
      implementationClass = <span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.sample.hello.HelloPlugin</span><span class="delimiter">&quot;</span></span>
    }
    goodbye {
      id = <span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.sample.goodbye</span><span class="delimiter">&quot;</span></span>
      implementationClass = <span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.sample.goodbye.GoodbyePlugin</span><span class="delimiter">&quot;</span></span>
    }
  }
}

publishing {
  repositories {
    maven {
      url <span class="string"><span class="delimiter">&quot;</span><span class="content">../consuming/maven-repo</span><span class="delimiter">&quot;</span></span>
    }
    ivy {
      url <span class="string"><span class="delimiter">&quot;</span><span class="content">../consuming/ivy-repo</span><span class="delimiter">&quot;</span></span>
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running <code>gradle publish</code> in the sample directory causes the following repo layouts to exist:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/pluginMarkers.png" alt="pluginMarkers">
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:old_plugin_application"><a class="anchor" href="#sec:old_plugin_application"></a><a class="link" href="#sec:old_plugin_application">Legacy Plugin Application</a></h5>
<div class="paragraph">
<p>With the introduction of the <a href="#sec:plugins_block">plugins DSL</a>, users should have little reason to use the legacy method of applying plugins. It is documented here in case a build author cannot use the plugins DSL due to restrictions in how it currently works.</p>
</div>
<div class="sect5">
<h6 id="sec:applying_binary_plugins"><a class="anchor" href="#sec:applying_binary_plugins"></a><a class="link" href="#sec:applying_binary_plugins">Applying Binary Plugins</a></h6>
<div class="sect6">
<h7 id="example_applying_a_binary_plugin"><a class="anchor" href="#example_applying_a_binary_plugin"></a><a class="link" href="#example_applying_a_binary_plugin">Example: Applying a binary plugin</a></h7>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Plugins can be applied using a <em>plugin id</em>. In the above case, we are using the short name <code>java</code> to apply the <a href="../javadoc/org/gradle/api/plugins/JavaPlugin.html">JavaPlugin</a>.</p>
</div>
<div class="paragraph">
<p>Rather than using a plugin id, plugins can also be applied by simply specifying the class of the plugin:</p>
</div>
</div>
<div class="sect6">
<h7 id="example_applying_a_binary_plugin_by_type"><a class="anchor" href="#example_applying_a_binary_plugin_by_type"></a><a class="link" href="#example_applying_a_binary_plugin_by_type">Example: Applying a binary plugin by type</a></h7>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: JavaPlugin</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>JavaPlugin</code> symbol in the above sample refers to the <a href="../javadoc/org/gradle/api/plugins/JavaPlugin.html">JavaPlugin</a>. This class does not strictly need to be imported as the <code>org.gradle.api.plugins</code> package is automatically imported in all build scripts (see <a href="#script-default-imports">Default imports</a>). Furthermore, it is not necessary to append <code>.class</code> to identify a class literal in Groovy as it is in Java.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="sec:applying_plugins_buildscript"><a class="anchor" href="#sec:applying_plugins_buildscript"></a><a class="link" href="#sec:applying_plugins_buildscript">Applying plugins with the buildscript block</a></h6>
<div class="paragraph">
<p>Binary plugins that have been published as external jar files can be added to a project by adding the plugin to the build script classpath and then applying the plugin. External jars can be added to the build script classpath using the <code>buildscript {}</code> block as described in <a href="#sec:build_script_external_dependencies">External dependencies for the build script</a>.</p>
</div>
<div class="sect6">
<h7 id="example_applying_a_plugin_with_the_buildscript_block"><a class="anchor" href="#example_applying_a_plugin_with_the_buildscript_block"></a><a class="link" href="#example_applying_a_plugin_with_the_buildscript_block">Example: Applying a plugin with the buildscript block</a></h7>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath <span class="string"><span class="delimiter">&quot;</span><span class="content">com.jfrog.bintray.gradle:gradle-bintray-plugin:0.4.1</span><span class="delimiter">&quot;</span></span>
    }
}

apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">com.jfrog.bintray</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:finding_community_plugins"><a class="anchor" href="#sec:finding_community_plugins"></a><a class="link" href="#sec:finding_community_plugins">Finding community plugins</a></h4>
<div class="paragraph">
<p>Gradle has a vibrant community of plugin developers who contribute plugins for a wide variety of capabilities. The Gradle <a href="https://plugins.gradle.org">plugin portal</a> provides an interface for searching and exploring community plugins.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:more_on_plugins"><a class="anchor" href="#sec:more_on_plugins"></a><a class="link" href="#sec:more_on_plugins">More on plugins</a></h4>
<div class="paragraph">
<p>This chapter aims to serve as an introduction to plugins and Gradle and the role they play. For more information on the inner workings of plugins, see <a href="#custom_plugins">Custom Plugins</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="working_with_files"><a class="anchor" href="#working_with_files"></a><a class="link" href="#working_with_files">Working With Files</a></h3>
<div class="paragraph">
<p>Almost every Gradle build interacts with files in some way: think source files, file dependencies, reports and so on. That&#8217;s why Gradle comes with a comprehensive API that makes it simple to perform the file operations you need.</p>
</div>
<div class="paragraph">
<p>The API has two parts to it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specifying which files and directories to process</p>
</li>
<li>
<p>Specifying what to do with them</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <a href="#sec:locating_files">File paths in depth</a> section covers the first of these in detail, while subsequent sections, like <a href="#sec:copying_files">File copying in depth</a>, cover the second. To begin with, we&#8217;ll show you examples of the most common scenarios that users encounter.</p>
</div>
<div class="sect3">
<h4 id="sec:copying_single_file_example"><a class="anchor" href="#sec:copying_single_file_example"></a><a class="link" href="#sec:copying_single_file_example">Copying a single file</a></h4>
<div class="paragraph">
<p>You copy a file by creating an instance of Gradle&#8217;s builtin <a href="../dsl/org.gradle.api.tasks.Copy.html">Copy</a> task and configuring it with the location of the file and where you want to put it. This example mimics copying a generated report into a directory that will be packed into an archive, such as a ZIP or TAR:</p>
</div>
<div class="sect4">
<h5 id="example_how_to_copy_a_single_file"><a class="anchor" href="#example_how_to_copy_a_single_file"></a><a class="link" href="#example_how_to_copy_a_single_file">Example: How to copy a single file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyReport(<span class="key">type</span>: Copy) {
    from file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/reports/my-report.pdf</span><span class="delimiter">&quot;</span></span>)
    into file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a> method is used to create a file or directory path relative to the current project and is a common way to make build scripts work regardless of the project path. The file and directory paths are then used to specify what file to copy using <a href="../dsl/org.gradle.api.tasks.Copy.html#org.gradle.api.tasks.Copy:from(java.lang.Object[])">Copy.from(java.lang.Object&#8230;&#8203;)</a> and which directory to copy it to using <a href="../dsl/org.gradle.api.tasks.Copy.html#org.gradle.api.tasks.Copy:into(java.lang.Object)">Copy.into(java.lang.Object)</a>.</p>
</div>
<div class="paragraph">
<p>You can even use the path directly without the <code>file()</code> method, as explained early in the section <a href="#sec:copying_files">File copying in depth</a>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_implicit_string_paths"><a class="anchor" href="#example_using_implicit_string_paths"></a><a class="link" href="#example_using_implicit_string_paths">Example: Using implicit string paths</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyReport2(<span class="key">type</span>: Copy) {
    from <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/reports/my-report.pdf</span><span class="delimiter">&quot;</span></span>
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Although hard-coded paths make for simple examples, they also make the build brittle. It&#8217;s better to use a reliable, single source of truth, such as a task or shared project property. In the following modified example, we use a report task defined elsewhere that has the report&#8217;s location stored in its <code>outputFile</code> property:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_prefer_taskproject_properties_over_hard_coded_paths"><a class="anchor" href="#example_prefer_taskproject_properties_over_hard_coded_paths"></a><a class="link" href="#example_prefer_taskproject_properties_over_hard_coded_paths">Example: Prefer task/project properties over hard-coded paths</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyReport3(<span class="key">type</span>: Copy) {
    from myReportTask.outputFile
    into archiveReportsTask.dirToArchive
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We have also assumed that the reports will be archived by <code>archiveReportsTask</code>, which provides us with the directory that will be archived and hence where we want to put the copies of the reports.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:copying_multiple_files_example"><a class="anchor" href="#sec:copying_multiple_files_example"></a><a class="link" href="#sec:copying_multiple_files_example">Copying multiple files</a></h4>
<div class="paragraph">
<p>You can extend the previous examples to multiple files very easily by providing multiple arguments to <code>from()</code>:</p>
</div>
<div class="sect4">
<h5 id="example_using_multiple_arguments_with_from"><a class="anchor" href="#example_using_multiple_arguments_with_from"></a><a class="link" href="#example_using_multiple_arguments_with_from">Example: Using multiple arguments with from()</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyReportsForArchiving(<span class="key">type</span>: Copy) {
    from <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/reports/my-report.pdf</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">src/docs/manual.pdf</span><span class="delimiter">&quot;</span></span>
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Two files are now copied into the archive directory. You can also use multiple <code>from()</code> statements to do the same thing, as shown in the first example of the section <a href="#sec:copying_files">File copying in depth</a>.</p>
</div>
<div class="paragraph">
<p>Now consider another example: what if you want to copy all the PDFs in a directory without having to specify each one? To do this, attach inclusion and/or exclusion patterns to the copy specification. Here we use a string pattern to include PDFs only:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_a_flat_filter"><a class="anchor" href="#example_using_a_flat_filter"></a><a class="link" href="#example_using_a_flat_filter">Example: Using a flat filter</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyPdfReportsForArchiving(<span class="key">type</span>: Copy) {
    from <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/reports</span><span class="delimiter">&quot;</span></span>
    include <span class="string"><span class="delimiter">&quot;</span><span class="content">*.pdf</span><span class="delimiter">&quot;</span></span>
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>One thing to note, as demonstrated in the following diagram, is that only the PDFs that reside directly in the <code>reports</code> directory are copied:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/copy-with-flat-filter-example.png" alt="copy with flat filter example">
</div>
<div class="title">Figure 8. The effect of a flat filter on copying</div>
</div>
<div class="paragraph">
<p>You can include files in subdirectories by using an Ant-style glob pattern (<code>**/*</code>), as done in this updated example:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_a_deep_filter"><a class="anchor" href="#example_using_a_deep_filter"></a><a class="link" href="#example_using_a_deep_filter">Example: Using a deep filter</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyAllPdfReportsForArchiving(<span class="key">type</span>: Copy) {
    from <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/reports</span><span class="delimiter">&quot;</span></span>
    include <span class="string"><span class="delimiter">&quot;</span><span class="content">**/*.pdf</span><span class="delimiter">&quot;</span></span>
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This task has the following effect:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/copy-with-deep-filter-example.png" alt="copy with deep filter example">
</div>
<div class="title">Figure 9. The effect of a deep filter on copying</div>
</div>
<div class="paragraph">
<p>One thing to bear in mind is that a deep filter like this has the side effect of copying the directory structure below <code>reports</code> as well as the files. If you just want to copy the files without the directory structure, you need to use an explicit <code>fileTree(<em>dir</em>) { <em>includes</em> }.files</code> expression. We talk more about the difference between file trees and file collections in the <a href="#sec:file_trees">File trees</a> section.</p>
</div>
<div class="paragraph">
<p>This is just one of the variations in behavior you&#8217;re likely to come across when dealing with file operations in Gradle builds. Fortunately, Gradle provides elegant solutions to almost all those use cases. Read the <em>in-depth</em> sections later in the chapter for more detail on how the file operations work in Gradle and what options you have for configuring them.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:copying_directories_example"><a class="anchor" href="#sec:copying_directories_example"></a><a class="link" href="#sec:copying_directories_example">Copying directory hierarchies</a></h4>
<div class="paragraph">
<p>You may have a need to copy not just files, but the directory structure they reside in as well. This is the default behavior when you specify a directory as the <code>from()</code> argument, as demonstrated by the following example that copies everything in the <code>reports</code> directory, including all its subdirectories, to the destination:</p>
</div>
<div class="sect4">
<h5 id="example_copying_an_entire_directory"><a class="anchor" href="#example_copying_an_entire_directory"></a><a class="link" href="#example_copying_an_entire_directory">Example: Copying an entire directory</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyReportsDirForArchiving(<span class="key">type</span>: Copy) {
    from <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/reports</span><span class="delimiter">&quot;</span></span>
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The key aspect that users struggle with is controlling how much of the directory structure goes to the destination. In the above example, do you get a <code>toArchive/reports</code> directory or does everything in <code>reports</code> go straight into <code>toArchive</code>? The answer is the latter. If a directory is part of the <code>from()</code> path, then it <em>won&#8217;t</em> appear in the destination.</p>
</div>
<div class="paragraph">
<p>So how do you ensure that <code>reports</code> itself is copied across, but not any other directory in <code>$buildDir</code>? The answer is to add it as an include pattern:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_copying_an_entire_directory_including_itself"><a class="anchor" href="#example_copying_an_entire_directory_including_itself"></a><a class="link" href="#example_copying_an_entire_directory_including_itself">Example: Copying an entire directory, including itself</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyReportsDirForArchiving2(<span class="key">type</span>: Copy) {
    from(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>) {
        include <span class="string"><span class="delimiter">&quot;</span><span class="content">reports/**</span><span class="delimiter">&quot;</span></span>
    }
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll get the same behavior as before except with one extra level of directory in the destination, i.e. <code>toArchive/reports</code>.</p>
</div>
<div class="paragraph">
<p>One thing to note is how the <code>include()</code> directive applies only to the <code>from()</code>, whereas the directive in the previous section applied to the whole task. These different levels of granularity in the copy specification allow you to easily handle most requirements that you will come across. You can learn more about this in the section on <a href="#sub:using_child_copy_specifications">child specifications</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:creating_archives_example"><a class="anchor" href="#sec:creating_archives_example"></a><a class="link" href="#sec:creating_archives_example">Creating archives (zip, tar, etc.)</a></h4>
<div class="paragraph">
<p>From the perspective of Gradle, packing files into an archive is effectively a copy in which the destination is the archive file rather than a directory on the file system. This means that creating archives looks a lot like copying, with all of the same features!</p>
</div>
<div class="paragraph">
<p>The simplest case involves archiving the entire contents of a directory, which this example demonstrates by creating a ZIP of the <code>toArchive</code> directory:</p>
</div>
<div class="sect4">
<h5 id="example_archiving_a_directory_as_a_zip"><a class="anchor" href="#example_archiving_a_directory_as_a_zip"></a><a class="link" href="#example_archiving_a_directory_as_a_zip">Example: Archiving a directory as a ZIP</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task packageDistribution(<span class="key">type</span>: Zip) {
    archiveName = <span class="string"><span class="delimiter">&quot;</span><span class="content">my-distribution.zip</span><span class="delimiter">&quot;</span></span>
    destinationDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/dist</span><span class="delimiter">&quot;</span></span>)

    from <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice how we specify the destination and name of the archive instead of an <code>into()</code>: both are required. You often won&#8217;t see them explicitly set, because most projects apply the <a href="#base_plugin">Base Plugin</a>. It provides some conventional values for those properties. The next example demonstrates this and you can learn more about the conventions in the <a href="#sec:archive_naming">archive naming</a> section.</p>
</div>
<div class="paragraph">
<p>Each type of archive has its own task type, the most common ones being <a href="../dsl/org.gradle.api.tasks.bundling.Zip.html">Zip</a>, <a href="../dsl/org.gradle.api.tasks.bundling.Tar.html">Tar</a> and <a href="../dsl/org.gradle.api.tasks.bundling.Jar.html">Jar</a>. They all share most of the configuration options of <code>Copy</code>, including filtering and renaming.</p>
</div>
<div class="paragraph">
<p>One of the most common scenarios involves copying files into specified subdirectories of the archive. For example, let&#8217;s say you want to package all PDFs into a <code>docs</code> directory in the root of the archive. This <code>docs</code> directory doesn&#8217;t exist in the source location, so you have to create it as part of the archive. You do this by adding an <code>into()</code> declaration for just the PDFs:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_the_base_plugin_for_its_archive_name_convention"><a class="anchor" href="#example_using_the_base_plugin_for_its_archive_name_convention"></a><a class="link" href="#example_using_the_base_plugin_for_its_archive_name_convention">Example: Using the Base Plugin for its archive name convention</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">base</span><span class="delimiter">'</span></span>
}

version = <span class="string"><span class="delimiter">&quot;</span><span class="content">1.0.0</span><span class="delimiter">&quot;</span></span>

task packageDistribution(<span class="key">type</span>: Zip) {
    from(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>) {
        exclude <span class="string"><span class="delimiter">&quot;</span><span class="content">**/*.pdf</span><span class="delimiter">&quot;</span></span>
    }

    from(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>) {
        include <span class="string"><span class="delimiter">&quot;</span><span class="content">**/*.pdf</span><span class="delimiter">&quot;</span></span>
        into <span class="string"><span class="delimiter">&quot;</span><span class="content">docs</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, you can have multiple <code>from()</code> declarations in a copy specification, each with its own configuration. See <a href="#sub:using_child_copy_specifications">Using child copy specifications</a> for more information on this feature.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:unpacking_archives_example"><a class="anchor" href="#sec:unpacking_archives_example"></a><a class="link" href="#sec:unpacking_archives_example">Unpacking archives</a></h4>
<div class="paragraph">
<p>Archives are effectively self-contained file systems, so unpacking them is a case of copying the files from that file system onto the local file system or even into another archive. Gradle enables this by providing some wrapper functions that make archives available as hierarchical collections of files (<a href="#sec:file_trees">file trees</a>).</p>
</div>
<div class="paragraph">
<p>The two functions of interest are <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:zipTree(java.lang.Object)">Project.zipTree(java.lang.Object)</a> and <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:tarTree(java.lang.Object)">Project.tarTree(java.lang.Object)</a>, which produce a <a href="../javadoc/org/gradle/api/file/FileTree.html">FileTree</a> from a corresponding archive file. That file tree can then be used in a <code>from()</code> specification, like so:</p>
</div>
<div class="sect4">
<h5 id="example_unpacking_a_zip_file"><a class="anchor" href="#example_unpacking_a_zip_file"></a><a class="link" href="#example_unpacking_a_zip_file">Example: Unpacking a ZIP file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task unpackFiles(<span class="key">type</span>: Copy) {
    from zipTree(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/resources/thirdPartyResources.zip</span><span class="delimiter">&quot;</span></span>)
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/resources</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As with a normal copy, you can control which files are unpacked via filters and even rename files as they are unpacked.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re a Java developer and are wondering why there is no <code>jarTree()</code> method, that&#8217;s because <code>zipTree()</code> works perfectly well for JARs, WARs and EARs.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:creating_uber_jar_example"><a class="anchor" href="#sec:creating_uber_jar_example"></a><a class="link" href="#sec:creating_uber_jar_example">Creating "uber" or "fat" JARs</a></h4>
<div class="paragraph">
<p>In the Java space, applications and their dependencies typically used to be packaged as separate JARs within a single distribution archive. That still happens, but there is another approach that is now common: placing the classes and resources of the dependencies directly into the application JAR, creating what is known as an uber or fat JAR.</p>
</div>
<div class="paragraph">
<p>Gradle makes this approach easy to accomplish. Consider the aim: to copy the contents of other JAR files into the application JAR. All you need for this is the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:zipTree(java.lang.Object)">Project.zipTree(java.lang.Object)</a> method and the <a href="../dsl/org.gradle.api.tasks.bundling.Jar.html">Jar</a> task, as demonstrated by the <code>uberJar</code> task in the following example:</p>
</div>
<div class="sect4">
<h5 id="example_creating_a_java_uber_or_fat_jar"><a class="anchor" href="#example_creating_a_java_uber_or_fat_jar"></a><a class="link" href="#example_creating_a_java_uber_or_fat_jar">Example: Creating a Java uber or fat JAR</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
}

version = <span class="string"><span class="delimiter">'</span><span class="content">1.0.0</span><span class="delimiter">'</span></span>

repositories {
    mavenCentral()
}

dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">commons-io:commons-io:2.6</span><span class="delimiter">'</span></span>
}

task uberJar(<span class="key">type</span>: Jar) {
    appendix = <span class="string"><span class="delimiter">'</span><span class="content">uber</span><span class="delimiter">'</span></span>

    from sourceSets.main.output
    from configurations.runtimeClasspath.
                                         findAll { <span class="local-variable">it</span>.name.endsWith(<span class="string"><span class="delimiter">'</span><span class="content">jar</span><span class="delimiter">'</span></span>) }.
                                         collect { zipTree(<span class="local-variable">it</span>) }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, we&#8217;re taking the runtime dependencies of the project  <code>configurations.runtimeClasspath.files</code>  and wrapping each of the JAR files with the <code>zipTree()</code> method. The result is a collection of ZIP file trees, the contents of which are copied into the uber JAR alongside the application classes.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:creating_directories_example"><a class="anchor" href="#sec:creating_directories_example"></a><a class="link" href="#sec:creating_directories_example">Creating directories</a></h4>
<div class="paragraph">
<p>Many tasks need to create directories to store the files they generate, which is why Gradle automatically manages this aspect of tasks when they explicitly define file and directory outputs. You can learn about this feature in the <a href="#sec:up_to_date_checks">incremental build</a> section of the user guide. All core Gradle tasks ensure that any output directories they need are created if necessary using this mechanism.</p>
</div>
<div class="paragraph">
<p>In cases where you need to create a directory manually, you can use the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:mkdir(java.lang.Object)">Project.mkdir(java.lang.Object)</a> method from within your build scripts or custom task implementations. Here&#8217;s a simple example that creates a single <code>images</code> directory in the project folder:</p>
</div>
<div class="sect4">
<h5 id="example_manually_creating_a_directory"><a class="anchor" href="#example_manually_creating_a_directory"></a><a class="link" href="#example_manually_creating_a_directory">Example: Manually creating a directory</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task ensureDirectory {
    doLast {
        mkdir <span class="string"><span class="delimiter">&quot;</span><span class="content">images</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As described in the <a href="https://ant.apache.org/manual/Tasks/mkdir.html">Apache Ant manual</a>, the <code>mkdir</code> task will automatically create all necessary directories in the given path and will do nothing if the directory already exists.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:moving_files_example"><a class="anchor" href="#sec:moving_files_example"></a><a class="link" href="#sec:moving_files_example">Moving files and directories</a></h4>
<div class="paragraph">
<p>Gradle has no API for moving files and directories around, but you can use the <a href="#ant">Apache Ant integration</a> to easily do that, as shown in this example:</p>
</div>
<div class="sect4">
<h5 id="example_moving_a_directory_using_the_ant_task"><a class="anchor" href="#example_moving_a_directory_using_the_ant_task"></a><a class="link" href="#example_moving_a_directory_using_the_ant_task">Example: Moving a directory using the Ant task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task moveReports {
    doLast {
        ant.move <span class="key">file</span>: <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/reports</span><span class="delimiter">&quot;</span></span>,
                 <span class="key">todir</span>: <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is not a common requirement and should be used sparingly as you lose information and can easily break a build. It&#8217;s generally preferable to copy directories and files instead.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:renaming_files_example"><a class="anchor" href="#sec:renaming_files_example"></a><a class="link" href="#sec:renaming_files_example">Renaming files on copy</a></h4>
<div class="paragraph">
<p>The files used and generated by your builds sometimes don&#8217;t have names that suit, in which case you want to rename those files as you copy them. Gradle allows you to do this as part of a copy specification using the <code>rename()</code> configuration.</p>
</div>
<div class="paragraph">
<p>The following example removes the "-staging-" marker from the names of any files that have it:</p>
</div>
<div class="sect4">
<h5 id="example_renaming_files_as_they_are_copied"><a class="anchor" href="#example_renaming_files_as_they_are_copied"></a><a class="link" href="#example_renaming_files_as_they_are_copied">Example: Renaming files as they are copied</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyFromStaging(<span class="key">type</span>: Copy) {
    from <span class="string"><span class="delimiter">&quot;</span><span class="content">src/main/webapp</span><span class="delimiter">&quot;</span></span>
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/explodedWar</span><span class="delimiter">&quot;</span></span>

    rename <span class="string"><span class="delimiter">'</span><span class="content">(.+)-staging(.+)</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">$1$2</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use regular expressions for this, as in the above example, or closures that use more complex logic to determine the target filename. For example, the following task truncates filenames:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_truncating_filenames_as_they_are_copied"><a class="anchor" href="#example_truncating_filenames_as_they_are_copied"></a><a class="link" href="#example_truncating_filenames_as_they_are_copied">Example: Truncating filenames as they are copied</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyWithTruncate(<span class="key">type</span>: Copy) {
    from <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/reports</span><span class="delimiter">&quot;</span></span>
    rename { <span class="predefined-type">String</span> filename -&gt;
        <span class="keyword">if</span> (filename.size() &gt; <span class="integer">10</span>) {
            <span class="keyword">return</span> filename[<span class="integer">0</span>..<span class="integer">7</span>] + <span class="string"><span class="delimiter">&quot;</span><span class="content">~</span><span class="delimiter">&quot;</span></span> + filename.size()
        }
        <span class="keyword">else</span> <span class="keyword">return</span> filename
    }
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As with filtering, you can also apply renaming to a subset of files by configuring it as part of a child specification on a <code>from()</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:deleting_files_example"><a class="anchor" href="#sec:deleting_files_example"></a><a class="link" href="#sec:deleting_files_example">Deleting files and directories</a></h4>
<div class="paragraph">
<p>You can easily delete files and directories using either the <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a> task or the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:delete(org.gradle.api.Action)">Project.delete(org.gradle.api.Action)</a> method.
In both cases, you specify which files and directories to delete in a way supported by the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:files(java.lang.Object[])">Project.files(java.lang.Object&#8230;&#8203;)</a>, <a href="../javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-">ProjectLayout.files(java.lang.Object&#8230;&#8203;)</a>, and <a href="../javadoc/org/gradle/api/file/ProjectLayout.html#configurableFiles-java.lang.Object...-">ProjectLayout.configurableFiles(java.lang.Object&#8230;&#8203;)</a> methods.</p>
</div>
<div class="paragraph">
<p>For example, the following task deletes the entire contents of a build&#8217;s output directory:</p>
</div>
<div class="sect4">
<h5 id="example_deleting_a_directory"><a class="anchor" href="#example_deleting_a_directory"></a><a class="link" href="#example_deleting_a_directory">Example: Deleting a directory</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task myClean(<span class="key">type</span>: Delete) {
    delete buildDir
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want more control over which files are deleted, you can&#8217;t use inclusions and exclusions in the same way as for copying files.
Instead, you have to use the builtin filtering mechanisms of <code>FileCollection</code> and <code>FileTree</code>.
The following example does just that to clear out temporary files from a source directory:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_deleting_files_matching_a_specific_pattern"><a class="anchor" href="#example_deleting_files_matching_a_specific_pattern"></a><a class="link" href="#example_deleting_files_matching_a_specific_pattern">Example: Deleting files matching a specific pattern</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task cleanTempFiles(<span class="key">type</span>: Delete) {
    delete fileTree(<span class="string"><span class="delimiter">&quot;</span><span class="content">src</span><span class="delimiter">&quot;</span></span>).matching {
        include <span class="string"><span class="delimiter">&quot;</span><span class="content">**/*.tmp</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll learn more about file collections and file trees in the next section.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:locating_files"><a class="anchor" href="#sec:locating_files"></a><a class="link" href="#sec:locating_files">File paths in depth</a></h4>
<div class="paragraph">
<p>In order to perform some action on a file, you need to know where it is, and that&#8217;s the information provided by file paths. Gradle builds on the standard Java <code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html">File</a></code> class, which represents the location of a single file, and provides new APIs for dealing with collections of paths. This section shows you how to use the Gradle APIs to specify file paths for use in tasks and file operations.</p>
</div>
<div class="paragraph">
<p>But first, an important note on using hard-coded file paths in your builds.</p>
</div>
<div class="sect4">
<h5 id="sec:hard_coded_file_paths"><a class="anchor" href="#sec:hard_coded_file_paths"></a><a class="link" href="#sec:hard_coded_file_paths">On hard-coded file paths</a></h5>
<div class="paragraph">
<p>Many examples in this chapter use hard-coded paths as string literals. This makes them easy to understand, but it&#8217;s not good practice for real builds. The problem is that paths often change and the more places you need to change them, the more likely you are to miss one and break the build.</p>
</div>
<div class="paragraph">
<p>Where possible, you should use tasks, task properties, and <a href="#sec:extra_properties">project properties</a>  in that order of preference  to configure file paths. For example, if you were to create a task that packages the compiled classes of a Java application, you should aim for something like this:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_how_to_minimize_the_number_of_hard_coded_paths_in_your_build"><a class="anchor" href="#example_how_to_minimize_the_number_of_hard_coded_paths_in_your_build"></a><a class="link" href="#example_how_to_minimize_the_number_of_hard_coded_paths_in_your_build">Example: How to minimize the number of hard-coded paths in your build</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ext {
    archivesDirPath = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/archives</span><span class="delimiter">&quot;</span></span>
}

task packageClasses(<span class="key">type</span>: Zip) {
    appendix = <span class="string"><span class="delimiter">&quot;</span><span class="content">classes</span><span class="delimiter">&quot;</span></span>
    destinationDir = file(archivesDirPath)

    from compileJava
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See how we&#8217;re using the <code>compileJava</code> task as the source of the files to package and we&#8217;ve created a project property <code>archivesDirPath</code> to store the location where we put archives, on the basis we&#8217;re likely to use it elsewhere in the build.</p>
</div>
<div class="paragraph">
<p>Using a task directly as an argument like this relies on it having <a href="#sec:task_inputs_outputs">defined outputs</a>, so it won&#8217;t always be possible. In addition, this example could be improved further by relying on the Java plugin&#8217;s convention for <code>destinationDir</code> rather than overriding it, but it does demonstrate the use of project properties.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:single_file_paths"><a class="anchor" href="#sec:single_file_paths"></a><a class="link" href="#sec:single_file_paths">Single files and directories</a></h5>
<div class="paragraph">
<p>Gradle provides the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a> method for specifying the location of a single file or directory.
Relative paths are resolved relative to the project directory, while absolute paths remain unchanged.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<div class="paragraph">
<p>Never use <code>new File(relative path)</code>, as this creates a path relative to the current working directory, which could be anywhere.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here are some examples of using the <code>file()</code> method with different types of argument:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_locating_files"><a class="anchor" href="#example_locating_files"></a><a class="link" href="#example_locating_files">Example: Locating files</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// Using a relative path</span>
<span class="predefined-type">File</span> configFile = file(<span class="string"><span class="delimiter">'</span><span class="content">src/config.xml</span><span class="delimiter">'</span></span>)

<span class="comment">// Using an absolute path</span>
configFile = file(configFile.absolutePath)

<span class="comment">// Using a File object with a relative path</span>
configFile = file(<span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="string"><span class="delimiter">'</span><span class="content">src/config.xml</span><span class="delimiter">'</span></span>))

<span class="comment">// Using a java.nio.file.Path object with a relative path</span>
configFile = file(Paths.get(<span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">config.xml</span><span class="delimiter">'</span></span>))

<span class="comment">// Using an absolute java.nio.file.Path object</span>
configFile = file(Paths.get(<span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">'</span><span class="content">user.home</span><span class="delimiter">'</span></span>)).resolve(<span class="string"><span class="delimiter">'</span><span class="content">global-config.xml</span><span class="delimiter">'</span></span>))</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, you can pass strings, <code>File</code> instances and <code><a href="https://docs.oracle.com/javase/7/docs/api/java/nio/file/Path.html">Path</a></code> instances to the <code>file()</code> method, all of which result in an absolute <code>File</code> object. You can find other options for argument types in the reference guide, linked in the previous paragraph.</p>
</div>
<div class="paragraph">
<p>What happens in the case of multi-project builds? The <code>file()</code> method will always turn relative paths into paths that are relative to the current project directory, which may be a child project. If you want to use a path that&#8217;s relative to the <em>root project</em> directory, then you need to use the special <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:rootDir">Project.getRootDir()</a> property to construct an absolute path, like so:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_creating_a_path_relative_to_a_parent_project"><a class="anchor" href="#example_creating_a_path_relative_to_a_parent_project"></a><a class="link" href="#example_creating_a_path_relative_to_a_parent_project">Example: Creating a path relative to a parent project</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">File</span> configFile = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>rootDir<span class="inline-delimiter">}</span></span><span class="content">/shared/config.xml</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s say you&#8217;re working on a multi-project build in a <code>dev/projects/AcmeHealth</code> directory. You use the above example in the build of the library you&#8217;re fixing  at <code>AcmeHealth/subprojects/AcmePatientRecordLib/build.gradle</code>. The file path will resolve to the absolute version of <code>dev/projects/AcmeHealth/shared/config.xml</code>.</p>
</div>
<div class="paragraph">
<p>The <code>file()</code> method can be used to configure any task that has a property of type <code>File</code>. Many tasks, though, work on multiple files, so we look at how to specify sets of files next.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:file_collections"><a class="anchor" href="#sec:file_collections"></a><a class="link" href="#sec:file_collections">File collections</a></h5>
<div class="paragraph">
<p>A <em>file collection</em> is simply a set of file paths that&#8217;s represented by the <a href="../javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a> interface. <em>Any</em> file paths. It&#8217;s important to understand that the file paths don&#8217;t have to be related in any way, so they don&#8217;t have to be in the same directory or even have a shared parent directory. You will also find that many parts of the Gradle API use <code>FileCollection</code>, such as the copying API discussed later in this chapter and <a href="#managing_dependency_configurations">dependency configurations</a>.</p>
</div>
<div class="paragraph">
<p>The recommended way to specify a collection of files is to use the link:../javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-[ProjectLayout.files(java.lang.Object...) method, which returns a <code>FileCollection</code> instance.
This method is very flexible and allows you to pass multiple strings, <code>File</code> instances, collections of strings, collections of <code>File</code>s, and more.
You can even pass in tasks as arguments if they have <a href="#sec:task_inputs_outputs">defined outputs</a>.
Learn about all the supported argument types in the reference guide.</p>
</div>
<div class="paragraph">
<p>As with the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a> method covered in the <a href="#sec:single_file_paths">previous section</a>, all relative paths are evaluated relative to the current project directory. The following example demonstrates some of the variety of argument types you can use  strings, <code>File</code> instances, a list and a <code><a href="https://docs.oracle.com/javase/7/docs/api/java/nio/file/Path.html">Path</a></code>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_creating_a_file_collection"><a class="anchor" href="#example_creating_a_file_collection"></a><a class="link" href="#example_creating_a_file_collection">Example: Creating a file collection</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">FileCollection collection = layout.files(<span class="string"><span class="delimiter">'</span><span class="content">src/file1.txt</span><span class="delimiter">'</span></span>,
                                  <span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="string"><span class="delimiter">'</span><span class="content">src/file2.txt</span><span class="delimiter">'</span></span>),
                                  [<span class="string"><span class="delimiter">'</span><span class="content">src/file3.csv</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">src/file4.csv</span><span class="delimiter">'</span></span>],
                                  Paths.get(<span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">file5.txt</span><span class="delimiter">'</span></span>))</code></pre>
</div>
</div>
<div class="paragraph">
<p>File collections have some important attributes in Gradle. They can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>created lazily</p>
</li>
<li>
<p>iterated over</p>
</li>
<li>
<p>filtered</p>
</li>
<li>
<p>combined</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Lazy creation</em> of a file collection is useful when you need to evaluate the files that make up a collection at the time a build runs. In the following example, we query the file system to find out what files exist in a particular directory and then make those into a file collection:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_implementing_a_file_collection"><a class="anchor" href="#example_implementing_a_file_collection"></a><a class="link" href="#example_implementing_a_file_collection">Example: Implementing a file collection</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task list {
    doLast {
        <span class="predefined-type">File</span> srcDir

        <span class="comment">// Create a file collection using a closure</span>
        collection = layout.files { srcDir.listFiles() }

        srcDir = file(<span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>)
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Contents of </span><span class="inline"><span class="inline-delimiter">$</span>srcDir</span><span class="content">.name</span><span class="delimiter">&quot;</span></span>
        collection.collect { relativePath(<span class="local-variable">it</span>) }.sort().each { println <span class="local-variable">it</span> }

        srcDir = file(<span class="string"><span class="delimiter">'</span><span class="content">src2</span><span class="delimiter">'</span></span>)
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Contents of </span><span class="inline"><span class="inline-delimiter">$</span>srcDir</span><span class="content">.name</span><span class="delimiter">&quot;</span></span>
        collection.collect { relativePath(<span class="local-variable">it</span>) }.sort().each { println <span class="local-variable">it</span> }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q list</code></strong></div>
<div class="content">
<pre>&gt; gradle -q list
Contents of src
src/dir1
src/file1.txt
Contents of src2
src2/dir1
src2/dir2</pre>
</div>
</div>
<div class="paragraph">
<p>The key to lazy creation is passing a closure to the <code>files()</code> method. Your closure simply needs to return a value of a type accepted by <code>files()</code>, such as <code>List&lt;File&gt;</code>, <code>String</code>, <code>FileCollection</code>, etc.</p>
</div>
<div class="paragraph">
<p><em>Iterating over a file collection</em> can be done through the <code>each()</code> method on the collection or using the collection in a <code>for</code> loop. In both approaches, the file collection is treated as a set of <code>File</code> instances, i.e. your iteration variable will be of type <code>File</code>.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates such iteration as well as how you can convert file collections to other types using the <code>as</code> operator or supported properties:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_a_file_collection"><a class="anchor" href="#example_using_a_file_collection"></a><a class="link" href="#example_using_a_file_collection">Example: Using a file collection</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">        <span class="comment">// Iterate over the files in the collection</span>
        collection.each { <span class="predefined-type">File</span> file -&gt;
            println file.name
        }

        <span class="comment">// Convert the collection to various types</span>
        <span class="predefined-type">Set</span> set = collection.files
        <span class="predefined-type">Set</span> set2 = collection <span class="keyword">as</span> <span class="predefined-type">Set</span>
        <span class="predefined-type">List</span> list = collection <span class="keyword">as</span> <span class="predefined-type">List</span>
        <span class="predefined-type">String</span> path = collection.asPath
        <span class="predefined-type">File</span> file = collection.singleFile
        <span class="predefined-type">File</span> file2 = collection <span class="keyword">as</span> <span class="predefined-type">File</span>

        <span class="comment">// Add and subtract collections</span>
        <span class="keyword">def</span> union = collection + layout.files(<span class="string"><span class="delimiter">'</span><span class="content">src/file2.txt</span><span class="delimiter">'</span></span>)
        <span class="keyword">def</span> difference = collection - layout.files(<span class="string"><span class="delimiter">'</span><span class="content">src/file2.txt</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also see at the end of the example <em>how to combine file collections</em> using the <code>+</code> and <code>-</code> operators to merge and subtract them. An important feature of the resulting file collections is that they are <em>live</em>. In other words, when you combine file collections in this way, the result always reflects what&#8217;s currently in the source file collections, even if they change during the build.</p>
</div>
<div class="paragraph">
<p>For example, imagine <code>collection</code> in the above example gains an extra file or two after <code>union</code> is created. As long as you use <code>union</code> after those files are added to <code>collection</code>, <code>union</code> will also contain those additional files. The same goes for the <code>different</code> file collection.</p>
</div>
<div class="paragraph">
<p>Live collections are also important when it comes to <em>filtering</em>. If you want to use a subset of a file collection, you can take advantage of the <a href="../javadoc/org/gradle/api/file/FileCollection.html#filter-org.gradle.api.specs.Spec-">FileCollection.filter(org.gradle.api.specs.Spec)</a> method to determine which files to "keep". In the following example, we create a new collection that consists of only the files that end with .txt in the source collection:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_filtering_a_file_collection"><a class="anchor" href="#example_filtering_a_file_collection"></a><a class="link" href="#example_filtering_a_file_collection">Example: Filtering a file collection</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">FileCollection textFiles = collection.filter { <span class="predefined-type">File</span> f -&gt;
    f.name.endsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">.txt</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q filterTextFiles</code></strong></div>
<div class="content">
<pre>&gt; gradle -q filterTextFiles
src/file1.txt
src/file2.txt
src/file5.txt</pre>
</div>
</div>
<div class="paragraph">
<p>If <code>collection</code> changes at any time, either by adding or removing files from itself, then <code>textFiles</code> will immediately reflect the change because it is also a live collection. Note that the closure you pass to <code>filter()</code> takes a <code>File</code> as an argument and should return a boolean.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:file_trees"><a class="anchor" href="#sec:file_trees"></a><a class="link" href="#sec:file_trees">File trees</a></h5>
<div class="paragraph">
<p>A <em>file tree</em> is a file collection that retains the directory structure of the files it contains and has the type <a href="../javadoc/org/gradle/api/file/FileTree.html">FileTree</a>. This means that all the paths in a file tree must have a shared parent directory. The following diagram highlights the distinction between file trees and file collections in the common case of copying files:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/file-collection-vs-file-tree.png" alt="file collection vs file tree">
</div>
<div class="title">Figure 10. The differences in how file trees and file collections behave when copying files</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Although <code>FileTree</code> extends <code>FileCollection</code> (an is-a relationship), their behaviors do differ. In other words, you can use a file tree wherever a file collection is required, but remember: a file collection is a flat list/set of files, while a file tree is a file and directory hierarchy. To convert a file tree to a flat collection, use the <a href="../javadoc/org/gradle/api/file/FileTree.html#getFiles--">FileTree.getFiles()</a> property.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The simplest way to create a file tree is to pass a file or directory path to the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:fileTree(java.lang.Object)">Project.fileTree(java.lang.Object)</a> method. This will create a tree of all the files and directories in that base directory (but not the base directory itself). The following example demonstrates how to use the basic method and, in addition, how to filter the files and directories using Ant-style patterns:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_creating_a_file_tree"><a class="anchor" href="#example_creating_a_file_tree"></a><a class="link" href="#example_creating_a_file_tree">Example: Creating a file tree</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// Create a file tree with a base directory</span>
FileTree tree = fileTree(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">src/main</span><span class="delimiter">'</span></span>)

<span class="comment">// Add include and exclude patterns to the tree</span>
tree.include <span class="string"><span class="delimiter">'</span><span class="content">**/*.java</span><span class="delimiter">'</span></span>
tree.exclude <span class="string"><span class="delimiter">'</span><span class="content">**/Abstract*</span><span class="delimiter">'</span></span>

<span class="comment">// Create a tree using path</span>
tree = fileTree(<span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>).include(<span class="string"><span class="delimiter">'</span><span class="content">**/*.java</span><span class="delimiter">'</span></span>)

<span class="comment">// Create a tree using closure</span>
tree = fileTree(<span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>) {
    include <span class="string"><span class="delimiter">'</span><span class="content">**/*.java</span><span class="delimiter">'</span></span>
}

<span class="comment">// Create a tree using a map</span>
tree = fileTree(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>, <span class="key">include</span>: <span class="string"><span class="delimiter">'</span><span class="content">**/*.java</span><span class="delimiter">'</span></span>)
tree = fileTree(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>, <span class="key">includes</span>: [<span class="string"><span class="delimiter">'</span><span class="content">**/*.java</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.xml</span><span class="delimiter">'</span></span>])
tree = fileTree(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>, <span class="key">include</span>: <span class="string"><span class="delimiter">'</span><span class="content">**/*.java</span><span class="delimiter">'</span></span>, <span class="key">exclude</span>: <span class="string"><span class="delimiter">'</span><span class="content">**/*test*/**</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see more examples of supported patterns in the API docs for <a href="../javadoc/org/gradle/api/tasks/util/PatternFilterable.html">PatternFilterable</a>. Also, see the API documentation for <code>fileTree()</code> to see what types you can pass as the base directory.</p>
</div>
<div class="paragraph">
<p>By default, <code>fileTree()</code> returns a <code>FileTree</code> instance that applies some default exclusion patterns for convenience  the same defaults as Ant in fact. For the complete default exclusion list, see <a href="http://ant.apache.org/manual/dirtasks.html#defaultexcludes">the Ant manual</a>.</p>
</div>
<div class="paragraph">
<p>If those default exclusions prove problematic, you can workaround the issue by using the <a href="https://ant.apache.org/manual/Tasks/defaultexcludes.html"><code>defaultexcludes</code> Ant task</a>, as demonstrated in this example:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_changing_ant_default_exclusions_for_a_copy_task"><a class="anchor" href="#example_changing_ant_default_exclusions_for_a_copy_task"></a><a class="link" href="#example_changing_ant_default_exclusions_for_a_copy_task">Example: Changing Ant default exclusions for a copy task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task forcedCopy(<span class="key">type</span>: Copy) {
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/inPlaceApp</span><span class="delimiter">&quot;</span></span>
    from <span class="string"><span class="delimiter">'</span><span class="content">src/main/webapp</span><span class="delimiter">'</span></span>

    doFirst {
        ant.defaultexcludes <span class="key">remove</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">**/.git</span><span class="delimiter">&quot;</span></span>
        ant.defaultexcludes <span class="key">remove</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">**/.git/**</span><span class="delimiter">&quot;</span></span>
        ant.defaultexcludes <span class="key">remove</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">**/*~</span><span class="delimiter">&quot;</span></span>
    }

    doLast {
        ant.defaultexcludes <span class="keyword">default</span>: <span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In general, it&#8217;s best to ensure that the default exclusions are reset whenever you change them as modifications are visible to the entire build. The above example is performing such a reset in its <code>doLast</code> action.</p>
</div>
<div class="paragraph">
<p>You can do many of the same things with file trees that you can with file collections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>iterate over them (depth first)</p>
</li>
<li>
<p>filter them (using <a href="../javadoc/org/gradle/api/file/FileTree.html#matching-org.gradle.api.Action-">FileTree.matching(org.gradle.api.Action)</a> and Ant-style patterns)</p>
</li>
<li>
<p>merge them</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also traverse file trees using the <a href="../javadoc/org/gradle/api/file/FileTree.html#visit-org.gradle.api.Action-">FileTree.visit(org.gradle.api.Action)</a> method. All of these techniques are demonstrated in the following example:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_a_file_tree"><a class="anchor" href="#example_using_a_file_tree"></a><a class="link" href="#example_using_a_file_tree">Example: Using a file tree</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// Iterate over the contents of a tree</span>
tree.each {<span class="predefined-type">File</span> file -&gt;
    println file
}

<span class="comment">// Filter a tree</span>
FileTree filtered = tree.matching {
    include <span class="string"><span class="delimiter">'</span><span class="content">org/gradle/api/**</span><span class="delimiter">'</span></span>
}

<span class="comment">// Add trees together</span>
FileTree sum = tree + fileTree(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">src/test</span><span class="delimiter">'</span></span>)

<span class="comment">// Visit the elements of the tree</span>
tree.visit {element -&gt;
    println <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>element</span><span class="content">.relativePath =&gt; </span><span class="inline"><span class="inline-delimiter">$</span>element</span><span class="content">.file</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ve discussed how to create your own file trees and file collections, but it&#8217;s also worth bearing in mind that many Gradle plugins provide their own instances of file trees, such as <a href="#sec:java_source_sets">Java&#8217;s source sets</a>. These can be used and manipulated in exactly the same way as the file trees you create yourself.</p>
</div>
<div class="paragraph">
<p>Another specific type of file tree that users commonly need is the archive, i.e. ZIP files, TAR files, etc. We look at those next.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:archive_contents"><a class="anchor" href="#sec:archive_contents"></a><a class="link" href="#sec:archive_contents">Using archives as file trees</a></h5>
<div class="paragraph">
<p>An archive is a directory and file hierarchy packed into a single file. In other words, it&#8217;s a special case of a file tree, and that&#8217;s exactly how Gradle treats archives. Instead of using the <code>fileTree()</code> method, which only works on normal file systems, you use the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:zipTree(java.lang.Object)">Project.zipTree(java.lang.Object)</a> and <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:tarTree(java.lang.Object)">Project.tarTree(java.lang.Object)</a> methods to wrap archive files of the corresponding type (note that JAR, WAR and EAR files are ZIPs). Both methods return <code>FileTree</code> instances that you can then use in the same way as normal file trees. For example, you can extract some or all of the files of an archive by copying its contents to some directory on the file system. Or you can merge one archive into another.</p>
</div>
<div class="paragraph">
<p>Here are some simple examples of creating archive-based file trees:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_an_archive_as_a_file_tree"><a class="anchor" href="#example_using_an_archive_as_a_file_tree"></a><a class="link" href="#example_using_an_archive_as_a_file_tree">Example: Using an archive as a file tree</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// Create a ZIP file tree using path</span>
FileTree zip = zipTree(<span class="string"><span class="delimiter">'</span><span class="content">someFile.zip</span><span class="delimiter">'</span></span>)

<span class="comment">// Create a TAR file tree using path</span>
FileTree tar = tarTree(<span class="string"><span class="delimiter">'</span><span class="content">someFile.tar</span><span class="delimiter">'</span></span>)

<span class="comment">//tar tree attempts to guess the compression based on the file extension</span>
<span class="comment">//however if you must specify the compression explicitly you can:</span>
FileTree someTar = tarTree(resources.gzip(<span class="string"><span class="delimiter">'</span><span class="content">someTar.ext</span><span class="delimiter">'</span></span>))</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see a practical example of extracting an archive file <a href="#sec:unpacking_archives_example">in among the common scenarios</a> we cover.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:specifying_multiple_files"><a class="anchor" href="#sec:specifying_multiple_files"></a><a class="link" href="#sec:specifying_multiple_files">Understanding implicit conversion to file collections</a></h5>
<div class="paragraph">
<p>Many objects in Gradle have properties which accept a set of input files.
For example, the <a href="../dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a> task has a <code>source</code> property that defines the source files to compile.
You can set the value of this property using any of the types supported by the <a href="#sec:file_collections">files()</a> method, as mentioned in the api docs.
This means you can, for example, set the property to a <code>File</code>, <code>String</code>, collection, <code>FileCollection</code> or even a closure.</p>
</div>
<div class="paragraph">
<p><strong>This is a feature of specific tasks</strong>!
That means implicit conversion will not happen for just any task that has a <code>FileCollection</code> or <code>FileTree</code> property.
If you want to know whether implicit conversion happens in a particular situation, you will need to read the relevant documentation, such as the corresponding task&#8217;s API docs.
Alternatively, you can remove all doubt by explicitly using link:../javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-[ProjectLayout.files(java.lang.Object...) in your build.</p>
</div>
<div class="paragraph">
<p>Here are some examples of the different types of arguments that the <code>source</code> property can take:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_specifying_a_set_of_files"><a class="anchor" href="#example_specifying_a_set_of_files"></a><a class="link" href="#example_specifying_a_set_of_files">Example: Specifying a set of files</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task compile(<span class="key">type</span>: JavaCompile)

<span class="comment">// Use a File object to specify the source directory</span>
compile {
    source = file(<span class="string"><span class="delimiter">'</span><span class="content">src/main/java</span><span class="delimiter">'</span></span>)
}

<span class="comment">// Use a String path to specify the source directory</span>
compile {
    source = <span class="string"><span class="delimiter">'</span><span class="content">src/main/java</span><span class="delimiter">'</span></span>
}

<span class="comment">// Use a collection to specify multiple source directories</span>
compile {
    source = [<span class="string"><span class="delimiter">'</span><span class="content">src/main/java</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">../shared/java</span><span class="delimiter">'</span></span>]
}

<span class="comment">// Use a FileCollection (or FileTree in this case) to specify the source files</span>
compile {
    source = fileTree(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">src/main/java</span><span class="delimiter">'</span></span>).matching { include <span class="string"><span class="delimiter">'</span><span class="content">org/gradle/api/**</span><span class="delimiter">'</span></span> }
}

<span class="comment">// Using a closure to specify the source files.</span>
compile {
    source = {
        <span class="comment">// Use the contents of each zip file in the src dir</span>
        file(<span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>).listFiles().findAll {<span class="local-variable">it</span>.name.endsWith(<span class="string"><span class="delimiter">'</span><span class="content">.zip</span><span class="delimiter">'</span></span>)}.collect { zipTree(<span class="local-variable">it</span>) }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>One other thing to note is that properties like <code>source</code> have corresponding methods in core Gradle tasks. Those methods follow the convention of <em>appending</em> to collections of values rather than replacing them. Again, this method accepts any of the types supported by the <a href="#sec:file_collections">files()</a> method, as shown here:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_appending_a_set_of_files"><a class="anchor" href="#example_appending_a_set_of_files"></a><a class="link" href="#example_appending_a_set_of_files">Example: Appending a set of files</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">compile {
    <span class="comment">// Add some source directories use String paths</span>
    source <span class="string"><span class="delimiter">'</span><span class="content">src/main/java</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">src/main/groovy</span><span class="delimiter">'</span></span>

    <span class="comment">// Add a source directory using a File object</span>
    source file(<span class="string"><span class="delimiter">'</span><span class="content">../shared/java</span><span class="delimiter">'</span></span>)

    <span class="comment">// Add some source directories using a closure</span>
    source { file(<span class="string"><span class="delimiter">'</span><span class="content">src/test/</span><span class="delimiter">'</span></span>).listFiles() }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As this is a common convention, we recommend that you follow it in your own custom tasks. Specifically, if you plan to add a method to configure a collection-based property, make sure the method appends rather than replaces values.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:copying_files"><a class="anchor" href="#sec:copying_files"></a><a class="link" href="#sec:copying_files">File copying in depth</a></h4>
<div class="paragraph">
<p>The basic process of copying files in Gradle is a simple one:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define a task of type <a href="../dsl/org.gradle.api.tasks.Copy.html">Copy</a></p>
</li>
<li>
<p>Specify which files (and potentially directories) to copy</p>
</li>
<li>
<p>Specify a destination for the copied files</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>But this apparent simplicity hides a rich API that allows fine-grained control of which files are copied, where they go, and what happens to them as they are copied  renaming of the files and token substitution of file content are both possibilities, for example.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with the last two items on the list, which form what is known as a <em>copy specification</em>. This is formally based on the <a href="../javadoc/org/gradle/api/file/CopySpec.html">CopySpec</a> interface, which the <code>Copy</code> task implements, and offers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <a href="../javadoc/org/gradle/api/file/CopySpec.html#from-java.lang.Object...-">CopySpec.from(java.lang.Object&#8230;&#8203;)</a> method to define what to copy</p>
</li>
<li>
<p>An <a href="../javadoc/org/gradle/api/file/CopySpec.html#into-java.lang.Object-">CopySpec.into(java.lang.Object)</a> method to define the destination</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CopySpec</code> has several additional methods that allow you to control the copying process, but these two are the only required ones. <code>into()</code> is straightforward, requiring a directory path as its argument in any form supported by the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a> method. The <code>from()</code> configuration is far more flexible.</p>
</div>
<div class="paragraph">
<p>Not only does <code>from()</code> accept multiple arguments, it also allows several different types of argument. For example, some of the most common types are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>String</code>  treated as a file path or, if it starts with "file://", a file URI</p>
</li>
<li>
<p>A <code>File</code>  used as a file path</p>
</li>
<li>
<p>A <code>FileCollection</code> or <code>FileTree</code>  all files in the collection are included in the copy</p>
</li>
<li>
<p>A task the files or directories that form a task&#8217;s <a href="#sec:task_inputs_outputs">defined outputs</a> are included</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In fact, <code>from()</code> accepts all the same arguments as <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:files(java.lang.Object[])">Project.files(java.lang.Object&#8230;&#8203;)</a>, <a href="../javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-">ProjectLayout.files(java.lang.Object&#8230;&#8203;)</a>, and <a href="../javadoc/org/gradle/api/file/ProjectLayout.html#configurableFiles-java.lang.Object...-">ProjectLayout.configurableFiles(java.lang.Object&#8230;&#8203;)</a>, so see those methods for a more detailed list of acceptable types.</p>
</div>
<div class="paragraph">
<p>Something else to consider is what type of thing a file path refers to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A file  the file is copied as is</p>
</li>
<li>
<p>A directory  this is effectively treated as a file tree: everything in it, including subdirectories, is copied. However, the directory itself is not included in the copy.</p>
</li>
<li>
<p>A non-existent file  the path is ignored</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an example that uses multiple <code>from()</code> specifications, each with a different argument type. You will probably also notice that <code>into()</code> is configured lazily using a closure a technique that also works with <code>from()</code>:</p>
</div>
<div class="sect4">
<h5 id="example_specifying_copy_task_source_files_and_destination_directory"><a class="anchor" href="#example_specifying_copy_task_source_files_and_destination_directory"></a><a class="link" href="#example_specifying_copy_task_source_files_and_destination_directory">Example: Specifying copy task source files and destination directory</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task anotherCopyTask(<span class="key">type</span>: Copy) {
    <span class="comment">// Copy everything under src/main/webapp</span>
    from <span class="string"><span class="delimiter">'</span><span class="content">src/main/webapp</span><span class="delimiter">'</span></span>
    <span class="comment">// Copy a single file</span>
    from <span class="string"><span class="delimiter">'</span><span class="content">src/staging/index.html</span><span class="delimiter">'</span></span>
    <span class="comment">// Copy the output of a task</span>
    from copyTask
    <span class="comment">// Copy the output of a task using Task outputs explicitly.</span>
    from copyTaskWithPatterns.outputs
    <span class="comment">// Copy the contents of a Zip file</span>
    from zipTree(<span class="string"><span class="delimiter">'</span><span class="content">src/main/assets.zip</span><span class="delimiter">'</span></span>)
    <span class="comment">// Determine the destination directory later</span>
    into { getDestDir() }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the lazy configuration of <code>into()</code> is different from a <a href="#sub:using_child_copy_specifications">child specification</a>, even though the syntax is similar. Keep an eye on the number of arguments to distinguish between them.</p>
</div>
</div>
<div class="sect4">
<h5 id="filtering_files"><a class="anchor" href="#filtering_files"></a><a class="link" href="#filtering_files">Filtering files</a></h5>
<div class="paragraph">
<p>You&#8217;ve already seen that you can filter file collections and file trees directly in a <code>Copy</code> task, but you can also apply filtering in any copy specification through the <a href="../javadoc/org/gradle/api/file/CopySpec.html#include-java.lang.String...-">CopySpec.include(java.lang.String&#8230;&#8203;)</a> and <a href="../javadoc/org/gradle/api/file/CopySpec.html#exclude-java.lang.String...-">CopySpec.exclude(java.lang.String&#8230;&#8203;)</a> methods.</p>
</div>
<div class="paragraph">
<p>Both of these methods are normally used with Ant-style include or exclude patterns, as described in <a href="../javadoc/org/gradle/api/tasks/util/PatternFilterable.html">PatternFilterable</a>. You can also perform more complex logic by using a closure that takes a <a href="../javadoc/org/gradle/api/file/FileTreeElement.html">FileTreeElement</a> and returns <code>true</code> if the file should be included or <code>false</code> otherwise. The following example demonstrates both forms, ensuring that only .html and .jsp files are copied, except for those .html files with the word "DRAFT" in their content:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_selecting_the_files_to_copy"><a class="anchor" href="#example_selecting_the_files_to_copy"></a><a class="link" href="#example_selecting_the_files_to_copy">Example: Selecting the files to copy</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyTaskWithPatterns(<span class="key">type</span>: Copy) {
    from <span class="string"><span class="delimiter">'</span><span class="content">src/main/webapp</span><span class="delimiter">'</span></span>
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/explodedWar</span><span class="delimiter">&quot;</span></span>
    include <span class="string"><span class="delimiter">'</span><span class="content">**/*.html</span><span class="delimiter">'</span></span>
    include <span class="string"><span class="delimiter">'</span><span class="content">**/*.jsp</span><span class="delimiter">'</span></span>
    exclude { FileTreeElement details -&gt;
        details.file.name.endsWith(<span class="string"><span class="delimiter">'</span><span class="content">.html</span><span class="delimiter">'</span></span>) &amp;&amp;
            details.file.text.contains(<span class="string"><span class="delimiter">'</span><span class="content">DRAFT</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A question you may ask yourself at this point is what happens when inclusion and exclusion patterns overlap? Which pattern wins? Here are the basic rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If there are no explicit inclusions or exclusions, everything is included</p>
</li>
<li>
<p>If at least one inclusion is specified, only files and directories matching the patterns are included</p>
</li>
<li>
<p>Any exclusion pattern overrides any inclusions, so if a file or directory matches at least one exclusion pattern, it won&#8217;t be included, regardless of the inclusion patterns</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Bear these rules in mind when creating combined inclusion and exclusion specifications so that you end up with the exact behavior you want.</p>
</div>
<div class="paragraph">
<p>Note that the inclusions and exclusions in the above example will apply to <em>all</em> <code>from()</code> configurations. If you want to apply filtering to a subset of the copied files, you&#8217;ll need to use <a href="#sub:using_child_copy_specifications">child specifications</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:renaming_files"><a class="anchor" href="#sec:renaming_files"></a><a class="link" href="#sec:renaming_files">Renaming files</a></h5>
<div class="paragraph">
<p>The <a href="#sec:renaming_files_example">example of how to rename files on copy</a> gives you most of the information you need to perform this operation. It demonstrates the two options for renaming:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using a regular expression</p>
</li>
<li>
<p>Using a closure</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Regular expressions are a flexible approach to renaming, particularly as Gradle supports regex groups that allow you to remove and replaces parts of the source filename. The following example shows how you can remove the string "-staging-" from any filename that contains it using a simple regular expression:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_renaming_files_as_they_are_copied_2"><a class="anchor" href="#example_renaming_files_as_they_are_copied_2"></a><a class="link" href="#example_renaming_files_as_they_are_copied_2">Example: Renaming files as they are copied</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task rename(<span class="key">type</span>: Copy) {
    from <span class="string"><span class="delimiter">'</span><span class="content">src/main/webapp</span><span class="delimiter">'</span></span>
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/explodedWar</span><span class="delimiter">&quot;</span></span>
    <span class="comment">// Use a closure to convert all file names to upper case</span>
    rename { <span class="predefined-type">String</span> fileName -&gt;
        fileName.toUpperCase()
    }
    <span class="comment">// Use a regular expression to map the file name</span>
    rename <span class="string"><span class="delimiter">'</span><span class="content">(.+)-staging-(.+)</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">$1$2</span><span class="delimiter">'</span></span>
    rename(<span class="regexp"><span class="delimiter">/</span><span class="content">(.+)-staging-(.+)</span><span class="delimiter">/</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">$1$2</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use any regular expression supported by the Java <code><a href="https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html">Pattern</a></code> class and the substitution string (the second argument of <code>rename()</code> works on the same principles as the <code><a href="https://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html#appendReplacement(java.lang.StringBuffer,%20java.lang.String)">Matcher.appendReplacement()</a></code> method.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Regular expressions in Groovy build scripts</div>
<div class="paragraph">
<p>There are two common issues people come across when using regular expressions in this context:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you use a slashy string (those delimited by '/') for the first argument, you <em>must</em> include the parentheses for <code>rename()</code> as shown in the above example.</p>
</li>
<li>
<p>It&#8217;s safest to use single quotes for the second argument, otherwise you need to escape the '$' in group substitutions, i.e. <code>"\$1\$2"</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The first is a minor inconvenience, but slashy strings have the advantage that you don&#8217;t have to escape backslash ('\') characters in the regular expression. The second issue stems from Groovy&#8217;s support for embedded expressions using <code>${ }</code> syntax in double-quoted and slashy strings.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The closure syntax for <code>rename()</code> is straightforward and can be used for any requirements that simple regular expressions can&#8217;t handle. You&#8217;re given the name of a file and you return a new name for that file, or <code>null</code> if you don&#8217;t want to change the name. Do be aware that the closure will be executed for every file that&#8217;s copied, so try to avoid expensive operations where possible.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:filtering_files"><a class="anchor" href="#sec:filtering_files"></a><a class="link" href="#sec:filtering_files">Filtering file content (token substitution, templating, etc.)</a></h5>
<div class="paragraph">
<p>Not to be confused with filtering which files are copied, <em>file content filtering</em> allows you to transform the content of files while they are being copied. This can involve basic templating that uses token substitution, removal of lines of text, or even more complex filtering using a full-blown template engine.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates several forms of filtering, including token substitution using the <a href="../javadoc/org/gradle/api/file/CopySpec.html#expand-java.util.Map-">CopySpec.expand(java.util.Map)</a> method and another using <a href="../javadoc/org/gradle/api/file/CopySpec.html#filter-java.lang.Class-">CopySpec.filter(java.lang.Class)</a> with an <a href="https://ant.apache.org/manual/Types/filterchain.html">Ant filter</a>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_filtering_files_as_they_are_copied"><a class="anchor" href="#example_filtering_files_as_they_are_copied"></a><a class="link" href="#example_filtering_files_as_they_are_copied">Example: Filtering files as they are copied</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.apache.tools.ant.filters.FixCrLfFilter</span>
<span class="keyword">import</span> <span class="include">org.apache.tools.ant.filters.ReplaceTokens</span>

task filter(<span class="key">type</span>: Copy) {
    from <span class="string"><span class="delimiter">'</span><span class="content">src/main/webapp</span><span class="delimiter">'</span></span>
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/explodedWar</span><span class="delimiter">&quot;</span></span>
    <span class="comment">// Substitute property tokens in files</span>
    expand(<span class="key">copyright</span>: <span class="string"><span class="delimiter">'</span><span class="content">2009</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">2.3.1</span><span class="delimiter">'</span></span>)
    expand(project.properties)
    <span class="comment">// Use some of the filters provided by Ant</span>
    filter(FixCrLfFilter)
    filter(ReplaceTokens, <span class="key">tokens</span>: [<span class="key">copyright</span>: <span class="string"><span class="delimiter">'</span><span class="content">2009</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">2.3.1</span><span class="delimiter">'</span></span>])
    <span class="comment">// Use a closure to filter each line</span>
    filter { <span class="predefined-type">String</span> line -&gt;
        <span class="string"><span class="delimiter">&quot;</span><span class="content">[</span><span class="inline"><span class="inline-delimiter">$</span>line</span><span class="content">]</span><span class="delimiter">&quot;</span></span>
    }
    <span class="comment">// Use a closure to remove lines</span>
    filter { <span class="predefined-type">String</span> line -&gt;
        line.startsWith(<span class="string"><span class="delimiter">'</span><span class="content">-</span><span class="delimiter">'</span></span>) ? <span class="predefined-constant">null</span> : line
    }
    filteringCharset = <span class="string"><span class="delimiter">'</span><span class="content">UTF-8</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>filter()</code> method has two variants, which behave differently:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one takes a <code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/FilterReader.html">FilterReader</a></code> and is designed to work with Ant filters, such as <code>ReplaceTokens</code></p>
</li>
<li>
<p>one takes a closure or <a href="../javadoc/org/gradle/api/Transformer.html">Transformer</a> that defines the transformation for each line of the source file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that both variants assume the source files are text based. When you use the <code>ReplaceTokens</code> class with <code>filter()</code>, the result is a template engine that replaces tokens of the form <code>@tokenName@</code> (the Ant-style token) with values that you define.</p>
</div>
<div class="paragraph">
<p>The <code>expand()</code> method treats the source files as <a href="http://docs.groovy-lang.org/latest/html/api/groovy/text/SimpleTemplateEngine.html">Groovy templates</a>, which evaluate and expand expressions of the form <code>${expression}</code>. You can pass in property names and values that are then expanded in the source files. <code>expand()</code> allows for more than basic token substitution as the embedded expressions are full-blown Groovy expressions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It&#8217;s good practice to specify the character set when reading and writing the file, otherwise the transformations won&#8217;t work properly for non-ASCII text. You configure the character set with the <a href="../javadoc/org/gradle/api/file/CopySpec.html#getFilteringCharset--">CopySpec.getFilteringCharset()</a> property. If it&#8217;s not specified, the JVM default character set is used, which is likely to be different from the one you want.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_the_copyspec_class"><a class="anchor" href="#sec:using_the_copyspec_class"></a><a class="link" href="#sec:using_the_copyspec_class">Using the <code>CopySpec</code> class</a></h5>
<div class="paragraph">
<p>A copy specification (or copy spec for short) determines what gets copied to where, and what happens to files during the copy. You&#8217;ve alread seen many examples in the form of configuration for <code>Copy</code> and archiving tasks. But copy specs have two attributes that are worth covering in more detail:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>They can be independent of tasks</p>
</li>
<li>
<p>They are hierarchical</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The first of these attributes allows you to <em>share copy specs within a build</em>. The second provides fine-grained control within the overall copy specification.</p>
</div>
<div class="sect5">
<h6 id="sub:sharing_copy_specs"><a class="anchor" href="#sub:sharing_copy_specs"></a><a class="link" href="#sub:sharing_copy_specs">Sharing copy specs</a></h6>
<div class="paragraph">
<p>Consider a build that has several tasks that copy a project&#8217;s static website resources or add them to an archive. One task might copy the resources to a folder for a local HTTP server and another might package them into a distribution. You could manually specify the file locations and appropriate inclusions each time they are needed, but human error is more likely to creep in, resulting in inconsistencies between tasks.</p>
</div>
<div class="paragraph">
<p>One solution Gradle provides is the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:copySpec(org.gradle.api.Action)">Project.copySpec(org.gradle.api.Action)</a> method. This allows you to create a copy spec outside of a task, which can then be attached to an appropriate task using the <a href="../javadoc/org/gradle/api/file/CopySpec.html#with-org.gradle.api.file.CopySpec...-">CopySpec.with(org.gradle.api.file.CopySpec&#8230;&#8203;)</a> method. The following example demonstrates how this is done:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_sharing_copy_specifications"><a class="anchor" href="#example_sharing_copy_specifications"></a><a class="link" href="#example_sharing_copy_specifications">Example: Sharing copy specifications</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">CopySpec webAssetsSpec = copySpec {
    from <span class="string"><span class="delimiter">'</span><span class="content">src/main/webapp</span><span class="delimiter">'</span></span>
    include <span class="string"><span class="delimiter">'</span><span class="content">**/*.html</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.png</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.jpg</span><span class="delimiter">'</span></span>
    rename <span class="string"><span class="delimiter">'</span><span class="content">(.+)-staging(.+)</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">$1$2</span><span class="delimiter">'</span></span>
}

task copyAssets(<span class="key">type</span>: Copy) {
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/inPlaceApp</span><span class="delimiter">&quot;</span></span>
    with webAssetsSpec
}

task distApp(<span class="key">type</span>: Zip) {
    archiveName = <span class="string"><span class="delimiter">'</span><span class="content">my-app-dist.zip</span><span class="delimiter">'</span></span>
    destinationDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/dists</span><span class="delimiter">&quot;</span></span>)

    from appClasses
    with webAssetsSpec
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both the <code>copyAssets</code> and <code>distApp</code> tasks will process the static resources under <code>src/main/webapp</code>, as specified by <code>webAssetsSpec</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The configuration defined by <code>webAssetsSpec</code> will <em>not</em> apply to the app classes included by the <code>distApp</code> task. That&#8217;s because <code>from appClasses</code> is its own child specification independent of <code>with webAssetsSpec</code>.</p>
</div>
<div class="paragraph">
<p>This can be confusing to understand, so it&#8217;s probably best to treat <code>with()</code> as an extra <code>from()</code> specification in the task. Hence it doesn&#8217;t make sense to define a standalone copy spec without at least one <code>from()</code> defined.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you encounter a scenario in which you want to apply the same copy configuration to <em>different</em> sets of files, then you can share the configuration block directly without using <code>copySpec()</code>. Here&#8217;s an example that has two independent tasks that happen to want to process image files only:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_sharing_copy_patterns_only"><a class="anchor" href="#example_sharing_copy_patterns_only"></a><a class="link" href="#example_sharing_copy_patterns_only">Example: Sharing copy patterns only</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> webAssetPatterns = {
    include <span class="string"><span class="delimiter">'</span><span class="content">**/*.html</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.png</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.jpg</span><span class="delimiter">'</span></span>
}

task copyAppAssets(<span class="key">type</span>: Copy) {
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/inPlaceApp</span><span class="delimiter">&quot;</span></span>
    from <span class="string"><span class="delimiter">'</span><span class="content">src/main/webapp</span><span class="delimiter">'</span></span>, webAssetPatterns
}

task archiveDistAssets(<span class="key">type</span>: Zip) {
    archiveName = <span class="string"><span class="delimiter">'</span><span class="content">distribution-assets.zip</span><span class="delimiter">'</span></span>
    destinationDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/dists</span><span class="delimiter">&quot;</span></span>)

    from <span class="string"><span class="delimiter">'</span><span class="content">distResources</span><span class="delimiter">'</span></span>, webAssetPatterns
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, we assign the copy configuration to its own variable and apply it to whatever <code>from()</code> specification we want. This doesn&#8217;t just work for inclusions, but also exclusions, file renaming, and file content filtering.</p>
</div>
<div class="sect5">
<h6 id="sub:using_child_copy_specifications"><a class="anchor" href="#sub:using_child_copy_specifications"></a><a class="link" href="#sub:using_child_copy_specifications">Using child specifications</a></h6>
<div class="paragraph">
<p>If you only use a single copy spec, the file filtering and renaming will apply to <em>all</em> the files that are copied. Sometimes this is what you want, but not always. Consider the following example that copies files into a directory structure that can be used by a Java Servlet container to deliver a website:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/exploded-war-child-copy-spec-example.png" alt="exploded war child copy spec example">
</div>
<div class="title">Figure 11. Creating an exploded WAR for a Servlet container</div>
</div>
<div class="paragraph">
<p>This is not a straightforward copy as the <code>WEB-INF</code> directory and its subdirectories don&#8217;t exist within the project, so they must be created during the copy. In addition, we only want HTML and image files going directly into the root folder  <code>build/explodedWar</code>  and only JavaScript files going into the <code>js</code> directory. So we need separate filter patterns for those two sets of files.</p>
</div>
<div class="paragraph">
<p>The solution is to use <em>child specifications</em>, which can be applied to both <code>from()</code> and <code>into()</code> declarations. The following task definition does the necessary work:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_nested_copy_specs"><a class="anchor" href="#example_nested_copy_specs"></a><a class="link" href="#example_nested_copy_specs">Example: Nested copy specs</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task nestedSpecs(<span class="key">type</span>: Copy) {
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/explodedWar</span><span class="delimiter">&quot;</span></span>
    exclude <span class="string"><span class="delimiter">'</span><span class="content">**/*staging*</span><span class="delimiter">'</span></span>
    from(<span class="string"><span class="delimiter">'</span><span class="content">src/dist</span><span class="delimiter">'</span></span>) {
        include <span class="string"><span class="delimiter">'</span><span class="content">**/*.html</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.png</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">**/*.jpg</span><span class="delimiter">'</span></span>
    }
    from(sourceSets.main.output) {
        into <span class="string"><span class="delimiter">'</span><span class="content">WEB-INF/classes</span><span class="delimiter">'</span></span>
    }
    into(<span class="string"><span class="delimiter">'</span><span class="content">WEB-INF/lib</span><span class="delimiter">'</span></span>) {
        from configurations.runtimeClasspath
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice how the <code>src/dist</code> configuration has a nested inclusion specification: that&#8217;s the child copy spec. You can of course add content filtering and renaming here as required. A child copy spec is still a copy spec.</p>
</div>
<div class="paragraph">
<p>The above example also demonstrates how you can copy files into a subdirectory of the destination either by using a child <code>into()</code> on a <code>from()</code> or a child <code>from()</code> on an <code>into()</code>. Both approaches are acceptable, but you may want to create and follow a convention to ensure consistency across your build files.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Don&#8217;t get your <code>into()</code> specifications mixed up! For a normal copy one to the filesystem rather than an archive  there should always be <em>one</em> "root" <code>into()</code> that simply specifies the overall destination directory of the copy. Any other <code>into()</code> should have a child spec attached and its path will be relative to the root <code>into()</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>One final thing to be aware of is that a child copy spec inherits its destination path, include patterns, exclude patterns, copy actions, name mappings and filters from its parent. So be careful where you place your configuration.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:project_copy_method"><a class="anchor" href="#sec:project_copy_method"></a><a class="link" href="#sec:project_copy_method">Copying files in your own tasks</a></h5>
<div class="paragraph">
<p>There might be occasions when you want to copy files or directories as <em>part</em> of a task. For example, a custom archiving task based on an unsupported archive format might want to copy files to a temporary directory before they are then archived. You still want to take advantage of Gradle&#8217;s copy API, but without introducing an extra <code>Copy</code> task.</p>
</div>
<div class="paragraph">
<p>The solution is to use the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:copy(org.gradle.api.Action)">Project.copy(org.gradle.api.Action)</a> method. It works the same way as the <code>Copy</code> task by configuring it with a copy spec. Here&#8217;s a trivial example:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_copying_files_using_the_copy_method_without_up_to_date_check"><a class="anchor" href="#example_copying_files_using_the_copy_method_without_up_to_date_check"></a><a class="link" href="#example_copying_files_using_the_copy_method_without_up_to_date_check">Example: Copying files using the copy() method without up-to-date check</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyMethod {
    doLast {
        copy {
            from <span class="string"><span class="delimiter">'</span><span class="content">src/main/webapp</span><span class="delimiter">'</span></span>
            into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/explodedWar</span><span class="delimiter">&quot;</span></span>
            include <span class="string"><span class="delimiter">'</span><span class="content">**/*.html</span><span class="delimiter">'</span></span>
            include <span class="string"><span class="delimiter">'</span><span class="content">**/*.jsp</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example demonstrates the basic syntax and also highlights two major limitations of using the <code>copy()</code> method:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>copy()</code> method is not <a href="#sec:up_to_date_checks">incremental</a>. The example&#8217;s <code>copyMethod</code> task will <em>always</em> execute because it has no information about what files make up the task&#8217;s inputs. You have to manually define the task inputs and outputs.</p>
</li>
<li>
<p>Using a task as a copy source, i.e. as an argument to <code>from()</code>, won&#8217;t set up an automatic task dependency between your task and that copy source. As such, if you are using the <code>copy()</code> method as part of a task action, you must explicitly declare all inputs and outputs in order to get the correct behavior.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following example shows you how to workaround these limitations by using the <a href="#sec:task_input_output_runtime_api">dynamic API for task inputs and outputs</a>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_copying_files_using_the_copy_method_with_up_to_date_check"><a class="anchor" href="#example_copying_files_using_the_copy_method_with_up_to_date_check"></a><a class="link" href="#example_copying_files_using_the_copy_method_with_up_to_date_check">Example: Copying files using the copy() method with up-to-date check</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyMethodWithExplicitDependencies{
    <span class="comment">// up-to-date check for inputs, plus add copyTask as dependency</span>
    inputs.files copyTask
    outputs.dir <span class="string"><span class="delimiter">'</span><span class="content">some-dir</span><span class="delimiter">'</span></span> <span class="comment">// up-to-date check for outputs</span>
    doLast{
        copy {
            <span class="comment">// Copy the output of copyTask</span>
            from copyTask
            into <span class="string"><span class="delimiter">'</span><span class="content">some-dir</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>These limitations make it preferable to use the <code>Copy</code> task wherever possible, because of its builtin support for incremental building and task dependency inference. That is why the <code>copy()</code> method is intended for use by <a href="#custom_tasks">custom tasks</a> that need to copy files as part of their function. Custom tasks that use the <code>copy()</code> method should declare the necessary inputs and outputs relevant to the copy action.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:sync_task"><a class="anchor" href="#sec:sync_task"></a><a class="link" href="#sec:sync_task">Mirroring directories and file collections with the <code>Sync</code> task</a></h5>
<div class="paragraph">
<p>The <a href="../dsl/org.gradle.api.tasks.Sync.html">Sync</a> task, which extends the <code>Copy</code> task, copies the source files into the destination directory and then removes any files from the destination directory which it did not copy. In other words, it synchronizes the contents of a directory with its source. This can be useful for doing things such as installing your application, creating an exploded copy of your archives, or maintaining a copy of the project&#8217;s dependencies.</p>
</div>
<div class="paragraph">
<p>Here is an example which maintains a copy of the project&#8217;s runtime dependencies in the <code>build/libs</code> directory.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_the_sync_task_to_copy_dependencies"><a class="anchor" href="#example_using_the_sync_task_to_copy_dependencies"></a><a class="link" href="#example_using_the_sync_task_to_copy_dependencies">Example: Using the Sync task to copy dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task libs(<span class="key">type</span>: Sync) {
    from configurations.runtime
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/libs</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also perform the same function in your own tasks with the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:sync(org.gradle.api.Action)">Project.sync(org.gradle.api.Action)</a> method.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:archives"><a class="anchor" href="#sec:archives"></a><a class="link" href="#sec:archives">Archive creation in depth</a></h4>
<div class="paragraph">
<p>Archives are essentially self-contained file systems and Gradle treats them as such. This is why working with archives is very similar to working with files and directories, including such things as file permissions.</p>
</div>
<div class="paragraph">
<p>Out of the box, Gradle supports creation of both ZIP and TAR archives, and by extension Java&#8217;s JAR, WAR and EAR formats Java&#8217;s archive formats are all ZIPs. Each of these formats has a corresponding task type to create them: <a href="../dsl/org.gradle.api.tasks.bundling.Zip.html">Zip</a>, <a href="../dsl/org.gradle.api.tasks.bundling.Tar.html">Tar</a>, <a href="../dsl/org.gradle.api.tasks.bundling.Jar.html">Jar</a>, <a href="../dsl/org.gradle.api.tasks.bundling.War.html">War</a>, and <a href="../dsl/org.gradle.plugins.ear.Ear.html">Ear</a>. These all work the same way and are based on copy specifications, just like the <code>Copy</code> task.</p>
</div>
<div class="paragraph">
<p>Creating an archive file is essentially a file copy in which the destination is implicit, i.e. the archive file itself. Here&#8217;s a basic example that specifies the path and name of the target archive file:</p>
</div>
<div class="sect4">
<h5 id="example_archiving_a_directory_as_a_zip_2"><a class="anchor" href="#example_archiving_a_directory_as_a_zip_2"></a><a class="link" href="#example_archiving_a_directory_as_a_zip_2">Example: Archiving a directory as a ZIP</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task packageDistribution(<span class="key">type</span>: Zip) {
    archiveName = <span class="string"><span class="delimiter">&quot;</span><span class="content">my-distribution.zip</span><span class="delimiter">&quot;</span></span>
    destinationDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/dist</span><span class="delimiter">&quot;</span></span>)

    from <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/toArchive</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the next section you&#8217;ll learn about convention-based archive names, which can save you from always configuring the destination directory and archive name.</p>
</div>
<div class="paragraph">
<p>The full power of copy specifications are available to you when creating archives, which means you can do content filtering, file renaming or anything else that is covered in the previous section. A particularly common requirement is copying files into subdirectories of the archive that don&#8217;t exist in the source folders, something that can be achieved with <code>into()</code> <a href="#sub:using_child_copy_specifications">child specifications</a>.</p>
</div>
<div class="paragraph">
<p>Gradle does of course allow you create as many archive tasks as you want, but it&#8217;s worth bearing in mind that many convention-based plugins provide their own. For example, the Java plugin adds a <code>jar</code> task for packaging a project&#8217;s compiled classes and resources in a JAR. Many of these plugins provide sensible conventions for the names of archives as well as the copy specifications used. We recommend you use these tasks wherever you can, rather than overriding them with your own.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:archive_naming"><a class="anchor" href="#sec:archive_naming"></a><a class="link" href="#sec:archive_naming">Archive naming</a></h5>
<div class="paragraph">
<p>Gradle has several conventions around the naming of archives and where they are created based on the plugins your project uses. The main convention is provided by the <a href="#base_plugin">Base Plugin</a>, which defaults to creating archives in the <code>$buildDir/distributions</code> directory and typically uses archive names of the form <em>[projectName]-[version].[type]</em>.</p>
</div>
<div class="paragraph">
<p>The following example comes from a project named 'zipProject', hence the <code>myZip</code> task creates an archive named 'zipProject-1.0.zip':</p>
</div>
</div>
<div class="sect4">
<h5 id="example_creation_of_zip_archive"><a class="anchor" href="#example_creation_of_zip_archive"></a><a class="link" href="#example_creation_of_zip_archive">Example: Creation of ZIP archive</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">base</span><span class="delimiter">'</span></span>
}

version = <span class="float">1.0</span>

task myZip(<span class="key">type</span>: Zip) {
    from <span class="string"><span class="delimiter">'</span><span class="content">somedir</span><span class="delimiter">'</span></span>

    doLast {
        println archiveName
        println relativePath(destinationDir)
        println relativePath(archivePath)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q myZip</code></strong></div>
<div class="content">
<pre>&gt; gradle -q myZip
zipProject-1.0.zip
build/distributions
build/distributions/zipProject-1.0.zip</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the name of the archive does <em>not</em> derive from the name of the task that creates it.</p>
</div>
<div class="paragraph">
<p>If you want to change the name and location of a generated archive file, you can provide values for the <code>archiveName</code> and <code>destinationDir</code> properties of the corresponding task. These override any conventions that would otherwise apply.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can make use of the default archive name pattern provided by <a href="../dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html#org.gradle.api.tasks.bundling.AbstractArchiveTask:archiveName">AbstractArchiveTask.getArchiveName()</a>: <em>[baseName]-[appendix]-[version]-[classifier].[extension]</em>. You can set each of these properties on the task separately if you wish. Note that the Base Plugin uses the convention of project name for <em>baseName</em>, project version for <em>version</em> and the archive type for <em>extension</em>. It does not provide values for the other properties.</p>
</div>
<div class="paragraph">
<p>This example  from the same project as the one above  configures just the <code>baseName</code> property, overriding the default value of the project name:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuration_of_archive_task_custom_archive_name"><a class="anchor" href="#example_configuration_of_archive_task_custom_archive_name"></a><a class="link" href="#example_configuration_of_archive_task_custom_archive_name">Example: Configuration of archive task - custom archive name</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task myCustomZip(<span class="key">type</span>: Zip) {
    baseName = <span class="string"><span class="delimiter">'</span><span class="content">customName</span><span class="delimiter">'</span></span>
    from <span class="string"><span class="delimiter">'</span><span class="content">somedir</span><span class="delimiter">'</span></span>

    doLast {
        println archiveName
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q myCustomZip</code></strong></div>
<div class="content">
<pre>&gt; gradle -q myCustomZip
customName-1.0.zip</pre>
</div>
</div>
<div class="paragraph">
<p>You can also override the default <code>baseName</code> value for <em>all</em> the archive tasks in your build by using the <em>project</em> property <code>archivesBaseName</code>, as demonstrated by the following example:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuration_of_archive_task_appendix_classifier"><a class="anchor" href="#example_configuration_of_archive_task_appendix_classifier"></a><a class="link" href="#example_configuration_of_archive_task_appendix_classifier">Example: Configuration of archive task - appendix &amp; classifier</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">base</span><span class="delimiter">'</span></span>
}

version = <span class="float">1.0</span>
archivesBaseName = <span class="string"><span class="delimiter">&quot;</span><span class="content">gradle</span><span class="delimiter">&quot;</span></span>

task myZip(<span class="key">type</span>: Zip) {
    from <span class="string"><span class="delimiter">'</span><span class="content">somedir</span><span class="delimiter">'</span></span>
}

task myOtherZip(<span class="key">type</span>: Zip) {
    appendix = <span class="string"><span class="delimiter">'</span><span class="content">wrapper</span><span class="delimiter">'</span></span>
    classifier = <span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>
    from <span class="string"><span class="delimiter">'</span><span class="content">somedir</span><span class="delimiter">'</span></span>
}

task echoNames {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Project name: </span><span class="inline"><span class="inline-delimiter">${</span>project.name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
        println myZip.archiveName
        println myOtherZip.archiveName
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q echoNames</code></strong></div>
<div class="content">
<pre>&gt; gradle -q echoNames
Project name: zipProject
gradle-1.0.zip
gradle-wrapper-1.0-src.zip</pre>
</div>
</div>
<div class="paragraph">
<p>You can find all the possible archive task properties in the API documentation for <a href="../dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html">AbstractArchiveTask</a>, but we have also summarized the main ones here:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>archiveName</code>  <code>String</code>, default: <code><em>baseName</em>-<em>appendix</em>-<em>version</em>-<em>classifier</em>.<em>extension</em></code></dt>
<dd>
<p>The complete file name of the generated archive. If any of the properties in the default value are empty, their '-' separator is dropped.</p>
</dd>
<dt class="hdlist1"><code>archivePath</code>  <code>File</code>, <em>read-only</em>, default: <code><em>destinationDir</em>/<em>archiveName</em></code></dt>
<dd>
<p>The absolute file path of the generated archive.</p>
</dd>
<dt class="hdlist1"><code>destinationDir</code>  <code>File</code>, default: depends on archive type</dt>
<dd>
<p>The target directory in which to put the generated archive. By default, JARs and WARs go into <code>$buildDir/libs</code>. ZIPs and TARs go into <code>$buildDir/distributions</code>.</p>
</dd>
<dt class="hdlist1"><code>baseName</code>  <code>String</code>, default: <code><em>project.name</em></code></dt>
<dd>
<p>The base name portion of the archive file name, typically a project name or some other descriptive name for what it contains.</p>
</dd>
<dt class="hdlist1"><code>appendix</code>  <code>String</code>, default: <code>null</code></dt>
<dd>
<p>The appendix portion of the archive file name that comes immediately after the base name. It is typically used to distinguish between different forms of content, such as code and docs, or a minimal distribution versus a full or complete one.</p>
</dd>
<dt class="hdlist1"><code>version</code>  <code>String</code>, default: <code><em>project.version</em></code></dt>
<dd>
<p>The version portion of the archive file name, typically in the form of a normal project or product version.</p>
</dd>
<dt class="hdlist1"><code>classifier</code>  <code>String</code>, default: <code>null</code></dt>
<dd>
<p>The classifier portion of the archive file name. Often used to distinguish between archives that target different platforms.</p>
</dd>
<dt class="hdlist1"><code>extension</code>  <code>String</code>, default: depends on archive type and compression type</dt>
<dd>
<p>The filename extension for the archive. By default, this is set based on the archive task type and the compression type (if you&#8217;re creating a TAR). Will be one of: <code>zip</code>, <code>jar</code>, <code>war</code>, <code>tar</code>, <code>tgz</code> or <code>tbz2</code>. You can of course set this to a custom extension if you wish.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="sec:sharing_content_between_multiple_archives"><a class="anchor" href="#sec:sharing_content_between_multiple_archives"></a><a class="link" href="#sec:sharing_content_between_multiple_archives">Sharing content between multiple archives</a></h5>
<div class="paragraph">
<p><a href="#sub:sharing_copy_specs">As described earlier</a>, you can use the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:copySpec(org.gradle.api.Action)">Project.copySpec(org.gradle.api.Action)</a> method to share content between archives.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:reproducible_archives"><a class="anchor" href="#sec:reproducible_archives"></a><a class="link" href="#sec:reproducible_archives">Reproducible archives</a></h5>
<div class="paragraph">
<p>Sometimes it&#8217;s desirable to recreate archives exactly the same, byte for byte, on different machines. You want to be sure that building an artifact from source code produces the same result no matter when and where it is built. This is necessary for projects like <a href="https://reproducible-builds.org/">reproducible-builds.org</a>.</p>
</div>
<div class="paragraph">
<p>Reproducing the same byte-for-byte archive poses some challenges since the order of the files in an archive is influenced by the underlying file system. Each time a ZIP, TAR, JAR, WAR or EAR is built from source, the order of the files inside the archive may change. Files that only have a different timestamp also causes differences in archives from build to build. All <a href="../dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html">AbstractArchiveTask</a> (e.g. Jar, Zip) tasks shipped with Gradle include <a href="#feature_lifecycle">incubating</a> support producing reproducible archives.</p>
</div>
<div class="paragraph">
<p>For example, to make a <code>Zip</code> task reproducible you need to set <a href="../dsl/org.gradle.api.tasks.bundling.Zip.html#org.gradle.api.tasks.bundling.Zip:reproducibleFileOrder">Zip.isReproducibleFileOrder()</a> to <code>true</code> and <a href="../dsl/org.gradle.api.tasks.bundling.Zip.html#org.gradle.api.tasks.bundling.Zip:preserveFileTimestamps">Zip.isPreserveFileTimestamps()</a> to <code>false</code>. In order to make all archive tasks in your build reproducible, consider adding the following configuration to your build file:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_activating_reproducible_archives"><a class="anchor" href="#example_activating_reproducible_archives"></a><a class="link" href="#example_activating_reproducible_archives">Example: Activating reproducible archives</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.withType(AbstractArchiveTask) {
    preserveFileTimestamps = <span class="predefined-constant">false</span>
    reproducibleFileOrder = <span class="predefined-constant">true</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Often you will want to publish an archive, so that it is usable from another project. This process is described in <a href="#artifact_management">Legacy Publishing</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing_build_scripts"><a class="anchor" href="#writing_build_scripts"></a><a class="link" href="#writing_build_scripts">Writing Build Scripts</a></h3>
<div class="paragraph">
<p>This chapter looks at some of the details of writing a build script.</p>
</div>
<div class="sect3">
<h4 id="sec:the_gradle_build_language"><a class="anchor" href="#sec:the_gradle_build_language"></a><a class="link" href="#sec:the_gradle_build_language">The Gradle build language</a></h4>
<div class="paragraph">
<p>Gradle provides a <em>domain specific language</em>, or DSL, for describing builds. This build language is based on Groovy, with some additions to make it easier to describe a build.</p>
</div>
<div class="paragraph">
<p>A build script can contain any Groovy language element.<sup class="footnote">[<a id="_footnoteref_7" class="footnote" href="#_footnotedef_7" title="View footnote.">7</a>]</sup> Gradle assumes that each build script is encoded using UTF-8.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:project_api"><a class="anchor" href="#sec:project_api"></a><a class="link" href="#sec:project_api">The Project API</a></h4>
<div class="paragraph">
<p>In <a href="#tutorial_java_projects">the tutorial</a> we used, for example, the <code>apply()</code> method. Where does this method come from? We said earlier that the build script defines a project in Gradle. For each project in the build, Gradle creates an object of type <a href="../dsl/org.gradle.api.Project.html">Project</a> and associates this <code>Project</code> object with the build script. As the build script executes, it configures this <code>Project</code> object:</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">Getting help writing build scripts</div>
<div class="paragraph">
<p>Don&#8217;t forget that your build script is simply Groovy code that drives the Gradle API. And the <a href="../dsl/org.gradle.api.Project.html">Project</a> interface is your starting point for accessing everything in the Gradle API. So, if you&#8217;re wondering what 'tags' are available in your build script, you can start with the documentation for the <code>Project</code> interface.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Any method you call in your build script which <em>is not defined</em> in the build script, is delegated to the <code>Project</code> object.</p>
</li>
<li>
<p>Any property you access in your build script, which <em>is not defined</em> in the build script, is delegated to the <code>Project</code> object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s try this out and try to access the <code>name</code> property of the <code>Project</code> object.</p>
</div>
<div class="sect4">
<h5 id="example_accessing_property_of_the_project_object"><a class="anchor" href="#example_accessing_property_of_the_project_object"></a><a class="link" href="#example_accessing_property_of_the_project_object">Example: Accessing property of the Project object</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println name
println project.name</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q check</code></strong></div>
<div class="content">
<pre>&gt; gradle -q check
projectApi
projectApi</pre>
</div>
</div>
<div class="paragraph">
<p>Both <code>println</code> statements print out the same property. The first uses auto-delegation to the <code>Project</code> object, for properties not defined in the build script. The other statement uses the <code>project</code> property available to any build script, which returns the associated <code>Project</code> object. Only if you define a property or a method which has the same name as a member of the <code>Project</code> object, would you need to use the <code>project</code> property.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:standard_project_properties"><a class="anchor" href="#sec:standard_project_properties"></a><a class="link" href="#sec:standard_project_properties">Standard project properties</a></h5>
<div class="paragraph">
<p>The <code>Project</code> object provides some standard properties, which are available in your build script. The following table lists a few of the commonly used ones.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 5. Project Properties</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>project</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../dsl/org.gradle.api.Project.html">Project</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>Project</code> instance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the project directory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The absolute path of the project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>description</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A description for the project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>projectDir</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>File</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The directory containing the build script.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buildDir</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>File</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>projectDir</em>/build</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unspecified</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>version</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unspecified</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ant</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/AntBuilder.html">AntBuilder</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An <code>AntBuilder</code> instance</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:the_script_api"><a class="anchor" href="#sec:the_script_api"></a><a class="link" href="#sec:the_script_api">The Script API</a></h4>
<div class="paragraph">
<p>When Gradle executes a script, it compiles the script into a class which implements <a href="../dsl/org.gradle.api.Script.html">Script</a>. This means that all of the properties and methods declared by the <code>Script</code> interface are available in your script.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring_variables"><a class="anchor" href="#sec:declaring_variables"></a><a class="link" href="#sec:declaring_variables">Declaring variables</a></h4>
<div class="paragraph">
<p>There are two kinds of variables that can be declared in a build script: local variables and extra properties.</p>
</div>
<div class="sect4">
<h5 id="sec:local_variables"><a class="anchor" href="#sec:local_variables"></a><a class="link" href="#sec:local_variables">Local variables</a></h5>
<div class="paragraph">
<p>Local variables are declared with the <code>def</code> keyword. They are only visible in the scope where they have been declared. Local variables are a feature of the underlying Groovy language.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_local_variables"><a class="anchor" href="#example_using_local_variables"></a><a class="link" href="#example_using_local_variables">Example: Using local variables</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> dest = <span class="string"><span class="delimiter">&quot;</span><span class="content">dest</span><span class="delimiter">&quot;</span></span>

task copy(<span class="key">type</span>: Copy) {
    from <span class="string"><span class="delimiter">&quot;</span><span class="content">source</span><span class="delimiter">&quot;</span></span>
    into dest
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:extra_properties"><a class="anchor" href="#sec:extra_properties"></a><a class="link" href="#sec:extra_properties">Extra properties</a></h5>
<div class="paragraph">
<p>All enhanced objects in Gradle&#8217;s domain model can hold extra user-defined properties. This includes, but is not limited to, projects, tasks, and source sets. Extra properties can be added, read and set via the owning object&#8217;s <code>ext</code> property. Alternatively, an <code>ext</code> block can be used to add multiple properties at once.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_extra_properties"><a class="anchor" href="#example_using_extra_properties"></a><a class="link" href="#example_using_extra_properties">Example: Using extra properties</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">java</span><span class="delimiter">&quot;</span></span>

ext {
    springVersion = <span class="string"><span class="delimiter">&quot;</span><span class="content">3.1.0.RELEASE</span><span class="delimiter">&quot;</span></span>
    emailNotification = <span class="string"><span class="delimiter">&quot;</span><span class="content">build@master.org</span><span class="delimiter">&quot;</span></span>
}

sourceSets.all { ext.purpose = <span class="predefined-constant">null</span> }

sourceSets {
    main {
        purpose = <span class="string"><span class="delimiter">&quot;</span><span class="content">production</span><span class="delimiter">&quot;</span></span>
    }
    test {
        purpose = <span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>
    }
    plugin {
        purpose = <span class="string"><span class="delimiter">&quot;</span><span class="content">production</span><span class="delimiter">&quot;</span></span>
    }
}

task printProperties {
    doLast {
        println springVersion
        println emailNotification
        sourceSets.matching { <span class="local-variable">it</span>.purpose == <span class="string"><span class="delimiter">&quot;</span><span class="content">production</span><span class="delimiter">&quot;</span></span> }.each { println <span class="local-variable">it</span>.name }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q printProperties</code></strong></div>
<div class="content">
<pre>&gt; gradle -q printProperties
3.1.0.RELEASE
build@master.org
main
plugin</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, an <code>ext</code> block adds two extra properties to the <code>project</code> object. Additionally, a property named <code>purpose</code> is added to each source set by setting <code>ext.purpose</code> to <code>null</code> (<code>null</code> is a permissible value). Once the properties have been added, they can be read and set like predefined properties.</p>
</div>
<div class="paragraph">
<p>By requiring special syntax for adding a property, Gradle can fail fast when an attempt is made to set a (predefined or extra) property but the property is misspelled or does not exist. Extra properties can be accessed from anywhere their owning object can be accessed, giving them a wider scope than local variables. Extra properties on a project are visible from its subprojects.</p>
</div>
<div class="paragraph">
<p>For further details on extra properties and their API, see the <a href="../dsl/org.gradle.api.plugins.ExtraPropertiesExtension.html">ExtraPropertiesExtension</a> class in the API documentation.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring_arbitrary_objects"><a class="anchor" href="#sec:configuring_arbitrary_objects"></a><a class="link" href="#sec:configuring_arbitrary_objects">Configuring arbitrary objects</a></h4>
<div class="paragraph">
<p>You can configure arbitrary objects in the following very readable way.</p>
</div>
<div class="sect4">
<h5 id="example_configuring_arbitrary_objects"><a class="anchor" href="#example_configuring_arbitrary_objects"></a><a class="link" href="#example_configuring_arbitrary_objects">Example: Configuring arbitrary objects</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task configure {
    doLast {
        <span class="keyword">def</span> pos = configure(<span class="keyword">new</span> java.text.FieldPosition(<span class="integer">10</span>)) {
            beginIndex = <span class="integer">1</span>
            endIndex = <span class="integer">5</span>
        }
        println pos.beginIndex
        println pos.endIndex
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q configure</code></strong></div>
<div class="content">
<pre>&gt; gradle -q configure
1
5</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring_arbitrary_objects_using_an_external_script"><a class="anchor" href="#sec:configuring_arbitrary_objects_using_an_external_script"></a><a class="link" href="#sec:configuring_arbitrary_objects_using_an_external_script">Configuring arbitrary objects using an external script</a></h4>
<div class="paragraph">
<p>You can also configure arbitrary objects using an external script.</p>
</div>
<div class="sect4">
<h5 id="example_configuring_arbitrary_objects_using_a_script"><a class="anchor" href="#example_configuring_arbitrary_objects_using_a_script"></a><a class="link" href="#example_configuring_arbitrary_objects_using_a_script">Example: Configuring arbitrary objects using a script</a></h5>
<div class="exampleblock multi-language-sample">
<div class="content">
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task configure {
    doLast {
        <span class="keyword">def</span> pos = <span class="keyword">new</span> java.text.FieldPosition(<span class="integer">10</span>)
        <span class="comment">// Apply the script</span>
        apply <span class="key">from</span>: <span class="string"><span class="delimiter">'</span><span class="content">other.gradle</span><span class="delimiter">'</span></span>, <span class="key">to</span>: pos
        println pos.beginIndex
        println pos.endIndex
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">other.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// Set properties.</span>
beginIndex = <span class="integer">1</span>
endIndex = <span class="integer">5</span></code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q configure</code></div>
<div class="content">
<pre>&gt; gradle -q configure
1
5</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="groovy-dsl-basics"><a class="anchor" href="#groovy-dsl-basics"></a><a class="link" href="#groovy-dsl-basics">Some Groovy basics</a></h4>
<div class="paragraph">
<p>The <a href="http://docs.groovy-lang.org/latest/html/documentation/index.html">Groovy language</a> provides plenty of features for creating DSLs, and the Gradle build language takes advantage of these. Understanding how the build language works will help you when you write your build script, and in particular, when you start to write custom plugins and tasks.</p>
</div>
<div class="sect4">
<h5 id="sec:groovy_jdk"><a class="anchor" href="#sec:groovy_jdk"></a><a class="link" href="#sec:groovy_jdk">Groovy JDK</a></h5>
<div class="paragraph">
<p>Groovy adds lots of useful methods to the standard Java classes. For example, <code>Iterable</code> gets an <code>each</code> method, which iterates over the elements of the <code>Iterable</code>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_groovy_jdk_methods"><a class="anchor" href="#example_groovy_jdk_methods"></a><a class="link" href="#example_groovy_jdk_methods">Example: Groovy JDK methods</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// Iterable gets an each() method</span>
configurations.runtime.each { <span class="predefined-type">File</span> f -&gt; println f }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Have a look at <a href="http://groovy-lang.org/gdk.html" class="bare">http://groovy-lang.org/gdk.html</a> for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:property_accessors"><a class="anchor" href="#sec:property_accessors"></a><a class="link" href="#sec:property_accessors">Property accessors</a></h5>
<div class="paragraph">
<p>Groovy automatically converts a property reference into a call to the appropriate getter or setter method.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_property_accessors"><a class="anchor" href="#example_property_accessors"></a><a class="link" href="#example_property_accessors">Example: Property accessors</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// Using a getter method</span>
println project.buildDir
println getProject().getBuildDir()

<span class="comment">// Using a setter method</span>
project.buildDir = <span class="string"><span class="delimiter">'</span><span class="content">target</span><span class="delimiter">'</span></span>
getProject().setBuildDir(<span class="string"><span class="delimiter">'</span><span class="content">target</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:optional_parentheses_on_method_calls"><a class="anchor" href="#sec:optional_parentheses_on_method_calls"></a><a class="link" href="#sec:optional_parentheses_on_method_calls">Optional parentheses on method calls</a></h5>
<div class="paragraph">
<p>Parentheses are optional for method calls.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_method_call_without_parentheses"><a class="anchor" href="#example_method_call_without_parentheses"></a><a class="link" href="#example_method_call_without_parentheses">Example: Method call without parentheses</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test.systemProperty <span class="string"><span class="delimiter">'</span><span class="content">some.prop</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">value</span><span class="delimiter">'</span></span>
test.systemProperty(<span class="string"><span class="delimiter">'</span><span class="content">some.prop</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">value</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:list_and_map_literals"><a class="anchor" href="#sec:list_and_map_literals"></a><a class="link" href="#sec:list_and_map_literals">List and map literals</a></h5>
<div class="paragraph">
<p>Groovy provides some shortcuts for defining <code>List</code> and <code>Map</code> instances. Both kinds of literals are straightforward, but map literals have some interesting twists.</p>
</div>
<div class="paragraph">
<p>For instance, the <code>apply</code> method (where you typically apply plugins) actually takes a map parameter. However, when you have a line like <code>apply plugin:'java'</code>, you aren&#8217;t actually using a map literal, you&#8217;re actually using named parameters, which have almost exactly the same syntax as a map literal (without the wrapping brackets). That named parameter list gets converted to a map when the method is called, but it doesn&#8217;t start out as a map.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_list_and_map_literals"><a class="anchor" href="#example_list_and_map_literals"></a><a class="link" href="#example_list_and_map_literals">Example: List and map literals</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// List literal</span>
test.includes = [<span class="string"><span class="delimiter">'</span><span class="content">org/gradle/api/**</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">org/gradle/internal/**</span><span class="delimiter">'</span></span>]

<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; list = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;<span class="predefined-type">String</span>&gt;()
list.add(<span class="string"><span class="delimiter">'</span><span class="content">org/gradle/api/**</span><span class="delimiter">'</span></span>)
list.add(<span class="string"><span class="delimiter">'</span><span class="content">org/gradle/internal/**</span><span class="delimiter">'</span></span>)
test.includes = list

<span class="comment">// Map literal.</span>
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; map = [<span class="key">key1</span>:<span class="string"><span class="delimiter">'</span><span class="content">value1</span><span class="delimiter">'</span></span>, <span class="key">key2</span>: <span class="string"><span class="delimiter">'</span><span class="content">value2</span><span class="delimiter">'</span></span>]

<span class="comment">// Groovy will coerce named arguments</span>
<span class="comment">// into a single map argument</span>
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:closures_as_the_last_parameter_in_a_method"><a class="anchor" href="#sec:closures_as_the_last_parameter_in_a_method"></a><a class="link" href="#sec:closures_as_the_last_parameter_in_a_method">Closures as the last parameter in a method</a></h5>
<div class="paragraph">
<p>The Gradle DSL uses closures in many places. You can find out more about closures <a href="http://docs.groovy-lang.org/latest/html/documentation/index.html#_closures">here</a>. When the last parameter of a method is a closure, you can place the closure after the method call:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_closure_as_method_parameter"><a class="anchor" href="#example_closure_as_method_parameter"></a><a class="link" href="#example_closure_as_method_parameter">Example: Closure as method parameter</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">in a closure</span><span class="delimiter">&quot;</span></span>
}
repositories() { println <span class="string"><span class="delimiter">&quot;</span><span class="content">in a closure</span><span class="delimiter">&quot;</span></span> }
repositories({ println <span class="string"><span class="delimiter">&quot;</span><span class="content">in a closure</span><span class="delimiter">&quot;</span></span> })</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:closure_delegate"><a class="anchor" href="#sec:closure_delegate"></a><a class="link" href="#sec:closure_delegate">Closure delegate</a></h5>
<div class="paragraph">
<p>Each closure has a <code>delegate</code> object, which Groovy uses to look up variable and method references which are not local variables or parameters of the closure. Gradle uses this for <em>configuration closures</em>, where the <code>delegate</code> object is set to the object to be configured.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_closure_delegates"><a class="anchor" href="#example_closure_delegates"></a><a class="link" href="#example_closure_delegates">Example: Closure delegates</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    <span class="keyword">assert</span> delegate == project.dependencies
    testCompile(<span class="string"><span class="delimiter">'</span><span class="content">junit:junit:4.12</span><span class="delimiter">'</span></span>)
    delegate.testCompile(<span class="string"><span class="delimiter">'</span><span class="content">junit:junit:4.12</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="script-default-imports"><a class="anchor" href="#script-default-imports"></a><a class="link" href="#script-default-imports">Default imports</a></h4>
<div class="paragraph">
<p>To make build scripts more concise, Gradle automatically adds a set of import statements to the Gradle scripts. This means that instead of using <code>throw new org.gradle.api.tasks.StopExecutionException()</code> you can just type <code>throw new StopExecutionException()</code> instead.</p>
</div>
<div class="paragraph">
<p>Listed below are the imports added to each script:</p>
</div>
<div class="listingblock">
<div class="title">Gradle default imports</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.gradle.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.artifacts.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.artifacts.component.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.artifacts.dsl.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.artifacts.ivy.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.artifacts.maven.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.artifacts.query.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.artifacts.repositories.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.artifacts.result.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.artifacts.transform.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.artifacts.type.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.attributes.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.capabilities.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.component.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.credentials.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.distribution.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.distribution.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.dsl.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.execution.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.file.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.initialization.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.initialization.definition.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.initialization.dsl.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.invocation.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.java.archives.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.logging.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.logging.configuration.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.model.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.plugins.announce.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.plugins.antlr.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.plugins.buildcomparison.gradle.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.plugins.osgi.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.plugins.quality.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.plugins.scala.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.provider.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.publish.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.publish.ivy.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.publish.ivy.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.publish.ivy.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.publish.maven.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.publish.maven.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.publish.maven.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.publish.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.publish.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.reflect.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.reporting.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.reporting.components.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.reporting.dependencies.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.reporting.dependents.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.reporting.model.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.reporting.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.resources.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.specs.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.ant.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.application.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.bundling.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.compile.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.diagnostics.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.incremental.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.javadoc.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.options.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.scala.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.testing.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.testing.junit.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.testing.junitplatform.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.testing.testng.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.util.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.wrapper.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.authentication.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.authentication.aws.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.authentication.http.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.buildinit.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.buildinit.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.caching.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.caching.configuration.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.caching.http.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.caching.local.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.concurrent.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.external.javadoc.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.ide.visualstudio.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.ide.visualstudio.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.ide.visualstudio.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.ide.xcode.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.ide.xcode.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.ide.xcode.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.ivy.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.jvm.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.jvm.application.scripts.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.jvm.application.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.jvm.platform.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.jvm.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.jvm.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.jvm.tasks.api.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.jvm.test.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.jvm.toolchain.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.assembler.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.assembler.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.assembler.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.base.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.base.artifact.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.base.compile.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.base.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.base.sources.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.c.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.c.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.c.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.coffeescript.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.cpp.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.cpp.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.cpp.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.java.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.java.artifact.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.java.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.java.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.javascript.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.jvm.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.jvm.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.jvm.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.nativeplatform.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.nativeplatform.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.objectivec.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.objectivec.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.objectivec.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.objectivecpp.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.objectivecpp.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.objectivecpp.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.rc.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.rc.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.rc.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.routes.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.scala.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.scala.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.scala.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.scala.toolchain.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.swift.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.swift.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.swift.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.language.twirl.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.maven.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.model.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.platform.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.cpp.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.cpp.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.cunit.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.cunit.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.cunit.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.googletest.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.googletest.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.xctest.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.xctest.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.test.xctest.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.toolchain.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.nativeplatform.toolchain.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.normalization.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.platform.base.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.platform.base.binary.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.platform.base.component.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.platform.base.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.play.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.play.distribution.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.play.platform.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.play.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.play.plugins.ide.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.play.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.play.toolchain.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugin.devel.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugin.devel.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugin.devel.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugin.management.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugin.use.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.ear.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.ear.descriptor.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.ide.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.ide.api.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.ide.eclipse.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.ide.idea.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.javascript.base.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.javascript.coffeescript.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.javascript.envjs.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.javascript.envjs.browser.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.javascript.envjs.http.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.javascript.envjs.http.simple.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.javascript.jshint.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.javascript.rhino.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.signing.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.signing.signatory.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.signing.signatory.pgp.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.signing.type.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.plugins.signing.type.pgp.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.process.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.swiftpm.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.swiftpm.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.swiftpm.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.testing.base.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.testing.base.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.testing.jacoco.plugins.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.testing.jacoco.tasks.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.testing.jacoco.tasks.rules.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.testkit.runner.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.vcs.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.vcs.git.*</span>
<span class="keyword">import</span> <span class="include">org.gradle.workers.*</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="custom_tasks"><a class="anchor" href="#custom_tasks"></a><a class="link" href="#custom_tasks">Writing Custom Task Classes</a></h3>
<div class="paragraph">
<p>Gradle supports two types of task. One such type is the simple task, where you define the task with an action closure. We have seen these in <a href="#tutorial_using_tasks">Build Script Basics</a>. For this type of task, the action closure determines the behaviour of the task. This type of task is good for implementing one-off tasks in your build script.</p>
</div>
<div class="paragraph">
<p>The other type of task is the enhanced task, where the behaviour is built into the task, and the task provides some properties which you can use to configure the behaviour. We have seen these in <a href="#more_about_tasks">Authoring Tasks</a>. Most Gradle plugins use enhanced tasks. With enhanced tasks, you don&#8217;t need to implement the task behaviour as you do with simple tasks. You simply declare the task and configure the task using its properties. In this way, enhanced tasks let you reuse a piece of behaviour in many different places, possibly across different builds.</p>
</div>
<div class="paragraph">
<p>The behaviour and properties of an enhanced task is defined by the task&#8217;s class. When you declare an enhanced task, you specify the type, or class of the task.</p>
</div>
<div class="paragraph">
<p>Implementing your own custom task class in Gradle is easy. You can implement a custom task class in pretty much any language you like, provided it ends up compiled to bytecode. In our examples, we are going to use Groovy as the implementation language. Groovy, Java or Kotlin are all good choices as the language to use to implement a task class, as the Gradle API has been designed to work well with these languages. In general, a task implemented using Java or Kotlin, which are statically typed, will perform better than the same task implemented using Groovy.</p>
</div>
<div class="sect3">
<h4 id="sec:packaging_a_task_class"><a class="anchor" href="#sec:packaging_a_task_class"></a><a class="link" href="#sec:packaging_a_task_class">Packaging a task class</a></h4>
<div class="paragraph">
<p>There are several places where you can put the source for the task class.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Build script</dt>
<dd>
<p>You can include the task class directly in the build script. This has the benefit that the task class is automatically compiled and included in the classpath of the build script without you having to do anything. However, the task class is not visible outside the build script, and so you cannot reuse the task class outside the build script it is defined in.</p>
</dd>
<dt class="hdlist1"><code>buildSrc</code> project</dt>
<dd>
<p>You can put the source for the task class in the <code><em>rootProjectDir</em>/buildSrc/src/main/groovy</code> directory. Gradle will take care of compiling and testing the task class and making it available on the classpath of the build script. The task class is visible to every build script used by the build. However, it is not visible outside the build, and so you cannot reuse the task class outside the build it is defined in. Using the <code>buildSrc</code> project approach separates the task declaration - that is, what the task should do - from the task implementation - that is, how the task does it.</p>
<div class="paragraph">
<p>See <a href="#organizing_gradle_projects">Organizing Gradle Projects</a> for more details about the <code>buildSrc</code> project.</p>
</div>
</dd>
<dt class="hdlist1">Standalone project</dt>
<dd>
<p>You can create a separate project for your task class. This project produces and publishes a JAR which you can then use in multiple builds and share with others. Generally, this JAR might include some custom plugins, or bundle several related task classes into a single library. Or some combination of the two.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In our examples, we will start with the task class in the build script, to keep things simple. Then we will look at creating a standalone project.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:writing_a_simple_task_class"><a class="anchor" href="#sec:writing_a_simple_task_class"></a><a class="link" href="#sec:writing_a_simple_task_class">Writing a simple task class</a></h4>
<div class="paragraph">
<p>To implement a custom task class, you extend <a href="../dsl/org.gradle.api.DefaultTask.html">DefaultTask</a>.</p>
</div>
<div class="sect4">
<h5 id="example_defining_a_custom_task"><a class="anchor" href="#example_defining_a_custom_task"></a><a class="link" href="#example_defining_a_custom_task">Example: Defining a custom task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">GreetingTask</span> <span class="directive">extends</span> DefaultTask {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This task doesn&#8217;t do anything useful, so let&#8217;s add some behaviour. To do so, we add a method to the task and mark it with the <a href="../javadoc/org/gradle/api/tasks/TaskAction.html">TaskAction</a> annotation. Gradle will call the method when the task executes. You don&#8217;t have to use a method to define the behaviour for the task. You could, for instance, call <code>doFirst()</code> or <code>doLast()</code> with a closure in the task constructor to add behaviour.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_hello_world_task"><a class="anchor" href="#example_a_hello_world_task"></a><a class="link" href="#example_a_hello_world_task">Example: A hello world task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">GreetingTask</span> <span class="directive">extends</span> DefaultTask {
    <span class="annotation">@TaskAction</span>
    <span class="keyword">def</span> <span class="function">greet</span>() {
        println <span class="string"><span class="delimiter">'</span><span class="content">hello from GreetingTask</span><span class="delimiter">'</span></span>
    }
}

<span class="comment">// Create a task using the task type</span>
task hello(<span class="key">type</span>: GreetingTask)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
hello from GreetingTask</pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s add a property to the task, so we can customize it. Tasks are simply POGOs, and when you declare a task, you can set the properties or call methods on the task object. Here we add a <code>greeting</code> property, and set the value when we declare the <code>greeting</code> task.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_customizable_hello_world_task"><a class="anchor" href="#example_a_customizable_hello_world_task"></a><a class="link" href="#example_a_customizable_hello_world_task">Example: A customizable hello world task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">GreetingTask</span> <span class="directive">extends</span> DefaultTask {
    <span class="predefined-type">String</span> greeting = <span class="string"><span class="delimiter">'</span><span class="content">hello from GreetingTask</span><span class="delimiter">'</span></span>

    <span class="annotation">@TaskAction</span>
    <span class="keyword">def</span> <span class="function">greet</span>() {
        println greeting
    }
}

<span class="comment">// Use the default greeting</span>
task hello(<span class="key">type</span>: GreetingTask)

<span class="comment">// Customize the greeting</span>
task greeting(<span class="key">type</span>: GreetingTask) {
    greeting = <span class="string"><span class="delimiter">'</span><span class="content">greetings from GreetingTask</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello greeting</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello greeting
hello from GreetingTask
greetings from GreetingTask</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:custom_tasks_standalone_project"><a class="anchor" href="#sec:custom_tasks_standalone_project"></a><a class="link" href="#sec:custom_tasks_standalone_project">A standalone project</a></h4>
<div class="paragraph">
<p>Now we will move our task to a standalone project, so we can publish it and share it with others. This project is simply a Groovy project that produces a JAR containing the task class. Here is a simple build script for the project. It applies the Groovy plugin, and adds the Gradle API as a compile-time dependency.</p>
</div>
<div class="sect4">
<h5 id="example_a_build_for_a_custom_task"><a class="anchor" href="#example_a_build_for_a_custom_task"></a><a class="link" href="#example_a_build_for_a_custom_task">Example: A build for a custom task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">groovy</span><span class="delimiter">'</span></span>
}

dependencies {
    compile gradleApi()
    compile localGroovy()
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/customPlugin/plugin</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We just follow the convention for where the source for the task class should go.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_custom_task"><a class="anchor" href="#example_a_custom_task"></a><a class="link" href="#example_a_custom_task">Example: A custom task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">src/main/groovy/org/gradle/GreetingTask.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> org.gradle

<span class="keyword">import</span> <span class="include">org.gradle.api.DefaultTask</span>
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.TaskAction</span>

<span class="type">class</span> <span class="class">GreetingTask</span> <span class="directive">extends</span> DefaultTask {
    <span class="predefined-type">String</span> greeting = <span class="string"><span class="delimiter">'</span><span class="content">hello from GreetingTask</span><span class="delimiter">'</span></span>

    <span class="annotation">@TaskAction</span>
    <span class="keyword">def</span> <span class="function">greet</span>() {
        println greeting
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_your_task_class_in_another_project"><a class="anchor" href="#sec:using_your_task_class_in_another_project"></a><a class="link" href="#sec:using_your_task_class_in_another_project">Using your task class in another project</a></h5>
<div class="paragraph">
<p>To use a task class in a build script, you need to add the class to the build script&#8217;s classpath. To do this, you use a <code>buildscript { }</code> block, as described in <a href="#sec:build_script_external_dependencies">External dependencies for the build script</a>. The following example shows how you might do this when the JAR containing the task class has been published to a local repository:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_a_custom_task_in_another_project"><a class="anchor" href="#example_using_a_custom_task_in_another_project"></a><a class="link" href="#example_using_a_custom_task_in_another_project">Example: Using a custom task in another project</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">buildscript {
    repositories {
        maven {
<span class="comment">// END SNIPPET use-plugin</span>
<span class="comment">// END SNIPPET use-task</span>
            <span class="keyword">def</span> producerName = findProperty(<span class="string"><span class="delimiter">'</span><span class="content">producerName</span><span class="delimiter">'</span></span>) ?: <span class="string"><span class="delimiter">'</span><span class="content">plugin</span><span class="delimiter">'</span></span>
            <span class="keyword">def</span> repoLocation = <span class="string"><span class="delimiter">&quot;</span><span class="content">../</span><span class="inline"><span class="inline-delimiter">$</span>producerName</span><span class="content">/build/repo</span><span class="delimiter">&quot;</span></span>
<span class="comment">// START SNIPPET use-plugin</span>
<span class="comment">// START SNIPPET use-task</span>
            url = uri(repoLocation)
        }
    }
    dependencies {
        classpath <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.gradle</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">customPlugin</span><span class="delimiter">'</span></span>,
                                  <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">1.0-SNAPSHOT</span><span class="delimiter">'</span></span>
    }
}

task greeting(<span class="key">type</span>: org.gradle.GreetingTask) {
    greeting = <span class="string"><span class="delimiter">'</span><span class="content">howdy!</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:writing_tests_for_your_task_class"><a class="anchor" href="#sec:writing_tests_for_your_task_class"></a><a class="link" href="#sec:writing_tests_for_your_task_class">Writing tests for your task class</a></h5>
<div class="paragraph">
<p>You can use the <a href="../javadoc/org/gradle/testfixtures/ProjectBuilder.html">ProjectBuilder</a> class to create <a href="../dsl/org.gradle.api.Project.html">Project</a> instances to use when you test your task class.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_testing_a_custom_task"><a class="anchor" href="#example_testing_a_custom_task"></a><a class="link" href="#example_testing_a_custom_task">Example: Testing a custom task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">src/test/groovy/org/gradle/GreetingTaskTest.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">GreetingTaskTest</span> {
    <span class="annotation">@Test</span>
    <span class="directive">public</span> <span class="type">void</span> canAddTaskToProject() {
        Project project = ProjectBuilder.builder().build()
        <span class="keyword">def</span> task = project.task(<span class="string"><span class="delimiter">'</span><span class="content">greeting</span><span class="delimiter">'</span></span>, <span class="key">type</span>: GreetingTask)
        assertTrue(task <span class="keyword">instanceof</span> GreetingTask)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="incremental_tasks"><a class="anchor" href="#incremental_tasks"></a><a class="link" href="#incremental_tasks">Incremental tasks</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Incremental tasks are an <a href="#feature_lifecycle">incubating</a> feature.</p>
</div>
<div class="paragraph">
<p>Since the introduction of the implementation described above (early in the Gradle 1.6 release cycle), discussions within the Gradle community have produced superior ideas for exposing the information about changes to task implementors to what is described below. As such, the API for this feature will almost certainly change in upcoming releases. However, please do experiment with the current implementation and share your experiences with the Gradle community.</p>
</div>
<div class="paragraph">
<p>The feature incubation process, which is part of the Gradle feature lifecycle (see <a href="#feature_lifecycle">Feature Lifecycle</a>), exists for this purpose of ensuring high quality final implementations through incorporation of early user feedback.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With Gradle, it&#8217;s very simple to implement a task that is skipped when all of its inputs and outputs are up to date (see <a href="#sec:up_to_date_checks">Incremental Builds</a>). However, there are times when only a few input files have changed since the last execution, and you&#8217;d like to avoid reprocessing all of the unchanged inputs. This can be particularly useful for a transformer task, that converts input files to output files on a 1:1 basis.</p>
</div>
<div class="paragraph">
<p>If you&#8217;d like to optimise your build so that only out-of-date inputs are processed, you can do so with an <em>incremental task</em>.</p>
</div>
<div class="sect4">
<h5 id="sec:implementing_an_incremental_task"><a class="anchor" href="#sec:implementing_an_incremental_task"></a><a class="link" href="#sec:implementing_an_incremental_task">Implementing an incremental task</a></h5>
<div class="paragraph">
<p>For a task to process inputs incrementally, that task must contain an <em>incremental task action</em>. This is a task action method that contains a single <a href="../javadoc/org/gradle/api/tasks/incremental/IncrementalTaskInputs.html">IncrementalTaskInputs</a> parameter, which indicates to Gradle that the action will process the changed inputs only.</p>
</div>
<div class="paragraph">
<p>The incremental task action may supply an <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:outOfDate(org.gradle.api.Action)">IncrementalTaskInputs.outOfDate(org.gradle.api.Action)</a> action for processing any input file that is out-of-date, and a <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:removed(org.gradle.api.Action)">IncrementalTaskInputs.removed(org.gradle.api.Action)</a> action that executes for any input file that has been removed since the previous execution.</p>
</div>
</div>
<div class="sect4">
<h5 id="taskDefinition"><a class="anchor" href="#taskDefinition"></a><a class="link" href="#taskDefinition">Example: Defining an incremental task action</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">IncrementalReverseTask</span> <span class="directive">extends</span> DefaultTask {
    <span class="annotation">@InputDirectory</span>
    <span class="keyword">def</span> <span class="predefined-type">File</span> inputDir

    <span class="annotation">@OutputDirectory</span>
    <span class="keyword">def</span> <span class="predefined-type">File</span> outputDir

    <span class="annotation">@Input</span>
    <span class="keyword">def</span> inputProperty

    <span class="annotation">@TaskAction</span>
    <span class="type">void</span> execute(IncrementalTaskInputs inputs) {
        println inputs.incremental ? <span class="string"><span class="delimiter">'</span><span class="content">CHANGED inputs considered out of date</span><span class="delimiter">'</span></span>
                                   : <span class="string"><span class="delimiter">'</span><span class="content">ALL inputs considered out of date</span><span class="delimiter">'</span></span>
        <span class="keyword">if</span> (!inputs.incremental)
            project.delete(outputDir.listFiles())

        inputs.outOfDate { change -&gt;
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">out of date: </span><span class="inline"><span class="inline-delimiter">${</span>change.file.name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
            <span class="keyword">def</span> targetFile = <span class="keyword">new</span> <span class="predefined-type">File</span>(outputDir, change.file.name)
            targetFile.text = change.file.text.reverse()
        }

        inputs.removed { change -&gt;
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">removed: </span><span class="inline"><span class="inline-delimiter">${</span>change.file.name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
            <span class="keyword">def</span> targetFile = <span class="keyword">new</span> <span class="predefined-type">File</span>(outputDir, change.file.name)
            targetFile.delete()
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/userguide/tasks/incrementalTask</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If for some reason the task is not run incremental, e.g. by running with <code>--rerun-tasks</code>, only the outOfDate action is executed, even if there were deleted input files. You should consider handling this case at the beginning, as is done in the example above.</p>
</div>
<div class="paragraph">
<p>For a simple transformer task like this, the task action simply needs to generate output files for any out-of-date inputs, and delete output files for any removed inputs.</p>
</div>
<div class="paragraph">
<p>A task may only contain a single incremental task action.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:which_inputs_are_considered_out_of_date"><a class="anchor" href="#sec:which_inputs_are_considered_out_of_date"></a><a class="link" href="#sec:which_inputs_are_considered_out_of_date">Which inputs are considered out of date?</a></h5>
<div class="paragraph">
<p>When Gradle has history of a previous task execution, and the only changes to the task execution context since that execution are to input files, then Gradle is able to determine which input files need to be reprocessed by the task. In this case, the <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:outOfDate(org.gradle.api.Action)">IncrementalTaskInputs.outOfDate(org.gradle.api.Action)</a> action will be executed for any input file that was <em>added</em> or <em>modified</em>, and the <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:removed(org.gradle.api.Action)">IncrementalTaskInputs.removed(org.gradle.api.Action)</a> action will be executed for any <em>removed</em> input file.</p>
</div>
<div class="paragraph">
<p>However, there are many cases where Gradle is unable to determine which input files need to be reprocessed. Examples include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There is no history available from a previous execution.</p>
</li>
<li>
<p>You are building with a different version of Gradle. Currently, Gradle does not use task history from a different version.</p>
</li>
<li>
<p>An <code>upToDateWhen</code> criteria added to the task returns <code>false</code>.</p>
</li>
<li>
<p>An input property has changed since the previous execution.</p>
</li>
<li>
<p>One or more output files have changed since the previous execution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In any of these cases, Gradle will consider all of the input files to be <code>outOfDate</code>. The <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:outOfDate(org.gradle.api.Action)">IncrementalTaskInputs.outOfDate(org.gradle.api.Action)</a> action will be executed for every input file, and the <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:removed(org.gradle.api.Action)">IncrementalTaskInputs.removed(org.gradle.api.Action)</a> action will not be executed at all.</p>
</div>
<div class="paragraph">
<p>You can check if Gradle was able to determine the incremental changes to input files with <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:incremental">IncrementalTaskInputs.isIncremental()</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:an_incremental_task_in_action"><a class="anchor" href="#sec:an_incremental_task_in_action"></a><a class="link" href="#sec:an_incremental_task_in_action">An incremental task in action</a></h5>
<div class="paragraph">
<p>Given the incremental task implementation <a href="#taskDefinition">above</a>, we can explore the various change scenarios by example. Note that the various mutation tasks ('updateInputs', 'removeInput', etc) are only present for demonstration purposes: these would not normally be part of your build script.</p>
</div>
<div class="paragraph">
<p>First, consider the <code>IncrementalReverseTask</code> executed against a set of inputs for the first time. In this case, all inputs will be considered out of date:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_running_the_incremental_task_for_the_first_time"><a class="anchor" href="#example_running_the_incremental_task_for_the_first_time"></a><a class="link" href="#example_running_the_incremental_task_for_the_first_time">Example: Running the incremental task for the first time</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task incrementalReverse(<span class="key">type</span>: IncrementalReverseTask) {
    inputDir = file(<span class="string"><span class="delimiter">'</span><span class="content">inputs</span><span class="delimiter">'</span></span>)
    outputDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/outputs</span><span class="delimiter">&quot;</span></span>)
    inputProperty = project.properties[<span class="string"><span class="delimiter">'</span><span class="content">taskInputProperty</span><span class="delimiter">'</span></span>] ?: <span class="string"><span class="delimiter">'</span><span class="content">original</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Build layout</div>
<div class="content">
<pre>.
 build.gradle
 inputs
     1.txt
     2.txt
     3.txt</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q incrementalReverse</code></div>
<div class="content">
<pre>&gt; gradle -q incrementalReverse
ALL inputs considered out of date
out of date: 1.txt
out of date: 2.txt
out of date: 3.txt</pre>
</div>
</div>
<div class="paragraph">
<p>Naturally when the task is executed again with no changes, then the entire task is up to date and no files are reported to the task action:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_running_the_incremental_task_with_unchanged_inputs"><a class="anchor" href="#example_running_the_incremental_task_with_unchanged_inputs"></a><a class="link" href="#example_running_the_incremental_task_with_unchanged_inputs">Example: Running the incremental task with unchanged inputs</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q incrementalReverse</code></strong></div>
<div class="content">
<pre>&gt; gradle -q incrementalReverse</pre>
</div>
</div>
<div class="paragraph">
<p>When an input file is modified in some way or a new input file is added, then re-executing the task results in those files being reported to <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:outOfDate(org.gradle.api.Action)">IncrementalTaskInputs.outOfDate(org.gradle.api.Action)</a>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_running_the_incremental_task_with_updated_input_files"><a class="anchor" href="#example_running_the_incremental_task_with_updated_input_files"></a><a class="link" href="#example_running_the_incremental_task_with_updated_input_files">Example: Running the incremental task with updated input files</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task updateInputs() {
    doLast {
        file(<span class="string"><span class="delimiter">'</span><span class="content">inputs/1.txt</span><span class="delimiter">'</span></span>).text = <span class="string"><span class="delimiter">'</span><span class="content">Changed content for existing file 1.</span><span class="delimiter">'</span></span>
        file(<span class="string"><span class="delimiter">'</span><span class="content">inputs/4.txt</span><span class="delimiter">'</span></span>).text = <span class="string"><span class="delimiter">'</span><span class="content">Content for new file 4.</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q updateInputs incrementalReverse</code></strong></div>
<div class="content">
<pre>&gt; gradle -q updateInputs incrementalReverse
CHANGED inputs considered out of date
out of date: 1.txt
out of date: 4.txt</pre>
</div>
</div>
<div class="paragraph">
<p>When an existing input file is removed, then re-executing the task results in that file being reported to <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:removed(org.gradle.api.Action)">IncrementalTaskInputs.removed(org.gradle.api.Action)</a>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_running_the_incremental_task_with_an_input_file_removed"><a class="anchor" href="#example_running_the_incremental_task_with_an_input_file_removed"></a><a class="link" href="#example_running_the_incremental_task_with_an_input_file_removed">Example: Running the incremental task with an input file removed</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task removeInput() {
    doLast {
        file(<span class="string"><span class="delimiter">'</span><span class="content">inputs/3.txt</span><span class="delimiter">'</span></span>).delete()
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q removeInput incrementalReverse</code></strong></div>
<div class="content">
<pre>&gt; gradle -q removeInput incrementalReverse
CHANGED inputs considered out of date
removed: 3.txt</pre>
</div>
</div>
<div class="paragraph">
<p>When an output file is deleted (or modified), then Gradle is unable to determine which input files are out of date. In this case, <em>all</em> input files are reported to the <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:outOfDate(org.gradle.api.Action)">IncrementalTaskInputs.outOfDate(org.gradle.api.Action)</a> action, and no input files are reported to the <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:removed(org.gradle.api.Action)">IncrementalTaskInputs.removed(org.gradle.api.Action)</a> action:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_running_the_incremental_task_with_an_output_file_removed"><a class="anchor" href="#example_running_the_incremental_task_with_an_output_file_removed"></a><a class="link" href="#example_running_the_incremental_task_with_an_output_file_removed">Example: Running the incremental task with an output file removed</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task removeOutput() {
    doLast {
        file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/outputs/1.txt</span><span class="delimiter">&quot;</span></span>).delete()
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q removeOutput incrementalReverse</code></strong></div>
<div class="content">
<pre>&gt; gradle -q removeOutput incrementalReverse
ALL inputs considered out of date
out of date: 1.txt
out of date: 2.txt
out of date: 3.txt</pre>
</div>
</div>
<div class="paragraph">
<p>When a task input property is modified, Gradle is unable to determine how this property impacted the task outputs, so all input files are assumed to be out of date. So similar to the changed output file example, <em>all</em> input files are reported to the <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:outOfDate(org.gradle.api.Action)">IncrementalTaskInputs.outOfDate(org.gradle.api.Action)</a> action, and no input files are reported to the <a href="../dsl/org.gradle.api.tasks.incremental.IncrementalTaskInputs.html#org.gradle.api.tasks.incremental.IncrementalTaskInputs:removed(org.gradle.api.Action)">IncrementalTaskInputs.removed(org.gradle.api.Action)</a> action:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_running_the_incremental_task_with_an_input_property_changed"><a class="anchor" href="#example_running_the_incremental_task_with_an_input_property_changed"></a><a class="link" href="#example_running_the_incremental_task_with_an_input_property_changed">Example: Running the incremental task with an input property changed</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q -PtaskInputProperty=changed incrementalReverse</code></strong></div>
<div class="content">
<pre>&gt; gradle -q -PtaskInputProperty=changed incrementalReverse
ALL inputs considered out of date
out of date: 1.txt
out of date: 2.txt
out of date: 3.txt</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:storing_incremental_task_state"><a class="anchor" href="#sec:storing_incremental_task_state"></a><a class="link" href="#sec:storing_incremental_task_state">Storing incremental state for cached tasks</a></h5>
<div class="paragraph">
<p>Using Gradle&#8217;s <code>IncrementalTaskInputs</code> is not the only way to create tasks that only works on changes since the last execution. Tools like the Kotlin compiler provide incrementality as a built-in feature. The way this is typically implemented is that the tool stores some analysis data about the state of the previous execution in some file. If such state files are <a href="#sec:task_output_caching_inputs">relocatable</a>, then they can be declared as outputs of the task. This way when the task&#8217;s results are loaded from cache, the next execution can already use the analysis data loaded from cache, too.</p>
</div>
<div class="paragraph">
<p>However, if the state files are non-relocatable, then they can&#8217;t be shared via the build cache. Indeed, when the task is loaded from cache, any such state files must be cleaned up to prevent stale state to confuse the tool during the next execution. Gradle can ensure such stale files are removed if they are declared via <code>task.localState.register()</code> or a property is marked with the <code>@LocalState</code> annotation.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring_and_using_command_line_options"><a class="anchor" href="#sec:declaring_and_using_command_line_options"></a><a class="link" href="#sec:declaring_and_using_command_line_options">Declaring and Using Command Line Options</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The API for exposing command line options is an <a href="#feature_lifecycle">incubating</a> feature.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Sometimes a user wants to declare the value of an exposed task property on the command line instead of the build script. Being able to pass in property values on the command line is particularly helpful if they change more frequently. The task API supports a mechanism for marking a property to automatically generate a corresponding command line parameter with a specific name at runtime.</p>
</div>
<div class="sect4">
<h5 id="sec:declaring_task_option"><a class="anchor" href="#sec:declaring_task_option"></a><a class="link" href="#sec:declaring_task_option">Declaring a command-line option</a></h5>
<div class="paragraph">
<p>Exposing a new command line option for a task property is straightforward. You just have to annotate the corresponding setter method of a property with <a href="../javadoc/org/gradle/api/tasks/options/Option.html">Option</a>. An option requires a mandatory identifier. Additionally, you can provide an optional description. A task can expose as many command line options as properties available in the class.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s have a look at an example to illustrate the functionality. The custom task <code>UrlVerify</code> verifies whether a given URL can be resolved by making a HTTP call and checking the response code. The URL to be verified is configurable through the property <code>url</code>. The setter method for the property is annotated with <a href="../javadoc/org/gradle/api/tasks/options/Option.html">Option</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_a_command_line_option"><a class="anchor" href="#example_declaring_a_command_line_option"></a><a class="link" href="#example_declaring_a_command_line_option">Example: Declaring a command line option</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">UrlVerify.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.gradle.api.tasks.options.Option</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">UrlVerify</span> <span class="directive">extends</span> DefaultTask {
    <span class="directive">private</span> <span class="predefined-type">String</span> url;

    <span class="annotation">@Option</span>(option = <span class="string"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>, description = <span class="string"><span class="delimiter">&quot;</span><span class="content">Configures the URL to be verified.</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> setUrl(<span class="predefined-type">String</span> url) {
        <span class="local-variable">this</span>.url = url;
    }

    <span class="annotation">@Input</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getUrl() {
        <span class="keyword">return</span> url;
    }

    <span class="annotation">@TaskAction</span>
    <span class="directive">public</span> <span class="type">void</span> verify() {
        getLogger().quiet(<span class="string"><span class="delimiter">&quot;</span><span class="content">Verifying URL '{}'</span><span class="delimiter">&quot;</span></span>, url);

        <span class="comment">// verify URL by making a HTTP call</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All options declared for a task can be <a href="#sec:listing_task_options">rendered as console output</a> by running the <code>help</code> task and the <code>--task</code> option.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_task_option_command_line"><a class="anchor" href="#sec:using_task_option_command_line"></a><a class="link" href="#sec:using_task_option_command_line">Using an option on the command line</a></h5>
<div class="paragraph">
<p>Using an option on the command line has to adhere to the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The option uses a double-dash as prefix e.g. <code>--url</code>. A single dash does not qualify as valid syntax for a task option.</p>
</li>
<li>
<p>The option argument follows directly after the task declaration e.g. <code>verifyUrl --url=http://www.google.com/</code>.</p>
</li>
<li>
<p>Multiple options of a task can be declared in any order on the command line following the task name.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Getting back to the previous example, the build script creates a task instance of type <code>UrlVerify</code> and provides a value from the command line through the exposed option.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_a_command_line_option"><a class="anchor" href="#example_using_a_command_line_option"></a><a class="link" href="#example_using_a_command_line_option">Example: Using a command line option</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task verifyUrl(<span class="key">type</span>: UrlVerify)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q verifyUrl --url=http://www.google.com/</code></strong></div>
<div class="content">
<pre>&gt; gradle -q verifyUrl --url=http://www.google.com/
Verifying URL 'http://www.google.com/'</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:supported_task_option_data_types"><a class="anchor" href="#sec:supported_task_option_data_types"></a><a class="link" href="#sec:supported_task_option_data_types">Supported data types for options</a></h5>
<div class="paragraph">
<p>Gradle limits the set of data types that can be used for declaring command line options. The use on the command line differ per type.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>boolean</code>, <code>Boolean</code></dt>
<dd>
<p>Describes an option with the value <code>true</code> or <code>false</code>. Passing the option on the command line does not require assigning a value. For example <code>--enabled</code> equates to <code>true</code>. The absence of the option uses the default values assign to the property; that is <code>false</code> for <code>boolean</code> and <code>null</code> for the complex data type.</p>
</dd>
<dt class="hdlist1"><code>String</code></dt>
<dd>
<p>Describes an option with an arbitrary String value. Passing the option on the command line requires a key-value pair of option and value separated by an equals sign e.g. <code>--containerId=2x94held</code>.</p>
</dd>
<dt class="hdlist1"><code>enum</code></dt>
<dd>
<p>Describes an option as enum. The enum has to be passed on the command line as key-value pair similar to the String type e.g. <code>--log-level=DEBUG</code>. The provided value is not case sensitive.</p>
</dd>
<dt class="hdlist1"><code>List&lt;String&gt;</code>, <code>List&lt;enum&gt;</code></dt>
<dd>
<p>Describes an option that can takes multiple values of a given type. The values for the option have to be provided as distinct declarations e.g. <code>--imageId=123 --imageId=456</code>. Other notations like comma-separated lists or multiple values separated by a space character are currently not supported.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="sec:documenting_available_task_option_values"><a class="anchor" href="#sec:documenting_available_task_option_values"></a><a class="link" href="#sec:documenting_available_task_option_values">Documenting available values for an option</a></h5>
<div class="paragraph">
<p>In theory, an option for a property type <code>String</code> or <code>List&lt;String&gt;</code> can accept any arbitrary value. Expected values for such an option can be documented programmatically with the help of the annotation <a href="../javadoc/org/gradle/api/tasks/options/OptionValues.html">OptionValues</a>. This annotation may be assigned to any method that returns a <code>List</code> of one of the supported data types. In addition, you have to provide the option identifier to indicate the relationship between option and available values.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Passing a value on the command line that is not supported by the option does not fail the build or throw an exception. You&#8217;ll have to implement custom logic for such behavior in the task action.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This example demonstrates the use of multiple options for a single task. The task implementation provides a list of available values for the option <code>output-type</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_available_values_for_an_option"><a class="anchor" href="#example_declaring_available_values_for_an_option"></a><a class="link" href="#example_declaring_available_values_for_an_option">Example: Declaring available values for an option</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">UrlProcess.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.gradle.api.tasks.options.Option</span>;
<span class="keyword">import</span> <span class="include">org.gradle.api.tasks.options.OptionValues</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">UrlProcess</span> <span class="directive">extends</span> DefaultTask {
    <span class="directive">private</span> <span class="predefined-type">String</span> url;
    <span class="directive">private</span> OutputType outputType;

    <span class="annotation">@Option</span>(option = <span class="string"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>, description = <span class="string"><span class="delimiter">&quot;</span><span class="content">Configures the URL to be write to the output.</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> setUrl(<span class="predefined-type">String</span> url) {
        <span class="local-variable">this</span>.url = url;
    }

    <span class="annotation">@Input</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getUrl() {
        <span class="keyword">return</span> url;
    }

    <span class="annotation">@Option</span>(option = <span class="string"><span class="delimiter">&quot;</span><span class="content">output-type</span><span class="delimiter">&quot;</span></span>, description = <span class="string"><span class="delimiter">&quot;</span><span class="content">Configures the output type.</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> setOutputType(OutputType outputType) {
        <span class="local-variable">this</span>.outputType = outputType;
    }

    <span class="annotation">@OptionValues</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">output-type</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;OutputType&gt; getAvailableOutputTypes() {
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;OutputType&gt;(<span class="predefined-type">Arrays</span>.asList(OutputType.values()));
    }

    <span class="annotation">@Input</span>
    <span class="directive">public</span> OutputType getOutputType() {
        <span class="keyword">return</span> outputType;
    }

    <span class="annotation">@TaskAction</span>
    <span class="directive">public</span> <span class="type">void</span> process() {
        getLogger().quiet(<span class="string"><span class="delimiter">&quot;</span><span class="content">Writing out the URL reponse from '{}' to '{}'</span><span class="delimiter">&quot;</span></span>, url, outputType);

        <span class="comment">// retrieve content from URL and write to output</span>
    }

    <span class="directive">private</span> <span class="directive">static</span> <span class="type">enum</span> OutputType {
        CONSOLE, FILE
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:listing_task_options"><a class="anchor" href="#sec:listing_task_options"></a><a class="link" href="#sec:listing_task_options">Listing command line options</a></h5>
<div class="paragraph">
<p>Command line options using the annotations <a href="../javadoc/org/gradle/api/tasks/options/Option.html">Option</a> and <a href="../javadoc/org/gradle/api/tasks/options/OptionValues.html">OptionValues</a> are self-documenting. You will see <a href="#sec:declaring_task_option">declared options</a> and their <a href="#sec:documenting_available_task_option_values">available values</a> reflected in the console output of the <code>help</code> task. The output renders options in alphabetical order.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_listing_available_values_for_option"><a class="anchor" href="#example_listing_available_values_for_option"></a><a class="link" href="#example_listing_available_values_for_option">Example: Listing available values for option</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q help --task processUrl</code></strong></div>
<div class="content">
<pre>&gt; gradle -q help --task processUrl
Detailed task information for processUrl

Path
     :processUrl

Type
     UrlProcess (UrlProcess)

Options
     --output-type     Configures the output type.
                       Available values are:
                            CONSOLE
                            FILE

     --url     Configures the URL to be write to the output.

Description
     -

Group
     -</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="limitations"><a class="anchor" href="#limitations"></a><a class="link" href="#limitations">Limitations</a></h5>
<div class="paragraph">
<p>Support for declaring command line options currently comes with a few limitations.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Command line options can only be declared for custom tasks via annotation. There&#8217;s no programmatic equivalent for defining options.</p>
</li>
<li>
<p>Options cannot be declared globally e.g. on a project-level or as part of a plugin.</p>
</li>
<li>
<p>When assigning an option on the command line then the task exposing the option needs to be spelled out explicitly e.g. <code>gradle check --tests abc</code> does not work even though the <code>check</code> task depends on the <code>test</code> task.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="worker_api"><a class="anchor" href="#worker_api"></a><a class="link" href="#worker_api">The Worker API</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The Worker API is an <a href="#feature_lifecycle">incubating</a> feature.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As can be seen from the discussion of <a href="#incremental_tasks">incremental tasks</a>, the work that a task performs can be viewed as discrete units (i.e. a subset of inputs that are transformed to a certain subset of outputs). Many times, these units of work are highly independent of each other, meaning they can be performed in any order and simply aggregated together to form the overall action of the task. In a single threaded execution, these units of work would execute in sequence, however if we have multiple processors, it would be desirable to perform independent units of work concurrently. By doing so, we can fully utilize the available resources at build time and complete the activity of the task faster.</p>
</div>
<div class="paragraph">
<p>The Worker API provides a mechanism for doing exactly this. It allows for safe, concurrent execution of multiple items of work during a task action. But the benefits of the Worker API are not confined to parallelizing the work of a task. You can also configure a desired level of isolation such that work can be executed in an isolated classloader or even in an isolated process. Furthermore, the benefits extend beyond even the execution of a single task. Using the Worker API, Gradle can begin to execute tasks in parallel by default. In other words, once a task has submitted its work to be executed asynchronously, and has exited the task action, Gradle can then begin the execution of other independent tasks in parallel, even if those tasks are in the same project.</p>
</div>
<div class="sect4">
<h5 id="using-the-worker-api"><a class="anchor" href="#using-the-worker-api"></a><a class="link" href="#using-the-worker-api">Using the Worker API</a></h5>
<div class="paragraph">
<p>In order to submit work to the Worker API, two things must be provided: an implementation of the unit of work, and a configuration for the unit of work. The implementation is simply a class that extends <code>java.lang.Runnable</code>. This class should have a constructor that is annotated with <code>javax.inject.Inject</code> and accepts parameters that configure the class for a single unit of work. When a unit of work is submitted to the <a href="../javadoc/org/gradle/workers/WorkerExecutor.html">WorkerExecutor</a>, an instance of this class will be created and the parameters configured for the unit of work will be passed to the constructor.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_creating_a_unit_of_work_implementation"><a class="anchor" href="#example_creating_a_unit_of_work_implementation"></a><a class="link" href="#example_creating_a_unit_of_work_implementation">Example: Creating a unit of work implementation</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.gradle.workers.WorkerExecutor</span>

<span class="keyword">import</span> <span class="include">javax.inject.Inject</span>

<span class="comment">// The implementation of a single unit of work</span>
<span class="type">class</span> <span class="class">ReverseFile</span> <span class="directive">implements</span> <span class="predefined-type">Runnable</span> {
    <span class="predefined-type">File</span> fileToReverse
    <span class="predefined-type">File</span> destinationFile

    <span class="annotation">@Inject</span>
    <span class="directive">public</span> ReverseFile(<span class="predefined-type">File</span> fileToReverse, <span class="predefined-type">File</span> destinationFile) {
        <span class="local-variable">this</span>.fileToReverse = fileToReverse
        <span class="local-variable">this</span>.destinationFile = destinationFile
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> run() {
        destinationFile.text = fileToReverse.text.reverse()
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration of the worker is represented by a <a href="../javadoc/org/gradle/workers/WorkerConfiguration.html">WorkerConfiguration</a> and is set by configuring an instance of this object at the time of submission. However, in order to submit the unit of work, it is necessary to first acquire the <a href="../javadoc/org/gradle/workers/WorkerExecutor.html">WorkerExecutor</a>. To do this, a constructor should be provided that is annotated with <code>javax.inject.Inject</code> and accepts a <a href="../javadoc/org/gradle/workers/WorkerExecutor.html">WorkerExecutor</a> parameter. Gradle will inject the instance of <a href="../javadoc/org/gradle/workers/WorkerExecutor.html">WorkerExecutor</a> at runtime when the task is created.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_submitting_a_unit_of_work_for_execution"><a class="anchor" href="#example_submitting_a_unit_of_work_for_execution"></a><a class="link" href="#example_submitting_a_unit_of_work_for_execution">Example: Submitting a unit of work for execution</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">ReverseFiles</span> <span class="directive">extends</span> SourceTask {
    <span class="directive">final</span> WorkerExecutor workerExecutor

    <span class="annotation">@OutputDirectory</span>
    <span class="predefined-type">File</span> outputDir

    <span class="comment">// The WorkerExecutor will be injected by Gradle at runtime</span>
    <span class="annotation">@Inject</span>
    <span class="directive">public</span> ReverseFiles(WorkerExecutor workerExecutor) {
        <span class="local-variable">this</span>.workerExecutor = workerExecutor
    }

    <span class="annotation">@TaskAction</span>
    <span class="type">void</span> reverseFiles() {
        <span class="comment">// Create and submit a unit of work for each file</span>
        source.each { file -&gt;
            workerExecutor.submit(ReverseFile.class) { WorkerConfiguration config -&gt;
                <span class="comment">// Use the minimum level of isolation</span>
                config.isolationMode = IsolationMode.NONE

                <span class="comment">// Constructor parameters for the unit of work implementation</span>
                config.params file, project.file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>outputDir<span class="inline-delimiter">}</span></span><span class="content">/</span><span class="inline"><span class="inline-delimiter">${</span>file.name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that one element of the <a href="../javadoc/org/gradle/workers/WorkerConfiguration.html">WorkerConfiguration</a> is the <code>params</code> property. These are the parameters passed to the constructor of the unit of work implementation for each item of work submitted. Any parameters provided to the unit of work <em>must</em> be <code>java.io.Serializable</code>.</p>
</div>
<div class="paragraph">
<p>Once all of the work for a task action has been submitted, it is safe to exit the task action. The work will be executed asynchronously and in parallel (up to the setting of <code>max-workers</code>). Of course, any tasks that are dependent on this task (and any subsequent task actions of this task) will not begin executing until all of the asynchronous work completes. However, other independent tasks that have no relationship to this task can begin executing immediately.</p>
</div>
<div class="paragraph">
<p>If any failures occur while executing the asynchronous work, the task will fail and a <a href="../javadoc/org/gradle/workers/WorkerExecutionException.html">WorkerExecutionException</a> will be thrown detailing the failure for each failed work item. This will be treated like any failure during task execution and will prevent any dependent tasks from executing.</p>
</div>
<div class="paragraph">
<p>In some cases, however, it might be desirable to wait for work to complete before exiting the task action. This is possible using the <a href="../javadoc/org/gradle/workers/WorkerExecutor.html#await--">WorkerExecutor.await()</a> method. As in the case of allowing the work to complete asynchronously, any failures that occur while executing an item of work will be surfaced as a <a href="../javadoc/org/gradle/workers/WorkerExecutionException.html">WorkerExecutionException</a> thrown from the <a href="../javadoc/org/gradle/workers/WorkerExecutor.html#await--">WorkerExecutor.await()</a> method.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Note that Gradle will only begin running other independent tasks in parallel when a task has exited a task action and returned control of execution to Gradle. When <a href="../javadoc/org/gradle/workers/WorkerExecutor.html#await--">WorkerExecutor.await()</a> is used, execution does not leave the task action. This means that Gradle will not allow other tasks to begin executing and will wait for the task action to complete before doing so.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="example_waiting_for_asynchronous_work_to_complete"><a class="anchor" href="#example_waiting_for_asynchronous_work_to_complete"></a><a class="link" href="#example_waiting_for_asynchronous_work_to_complete">Example: Waiting for asynchronous work to complete</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// Create and submit a unit of work for each file</span>
source.each { file -&gt;
    workerExecutor.submit(ReverseFile.class) { config -&gt;
        config.isolationMode = IsolationMode.NONE
        <span class="comment">// Constructor parameters for the unit of work implementation</span>
        config.params file, project.file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>outputDir<span class="inline-delimiter">}</span></span><span class="content">/</span><span class="inline"><span class="inline-delimiter">${</span>file.name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
    }
}

<span class="comment">// Wait for all asynchronous work to complete before continuing</span>
workerExecutor.await()
logger.lifecycle(<span class="string"><span class="delimiter">&quot;</span><span class="content">Created </span><span class="inline"><span class="inline-delimiter">${</span>outputDir.listFiles().size()<span class="inline-delimiter">}</span></span><span class="content"> reversed files in </span><span class="inline"><span class="inline-delimiter">${</span>project.relativePath(outputDir)<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="isolation-modes"><a class="anchor" href="#isolation-modes"></a><a class="link" href="#isolation-modes">Isolation Modes</a></h5>
<div class="paragraph">
<p>Gradle provides three isolation modes that can be configured on a unit of work and are specified using the <a href="../javadoc/org/gradle/workers/IsolationMode.html">IsolationMode</a> enum:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">IsolationMode.NONE</dt>
<dd>
<p>This states that the work should be run in a thread with a minimum of isolation. For instance, it will share the same classloader that the task is loaded from. This is the fastest level of isolation.</p>
</dd>
<dt class="hdlist1">IsolationMode.CLASSLOADER</dt>
<dd>
<p>This states that the work should be run in a thread with an isolated classloader. The classloader will have the classpath from the classloader that the unit of work implementation class was loaded from as well as any additional classpath entries added through <a href="../javadoc/org/gradle/workers/WorkerConfiguration.html#classpath-java.lang.Iterable-">WorkerConfiguration.classpath(java.lang.Iterable)</a>.</p>
</dd>
<dt class="hdlist1">IsolationMode.PROCESS</dt>
<dd>
<p>This states that the work should be run with a maximum level of isolation by executing the work in a separate process. The classloader of the process will use the classpath from the classloader that the unit of work was loaded from as well as any additional classpath entries added through <a href="../javadoc/org/gradle/workers/WorkerConfiguration.html#classpath-java.lang.Iterable-">WorkerConfiguration.classpath(java.lang.Iterable)</a>. Furthermore, the process will be a <em>Worker Daemon</em> which will stay alive and can be reused for future work items that may have the same requirements. This process can be configured with different settings than the Gradle JVM using <a href="../javadoc/org/gradle/workers/WorkerConfiguration.html#forkOptions-org.gradle.api.Action-">WorkerConfiguration.forkOptions(org.gradle.api.Action)</a>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="worker-daemons"><a class="anchor" href="#worker-daemons"></a><a class="link" href="#worker-daemons">Worker Daemons</a></h5>
<div class="paragraph">
<p>When using <code>IsolationMode.PROCESS</code>, gradle will start a long-lived <em>Worker Daemon</em> process that can be reused for future work items.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_submitting_an_item_of_work_to_run_in_a_worker_daemon"><a class="anchor" href="#example_submitting_an_item_of_work_to_run_in_a_worker_daemon"></a><a class="link" href="#example_submitting_an_item_of_work_to_run_in_a_worker_daemon">Example: Submitting an item of work to run in a worker daemon</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">workerExecutor.submit(ReverseFile.class) { WorkerConfiguration config -&gt;
    <span class="comment">// Run this work in an isolated process</span>
    config.isolationMode = IsolationMode.PROCESS

    <span class="comment">// Configure the options for the forked process</span>
    config.forkOptions { JavaForkOptions options -&gt;
        options.maxHeapSize = <span class="string"><span class="delimiter">&quot;</span><span class="content">512m</span><span class="delimiter">&quot;</span></span>
        options.systemProperty <span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.sample.showFileSize</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>
    }

    <span class="comment">// Constructor parameters for the unit of work implementation</span>
    config.params file, project.file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>outputDir<span class="inline-delimiter">}</span></span><span class="content">/</span><span class="inline"><span class="inline-delimiter">${</span>file.name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When a unit of work for a Worker Daemon is submitted, Gradle will first look to see if a compatible, idle daemon already exists. If so, it will send the unit of work to the idle daemon, marking it as busy. If not, it will start a new daemon. When evaluating compatibility, Gradle looks at a number of criteria, all of which can be controlled through <a href="../javadoc/org/gradle/workers/WorkerConfiguration.html#forkOptions-org.gradle.api.Action-">WorkerConfiguration.forkOptions(org.gradle.api.Action)</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">executable</dt>
<dd>
<p>A daemon is considered compatible only if it uses the same java executable.</p>
</dd>
<dt class="hdlist1">classpath</dt>
<dd>
<p>A daemon is considered compatible if its classpath contains all of the classpath entries requested. Note that a daemon is considered compatible if it has more classpath entries in addition to those requested.</p>
</dd>
<dt class="hdlist1">heap settings</dt>
<dd>
<p>A daemon is considered compatible if it has at least the same heap size settings as requested. In other words, a daemon that has higher heap settings than requested would be considered compatible.</p>
</dd>
<dt class="hdlist1">jvm arguments</dt>
<dd>
<p>A daemon is considered compatible if it has set all of the jvm arguments requested. Note that a daemon is considered compatible if it has additional jvm arguments beyond those requested (except for arguments treated specially such as heap settings, assertions, debug, etc).</p>
</dd>
<dt class="hdlist1">system properties</dt>
<dd>
<p>A daemon is considered compatible if it has set all of the system properties requested with the same values. Note that a daemon is considered compatible if it has additional system properties beyond those requested.</p>
</dd>
<dt class="hdlist1">environment variables</dt>
<dd>
<p>A daemon is considered compatible if it has set all of the environment variables requested with the same values. Note that a daemon is considered compatible if it has more environment variables in addition to those requested.</p>
</dd>
<dt class="hdlist1">bootstrap classpath</dt>
<dd>
<p>A daemon is considered compatible if it contains all of the bootstrap classpath entries requested. Note that a daemon is considered compatible if it has more bootstrap classpath entries in addition to those requested.</p>
</dd>
<dt class="hdlist1">debug</dt>
<dd>
<p>A daemon is considered compatible only if debug is set to the same value as requested (true or false).</p>
</dd>
<dt class="hdlist1">enable assertions</dt>
<dd>
<p>A daemon is considered compatible only if enable assertions is set to the same value as requested (true or false).</p>
</dd>
<dt class="hdlist1">default character encoding</dt>
<dd>
<p>A daemon is considered compatible only if the default character encoding is set to the same value as requested.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Worker daemons will remain running until either the build daemon that started them is stopped, or system memory becomes scarce. When available system memory is low, Gradle will begin stopping worker daemons in an attempt to minimize memory consumption.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:reusing_task_logic"><a class="anchor" href="#sec:reusing_task_logic"></a><a class="link" href="#sec:reusing_task_logic">Re-using logic between task classes</a></h4>
<div class="paragraph">
<p>There are different ways to re-use logic between task classes.
The easiest case is when you can extract the logic you want to share in a separate method or class and then use the extracted piece of code in your tasks.
For example, the <a href="../dsl/org.gradle.api.tasks.Copy.html">Copy</a> task re-uses the logic of the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:copy(org.gradle.api.Action)">Project.copy(org.gradle.api.Action)</a> method.
Another option is to add a task dependency on the task which outputs you want to re-use.
Other options include using <a href="#sec:task_rules">task rules</a> or the <a href="#worker_api">worker API</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="base_plugin"><a class="anchor" href="#base_plugin"></a><a class="link" href="#base_plugin">The Base Plugin</a></h3>
<div class="paragraph">
<p>The Base Plugin provides some tasks and conventions that are common to most builds and adds a structure to the build that promotes consistency in how they are run. Its most significant contribution is a set of <a href="#sec:lifecycle_tasks"><em>lifecycle</em> tasks</a> that act as an umbrella for the more specific tasks provided by other plugins and build authors.</p>
</div>
<div class="sect3">
<h4 id="sec:base_plugin_usage"><a class="anchor" href="#sec:base_plugin_usage"></a><a class="link" href="#sec:base_plugin_usage">Usage</a></h4>
<div class="sect4">
<h5 id="example_applying_the_base_plugin"><a class="anchor" href="#example_applying_the_base_plugin"></a><a class="link" href="#example_applying_the_base_plugin">Example: Applying the Base Plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">base</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:base_tasks"><a class="anchor" href="#sec:base_tasks"></a><a class="link" href="#sec:base_tasks">Task</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>clean</code>  <code>Delete</code></dt>
<dd>
<p>Deletes the build directory and everything in it, i.e. the path specified by the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:buildDir">Project.getBuildDir()</a> project property.</p>
</dd>
<dt class="hdlist1"><code>check</code> <em>lifecycle task</em></dt>
<dd>
<p>Plugins and build authors should attach their verification tasks, such as ones that run tests, to this lifecycle task using <code>check.dependsOn(<em>task</em>)</code>.</p>
</dd>
<dt class="hdlist1"><code>assemble</code>  <em>lifecycle task</em></dt>
<dd>
<p>Plugins and build authors should attach tasks that produce distributions and other consumable artifacts to this lifecycle task. For example, <code>jar</code> produces the consumable artifact for Java libraries. Attach tasks to this lifecycle task using <code>assemble.dependsOn(<em>task</em>)</code>.</p>
</dd>
<dt class="hdlist1"><code>build</code> <em>lifecycle task</em></dt>
<dd>
<p><em>Depends on</em>: <code>check</code>, <code>assemble</code></p>
<div class="paragraph">
<p>Intended to build everything, including running all tests, producing the production artifacts and generating documentation. You will probably rarely attach concrete tasks directly to <code>build</code> as <code>assemble</code> and <code>check</code> are typically more appropriate.</p>
</div>
</dd>
<dt class="hdlist1"><code>build<em>Configuration</em></code> task rule</dt>
<dd>
<p>Assembles those artifacts attached to the named configuration. For example, <code>buildArchives</code> will execute any task that is required to create any artifact attached to the <code>archives</code> configuration.</p>
</dd>
<dt class="hdlist1"><code>upload<em>Configuration</em></code> task rule</dt>
<dd>
<p>Does the same as <code>build<em>Configuration</em></code>, but also uploads all the artifacts attached to the given configuration.</p>
</dd>
<dt class="hdlist1"><code>clean<em>Task</em></code> task rule</dt>
<dd>
<p>Removes the <a href="#sec:task_inputs_outputs">defined outputs</a> of a task, e.g. <code>cleanJar</code> will delete the JAR file produced by the <code>jar</code> task of the Java Plugin.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:base_plugin_configurations"><a class="anchor" href="#sec:base_plugin_configurations"></a><a class="link" href="#sec:base_plugin_configurations">Dependency management</a></h4>
<div class="paragraph">
<p>The Base Plugin adds no <a href="#managing_dependency_configurations">configurations for dependencies</a>, but it does add the following configurations for <a href="#sec:artifacts_and_configurations">artifacts</a>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>default</code></dt>
<dd>
<p>A fallback configuration used by consumer projects. Let&#8217;s say you have project B with a <a href="#sub:project_dependencies">project dependency</a> on project A. Gradle uses some internal logic to determine which of project A&#8217;s artifacts and dependencies are added to the specified configuration of project B. If no other factors apply  you don&#8217;t need to worry what these are then Gradle falls back to using everything in project A&#8217;s <code>default</code> configuration.</p>
<div class="paragraph">
<p><strong>New builds and plugins should not be using the <code>default</code> configuration!</strong> It remains for the reason of backwards compatibility.</p>
</div>
</dd>
<dt class="hdlist1"><code>archives</code></dt>
<dd>
<p>A standard configuration for the production artifacts of a project. This results in an <code>uploadArchives</code> task for publishing artifacts attached to the <code>archives</code> configuration.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Note that the <code>assemble</code> task generates all artifacts that are attached to the <code>archives</code> configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:base_plugin_conventions"><a class="anchor" href="#sec:base_plugin_conventions"></a><a class="link" href="#sec:base_plugin_conventions">Conventions</a></h4>
<div class="paragraph">
<p>The Base Plugin only adds conventions related to the creation of archives, such as ZIPs, TARs and JARs. Specifically, it provides the following project properties that you can set:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>archivesBaseName</code> default: <code>$project.name</code></dt>
<dd>
<p>Provides the default <a href="../dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html#org.gradle.api.tasks.bundling.AbstractArchiveTask:baseName">AbstractArchiveTask.getBaseName()</a> for archive tasks.</p>
</dd>
<dt class="hdlist1"><code>distsDirName</code> default: <em>distributions</em></dt>
<dd>
<p>Default name of the directory in which distribution archives, i.e. non-JARs, are created.</p>
</dd>
<dt class="hdlist1"><code>libsDirName</code> default: <em>libs</em></dt>
<dd>
<p>Default name of the directory in which library archives, i.e. JARs, are created.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The plugin also provides default values for the following properties on any task that extends <a href="../dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html">AbstractArchiveTask</a>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>destinationDir</code></dt>
<dd>
<p>Defaults to <em><code>$buildDir</code>/<code>$distsDirName</code></em> for non-JAR archives and <em><code>$buildDir</code>/<code>$libsDirName</code></em> for JARs and derivatives of JAR, such as WARs.</p>
</dd>
<dt class="hdlist1"><code>version</code></dt>
<dd>
<p>Defaults to <code>$project.version</code> or 'unspecified' if the project has no version.</p>
</dd>
<dt class="hdlist1"><code>baseName</code></dt>
<dd>
<p>Defaults to <code>$archivesBaseName</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dependency_management"><a class="anchor" href="#dependency_management"></a><a class="link" href="#dependency_management">Dependency Management</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="introduction_dependency_management"><a class="anchor" href="#introduction_dependency_management"></a><a class="link" href="#introduction_dependency_management">Introduction to Dependency Management</a></h3>
<div class="sect3">
<h4 id="what_is_dependency_management"><a class="anchor" href="#what_is_dependency_management"></a><a class="link" href="#what_is_dependency_management">What is dependency management?</a></h4>
<div class="paragraph">
<p>Software projects rarely work in isolation. In most cases, a project relies on reusable functionality in the form of libraries or is broken up into individual components to compose a modularized system. Dependency management is a technique for declaring, resolving and using dependencies required by the project in an automated fashion.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For a general overview on the terms used throughout the user guide, refer to <a href="#dependency_management_terminology">Dependency Management Terminology</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="dependency_management_in_gradle"><a class="anchor" href="#dependency_management_in_gradle"></a><a class="link" href="#dependency_management_in_gradle">Dependency management in Gradle</a></h4>
<div class="paragraph">
<p>Gradle has built-in support for dependency management and lives up the task of fulfilling typical scenarios encountered in modern software projects. Well explore the main concepts with the help of an example project. The illustration below should give you an rough overview on all the moving parts.</p>
</div>
<div class="imageblock inset">
<div class="content">
<img src="img/dependency-management-resolution.png" alt="dependency management resolution">
</div>
<div class="title">Figure 12. Dependency management big picture</div>
</div>
<div class="paragraph">
<p>The example project builds Java source code. Some of the Java source files import classes from <a href="https://github.com/google/guava">Google Guava</a>, a open-source library providing a wealth of utility functionality. In addition to Guava, the project needs the <a href="http://junit.org/junit5/">JUnit</a> libraries for compiling and executing test code.</p>
</div>
<div class="paragraph">
<p>Guava and JUnit represent the <em>dependencies</em> of this project. A build script developer can <a href="#declaring_dependencies">declare dependencies</a> for different scopes e.g. just for compilation of source code or for executing tests. In Gradle, the <a href="#managing_dependency_configurations">scope of a dependency</a> is called a <em>configuration</em>. For a full overview, see the reference material on <a href="#dependency_types">dependency types</a>.</p>
</div>
<div class="paragraph">
<p>Often times dependencies come in the form of <a href="#sub:terminology_module">modules</a>. Youll need to tell Gradle where to find those modules so they can be consumed by the build. The location for storing modules is called a <em>repository</em>. By <a href="#declaring_repositories">declaring repositories</a> for a build, Gradle will know how to find and retrieve modules. Repositories can come in different forms: as local directory or a remote repository. The reference on <a href="#repository_types">repository types</a> provides a broad coverage on this topic.</p>
</div>
<div class="paragraph">
<p>At runtime, Gradle will locate the declared dependencies if needed for operating a specific task. The dependencies might need to be downloaded from a remote repository, retrieved from a local directory or requires another project to be built in a multi-project setting. This process is called <em>dependency resolution</em>. You can find a detailed discussion in <a href="#sec:dependency_resolution">How dependency resolution works</a>.</p>
</div>
<div class="paragraph">
<p>Once resolved, the resolution mechanism <a href="#dependency_cache">stores the underlying files of a dependency in a local cache</a>, also referred to as the <em>dependency cache</em>. Future builds reuse the files stored in the cache to avoid unnecessary network calls.</p>
</div>
<div class="paragraph">
<p>Modules can provide additional metadata. Metadata is the data that describes the module in more detail e.g. the coordinates for finding it in a repository, information about the project, or its authors. As part of the metadata, a module can define that other modules are needed for it to work properly. For example, the JUnit 5 platform module also requires the platform commons module. Gradle automatically resolves those additional modules, so called <em>transitive dependencies</em>. If needed, you can <a href="#managing_transitive_dependencies">customize the behavior the handling of transitive dependencies</a> to your project&#8217;s requirements.</p>
</div>
<div class="paragraph">
<p>Projects with tens or hundreds of declared dependencies can easily suffer from dependency hell. Gradle provides sufficient tooling to visualize, navigate and analyze the dependency graph of a project either with the help of a <a href="https://scans.gradle.com/get-started">build scan</a> or built-in tasks. Learn more in <a href="#inspecting_dependencies">Inspecting Dependencies</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/gradle-core-test-build-scan-dependencies.png" alt="gradle core test build scan dependencies">
</div>
<div class="title">Figure 13. Build scan dependencies report</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:dependency_resolution"><a class="anchor" href="#sec:dependency_resolution"></a><a class="link" href="#sec:dependency_resolution">How dependency resolution works</a></h4>
<div class="paragraph">
<p>Gradle takes your dependency declarations and repository definitions and attempts to download all of your dependencies by a process called <em>dependency resolution</em>. Below is a brief outline of how this process works.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Given a required dependency, Gradle attempts to resolve the dependency by searching for the module the dependency points at. Each repository is inspected in order. Depending on the type of repository, Gradle looks for metadata files describing the module (<code>.module</code>, <code>.pom</code> or <code>ivy.xml</code> file) or directly for artifact files.</p>
<div class="ulist">
<ul>
<li>
<p>If the dependency is declared as a dynamic version (like <code>1.+</code>), Gradle will resolve this to the highest available concrete version (like <code>1.2</code>) in the repository. For Maven repositories, this is done using the <code>maven-metadata.xml</code> file, while for Ivy repositories this is done by directory listing.</p>
</li>
<li>
<p>If the module metadata is a POM file that has a parent POM declared, Gradle will recursively attempt to resolve each of the parent modules for the POM.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Once each repository has been inspected for the module, Gradle will choose the 'best' one to use. This is done using the following criteria:</p>
<div class="ulist">
<ul>
<li>
<p>For a dynamic version, a 'higher' concrete version is preferred over a 'lower' version.</p>
</li>
<li>
<p>Modules declared by a module metadata file (<code>.module</code>, <code>.pom</code> or <code>ivy.xml</code> file) are preferred over modules that have an artifact file only.</p>
</li>
<li>
<p>Modules from earlier repositories are preferred over modules in later repositories.</p>
</li>
<li>
<p>When the dependency is declared by a concrete version and a module metadata file is found in a repository, there is no need to continue searching later repositories and the remainder of the process is short-circuited.</p>
</li>
</ul>
</div>
</li>
<li>
<p>All of the artifacts for the module are then requested from the <em>same repository</em> that was chosen in the process above.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The dependency resolution process is highly customizable to meet enterprise requirements. For more information, see the chapter on <a href="#customizing_dependency_resolution_behavior">customizing dependency resolution</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dependency_management_terminology"><a class="anchor" href="#dependency_management_terminology"></a><a class="link" href="#dependency_management_terminology">Dependency Management Terminology</a></h3>
<div class="paragraph">
<p>Dependency management comes with a wealth of terminology. Here you can find the most commonly-used terms including references to the user guide to learn about their practical application.</p>
</div>
<div class="sect3">
<h4 id="sub:terminology_configuration"><a class="anchor" href="#sub:terminology_configuration"></a><a class="link" href="#sub:terminology_configuration">Configuration</a></h4>
<div class="paragraph">
<p>A configuration is a named set of <a href="#sub:terminology_dependency">dependencies</a> grouped together for a specific goal: For example the <code>implementation</code> configuration represents the set of dependencies required to compile a project. Configurations provide access to the underlying, resolved <a href="#sub:terminology_module">modules</a> and their artifacts. For more information, see <a href="#managing_dependency_configurations">Managing Dependency Configurations</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The word "configuration" is an overloaded term and has a different meaning outside of the context of dependency management.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sub:terminology_dependency"><a class="anchor" href="#sub:terminology_dependency"></a><a class="link" href="#sub:terminology_dependency">Dependency</a></h4>
<div class="paragraph">
<p>A dependency is a pointer to another piece of software required to build, test or run a <a href="#sub:terminology_module">module</a>. For more information, see <a href="#declaring_dependencies">Declaring Dependencies</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:terminology_dependency_constraint"><a class="anchor" href="#sub:terminology_dependency_constraint"></a><a class="link" href="#sub:terminology_dependency_constraint">Dependency constraint</a></h4>
<div class="paragraph">
<p>A dependency constraint defines requirements that need to be met by a module to make it a valid resolution result for the dependency. For example, a dependency constraint can narrow down the set of supported module versions. Dependency constraints can be used to express such requirements for transitive dependencies. For more information, see <a href="#sec:dependency_constraints">Dependency Constraints</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:terminology_module"><a class="anchor" href="#sub:terminology_module"></a><a class="link" href="#sub:terminology_module">Module</a></h4>
<div class="paragraph">
<p>A piece of software that evolves over time e.g. <a href="https://github.com/google/guava">Google Guava</a>. Every module has a name. Each release of a module is optimally represented by a <a href="#sub:terminology_module_version">module version</a>. For convenient consumption, modules can be hosted in a <a href="#sub:terminology_repository">repository</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:terminology_module_metadata"><a class="anchor" href="#sub:terminology_module_metadata"></a><a class="link" href="#sub:terminology_module_metadata">Module metadata</a></h4>
<div class="paragraph">
<p>Releases of a <a href="#sub:terminology_module">module</a> can provide metadata. Metadata is the data that describes the module in more detail e.g. the coordinates for locating it in a repository, information about the project or required <a href="#sub:terminology_transitive_dependency">transitive dependencies</a>. In Maven the metadata file is called <code>.pom</code>, in Ivy it is called <code>ivy.xml</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:terminology_module_version"><a class="anchor" href="#sub:terminology_module_version"></a><a class="link" href="#sub:terminology_module_version">Module version</a></h4>
<div class="paragraph">
<p>A module version represents a distinct set of changes of a released <a href="#sub:terminology_module">module</a>. For example <code>18.0</code> represents the version of the module with the coordinates <code>com.google:guava:18.0</code>. In practice there&#8217;s no limitation to the scheme of the module version. Timestamps, numbers, special suffixes like <code>-GA</code> are all allowed identifiers. The most widely-used versioning strategy is <a href="https://semver.org/">semantic versioning</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:terminology_repository"><a class="anchor" href="#sub:terminology_repository"></a><a class="link" href="#sub:terminology_repository">Repository</a></h4>
<div class="paragraph">
<p>A repository hosts a set of <a href="#sub:terminology_module">modules</a>, each of which may provide one or many releases indicated by a <a href="#sub:terminology_module_version">module version</a>. The repository can be based on a binary repository product (e.g. Artifactory or Nexus) or a directory structure in the filesystem. For more information, see <a href="#declaring_repositories">Declaring Repositories</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:resolution_rule"><a class="anchor" href="#sub:resolution_rule"></a><a class="link" href="#sub:resolution_rule">Resolution rule</a></h4>
<div class="paragraph">
<p>A resolution rule influences the behavior of how a <a href="#sub:terminology_dependency">dependency</a> is resolved. Resolution rules are defined as part of the build logic. For more information, see <a href="#customizing_dependency_resolution_behavior">Customizing Dependency Resolution Behavior</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:terminology_transitive_dependency"><a class="anchor" href="#sub:terminology_transitive_dependency"></a><a class="link" href="#sub:terminology_transitive_dependency">Transitive dependency</a></h4>
<div class="paragraph">
<p>A <a href="#sub:terminology_module">module</a> can have dependencies on other modules to work properly, so-called transitive dependencies. Releases of a module hosted on a <a href="#sub:terminology_repository">repository</a> can provide <a href="#sub:terminology_module_metadata">metadata</a> to declare those transitive dependencies. By default, Gradle resolves transitive dependencies automatically. However, the behavior is highly customizable. For more information, see <a href="#managing_transitive_dependencies">Managing Transitive Dependencies</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dependency_types"><a class="anchor" href="#dependency_types"></a><a class="link" href="#dependency_types">Dependency Types</a></h3>
<div class="sect3">
<h4 id="sub:module_dependencies"><a class="anchor" href="#sub:module_dependencies"></a><a class="link" href="#sub:module_dependencies">Module dependencies</a></h4>
<div class="paragraph">
<p>Module dependencies are the most common dependencies. They refer to a module in a repository.</p>
</div>
<div class="sect4">
<h5 id="example_module_dependencies"><a class="anchor" href="#example_module_dependencies"></a><a class="link" href="#example_module_dependencies">Example: Module dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    runtime <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.springframework</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">spring-core</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">2.5</span><span class="delimiter">'</span></span>
    runtime <span class="string"><span class="delimiter">'</span><span class="content">org.springframework:spring-core:2.5</span><span class="delimiter">'</span></span>,
            <span class="string"><span class="delimiter">'</span><span class="content">org.springframework:spring-aop:2.5</span><span class="delimiter">'</span></span>
    runtime(
        [<span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.springframework</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">spring-core</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">2.5</span><span class="delimiter">'</span></span>],
        [<span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.springframework</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">spring-aop</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">2.5</span><span class="delimiter">'</span></span>]
    )
    runtime(<span class="string"><span class="delimiter">'</span><span class="content">org.hibernate:hibernate:3.0.5</span><span class="delimiter">'</span></span>) {
        transitive = <span class="predefined-constant">true</span>
    }
    runtime <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.hibernate</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">hibernate</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">3.0.5</span><span class="delimiter">'</span></span>, <span class="key">transitive</span>: <span class="predefined-constant">true</span>
    runtime(<span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.hibernate</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">hibernate</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">3.0.5</span><span class="delimiter">'</span></span>) {
        transitive = <span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="../dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html">DependencyHandler</a> class in the API documentation for more examples and a complete reference.</p>
</div>
<div class="paragraph">
<p>Gradle provides different notations for module dependencies. There is a string notation and a map notation. A module dependency has an API which allows further configuration. Have a look at <a href="../javadoc/org/gradle/api/artifacts/ExternalModuleDependency.html">ExternalModuleDependency</a> to learn all about the API. This API provides properties and configuration methods. Via the string notation you can define a subset of the properties. With the map notation you can define all properties. To have access to the complete API, either with the map or with the string notation, you can assign a single dependency to a configuration together with a closure.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you declare a module dependency, Gradle looks for a module metadata file (<code>.module</code>, <code>.pom</code> or <code>ivy.xml</code>) in the repositories. If such a module metadata file exists, it is parsed and the artifacts of this module (e.g. <code>hibernate-3.0.5.jar</code>) as well as its dependencies (e.g. cglib) are downloaded. If no such module metadata file exists, Gradle may look, depending on the <a href="#sub:supported_metadata_sources">metadata sources definitions</a>, for an artifact file called <code>hibernate-3.0.5.jar</code> directly. In Maven, a module can have one and only one artifact. In Gradle and Ivy, a module can have multiple artifacts. Each artifact can have a different set of dependencies.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:file_dependencies"><a class="anchor" href="#sub:file_dependencies"></a><a class="link" href="#sub:file_dependencies">File dependencies</a></h4>
<div class="paragraph">
<p>File dependencies allow you to directly add a set of files to a configuration, without first adding them to a repository. This can be useful if you cannot, or do not want to, place certain files in a repository. Or if you do not want to use any repositories at all for storing your dependencies.</p>
</div>
<div class="paragraph">
<p>To add some files as a dependency for a configuration, you simply pass a <a href="#sec:file_collections">file collection</a> as a dependency:</p>
</div>
<div class="sect4">
<h5 id="example_file_dependencies"><a class="anchor" href="#example_file_dependencies"></a><a class="link" href="#example_file_dependencies">Example: File dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    runtime files(<span class="string"><span class="delimiter">'</span><span class="content">libs/a.jar</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">libs/b.jar</span><span class="delimiter">'</span></span>)
    runtime fileTree(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">libs</span><span class="delimiter">'</span></span>, <span class="key">include</span>: <span class="string"><span class="delimiter">'</span><span class="content">*.jar</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>File dependencies are not included in the published dependency descriptor for your project. However, file dependencies are included in transitive project dependencies within the same build. This means they cannot be used outside the current build, but they can be used with the same build.</p>
</div>
<div class="paragraph">
<p>You can declare which tasks produce the files for a file dependency. You might do this when, for example, the files are generated by the build.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_generated_file_dependencies"><a class="anchor" href="#example_generated_file_dependencies"></a><a class="link" href="#example_generated_file_dependencies">Example: Generated file dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    compile files(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/classes</span><span class="delimiter">&quot;</span></span>) {
        builtBy <span class="string"><span class="delimiter">'</span><span class="content">compile</span><span class="delimiter">'</span></span>
    }
}

task compile {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">compiling classes</span><span class="delimiter">'</span></span>
    }
}

task list(<span class="key">dependsOn</span>: configurations.compile) {
    doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">classpath = </span><span class="inline"><span class="inline-delimiter">${</span>configurations.compile.collect { <span class="predefined-type">File</span> file -&gt; file.name }<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q list</code></strong></div>
<div class="content">
<pre>&gt; gradle -q list
compiling classes
classpath = [classes]</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:project_dependencies"><a class="anchor" href="#sub:project_dependencies"></a><a class="link" href="#sub:project_dependencies">Project dependencies</a></h4>
<div class="paragraph">
<p>Gradle distinguishes between external dependencies and dependencies on projects which are part of the same multi-project build. For the latter you can declare <em>project dependencies</em>.</p>
</div>
<div class="sect4">
<h5 id="example_project_dependencies"><a class="anchor" href="#example_project_dependencies"></a><a class="link" href="#example_project_dependencies">Example: Project dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    compile project(<span class="string"><span class="delimiter">'</span><span class="content">:shared</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information see the API documentation for <a href="../javadoc/org/gradle/api/artifacts/ProjectDependency.html">ProjectDependency</a>.</p>
</div>
<div class="paragraph">
<p>Multi-project builds are discussed in <a href="#multi_project_builds">this chapter</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:gradle_distribution_dependencies"><a class="anchor" href="#sub:gradle_distribution_dependencies"></a><a class="link" href="#sub:gradle_distribution_dependencies">Gradle distribution-specific dependencies</a></h4>
<div class="sect4">
<h5 id="sub:api_dependencies"><a class="anchor" href="#sub:api_dependencies"></a><a class="link" href="#sub:api_dependencies">Gradle API dependency</a></h5>
<div class="paragraph">
<p>You can declare a dependency on the API of the current version of Gradle by using the <a href="../dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:gradleApi()">DependencyHandler.gradleApi()</a> method. This is useful when you are developing custom Gradle tasks or plugins.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_gradle_api_dependencies"><a class="anchor" href="#example_gradle_api_dependencies"></a><a class="link" href="#example_gradle_api_dependencies">Example: Gradle API dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    compile gradleApi()
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sub:testkit_dependencies"><a class="anchor" href="#sub:testkit_dependencies"></a><a class="link" href="#sub:testkit_dependencies">Gradle TestKit dependency</a></h5>
<div class="paragraph">
<p>You can declare a dependency on the TestKit API of the current version of Gradle by using the <a href="../dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:gradleTestKit()">DependencyHandler.gradleTestKit()</a> method. This is useful for writing and executing functional tests for Gradle plugins and build scripts.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_gradle_testkit_dependencies"><a class="anchor" href="#example_gradle_testkit_dependencies"></a><a class="link" href="#example_gradle_testkit_dependencies">Example: Gradle TestKit dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    testCompile gradleTestKit()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#test_kit">The TestKit chapter</a> explains the use of TestKit by example.</p>
</div>
</div>
<div class="sect4">
<h5 id="sub:groovy_dependencies"><a class="anchor" href="#sub:groovy_dependencies"></a><a class="link" href="#sub:groovy_dependencies">Local Groovy dependency</a></h5>
<div class="paragraph">
<p>You can declare a dependency on the Groovy that is distributed with Gradle by using the <a href="../dsl/org.gradle.api.artifacts.dsl.DependencyHandler.html#org.gradle.api.artifacts.dsl.DependencyHandler:localGroovy()">DependencyHandler.localGroovy()</a> method. This is useful when you are developing custom Gradle tasks or plugins in Groovy.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_gradles_groovy_dependencies"><a class="anchor" href="#example_gradles_groovy_dependencies"></a><a class="link" href="#example_gradles_groovy_dependencies">Example: Gradle&#8217;s Groovy dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    compile localGroovy()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="repository_types"><a class="anchor" href="#repository_types"></a><a class="link" href="#repository_types">Repository Types</a></h3>
<div class="sect3">
<h4 id="sec:flat_dir_resolver"><a class="anchor" href="#sec:flat_dir_resolver"></a><a class="link" href="#sec:flat_dir_resolver">Flat directory repository</a></h4>
<div class="paragraph">
<p>Some projects might prefer to store dependencies on a shared drive or as part of the project source code instead of a binary repository product. If you want to use a (flat) filesystem directory as a repository, simply type:</p>
</div>
<div class="sect4">
<h5 id="example_flat_repository_resolver"><a class="anchor" href="#example_flat_repository_resolver"></a><a class="link" href="#example_flat_repository_resolver">Example: Flat repository resolver</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    flatDir {
        dirs <span class="string"><span class="delimiter">'</span><span class="content">lib</span><span class="delimiter">'</span></span>
    }
    flatDir {
        dirs <span class="string"><span class="delimiter">'</span><span class="content">lib1</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">lib2</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This adds repositories which look into one or more directories for finding dependencies. Note that this type of repository does not support any meta-data formats like Ivy XML or Maven POM files. Instead, Gradle will dynamically generate a module descriptor (without any dependency information) based on the presence of artifacts. However, as Gradle prefers to use modules whose descriptor has been created from real meta-data rather than being generated, flat directory repositories cannot be used to override artifacts with real meta-data from other repositories. For example, if Gradle finds only <code>jmxri-1.2.1.jar</code> in a flat directory repository, but <code>jmxri-1.2.1.pom</code> in another repository that supports meta-data, it will use the second repository to provide the module.</p>
</div>
<div class="paragraph">
<p>For the use case of overriding remote artifacts with local ones consider using an Ivy or Maven repository instead whose URL points to a local directory. If you only work with flat directory repositories you don&#8217;t need to set all attributes of a dependency.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:maven_central"><a class="anchor" href="#sub:maven_central"></a><a class="link" href="#sub:maven_central">Maven Central repository</a></h4>
<div class="paragraph">
<p>Maven Central is a popular repository hosting open source libraries for consumption by Java projects.</p>
</div>
<div class="paragraph">
<p>To declare the <a href="https://repo.maven.apache.org/maven2/">central Maven repository</a> for your build add this to your script:</p>
</div>
<div class="sect4">
<h5 id="example_adding_central_maven_repository"><a class="anchor" href="#example_adding_central_maven_repository"></a><a class="link" href="#example_adding_central_maven_repository">Example: Adding central Maven repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    mavenCentral()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:maven_jcenter"><a class="anchor" href="#sub:maven_jcenter"></a><a class="link" href="#sub:maven_jcenter">JCenter Maven repository</a></h4>
<div class="paragraph">
<p><a href="http://bintray.com">Bintray</a>'s JCenter is an up-to-date collection of all popular Maven OSS artifacts, including artifacts published directly to Bintray.</p>
</div>
<div class="paragraph">
<p>To declare the <a href="https://jcenter.bintray.com">JCenter Maven repository</a> add this to your build script:</p>
</div>
<div class="sect4">
<h5 id="example_adding_bintrays_jcenter_maven_repository"><a class="anchor" href="#example_adding_bintrays_jcenter_maven_repository"></a><a class="link" href="#example_adding_bintrays_jcenter_maven_repository">Example: Adding Bintray&#8217;s JCenter Maven repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    jcenter()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:maven_google"><a class="anchor" href="#sub:maven_google"></a><a class="link" href="#sub:maven_google">Google Maven repository</a></h4>
<div class="paragraph">
<p>The Google repository hosts Android-specific artifacts including the Android SDK. For usage examples, see the <a href="https://developer.android.com/studio/build/dependencies.html#google-maven">relevant documentation</a>.</p>
</div>
<div class="paragraph">
<p>To declare the <a href="https://maven.google.com/">Google Maven repository</a> add this to your build script:</p>
</div>
<div class="sect4">
<h5 id="example_adding_google_maven_repository"><a class="anchor" href="#example_adding_google_maven_repository"></a><a class="link" href="#example_adding_google_maven_repository">Example: Adding Google Maven repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    google()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:maven_local"><a class="anchor" href="#sub:maven_local"></a><a class="link" href="#sub:maven_local">Local Maven repository</a></h4>
<div class="paragraph">
<p>Gradle can consume dependencies available in the <a href="https://maven.apache.org/guides/introduction/introduction-to-repositories.html">local Maven repository</a>. Declaring this repository is beneficial for teams that publish to the local Maven repository with one project and consume the artifacts by Gradle in another project.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Gradle stores resolved dependencies in <a href="#dependency_cache">its own cache</a>. A build does not need to declare the local Maven repository even if you resolve dependencies from a Maven-based, remote repository.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To declare the local Maven cache as a repository add this to your build script:</p>
</div>
<div class="sect4">
<h5 id="example_adding_the_local_maven_cache_as_a_repository"><a class="anchor" href="#example_adding_the_local_maven_cache_as_a_repository"></a><a class="link" href="#example_adding_the_local_maven_cache_as_a_repository">Example: Adding the local Maven cache as a repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    mavenLocal()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle uses the same logic as Maven to identify the location of your local Maven cache. If a local repository location is defined in a <code>settings.xml</code>, this location will be used. The <code>settings.xml</code> in <code><em>USER_HOME</em>/.m2</code> takes precedence over the <code>settings.xml</code> in <code><em>M2_HOME</em>/conf</code>. If no <code>settings.xml</code> is available, Gradle uses the default location <code><em>USER_HOME</em>/.m2/repository</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:maven_repo"><a class="anchor" href="#sub:maven_repo"></a><a class="link" href="#sub:maven_repo">Custom Maven repositories</a></h4>
<div class="paragraph">
<p>Many organizations host dependencies in an in-house Maven repository only accessible within the company&#8217;s network. Gradle can declare Maven repositories by URL.</p>
</div>
<div class="paragraph">
<p>For adding a custom Maven repository you can do:</p>
</div>
<div class="sect4">
<h5 id="example_adding_custom_maven_repository"><a class="anchor" href="#example_adding_custom_maven_repository"></a><a class="link" href="#example_adding_custom_maven_repository">Example: Adding custom Maven repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/maven2</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sometimes a repository will have the POMs published to one location, and the JARs and other artifacts published at another location. To define such a repository, you can do:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_additional_maven_repositories_for_jar_files"><a class="anchor" href="#example_adding_additional_maven_repositories_for_jar_files"></a><a class="link" href="#example_adding_additional_maven_repositories_for_jar_files">Example: Adding additional Maven repositories for JAR files</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        <span class="comment">// Look for POMs and artifacts, such as JARs, here</span>
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo2.mycompany.com/maven2</span><span class="delimiter">&quot;</span></span>
        <span class="comment">// Look for artifacts here if not found at the above location</span>
        artifactUrls <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/jars</span><span class="delimiter">&quot;</span></span>
        artifactUrls <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/jars2</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle will look at the first URL for the POM and the JAR. If the JAR can&#8217;t be found there, the artifact URLs are used to look for JARs.</p>
</div>
<div class="paragraph">
<p>See <a href="#sub:authentication_schemes">Configuring HTTP authentication schemes</a> for authentication options.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:ivy_repositories"><a class="anchor" href="#sec:ivy_repositories"></a><a class="link" href="#sec:ivy_repositories">Custom Ivy repositories</a></h4>
<div class="paragraph">
<p>Organizations might decide to host dependencies in an in-house Ivy repository. Gradle can declare Ivy repositories by URL.</p>
</div>
<div class="sect4">
<h5 id="sec:defining_an_ivy_repository_with_a_standard_layout"><a class="anchor" href="#sec:defining_an_ivy_repository_with_a_standard_layout"></a><a class="link" href="#sec:defining_an_ivy_repository_with_a_standard_layout">Defining an Ivy repository with a standard layout</a></h5>
<div class="paragraph">
<p>To declare an Ivy repository using the standard layout no additional customization is needed. You just declare the URL.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_ivy_repository"><a class="anchor" href="#example_ivy_repository"></a><a class="link" href="#example_ivy_repository">Example: Ivy repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    ivy {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/repo</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:defining_a_named_layout_for_an_ivy_repository"><a class="anchor" href="#sec:defining_a_named_layout_for_an_ivy_repository"></a><a class="link" href="#sec:defining_a_named_layout_for_an_ivy_repository">Defining a named layout for an Ivy repository</a></h5>
<div class="paragraph">
<p>You can specify that your repository conforms to the Ivy or Maven default layout by using a named layout.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_ivy_repository_with_named_layout"><a class="anchor" href="#example_ivy_repository_with_named_layout"></a><a class="link" href="#example_ivy_repository_with_named_layout">Example: Ivy repository with named layout</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    ivy {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/repo</span><span class="delimiter">&quot;</span></span>
        layout <span class="string"><span class="delimiter">&quot;</span><span class="content">maven</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Valid named layout values are <code>'gradle'</code> (the default), <code>'maven'</code>, <code>'ivy'</code> and <code>'pattern'</code>. See <a href="../dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html#org.gradle.api.artifacts.repositories.IvyArtifactRepository:layout(java.lang.String,%20groovy.lang.Closure)">IvyArtifactRepository.layout(java.lang.String, groovy.lang.Closure)</a> in the API documentation for details of these named layouts.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:defining_custom_pattern_layout_for_an_ivy_repository"><a class="anchor" href="#sec:defining_custom_pattern_layout_for_an_ivy_repository"></a><a class="link" href="#sec:defining_custom_pattern_layout_for_an_ivy_repository">Defining custom pattern layout for an Ivy repository</a></h5>
<div class="paragraph">
<p>To define an Ivy repository with a non-standard layout, you can define a <code>'pattern'</code> layout for the repository:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_ivy_repository_with_pattern_layout"><a class="anchor" href="#example_ivy_repository_with_pattern_layout"></a><a class="link" href="#example_ivy_repository_with_pattern_layout">Example: Ivy repository with pattern layout</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    ivy {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/repo</span><span class="delimiter">&quot;</span></span>
        layout <span class="string"><span class="delimiter">&quot;</span><span class="content">pattern</span><span class="delimiter">&quot;</span></span>, {
            artifact <span class="string"><span class="delimiter">&quot;</span><span class="content">[module]/[revision]/[type]/[artifact].[ext]</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To define an Ivy repository which fetches Ivy files and artifacts from different locations, you can define separate patterns to use to locate the Ivy files and artifacts:</p>
</div>
<div class="paragraph">
<p>Each <code>artifact</code> or <code>ivy</code> specified for a repository adds an <em>additional</em> pattern to use. The patterns are used in the order that they are defined.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_ivy_repository_with_multiple_custom_patterns"><a class="anchor" href="#example_ivy_repository_with_multiple_custom_patterns"></a><a class="link" href="#example_ivy_repository_with_multiple_custom_patterns">Example: Ivy repository with multiple custom patterns</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    ivy {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/repo</span><span class="delimiter">&quot;</span></span>
        layout <span class="string"><span class="delimiter">&quot;</span><span class="content">pattern</span><span class="delimiter">&quot;</span></span>, {
            artifact <span class="string"><span class="delimiter">&quot;</span><span class="content">3rd-party-artifacts/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]</span><span class="delimiter">&quot;</span></span>
            artifact <span class="string"><span class="delimiter">&quot;</span><span class="content">company-artifacts/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]</span><span class="delimiter">&quot;</span></span>
            ivy <span class="string"><span class="delimiter">&quot;</span><span class="content">ivy-files/[organisation]/[module]/[revision]/ivy.xml</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optionally, a repository with pattern layout can have its <code>'organisation'</code> part laid out in Maven style, with forward slashes replacing dots as separators. For example, the organisation <code>my.company</code> would then be represented as <code>my/company</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_ivy_repository_with_maven_compatible_layout"><a class="anchor" href="#example_ivy_repository_with_maven_compatible_layout"></a><a class="link" href="#example_ivy_repository_with_maven_compatible_layout">Example: Ivy repository with Maven compatible layout</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    ivy {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/repo</span><span class="delimiter">&quot;</span></span>
        layout <span class="string"><span class="delimiter">&quot;</span><span class="content">pattern</span><span class="delimiter">&quot;</span></span>, {
            artifact <span class="string"><span class="delimiter">&quot;</span><span class="content">[organisation]/[module]/[revision]/[artifact]-[revision].[ext]</span><span class="delimiter">&quot;</span></span>
            m2compatible = <span class="predefined-constant">true</span>
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:accessing_password_protected_ivy_repositories"><a class="anchor" href="#sec:accessing_password_protected_ivy_repositories"></a><a class="link" href="#sec:accessing_password_protected_ivy_repositories">Accessing password-protected Ivy repositories</a></h5>
<div class="paragraph">
<p>You can specify credentials for Ivy repositories secured by basic authentication.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_ivy_repository_with_authentication"><a class="anchor" href="#example_ivy_repository_with_authentication"></a><a class="link" href="#example_ivy_repository_with_authentication">Example: Ivy repository with authentication</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    ivy {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com</span><span class="delimiter">&quot;</span></span>
        credentials {
            username <span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>
            password <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:supported_metadata_sources"><a class="anchor" href="#sub:supported_metadata_sources"></a><a class="link" href="#sub:supported_metadata_sources">Supported metadata sources</a></h4>
<div class="paragraph">
<p>When searching for a module in a repository, Gradle, by default, checks for supported metadata file formats in that repository. In a Maven repository, Gradle looks for a <code>.pom</code> file, in an ivy repository it looks for an <code>ivy.xml</code> file and in a flat directory repository it looks directly for <code>.jar</code> files as it does not expect any metadata. Starting with 5.0, Gradle also looks for <code>.module</code> (Gradle module metadata) files.</p>
</div>
<div class="paragraph">
<p>However, if you define a customized repository you might want to configure this behavior. For example, you can define a Maven repository without <code>.pom</code> files but only jars. To do so, you can configure <em>metadata sources</em> for any repository.</p>
</div>
<div class="sect4">
<h5 id="example_maven_repository_that_supports_artifacts_without_metadata"><a class="anchor" href="#example_maven_repository_that_supports_artifacts_without_metadata"></a><a class="link" href="#example_maven_repository_that_supports_artifacts_without_metadata">Example: Maven repository that supports artifacts without metadata</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/repo</span><span class="delimiter">&quot;</span></span>
        metadataSources {
            mavenPom()
            artifact()
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can specify multiple sources to tell Gradle to keep looking if a file was not found. In that case, the order of checking for sources is predefined.</p>
</div>
<div class="paragraph">
<p>The following metadata sources are supported:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 6. Repository transport protocols</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metadata source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Order</th>
<th class="tableblock halign-left valign-top">Maven</th>
<th class="tableblock halign-left valign-top">Ivy / flat dir</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gradleMetadata()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Look for Gradle <code>.module</code> files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1st</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mavenPom()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Look for Maven <code>.pom</code> files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2nd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ivyDescriptor()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Look for <code>ivy.xml</code> files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2nd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>artifact()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Look directly for artifact</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3rd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The defaults for Ivy and Maven repositories change with Gradle 5.0. Before 5.0, <code>artifact()</code> was included in the defaults. Leading to some inefficiency when modules are missing completely. To restore this behavior, for example, for Maven central you can use <code>mavenCentral { mavenPom(); artifact() }</code>. In a similar way, you can opt into the new behavior in older Gradle verisions using <code>mavenCentral { mavenPom() }</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:supported_transport_protocols"><a class="anchor" href="#sub:supported_transport_protocols"></a><a class="link" href="#sub:supported_transport_protocols">Supported repository transport protocols</a></h4>
<div class="paragraph">
<p>Maven and Ivy repositories support the use of various transport protocols. At the moment the following protocols are supported:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 7. Repository transport protocols</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Credential types</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">username/password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>https</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">username/password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sftp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">username/password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>s3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">access key/secret key/session token or Environment variables</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gcs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developers.google.com/identity/protocols/application-default-credentials">default application credentials</a> sourced from well known files, Environment variables etc.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Username and password should never be checked in plain text into version control as part of your build file. You can store the credentials in a local <code>gradle.properties</code> file and use one of the open source Gradle plugins for encrypting and consuming credentials e.g. the <a href="https://plugins.gradle.org/plugin/nu.studer.credentials">credentials plugin</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The transport protocol is part of the URL definition for a repository. The following build script demonstrates how to create a HTTP-based Maven and Ivy repository:</p>
</div>
<div class="sect4">
<h5 id="example_declaring_a_maven_and_ivy_repository"><a class="anchor" href="#example_declaring_a_maven_and_ivy_repository"></a><a class="link" href="#example_declaring_a_maven_and_ivy_repository">Example: Declaring a Maven and Ivy repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/maven2</span><span class="delimiter">&quot;</span></span>
    }

    ivy {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/repo</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example shows how to declare SFTP repositories:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_the_sftp_protocol_for_a_repository"><a class="anchor" href="#example_using_the_sftp_protocol_for_a_repository"></a><a class="link" href="#example_using_the_sftp_protocol_for_a_repository">Example: Using the SFTP protocol for a repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">sftp://repo.mycompany.com:22/maven2</span><span class="delimiter">&quot;</span></span>
        credentials {
            username <span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>
            password <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>
        }
    }

    ivy {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">sftp://repo.mycompany.com:22/repo</span><span class="delimiter">&quot;</span></span>
        credentials {
            username <span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>
            password <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using an AWS S3 backed repository you need to authenticate using <a href="../dsl/org.gradle.api.credentials.AwsCredentials.html">AwsCredentials</a>, providing access-key and a private-key. The following example shows how to declare a S3 backed repository and providing AWS credentials:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_a_s3_backed_maven_and_ivy_repository"><a class="anchor" href="#example_declaring_a_s3_backed_maven_and_ivy_repository"></a><a class="link" href="#example_declaring_a_s3_backed_maven_and_ivy_repository">Example: Declaring a S3 backed Maven and Ivy repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">s3://myCompanyBucket/maven2</span><span class="delimiter">&quot;</span></span>
        credentials(AwsCredentials) {
            accessKey <span class="string"><span class="delimiter">&quot;</span><span class="content">someKey</span><span class="delimiter">&quot;</span></span>
            secretKey <span class="string"><span class="delimiter">&quot;</span><span class="content">someSecret</span><span class="delimiter">&quot;</span></span>
            <span class="comment">// optional</span>
            sessionToken <span class="string"><span class="delimiter">&quot;</span><span class="content">someSTSToken</span><span class="delimiter">&quot;</span></span>
        }
    }

    ivy {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">s3://myCompanyBucket/ivyrepo</span><span class="delimiter">&quot;</span></span>
        credentials(AwsCredentials) {
            accessKey <span class="string"><span class="delimiter">&quot;</span><span class="content">someKey</span><span class="delimiter">&quot;</span></span>
            secretKey <span class="string"><span class="delimiter">&quot;</span><span class="content">someSecret</span><span class="delimiter">&quot;</span></span>
            <span class="comment">// optional</span>
            sessionToken <span class="string"><span class="delimiter">&quot;</span><span class="content">someSTSToken</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also delegate all credentials to the AWS sdk by using the AwsImAuthentication. The following example shows how:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_a_s3_backed_maven_and_ivy_repository_using_iam"><a class="anchor" href="#example_declaring_a_s3_backed_maven_and_ivy_repository_using_iam"></a><a class="link" href="#example_declaring_a_s3_backed_maven_and_ivy_repository_using_iam">Example: Declaring a S3 backed Maven and Ivy repository using IAM</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">s3://myCompanyBucket/maven2</span><span class="delimiter">&quot;</span></span>
        authentication {
           awsIm(AwsImAuthentication) <span class="comment">// load from EC2 role or env var</span>
        }
    }

    ivy {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">s3://myCompanyBucket/ivyrepo</span><span class="delimiter">&quot;</span></span>
        authentication {
           awsIm(AwsImAuthentication)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using a Google Cloud Storage backed repository default application credentials will be used with no further configuration required:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_a_google_cloud_storage_backed_maven_and_ivy_repository_using_default_application_credentials"><a class="anchor" href="#example_declaring_a_google_cloud_storage_backed_maven_and_ivy_repository_using_default_application_credentials"></a><a class="link" href="#example_declaring_a_google_cloud_storage_backed_maven_and_ivy_repository_using_default_application_credentials">Example: Declaring a Google Cloud Storage backed Maven and Ivy repository using default application credentials</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">gcs://myCompanyBucket/maven2</span><span class="delimiter">&quot;</span></span>
    }

    ivy {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">gcs://myCompanyBucket/ivyrepo</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sub:s3_configuration_properties"><a class="anchor" href="#sub:s3_configuration_properties"></a><a class="link" href="#sub:s3_configuration_properties">S3 configuration properties</a></h5>
<div class="paragraph">
<p>The following system properties can be used to configure the interactions with s3 repositories:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.gradle.s3.endpoint</code></dt>
<dd>
<p>Used to override the AWS S3 endpoint when using a non AWS, S3 API compatible, storage service.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.s3.maxErrorRetry</code></dt>
<dd>
<p>Specifies the maximum number of times to retry a request in the event that the S3 server responds with a HTTP 5xx status code. When not specified a default value of 3 is used.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="sub:s3_url_formats"><a class="anchor" href="#sub:s3_url_formats"></a><a class="link" href="#sub:s3_url_formats">S3 URL formats</a></h5>
<div class="paragraph">
<p>S3 URL&#8217;s are 'virtual-hosted-style' and must be in the following format</p>
</div>
<div class="listingblock">
<div class="content">
<pre>s3://&lt;bucketName&gt;[.&lt;regionSpecificEndpoint&gt;]/&lt;s3Key&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>e.g. <code>s3://myBucket.s3.eu-central-1.amazonaws.com/maven/release</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>myBucket</code> is the AWS S3 bucket name.</p>
</li>
<li>
<p><code>s3.eu-central-1.amazonaws.com</code> is the <em>optional</em> <a href="http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region">region specific endpoint</a>.</p>
</li>
<li>
<p><code>/maven/release</code> is the AWS S3 key (unique identifier for an object within a bucket)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sub:s3_proxy_settings"><a class="anchor" href="#sub:s3_proxy_settings"></a><a class="link" href="#sub:s3_proxy_settings">S3 proxy settings</a></h5>
<div class="paragraph">
<p>A proxy for S3 can be configured using the following system properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>https.proxyHost</code></p>
</li>
<li>
<p><code>https.proxyPort</code></p>
</li>
<li>
<p><code>https.proxyUser</code></p>
</li>
<li>
<p><code>https.proxyPassword</code></p>
</li>
<li>
<p><code>http.nonProxyHosts</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the 'org.gradle.s3.endpoint' property has been specified with a http (not https) URI the following system proxy settings can be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>http.proxyHost</code></p>
</li>
<li>
<p><code>http.proxyPort</code></p>
</li>
<li>
<p><code>http.proxyUser</code></p>
</li>
<li>
<p><code>http.proxyPassword</code></p>
</li>
<li>
<p><code>http.nonProxyHosts</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="s3_v4_signatures"><a class="anchor" href="#s3_v4_signatures"></a><a class="link" href="#s3_v4_signatures">AWS S3 V4 Signatures (AWS4-HMAC-SHA256)</a></h5>
<div class="paragraph">
<p>Some of the AWS S3 regions (eu-central-1 - Frankfurt) require that all HTTP requests are signed in accordance with AWS&#8217;s <a href="http://docs.aws.amazon.com/general/latest/gr/signature-version-4.html">signature version 4</a>. It is recommended to specify S3 URL&#8217;s containing the region specific endpoint when using buckets that require V4 signatures. e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>s3://somebucket.s3.eu-central-1.amazonaws.com/maven/release</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>When a region-specific endpoint is not specified for buckets requiring V4 Signatures, Gradle will use the default AWS region (us-east-1) and the
following warning will appear on the console:</p>
</div>
<div class="paragraph">
<p>Attempting to re-send the request to &#8230;&#8203;. with AWS V4 authentication. To avoid this warning in the future, use region-specific endpoint to access buckets located in regions that require V4 signing.</p>
</div>
<div class="paragraph">
<p>Failing to specify the region-specific endpoint for buckets requiring V4 signatures means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>3 round-trips to AWS, as opposed to one, for every file upload and download.</code></p>
</li>
<li>
<p><code>Depending on location - increased network latencies and slower builds.</code></p>
</li>
<li>
<p><code>Increased likelihood of transmission failures.</code></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="sub:s3_cross_account"><a class="anchor" href="#sub:s3_cross_account"></a><a class="link" href="#sub:s3_cross_account">AWS S3 Cross Account Access</a></h6>
<div class="paragraph">
<p>Some organizations may have multiple AWS accounts, e.g. one for each team. The AWS account of the bucket owner is often different from the artifact publisher and consumers. The bucket owner needs to be able to grant the consumers access otherwise the artifacts will only be usable by the publisher&#8217;s account. This is done by adding the <code>bucket-owner-full-control</code> <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html#canned-acl">Canned ACL</a> to the uploaded objects. Gradle will do this in every upload. Make sure the publisher has the required IAM permission, <code>PutObjectAcl</code> (and <code>PutObjectVersionAcl</code> if bucket versioning is enabled), either directly or via an assumed IAM Role (depending on your case). You can read more at <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/s3-access-control.html">AWS S3 Access Permissions</a>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sub:gcs_configuration_properties"><a class="anchor" href="#sub:gcs_configuration_properties"></a><a class="link" href="#sub:gcs_configuration_properties">Google Cloud Storage configuration properties</a></h5>
<div class="paragraph">
<p>The following system properties can be used to configure the interactions with <a href="https://cloud.google.com/storage/">Google Cloud Storage</a> repositories:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.gradle.gcs.endpoint</code></dt>
<dd>
<p>Used to override the Google Cloud Storage endpoint when using a non-Google Cloud Platform, Google Cloud Storage API compatible, storage service.</p>
</dd>
<dt class="hdlist1"><code>org.gradle.gcs.servicePath</code></dt>
<dd>
<p>Used to override the Google Cloud Storage root service path which the Google Cloud Storage client builds requests from, defaults to <code>/</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="sub:gcs_url_formats"><a class="anchor" href="#sub:gcs_url_formats"></a><a class="link" href="#sub:gcs_url_formats">Google Cloud Storage URL formats</a></h5>
<div class="paragraph">
<p>Google Cloud Storage URL&#8217;s are 'virtual-hosted-style' and must be in the following format <code>gcs://&lt;bucketName&gt;/&lt;objectKey&gt;</code></p>
</div>
<div class="paragraph">
<p>e.g. <code>gcs://myBucket/maven/release</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>myBucket</code> is the Google Cloud Storage bucket name.</p>
</li>
<li>
<p><code>/maven/release</code> is the Google Cloud Storage key (unique identifier for an object within a bucket)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="sub:authentication_schemes"><a class="anchor" href="#sub:authentication_schemes"></a><a class="link" href="#sub:authentication_schemes">Configuring HTTP authentication schemes</a></h5>
<div class="paragraph">
<p>When configuring a repository using HTTP or HTTPS transport protocols, multiple authentication schemes are available. By default, Gradle will attempt to use all schemes that are supported by the Apache HttpClient library, <a href="http://hc.apache.org/httpcomponents-client-ga/tutorial/html/authentication.html#d5e625">documented here</a>. In some cases, it may be preferable to explicitly specify which authentication schemes should be used when exchanging credentials with a remote server. When explicitly declared, only those schemes are used when authenticating to a remote repository.</p>
</div>
<div class="paragraph">
<p>You can specify credentials for Maven repositories secured by basic authentication using api:org.gradle.api.credentials.PasswordCredentials[].</p>
</div>
<div class="sect5">
<h6 id="example_accessing_password_protected_maven_repository"><a class="anchor" href="#example_accessing_password_protected_maven_repository"></a><a class="link" href="#example_accessing_password_protected_maven_repository">Example: Accessing password-protected Maven repository</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/maven2</span><span class="delimiter">&quot;</span></span>
        credentials {
            username <span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>
            password <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/userguide/artifacts/defineRepository</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example show how to configure a repository to use only api:org.gradle.authentication.http.DigestAuthentication[]:</p>
</div>
</div>
<div class="sect5">
<h6 id="example_configure_repository_to_use_only_digest_authentication"><a class="anchor" href="#example_configure_repository_to_use_only_digest_authentication"></a><a class="link" href="#example_configure_repository_to_use_only_digest_authentication">Example: Configure repository to use only digest authentication</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        url <span class="string"><span class="delimiter">'</span><span class="content">https://repo.mycompany.com/maven2</span><span class="delimiter">'</span></span>
        credentials {
            username <span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>
            password <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>
        }
        authentication {
            digest(DigestAuthentication)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Currently supported authentication schemes are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="../javadoc/org/gradle/authentication/http/BasicAuthentication.html">BasicAuthentication</a></dt>
<dd>
<p>Basic access authentication over HTTP. When using this scheme, credentials are sent preemptively.</p>
</dd>
<dt class="hdlist1"><a href="../javadoc/org/gradle/authentication/http/DigestAuthentication.html">DigestAuthentication</a></dt>
<dd>
<p>Digest access authentication over HTTP.</p>
</dd>
<dt class="hdlist1"><a href="../javadoc/org/gradle/authentication/http/HttpHeaderAuthentication.html">HttpHeaderAuthentication</a></dt>
<dd>
<p>Authentication based on any custom HTTP header, e.g. private tokens, OAuth tokens, etc.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sub:preemptive_authentication"><a class="anchor" href="#sub:preemptive_authentication"></a><a class="link" href="#sub:preemptive_authentication">Using preemptive authentication</a></h5>
<div class="paragraph">
<p>Gradle&#8217;s default behavior is to only submit credentials when a server responds with an authentication challenge in the form of a HTTP 401 response. In some cases, the server will respond with a different code (ex. for repositories hosted on GitHub a 404 is returned) causing dependency resolution to fail. To get around this behavior, credentials may be sent to the server preemptively. To enable preemptive authentication simply configure your repository to explicitly use the <a href="../javadoc/org/gradle/authentication/http/BasicAuthentication.html">BasicAuthentication</a> scheme:</p>
</div>
<div class="sect5">
<h6 id="example_configure_repository_to_use_preemptive_authentication"><a class="anchor" href="#example_configure_repository_to_use_preemptive_authentication"></a><a class="link" href="#example_configure_repository_to_use_preemptive_authentication">Example: Configure repository to use preemptive authentication</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        url <span class="string"><span class="delimiter">'</span><span class="content">https://repo.mycompany.com/maven2</span><span class="delimiter">'</span></span>
        credentials {
            username <span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>
            password <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>
        }
        authentication {
            basic(BasicAuthentication)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="using_http_header_authentication"><a class="anchor" href="#using_http_header_authentication"></a><a class="link" href="#using_http_header_authentication">Using HTTP header authentication</a></h5>
<div class="paragraph">
<p>You can specify any HTTP header for secured Maven repositories requiring token, OAuth2 or other HTTP header based authentication using api:org.gradle.api.credentials.HttpHeaderCredentials[] with api:org.gradle.authentication.http.HttpHeaderAuthentication[].</p>
</div>
<div class="sect5">
<h6 id="example_accessing_header_protected_maven_repository"><a class="anchor" href="#example_accessing_header_protected_maven_repository"></a><a class="link" href="#example_accessing_header_protected_maven_repository">Example: Accessing header-protected Maven repository</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/maven2</span><span class="delimiter">&quot;</span></span>
        credentials(HttpHeaderCredentials) {
            name = <span class="string"><span class="delimiter">&quot;</span><span class="content">Private-Token</span><span class="delimiter">&quot;</span></span>
            value = <span class="string"><span class="delimiter">&quot;</span><span class="content">TOKEN</span><span class="delimiter">&quot;</span></span>
        }
        authentication {
            header(HttpHeaderAuthentication)
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/userguide/artifacts/defineRepository</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="declaring_dependencies"><a class="anchor" href="#declaring_dependencies"></a><a class="link" href="#declaring_dependencies">Declaring Dependencies</a></h3>
<div class="paragraph">
<p>Gradle builds can declare dependencies on modules hosted in repositories, files and other Gradle projects. You can find examples for common scenarios in this section. For more information, see the <a href="#dependency_types">full reference on all types of dependencies</a>.</p>
</div>
<div class="paragraph">
<p>Every dependency needs to be assigned to a configuration when declared in a build script. For more information on the purpose and syntax of configurations, see <a href="#managing_dependency_configurations">Managing Dependency Configurations</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:declaring_dependency_to_module"><a class="anchor" href="#sec:declaring_dependency_to_module"></a><a class="link" href="#sec:declaring_dependency_to_module">Declaring a dependency to a module</a></h4>
<div class="paragraph">
<p>Modern software projects rarely build code in isolation. Projects reference modules for the purpose of reusing existing and proven functionality. Upon resolution, selected versions of modules are downloaded from dedicated repositories and stored in the <a href="#dependency_cache">dependency cache</a> to avoid unnecessary network traffic.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-dependencies-to-modules.png" alt="dependency management dependencies to modules">
</div>
<div class="title">Figure 14. Resolving dependencies from remote repositories</div>
</div>
<div class="sect4">
<h5 id="sub:declaring_dependency_with_version"><a class="anchor" href="#sub:declaring_dependency_with_version"></a><a class="link" href="#sub:declaring_dependency_with_version">Declaring a concrete version of a dependency</a></h5>
<div class="paragraph">
<p>A typical example for such a library in a Java project is the <a href="https://projects.spring.io/spring-framework/">Spring framework</a>. The following code snippet declares a compile-time dependency on the Spring web module by its coordinates: <code>org.springframework:spring-web:5.0.2.RELEASE</code>. Gradle resolves the module including its transitive dependencies from the <a href="https://search.maven.org/">Maven Central repository</a> and uses it to compile Java source code. The version attribute of the dependency coordinates points to a <em>concrete version</em> indicating that the underlying artifacts do not change over time. The use of concrete versions ensure reproducibility for the aspect of dependency resolution.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_a_dependency_with_a_concrete_version"><a class="anchor" href="#example_declaring_a_dependency_with_a_concrete_version"></a><a class="link" href="#example_declaring_a_dependency_with_a_concrete_version">Example: Declaring a dependency with a concrete version</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java-library</span><span class="delimiter">'</span></span>

repositories {
    mavenCentral()
}

dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.springframework:spring-web:5.0.2.RELEASE</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A Gradle project can define other types of repositories hosting modules. You can learn more about the syntax and API in the section on <a href="#declaring_repositories">declaring repositories</a>. Refer to <a href="#java_plugin">the chapter on the Java Plugin</a> for a deep dive on declaring dependencies for a Java project. The resolution behavior for dependencies is <a href="#customizing_dependency_resolution_behavior">highly customizable</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="declaring_a_dependency_without_version"><a class="anchor" href="#declaring_a_dependency_without_version"></a><a class="link" href="#declaring_a_dependency_without_version">Declaring a dependency without version</a></h5>
<div class="paragraph">
<p>A recommended practice for larger projects is to declare dependencies without versions and use <a href="#sec:dependency_constraints">dependency constraints</a> for version declaration. The advantage is that dependency constrains allow you to manage versions of all dependencies, including transitive ones, in one place.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_a_dependency_without_version"><a class="anchor" href="#example_declaring_a_dependency_without_version"></a><a class="link" href="#example_declaring_a_dependency_without_version">Example: Declaring a dependency without version</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.springframework:spring-web</span><span class="delimiter">'</span></span>
}

dependencies {
    constraints {
        implementation <span class="string"><span class="delimiter">'</span><span class="content">org.springframework:spring-web:5.0.2.RELEASE</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sub:declaring_dependency_with_dynamic_version"><a class="anchor" href="#sub:declaring_dependency_with_dynamic_version"></a><a class="link" href="#sub:declaring_dependency_with_dynamic_version">Declaring a dynamic version</a></h5>
<div class="paragraph">
<p>Projects might adopt a more aggressive approach for consuming dependencies to modules. For example you might want to always integrate the latest version of a dependency to consume cutting edge features at any given time. A <em>dynamic version</em> allows for resolving the latest version or the latest version of a version range for a given module.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Using dynamic versions in a build bears the risk of potentially breaking it. As soon as a new version of the dependency is released that contains an incompatible API change your source code might stop compiling.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_a_dependency_with_a_dynamic_version"><a class="anchor" href="#example_declaring_a_dependency_with_a_dynamic_version"></a><a class="link" href="#example_declaring_a_dependency_with_a_dynamic_version">Example: Declaring a dependency with a dynamic version</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java-library</span><span class="delimiter">'</span></span>

repositories {
    mavenCentral()
}

dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.springframework:spring-web:5.+</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <a href="https://scans.gradle.com/">build scan</a> can effectively visualize dynamic dependency versions and their respective, selected versions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-dynamic-dependency-build-scan.png" alt="dependency management dynamic dependency build scan">
</div>
<div class="title">Figure 15. Dynamic dependencies in build scan</div>
</div>
<div class="paragraph">
<p>By default, Gradle caches dynamic versions of dependencies for 24 hours. Within this time frame, Gradle does not try to resolve newer versions from the declared repositories. The <a href="#sub:dynamic_versions_and_changing_modules">threshold can be configured</a> as needed for example if you want to resolve new versions earlier.</p>
</div>
</div>
<div class="sect4">
<h5 id="sub:declaring_dependency_with_changing_version"><a class="anchor" href="#sub:declaring_dependency_with_changing_version"></a><a class="link" href="#sub:declaring_dependency_with_changing_version">Declaring a changing version</a></h5>
<div class="paragraph">
<p>A team might decide to implement a series of features before releasing a new version of the application or library. A common strategy to allow consumers to integrate an unfinished version of their artifacts early and often is to release a module with a so-called <em>changing version</em>. A changing version indicates that the feature set is still under active development and hasn&#8217;t released a stable version for general availability yet.</p>
</div>
<div class="paragraph">
<p>In Maven repositories, changing versions are commonly referred to as <a href="https://maven.apache.org/guides/getting-started/index.html#What_is_a_SNAPSHOT_version">snapshot versions</a>. Snapshot versions contain the suffix <code>-SNAPSHOT</code>. The following example demonstrates how to declare a snapshot version on the Spring dependency.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_a_dependency_with_a_changing_version"><a class="anchor" href="#example_declaring_a_dependency_with_a_changing_version"></a><a class="link" href="#example_declaring_a_dependency_with_a_changing_version">Example: Declaring a dependency with a changing version</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java-library</span><span class="delimiter">'</span></span>

repositories {
    mavenCentral()
    maven {
        url <span class="string"><span class="delimiter">'</span><span class="content">https://repo.spring.io/snapshot/</span><span class="delimiter">'</span></span>
    }
}

dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.springframework:spring-web:5.0.3.BUILD-SNAPSHOT</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, Gradle caches changing versions of dependencies for 24 hours. Within this time frame, Gradle does not try to resolve newer versions from the declared repositories. The <a href="#sub:dynamic_versions_and_changing_modules">threshold can be configured</a> as needed for example if you want to resolve new snapshot versions earlier.</p>
</div>
<div class="paragraph">
<p>Gradle is flexible enough to treat any version as changing version e.g. if you wanted to model snapshot behavior for an Ivy module. All you need to do is to set the property <a href="../javadoc/org/gradle/api/artifacts/ExternalModuleDependency.html#setChanging-boolean-">ExternalModuleDependency.setChanging(boolean)</a> to <code>true</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring_file_dependency"><a class="anchor" href="#sec:declaring_file_dependency"></a><a class="link" href="#sec:declaring_file_dependency">Declaring a file dependency</a></h4>
<div class="paragraph">
<p>Projects sometimes do not rely on a binary repository product e.g. JFrog Artifactory or Sonatype Nexus for hosting and resolving external dependencies. It&#8217;s common practice to host those dependencies on a shared drive or check them into version control alongside the project source code. Those dependencies are referred to as <em>file dependencies</em>, the reason being that they represent a file without any <a href="#sub:terminology_module_metadata">metadata</a> (like information about transitive dependencies, the origin or its author) attached to them.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-file-dependencies.png" alt="dependency management file dependencies">
</div>
<div class="title">Figure 16. Resolving file dependencies from the local file system and a shared drive</div>
</div>
<div class="paragraph">
<p>The following example resolves file dependencies from the directories <code>ant</code>, <code>libs</code> and <code>tools</code>.</p>
</div>
<div class="sect4">
<h5 id="example_declaring_multiple_file_dependencies"><a class="anchor" href="#example_declaring_multiple_file_dependencies"></a><a class="link" href="#example_declaring_multiple_file_dependencies">Example: Declaring multiple file dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    antContrib
    externalLibs
    deploymentTools
}

dependencies {
    antContrib files(<span class="string"><span class="delimiter">'</span><span class="content">ant/antcontrib.jar</span><span class="delimiter">'</span></span>)
    externalLibs files(<span class="string"><span class="delimiter">'</span><span class="content">libs/commons-lang.jar</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">libs/log4j.jar</span><span class="delimiter">'</span></span>)
    deploymentTools fileTree(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">tools</span><span class="delimiter">'</span></span>, <span class="key">include</span>: <span class="string"><span class="delimiter">'</span><span class="content">*.exe</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see in the code example, every dependency has to define its exact location in the file system.
The most prominent methods for creating a file reference are
<a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:files(java.lang.Object[])">Project.files(java.lang.Object&#8230;&#8203;)</a>,
<a href="../javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-">ProjectLayout.files(java.lang.Object&#8230;&#8203;)</a>,
<a href="../javadoc/org/gradle/api/file/ProjectLayout.html#configurableFiles-java.lang.Object...-">ProjectLayout.configurableFiles(java.lang.Object&#8230;&#8203;)</a>, and
<a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:fileTree(java.lang.Object)">Project.fileTree(java.lang.Object)</a>
Alternatively, you can also define the source directory of one or many file dependencies in the form of a <a href="#sec:flat_dir_resolver">flat directory repository</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring_project_dependency"><a class="anchor" href="#sec:declaring_project_dependency"></a><a class="link" href="#sec:declaring_project_dependency">Declaring a project dependency</a></h4>
<div class="paragraph">
<p>Software projects often break up software components into modules to improve maintainability and prevent strong coupling. Modules can define dependencies between each other to reuse code within the same project.</p>
</div>
<div class="paragraph">
<p>Gradle can model dependencies between modules. Those dependencies are called <em>project dependencies</em> because each module is represented by a Gradle project. At runtime, the build automatically ensures that project dependencies are built in the correct order and added to the classpath for compilation. The chapter <a href="#multi_project_builds">Authoring Multi-Project Builds</a> discusses how to set up and configure multi-project builds in more detail.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-project-dependencies.png" alt="dependency management project dependencies">
</div>
<div class="title">Figure 17. Dependencies between projects</div>
</div>
<div class="paragraph">
<p>The following example declares the dependencies on the <code>utils</code> and <code>api</code> project from the <code>web-service</code> project. The method <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:project(java.lang.String)">Project.project(java.lang.String)</a> creates a reference to a specific subproject by path.</p>
</div>
<div class="sect4">
<h5 id="example_declaring_project_dependencies"><a class="anchor" href="#example_declaring_project_dependencies"></a><a class="link" href="#example_declaring_project_dependencies">Example: Declaring project dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">project(<span class="string"><span class="delimiter">'</span><span class="content">:web-service</span><span class="delimiter">'</span></span>) {
    dependencies {
        implementation project(<span class="string"><span class="delimiter">'</span><span class="content">:utils</span><span class="delimiter">'</span></span>)
        implementation project(<span class="string"><span class="delimiter">'</span><span class="content">:api</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:resolve_specific_artifacts_from_dependency"><a class="anchor" href="#sub:resolve_specific_artifacts_from_dependency"></a><a class="link" href="#sub:resolve_specific_artifacts_from_dependency">Resolving specific artifacts from a module dependency</a></h4>
<div class="paragraph">
<p>Whenever Gradle tries to resolve a module from a Maven or Ivy repository, it looks for a metadata file and the default artifact file, a JAR. The build fails if none of these artifact files can be resolved. Under certain conditions, you might want to tweak the way Gradle resolves artifacts for a dependency.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The dependency only provides a non-standard artifact without any metadata e.g. a ZIP file.</p>
</li>
<li>
<p>The module metadata declares more than one artifact e.g. as part of an Ivy dependency descriptor.</p>
</li>
<li>
<p>You only want to download a specific artifact without any of the transitive dependencies declared in the metadata.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle is a polyglot build tool and not limited to just resolving Java libraries. Let&#8217;s assume you wanted to build a web application using JavaScript as the client technology. Most projects check in external JavaScript libraries into version control. An external JavaScript library is no different than a reusable Java library so why not download it from a repository instead?</p>
</div>
<div class="paragraph">
<p><a href="https://developers.google.com/speed/libraries/">Google Hosted Libraries</a> is a distribution platform for popular, open-source JavaScript libraries. With the help of the artifact-only notation you can download a JavaScript library file e.g. JQuery. The <code>@</code> character separates the dependency&#8217;s coordinates from the artifact&#8217;s file extension.</p>
</div>
<div class="sect4">
<h5 id="example_resolving_a_javascript_artifact_for_a_declared_dependency"><a class="anchor" href="#example_resolving_a_javascript_artifact_for_a_declared_dependency"></a><a class="link" href="#example_resolving_a_javascript_artifact_for_a_declared_dependency">Example: Resolving a JavaScript artifact for a declared dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    ivy {
        url <span class="string"><span class="delimiter">'</span><span class="content">https://ajax.googleapis.com/ajax/libs</span><span class="delimiter">'</span></span>
        layout <span class="string"><span class="delimiter">'</span><span class="content">pattern</span><span class="delimiter">'</span></span>, {
            artifact <span class="string"><span class="delimiter">'</span><span class="content">[organization]/[revision]/[module].[ext]</span><span class="delimiter">'</span></span>
        }
    }
}

configurations {
    js
}

dependencies {
    js <span class="string"><span class="delimiter">'</span><span class="content">jquery:jquery:3.2.1@js</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Some modules ship different "flavors" of the same artifact or they publish multiple artifacts that belong to a specific module version but have a different purpose. It&#8217;s common for a Java library to publish the artifact with the compiled class files, another one with just the source code in it and a third one containing the Javadocs.</p>
</div>
<div class="paragraph">
<p>In JavaScript, a library may exist as uncompressed or minified artifact. In Gradle, a specific artifact identifier is called <em>classifier</em>, a term generally used in Maven and Ivy dependency management.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say we wanted to download the minified artifact of the JQuery library instead of the uncompressed file. You can provide the classifier <code>min</code> as part of the dependency declaration.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_resolving_a_javascript_artifact_with_classifier_for_a_declared_dependency"><a class="anchor" href="#example_resolving_a_javascript_artifact_with_classifier_for_a_declared_dependency"></a><a class="link" href="#example_resolving_a_javascript_artifact_with_classifier_for_a_declared_dependency">Example: Resolving a JavaScript artifact with classifier for a declared dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    ivy {
        url <span class="string"><span class="delimiter">'</span><span class="content">https://ajax.googleapis.com/ajax/libs</span><span class="delimiter">'</span></span>
        layout <span class="string"><span class="delimiter">'</span><span class="content">pattern</span><span class="delimiter">'</span></span>, {
            artifact <span class="string"><span class="delimiter">'</span><span class="content">[organization]/[revision]/[module](.[classifier]).[ext]</span><span class="delimiter">'</span></span>
        }
    }
}

configurations {
    js
}

dependencies {
    js <span class="string"><span class="delimiter">'</span><span class="content">jquery:jquery:3.2.1:min@js</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="declaring_repositories"><a class="anchor" href="#declaring_repositories"></a><a class="link" href="#declaring_repositories">Declaring Repositories</a></h3>
<div class="paragraph">
<p>Gradle can resolve dependencies from one or many repositories based on Maven, Ivy or flat directory formats. Check out the <a href="#repository_types">full reference on all types of repositories</a> for more information.</p>
</div>
<div class="sect3">
<h4 id="sec:declaring_public_repository"><a class="anchor" href="#sec:declaring_public_repository"></a><a class="link" href="#sec:declaring_public_repository">Declaring a publicly-available repository</a></h4>
<div class="paragraph">
<p>Organizations building software may want to leverage public binary repositories to download and consume open source dependencies. Popular public repositories include Maven Central, Bintray JCenter and the Google Android repository. Gradle provides built-in shortcut methods for the most widely-used repositories.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-shortcut-repositories.png" alt="dependency management shortcut repositories">
</div>
<div class="title">Figure 18. Declaring a repository with the help of shortcut methods</div>
</div>
<div class="paragraph">
<p>To declare JCenter as repository, add this code to your build script:</p>
</div>
<div class="sect4">
<h5 id="example_declaring_jcenter_repository_as_source_for_resolving_dependencies"><a class="anchor" href="#example_declaring_jcenter_repository_as_source_for_resolving_dependencies"></a><a class="link" href="#example_declaring_jcenter_repository_as_source_for_resolving_dependencies">Example: Declaring JCenter repository as source for resolving dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    jcenter()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Under the covers Gradle resolves dependencies from the respective URL of the public repository defined by the shortcut method. All shortcut methods are available via the <a href="../dsl/org.gradle.api.artifacts.dsl.RepositoryHandler.html">RepositoryHandler</a> API. Alternatively, you can <a href="#sec:declaring_custom_repository">spell out the URL of the repository</a> for more fine-grained control.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring_custom_repository"><a class="anchor" href="#sec:declaring_custom_repository"></a><a class="link" href="#sec:declaring_custom_repository">Declaring a custom repository by URL</a></h4>
<div class="paragraph">
<p>Most enterprise projects set up a binary repository available only within an intranet. In-house repositories enable teams to publish internal binaries, setup user management and security measure and ensure uptime and availability. Specifying a custom URL is also helpful if you want to declare a less popular, but publicly-available repository.</p>
</div>
<div class="paragraph">
<p>Add the following code to declare an in-house repository for your build reachable through a custom URL.</p>
</div>
<div class="sect4">
<h5 id="example_declaring_a_custom_repository_by_url"><a class="anchor" href="#example_declaring_a_custom_repository_by_url"></a><a class="link" href="#example_declaring_a_custom_repository_by_url">Example: Declaring a custom repository by URL</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/maven2</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Repositories with custom URLs can be specified as Maven or Ivy repositories by calling the corresponding methods available on the <a href="../dsl/org.gradle.api.artifacts.dsl.RepositoryHandler.html">RepositoryHandler</a> API. Gradle supports other protocols than <code>http</code> or <code>https</code> as part of the custom URL e.g. <code>file</code>, <code>sftp</code> or <code>s3</code>. For a full coverage see the <a href="#sub:supported_transport_protocols">reference manual on supported transport protocols</a>.</p>
</div>
<div class="paragraph">
<p>You can also <a href="#sec:defining_custom_pattern_layout_for_an_ivy_repository">define your own repository layout</a> by using <code>ivy { }</code> repositories as they are very flexible in terms of how modules are organised in a repository.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring_multiple_repositories"><a class="anchor" href="#sec:declaring_multiple_repositories"></a><a class="link" href="#sec:declaring_multiple_repositories">Declaring multiple repositories</a></h4>
<div class="paragraph">
<p>You can define more than one repository for resolving dependencies. Declaring multiple repositories is helpful if some dependencies are only available in one repository but not the other. You can mix any type of repository described in the <a href="#repository_types">reference section</a>.</p>
</div>
<div class="paragraph">
<p>This example demonstrates how to declare various shortcut and custom URL repositories for a project:</p>
</div>
<div class="sect4">
<h5 id="example_declaring_multiple_repositories"><a class="anchor" href="#example_declaring_multiple_repositories"></a><a class="link" href="#example_declaring_multiple_repositories">Example: Declaring multiple repositories</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    jcenter()
    maven {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">https://maven.springframework.org/release</span><span class="delimiter">&quot;</span></span>
    }
    maven {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">https://maven.restlet.com</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The order of declaration determines how Gradle will check for dependencies at runtime. If Gradle finds a module descriptor in a particular repository, it will attempt to download all of the artifacts for that module from <em>the same repository</em>. You can learn more about the inner workings of <a href="#sec:dependency_resolution">Gradle&#8217;s resolution mechanism</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="inspecting_dependencies"><a class="anchor" href="#inspecting_dependencies"></a><a class="link" href="#inspecting_dependencies">Inspecting Dependencies</a></h3>
<div class="paragraph">
<p>Gradle provides sufficient tooling to navigate large dependency graphs and mitigate situations that can lead to <a href="https://en.wikipedia.org/wiki/Dependency_hell">dependency hell</a>. Users can chose to render the full graph of dependencies as well as identify the selection reason and origin for a dependency. The origin of a dependency can be a declared dependency in the build script or a transitive dependency in graph plus their corresponding configuration. Gradle offers both capabilities through visual representation via build scans and as command line tooling.</p>
</div>
<div class="sect3">
<h4 id="sec:listing_dependencies"><a class="anchor" href="#sec:listing_dependencies"></a><a class="link" href="#sec:listing_dependencies">Listing dependencies in a project</a></h4>
<div class="paragraph">
<p>A project can declare one or more dependencies. Gradle can visualize the whole dependency tree for every <a href="#sub:what_is_a_configuration">configuration</a> available in the project.</p>
</div>
<div class="paragraph">
<p>Rendering the dependency tree is particularly useful if you&#8217;d like to identify which dependencies have been resolved at runtime. It also provides you with information about any dependency conflict resolution that occurred in the process and clearly indicates the selected version. The dependency report always contains declared and transitive dependencies.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you&#8217;d want to create tasks for your project that use the <a href="https://www.eclipse.org/jgit/">JGit library</a> to execute SCM operations e.g. to model a release process. You can declare dependencies for any external tooling with the help of a <a href="#managing_dependency_configurations">custom configuration</a> so that it doesn&#8217;t doesn&#8217;t pollute other contexts like the compilation classpath for your production source code.</p>
</div>
<div class="sect4">
<h5 id="example_declaring_the_jgit_dependency_with_a_custom_configuration"><a class="anchor" href="#example_declaring_the_jgit_dependency_with_a_custom_configuration"></a><a class="link" href="#example_declaring_the_jgit_dependency_with_a_custom_configuration">Example: Declaring the JGit dependency with a custom configuration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    jcenter()
}

configurations {
    scm
}

dependencies {
    scm <span class="string"><span class="delimiter">'</span><span class="content">org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <a href="https://scans.gradle.com/">build scan</a> can visualize dependencies as a navigable, searchable tree. Additional context information can be rendered by clicking on a specific dependency in the graph.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-dependencies-report-build-scan.png" alt="dependency management dependencies report build scan">
</div>
<div class="title">Figure 19. Dependency tree in a build scan</div>
</div>
<div class="paragraph">
<p>Every Gradle project provides the task <code>dependencies</code> to render the so-called <em>dependency report</em> from the command line. By default the dependency report renders dependencies for all configurations. To pair down on the information provide the optional parameter <code>--configuration</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_rendering_the_dependency_report_for_a_custom_configuration"><a class="anchor" href="#example_rendering_the_dependency_report_for_a_custom_configuration"></a><a class="link" href="#example_rendering_the_dependency_report_for_a_custom_configuration">Example: Rendering the dependency report for a custom configuration</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q dependencies --configuration scm</code></strong></div>
<div class="content">
<pre>&gt; gradle -q dependencies --configuration scm

------------------------------------------------------------
Root project
------------------------------------------------------------

scm
\--- org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r
     +--- com.jcraft:jsch:0.1.54
     +--- com.googlecode.javaewah:JavaEWAH:1.1.6
     +--- org.apache.httpcomponents:httpclient:4.3.6
     |    +--- org.apache.httpcomponents:httpcore:4.3.3
     |    +--- commons-logging:commons-logging:1.1.3
     |    \--- commons-codec:commons-codec:1.6
     \--- org.slf4j:slf4j-api:1.7.2

A web-based, searchable dependency report is available by adding the --scan option.</pre>
</div>
</div>
<div class="paragraph">
<p>The dependencies report provides detailed information about the dependencies available in the graph. Any dependency that could not be resolved is marked with <code>FAILED</code> in red color. Dependencies with the same coordinates that can occur multiple times in the graph are omitted and indicated by an asterisk. Dependencies that had to undergo conflict resolution render the requested and selected version separated by a right arrow character.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:identifying_reason_dependency_selection"><a class="anchor" href="#sec:identifying_reason_dependency_selection"></a><a class="link" href="#sec:identifying_reason_dependency_selection">Identifying which dependency version was selected and why</a></h4>
<div class="paragraph">
<p>Large software projects inevitably deal with an increased number of dependencies either through direct or transitive dependencies. The <a href="#sec:listing_dependencies">dependencies report</a> provides you with the raw list of dependencies but does not explain <em>why</em> they have been selected or <em>which</em> dependency is responsible for pulling them into the graph.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s have a look at a concrete example. A project may request two different versions of the same dependency either as direct or transitive dependency. Gradle applies version conflict resolution to ensure that only one version of the dependency exists in the dependency graph. In this example the conflicting dependency is represented by <code>commons-codec:commons-codec</code>.</p>
</div>
<div class="sect4">
<h5 id="example_declaring_the_jgit_dependency_and_a_conflicting_dependency"><a class="anchor" href="#example_declaring_the_jgit_dependency_and_a_conflicting_dependency"></a><a class="link" href="#example_declaring_the_jgit_dependency_and_a_conflicting_dependency">Example: Declaring the JGit dependency and a conflicting dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    jcenter()
}

configurations {
    scm
}

dependencies {
    scm <span class="string"><span class="delimiter">'</span><span class="content">org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r</span><span class="delimiter">'</span></span>
    scm <span class="string"><span class="delimiter">'</span><span class="content">commons-codec:commons-codec:1.7</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The dependency tree in a <a href="https://scans.gradle.com/">build scan</a> renders the selection reason (conflict resolution) as well as the origin of a dependency if you click on a dependency and select the "Required By" tab.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-dependency-insight-report-build-scan.png" alt="dependency management dependency insight report build scan">
</div>
<div class="title">Figure 20. Dependency insight capabilities in a build scan</div>
</div>
<div class="paragraph">
<p>Every Gradle project provides the task <code>dependencyInsight</code> to render the so-called  <em>dependency insight report</em> from the command line. Given a dependency in the dependency graph you can identify the selection reason and track down the origin of the dependency selection. You can think of the dependency insight report as the inverse representation of the dependency report for a given dependency. When executing the task you have to provide the mandatory parameter <code>--dependency</code> to specify the coordinates of the dependency under inspection. The parameters <code>--configuration</code> and <code>--singlepath</code> are optional but help with filtering the output.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_the_dependency_insight_report_for_a_given_dependency"><a class="anchor" href="#example_using_the_dependency_insight_report_for_a_given_dependency"></a><a class="link" href="#example_using_the_dependency_insight_report_for_a_given_dependency">Example: Using the dependency insight report for a given dependency</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q dependencyInsight --dependency commons-codec --configuration scm</code></strong></div>
<div class="content">
<pre>&gt; gradle -q dependencyInsight --dependency commons-codec --configuration scm
commons-codec:commons-codec:1.7
   variant "default+runtime" [
      org.gradle.status = release (not requested)
   ]
   Selection reasons:
      - Was requested
      - By conflict resolution : between versions 1.7 and 1.6

commons-codec:commons-codec:1.7
\--- scm

commons-codec:commons-codec:1.6 -&gt; 1.7
\--- org.apache.httpcomponents:httpclient:4.3.6
     \--- org.eclipse.jgit:org.eclipse.jgit:4.9.2.201712150930-r
          \--- scm

A web-based, searchable dependency report is available by adding the --scan option.</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:dependency_declaration_reasons"><a class="anchor" href="#sec:dependency_declaration_reasons"></a><a class="link" href="#sec:dependency_declaration_reasons">Justifying dependency declarations with custom reasons</a></h4>
<div class="paragraph">
<p>When you declare a <a href="#declaring_dependencies">dependency</a> or a <a href="#sec:dependency_constraints">dependency constraint</a>, you can provide a custom reason for the declaration. This makes the dependency declarations in your build script and the dependency insight report easier to interpret.</p>
</div>
<div class="sect4">
<h5 id="example_giving_a_reason_for_choosing_a_certain_module_version_in_a_dependency_declaration"><a class="anchor" href="#example_giving_a_reason_for_choosing_a_certain_module_version_in_a_dependency_declaration"></a><a class="link" href="#example_giving_a_reason_for_choosing_a_certain_module_version_in_a_dependency_declaration">Example: Giving a reason for choosing a certain module version in a dependency declaration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java-library</span><span class="delimiter">'</span></span>

repositories {
    jcenter()
}

dependencies {
    implementation(<span class="string"><span class="delimiter">'</span><span class="content">org.ow2.asm:asm:6.0</span><span class="delimiter">'</span></span>) {
        because <span class="string"><span class="delimiter">'</span><span class="content">we require a JDK 9 compatible bytecode generator</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_using_the_dependency_insight_report_with_custom_reasons"><a class="anchor" href="#example_using_the_dependency_insight_report_with_custom_reasons"></a><a class="link" href="#example_using_the_dependency_insight_report_with_custom_reasons">Example: Using the dependency insight report with custom reasons</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q dependencyInsight --dependency asm</code></strong></div>
<div class="content">
<pre>&gt; gradle -q dependencyInsight --dependency asm
org.ow2.asm:asm:6.0
   variant "compile" [
      org.gradle.status = release (not requested)
      org.gradle.usage  = java-api
   ]
   Selection reasons:
      - Was requested : we require a JDK 9 compatible bytecode generator

org.ow2.asm:asm:6.0
\--- compileClasspath

A web-based, searchable dependency report is available by adding the --scan option.</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="managing_dependency_configurations"><a class="anchor" href="#managing_dependency_configurations"></a><a class="link" href="#managing_dependency_configurations">Managing Dependency Configurations</a></h3>
<div class="sect3">
<h4 id="sub:what_is_a_configuration"><a class="anchor" href="#sub:what_is_a_configuration"></a><a class="link" href="#sub:what_is_a_configuration">What is a configuration?</a></h4>
<div class="paragraph">
<p>Every dependency declared for a Gradle project applies to a specific scope. For example some dependencies should be used for compiling source code whereas others only need to be available at runtime. Gradle represents the scope of a dependency with the help of a <a href="../dsl/org.gradle.api.artifacts.Configuration.html">Configuration</a>. Every configuration can be identified by a unique name.</p>
</div>
<div class="paragraph">
<p>Many Gradle plugins add pre-defined configurations to your project. The Java plugin, for example, adds configurations to represent the various classpaths it needs for source code compilation, executing tests and the like. See <a href="#sec:java_plugin_and_dependency_management">the Java plugin chapter</a> for an example. The sections above demonstrate how to <a href="#declaring_dependencies">declare dependencies</a> for different use cases.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-configurations.png" alt="dependency management configurations">
</div>
<div class="title">Figure 21. Configurations use declared dependencies for specific purposes</div>
</div>
<div class="paragraph">
<p>For more examples on the usage of configurations to navigate, inspect and post-process metadata and artifacts of assigned dependencies, see <a href="#working_with_dependencies">Working with Dependencies</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="defining_custom_configurations"><a class="anchor" href="#defining_custom_configurations"></a><a class="link" href="#defining_custom_configurations">Defining custom configurations</a></h4>
<div class="paragraph">
<p>You can define configurations yourself, so-called <em>custom configurations</em>. A custom configuration is useful for separating the scope of dependencies needed for a dedicated purpose.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you wanted to declare a dependency on the <a href="https://tomcat.apache.org/tomcat-9.0-doc/jasper-howto.html">Jasper Ant task</a> for the purpose of pre-compiling JSP files that should <em>not</em> end up in the classpath for compiling your source code. It&#8217;s fairly simple to achieve that goal by introducing a custom configuration and using it in a task.</p>
</div>
<div class="sect4">
<h5 id="example_declaring_and_using_a_custom_configuration"><a class="anchor" href="#example_declaring_and_using_a_custom_configuration"></a><a class="link" href="#example_declaring_and_using_a_custom_configuration">Example: Declaring and using a custom configuration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    jasper
}

repositories {
    mavenCentral()
}

dependencies {
    jasper <span class="string"><span class="delimiter">'</span><span class="content">org.apache.tomcat.embed:tomcat-embed-jasper:9.0.2</span><span class="delimiter">'</span></span>
}

task preCompileJsps {
    doLast {
        ant.taskdef(<span class="key">classname</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.apache.jasper.JspC</span><span class="delimiter">'</span></span>,
                    <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">jasper</span><span class="delimiter">'</span></span>,
                    <span class="key">classpath</span>: configurations.jasper.asPath)
        ant.jasper(<span class="key">validateXml</span>: <span class="predefined-constant">false</span>,
                   <span class="key">uriroot</span>: file(<span class="string"><span class="delimiter">'</span><span class="content">src/main/webapp</span><span class="delimiter">'</span></span>),
                   <span class="key">outputDir</span>: file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/compiled-jsps</span><span class="delimiter">&quot;</span></span>))
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A project&#8217;s configurations are managed by a <code>configurations</code> object. Configurations have a name and can extend each other. To learn more about this API have a look at <a href="../dsl/org.gradle.api.artifacts.ConfigurationContainer.html">ConfigurationContainer</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:inheriting_dependencies_from_other_configurations"><a class="anchor" href="#sub:inheriting_dependencies_from_other_configurations"></a><a class="link" href="#sub:inheriting_dependencies_from_other_configurations">Inheriting dependencies from other configurations</a></h4>
<div class="paragraph">
<p>A configuration can extend other configurations to form an inheritance hierarchy. Child configurations inherit the whole set of dependencies declared for any of its superconfigurations.</p>
</div>
<div class="paragraph">
<p>Configuration inheritance is heavily used by Gradle core plugins like the <a href="#sec:java_plugin_and_dependency_management">Java plugin</a>. For example the <code>testImplementation</code> configuration extends the <code>implementation</code> configuration. The configuration hierarchy has a practical purpose: compiling tests requires the dependencies of the source code under test on top of the dependencies needed write the test class. A Java project that uses JUnit to write and execute test code also needs Guava if its classes are imported in the production source code.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/dependency-management-configuration-inheritance.png" alt="dependency management configuration inheritance">
</div>
<div class="title">Figure 22. Configuration inheritance provided by the Java plugin</div>
</div>
<div class="paragraph">
<p>Under the covers the <code>testImplementation</code> and <code>implementation</code> configurations form an inheritance hierarchy by calling the method <a href="../dsl/org.gradle.api.artifacts.Configuration.html#org.gradle.api.artifacts.Configuration:extendsFrom(org.gradle.api.artifacts.Configuration[])">Configuration.extendsFrom(org.gradle.api.artifacts.Configuration[])</a>. A configuration can extend any other configuration irrespective of its definition in the build script or a plugin.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you wanted to write a suite of smoke tests. Each smoke test makes a HTTP call to verify a web service endpoint. As the underlying test framework the project already uses JUnit. You can define a new configuration named <code>smokeTest</code> that extends from the <code>testImplementation</code> configuration to reuse the existing test framework dependency.</p>
</div>
<div class="sect4">
<h5 id="example_extending_a_configuration_from_another_configuration"><a class="anchor" href="#example_extending_a_configuration_from_another_configuration"></a><a class="link" href="#example_extending_a_configuration_from_another_configuration">Example: Extending a configuration from another configuration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    smokeTest.extendsFrom testImplementation
}

dependencies {
    testImplementation <span class="string"><span class="delimiter">'</span><span class="content">junit:junit:4.12</span><span class="delimiter">'</span></span>
    smokeTest <span class="string"><span class="delimiter">'</span><span class="content">org.apache.httpcomponents:httpclient:4.5.5</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="managing_transitive_dependencies"><a class="anchor" href="#managing_transitive_dependencies"></a><a class="link" href="#managing_transitive_dependencies">Managing Transitive Dependencies</a></h3>
<div class="paragraph">
<p>Resolution behavior for transitive dependencies can be customized to a high degree to meet enterprise requirements.</p>
</div>
<div class="sect3">
<h4 id="sec:dependency_constraints"><a class="anchor" href="#sec:dependency_constraints"></a><a class="link" href="#sec:dependency_constraints">Managing versions of transitive dependencies with dependency constraints</a></h4>
<div class="paragraph">
<p>Dependency constraints allow you to define the version or the version range of both dependencies declared in the build script and transitive dependencies. It is the preferred method to express constraints that should be applied to all dependencies of a configuration. When Gradle attempts to resolve a dependency to a module version, all <a href="#sub:declaring_dependency_with_version">dependency declarations with version</a>, all transitive dependencies and all dependency constraints for that module are taken into consideration. The highest version that matches all conditions is selected. If no such version is found, Gradle fails with an error showing the conflicting declarations. If this happens you can adjust your dependencies or dependency constraints declarations, or <a href="#managing_transitive_dependencies">make other adjustments to the transitive dependencies</a> if needed. Similar to dependency declarations, dependency constraint declarations are <a href="#managing_dependency_configurations">scoped by configurations</a> and can therefore be selectively defined for parts of a build. If a dependency constraint influenced the resolution result, any type of <a href="#sec:dependency_resolve_rules">dependency resolve rules</a> may still be applied afterwards.</p>
</div>
<div class="sect4">
<h5 id="example_define_dependency_constraints"><a class="anchor" href="#example_define_dependency_constraints"></a><a class="link" href="#example_define_dependency_constraints">Example: Define dependency constraints</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.apache.httpcomponents:httpclient</span><span class="delimiter">'</span></span>
    constraints {
        implementation(<span class="string"><span class="delimiter">'</span><span class="content">org.apache.httpcomponents:httpclient:4.5.3</span><span class="delimiter">'</span></span>) {
            because <span class="string"><span class="delimiter">'</span><span class="content">previous versions have a bug impacting this application</span><span class="delimiter">'</span></span>
        }
        implementation(<span class="string"><span class="delimiter">'</span><span class="content">commons-codec:commons-codec:1.11</span><span class="delimiter">'</span></span>) {
            because <span class="string"><span class="delimiter">'</span><span class="content">version 1.9 pulled from httpclient has bugs affecting this application</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example, all versions are omitted from the dependency declaration. Instead, the versions are defined in the constraints block. The version definition for <code>commons-codec:1.11</code> is only taken into account if <code>commons-codec</code> is brought in as transitive dependency, since <code>commons-codec</code> is not defined as dependency in the project. Otherwise, the constraint has no effect.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Dependency constraints are not yet published, but that will be added in a future release.
This means that their use currently only targets builds that do not publish artifacts to maven or ivy repositories.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dependency constraints themselves can also be added transitively. If a modules&#8217;s metadata is defined in a <code>.pom</code> file that contains dependency entries with <code>&lt;optional&gt;true&lt;/optional&gt;</code>, Gradle will create a dependency constraint for each of these so-called <em>optional dependencies</em>. This leads to a similar resolution behavior as provided by Maven: if the corresponding module is brought in by another, non-optional dependency declaration, then the constraint will apply when choosing the version for that module (e.g., if the optional dependency defines a higher version, that one is chosen).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Support for <em>optional dependencies</em> from pom files is active by default with Gradle 5.0+. For using it in Gradle 4.6+, you need to activate it by adding <code>enableFeaturePreview('IMPROVED_POM_SUPPORT')</code> in <em>settings.gradle</em>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:excluding_transitive_module_dependencies"><a class="anchor" href="#sec:excluding_transitive_module_dependencies"></a><a class="link" href="#sec:excluding_transitive_module_dependencies">Excluding transitive module dependencies</a></h4>
<div class="paragraph">
<p>Declared dependencies in a build script can pull in a lot of transitive dependencies. You might decide that you do not want a particular transitive dependency as part of the dependency graph for a good reason.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The dependency is undesired due to licensing constraints.</p>
</li>
<li>
<p>The dependency is not available in any of the declared repositories.</p>
</li>
<li>
<p>The metadata for the dependency exists but the artifact does not.</p>
</li>
<li>
<p>The metadata provides incorrect coordinates for a transitive dependency.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Transitive dependencies can be excluded on the level of a declared dependency or a configuration. Let&#8217;s demonstrate both use cases. In the following two examples the build script declares a dependency on Log4J, a popular logging framework in the Java world. The metadata of the particular version of Log4J also defines transitive dependencies.</p>
</div>
<div class="sect4">
<h5 id="example_unresolved_artifacts_for_transitive_dependencies"><a class="anchor" href="#example_unresolved_artifacts_for_transitive_dependencies"></a><a class="link" href="#example_unresolved_artifacts_for_transitive_dependencies">Example: Unresolved artifacts for transitive dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>

repositories {
    mavenCentral()
}

dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">log4j:log4j:1.2.15</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If resolved from Maven Central some of the transitive dependencies provide metadata but not the corresponding binary artifact. As a result any task requiring the binary files will fail e.g. a compilation task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; gradle -q compileJava

* What went wrong:
Could not resolve all files for configuration ':compileClasspath'.
&gt; Could not find jms.jar (javax.jms:jms:1.1).
  Searched in the following locations:
      https://repo.maven.apache.org/maven2/javax/jms/jms/1.1/jms-1.1.jar
&gt; Could not find jmxtools.jar (com.sun.jdmk:jmxtools:1.2.1).
  Searched in the following locations:
      https://repo.maven.apache.org/maven2/com/sun/jdmk/jmxtools/1.2.1/jmxtools-1.2.1.jar
&gt; Could not find jmxri.jar (com.sun.jmx:jmxri:1.2.1).
  Searched in the following locations:
      https://repo.maven.apache.org/maven2/com/sun/jmx/jmxri/1.2.1/jmxri-1.2.1.jar</pre>
</div>
</div>
<div class="paragraph">
<p>The situation can be fixed by adding a repository containing those dependencies. In the given example project, the source code does not actually use any of Log4J&#8217;s functionality that require the JMS (e.g. <code><a href="https://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/net/JMSAppender.html">JMSAppender</a></code>) or JMX libraries. It&#8217;s safe to exclude them from the dependency declaration.</p>
</div>
<div class="paragraph">
<p>Exclusions need to spelled out as a key/value pair via the attributes <code>group</code> and/or <code>module</code>. For more information, refer to <a href="../javadoc/org/gradle/api/artifacts/ModuleDependency.html#exclude-java.util.Map-">ModuleDependency.exclude(java.util.Map)</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_excluding_transitive_dependency_for_a_particular_dependency_declaration"><a class="anchor" href="#example_excluding_transitive_dependency_for_a_particular_dependency_declaration"></a><a class="link" href="#example_excluding_transitive_dependency_for_a_particular_dependency_declaration">Example: Excluding transitive dependency for a particular dependency declaration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    implementation(<span class="string"><span class="delimiter">'</span><span class="content">log4j:log4j:1.2.15</span><span class="delimiter">'</span></span>) {
        exclude <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">javax.jms</span><span class="delimiter">'</span></span>, <span class="key">module</span>: <span class="string"><span class="delimiter">'</span><span class="content">jms</span><span class="delimiter">'</span></span>
        exclude <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">com.sun.jdmk</span><span class="delimiter">'</span></span>, <span class="key">module</span>: <span class="string"><span class="delimiter">'</span><span class="content">jmxtools</span><span class="delimiter">'</span></span>
        exclude <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">com.sun.jmx</span><span class="delimiter">'</span></span>, <span class="key">module</span>: <span class="string"><span class="delimiter">'</span><span class="content">jmxri</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You may find that other dependencies will want to pull in the same transitive dependency that misses the artifacts. Alternatively, you can exclude the transitive dependencies for a particular configuration by calling the method <a href="../dsl/org.gradle.api.artifacts.Configuration.html#org.gradle.api.artifacts.Configuration:exclude(java.util.Map)">Configuration.exclude(java.util.Map)</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_excluding_transitive_dependency_for_a_particular_configuration"><a class="anchor" href="#example_excluding_transitive_dependency_for_a_particular_configuration"></a><a class="link" href="#example_excluding_transitive_dependency_for_a_particular_configuration">Example: Excluding transitive dependency for a particular configuration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    implementation {
        exclude <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">javax.jms</span><span class="delimiter">'</span></span>, <span class="key">module</span>: <span class="string"><span class="delimiter">'</span><span class="content">jms</span><span class="delimiter">'</span></span>
        exclude <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">com.sun.jdmk</span><span class="delimiter">'</span></span>, <span class="key">module</span>: <span class="string"><span class="delimiter">'</span><span class="content">jmxtools</span><span class="delimiter">'</span></span>
        exclude <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">com.sun.jmx</span><span class="delimiter">'</span></span>, <span class="key">module</span>: <span class="string"><span class="delimiter">'</span><span class="content">jmxri</span><span class="delimiter">'</span></span>
    }
}

dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">log4j:log4j:1.2.15</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>As a build script author you often times know that you want to exclude a dependency for all configurations available in the project. You can use the method <a href="../javadoc/org/gradle/api/DomainObjectCollection.html#all-org.gradle.api.Action-">DomainObjectCollection.all(org.gradle.api.Action)</a> to define a global rule.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You might encounter other use cases that don&#8217;t quite fit the bill of an exclude rule. For example you want to automatically select a version for a dependency with a specific requested version or you want to select a different group for a requested dependency to react to a relocation. Those use cases are better solved by the <a href="../dsl/org.gradle.api.artifacts.ResolutionStrategy.html">ResolutionStrategy</a> API. Some of these use cases are covered in <a href="#customizing_dependency_resolution_behavior">Customizing Dependency Resolution Behavior</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:enforcing_dependency_version"><a class="anchor" href="#sec:enforcing_dependency_version"></a><a class="link" href="#sec:enforcing_dependency_version">Enforcing a particular dependency version</a></h4>
<div class="paragraph">
<p>Gradle resolves any dependency version conflicts by selecting the latest version found in the dependency graph. Some projects might need to divert from the default behavior and enforce an earlier version of a dependency e.g. if the source code of the project depends on an older API of a dependency than some of the external libraries.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Enforcing a version of a dependency requires a conscious decision. Changing the version of a transitive dependency might lead to runtime errors if external libraries do not properly function without them. Consider upgrading your source code to use a newer version of the library as an alternative approach.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s say a project uses the <a href="https://hc.apache.org/httpcomponents-client-ga/">HttpClient library</a> for performing HTTP calls. HttpClient pulls in <a href="https://commons.apache.org/proper/commons-codec/">Commons Codec</a> as transitive dependency with version 1.10. However, the production source code of the project requires an API from Commons Codec 1.9 which is not available in 1.10 anymore. A dependency version can be enforced by declaring it in the build script and setting <a href="../javadoc/org/gradle/api/artifacts/ExternalDependency.html#setForce-boolean-">ExternalDependency.setForce(boolean)</a> to <code>true</code>.</p>
</div>
<div class="sect4">
<h5 id="example_enforcing_a_dependency_version"><a class="anchor" href="#example_enforcing_a_dependency_version"></a><a class="link" href="#example_enforcing_a_dependency_version">Example: Enforcing a dependency version</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.apache.httpcomponents:httpclient:4.5.4</span><span class="delimiter">'</span></span>
    implementation(<span class="string"><span class="delimiter">'</span><span class="content">commons-codec:commons-codec:1.9</span><span class="delimiter">'</span></span>) {
        force = <span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the project requires a specific version of a dependency on a configuration-level then it can be achieved by calling the method <a href="../dsl/org.gradle.api.artifacts.ResolutionStrategy.html#org.gradle.api.artifacts.ResolutionStrategy:force(java.lang.Object[])">ResolutionStrategy.force(java.lang.Object[])</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_enforcing_a_dependency_version_on_the_configuration_level"><a class="anchor" href="#example_enforcing_a_dependency_version_on_the_configuration_level"></a><a class="link" href="#example_enforcing_a_dependency_version_on_the_configuration_level">Example: Enforcing a dependency version on the configuration-level</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    compileClasspath {
        resolutionStrategy.force <span class="string"><span class="delimiter">'</span><span class="content">commons-codec:commons-codec:1.9</span><span class="delimiter">'</span></span>
    }
}

dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.apache.httpcomponents:httpclient:4.5.4</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:disabling_resolution_transitive_dependencies"><a class="anchor" href="#sub:disabling_resolution_transitive_dependencies"></a><a class="link" href="#sub:disabling_resolution_transitive_dependencies">Disabling resolution of transitive dependencies</a></h4>
<div class="paragraph">
<p>By default Gradle resolves all transitive dependencies specified by the dependency metadata. Sometimes this behavior may not be desirable e.g. if the metadata is incorrect or defines a large graph of transitive dependencies. You can tell Gradle to disable transitive dependency management for a dependency by setting <a href="../javadoc/org/gradle/api/artifacts/ModuleDependency.html#setTransitive-boolean-">ModuleDependency.setTransitive(boolean)</a> to <code>true</code>. As a result only the main artifact will be resolved for the declared dependency.</p>
</div>
<div class="sect4">
<h5 id="example_disabling_transitive_dependency_resolution_for_a_declared_dependency"><a class="anchor" href="#example_disabling_transitive_dependency_resolution_for_a_declared_dependency"></a><a class="link" href="#example_disabling_transitive_dependency_resolution_for_a_declared_dependency">Example: Disabling transitive dependency resolution for a declared dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    implementation(<span class="string"><span class="delimiter">'</span><span class="content">com.google.guava:guava:23.0</span><span class="delimiter">'</span></span>) {
        transitive = <span class="predefined-constant">false</span>
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Disabling transitive dependency resolution will likely require you to declare the necessary runtime dependencies in your build script which otherwise would have been resolved automatically. Not doing so might lead to runtime classpath issues.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A project can decide to disable transitive dependency resolution completely. You either don&#8217;t want to rely on the metadata published to the consumed repositories or you want to gain full control over the dependencies in your graph. For more information, see <a href="../javadoc/org/gradle/api/artifacts/Configuration.html#setTransitive-boolean-">Configuration.setTransitive(boolean)</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_disabling_transitive_dependency_resolution_on_the_configuration_level"><a class="anchor" href="#example_disabling_transitive_dependency_resolution_on_the_configuration_level"></a><a class="link" href="#example_disabling_transitive_dependency_resolution_on_the_configuration_level">Example: Disabling transitive dependency resolution on the configuration-level</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations.all {
    transitive = <span class="predefined-constant">false</span>
}

dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">com.google.guava:guava:23.0</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:bom_import"><a class="anchor" href="#sec:bom_import"></a><a class="link" href="#sec:bom_import">Importing version recommendations from a Maven BOM</a></h4>
<div class="paragraph">
<p>Gradle provides support for importing <a href="https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Importing_Dependencies">bill of materials (BOM) files</a>, which are effectively <code>.pom</code> files that use <code>&lt;dependencyManagement&gt;</code> to control the dependency versions of direct and transitive dependencies. The BOM support in Gradle works similar to using <code>&lt;scope&gt;import&lt;/scope&gt;</code> when depending on a BOM in Maven. In Gradle however, it is done via a regular dependency declaration on the BOM:</p>
</div>
<div class="sect4">
<h5 id="example_depending_on_a_bom_to_import_its_dependency_constraints"><a class="anchor" href="#example_depending_on_a_bom_to_import_its_dependency_constraints"></a><a class="link" href="#example_depending_on_a_bom_to_import_its_dependency_constraints">Example: Depending on a BOM to import its dependency constraints</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    <span class="comment">// import a BOM</span>
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.springframework.boot:spring-boot-dependencies:1.5.8.RELEASE</span><span class="delimiter">'</span></span>

    <span class="comment">// define dependencies without versions</span>
    implementation <span class="string"><span class="delimiter">'</span><span class="content">com.google.code.gson:gson</span><span class="delimiter">'</span></span>
    implementation <span class="string"><span class="delimiter">'</span><span class="content">dom4j:dom4j</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example, the versions of <code>gson</code> and <code>dom4j</code> are provided by the Spring Boot BOM. This way, if you are developing for a platform like Spring Boot, you do not have to declare any versions yourself but can rely on the versions the platform provides.</p>
</div>
<div class="paragraph">
<p>Gradle treats all entries in the <code>&lt;dependencyManagement&gt;</code> block of a BOM similar to <a href="#sec:dependency_constraints">Gradle&#8217;s dependency constraints</a>. This means that any version defined in the <code>&lt;dependencyManagement&gt;</code> block can impact the dependency resolution result. In order to qualify as a BOM, a <code>.pom</code> file needs to have <code>&lt;packaging&gt;pom&lt;/packaging&gt;</code> set.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Importing dependency constraints from Maven BOMs is active by default with Gradle 5.0+. For using it in Gradle 4.6+, you need to activate it by adding <code>enableFeaturePreview('IMPROVED_POM_SUPPORT')</code> in <em>settings.gradle</em>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dependency_locking"><a class="anchor" href="#dependency_locking"></a><a class="link" href="#dependency_locking">Dependency Locking</a></h3>
<div class="paragraph">
<p>Use of dynamic dependency versions (e.g. <code>1.+</code> or <code>[1.0,2.0)</code>) makes builds non-deterministic.
This causes builds to break without any obvious change, and worse, can be caused by a transitive dependency that the build author has no control over.</p>
</div>
<div class="paragraph">
<p>To achieve <a href="https://reproducible-builds.org/">reproducible builds</a>, it is necessary to <em>lock</em> versions of dependencies and transitive dependencies such that a build with the same inputs will always resolve the same module versions.
This is called <em>dependency locking</em>.</p>
</div>
<div class="paragraph">
<p>It enables, amongst others, the following scenarios:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Companies dealing with multi repositories no longer need to rely on <code>-SNAPSHOT</code> or changing dependencies,
which sometimes result in cascading failures when a dependency introduces a bug or incompatibility.
Now dependencies can be declared against major or minor version range, enabling to test with the latest versions on CI while leveraging locking for stable developer builds.</p>
</li>
<li>
<p>Teams that want to always use the latest of their dependencies can use dynamic versions, locking their dependencies only for releases.
The release tag will contain the lock states, allowing that build to be fully reproducible when bug fixes need to be developed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Locking is enabled per <a href="#managing_dependency_configurations">dependency configuration</a>.
Once enabled, you must create an initial lock state.
It will cause Gradle to verify that resolution results do not change, resulting in the same selected dependencies even if newer versions are produced.
Modifications to your build that would impact the resolved set of dependencies will cause it to fail.
This makes sure that changes, either in published dependencies or build definitions, do not alter resolution without adapting the lock state.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Dependency locking makes sense only with <a href="#sub:declaring_dependency_with_dynamic_version">dynamic versions</a>.
It will have no impact on <a href="#sub:declaring_dependency_with_changing_version">changing versions</a> (like <code>-SNAPSHOT</code>) whose coordinates remain the same, though the content may change.
Gradle will even emit a warning when persisting lock state and changing dependencies are present in the resolution result.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="enabling_locking_on_configurations"><a class="anchor" href="#enabling_locking_on_configurations"></a><a class="link" href="#enabling_locking_on_configurations">Enabling locking on configurations</a></h4>
<div class="paragraph">
<p>Locking of a configuration happens through the <a href="../dsl/org.gradle.api.artifacts.ResolutionStrategy.html">ResolutionStrategy</a>:</p>
</div>
<div class="sect5">
<h6 id="example_locking_a_specific_configuration"><a class="anchor" href="#example_locking_a_specific_configuration"></a><a class="link" href="#example_locking_a_specific_configuration">Example: Locking a specific configuration</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    compileClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or the following, as a way to lock all configurations:</p>
</div>
</div>
<div class="sect5">
<h6 id="example_locking_all_configurations"><a class="anchor" href="#example_locking_all_configurations"></a><a class="link" href="#example_locking_all_configurations">Example: Locking all configurations</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencyLocking {
    lockAllConfigurations()
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Only configurations that can be resolved will have lock state attached to them. Applying locking on non resolvable-configurations is simply a no-op.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="generating_and_updating_dependency_locks"><a class="anchor" href="#generating_and_updating_dependency_locks"></a><a class="link" href="#generating_and_updating_dependency_locks">Generating and updating dependency locks</a></h4>
<div class="paragraph">
<p>In order to generate or update lock state, you specify the <code>--write-locks</code> command line argument in addition to the normal tasks that would trigger configurations to be resolved.
This will cause the creation of lock state for each resolved configuration in that build execution.
Note that if lock state existed previously, it is overwritten.</p>
</div>
<div class="sect4">
<h5 id="lock_all_configurations_in_one_build_execution"><a class="anchor" href="#lock_all_configurations_in_one_build_execution"></a><a class="link" href="#lock_all_configurations_in_one_build_execution">Lock all configurations in one build execution</a></h5>
<div class="paragraph">
<p>When locking multiple configurations, you may want to lock them all at once, during a single build execution.</p>
</div>
<div class="paragraph">
<p>For this, you have two options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Run <code>gradle dependencies --write-locks</code>.
This will effectively lock all resolvable configurations that have locking enabled.
Note that in a multi project setup, <code>dependencies</code> only is executed on <em>one</em> project, the root one in this case.</p>
</li>
<li>
<p>Declare a custom task that will resolve all configurations</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="example_resolving_all_configurations"><a class="anchor" href="#example_resolving_all_configurations"></a><a class="link" href="#example_resolving_all_configurations">Example: Resolving all configurations</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task resolveAndLockAll {
    doFirst {
        <span class="keyword">assert</span> gradle.startParameter.writeDependencyLocks
    }
    doLast {
        configurations.findAll {
            <span class="comment">// Add any custom filtering on the configurations to be resolved</span>
            <span class="local-variable">it</span>.canBeResolved
        }.each { <span class="local-variable">it</span>.resolve() }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That second option, with proper choosing of configurations, can be the only option in the native world, where not all configurations can be resolved on a single platform.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="lock_state_location_and_format"><a class="anchor" href="#lock_state_location_and_format"></a><a class="link" href="#lock_state_location_and_format">Lock state location and format</a></h4>
<div class="paragraph">
<p>Lock state will be preserved in a file located in the folder <code>gradle/dependency-locks</code> inside the project or subproject directory.
Each file is named by the configuration it locks and has the <code>lockfile</code> extension.</p>
</div>
<div class="paragraph">
<p>The content of the file is a module notation per line, with a header giving some context.
Module notations are ordered alphabetically, to ease diffs.</p>
</div>
<div class="sect5">
<h6 id="example_lockfile_content"><a class="anchor" href="#example_lockfile_content"></a><a class="link" href="#example_lockfile_content">Example: Lockfile content</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">gradle/dependency-locks/compileClasspath.lockfile</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="error">#</span> This is a Gradle generated file <span class="keyword">for</span> dependency locking.
<span class="error">#</span> Manual edits can <span class="keyword">break</span> the build and are not advised.
<span class="error">#</span> This file is expected to be part of source control.
org.springframework:spring-<span class="key">beans</span>:<span class="float">5.0</span><span class="float">.5</span>.RELEASE
org.springframework:spring-<span class="key">core</span>:<span class="float">5.0</span><span class="float">.5</span>.RELEASE
org.springframework:spring-<span class="key">jcl</span>:<span class="float">5.0</span><span class="float">.5</span>.RELEASE</code></pre>
</div>
</div>
<div class="paragraph">
<p>which matches the following dependency declaration:</p>
</div>
</div>
<div class="sect5">
<h6 id="example_dynamic_dependency_declaration"><a class="anchor" href="#example_dynamic_dependency_declaration"></a><a class="link" href="#example_dynamic_dependency_declaration">Example: Dynamic dependency declaration</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.springframework:spring-beans:[5.0,6.0)</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running_a_build_with_lock_state_present"><a class="anchor" href="#running_a_build_with_lock_state_present"></a><a class="link" href="#running_a_build_with_lock_state_present">Running a build with lock state present</a></h4>
<div class="paragraph">
<p>The moment a build needs to resolve a configuration that has locking enabled and it finds a matching lock state,
it will use it to verify that the given configuration still resolves the same versions.</p>
</div>
<div class="paragraph">
<p>A successful build indicates that the same dependencies are used as stored in the lock state, regardless if new versions matching the dynamic selector have been produced.</p>
</div>
<div class="paragraph">
<p>The complete validation is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Existing entries in the lock state must be matched in the build</p>
<div class="ulist">
<ul>
<li>
<p>A version mismatch or missing resolved module causes a build failure</p>
</li>
</ul>
</div>
</li>
<li>
<p>Resolution result must not contain extra dependencies compared to the lock state</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="selectively_updating_lock_state_entries"><a class="anchor" href="#selectively_updating_lock_state_entries"></a><a class="link" href="#selectively_updating_lock_state_entries">Selectively updating lock state entries</a></h4>
<div class="paragraph">
<p>In order to update only specific modules of a configuration, you can use the <code>--update-locks</code> command line flag.
It takes a comma (<code>,</code>) separated list of module notations.
In this mode, the existing lock state is still used as input to resolution, filtering out the modules targeted by the update.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> gradle classes --update-locks org.apache.commons:commons-lang3,org.slf4j:slf4j-api</pre>
</div>
</div>
<div class="paragraph">
<p>Wildcards, indicated with <code>*</code>, can be used in the group or module name. They can be the only character or appear at the end of the group or module respectively.
The following wildcard notation examples are valid:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.apache.commons:*</code>: will let all modules belonging to group <code>org.apache.commons</code> update</p>
</li>
<li>
<p><code>*:guava</code>: will let all modules named <code>guava</code>, whatever their group, update</p>
</li>
<li>
<p><code>org.springframework.spring*:spring*</code>: will let all modules having their group starting with <code>org.springframework.spring</code> and name starting with <code>spring</code> update</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The resolution may cause other module versions to update, as dictated by the Gradle resolution rules.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="disabling_dependency_locking"><a class="anchor" href="#disabling_dependency_locking"></a><a class="link" href="#disabling_dependency_locking">Disabling dependency locking</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that the configuration for which you no longer want locking is not configured with locking.</p>
</li>
<li>
<p>Remove the file matching the configurations where you no longer want locking.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you only perform the second step above, then locking will effectively no longer be applied.
However, if that configuration happens to be resolved in the future at a time where lock state is persisted, it will once again be locked.</p>
</div>
</div>
<div class="sect3">
<h4 id="locking_limitations"><a class="anchor" href="#locking_limitations"></a><a class="link" href="#locking_limitations">Locking limitations</a></h4>
<div class="ulist">
<ul>
<li>
<p>It is currently not possible to lock the <a href="#sec:applying_plugins_buildscript"><code>classpath</code> configuration</a> used for script plugins.</p>
</li>
<li>
<p>Locking can not yet be applied to source dependencies.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="nebula_locking_plugin"><a class="anchor" href="#nebula_locking_plugin"></a><a class="link" href="#nebula_locking_plugin">Nebula locking plugin</a></h4>
<div class="paragraph">
<p>This feature is inspired by the <a href="https://github.com/nebula-plugins/gradle-dependency-lock-plugin">Nebula Gradle dependency lock plugin</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="troubleshooting_dependency_resolution"><a class="anchor" href="#troubleshooting_dependency_resolution"></a><a class="link" href="#troubleshooting_dependency_resolution">Troubleshooting Dependency Resolution</a></h3>
<div class="paragraph">
<p>Managing dependencies in a project can be challenging. This chapter describes techniques for troubleshooting issues you might encounter in your project as well as best practices for avoiding common problems.</p>
</div>
<div class="sect3">
<h4 id="sub:version_conflicts"><a class="anchor" href="#sub:version_conflicts"></a><a class="link" href="#sub:version_conflicts">Resolving version conflicts</a></h4>
<div class="paragraph">
<p>Gradle resolves version conflicts by picking the highest version of a module. <a href="https://scans.gradle.com/get-started">Build scans</a> and the <a href="#sec:identifying_reason_dependency_selection">dependency insight report</a> are immensely helpful in identifying why a specific version was selected. If the resolution result is not satisfying (e.g. the selected version of a module is too high) or it fails (because you configured <a href="../dsl/org.gradle.api.artifacts.ResolutionStrategy.html#org.gradle.api.artifacts.ResolutionStrategy:failOnVersionConflict()">ResolutionStrategy.failOnVersionConflict()</a>) you have the following possibilities to fix it.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configuring any dependency (transitive or not) as <em>forced</em>. This approach is useful if the dependency in conflict is a transitive dependency. See <a href="#sec:enforcing_dependency_version">Enforcing a particular dependency version</a> for examples.</p>
</li>
<li>
<p>Configuring dependency resolution to <em>prefer modules that are part of your build</em> (transitive or not). This approach is useful if your build contains custom forks of modules (as part of <a href="#multi_project_builds">multi-project builds</a> or as include in <a href="#composite_builds">composite builds</a>). See <a href="../dsl/org.gradle.api.artifacts.ResolutionStrategy.html#org.gradle.api.artifacts.ResolutionStrategy:preferProjectModules()">ResolutionStrategy.preferProjectModules()</a> for more information.</p>
</li>
<li>
<p>Using <a href="#sec:dependency_resolve_rules">dependency resolve rules</a> for fine-grained control over the version selected for a particular dependency.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sub:dynamic_versions_and_changing_modules"><a class="anchor" href="#sub:dynamic_versions_and_changing_modules"></a><a class="link" href="#sub:dynamic_versions_and_changing_modules">Using dynamic versions and changing modules</a></h4>
<div class="paragraph">
<p>There are many situations when you want to use the latest version of a particular module dependency, or the latest in a range of versions. This can be a requirement during development, or you may be developing a library that is designed to work with a range of dependency versions. You can easily depend on these constantly changing dependencies by using a <em>dynamic version</em>. A <a href="#sub:declaring_dependency_with_dynamic_version">dynamic version</a> can be either a version range (e.g. <code>2.+</code>) or it can be a placeholder for the latest version available e.g. <code>latest.integration</code>.</p>
</div>
<div class="paragraph">
<p>Alternatively, the module you request can change over time even for the same version, a so-called <a href="#sub:declaring_dependency_with_changing_version">changing version</a>. An example of this type of <em>changing module</em> is a Maven <code>SNAPSHOT</code> module, which always points at the latest artifact published. In other words, a standard Maven snapshot is a module that is continually evolving, it is a "changing module".</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Using dynamic versions and changing modules can lead to unreproducible builds. As new versions of a particular module are published, its API may become incompatible with your source code. Use this feature with caution!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, Gradle caches dynamic versions and changing modules for 24 hours. During that time frame Gradle does not contact any of the declared, remote repositories for new versions. If you want Gradle to check the remote repository more frequently or with every execution of your build, then you will need to change the time to live (TTL) threshold.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Using a short TTL threshold for dynamic or changing versions may result in longer build times due to the increased number of HTTP(s) calls.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can override the default cache modes using <a href="#sec:controlling_dependency_caching_command_line">command line options</a>. You can also <a href="#sec:controlling_dependency_caching_programmatically">change the cache expiry times in your build programmatically</a> using the resolution strategy.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:controlling_dependency_caching_programmatically"><a class="anchor" href="#sec:controlling_dependency_caching_programmatically"></a><a class="link" href="#sec:controlling_dependency_caching_programmatically">Controlling dependency caching programmatically</a></h4>
<div class="paragraph">
<p>You can fine-tune certain aspects of caching programmatically using the <a href="../javadoc/org/gradle/api/artifacts/ResolutionStrategy.html">ResolutionStrategy</a> for a configuration. The programmatic approach is useful if you would like to change the settings permanently.</p>
</div>
<div class="paragraph">
<p>By default, Gradle caches dynamic versions for 24 hours. To change how long Gradle will cache the resolved version for a dynamic version, use:</p>
</div>
<div class="sect4">
<h5 id="example_dynamic_version_cache_control"><a class="anchor" href="#example_dynamic_version_cache_control"></a><a class="link" href="#example_dynamic_version_cache_control">Example: Dynamic version cache control</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations.all {
    resolutionStrategy.cacheDynamicVersionsFor <span class="integer">10</span>, <span class="string"><span class="delimiter">'</span><span class="content">minutes</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, Gradle caches changing modules for 24 hours. To change how long Gradle will cache the meta-data and artifacts for a changing module, use:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_changing_module_cache_control"><a class="anchor" href="#example_changing_module_cache_control"></a><a class="link" href="#example_changing_module_cache_control">Example: Changing module cache control</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations.all {
    resolutionStrategy.cacheChangingModulesFor <span class="integer">4</span>, <span class="string"><span class="delimiter">'</span><span class="content">hours</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:controlling_dependency_caching_command_line"><a class="anchor" href="#sec:controlling_dependency_caching_command_line"></a><a class="link" href="#sec:controlling_dependency_caching_command_line">Controlling dependency caching from the command line</a></h4>
<div class="paragraph">
<p>You can control the behavior of dependency caching for a distinct build invocation from the command line. Command line options are helpful for making a selective, ad-hoc choice for a single execution of the build.</p>
</div>
<div class="sect4">
<h5 id="avoiding_network_access_with_offline_mode"><a class="anchor" href="#avoiding_network_access_with_offline_mode"></a><a class="link" href="#avoiding_network_access_with_offline_mode">Avoiding network access with offline mode</a></h5>
<div class="paragraph">
<p>The <code>--offline</code> command line switch tells Gradle to always use dependency modules from the cache, regardless if they are due to be checked again. When running with offline, Gradle will never attempt to access the network to perform dependency resolution. If required modules are not present in the dependency cache, build execution will fail.</p>
</div>
</div>
<div class="sect4">
<h5 id="forcing_all_dependencies_to_be_re_resolved"><a class="anchor" href="#forcing_all_dependencies_to_be_re_resolved"></a><a class="link" href="#forcing_all_dependencies_to_be_re_resolved">Forcing all dependencies to be re-resolved</a></h5>
<div class="paragraph">
<p>At times, the Gradle Dependency Cache can become out of sync with the actual state of the configured repositories. Perhaps a repository was initially misconfigured, or perhaps a "non-changing" module was published incorrectly. To refresh all dependencies in the dependency cache, use the <code>--refresh-dependencies</code> option on the command line.</p>
</div>
<div class="paragraph">
<p>The <code>--refresh-dependencies</code> option tells Gradle to ignore all cached entries for resolved modules and artifacts. A fresh resolve will be performed against all configured repositories, with dynamic versions recalculated, modules refreshed, and artifacts downloaded. However, where possible Gradle will check if the previously downloaded artifacts are valid before downloading again. This is done by comparing published SHA1 values in the repository with the SHA1 values for existing downloaded artifacts.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sub:locking_dependency_versions"><a class="anchor" href="#sub:locking_dependency_versions"></a><a class="link" href="#sub:locking_dependency_versions">Locking dependency versions</a></h4>
<div class="paragraph">
<p>The use of <a href="#sub:declaring_dependency_with_dynamic_version">dynamic dependencies</a> in a build is convenient.
The user does not need to know the latest version of a dependency and Gradle automatically uses new versions once they are published.
However, dynamic dependencies make builds non-reproducible, as they can resolve to a different version at a later point in time.
This makes it hard to reproduce old builds when debugging a problem.
It can also disrupt development if a new, but incompatible version is selected.
In the best case the CI build catches the problem and someone needs to investigate.
In the worst case, the problem makes it to production unnoticed.</p>
</div>
<div class="paragraph">
<p>Gradle offers <a href="#dependency_locking">dependency locking</a> to solve this problem.
The user can run a build asking to persist the resolved versions for every module dependency.
This file is then checked in and the versions in it are used on all subsequent runs until the lock is updated or removed again.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:versioning_file_dependencies"><a class="anchor" href="#sub:versioning_file_dependencies"></a><a class="link" href="#sub:versioning_file_dependencies">Versioning of file dependencies</a></h4>
<div class="paragraph">
<p>Legacy projects sometimes prefer to consume <a href="#sec:declaring_file_dependency">file dependencies</a> instead of <a href="#sec:declaring_dependency_to_module">module dependencies</a>. File dependencies can point to any file in the filesystem and do not need to adhere a specific naming convention. It is recommended to clearly express the intention and a concrete version for file dependencies. File dependencies are not considered by Gradle&#8217;s <a href="#sec:dependency_resolution">version conflict resolution</a>. Therefore, it is extremely important to assign a version to the file name to indicate the distinct set of changes shipped with it. For example <code>commons-beanutils-1.3.jar</code> lets you track the changes of the library by the release notes.</p>
</div>
<div class="paragraph">
<p>As a result, the dependencies of the project are easier to maintain and organize. It&#8217;s much easier to uncover potential API incompatibilities by the assigned version.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="customizing_dependency_resolution_behavior"><a class="anchor" href="#customizing_dependency_resolution_behavior"></a><a class="link" href="#customizing_dependency_resolution_behavior">Customizing Dependency Resolution Behavior</a></h3>
<div class="paragraph">
<p>There are a number of ways that you can influence how Gradle resolves dependencies. All of these mechanisms offer an API to define a reason for why they are used. Providing reasons makes dependency resolution results more understandable. If any customization influenced the resolution result, the provided reason will show up in <a href="#sec:identifying_reason_dependency_selection">dependency insight</a> report.</p>
</div>
<div class="sect3">
<h4 id="sec:dependency_resolve_rules"><a class="anchor" href="#sec:dependency_resolve_rules"></a><a class="link" href="#sec:dependency_resolve_rules">Using dependency resolve rules</a></h4>
<div class="paragraph">
<p>A dependency resolve rule is executed for each resolved dependency, and offers a powerful api for manipulating a requested dependency prior to that dependency being resolved. The feature currently offers the ability to change the group, name and/or version of a requested dependency, allowing a dependency to be substituted with a completely different module during resolution.</p>
</div>
<div class="paragraph">
<p>Dependency resolve rules provide a very powerful way to control the dependency resolution process, and can be used to implement all sorts of advanced patterns in dependency management. Some of these patterns are outlined below. For more information and code samples see the <a href="../dsl/org.gradle.api.artifacts.ResolutionStrategy.html">ResolutionStrategy</a> class in the API documentation.</p>
</div>
<div class="sect4">
<h5 id="sec:releasable_unit"><a class="anchor" href="#sec:releasable_unit"></a><a class="link" href="#sec:releasable_unit">Modelling releasable units</a></h5>
<div class="paragraph">
<p>Often an organisation publishes a set of libraries with a single version; where the libraries are built, tested and published together. These libraries form a "releasable unit", designed and intended to be used as a whole. It does not make sense to use libraries from different releasable units together.</p>
</div>
<div class="paragraph">
<p>But it is easy for transitive dependency resolution to violate this contract. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>module-a</code> depends on <code>releasable-unit:part-one:1.0</code></p>
</li>
<li>
<p><code>module-b</code> depends on <code>releasable-unit:part-two:1.1</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A build depending on both <code>module-a</code> and <code>module-b</code> will obtain different versions of libraries within the releasable unit.</p>
</div>
<div class="paragraph">
<p>Dependency resolve rules give you the power to enforce releasable units in your build. Imagine a releasable unit defined by all libraries that have <code>org.gradle</code> group. We can force all of these libraries to use a consistent version:</p>
</div>
<div class="sect5">
<h6 id="example_forcing_a_consistent_version_for_a_group_of_libraries"><a class="anchor" href="#example_forcing_a_consistent_version_for_a_group_of_libraries"></a><a class="link" href="#example_forcing_a_consistent_version_for_a_group_of_libraries">Example: Forcing a consistent version for a group of libraries</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations.all {
    resolutionStrategy.eachDependency { DependencyResolveDetails details -&gt;
        <span class="keyword">if</span> (details.requested.group == <span class="string"><span class="delimiter">'</span><span class="content">org.gradle</span><span class="delimiter">'</span></span>) {
            details.useVersion <span class="string"><span class="delimiter">'</span><span class="content">1.4</span><span class="delimiter">'</span></span>
            details.because <span class="string"><span class="delimiter">'</span><span class="content">API breakage in higher versions</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:custom_versioning_scheme"><a class="anchor" href="#sec:custom_versioning_scheme"></a><a class="link" href="#sec:custom_versioning_scheme">Implementing a custom versioning scheme</a></h5>
<div class="paragraph">
<p>In some corporate environments, the list of module versions that can be declared in Gradle builds is maintained and audited externally. Dependency resolve rules provide a neat implementation of this pattern:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the build script, the developer declares dependencies with the module group and name, but uses a placeholder version, for example: <code>default</code>.</p>
</li>
<li>
<p>The <code>default</code> version is resolved to a specific version via a dependency resolve rule, which looks up the version in a corporate catalog of approved modules.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This rule implementation can be neatly encapsulated in a corporate plugin, and shared across all builds within the organisation.</p>
</div>
<div class="sect5">
<h6 id="example_using_a_custom_versioning_scheme"><a class="anchor" href="#example_using_a_custom_versioning_scheme"></a><a class="link" href="#example_using_a_custom_versioning_scheme">Example: Using a custom versioning scheme</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations.all {
    resolutionStrategy.eachDependency { DependencyResolveDetails details -&gt;
        <span class="keyword">if</span> (details.requested.version == <span class="string"><span class="delimiter">'</span><span class="content">default</span><span class="delimiter">'</span></span>) {
            <span class="keyword">def</span> version = findDefaultVersionInCatalog(details.requested.group, details.requested.name)
            details.useVersion version.version
            details.because version.because
        }
    }
}

<span class="keyword">def</span> <span class="function">findDefaultVersionInCatalog</span>(<span class="predefined-type">String</span> group, <span class="predefined-type">String</span> name) {
    <span class="comment">//some custom logic that resolves the default version into a specific version</span>
    [<span class="key">version</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span>, <span class="key">because</span>: <span class="string"><span class="delimiter">'</span><span class="content">tested by QA</span><span class="delimiter">'</span></span>]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:blacklisting_version"><a class="anchor" href="#sec:blacklisting_version"></a><a class="link" href="#sec:blacklisting_version">Blacklisting a particular version with a replacement</a></h5>
<div class="paragraph">
<p>Dependency resolve rules provide a mechanism for blacklisting a particular version of a dependency and providing a replacement version. This can be useful if a certain dependency version is broken and should not be used, where a dependency resolve rule causes this version to be replaced with a known good version. One example of a broken module is one that declares a dependency on a library that cannot be found in any of the public repositories, but there are many other reasons why a particular module version is unwanted and a different version is preferred.</p>
</div>
<div class="paragraph">
<p>In example below, imagine that version <code>1.2.1</code> contains important fixes and should always be used in preference to <code>1.2</code>. The rule provided will enforce just this: any time version <code>1.2</code> is encountered it will be replaced with <code>1.2.1</code>. Note that this is different from a forced version as described above, in that any other versions of this module would not be affected. This means that the 'newest' conflict resolution strategy would still select version <code>1.3</code> if this version was also pulled transitively.</p>
</div>
<div class="sect5">
<h6 id="example_blacklisting_a_version_with_a_replacement"><a class="anchor" href="#example_blacklisting_a_version_with_a_replacement"></a><a class="link" href="#example_blacklisting_a_version_with_a_replacement">Example: Blacklisting a version with a replacement</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations.all {
    resolutionStrategy.eachDependency { DependencyResolveDetails details -&gt;
        <span class="keyword">if</span> (details.requested.group == <span class="string"><span class="delimiter">'</span><span class="content">org.software</span><span class="delimiter">'</span></span> &amp;&amp; details.requested.name == <span class="string"><span class="delimiter">'</span><span class="content">some-library</span><span class="delimiter">'</span></span> &amp;&amp; details.requested.version == <span class="string"><span class="delimiter">'</span><span class="content">1.2</span><span class="delimiter">'</span></span>) {
            details.useVersion <span class="string"><span class="delimiter">'</span><span class="content">1.2.1</span><span class="delimiter">'</span></span>
            details.because <span class="string"><span class="delimiter">'</span><span class="content">fixes critical bug in 1.2</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:module_substitution"><a class="anchor" href="#sec:module_substitution"></a><a class="link" href="#sec:module_substitution">Substituting a dependency module with a compatible replacement</a></h5>
<div class="paragraph">
<p>At times a completely different module can serve as a replacement for a requested module dependency. Examples include using <code>groovy</code> in place of <code>groovy-all</code>, or using <code>log4j-over-slf4j</code> instead of <code>log4j</code>. You can perform these substitutions using dependency resolve rules:</p>
</div>
<div class="sect5">
<h6 id="example_changing_dependency_group_andor_name_during_resolution"><a class="anchor" href="#example_changing_dependency_group_andor_name_during_resolution"></a><a class="link" href="#example_changing_dependency_group_andor_name_during_resolution">Example: Changing dependency group and/or name during resolution</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations.all {
    resolutionStrategy.eachDependency { DependencyResolveDetails details -&gt;
        <span class="keyword">if</span> (details.requested.name == <span class="string"><span class="delimiter">'</span><span class="content">groovy-all</span><span class="delimiter">'</span></span>) {
            details.useTarget <span class="key">group</span>: details.requested.group, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">groovy</span><span class="delimiter">'</span></span>, <span class="key">version</span>: details.requested.version
            details.because <span class="string"><span class="delimiter">&quot;</span><span class="content">prefer 'groovy' over 'groovy-all'</span><span class="delimiter">&quot;</span></span>
        }
        <span class="keyword">if</span> (details.requested.name == <span class="string"><span class="delimiter">'</span><span class="content">log4j</span><span class="delimiter">'</span></span>) {
            details.useTarget <span class="string"><span class="delimiter">&quot;</span><span class="content">org.slf4j:log4j-over-slf4j:1.7.10</span><span class="delimiter">&quot;</span></span>
            details.because <span class="string"><span class="delimiter">&quot;</span><span class="content">prefer 'log4j-over-slf4j' 1.7.10 over any version of 'log4j'</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:dependency_substitution_rules"><a class="anchor" href="#sec:dependency_substitution_rules"></a><a class="link" href="#sec:dependency_substitution_rules">Using dependency substitution rules</a></h4>
<div class="paragraph">
<p>Dependency substitution rules work similarly to dependency resolve rules. In fact, many capabilities of dependency resolve rules can be implemented with dependency substitution rules. They allow project and module dependencies to be transparently substituted with specified replacements. Unlike dependency resolve rules, dependency substitution rules allow project and module dependencies to be substituted interchangeably.</p>
</div>
<div class="paragraph">
<p><em>Adding a dependency substitution rule to a configuration changes the timing of when that configuration is resolved.</em> Instead of being resolved on first use, the configuration is instead resolved when the task graph is being constructed. This can have unexpected consequences if the configuration is being further modified during task execution, or if the configuration relies on modules that are published during execution of another task.</p>
</div>
<div class="paragraph">
<p>To explain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>Configuration</code> can be declared as an input to any Task, and that configuration can include project dependencies when it is resolved.</p>
</li>
<li>
<p>If a project dependency is an input to a Task (via a configuration), then tasks to build the project artifacts must be added to the task dependencies.</p>
</li>
<li>
<p>In order to determine the project dependencies that are inputs to a task, Gradle needs to resolve the <code>Configuration</code> inputs.</p>
</li>
<li>
<p>Because the Gradle task graph is fixed once task execution has commenced, Gradle needs to perform this resolution prior to executing any tasks.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the absence of dependency substitution rules, Gradle knows that an external module dependency will never transitively reference a project dependency. This makes it easy to determine the full set of project dependencies for a configuration through simple graph traversal. With this functionality, Gradle can no longer make this assumption, and must perform a full resolve in order to determine the project dependencies.</p>
</div>
<div class="sect4">
<h5 id="sec:module_to_project_substitution"><a class="anchor" href="#sec:module_to_project_substitution"></a><a class="link" href="#sec:module_to_project_substitution">Substituting an external module dependency with a project dependency</a></h5>
<div class="paragraph">
<p>One use case for dependency substitution is to use a locally developed version of a module in place of one that is downloaded from an external repository. This could be useful for testing a local, patched version of a dependency.</p>
</div>
<div class="paragraph">
<p>The module to be replaced can be declared with or without a version specified.</p>
</div>
<div class="sect5">
<h6 id="example_substituting_a_module_with_a_project"><a class="anchor" href="#example_substituting_a_module_with_a_project"></a><a class="link" href="#example_substituting_a_module_with_a_project">Example: Substituting a module with a project</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute module(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.utils:api</span><span class="delimiter">&quot;</span></span>) with project(<span class="string"><span class="delimiter">&quot;</span><span class="content">:api</span><span class="delimiter">&quot;</span></span>) because <span class="string"><span class="delimiter">&quot;</span><span class="content">we work with the unreleased development version</span><span class="delimiter">&quot;</span></span>
        substitute module(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.utils:util:2.5</span><span class="delimiter">&quot;</span></span>) with project(<span class="string"><span class="delimiter">&quot;</span><span class="content">:util</span><span class="delimiter">&quot;</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that a project that is substituted must be included in the multi-project build (via <code>settings.gradle</code>). Dependency substitution rules take care of replacing the module dependency with the project dependency and wiring up any task dependencies, but do not implicitly include the project in the build.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:project_to_module_substitution"><a class="anchor" href="#sec:project_to_module_substitution"></a><a class="link" href="#sec:project_to_module_substitution">Substituting a project dependency with a module replacement</a></h5>
<div class="paragraph">
<p>Another way to use substitution rules is to replace a project dependency with a module in a multi-project build. This can be useful to speed up development with a large multi-project build, by allowing a subset of the project dependencies to be downloaded from a repository rather than being built.</p>
</div>
<div class="paragraph">
<p>The module to be used as a replacement must be declared with a version specified.</p>
</div>
<div class="sect5">
<h6 id="example_substituting_a_project_with_a_module"><a class="anchor" href="#example_substituting_a_project_with_a_module"></a><a class="link" href="#example_substituting_a_project_with_a_module">Example: Substituting a project with a module</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations.all {
    resolutionStrategy.dependencySubstitution {
        substitute project(<span class="string"><span class="delimiter">&quot;</span><span class="content">:api</span><span class="delimiter">&quot;</span></span>) with module(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.utils:api:1.3</span><span class="delimiter">&quot;</span></span>) because <span class="string"><span class="delimiter">&quot;</span><span class="content">we use a stable version of utils</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When a project dependency has been replaced with a module dependency, that project is still included in the overall multi-project build. However, tasks to build the replaced dependency will not be executed in order to build the resolve the depending <code>Configuration</code>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:conditional_dependency_substitution"><a class="anchor" href="#sec:conditional_dependency_substitution"></a><a class="link" href="#sec:conditional_dependency_substitution">Conditionally substituting a dependency</a></h5>
<div class="paragraph">
<p>A common use case for dependency substitution is to allow more flexible assembly of sub-projects within a multi-project build. This can be useful for developing a local, patched version of an external dependency or for building a subset of the modules within a large multi-project build.</p>
</div>
<div class="paragraph">
<p>The following example uses a dependency substitution rule to replace any module dependency with the group <code>org.example</code>, but only if a local project matching the dependency name can be located.</p>
</div>
<div class="sect5">
<h6 id="example_conditionally_substituting_a_dependency"><a class="anchor" href="#example_conditionally_substituting_a_dependency"></a><a class="link" href="#example_conditionally_substituting_a_dependency">Example: Conditionally substituting a dependency</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    configurations.all {
        resolutionStrategy.dependencySubstitution.all { DependencySubstitution dependency -&gt;
            <span class="keyword">if</span> (dependency.requested <span class="keyword">instanceof</span> ModuleComponentSelector &amp;&amp; dependency.requested.group == <span class="string"><span class="delimiter">&quot;</span><span class="content">org.example</span><span class="delimiter">&quot;</span></span>) {
                <span class="keyword">def</span> targetProject = findProject(<span class="string"><span class="delimiter">&quot;</span><span class="content">:</span><span class="inline"><span class="inline-delimiter">${</span>dependency.requested.module<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
                <span class="keyword">if</span> (targetProject != <span class="predefined-constant">null</span>) {
                    dependency.useTarget targetProject
                }
            }
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that a project that is substituted must be included in the multi-project build (via <code>settings.gradle</code>). Dependency substitution rules take care of replacing the module dependency with the project dependency, but do not implicitly include the project in the build</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:component_metadata_rules"><a class="anchor" href="#sec:component_metadata_rules"></a><a class="link" href="#sec:component_metadata_rules">Using component metadata rules</a></h4>
<div class="paragraph">
<p>Each module has metadata associated with it, such as its group, name, version, dependencies, and so on. This metadata typically originates in the module&#8217;s descriptor. Metadata rules allow certain parts of a module&#8217;s metadata to be manipulated from within the build script. They take effect after a module&#8217;s descriptor has been downloaded, but before it has been selected among all candidate versions. This makes metadata rules another instrument for customizing dependency resolution.</p>
</div>
<div class="paragraph">
<p>One piece of module metadata that Gradle understands is a module&#8217;s <em>status scheme</em>. This concept, also known from Ivy, models the different levels of maturity that a module transitions through over time. The default status scheme, ordered from least to most mature status, is <code>integration</code>, <code>milestone</code>, <code>release</code>. Apart from a status scheme, a module also has a (current) <em>status</em>, which must be one of the values in its status scheme. If not specified in the (Ivy) descriptor, the status defaults to <code>integration</code> for Ivy modules and Maven snapshot modules, and <code>release</code> for Maven modules that aren&#8217;t snapshots.</p>
</div>
<div class="paragraph">
<p>A module&#8217;s status and status scheme are taken into consideration when a <code>latest</code> version selector is resolved. Specifically, <code>latest.someStatus</code> will resolve to the highest module version that has status <code>someStatus</code> or a more mature status. For example, with the default status scheme in place, <code>latest.integration</code> will select the highest module version regardless of its status (because <code>integration</code> is the least mature status), whereas <code>latest.release</code> will select the highest module version with status <code>release</code>. Here is what this looks like in code:</p>
</div>
<div class="sect4">
<h5 id="example_latest_version_selector"><a class="anchor" href="#example_latest_version_selector"></a><a class="link" href="#example_latest_version_selector">Example: 'Latest' version selector</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    config1 <span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample:client:latest.integration</span><span class="delimiter">&quot;</span></span>
    config2 <span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample:client:latest.release</span><span class="delimiter">&quot;</span></span>
}

task listConfigs {
    doLast {
        configurations.config1.each { println <span class="local-variable">it</span>.name }
        println()
        configurations.config2.each { println <span class="local-variable">it</span>.name }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q listConfigs</code></strong></div>
<div class="content">
<pre>&gt; gradle -q listConfigs
client-1.5.jar

client-1.4.jar</pre>
</div>
</div>
<div class="paragraph">
<p>The next example demonstrates <code>latest</code> selectors based on a custom status scheme declared in a component metadata rule that applies to all modules:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_custom_status_scheme"><a class="anchor" href="#example_custom_status_scheme"></a><a class="link" href="#example_custom_status_scheme">Example: Custom status scheme</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">CustomStatusRule</span> <span class="directive">implements</span> ComponentMetadataRule {
    <span class="annotation">@Override</span>
    <span class="type">void</span> execute(ComponentMetadataContext context) {
        <span class="keyword">def</span> details = context.details
        <span class="keyword">if</span> (details.id.group == <span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample</span><span class="delimiter">&quot;</span></span> &amp;&amp; details.id.name == <span class="string"><span class="delimiter">&quot;</span><span class="content">api</span><span class="delimiter">&quot;</span></span>) {
            details.statusScheme = [<span class="string"><span class="delimiter">&quot;</span><span class="content">bronze</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">silver</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">gold</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">platinum</span><span class="delimiter">&quot;</span></span>]
        }
    }
}

dependencies {
    config3 <span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample:api:latest.silver</span><span class="delimiter">&quot;</span></span>
    components {
        all(CustomStatusRule)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Component metadata rules can be applied to a specified module. Modules must be specified in the form of <code>group:module</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_custom_status_scheme_by_module"><a class="anchor" href="#example_custom_status_scheme_by_module"></a><a class="link" href="#example_custom_status_scheme_by_module">Example: Custom status scheme by module</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">ModuleStatusRule</span> <span class="directive">implements</span> ComponentMetadataRule {
    <span class="annotation">@Override</span>
    <span class="type">void</span> execute(ComponentMetadataContext context) {
        context.details.statusScheme = [<span class="string"><span class="delimiter">&quot;</span><span class="content">int</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">rc</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">prod</span><span class="delimiter">&quot;</span></span>]
    }
}

dependencies {
    config4 <span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample:lib:latest.prod</span><span class="delimiter">&quot;</span></span>
    components {
        withModule(<span class="string"><span class="delimiter">'</span><span class="content">org.sample:lib</span><span class="delimiter">'</span></span>, ModuleStatusRule)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle can also provide to component metadata rules the Ivy-specific metadata for modules resolved from an Ivy repository.
Values from the Ivy descriptor are made available via the <a href="../javadoc/org/gradle/api/artifacts/ivy/IvyModuleDescriptor.html">IvyModuleDescriptor</a> interface.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_ivy_component_metadata_rule"><a class="anchor" href="#example_ivy_component_metadata_rule"></a><a class="link" href="#example_ivy_component_metadata_rule">Example: Ivy component metadata rule</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">IvyComponentRule</span> <span class="directive">implements</span> ComponentMetadataRule {
    <span class="annotation">@Override</span>
    <span class="type">void</span> execute(ComponentMetadataContext context) {
        <span class="keyword">def</span> descriptor = context.getDescriptor(IvyModuleDescriptor)
        <span class="keyword">if</span> (descriptor != <span class="predefined-constant">null</span> &amp;&amp; descriptor.branch == <span class="string"><span class="delimiter">'</span><span class="content">testing</span><span class="delimiter">'</span></span>) {
            context.details.status = <span class="string"><span class="delimiter">&quot;</span><span class="content">rc</span><span class="delimiter">&quot;</span></span>
        }
    }
}
dependencies {
    config5 <span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample:lib:latest.rc</span><span class="delimiter">&quot;</span></span>
    components {
        withModule(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample:lib</span><span class="delimiter">&quot;</span></span>, IvyComponentRule)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that while any rule can request the <a href="../javadoc/org/gradle/api/artifacts/ivy/IvyModuleDescriptor.html">IvyModuleDescriptor</a>, only components sourced from an Ivy repository will have a non-null value for it.</p>
</div>
<div class="paragraph">
<p>As can be seen in the examples above, component metadata rules are defined by implementing <a href="../javadoc/org/gradle/api/artifacts/ComponentMetadataRule.html">ComponentMetadataRule</a> which has a single <code>execute</code> method receiving an instance of <a href="../javadoc/org/gradle/api/artifacts/ComponentMetadataContext.html">ComponentMetadataContext</a> as parameter.</p>
</div>
<div class="paragraph">
<p>The next example shows how you can configure the <code>ComponentMetadataRule</code> through an <a href="../javadoc/org/gradle/api/ActionConfiguration.html">ActionConfiguration</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuration_of_componentmetadatarule"><a class="anchor" href="#example_configuration_of_componentmetadatarule"></a><a class="link" href="#example_configuration_of_componentmetadatarule">Example: Configuration of ComponentMetadataRule</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">ConfiguredRule</span> <span class="directive">implements</span> ComponentMetadataRule {
    <span class="predefined-type">String</span> param

    <span class="annotation">@javax</span>.inject.Inject
    ConfiguredRule(<span class="predefined-type">String</span> param) {
        <span class="local-variable">this</span>.param = param
    }

    <span class="annotation">@Override</span>
    <span class="type">void</span> execute(ComponentMetadataContext context) {
        <span class="keyword">if</span> (param == <span class="string"><span class="delimiter">'</span><span class="content">sampleValue</span><span class="delimiter">'</span></span>) {
            context.details.statusScheme = [<span class="string"><span class="delimiter">&quot;</span><span class="content">bronze</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">silver</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">gold</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">platinum</span><span class="delimiter">&quot;</span></span>]
        }
    }
}
dependencies {
    config6 <span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample:api:latest.gold</span><span class="delimiter">&quot;</span></span>
    components {
        withModule(<span class="string"><span class="delimiter">'</span><span class="content">org.sample:api</span><span class="delimiter">'</span></span>, ConfiguredRule, {
            params(<span class="string"><span class="delimiter">'</span><span class="content">sampleValue</span><span class="delimiter">'</span></span>)
        })
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This happens by having a constructor in your implementation of <code>ComponentMetadataRule</code> accepting the parameters that were configured and the services that need injecting.</p>
</div>
<div class="paragraph">
<p>Gradle enforces isolation of instances of <code>ComponentMetadataRule</code>.
This means that all passed in parameters must be <code>Serializable</code> or known Gradle types that can be isolated.</p>
</div>
<div class="paragraph">
<p>In addition, Gradle services can be injected into your <code>ComponentMetadataRule</code>.
This is for the moment limited to the <a href="../javadoc/org/gradle/api/artifacts/repositories/RepositoryResourceAccessor.html">RepositoryResourceAccessor</a>.
Because of this, the moment you have a constructor, it must be annotated with <code>@javax.inject.Inject</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:component_selection_rules"><a class="anchor" href="#sec:component_selection_rules"></a><a class="link" href="#sec:component_selection_rules">Using component selection rules</a></h4>
<div class="paragraph">
<p>Component selection rules may influence which component instance should be selected when multiple versions are available that match a version selector. Rules are applied against every available version and allow the version to be explicitly rejected by rule. This allows Gradle to ignore any component instance that does not satisfy conditions set by the rule. Examples include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For a dynamic version like <code>1.+</code> certain versions may be explicitly rejected from selection.</p>
</li>
<li>
<p>For a static version like <code>1.4</code> an instance may be rejected based on extra component metadata such as the Ivy branch attribute, allowing an instance from a subsequent repository to be used.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Rules are configured via the <a href="../dsl/org.gradle.api.artifacts.ComponentSelectionRules.html">ComponentSelectionRules</a> object. Each rule configured will be called with a <a href="../dsl/org.gradle.api.artifacts.ComponentSelection.html">ComponentSelection</a> object as an argument which contains information about the candidate version being considered. Calling <a href="../dsl/org.gradle.api.artifacts.ComponentSelection.html#org.gradle.api.artifacts.ComponentSelection:reject(java.lang.String)">ComponentSelection.reject(java.lang.String)</a> causes the given candidate version to be explicitly rejected, in which case the candidate will not be considered for the selector.</p>
</div>
<div class="paragraph">
<p>The following example shows a rule that disallows a particular version of a module but allows the dynamic version to choose the next best candidate.</p>
</div>
<div class="sect4">
<h5 id="example_component_selection_rule"><a class="anchor" href="#example_component_selection_rule"></a><a class="link" href="#example_component_selection_rule">Example: Component selection rule</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    rejectConfig {
        resolutionStrategy {
            componentSelection {
                <span class="comment">// Accept the highest version matching the requested version that isn't '1.5'</span>
                all { ComponentSelection selection -&gt;
                    <span class="keyword">if</span> (selection.candidate.group == <span class="string"><span class="delimiter">'</span><span class="content">org.sample</span><span class="delimiter">'</span></span> &amp;&amp; selection.candidate.module == <span class="string"><span class="delimiter">'</span><span class="content">api</span><span class="delimiter">'</span></span> &amp;&amp; selection.candidate.version == <span class="string"><span class="delimiter">'</span><span class="content">1.5</span><span class="delimiter">'</span></span>) {
                        selection.reject(<span class="string"><span class="delimiter">&quot;</span><span class="content">version 1.5 is broken for 'org.sample:api'</span><span class="delimiter">&quot;</span></span>)
                    }
                }
            }
        }
    }
}

dependencies {
    rejectConfig <span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample:api:1.+</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that version selection is applied starting with the highest version first. The version selected will be the first version found that all component selection rules accept. A version is considered accepted if no rule explicitly rejects it.</p>
</div>
<div class="paragraph">
<p>Similarly, rules can be targeted at specific modules. Modules must be specified in the form of <code>group:module</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_component_selection_rule_with_module_target"><a class="anchor" href="#example_component_selection_rule_with_module_target"></a><a class="link" href="#example_component_selection_rule_with_module_target">Example: Component selection rule with module target</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    targetConfig {
        resolutionStrategy {
            componentSelection {
                withModule(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.sample:api</span><span class="delimiter">&quot;</span></span>) { ComponentSelection selection -&gt;
                    <span class="keyword">if</span> (selection.candidate.version == <span class="string"><span class="delimiter">&quot;</span><span class="content">1.5</span><span class="delimiter">&quot;</span></span>) {
                        selection.reject(<span class="string"><span class="delimiter">&quot;</span><span class="content">version 1.5 is broken for 'org.sample:api'</span><span class="delimiter">&quot;</span></span>)
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Component selection rules can also consider component metadata when selecting a version. Possible metadata arguments that can be considered are <a href="../javadoc/org/gradle/api/artifacts/ComponentMetadata.html">ComponentMetadata</a> and <a href="../javadoc/org/gradle/api/artifacts/ivy/IvyModuleDescriptor.html">IvyModuleDescriptor</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_component_selection_rule_with_metadata"><a class="anchor" href="#example_component_selection_rule_with_metadata"></a><a class="link" href="#example_component_selection_rule_with_metadata">Example: Component selection rule with metadata</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    metadataRulesConfig {
        resolutionStrategy {
            componentSelection {
                <span class="comment">// Reject any versions with a status of 'experimental'</span>
                all { ComponentSelection selection, ComponentMetadata metadata -&gt;
                    <span class="keyword">if</span> (selection.candidate.group == <span class="string"><span class="delimiter">'</span><span class="content">org.sample</span><span class="delimiter">'</span></span> &amp;&amp; metadata.status == <span class="string"><span class="delimiter">'</span><span class="content">experimental</span><span class="delimiter">'</span></span>) {
                        selection.reject(<span class="string"><span class="delimiter">&quot;</span><span class="content">don't use experimental candidates from 'org.sample'</span><span class="delimiter">&quot;</span></span>)
                    }
                }
                <span class="comment">// Accept the highest version with either a &quot;release&quot; branch or a status of 'milestone'</span>
                withModule(<span class="string"><span class="delimiter">'</span><span class="content">org.sample:api</span><span class="delimiter">'</span></span>) { ComponentSelection selection, IvyModuleDescriptor descriptor, ComponentMetadata metadata -&gt;
                    <span class="keyword">if</span> (descriptor.branch != <span class="string"><span class="delimiter">&quot;</span><span class="content">release</span><span class="delimiter">&quot;</span></span> &amp;&amp; metadata.status != <span class="string"><span class="delimiter">'</span><span class="content">milestone</span><span class="delimiter">'</span></span>) {
                        selection.reject(<span class="string"><span class="delimiter">&quot;</span><span class="content">'org.sample:api' must have testing branch or milestone status</span><span class="delimiter">&quot;</span></span>)
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that a <a href="../dsl/org.gradle.api.artifacts.ComponentSelection.html">ComponentSelection</a> argument is <em>always</em> required as the first parameter when declaring a component selection rule with additional Ivy metadata parameters, but the metadata parameters can be declared in any order.</p>
</div>
<div class="paragraph">
<p>Lastly, component selection rules can also be defined using a <em>rule source</em> object. A rule source object is any object that contains exactly one method that defines the rule action and is annotated with <code>@Mutate</code>.</p>
</div>
<div class="paragraph">
<p>This method:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>must return void.</p>
</li>
<li>
<p>must have <a href="../dsl/org.gradle.api.artifacts.ComponentSelection.html">ComponentSelection</a> as the first argument.</p>
</li>
<li>
<p>may have additional parameters of type <a href="../javadoc/org/gradle/api/artifacts/ComponentMetadata.html">ComponentMetadata</a> and/or <a href="../javadoc/org/gradle/api/artifacts/ivy/IvyModuleDescriptor.html">IvyModuleDescriptor</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="example_component_selection_rule_using_a_rule_source_object"><a class="anchor" href="#example_component_selection_rule_using_a_rule_source_object"></a><a class="link" href="#example_component_selection_rule_using_a_rule_source_object">Example: Component selection rule using a rule source object</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">RejectTestBranch</span> {
    <span class="annotation">@Mutate</span>
    <span class="type">void</span> evaluateRule(ComponentSelection selection, IvyModuleDescriptor ivy) {
        <span class="keyword">if</span> (ivy.branch == <span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>) {
            selection.reject(<span class="string"><span class="delimiter">&quot;</span><span class="content">reject test branch</span><span class="delimiter">&quot;</span></span>)
        }
    }
}

configurations {
    ruleSourceConfig {
        resolutionStrategy {
            componentSelection {
                all <span class="keyword">new</span> RejectTestBranch()
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:module_replacement"><a class="anchor" href="#sec:module_replacement"></a><a class="link" href="#sec:module_replacement">Using module replacement rules</a></h4>
<div class="paragraph">
<p>Module replacement rules allow a build to declare that a legacy library has been replaced by a new one. A good example when a new library replaced a legacy one is the <code>google-collections</code> -&gt; <code>guava</code> migration. The team that created google-collections decided to change the module name from <code>com.google.collections:google-collections</code> into <code>com.google.guava:guava</code>. This is a legal scenario in the industry: teams need to be able to change the names of products they maintain, including the module coordinates. Renaming of the module coordinates has impact on conflict resolution.</p>
</div>
<div class="paragraph">
<p>To explain the impact on conflict resolution, let&#8217;s consider the <code>google-collections</code> -&gt; <code>guava</code> scenario. It may happen that both libraries are pulled into the same dependency graph. For example, <em>our project</em> depends on <code>guava</code> but some of <em>our dependencies</em> pull in a legacy version of <code>google-collections</code>. This can cause runtime errors, for example during test or application execution. Gradle does not automatically resolve the <code>google-collections</code> -&gt; <code>guava</code> conflict because it is not considered as a <em>version conflict</em>. It&#8217;s because the module coordinates for both libraries are completely different and conflict resolution is activated when <code>group</code> and <code>module</code> coordinates are the same but there are different versions available in the dependency graph (for more info, refer to the section on conflict resolution). Traditional remedies to this problem are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Declare exclusion rule to avoid pulling in <code>google-collections</code> to graph. It is probably the most popular approach.</p>
</li>
<li>
<p>Avoid dependencies that pull in legacy libraries.</p>
</li>
<li>
<p>Upgrade the dependency version if the new version no longer pulls in a legacy library.</p>
</li>
<li>
<p>Downgrade to <code>google-collections</code>. It&#8217;s not recommended, just mentioned for completeness.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Traditional approaches work but they are not general enough. For example, an organisation wants to resolve the <code>google-collections</code> -&gt; <code>guava</code> conflict resolution problem in all projects. Starting from Gradle 2.2 it is possible to declare that certain module was replaced by other. This enables organisations to include the information about module replacement in the corporate plugin suite and resolve the problem holistically for all Gradle-powered projects in the enterprise.</p>
</div>
<div class="sect4">
<h5 id="example_declaring_a_module_replacement"><a class="anchor" href="#example_declaring_a_module_replacement"></a><a class="link" href="#example_declaring_a_module_replacement">Example: Declaring a module replacement</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    modules {
        module(<span class="string"><span class="delimiter">&quot;</span><span class="content">com.google.collections:google-collections</span><span class="delimiter">&quot;</span></span>) {
            replacedBy(<span class="string"><span class="delimiter">&quot;</span><span class="content">com.google.guava:guava</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">google-collections is now part of Guava</span><span class="delimiter">&quot;</span></span>)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more examples and detailed API, refer to the DSL reference for <a href="../javadoc/org/gradle/api/artifacts/dsl/ComponentMetadataHandler.html">ComponentMetadataHandler</a>.</p>
</div>
<div class="paragraph">
<p>What happens when we declare that <code>google-collections</code> is replaced by <code>guava</code>? Gradle can use this information for conflict resolution. Gradle will consider every version of <code>guava</code> newer/better than any version of <code>google-collections</code>. Also, Gradle will ensure that only guava jar is present in the classpath / resolved file list. Note that if only <code>google-collections</code> appears in the dependency graph (e.g. no <code>guava</code>) Gradle will not eagerly replace it with <code>guava</code>. Module replacement is an information that Gradle uses for resolving conflicts. If there is no conflict (e.g. only <code>google-collections</code> or only <code>guava</code> in the graph) the replacement information is not used.</p>
</div>
<div class="paragraph">
<p>Currently it is not possible to declare that a given module is replaced by a set of modules. However, it is possible to declare that multiple modules are replaced by a single module.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuration_defaults"><a class="anchor" href="#sec:configuration_defaults"></a><a class="link" href="#sec:configuration_defaults">Specifying default dependencies for a configuration</a></h4>
<div class="paragraph">
<p>A configuration can be configured with default dependencies to be used if no dependencies are explicitly set for the configuration. A primary use case of this functionality is for developing plugins that make use of versioned tools that the user might override. By specifying default dependencies, the plugin can use a default version of the tool only if the user has not specified a particular version to use.</p>
</div>
<div class="sect4">
<h5 id="example_specifying_default_dependencies_on_a_configuration"><a class="anchor" href="#example_specifying_default_dependencies_on_a_configuration"></a><a class="link" href="#example_specifying_default_dependencies_on_a_configuration">Example: Specifying default dependencies on a configuration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    pluginTool {
        defaultDependencies { dependencies -&gt;
            dependencies.add(project.dependencies.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle:my-util:1.0</span><span class="delimiter">&quot;</span></span>))
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:ivy_dynamic_resolve_mode"><a class="anchor" href="#sec:ivy_dynamic_resolve_mode"></a><a class="link" href="#sec:ivy_dynamic_resolve_mode">Enabling Ivy dynamic resolve mode</a></h4>
<div class="paragraph">
<p>Gradle&#8217;s Ivy repository implementations support the equivalent to Ivy&#8217;s dynamic resolve mode. Normally, Gradle will use the <code>rev</code> attribute for each dependency definition included in an <code>ivy.xml</code> file. In dynamic resolve mode, Gradle will instead prefer the <code>revConstraint</code> attribute over the <code>rev</code> attribute for a given dependency definition. If the <code>revConstraint</code> attribute is not present, the <code>rev</code> attribute is used instead.</p>
</div>
<div class="paragraph">
<p>To enable dynamic resolve mode, you need to set the appropriate option on the repository definition. A couple of examples are shown below. Note that dynamic resolve mode is only available for Gradle&#8217;s Ivy repositories. It is not available for Maven repositories, or custom Ivy <code>DependencyResolver</code> implementations.</p>
</div>
<div class="sect4">
<h5 id="example_enabling_dynamic_resolve_mode"><a class="anchor" href="#example_enabling_dynamic_resolve_mode"></a><a class="link" href="#example_enabling_dynamic_resolve_mode">Example: Enabling dynamic resolve mode</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// Can enable dynamic resolve mode when you define the repository</span>
repositories {
    ivy {
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com/repo</span><span class="delimiter">&quot;</span></span>
        resolve.dynamicMode = <span class="predefined-constant">true</span>
    }
}

<span class="comment">// Can use a rule instead to enable (or disable) dynamic resolve mode for all repositories</span>
repositories.withType(IvyArtifactRepository) {
    resolve.dynamicMode = <span class="predefined-constant">true</span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dependency_cache"><a class="anchor" href="#dependency_cache"></a><a class="link" href="#dependency_cache">The Dependency Cache</a></h3>
<div class="paragraph">
<p>Gradle contains a highly sophisticated dependency caching mechanism, which seeks to minimise the number of remote requests made in dependency resolution, while striving to guarantee that the results of dependency resolution are correct and reproducible.</p>
</div>
<div class="paragraph">
<p>The Gradle dependency cache consists of two storage types located under <code>GRADLE_USER_HOME/caches</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A file-based store of downloaded artifacts, including binaries like jars as well as raw downloaded meta-data like POM files and Ivy files. The storage path for a downloaded artifact includes the SHA1 checksum, meaning that 2 artifacts with the same name but different content can easily be cached.</p>
</li>
<li>
<p>A binary store of resolved module meta-data, including the results of resolving dynamic versions, module descriptors, and artifacts.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Gradle cache does not allow the local cache to hide problems and create other mysterious and difficult to debug behavior. Gradle enables reliable and reproducible enterprise builds with a focus on bandwidth and storage efficiency.</p>
</div>
<div class="sect3">
<h4 id="sub:cache_metadata"><a class="anchor" href="#sub:cache_metadata"></a><a class="link" href="#sub:cache_metadata">Separate metadata cache</a></h4>
<div class="paragraph">
<p>Gradle keeps a record of various aspects of dependency resolution in binary format in the metadata cache. The information stored in the metadata cache includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The result of resolving a dynamic version (e.g. <code>1.+</code>) to a concrete version (e.g. <code>1.2</code>).</p>
</li>
<li>
<p>The resolved module metadata for a particular module, including module artifacts and module dependencies.</p>
</li>
<li>
<p>The resolved artifact metadata for a particular artifact, including a pointer to the downloaded artifact file.</p>
</li>
<li>
<p>The <em>absence</em> of a particular module or artifact in a particular repository, eliminating repeated attempts to access a resource that does not exist.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Every entry in the metadata cache includes a record of the repository that provided the information as well as a timestamp that can be used for cache expiry.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:cache_repository_independence"><a class="anchor" href="#sub:cache_repository_independence"></a><a class="link" href="#sub:cache_repository_independence">Repository caches are independent</a></h4>
<div class="paragraph">
<p>As described above, for each repository there is a separate metadata cache. A repository is identified by its URL, type and layout. If a module or artifact has not been previously resolved from <em>this repository</em>, Gradle will attempt to resolve the module against the repository. This will always involve a remote lookup on the repository, however in many cases <a href="#sub:cache_artifact_reuse">no download will be required</a>.</p>
</div>
<div class="paragraph">
<p>Dependency resolution will fail if the required artifacts are not available in any repository specified by the build, even if the local cache has a copy of this artifact which was retrieved from a different repository. Repository independence allows builds to be isolated from each other in an advanced way that no build tool has done before. This is a key feature to create builds that are reliable and reproducible in any environment.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:cache_artifact_reuse"><a class="anchor" href="#sub:cache_artifact_reuse"></a><a class="link" href="#sub:cache_artifact_reuse">Artifact reuse</a></h4>
<div class="paragraph">
<p>Before downloading an artifact, Gradle tries to determine the checksum of the required artifact by downloading the sha file associated with that artifact. If the checksum can be retrieved, an artifact is not downloaded if an artifact already exists with the same id and checksum. If the checksum cannot be retrieved from the remote server, the artifact will be downloaded (and ignored if it matches an existing artifact).</p>
</div>
<div class="paragraph">
<p>As well as considering artifacts downloaded from a different repository, Gradle will also attempt to reuse artifacts found in the local Maven Repository. If a candidate artifact has been downloaded by Maven, Gradle will use this artifact if it can be verified to match the checksum declared by the remote server.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:cache_checksum_storage"><a class="anchor" href="#sub:cache_checksum_storage"></a><a class="link" href="#sub:cache_checksum_storage">Checksum based storage</a></h4>
<div class="paragraph">
<p>It is possible for different repositories to provide a different binary artifact in response to the same artifact identifier. This is often the case with Maven SNAPSHOT artifacts, but can also be true for any artifact which is republished without changing its identifier. By caching artifacts based on their SHA1 checksum, Gradle is able to maintain multiple versions of the same artifact. This means that when resolving against one repository Gradle will never overwrite the cached artifact file from a different repository. This is done without requiring a separate artifact file store per repository.</p>
</div>
</div>
<div class="sect3">
<h4 id="sub:cache_locking"><a class="anchor" href="#sub:cache_locking"></a><a class="link" href="#sub:cache_locking">Cache Locking</a></h4>
<div class="paragraph">
<p>The Gradle dependency cache uses file-based locking to ensure that it can safely be used by multiple Gradle processes concurrently. The lock is held whenever the binary meta-data store is being read or written, but is released for slow operations such as downloading remote artifacts.</p>
</div>
<div class="sect4">
<h5 id="sub:cache_cleanup"><a class="anchor" href="#sub:cache_cleanup"></a><a class="link" href="#sub:cache_cleanup">Cache Cleanup</a></h5>
<div class="paragraph">
<p>Gradle keeps track of which artifacts in the dependency cache are accessed. Using this information, the cache is periodically (at most every 24 hours) scanned for artifacts that have not been used for more than 30 days. Obsolete artifacts are then deleted to ensure the cache does not grow indefinitely.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="working_with_dependencies"><a class="anchor" href="#working_with_dependencies"></a><a class="link" href="#working_with_dependencies">Working with Dependencies</a></h3>
<div class="paragraph">
<p>Gradle provides an extensive API for navigating, inspecting and post-processing metadata and artifacts of resolved dependencies.</p>
</div>
<div class="paragraph">
<p>The main entry point for this functionality is the <a href="../dsl/org.gradle.api.artifacts.Configuration.html">Configuration</a> API. To learn more about the fundamentals of configurations, see <a href="#managing_dependency_configurations">Managing Dependency Configurations</a>.</p>
</div>
<div class="sect3">
<h4 id="iterating_over_dependencies_assigned_to_a_configuration"><a class="anchor" href="#iterating_over_dependencies_assigned_to_a_configuration"></a><a class="link" href="#iterating_over_dependencies_assigned_to_a_configuration">Iterating over dependencies assigned to a configuration</a></h4>
<div class="paragraph">
<p>Sometimes you&#8217;ll want to implement logic based on the dependencies declared in the build script of a project e.g. to inspect them in a Gradle plugin. You can iterate over the set of dependencies assigned to a configuration with the help of the method <a href="../dsl/org.gradle.api.artifacts.Configuration.html#org.gradle.api.artifacts.Configuration:dependencies">Configuration.getDependencies()</a>. Alternatively, you can also use <a href="../dsl/org.gradle.api.artifacts.Configuration.html#org.gradle.api.artifacts.Configuration:allDependencies">Configuration.getAllDependencies()</a> to include the dependencies declared in <a href="#sub:inheriting_dependencies_from_other_configurations">superconfigurations</a>. These APIs only return the declared dependencies and do not trigger <a href="#sec:dependency_resolution">dependency resolution</a>. Therefore, the dependency sets do not include transitive dependencies. Calling the APIs during the <a href="#sec:build_phases">configuration phase of the build lifecycle</a> does not result in a significant performance impact.</p>
</div>
<div class="sect4">
<h5 id="example_iterating_over_the_dependencies_assigned_to_a_configuration"><a class="anchor" href="#example_iterating_over_the_dependencies_assigned_to_a_configuration"></a><a class="link" href="#example_iterating_over_the_dependencies_assigned_to_a_configuration">Example: Iterating over the dependencies assigned to a configuration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task iterateDeclaredDependencies {
    doLast {
        DependencySet dependencySet = configurations.scm.dependencies

        dependencySet.each {
            logger.quiet <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span><span class="local-variable">it</span></span><span class="content">.group:</span><span class="inline"><span class="inline-delimiter">$</span><span class="local-variable">it</span></span><span class="content">.name:</span><span class="inline"><span class="inline-delimiter">$</span><span class="local-variable">it</span></span><span class="content">.version</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="iterating_over_artifacts_resolved_for_a_module"><a class="anchor" href="#iterating_over_artifacts_resolved_for_a_module"></a><a class="link" href="#iterating_over_artifacts_resolved_for_a_module">Iterating over artifacts resolved for a module</a></h4>
<div class="paragraph">
<p>None of the <a href="#inspecting_dependencies">dependency reporting</a> helps you with inspecting or further processing the underlying, resolved artifacts of a module. A typical use case for accessing the artifacts is to copy them into a specific directory or filter out files of interest based on a specific file extension.</p>
</div>
<div class="paragraph">
<p>You can iterate over the complete set of artifacts resolved for a module with the help of the method <a href="../javadoc/org/gradle/api/file/FileCollection.html#getFiles--">FileCollection.getFiles()</a>. Every file instance returned from the method points to its location in the <a href="#dependency_cache">dependency cache</a>. Using this method on a <code>Configuration</code> instance is possible as the interface extends <code>FileCollection</code>.</p>
</div>
<div class="sect4">
<h5 id="example_iterating_over_the_artifacts_resolved_for_a_module"><a class="anchor" href="#example_iterating_over_the_artifacts_resolved_for_a_module"></a><a class="link" href="#example_iterating_over_the_artifacts_resolved_for_a_module">Example: Iterating over the artifacts resolved for a module</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task iterateResolvedArtifacts {
    dependsOn configurations.scm

    doLast {
        configurations.scm.each {
            logger.quiet <span class="local-variable">it</span>.absolutePath
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Iterating over the artifacts of a module automatically resolves the configuration. A resolved configuration becomes immutable and cannot add or remove dependencies. If needed you can copy a configuration for further modification via <a href="../dsl/org.gradle.api.artifacts.Configuration.html#org.gradle.api.artifacts.Configuration:copy()">Configuration.copy()</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="navigating_the_dependency_graph"><a class="anchor" href="#navigating_the_dependency_graph"></a><a class="link" href="#navigating_the_dependency_graph">Navigating the dependency graph</a></h4>
<div class="paragraph">
<p>As a plugin developer, you may want to navigate the full graph of dependencies assigned to a configuration e.g. for turning the dependency graph into a visualization. You can access the full graph of dependencies for a configuration with the help of the <a href="../javadoc/org/gradle/api/artifacts/result/ResolutionResult.html">ResolutionResult</a>.</p>
</div>
<div class="paragraph">
<p>The resolution result provides various methods for accessing the resolved and unresolved dependencies. For demonstration purposes the sample code uses <a href="../javadoc/org/gradle/api/artifacts/result/ResolutionResult.html#getRoot--">ResolutionResult.getRoot()</a> to access the root node the resolved dependency graph. Each dependency of this component returns an instance of <a href="../javadoc/org/gradle/api/artifacts/result/ResolvedDependencyResult.html">ResolvedDependencyResult</a> or <a href="../javadoc/org/gradle/api/artifacts/result/UnresolvedDependencyResult.html">UnresolvedDependencyResult</a> providing detailed information about the node.</p>
</div>
<div class="sect4">
<h5 id="example_walking_the_resolved_and_unresolved_dependencies_of_a_configuration"><a class="anchor" href="#example_walking_the_resolved_and_unresolved_dependencies_of_a_configuration"></a><a class="link" href="#example_walking_the_resolved_and_unresolved_dependencies_of_a_configuration">Example: Walking the resolved and unresolved dependencies of a configuration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task walkDependencyGraph(<span class="key">type</span>: DependencyGraphWalk) {
    dependsOn configurations.scm
}

<span class="type">class</span> <span class="class">DependencyGraphWalk</span> <span class="directive">extends</span> DefaultTask {
    <span class="annotation">@TaskAction</span>
    <span class="type">void</span> walk() {
        <span class="predefined-type">Configuration</span> configuration = project.configurations.scm
        ResolutionResult resolutionResult = configuration.incoming.resolutionResult
        ResolvedComponentResult root = resolutionResult.root
        logger.quiet configuration.name
        traverseDependencies(<span class="integer">0</span>, root.dependencies)
    }

    <span class="directive">private</span> <span class="type">void</span> traverseDependencies(<span class="type">int</span> level, <span class="predefined-type">Set</span>&lt;? <span class="directive">extends</span> DependencyResult&gt; results) {
        <span class="keyword">for</span> (DependencyResult result : results) {
            <span class="keyword">if</span> (result <span class="keyword">instanceof</span> ResolvedDependencyResult) {
                ResolvedComponentResult componentResult = result.selected
                ComponentIdentifier componentIdentifier = componentResult.id
                <span class="predefined-type">String</span> node = calculateIndentation(level) + <span class="string"><span class="delimiter">&quot;</span><span class="content">- </span><span class="inline"><span class="inline-delimiter">$</span>componentIdentifier</span><span class="content">.displayName (</span><span class="inline"><span class="inline-delimiter">$</span>componentResult</span><span class="content">.selectionReason)</span><span class="delimiter">&quot;</span></span>
                logger.quiet node
                traverseDependencies(level + <span class="integer">1</span>, componentResult.dependencies)
            } <span class="keyword">else</span> <span class="keyword">if</span> (result <span class="keyword">instanceof</span> UnresolvedDependencyResult) {
                ComponentSelector componentSelector = result.attempted
                <span class="predefined-type">String</span> node = calculateIndentation(level) + <span class="string"><span class="delimiter">&quot;</span><span class="content">- </span><span class="inline"><span class="inline-delimiter">$</span>componentSelector</span><span class="content">.displayName (failed)</span><span class="delimiter">&quot;</span></span>
                logger.quiet node
            }
        }
    }

    <span class="directive">private</span> <span class="predefined-type">String</span> calculateIndentation(<span class="type">int</span> level) {
        <span class="string"><span class="delimiter">'</span><span class="content">     </span><span class="delimiter">'</span></span> * level
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="accessing_a_modules_metadata_file"><a class="anchor" href="#accessing_a_modules_metadata_file"></a><a class="link" href="#accessing_a_modules_metadata_file">Accessing a modules metadata file</a></h4>
<div class="paragraph">
<p>As part of the dependency resolution process, Gradle downloads the metadata file of a module and stores it in the dependency cache. Some organizations enforce strong restrictions on accessing repositories outside of internal network. Instead of downloading artifacts, those organizations prefer to provide an "installable" Gradle cache with all artifacts contained in it to fulfill the build&#8217;s dependency requirements.</p>
</div>
<div class="paragraph">
<p>The artifact query API provides access to the raw files of a module. Currently, it allows getting a handle to the metadata file and some selected, additional artifacts (e.g. a JVM-based module&#8217;s source and Javadoc files). The main API entry point is <a href="../dsl/org.gradle.api.artifacts.query.ArtifactResolutionQuery.html">ArtifactResolutionQuery</a>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you wanted to post-process the metadata file of a Maven module. The group, name and version of the module component serve as input to the artifact resolution query. After executing the query, you get a handle to all components that match the criteria and their underlying files. Additionally, it&#8217;s very easy to post-process the metadata file. The example code uses Groovy&#8217;s <a href="http://docs.groovy-lang.org/latest/html/api/groovy/util/XmlSlurper.html">XmlSlurper</a> to ask for POM element values.</p>
</div>
<div class="sect4">
<h5 id="example_accessing_a_maven_modules_metadata_artifact"><a class="anchor" href="#example_accessing_a_maven_modules_metadata_artifact"></a><a class="link" href="#example_accessing_a_maven_modules_metadata_artifact">Example: Accessing a Maven module&#8217;s metadata artifact</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java-library</span><span class="delimiter">'</span></span>

repositories {
    mavenCentral()
}

dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">com.google.guava:guava:18.0</span><span class="delimiter">'</span></span>
}

task printGuavaMetadata {
    dependsOn configurations.compileClasspath

    doLast {
        ArtifactResolutionQuery query = dependencies.createArtifactResolutionQuery()
            .forModule(<span class="string"><span class="delimiter">'</span><span class="content">com.google.guava</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">guava</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">18.0</span><span class="delimiter">'</span></span>)
            .withArtifacts(MavenModule, MavenPomArtifact)
        ArtifactResolutionResult result = query.execute()

        <span class="keyword">for</span>(component <span class="keyword">in</span> result.resolvedComponents) {
            <span class="predefined-type">Set</span>&lt;ArtifactResult&gt; mavenPomArtifacts = component.getArtifacts(MavenPomArtifact)
            ArtifactResult guavaPomArtifact = mavenPomArtifacts.find { <span class="local-variable">it</span>.file.name == <span class="string"><span class="delimiter">'</span><span class="content">guava-18.0.pom</span><span class="delimiter">'</span></span> }
            <span class="keyword">def</span> xml = <span class="keyword">new</span> XmlSlurper().parse(guavaPomArtifact.file)
            println guavaPomArtifact.file
            println xml.name
            println xml.description
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="publishing_artifacts"><a class="anchor" href="#publishing_artifacts"></a><a class="link" href="#publishing_artifacts">Publishing Artifacts</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="publishing_overview"><a class="anchor" href="#publishing_overview"></a><a class="link" href="#publishing_overview">Publishing</a></h3>
<div class="paragraph">
<p>The vast majority of software projects build something that aims to be consumed in some way. It could be a library that other software projects use or it could be an application for end users. <em>Publishing</em> is the process by which the thing being built is made available to consumers.</p>
</div>
<div class="paragraph">
<p>In Gradle, that process looks like this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define <a href="#publishing_overview:what">what</a> to publish</p>
</li>
<li>
<p>Define <a href="#publishing_overview:where">where</a> to publish it to</p>
</li>
<li>
<p><a href="#publishing_overview:how">Do</a> the publishing</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Each of the these steps is dependent on the type of repository to which you want to publish artifacts. The two most common types are Maven-compatible and Ivy-compatible repositories, or Maven and Ivy repositories for short.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Looking for information on upload tasks and the <code>archives</code> configuration? See the <a href="#artifact_management">Legacy Publishing</a> chapter.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Gradle makes it easy to publish to these types of repository by providing some prepackaged infrastructure in the form of the <a href="#publishing_maven">Maven Publish Plugin</a> and the <a href="#publishing_ivy">Ivy Publish Plugin</a>. These plugins allow you to configure what to publish and perform the publishing with a minimum of effort.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/publishing-process.png" alt="publishing process">
</div>
<div class="title">Figure 23. The publishing process</div>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at those steps in more detail:</p>
</div>
<div id="publishing_overview:what" class="dlist">
<dl>
<dt class="hdlist1">What to publish</dt>
<dd>
<p>Gradle needs to know what files and information to publish so that consumers can use your project. This is typically a combination of <a href="#glossary:artifact">artifacts</a> and metadata that Gradle calls a <a href="#glossary:publication">publication</a>. Exactly what a publication contains depends on the type of repository it&#8217;s being published to.</p>
<div class="paragraph">
<p>For example, a publication destined for a Maven repository includes one or more artifacts  typically built by the project  plus a POM file describing the primary artifact and its dependencies. The primary artifact is typically the project&#8217;s production JAR and secondary artifacts might consist of "-sources" and "-javadoc" JARs.</p>
</div>
</dd>
</dl>
</div>
<div id="publishing_overview:where" class="dlist">
<dl>
<dt class="hdlist1">Where to publish</dt>
<dd>
<p>Gradle needs to know where to publish artifacts so that consumers can get hold of them. This is done via <a href="#sub:terminology_repository">repositories</a>, which store and make available all sorts of artifact. Gradle also needs to interact with the repository, which is why you must provide the type of the repository and its location.</p>
</dd>
</dl>
</div>
<div id="publishing_overview:how" class="dlist">
<dl>
<dt class="hdlist1">How to publish</dt>
<dd>
<p>Gradle automatically generates publishing tasks for all possible combinations of publication and repository, allowing you to publish any artifact to any repository. If you&#8217;re publishing to a Maven repository, the tasks are of type <a href="../dsl/org.gradle.api.publish.maven.tasks.PublishToMavenRepository.html">PublishToMavenRepository</a>, while for Ivy repositories the tasks are of type <a href="../dsl/org.gradle.api.publish.ivy.tasks.PublishToIvyRepository.html">PublishToIvyRepository</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>What follows is a practical example that demonstrates the entire publishing process.</p>
</div>
<div class="sect3">
<h4 id="sec:basic_publishing"><a class="anchor" href="#sec:basic_publishing"></a><a class="link" href="#sec:basic_publishing">Setting up basic publishing</a></h4>
<div class="paragraph">
<p>The first step in publishing, irrespective of your project type, is to apply the appropriate publishing plugin. As mentioned in the introduction, Gradle supports both Maven and Ivy repositories via the following plugins:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#publishing_maven">Maven Publish Plugin</a></p>
</li>
<li>
<p><a href="#publishing_ivy">Ivy Publish Plugin</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These provide the specific publication and repository classes needed to configure publishing for the corresponding repository type. Since Maven repositories are the most commonly used ones, they will be the basis for this example and for the other samples in the chapter. Don&#8217;t worry, we will explain how to adjust individual samples for Ivy repositories.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s assume we&#8217;re working with a simple Java library project, so only the following plugins are applied:</p>
</div>
<div class="sect4">
<h5 id="example_applying_the_necessary_plugins"><a class="anchor" href="#example_applying_the_necessary_plugins"></a><a class="link" href="#example_applying_the_necessary_plugins">Example: Applying the necessary plugins</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">java-library</span><span class="delimiter">'</span></span>
    id <span class="string"><span class="delimiter">'</span><span class="content">maven-publish</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the appropriate plugin has been applied, you can configure the publications and repositories. For this example, we want to publish the project&#8217;s production JAR file the one produced by the <code>jar</code> task  to a custom, Maven repository. We do that with the following <code>publishing {}</code> block, which is backed by <a href="../dsl/org.gradle.api.publish.PublishingExtension.html">PublishingExtension</a>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_a_java_library_for_publishing"><a class="anchor" href="#example_configuring_a_java_library_for_publishing"></a><a class="link" href="#example_configuring_a_java_library_for_publishing">Example: Configuring a Java library for publishing</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">group = <span class="string"><span class="delimiter">'</span><span class="content">org.example</span><span class="delimiter">'</span></span>
version = <span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>

publishing {
    publications {
        myLibrary(MavenPublication) {
            from components.java
        }
    }

    repositories {
        maven {
            name = <span class="string"><span class="delimiter">'</span><span class="content">myRepo</span><span class="delimiter">'</span></span>
            url = <span class="string"><span class="delimiter">&quot;</span><span class="content">file://</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/repo</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This defines a publication called "myLibrary" that can be published to a Maven repositoryby virtue of its type: <a href="../dsl/org.gradle.api.publish.maven.MavenPublication.html">MavenPublication</a>. This publication consists of just the production JAR artifact and its metadata, which combined are represented by the <code>java</code> <a href="#glossary:component">component</a> of the project.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Components are the standard way of defining a publication. They are provided by plugins, usually of the language or platform variety. For example, the Java Plugin defines the <code>components.java</code> <a href="../javadoc/org/gradle/api/component/SoftwareComponent.html">SoftwareComponent</a>, while the War Plugin defines <code>components.web</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The example also defines a file-based Maven repository with the name "myRepo". Such a file-based repository is convenient for a sample, but real-world builds typically work with HTTPS-based repository servers, such as Maven Central or an internal company server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You may define one, and only one, repository without a name. This translates to an implicit name of "Maven" for Maven repositories and "Ivy" for Ivy repositories. All other repository definitions must be given an explicit name.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In combination with the project&#8217;s <code>group</code> and <code>version</code>, the publication and repository definitions provide everything that Gradle needs to publish the project&#8217;s production JAR. Gradle will then create a dedicated <code>publishMyLibraryPublicationToMyRepoRepository</code> task that does just that. Its name is based on the template <code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code>. See the appropriate publishing plugin&#8217;s documentation for more details on the nature of this task and any other tasks that may be available to you.</p>
</div>
<div class="paragraph">
<p>You can either execute the individual publishing tasks directly, or you can execute <code>publish</code>, which will run all the available publishing tasks. In this example, <code>publish</code> will just run <code>publishMyLibraryPublicationToMavenRepository</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Basic publishing to an Ivy repository is very similar: you simply use the Ivy Publish Plugin, replace  <code>MavenPublication</code> with <a href="../dsl/org.gradle.api.publish.ivy.IvyPublication.html">IvyPublication</a>, and use <code>ivy</code> instead of <code>maven</code> in the repository definition.</p>
</div>
<div class="paragraph">
<p>There are differences between the two types of repository, particularly around the extra metadata that each support for example, Maven repositories require a POM file while Ivy ones have their own metadata format  so see the plugin chapters for comprehensive information on how to configure both publications and repositories for whichever repository type you&#8217;re working with.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That&#8217;s everything for the basic use case. However, many projects need more control over what gets published, so we look at several common scenarios in the following sections.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:publishing_custom_artifacts_to_maven"><a class="anchor" href="#sec:publishing_custom_artifacts_to_maven"></a><a class="link" href="#sec:publishing_custom_artifacts_to_maven">Adding custom artifacts to a publication</a></h4>
<div class="paragraph">
<p>Users often need to include additional artifacts with a publication, one of the most common examples being that of "-sources" and "-javadoc" JARs for JVM libraries. This is easy to do for both Maven- and Ivy-compatible repositories via the <code>artifact</code> configuration.</p>
</div>
<div class="paragraph">
<p>The following sample configures "-sources" and "-javadoc" JARs for a Java project and attaches them to the main (Maven) publication, i.e. the production JAR:</p>
</div>
<div class="sect4">
<h5 id="example_adding_an_additional_archive_artifact_to_a_mavenpublication"><a class="anchor" href="#example_adding_an_additional_archive_artifact_to_a_mavenpublication"></a><a class="link" href="#example_adding_an_additional_archive_artifact_to_a_mavenpublication">Example: Adding an additional archive artifact to a MavenPublication</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task sourcesJar(<span class="key">type</span>: Jar) {
    classifier = <span class="string"><span class="delimiter">'</span><span class="content">sources</span><span class="delimiter">'</span></span>
    from sourceSets.main.allJava
}

task javadocJar(<span class="key">type</span>: Jar) {
    classifier = <span class="string"><span class="delimiter">'</span><span class="content">javadoc</span><span class="delimiter">'</span></span>
    from javadoc.destinationDir
}

publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java

            artifact sourcesJar
            artifact javadocJar
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are several important things to note about the sample:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>artifact()</code> method accepts archive tasks as an argument  like <code>sourcesJar</code> in the sample  as well as any type of argument accepted by <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a>, such as a <code>File</code> instance or string file path.</p>
</li>
<li>
<p>Publishing plugins support different artifact configuration properties, so always check the plugin documentation for more details. The <code>classifier</code> and <code>extension</code> properties are supported by both the <a href="#publishing_maven">Maven Publish Plugin</a> and the <a href="#publishing_ivy">Ivy Publish Plugin</a>.</p>
</li>
<li>
<p>Custom artifacts need to be distinct within a publication, typically via a unique combination of <code>classifier</code> and <code>extension</code>. See the documentation for the plugin you&#8217;re using for the precise requirements.</p>
</li>
<li>
<p>If you use <code>artifact()</code> with an archive task, Gradle automatically populates the artifact&#8217;s metadata with the <code>classifier</code> and <code>extension</code> properties from that task. That&#8217;s why the above sample does not specify those properties in the artifact configurations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you&#8217;re attaching extra artifacts to a publication, remember that they are <em>secondary</em> artifacts that support a <em>primary</em> artifact. The metadata that a publication defines such as dependency information is associated with that primary artifact only. Thinking about publications in this way should help you determine whether you should be adding custom artifacts to an existing publication, or defining a new publication.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:publishing_custom_primary_artifact"><a class="anchor" href="#sec:publishing_custom_primary_artifact"></a><a class="link" href="#sec:publishing_custom_primary_artifact">Publishing a custom primary artifact (no component)</a></h4>
<div class="paragraph">
<p>If your build produces a primary artifact that isn&#8217;t supported by a predefined component, then you will need to configure a custom artifact. This isn&#8217;t much different to adding a custom artifact to an existing publication. There are just a couple of extra considerations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You may want to make the artifact available to other projects in the build</p>
</li>
<li>
<p>You will need to manually construct the necessary metadata for publishing</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Inter-project dependencies have nothing to do with publishing, but both features typically apply to the same set of artifacts in a Gradle project. So how do you tie them together?</p>
</div>
<div class="paragraph">
<p>You start by defining a custom artifact and attaching it to a Gradle <a href="#glossary:configuration">configuration</a> of your choice. The following sample defines an RPM artifact that is produced by an <code>rpm</code> task (not shown) and attaches that artifact to the <code>archives</code> configuration:</p>
</div>
<div class="sect4">
<h5 id="example_defining_a_custom_artifact_for_a_configuration"><a class="anchor" href="#example_defining_a_custom_artifact_for_a_configuration"></a><a class="link" href="#example_defining_a_custom_artifact_for_a_configuration">Example: Defining a custom artifact for a configuration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> rpmFile = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/rpms/my-package.rpm</span><span class="delimiter">&quot;</span></span>)
<span class="keyword">def</span> rpmArtifact = artifacts.add(<span class="string"><span class="delimiter">'</span><span class="content">archives</span><span class="delimiter">'</span></span>, rpmFile) {
    type <span class="string"><span class="delimiter">'</span><span class="content">rpm</span><span class="delimiter">'</span></span>
    builtBy <span class="string"><span class="delimiter">'</span><span class="content">rpm</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>artifacts.add()</code> method from <a href="../dsl/org.gradle.api.artifacts.dsl.ArtifactHandler.html">ArtifactHandler</a>  returns an artifact object of type <a href="../javadoc/org/gradle/api/artifacts/PublishArtifact.html">PublishArtifact</a> that can then be used in defining a publication, as shown in the following sample:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_attaching_a_custom_publishartifact_to_a_publication"><a class="anchor" href="#example_attaching_a_custom_publishartifact_to_a_publication"></a><a class="link" href="#example_attaching_a_custom_publishartifact_to_a_publication">Example: Attaching a custom PublishArtifact to a publication</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">publishing {
    publications {
        maven(MavenPublication) {
            artifact rpmArtifact
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can publish the RPM as well as depend on it from another project using the <code>project(path: ':my-project', configuration: 'archives')</code> syntax.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There is currently no easy way to define dependency information for a custom artifact.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>groupId</code> and <code>artifactId</code> properties are specific to Maven publications. See <a href="../dsl/org.gradle.api.publish.ivy.IvyPublication.html">IvyPublication</a> for the relevant Ivy properties.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:signing"><a class="anchor" href="#publishing_maven:signing"></a><a class="link" href="#publishing_maven:signing">Signing artifacts</a></h4>
<div class="paragraph">
<p>The <a href="#signing_plugin">Signing Plugin</a> can be used to sign all artifacts and metadata files that make up a publication, including Maven POM files and Ivy module desciptors. In order to use it:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Apply the Signing Plugin</p>
</li>
<li>
<p>Configure the <a href="#sec:signatory_credentials">signatory credentials</a>  follow the link to see how</p>
</li>
<li>
<p>Specify the publications you want signed</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Here&#8217;s an example that configures the plugin to sign the <code>mavenJava</code> publication:</p>
</div>
<div class="sect4">
<h5 id="example_signing_a_publication"><a class="anchor" href="#example_signing_a_publication"></a><a class="link" href="#example_signing_a_publication">Example: Signing a publication</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">signing {
    sign publishing.publications.mavenJava
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create a <code>Sign</code> task for each publication you specify and wire all <code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code> tasks to depend on it. Thus, publishing any publication will automatically create and publish the signatures for its artifacts and metadata, as you can see from this output:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_sign_and_publish_a_project"><a class="anchor" href="#example_sign_and_publish_a_project"></a><a class="link" href="#example_sign_and_publish_a_project">Example: Sign and publish a project</a></h5>
<div class="listingblock">
<div class="title">Output of <code>gradle publish</code></div>
<div class="content">
<pre>&gt; gradle publish
&gt; Task :generatePomFileForMavenJavaPublication
&gt; Task :compileJava
&gt; Task :processResources
&gt; Task :classes
&gt; Task :jar
&gt; Task :javadoc
&gt; Task :javadocJar
&gt; Task :sourcesJar
&gt; Task :signMavenJavaPublication
&gt; Task :publishMavenJavaPublicationToMavenRepository
&gt; Task :publish

BUILD SUCCESSFUL in 0s
9 actionable tasks: 9 executed</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:conditional_publishing"><a class="anchor" href="#publishing_maven:conditional_publishing"></a><a class="link" href="#publishing_maven:conditional_publishing">Restricting publications to specific repositories</a></h4>
<div class="paragraph">
<p>When you have defined multiple publications or repositories, you often want to control which publications are published to which repositories. For instance, consider the following sample that defines two publications one that consists of just a binary and another that contains the binary and associated sources and two repositories  one for internal use and one for external consumers:</p>
</div>
<div class="sect4">
<h5 id="example_adding_multiple_publications_and_repositories"><a class="anchor" href="#example_adding_multiple_publications_and_repositories"></a><a class="link" href="#example_adding_multiple_publications_and_repositories">Example: Adding multiple publications and repositories</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">publishing {
    publications {
        binary(MavenPublication) {
            from components.java
        }
        binaryAndSources(MavenPublication) {
            from components.java
            artifact sourcesJar
        }
    }
    repositories {
        <span class="comment">// change URLs to point to your repos, e.g. http://my.org/repo</span>
        maven {
            name = <span class="string"><span class="delimiter">'</span><span class="content">external</span><span class="delimiter">'</span></span>
            url = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/repos/external</span><span class="delimiter">&quot;</span></span>
        }
        maven {
            name = <span class="string"><span class="delimiter">'</span><span class="content">internal</span><span class="delimiter">'</span></span>
            url = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/repos/internal</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The publishing plugins will create tasks that allow you to publish either of the publications to either repository. They also attach those tasks to the <code>publish</code> aggregate task. But let&#8217;s say you want to restrict the binary-only publication to the external repository and the binary-with-sources publication to the internal one. To do that, you need to make the publishing <em>conditional</em>.</p>
</div>
<div class="paragraph">
<p>Gradle allows you to skip any task you want based on a condition via the <a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:onlyIf(org.gradle.api.specs.Spec)">Task.onlyIf(org.gradle.api.specs.Spec)</a> method. The following sample demonstrates how to implement the constraints we just mentioned:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_which_artifacts_should_be_published_to_which_repositories"><a class="anchor" href="#example_configuring_which_artifacts_should_be_published_to_which_repositories"></a><a class="link" href="#example_configuring_which_artifacts_should_be_published_to_which_repositories">Example: Configuring which artifacts should be published to which repositories</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.withType(PublishToMavenRepository) {
    onlyIf {
        (repository == publishing.repositories.external &amp;&amp;
            publication == publishing.publications.binary) ||
        (repository == publishing.repositories.internal &amp;&amp;
            publication == publishing.publications.binaryAndSources)
    }
}
tasks.withType(PublishToMavenLocal) {
    onlyIf {
        publication == publishing.publications.binaryAndSources
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle publish</code></div>
<div class="content">
<pre>&gt; gradle publish
&gt; Task :generatePomFileForBinaryAndSourcesPublication
&gt; Task :compileJava
&gt; Task :processResources
&gt; Task :classes
&gt; Task :jar
&gt; Task :sourcesJar
&gt; Task :publishBinaryAndSourcesPublicationToExternalRepository SKIPPED
&gt; Task :publishBinaryAndSourcesPublicationToInternalRepository
&gt; Task :generatePomFileForBinaryPublication
&gt; Task :publishBinaryPublicationToExternalRepository
&gt; Task :publishBinaryPublicationToInternalRepository SKIPPED
&gt; Task :publish

BUILD SUCCESSFUL in 0s
8 actionable tasks: 8 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You may also want to define your own aggregate tasks to help with your workflow. For example, imagine that you have several publications that should be published to the external repository. It could be very useful to publish all of them in one go without publishing the internal ones.</p>
</div>
<div class="paragraph">
<p>The following sample demonstrates how you can do this by defining an aggregate task <code>publishToExternalRepository</code> that depends on all the relevant publish tasks:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_your_own_shorthand_tasks_for_publishing"><a class="anchor" href="#example_defining_your_own_shorthand_tasks_for_publishing"></a><a class="link" href="#example_defining_your_own_shorthand_tasks_for_publishing">Example: Defining your own shorthand tasks for publishing</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task publishToExternalRepository {
    group = <span class="string"><span class="delimiter">'</span><span class="content">publishing</span><span class="delimiter">'</span></span>
    description = <span class="string"><span class="delimiter">'</span><span class="content">Publishes all Maven publications to the external Maven repository.</span><span class="delimiter">'</span></span>
    dependsOn tasks.withType(PublishToMavenRepository).matching {
        <span class="local-variable">it</span>.repository == publishing.repositories.external
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This particular sample automatically handles the introduction or removal of the relevant publishing tasks by using <a href="../javadoc/org/gradle/api/tasks/TaskCollection.html#withType-java.lang.Class-">TaskCollection.withType(java.lang.Class)</a> with the <a href="../dsl/org.gradle.api.publish.maven.tasks.PublishToMavenRepository.html">PublishToMavenRepository</a> task type. You can do the same with <a href="../dsl/org.gradle.api.publish.ivy.tasks.PublishToIvyRepository.html">PublishToIvyRepository</a> if you&#8217;re publishing to Ivy-compatible repositories.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring_publishing_tasks"><a class="anchor" href="#sec:configuring_publishing_tasks"></a><a class="link" href="#sec:configuring_publishing_tasks">Configuring publishing tasks</a></h4>
<div class="paragraph">
<p>The publishing plugins create their non-aggregate tasks after the project has been evaluated, which means you cannot directly reference them from your build script. If you would like to configure any of these tasks, you should use deferred task configuration. This can be done in a number of ways via the project&#8217;s <code>tasks</code> collection.</p>
</div>
<div class="paragraph">
<p>For example, imagine you want to change where the <code>generatePomFileFor<em>PubName</em>Publication</code> tasks write their POM files. You can do this by using the <a href="../javadoc/org/gradle/api/tasks/TaskCollection.html#withType-java.lang.Class-">TaskCollection.withType(java.lang.Class)</a> method, as demonstrated by this sample:</p>
</div>
<div class="sect4">
<h5 id="example_configuring_a_dynamically_named_task_created_by_the_publishing_plugins"><a class="anchor" href="#example_configuring_a_dynamically_named_task_created_by_the_publishing_plugins"></a><a class="link" href="#example_configuring_a_dynamically_named_task_created_by_the_publishing_plugins">Example: Configuring a dynamically named task created by the publishing plugins</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.withType(GenerateMavenPom).all {
    <span class="keyword">def</span> matcher = name =~ <span class="regexp"><span class="delimiter">/</span><span class="content">generatePomFileFor(</span><span class="char">\w</span><span class="content">+)Publication</span><span class="delimiter">/</span></span>
    <span class="keyword">def</span> publicationName = matcher[<span class="integer">0</span>][<span class="integer">1</span>]
    destination = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/poms/</span><span class="inline"><span class="inline-delimiter">${</span>publicationName<span class="inline-delimiter">}</span></span><span class="content">-pom.xml</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above sample uses a regular expression to extract the name of the publication from the name of the task. This is so that there is no conflict between the file paths of all the POM files that might be generated. If you only have one publication, then you don&#8217;t have to worry about such conflicts since there will only be one POM file.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="terminology"><a class="anchor" href="#terminology"></a><a class="link" href="#terminology">Terminology</a></h4>
<div id="glossary:artifact" class="dlist">
<dl>
<dt class="hdlist1">Artifact</dt>
<dd>
<p>A file or directory produced by a build, such as a JAR, a ZIP distribution, or a native executable.</p>
<div class="paragraph">
<p>Artifacts are typically designed to be used or consumed by users or other projects, or deployed to hosting systems. In such cases, the artifact is a single file. Directories are common in the case of inter-project dependencies to avoid the cost of producing the publishable artifact.</p>
</div>
</dd>
</dl>
</div>
<div id="glossary:component" class="dlist">
<dl>
<dt class="hdlist1">Component</dt>
<dd>
<p>Any single version of a <a href="#sub:terminology_module">module</a>.</p>
<div class="paragraph">
<p>Components are defined by plugins and provide a simple way to define a publication for publishing. They comprise one or more <a href="#glossary:artifact">artifacts</a> as well as the appropriate metadata. For example, the <code>java</code> component consists of the production JAR produced by the <code>jar</code> task and its dependency information.</p>
</div>
</dd>
</dl>
</div>
<div id="glossary:configuration" class="dlist">
<dl>
<dt class="hdlist1">Configuration</dt>
<dd>
<p>A named collection of <a href="#sub:terminology_configuration">dependencies</a> or <a href="#glossary:artifact">artifacts</a>.</p>
<div class="paragraph">
<p>Gradle&#8217;s configurations can be somewhat confusing because they apply to both dependencies and artifacts. The main difference is that dependencies are consumed by the project, while artifacts are produced by it. Even then, the artifacts produced by a project are often consumed as dependencies by other projects.</p>
</div>
<div class="paragraph">
<p>Configurations allow different aspects of the build to work with known subsets of a project&#8217;s dependencies or artifacts, e.g. the dependencies required for compilation, or the artifacts related to a project&#8217;s API.</p>
</div>
</dd>
</dl>
</div>
<div id="glossary:publication" class="dlist">
<dl>
<dt class="hdlist1">Publication</dt>
<dd>
<p>A description of the files and metadata that should be published to a repository as a single entity for use by consumers.</p>
<div class="paragraph">
<p>A publication has a name and consists of one or more artifacts plus information about those artifacts. The nature of that information depends on what type of repository you publish the publication to. In the case of Maven, the information takes the form of a POM.</p>
</div>
<div class="paragraph">
<p>One thing to bear in mind is that Maven repositories only allow a single <em>primary</em> artifact, i.e. one with metadata, but they do allow <em>secondary</em> artifacts such as packages of the associated source files and documentation ("-sources" and "-javadoc" JARs in the Java world).</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="publishing_maven"><a class="anchor" href="#publishing_maven"></a><a class="link" href="#publishing_maven">Maven Publish Plugin</a></h3>
<div class="paragraph">
<p>The Maven Publish Plugin provides the ability to publish build artifacts to an <a href="http://maven.apache.org/">Apache Maven</a> repository. A module published to a Maven repository can be consumed by Maven, Gradle (see <a href="#declaring_dependencies">Declaring Dependencies</a>) and other tools that understand the Maven repository format. You can learn about the fundamentals of publishing in <a href="#publishing_overview">Publishing Overview</a>.</p>
</div>
<div class="sect3">
<h4 id="publishing_maven:usage"><a class="anchor" href="#publishing_maven:usage"></a><a class="link" href="#publishing_maven:usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Maven Publish Plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_applying_the_maven_publish_plugin"><a class="anchor" href="#example_applying_the_maven_publish_plugin"></a><a class="link" href="#example_applying_the_maven_publish_plugin">Example: Applying the Maven Publish Plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">maven-publish</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Maven Publish Plugin uses an extension on the project named <code>publishing</code> of type <a href="../dsl/org.gradle.api.publish.PublishingExtension.html">PublishingExtension</a>. This extension provides a container of named publications and a container of named repositories. The Maven Publish Plugin works with <a href="../dsl/org.gradle.api.publish.maven.MavenPublication.html">MavenPublication</a> publications and <a href="../dsl/org.gradle.api.artifacts.repositories.MavenArtifactRepository.html">MavenArtifactRepository</a> repositories.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:tasks"><a class="anchor" href="#publishing_maven:tasks"></a><a class="link" href="#publishing_maven:tasks">Tasks</a></h4>
<div id="publishing_maven:generate-pom" class="dlist">
<dl>
<dt class="hdlist1"><code>generatePomFileFor<em>PubName</em>Publication</code>  <a href="../dsl/org.gradle.api.publish.maven.tasks.GenerateMavenPom.html">GenerateMavenPom</a></dt>
<dd>
<p>Creates a POM file for the publication named <em>PubName</em>, populating the known metadata such as project name, project version, and the dependencies. The default location for the POM file is <em>build/publications/$pubName/pom-default.xml</em>.</p>
</dd>
<dt class="hdlist1"><code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code>  <a href="../dsl/org.gradle.api.publish.maven.tasks.PublishToMavenRepository.html">PublishToMavenRepository</a></dt>
<dd>
<p>Publishes the <em>PubName</em> publication to the repository named <em>RepoName</em>. If you have a repository definition without an explicit name, <em>RepoName</em> will be "Maven".</p>
</dd>
<dt class="hdlist1"><code>publish<em>PubName</em>PublicationToMavenLocal</code>  <a href="../javadoc/org/gradle/api/publish/maven/tasks/PublishToMavenLocal.html">PublishToMavenLocal</a></dt>
<dd>
<p>Copies the <em>PubName</em> publication to the local Maven cache typically <em>$USER_HOME/.m2/repository</em> along with the publication&#8217;s POM file and other metadata.</p>
</dd>
<dt class="hdlist1"><code>publish</code></dt>
<dd>
<p><em>Depends on</em>: All <code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code> tasks</p>
<div class="paragraph">
<p>An aggregate task that publishes all defined publications to all defined repositories. It does <em>not</em> include copying publications to the local Maven cache.</p>
</div>
</dd>
<dt class="hdlist1"><code>publishToMavenLocal</code></dt>
<dd>
<p><em>Depends on</em>: All <code>publish<em>PubName</em>PublicationToMavenLocal</code> tasks</p>
<div class="paragraph">
<p>Copies all defined publications to the local Maven cache, including their metadata (POM files, etc.).</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:publications"><a class="anchor" href="#publishing_maven:publications"></a><a class="link" href="#publishing_maven:publications">Publications</a></h4>
<div class="paragraph">
<p>This plugin provides <a href="#glossary:publication">publications</a> of type <a href="../dsl/org.gradle.api.publish.maven.MavenPublication.html">MavenPublication</a>. To learn how to define and use publications, see the section on <a href="#sec:basic_publishing">basic publishing</a>.</p>
</div>
<div class="paragraph">
<p>There are four main things you can configure in a Maven publication:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <a href="#glossary:component">component</a> via <a href="../dsl/org.gradle.api.publish.maven.MavenPublication.html#org.gradle.api.publish.maven.MavenPublication:from(org.gradle.api.component.SoftwareComponent)">MavenPublication.from(org.gradle.api.component.SoftwareComponent)</a>.</p>
</li>
<li>
<p><a href="#sec:publishing_custom_artifacts_to_maven">Custom artifacts</a> via the <a href="../dsl/org.gradle.api.publish.maven.MavenPublication.html#org.gradle.api.publish.maven.MavenPublication:artifact(java.lang.Object)">MavenPublication.artifact(java.lang.Object)</a> method. See <a href="../dsl/org.gradle.api.publish.maven.MavenArtifact.html">MavenArtifact</a> for the available configuration options for custom Maven artifacts.</p>
</li>
<li>
<p>Standard metadata like <code>artifactId</code>, <code>groupId</code> and <code>version</code>.</p>
</li>
<li>
<p>Other contents of the POM file via <a href="../dsl/org.gradle.api.publish.maven.MavenPublication.html#org.gradle.api.publish.maven.MavenPublication:pom(org.gradle.api.Action)">MavenPublication.pom(org.gradle.api.Action)</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can see all of these in action in the <a href="#publishing_maven:complete_example">complete publishing example</a>. The API documentation for <code>MavenPublication</code> has additional code samples.</p>
</div>
<div class="sect4">
<h5 id="sec:identity_values_in_the_generated_pom"><a class="anchor" href="#sec:identity_values_in_the_generated_pom"></a><a class="link" href="#sec:identity_values_in_the_generated_pom">Identity values in the generated POM</a></h5>
<div class="paragraph">
<p>The attributes of the generated POM file will contain identity values derived from the following project properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>groupId</code> - <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:group">Project.getGroup()</a></p>
</li>
<li>
<p><code>artifactId</code> - <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:name">Project.getName()</a></p>
</li>
<li>
<p><code>version</code> - <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:version">Project.getVersion()</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Overriding the default identity values is easy: simply specify the <code>groupId</code>, <code>artifactId</code> or <code>version</code> attributes when configuring the <a href="../dsl/org.gradle.api.publish.maven.MavenPublication.html">MavenPublication</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_customizing_the_publication_identity"><a class="anchor" href="#example_customizing_the_publication_identity"></a><a class="link" href="#example_customizing_the_publication_identity">Example: customizing the publication identity</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">publishing {
    publications {
        maven(MavenPublication) {
            groupId = <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample</span><span class="delimiter">'</span></span>
            artifactId = <span class="string"><span class="delimiter">'</span><span class="content">project1-sample</span><span class="delimiter">'</span></span>
            version = <span class="string"><span class="delimiter">'</span><span class="content">1.1</span><span class="delimiter">'</span></span>

            from components.java
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Certain repositories will not be able to handle all supported characters. For example, the <code>:</code> character cannot be used as an identifier when publishing to a filesystem-backed repository on Windows.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Maven restricts <code>groupId</code> and <code>artifactId</code> to a limited character set (<code>[A-Za-z0-9_\\-.]+</code>) and Gradle enforces this restriction. For <code>version</code> (as well as the artifact <code>extension</code> and <code>classifier</code> properties), Gradle will handle any valid Unicode character.</p>
</div>
<div class="paragraph">
<p>The only Unicode values that are explicitly prohibited are <code>\</code>, <code>/</code> and any ISO control character. Supplied values are validated early in publication.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:modifying_the_generated_pom"><a class="anchor" href="#sec:modifying_the_generated_pom"></a><a class="link" href="#sec:modifying_the_generated_pom">Customizing the generated POM</a></h5>
<div class="paragraph">
<p>The generated POM file can be customized before publishing. For example, when publishing a library to Maven Central you will need to set certain metadata. The Maven Publish Plugin provides a DSL for that purpose. Please see <a href="../dsl/org.gradle.api.publish.maven.MavenPom.html">MavenPom</a> in the DSL Reference for the complete documentation of available properties and methods. The following sample shows how to use the most common ones:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_customizing_the_pom_file"><a class="anchor" href="#example_customizing_the_pom_file"></a><a class="link" href="#example_customizing_the_pom_file">Example: Customizing the POM file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">publishing {
    publications {
        mavenJava(MavenPublication) {
            pom {
                name = <span class="string"><span class="delimiter">'</span><span class="content">My Library</span><span class="delimiter">'</span></span>
                description = <span class="string"><span class="delimiter">'</span><span class="content">A concise description of my library</span><span class="delimiter">'</span></span>
                url = <span class="string"><span class="delimiter">'</span><span class="content">http://www.example.com/library</span><span class="delimiter">'</span></span>
                licenses {
                    license {
                        name = <span class="string"><span class="delimiter">'</span><span class="content">The Apache License, Version 2.0</span><span class="delimiter">'</span></span>
                        url = <span class="string"><span class="delimiter">'</span><span class="content">http://www.apache.org/licenses/LICENSE-2.0.txt</span><span class="delimiter">'</span></span>
                    }
                }
                developers {
                    developer {
                        id = <span class="string"><span class="delimiter">'</span><span class="content">johnd</span><span class="delimiter">'</span></span>
                        name = <span class="string"><span class="delimiter">'</span><span class="content">John Doe</span><span class="delimiter">'</span></span>
                        email = <span class="string"><span class="delimiter">'</span><span class="content">john.doe@example.com</span><span class="delimiter">'</span></span>
                    }
                }
                scm {
                    connection = <span class="string"><span class="delimiter">'</span><span class="content">scm:git:git://example.com/my-library.git</span><span class="delimiter">'</span></span>
                    developerConnection = <span class="string"><span class="delimiter">'</span><span class="content">scm:git:ssh://example.com/my-library.git</span><span class="delimiter">'</span></span>
                    url = <span class="string"><span class="delimiter">'</span><span class="content">http://example.com/my-library/</span><span class="delimiter">'</span></span>
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:repositories"><a class="anchor" href="#publishing_maven:repositories"></a><a class="link" href="#publishing_maven:repositories">Repositories</a></h4>
<div class="paragraph">
<p>This plugin provides <a href="#sub:terminology_repository">repositories</a> of type <a href="../dslorg.gradle.api.artifacts.repositories.MavenArtifactRepository.html">MavenArtifactRepository</a>. To learn how to define and use repositories for publishing, see the section on <a href="#sec:basic_publishing">basic publishing</a>.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a simple example of defining a publishing repository:</p>
</div>
<div class="sect4">
<h5 id="example_declaring_repositories_to_publish_to"><a class="anchor" href="#example_declaring_repositories_to_publish_to"></a><a class="link" href="#example_declaring_repositories_to_publish_to">Example: Declaring repositories to publish to</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">publishing {
    repositories {
        maven {
            <span class="comment">// change to point to your repo, e.g. http://my.org/repo</span>
            url = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/repo</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The two main things you will want to configure are the repository&#8217;s:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>URL (required)</p>
</li>
<li>
<p>Name (optional)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can define multiple repositories as long as they have unique names within the build script. You may also declare one (and only one) repository without a name. That repository will take on an implicit name of "Maven".</p>
</div>
<div class="paragraph">
<p>You can also configure any authentication details that are required to connect to the repository. See <a href="../dslorg.gradle.api.artifacts.repositories.MavenArtifactRepository.html">MavenArtifactRepository</a> for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="publishing_maven:snapshot_and_release_repositories"><a class="anchor" href="#publishing_maven:snapshot_and_release_repositories"></a><a class="link" href="#publishing_maven:snapshot_and_release_repositories">Snapshot and release repositories</a></h5>
<div class="paragraph">
<p>It is a common practice to publish snapshots and releases to different Maven repositories. A simple way to accomplish this is to configure the repository URL based on the project version. The following sample uses one URL for versions that end with "SNAPSHOT" and a different URL for the rest:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_repository_url_based_on_project_version"><a class="anchor" href="#example_configuring_repository_url_based_on_project_version"></a><a class="link" href="#example_configuring_repository_url_based_on_project_version">Example: Configuring repository URL based on project version</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">publishing {
    repositories {
        maven {
            <span class="keyword">def</span> releasesRepoUrl = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/repos/releases</span><span class="delimiter">&quot;</span></span>
            <span class="keyword">def</span> snapshotsRepoUrl = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/repos/snapshots</span><span class="delimiter">&quot;</span></span>
            url = version.endsWith(<span class="string"><span class="delimiter">'</span><span class="content">SNAPSHOT</span><span class="delimiter">'</span></span>) ? snapshotsRepoUrl : releasesRepoUrl
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, you can use a <a href="#build_environment">project or system property</a> to decide which repository to publish to. The following example uses the release repository if the project property <code>release</code> is set, such as when a user runs <code>gradle -Prelease publish</code>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_repository_url_based_on_project_property"><a class="anchor" href="#example_configuring_repository_url_based_on_project_property"></a><a class="link" href="#example_configuring_repository_url_based_on_project_property">Example: Configuring repository URL based on project property</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">publishing {
    repositories {
        maven {
            <span class="keyword">def</span> releasesRepoUrl = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/repos/releases</span><span class="delimiter">&quot;</span></span>
            <span class="keyword">def</span> snapshotsRepoUrl = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/repos/snapshots</span><span class="delimiter">&quot;</span></span>
            url = project.hasProperty(<span class="string"><span class="delimiter">'</span><span class="content">release</span><span class="delimiter">'</span></span>) ? releasesRepoUrl : snapshotsRepoUrl
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:install"><a class="anchor" href="#publishing_maven:install"></a><a class="link" href="#publishing_maven:install">Publishing to Maven Local</a></h4>
<div class="paragraph">
<p>For integration with a local Maven installation, it is sometimes useful to publish the module into the Maven local repository (typically at <em>$USER_HOME/.m2/repository</em>), along with its POM file and other metadata. In Maven parlance, this is referred to as 'installing' the module.</p>
</div>
<div class="paragraph">
<p>The Maven Publish Plugin makes this easy to do by automatically creating a <a href="../javadoc/org/gradle/api/publish/maven/tasks/PublishToMavenLocal.html">PublishToMavenLocal</a> task for each <a href="../dsl/org.gradle.api.publish.maven.MavenPublication.html">MavenPublication</a> in the <code>publishing.publications</code> container. The task name follows the pattern of <code>publish<em>PubName</em>PublicationToMavenLocal</code>. Each of these tasks is wired into the <code>publishToMavenLocal</code> aggregate task. You do not need to have <code>mavenLocal()</code> in your <code>publishing.repositories</code> section.</p>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:complete_example"><a class="anchor" href="#publishing_maven:complete_example"></a><a class="link" href="#publishing_maven:complete_example">Complete example</a></h4>
<div class="paragraph">
<p>The following example demonstrates how to sign and publish a Java library including sources, Javadoc, and a customized POM:</p>
</div>
<div class="sect4">
<h5 id="example_publishing_a_java_library"><a class="anchor" href="#example_publishing_a_java_library"></a><a class="link" href="#example_publishing_a_java_library">Example: Publishing a Java library</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">java-library</span><span class="delimiter">'</span></span>
    id <span class="string"><span class="delimiter">'</span><span class="content">maven-publish</span><span class="delimiter">'</span></span>
    id <span class="string"><span class="delimiter">'</span><span class="content">signing</span><span class="delimiter">'</span></span>
}

group = <span class="string"><span class="delimiter">'</span><span class="content">com.example</span><span class="delimiter">'</span></span>
version = <span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>

task sourcesJar(<span class="key">type</span>: Jar) {
    from sourceSets.main.allJava
    classifier = <span class="string"><span class="delimiter">'</span><span class="content">sources</span><span class="delimiter">'</span></span>
}

task javadocJar(<span class="key">type</span>: Jar) {
    from javadoc
    classifier = <span class="string"><span class="delimiter">'</span><span class="content">javadoc</span><span class="delimiter">'</span></span>
}

publishing {
    publications {
        mavenJava(MavenPublication) {
            artifactId = <span class="string"><span class="delimiter">'</span><span class="content">my-library</span><span class="delimiter">'</span></span>
            from components.java
            artifact sourcesJar
            artifact javadocJar
            pom {
                name = <span class="string"><span class="delimiter">'</span><span class="content">My Library</span><span class="delimiter">'</span></span>
                description = <span class="string"><span class="delimiter">'</span><span class="content">A concise description of my library</span><span class="delimiter">'</span></span>
                url = <span class="string"><span class="delimiter">'</span><span class="content">http://www.example.com/library</span><span class="delimiter">'</span></span>
                licenses {
                    license {
                        name = <span class="string"><span class="delimiter">'</span><span class="content">The Apache License, Version 2.0</span><span class="delimiter">'</span></span>
                        url = <span class="string"><span class="delimiter">'</span><span class="content">http://www.apache.org/licenses/LICENSE-2.0.txt</span><span class="delimiter">'</span></span>
                    }
                }
                developers {
                    developer {
                        id = <span class="string"><span class="delimiter">'</span><span class="content">johnd</span><span class="delimiter">'</span></span>
                        name = <span class="string"><span class="delimiter">'</span><span class="content">John Doe</span><span class="delimiter">'</span></span>
                        email = <span class="string"><span class="delimiter">'</span><span class="content">john.doe@example.com</span><span class="delimiter">'</span></span>
                    }
                }
                scm {
                    connection = <span class="string"><span class="delimiter">'</span><span class="content">scm:git:git://example.com/my-library.git</span><span class="delimiter">'</span></span>
                    developerConnection = <span class="string"><span class="delimiter">'</span><span class="content">scm:git:ssh://example.com/my-library.git</span><span class="delimiter">'</span></span>
                    url = <span class="string"><span class="delimiter">'</span><span class="content">http://example.com/my-library/</span><span class="delimiter">'</span></span>
                }
            }
        }
    }
    repositories {
        maven {
            <span class="comment">// change URLs to point to your repos, e.g. http://my.org/repo</span>
            <span class="keyword">def</span> releasesRepoUrl = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/repos/releases</span><span class="delimiter">&quot;</span></span>
            <span class="keyword">def</span> snapshotsRepoUrl = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/repos/snapshots</span><span class="delimiter">&quot;</span></span>
            url = version.endsWith(<span class="string"><span class="delimiter">'</span><span class="content">SNAPSHOT</span><span class="delimiter">'</span></span>) ? snapshotsRepoUrl : releasesRepoUrl
        }
    }
}

signing {
    sign publishing.publications.mavenJava
}


javadoc {
    <span class="keyword">if</span>(JavaVersion.current().isJava9Compatible()) {
        options.addBooleanOption(<span class="string"><span class="delimiter">'</span><span class="content">html4</span><span class="delimiter">'</span></span>, <span class="predefined-constant">true</span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result is that the following artifacts will be published:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The POM: <code>my-library-1.0.pom</code></p>
</li>
<li>
<p>The primary JAR artifact for the Java component: <code>my-library-1.0.jar</code></p>
</li>
<li>
<p>The sources JAR artifact that has been explicitly configured: <code>my-library-1.0-sources.jar</code></p>
</li>
<li>
<p>The Javadoc JAR artifact that has been explicitly configured: <code>my-library-1.0-javadoc.jar</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <a href="#signing_plugin">Signing Plugin</a> is used to generate a signature file for each artifact. In addition, checksum files will be generated for all artifacts and signature files.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_maven:deferred_configuration"><a class="anchor" href="#publishing_maven:deferred_configuration"></a><a class="link" href="#publishing_maven:deferred_configuration">Removal of deferred configuration behavior</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Gradle 5.0 will change the behavior of the publishing {} block. Read on to find out how you can make your build compatible today.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Prior to Gradle 4.8, the <code>publishing {}</code> block was implicitly treated as if all the logic inside it was executed after the project is evaluated.
This caused quite a bit of confusion, because it was the only block that behaved that way.
As part of the stabilization effort in Gradle 4.8, we are deprecating this behavior and asking all users to migrate their build.</p>
</div>
<div class="paragraph">
<p>The new, stable behavior can be switched on by adding the following to your settings file:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>enableFeaturePreview('STABLE_PUBLISHING')</pre>
</div>
</div>
<div class="paragraph">
<p>We recommend doing a test run with a local repository to see whether all artifacts still have the expected coordinates.
In most cases everything should work as before and you are done.</p>
</div>
<div class="paragraph">
<p>If the coordinates change unexpectedly, you may have some logic inside your publishing block or in a plugin that is depending on the deferred configuration behavior.
For instance, the following logic assumes that the subprojects will be evaluated when the artifactId is set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">subprojects {
    publishing {
        publications {
            mavenJava {
                from components.java
                artifactId = jar.baseName
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This kind of logic must be wrapped in an <code>afterEvaluate {}</code> block to make it work going forward.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">subprojects {
    publishing {
        publications {
            mavenJava {
                from components.java
                afterEvaluate {
                    artifactId = jar.baseName
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="publishing_ivy"><a class="anchor" href="#publishing_ivy"></a><a class="link" href="#publishing_ivy">Ivy Publish Plugin</a></h3>
<div class="paragraph">
<p>The Ivy Publish Plugin provides the ability to publish build artifacts in the <a href="http://ant.apache.org/ivy/">Apache Ivy</a> format, usually to a repository for consumption by other builds or projects. What is published is one or more artifacts created by the build, and an Ivy <em>module descriptor</em> (normally <code>ivy.xml</code>) that describes the artifacts and the dependencies of the artifacts, if any.</p>
</div>
<div class="paragraph">
<p>A published Ivy module can be consumed by Gradle (see <a href="#declaring_dependencies">Declaring Dependencies</a>) and other tools that understand the Ivy format. You can learn about the fundamentals of publishing in <a href="#publishing_overview">Publishing Overview</a>.</p>
</div>
<div class="sect3">
<h4 id="publishing_ivy:usage"><a class="anchor" href="#publishing_ivy:usage"></a><a class="link" href="#publishing_ivy:usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Ivy Publish Plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_applying_the_ivy_publish_plugin"><a class="anchor" href="#example_applying_the_ivy_publish_plugin"></a><a class="link" href="#example_applying_the_ivy_publish_plugin">Example: Applying the Ivy Publish Plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">ivy-publish</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Ivy Publish Plugin uses an extension on the project named <code>publishing</code> of type <a href="../dsl/org.gradle.api.publish.PublishingExtension.html">PublishingExtension</a>. This extension provides a container of named publications and a container of named repositories. The Ivy Publish Plugin works with <a href="../dsl/org.gradle.api.publish.ivy.IvyPublication.html">IvyPublication</a> publications and <a href="../dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html">IvyArtifactRepository</a> repositories.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_ivy:tasks"><a class="anchor" href="#publishing_ivy:tasks"></a><a class="link" href="#publishing_ivy:tasks">Tasks</a></h4>
<div id="publishing_ivy:descriptor" class="dlist">
<dl>
<dt class="hdlist1"><code>generateDescriptorFileFor<em>PubName</em>Publication</code>  <a href="../dsl/org.gradle.api.publish.ivy.tasks.GenerateIvyDescriptor.html">GenerateIvyDescriptor</a></dt>
<dd>
<p>Creates an Ivy descriptor file for the publication named <em>PubName</em>, populating the known metadata such as project name, project version, and the dependencies. The default location for the descriptor file is <em>build/publications/$pubName/ivy.xml</em>.</p>
</dd>
<dt class="hdlist1"><code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code>  <a href="../dsl/org.gradle.api.publish.ivy.tasks.PublishToIvyRepository.html">PublishToIvyRepository</a></dt>
<dd>
<p>Publishes the <em>PubName</em> publication to the repository named <em>RepoName</em>. If you have a repository definition without an explicit name, <em>RepoName</em> will be "Ivy".</p>
</dd>
<dt class="hdlist1"><code>publish</code></dt>
<dd>
<p><em>Depends on</em>: All <code>publish<em>PubName</em>PublicationTo<em>RepoName</em>Repository</code> tasks</p>
<div class="paragraph">
<p>An aggregate task that publishes all defined publications to all defined repositories.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="publishing_ivy:publications"><a class="anchor" href="#publishing_ivy:publications"></a><a class="link" href="#publishing_ivy:publications">Publications</a></h4>
<div class="paragraph">
<p>This plugin provides <a href="#glossary:publication">publications</a> of type <a href="../dsl/org.gradle.api.publish.ivy.IvyPublication.html">IvyPublication</a>. To learn how to define and use publications, see the section on <a href="#sec:basic_publishing">basic publishing</a>.</p>
</div>
<div class="paragraph">
<p>There are four main things you can configure in an Ivy publication:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <a href="#glossary:component">component</a> via <a href="../dsl/org.gradle.api.publish.ivy.IvyPublication.html#org.gradle.api.publish.ivy.IvyPublication:from(org.gradle.api.component.SoftwareComponent)">IvyPublication.from(org.gradle.api.component.SoftwareComponent)</a>.</p>
</li>
<li>
<p><a href="#sec:publishing_custom_artifacts_to_maven">Custom artifacts</a> via the <a href="../dsl/org.gradle.api.publish.ivy.IvyPublication.html#org.gradle.api.publish.ivy.IvyPublication:artifact(java.lang.Object)">IvyPublication.artifact(java.lang.Object)</a> method. See <a href="../dsl/org.gradle.api.publish.ivy.IvyArtifact.html">IvyArtifact</a> for the available configuration options for custom Ivy artifacts.</p>
</li>
<li>
<p>Standard metadata like <code>module</code>, <code>organisation</code> and <code>revision</code>.</p>
</li>
<li>
<p>Other contents of the module descriptor via <a href="../dsl/org.gradle.api.publish.ivy.IvyPublication.html#org.gradle.api.publish.ivy.IvyPublication:descriptor(org.gradle.api.Action)">IvyPublication.descriptor(org.gradle.api.Action)</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can see all of these in action in the <a href="#publishing_ivy:example">complete publishing example</a>. The API documentation for <code>IvyPublication</code> has additional code samples.</p>
</div>
<div class="sect4">
<h5 id="sec:identity_values_for_the_published_project"><a class="anchor" href="#sec:identity_values_for_the_published_project"></a><a class="link" href="#sec:identity_values_for_the_published_project">Identity values for the published project</a></h5>
<div class="paragraph">
<p>The generated Ivy module descriptor file contains an <code>&lt;info&gt;</code> element that identifies the module. The default identity values are derived from the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>organisation</code> - <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:group">Project.getGroup()</a></p>
</li>
<li>
<p><code>module</code> - <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:name">Project.getName()</a></p>
</li>
<li>
<p><code>revision</code> - <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:version">Project.getVersion()</a></p>
</li>
<li>
<p><code>status</code> - <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:status">Project.getStatus()</a></p>
</li>
<li>
<p><code>branch</code> - (not set)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Overriding the default identity values is easy: simply specify the <code>organisation</code>, <code>module</code> or <code>revision</code> properties when configuring the <a href="../dsl/org.gradle.api.publish.ivy.IvyPublication.html">IvyPublication</a>. <code>status</code> and <code>branch</code> can be set via the <code>descriptor</code> property  see <a href="../dsl/org.gradle.api.publish.ivy.IvyModuleDescriptorSpec.html">IvyModuleDescriptorSpec</a>.</p>
</div>
<div class="paragraph">
<p>The <code>descriptor</code> property can also be used to add additional custom elements as children of the <code>&lt;info&gt;</code> element, like so:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_customizing_the_publication_identity_2"><a class="anchor" href="#example_customizing_the_publication_identity_2"></a><a class="link" href="#example_customizing_the_publication_identity_2">Example: customizing the publication identity</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">publishing {
    publications {
        ivy(IvyPublication) {
            organisation = <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample</span><span class="delimiter">'</span></span>
            module = <span class="string"><span class="delimiter">'</span><span class="content">project1-sample</span><span class="delimiter">'</span></span>
            revision = <span class="string"><span class="delimiter">'</span><span class="content">1.1</span><span class="delimiter">'</span></span>
            descriptor.status = <span class="string"><span class="delimiter">'</span><span class="content">milestone</span><span class="delimiter">'</span></span>
            descriptor.branch = <span class="string"><span class="delimiter">'</span><span class="content">testing</span><span class="delimiter">'</span></span>
            descriptor.extraInfo <span class="string"><span class="delimiter">'</span><span class="content">http://my.namespace</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">myElement</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Some value</span><span class="delimiter">'</span></span>

            from components.java
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Certain repositories are not able to handle all supported characters. For example, the <code>:</code> character cannot be used as an identifier when publishing to a filesystem-backed repository on Windows.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Gradle will handle any valid Unicode character for <code>organisation</code>, <code>module</code> and <code>revision</code> (as well as the artifact&#8217;s <code>name</code>, <code>extension</code> and <code>classifier</code>). The only values that are explicitly prohibited are <code>\</code>, <code>/</code> and any ISO control character. The supplied values are validated early during publication.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:modifying_the_generated_module_descriptor"><a class="anchor" href="#sec:modifying_the_generated_module_descriptor"></a><a class="link" href="#sec:modifying_the_generated_module_descriptor">Customizing the generated module descriptor</a></h5>
<div class="paragraph">
<p>At times, the module descriptor file generated from the project information will need to be tweaked before publishing. The Ivy Publish Plugin provides a DSL for that purpose. Please see <a href="../dsl/org.gradle.api.publish.ivy.IvyModuleDescriptorSpec.html">IvyModuleDescriptorSpec</a> in the DSL Reference for the complete documentation of available properties and methods.</p>
</div>
<div class="paragraph">
<p>The following sample shows how to use the most common aspects of the DSL:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_customizing_the_module_descriptor_file"><a class="anchor" href="#example_customizing_the_module_descriptor_file"></a><a class="link" href="#example_customizing_the_module_descriptor_file">Example: Customizing the module descriptor file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">publications {
    ivyCustom(IvyPublication) {
        descriptor {
            license {
                name = <span class="string"><span class="delimiter">'</span><span class="content">The Apache License, Version 2.0</span><span class="delimiter">'</span></span>
                url = <span class="string"><span class="delimiter">'</span><span class="content">http://www.apache.org/licenses/LICENSE-2.0.txt</span><span class="delimiter">'</span></span>
            }
            author {
                name = <span class="string"><span class="delimiter">'</span><span class="content">Jane Doe</span><span class="delimiter">'</span></span>
                url = <span class="string"><span class="delimiter">'</span><span class="content">http://example.com/users/jane</span><span class="delimiter">'</span></span>
            }
            description {
                text = <span class="string"><span class="delimiter">'</span><span class="content">A concise description of my library</span><span class="delimiter">'</span></span>
                homepage = <span class="string"><span class="delimiter">'</span><span class="content">http://www.example.com/library</span><span class="delimiter">'</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example we are simply adding a 'description' element to the generated Ivy dependency descriptor, but this hook allows you to modify any aspect of the generated descriptor. For example, you could replace the version range for a dependency with the actual version used to produce the build.</p>
</div>
<div class="paragraph">
<p>You can also add arbitrary XML to the descriptor file via <a href="../dsl/org.gradle.api.publish.ivy.IvyModuleDescriptorSpec.html#org.gradle.api.publish.ivy.IvyModuleDescriptorSpec:withXml(org.gradle.api.Action)">IvyModuleDescriptorSpec.withXml(org.gradle.api.Action)</a>, but you can not use it to modify any part of the module identifier (organisation, module, revision).</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
It is possible to modify the descriptor in such a way that it is no longer a valid Ivy module descriptor, so care must be taken when using this feature.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_ivy:repositories"><a class="anchor" href="#publishing_ivy:repositories"></a><a class="link" href="#publishing_ivy:repositories">Repositories</a></h4>
<div class="paragraph">
<p>This plugin provides <a href="#sub:terminology_repository">repositories</a> of type <a href="../dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html">IvyArtifactRepository</a>. To learn how to define and use repositories for publishing, see the section on <a href="#sec:basic_publishing">basic publishing</a>.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a simple example of defining a publishing repository:</p>
</div>
<div class="sect4">
<h5 id="example_declaring_repositories_to_publish_to_2"><a class="anchor" href="#example_declaring_repositories_to_publish_to_2"></a><a class="link" href="#example_declaring_repositories_to_publish_to_2">Example: Declaring repositories to publish to</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">publishing {
    repositories {
        ivy {
            <span class="comment">// change to point to your repo, e.g. http://my.org/repo</span>
            url = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/repo</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The two main things you will want to configure are the repository&#8217;s:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>URL (required)</p>
</li>
<li>
<p>Name (optional)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can define multiple repositories as long as they have unique names within the build script. You may also declare one (and only one) repository without a name. That repository will take on an implicit name of "Ivy".</p>
</div>
<div class="paragraph">
<p>You can also configure any authentication details that are required to connect to the repository. See <a href="../dsl/org.gradle.api.artifacts.repositories.IvyArtifactRepository.html">IvyArtifactRepository</a> for more details.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="publishing_ivy:example"><a class="anchor" href="#publishing_ivy:example"></a><a class="link" href="#publishing_ivy:example">Complete example</a></h4>
<div class="paragraph">
<p>The following example demonstrates publishing with a multi-project build. Each project publishes a Java component and a configured additional source artifact. The descriptor file is customized to include the project description for each project.</p>
</div>
<div class="sect4">
<h5 id="example_publishing_a_java_module"><a class="anchor" href="#example_publishing_a_java_module"></a><a class="link" href="#example_publishing_a_java_module">Example: Publishing a Java module</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">subprojects {
    apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
    apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">ivy-publish</span><span class="delimiter">'</span></span>

    version = <span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>
    group = <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample</span><span class="delimiter">'</span></span>

    repositories {
        mavenCentral()
    }
    task sourcesJar(<span class="key">type</span>: Jar) {
        from sourceSets.main.java
        classifier = <span class="string"><span class="delimiter">'</span><span class="content">sources</span><span class="delimiter">'</span></span>
    }
}

project(<span class="string"><span class="delimiter">'</span><span class="content">:project1</span><span class="delimiter">'</span></span>) {
    description = <span class="string"><span class="delimiter">'</span><span class="content">The first project</span><span class="delimiter">'</span></span>

    dependencies {
       compile <span class="string"><span class="delimiter">'</span><span class="content">junit:junit:4.12</span><span class="delimiter">'</span></span>, project(<span class="string"><span class="delimiter">'</span><span class="content">:project2</span><span class="delimiter">'</span></span>)
    }
}

project(<span class="string"><span class="delimiter">'</span><span class="content">:project2</span><span class="delimiter">'</span></span>) {
    description = <span class="string"><span class="delimiter">'</span><span class="content">The second project</span><span class="delimiter">'</span></span>

    dependencies {
       compile <span class="string"><span class="delimiter">'</span><span class="content">commons-collections:commons-collections:3.2.2</span><span class="delimiter">'</span></span>
    }
}

subprojects {
    publishing {
        repositories {
            ivy {
                <span class="comment">// change to point to your repo, e.g. http://my.org/repo</span>
                url = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>rootProject.buildDir<span class="inline-delimiter">}</span></span><span class="content">/repo</span><span class="delimiter">&quot;</span></span>
            }
        }
        publications {
            ivy(IvyPublication) {
                from components.java
                artifact(sourcesJar) {
                    type = <span class="string"><span class="delimiter">'</span><span class="content">sources</span><span class="delimiter">'</span></span>
                    conf = <span class="string"><span class="delimiter">'</span><span class="content">compile</span><span class="delimiter">'</span></span>
                }
                descriptor.description {
                    text = description
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result is that the following artifacts will be published for each project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Ivy module descriptor file: <code>ivy-1.0.xml</code>.</p>
</li>
<li>
<p>The primary JAR artifact for the Java component: <code>project1-1.0.jar</code>.</p>
</li>
<li>
<p>The source JAR artifact that has been explicitly configured: <code>project1-1.0-source.jar</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <code>project1</code> is published, the module descriptor (i.e. the <code>ivy.xml</code> file) that is produced will look like:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_generated_ivy_xml"><a class="anchor" href="#example_generated_ivy_xml"></a><a class="link" href="#example_generated_ivy_xml">Example: Generated ivy.xml</a></h5>
<div class="listingblock">
<div class="title">output-ivy.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!-- This file is an example of the Ivy module descriptor that this build will produce --&gt;</span>
<span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;ivy-module</span> <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2.0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:m</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://ant.apache.org/ivy/maven</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;info</span> <span class="attribute-name">organisation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.sample</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">module</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">project1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">revision</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">status</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">integration</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">publication</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PUBLICATION-TIME-STAMP</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;description&gt;</span>The first project<span class="tag">&lt;/description&gt;</span>
  <span class="tag">&lt;/info&gt;</span>
  <span class="tag">&lt;configurations&gt;</span>
    <span class="tag">&lt;conf</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">compile</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">visibility</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;conf</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">visibility</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">extends</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">compile,runtime</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;conf</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">runtime</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">visibility</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">public</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/configurations&gt;</span>
  <span class="tag">&lt;publications&gt;</span>
    <span class="tag">&lt;artifact</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">project1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sources</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">ext</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jar</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">conf</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">compile</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">m:classifier</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sources</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;artifact</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">project1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jar</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">ext</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jar</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">conf</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">compile</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/publications&gt;</span>
  <span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency</span> <span class="attribute-name">org</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">junit</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">junit</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rev</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">4.12</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">conf</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">compile-</span><span class="entity">&amp;gt;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;dependency</span> <span class="attribute-name">org</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.sample</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">project2</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rev</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">conf</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">compile-</span><span class="entity">&amp;gt;</span><span class="content">default</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/dependencies&gt;</span>
<span class="tag">&lt;/ivy-module&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Note that <code>PUBLICATION-TIME-STAMP</code> in this example Ivy module descriptor will be the timestamp of when the descriptor was generated.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="artifact_management"><a class="anchor" href="#artifact_management"></a><a class="link" href="#artifact_management">Legacy publishing</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This chapter describes the <em>original</em> publishing mechanism available in Gradle 1.0, which has since been superseded by <a href="#publishing_overview">an alternative model</a>. The approach detailed in this chapter  based on <a href="../dsl/org.gradle.api.tasks.Upload.html">Upload</a> tasks should not be used in new builds. We cover it in order to help users work with and update existing builds that use it.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec:introduction"><a class="anchor" href="#sec:introduction"></a><a class="link" href="#sec:introduction">Introduction</a></h4>
<div class="paragraph">
<p>This chapter is about how you declare the outgoing artifacts of your project, and how to work with them (e.g. upload them). We define the artifacts of the projects as the files the project provides to the outside world. This might be a library or a ZIP distribution or any other file. A project can publish as many artifacts as it wants.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:artifacts_and_configurations"><a class="anchor" href="#sec:artifacts_and_configurations"></a><a class="link" href="#sec:artifacts_and_configurations">Artifacts and configurations</a></h4>
<div class="paragraph">
<p>Like dependencies, artifacts are grouped by configurations. In fact, a configuration can contain both artifacts and dependencies at the same time.</p>
</div>
<div class="paragraph">
<p>For each configuration in your project, Gradle provides the tasks <code>upload<em>ConfigurationName</em></code> and <code>build<em>ConfigurationName</em></code> when the <a href="#base_plugin">base plugin</a> is applied.
Execution of these tasks will build or upload the artifacts belonging to the respective configuration.</p>
</div>
<div class="paragraph">
<p><a href="#tab:configurations">This listing</a> shows the configurations added by the Java plugin. Two of the configurations are relevant for the usage with artifacts. The <code>archives</code> configuration is the standard configuration to assign your artifacts to. The Java plugin automatically assigns the default jar to this configuration. We will talk more about the <code>runtime</code> configuration <a href="#project_libraries">further on</a>. As with dependencies, you can declare as many custom configurations as you like and assign artifacts to them.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:declaring_artifacts"><a class="anchor" href="#sec:declaring_artifacts"></a><a class="link" href="#sec:declaring_artifacts">Declaring artifacts</a></h4>
<div class="sect4">
<h5 id="sec:archive_task_artifacts"><a class="anchor" href="#sec:archive_task_artifacts"></a><a class="link" href="#sec:archive_task_artifacts">Archive task artifacts</a></h5>
<div class="paragraph">
<p>You can use an archive task to define an artifact:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_an_artifact_using_an_archive_task"><a class="anchor" href="#example_defining_an_artifact_using_an_archive_task"></a><a class="link" href="#example_defining_an_artifact_using_an_archive_task">Example: Defining an artifact using an archive task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task myJar(<span class="key">type</span>: Jar)

artifacts {
    archives myJar
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is important to note that the custom archives you are creating as part of your build are not automatically assigned to any configuration. You have to explicitly do this assignment.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:file_artifacts"><a class="anchor" href="#sec:file_artifacts"></a><a class="link" href="#sec:file_artifacts">File artifacts</a></h5>
<div class="paragraph">
<p>You can also use a file to define an artifact:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_an_artifact_using_a_file"><a class="anchor" href="#example_defining_an_artifact_using_a_file"></a><a class="link" href="#example_defining_an_artifact_using_a_file">Example: Defining an artifact using a file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> someFile = file(<span class="string"><span class="delimiter">'</span><span class="content">build/somefile.txt</span><span class="delimiter">'</span></span>)

artifacts {
    archives someFile
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle will figure out the properties of the artifact based on the name of the file. You can customize these properties:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_customizing_an_artifact"><a class="anchor" href="#example_customizing_an_artifact"></a><a class="link" href="#example_customizing_an_artifact">Example: Customizing an artifact</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task myTask(<span class="key">type</span>:  MyTaskType) {
    destFile = file(<span class="string"><span class="delimiter">'</span><span class="content">build/somefile.txt</span><span class="delimiter">'</span></span>)
}

artifacts {
    archives(myTask.destFile) {
        name <span class="string"><span class="delimiter">'</span><span class="content">my-artifact</span><span class="delimiter">'</span></span>
        type <span class="string"><span class="delimiter">'</span><span class="content">text</span><span class="delimiter">'</span></span>
        builtBy myTask
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is a map-based syntax for defining an artifact using a file. The map must include a <code>file</code> entry that defines the file. The map may include other artifact properties:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_map_syntax_for_defining_an_artifact_using_a_file"><a class="anchor" href="#example_map_syntax_for_defining_an_artifact_using_a_file"></a><a class="link" href="#example_map_syntax_for_defining_an_artifact_using_a_file">Example: Map syntax for defining an artifact using a file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task generate(<span class="key">type</span>:  MyTaskType) {
    destFile = file(<span class="string"><span class="delimiter">'</span><span class="content">build/somefile.txt</span><span class="delimiter">'</span></span>)
}

artifacts {
    archives <span class="key">file</span>: generate.destFile, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">my-artifact</span><span class="delimiter">'</span></span>, <span class="key">type</span>: <span class="string"><span class="delimiter">'</span><span class="content">text</span><span class="delimiter">'</span></span>, <span class="key">builtBy</span>: generate
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:publishing_artifacts"><a class="anchor" href="#sec:publishing_artifacts"></a><a class="link" href="#sec:publishing_artifacts">Publishing artifacts</a></h4>
<div class="paragraph">
<p>We have said that there is a specific upload task for each configuration. Before you can do an upload, you have to configure the upload task and define where to publish the artifacts to. The repositories you have defined (as described in <a href="#declaring_repositories">Declaring Repositories</a>) are not automatically used for uploading. In fact, some of those repositories only allow downloading artifacts, not uploading. Here is an example of how you can configure the upload task of a configuration:</p>
</div>
<div class="sect4">
<h5 id="example_configuration_of_the_upload_task"><a class="anchor" href="#example_configuration_of_the_upload_task"></a><a class="link" href="#example_configuration_of_the_upload_task">Example: Configuration of the upload task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    flatDir {
        name <span class="string"><span class="delimiter">&quot;</span><span class="content">fileRepo</span><span class="delimiter">&quot;</span></span>
        dirs <span class="string"><span class="delimiter">&quot;</span><span class="content">repo</span><span class="delimiter">&quot;</span></span>
    }
}

uploadArchives {
    repositories {
        add project.repositories.fileRepo
        ivy {
            credentials {
                username <span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>
                password <span class="string"><span class="delimiter">&quot;</span><span class="content">pw</span><span class="delimiter">&quot;</span></span>
            }
            url <span class="string"><span class="delimiter">&quot;</span><span class="content">http://repo.mycompany.com</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, you can either use a reference to an existing repository or create a new repository.</p>
</div>
<div class="paragraph">
<p>If an upload repository is defined with multiple patterns, Gradle must choose a pattern to use for uploading each file. By default, Gradle will upload to the pattern defined by the <code>url</code> parameter, combined with the optional <code>layout</code> parameter. If no <code>url</code> parameter is supplied, then Gradle will use the first defined <code>artifactPattern</code> for uploading, or the first defined <code>ivyPattern</code> for uploading Ivy files, if this is set.</p>
</div>
<div class="paragraph">
<p>Uploading to a Maven repository is described in <a href="#uploading_to_maven_repositories">this section</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="project_libraries"><a class="anchor" href="#project_libraries"></a><a class="link" href="#project_libraries">More about project libraries</a></h4>
<div class="paragraph">
<p>If your project is supposed to be used as a library, you need to define what are the artifacts of this library and what are the dependencies of these artifacts. The Java plugin adds a <code>runtime</code> configuration for this purpose, with the implicit assumption that the <code>runtime</code> dependencies are the dependencies of the artifact you want to publish. Of course this is fully customizable. You can add your own custom configuration or let the existing configurations extend from other configurations. You might have a different group of artifacts which have a different set of dependencies. This mechanism is very powerful and flexible.</p>
</div>
<div class="paragraph">
<p>If someone wants to use your project as a library, she simply needs to declare which configuration of the dependency to depend on. A Gradle dependency offers the <code>configuration</code> property to declare this. If this is not specified, the <code>default</code> configuration is used (see <a href="#managing_dependency_configurations">Managing Dependency Configurations</a>). Using your project as a library can either happen from within a multi-project build or by retrieving your project from a repository. In the latter case, an <code>ivy.xml</code> descriptor in the repository is supposed to contain all the necessary information. If you work with Maven repositories you don&#8217;t have the flexibility as described above. For how to publish to a Maven repository, see the section <a href="#uploading_to_maven_repositories">Uploading to Maven repositories</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="maven_plugin"><a class="anchor" href="#maven_plugin"></a><a class="link" href="#maven_plugin">Maven Plugin</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This chapter describes deploying artifacts to Maven repositories using the <em>original</em> publishing mechanism available in Gradle 1.0: in Gradle 1.3 a new mechanism for publishing was introduced. This new mechanism introduces some new concepts and features that make Gradle publishing even more powerful and is now the preferred option for publishing artifacts.</p>
</div>
<div class="paragraph">
<p>You can read about the new publishing plugins in <a href="#publishing_ivy">Publishing Ivy</a> and <a href="#publishing_maven">Publishing Maven</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Maven plugin adds support for deploying artifacts to Maven repositories.</p>
</div>
<div class="sect3">
<h4 id="sec:maven_usage"><a class="anchor" href="#sec:maven_usage"></a><a class="link" href="#sec:maven_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Maven plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_maven_plugin"><a class="anchor" href="#example_using_the_maven_plugin"></a><a class="link" href="#example_using_the_maven_plugin">Example: Using the Maven plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">maven</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:maven_tasks"><a class="anchor" href="#sec:maven_tasks"></a><a class="link" href="#sec:maven_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Maven plugin defines the following tasks:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>install</code>  <a href="../dsl/org.gradle.api.tasks.Upload.html">Upload</a></dt>
<dd>
<p><em>Depends on</em>: All tasks that build the associated archives.</p>
<div class="paragraph">
<p>Installs the associated artifacts to the local Maven cache, including Maven metadata generation. By default the install task is associated with the <code>archives</code> configuration. This configuration has by default only the default jar as an element. To learn more about installing to the local repository, see <a href="#sub:installing_to_the_local_repository">Installing to the local repository</a></p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:maven_dependency_management"><a class="anchor" href="#sec:maven_dependency_management"></a><a class="link" href="#sec:maven_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>The Maven plugin does not define any dependency configurations.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:maven_convention_properties"><a class="anchor" href="#sec:maven_convention_properties"></a><a class="link" href="#sec:maven_convention_properties">Convention properties</a></h4>
<div class="paragraph">
<p>The Maven plugin defines the following convention properties:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>mavenPomDir</code>  <code>File</code></dt>
<dd>
<p>The directory where the generated POMs are written to. <em>Default value</em>: <code><em>${project.buildDir}</em>/poms</code></p>
</dd>
<dt class="hdlist1"><code>conf2ScopeMappings</code>  <code><a href="../javadoc/org/gradle/api/artifacts/maven/Conf2ScopeMappingContainer.html">Conf2ScopeMappingContainer</a></code></dt>
<dd>
<p>Instructions for mapping Gradle configurations to Maven scopes. See <a href="#sub:dependency_mapping">Dependency mapping</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These properties are provided by a <a href="../dsl/org.gradle.api.plugins.MavenPluginConvention.html">MavenPluginConvention</a> convention object.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:maven_convention_methods"><a class="anchor" href="#sec:maven_convention_methods"></a><a class="link" href="#sec:maven_convention_methods">Convention methods</a></h4>
<div class="paragraph">
<p>The maven plugin provides a factory method for creating a POM. This is useful if you need a POM without the context of uploading to a Maven repo.</p>
</div>
<div class="sect4">
<h5 id="example_creating_a_standalone_pom"><a class="anchor" href="#example_creating_a_standalone_pom"></a><a class="link" href="#example_creating_a_standalone_pom">Example: Creating a standalone pom.</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task writeNewPom {
    doLast {
        pom {
            project {
                inceptionYear <span class="string"><span class="delimiter">'</span><span class="content">2008</span><span class="delimiter">'</span></span>
                licenses {
                    license {
                        name <span class="string"><span class="delimiter">'</span><span class="content">The Apache Software License, Version 2.0</span><span class="delimiter">'</span></span>
                        url <span class="string"><span class="delimiter">'</span><span class="content">http://www.apache.org/licenses/LICENSE-2.0.txt</span><span class="delimiter">'</span></span>
                        distribution <span class="string"><span class="delimiter">'</span><span class="content">repo</span><span class="delimiter">'</span></span>
                    }
                }
            }
        }.writeTo(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/newpom.xml</span><span class="delimiter">&quot;</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Amongst other things, Gradle supports the same builder syntax as polyglot Maven. To learn more about the Gradle Maven POM object, see <a href="../javadoc/org/gradle/api/artifacts/maven/MavenPom.html">MavenPom</a>. See also: <a href="../dsl/org.gradle.api.plugins.MavenPluginConvention.html">MavenPluginConvention</a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="uploading_to_maven_repositories"><a class="anchor" href="#uploading_to_maven_repositories"></a><a class="link" href="#uploading_to_maven_repositories">Interacting with Maven repositories</a></h4>
<div class="sect4">
<h5 id="sec:maven_upload_intro"><a class="anchor" href="#sec:maven_upload_intro"></a><a class="link" href="#sec:maven_upload_intro">Introduction</a></h5>
<div class="paragraph">
<p>With Gradle you can deploy to remote Maven repositories or install to your local Maven repository. This includes all Maven metadata manipulation and works also for Maven snapshots. In fact, Gradle&#8217;s deployment is 100 percent Maven compatible as we use the native Maven Ant tasks under the hood.</p>
</div>
<div class="paragraph">
<p>Deploying to a Maven repository is only half the fun if you don&#8217;t have a POM. Fortunately Gradle can generate this POM for you using the dependency information it has.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:deploying_to_a_maven_repository"><a class="anchor" href="#sec:deploying_to_a_maven_repository"></a><a class="link" href="#sec:deploying_to_a_maven_repository">Deploying to a Maven repository</a></h5>
<div class="paragraph">
<p>Let&#8217;s assume your project produces just the default jar file. Now you want to deploy this jar file to a remote Maven repository.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_upload_of_file_to_remote_maven_repository"><a class="anchor" href="#example_upload_of_file_to_remote_maven_repository"></a><a class="link" href="#example_upload_of_file_to_remote_maven_repository">Example: Upload of file to remote Maven repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">maven</span><span class="delimiter">'</span></span>

uploadArchives {
    repositories {
        mavenDeployer {
            repository(<span class="key">url</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://localhost/tmp/myRepo/</span><span class="delimiter">&quot;</span></span>)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That is all. Calling the <code>uploadArchives</code> task will generate the POM and deploys the artifact and the POM to the specified repository.</p>
</div>
<div class="paragraph">
<p>There is more work to do if you need support for protocols other than <code>file</code>. In this case the native Maven code we delegate to needs additional libraries. Which libraries are needed depends on what protocol you plan to use. The available protocols and the corresponding libraries are listed in <a href="#wagonLibs">Protocol JARs for Maven deployment</a> (those libraries have transitive dependencies which have transitive dependencies).<sup class="footnote">[<a id="_footnoteref_8" class="footnote" href="#_footnotedef_8" title="View footnote.">8</a>]</sup> For example, to use the ssh protocol you can do:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_upload_of_file_via_ssh"><a class="anchor" href="#example_upload_of_file_via_ssh"></a><a class="link" href="#example_upload_of_file_via_ssh">Example: Upload of file via SSH</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    deployerJars
}

repositories {
    mavenCentral()
}

dependencies {
    deployerJars <span class="string"><span class="delimiter">&quot;</span><span class="content">org.apache.maven.wagon:wagon-ssh:2.2</span><span class="delimiter">&quot;</span></span>
}

uploadArchives {
    repositories.mavenDeployer {
        configuration = configurations.deployerJars
        repository(<span class="key">url</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">scp://repos.mycompany.com/releases</span><span class="delimiter">&quot;</span></span>) {
            authentication(<span class="key">userName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">me</span><span class="delimiter">&quot;</span></span>, <span class="key">password</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">myPassword</span><span class="delimiter">&quot;</span></span>)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are many configuration options for the Maven deployer. The configuration is done via a Groovy builder. All the elements of this tree are Java beans. To configure the simple attributes you pass a map to the bean elements. To add bean elements to its parent, you use a closure. In the example above <em>repository</em> and <em>authentication</em> are such bean elements. <a href="#deployerConfig">Configuration elements of Maven deployer</a> lists the available bean elements and a link to the Javadoc of the corresponding class. In the Javadoc you can see the possible attributes you can set for a particular element.</p>
</div>
<div class="paragraph">
<p>In Maven you can define repositories and optionally snapshot repositories. If no snapshot repository is defined, releases and snapshots are both deployed to the <code>repository</code> element. Otherwise snapshots are deployed to the <code>snapshotRepository</code> element.</p>
</div>
<table id="wagonLibs" class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 8. Protocol jars for Maven deployment</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Protocol</th>
<th class="tableblock halign-left valign-top">Library</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">http</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.apache.maven.wagon:wagon-http:2.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ssh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.apache.maven.wagon:wagon-ssh:2.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ssh-external</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.apache.maven.wagon:wagon-ssh-external:2.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ftp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.apache.maven.wagon:wagon-ftp:2.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">webdav</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.apache.maven.wagon:wagon-webdav:1.0-beta-2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<table id="deployerConfig" class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 9. Configuration elements of the MavenDeployer</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Javadoc</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">root</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/artifacts/maven/MavenDeployer.html">MavenDeployer</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">repository</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.docjar.com/docs/api/org/apache/maven/artifact/ant/RemoteRepository.html">org.apache.maven.artifact.ant.RemoteRepository</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.docjar.com/docs/api/org/apache/maven/artifact/ant/Authentication.html">org.apache.maven.artifact.ant.Authentication</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">releases</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.docjar.com/docs/api/org/apache/maven/artifact/ant/RepositoryPolicy.html">org.apache.maven.artifact.ant.RepositoryPolicy</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">snapshots</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.docjar.com/docs/api/org/apache/maven/artifact/ant/RepositoryPolicy.html">org.apache.maven.artifact.ant.RepositoryPolicy</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">proxy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.docjar.com/docs/api/org/apache/maven/artifact/ant/Proxy.html">org.apache.maven.artifact.ant.Proxy</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">snapshotRepository</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.docjar.com/docs/api/org/apache/maven/artifact/ant/RemoteRepository.html">org.apache.maven.artifact.ant.RemoteRepository</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="sub:installing_to_the_local_repository"><a class="anchor" href="#sub:installing_to_the_local_repository"></a><a class="link" href="#sub:installing_to_the_local_repository">Installing to the local repository</a></h5>
<div class="paragraph">
<p>The Maven plugin adds an <code>install</code> task to your project. This task depends on all the archives task of the <code>archives</code> configuration. It installs those archives to your local Maven repository. If the default location for the local repository is redefined in a Maven <code>settings.xml</code>, this is considered by this task.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:maven_pom_generation"><a class="anchor" href="#sec:maven_pom_generation"></a><a class="link" href="#sec:maven_pom_generation">Maven POM generation</a></h5>
<div class="paragraph">
<p>When deploying an artifact to a Maven repository, Gradle automatically generates a POM for it. The <code>groupId</code>, <code>artifactId</code>, <code>version</code> and <code>packaging</code> elements used for the POM default to the values shown in the table below. The <code>dependency</code> elements are created from the project&#8217;s dependency declarations.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 10. Default Values for Maven POM generation</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Maven Element</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">project.group</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">artifactId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uploadTask.repositories.mavenDeployer.pom.artifactId (if set) or archiveTask.baseName.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">project.version</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">packaging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">archiveTask.extension</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Here, <code>uploadTask</code> and <code>archiveTask</code> refer to the tasks used for uploading and generating the archive, respectively (for example <code>uploadArchives</code> and <code>jar</code>). <code>archiveTask.baseName</code> defaults to <code>project.archivesBaseName</code> which in turn defaults to <code>project.name</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>When you set the <code>archiveTask.baseName</code> property to a value other than the default, you&#8217;ll also have to set <code>uploadTask.repositories.mavenDeployer.pom.artifactId</code> to the same value. Otherwise, the project at hand may be referenced with the wrong artifact ID from generated POMs for other projects in the same build.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Generated POMs can be found in <code>&lt;buildDir&gt;/poms</code>. They can be further customized via the <a href="../javadoc/org/gradle/api/artifacts/maven/MavenPom.html">MavenPom</a> API. For example, you might want the artifact deployed to the Maven repository to have a different version or name than the artifact generated by Gradle. To customize these you can do:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_customization_of_pom"><a class="anchor" href="#example_customization_of_pom"></a><a class="link" href="#example_customization_of_pom">Example: Customization of pom</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">uploadArchives {
    repositories {
        mavenDeployer {
            repository(<span class="key">url</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://localhost/tmp/myRepo/</span><span class="delimiter">&quot;</span></span>)
            pom.version = <span class="string"><span class="delimiter">'</span><span class="content">1.0Maven</span><span class="delimiter">'</span></span>
            pom.artifactId = <span class="string"><span class="delimiter">'</span><span class="content">myMavenName</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To add additional content to the POM, the <code>pom.project</code> builder can be used. With this builder, any element listed in the <a href="http://maven.apache.org/pom.html">Maven POM reference</a> can be added.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_builder_style_customization_of_pom"><a class="anchor" href="#example_builder_style_customization_of_pom"></a><a class="link" href="#example_builder_style_customization_of_pom">Example: Builder style customization of pom</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">uploadArchives {
    repositories {
        mavenDeployer {
            repository(<span class="key">url</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://localhost/tmp/myRepo/</span><span class="delimiter">&quot;</span></span>)
            pom.project {
                licenses {
                    license {
                        name <span class="string"><span class="delimiter">'</span><span class="content">The Apache Software License, Version 2.0</span><span class="delimiter">'</span></span>
                        url <span class="string"><span class="delimiter">'</span><span class="content">http://www.apache.org/licenses/LICENSE-2.0.txt</span><span class="delimiter">'</span></span>
                        distribution <span class="string"><span class="delimiter">'</span><span class="content">repo</span><span class="delimiter">'</span></span>
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: <code>groupId</code>, <code>artifactId</code>, <code>version</code>, and <code>packaging</code> should always be set directly on the <code>pom</code> object.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_modifying_auto_generated_content"><a class="anchor" href="#example_modifying_auto_generated_content"></a><a class="link" href="#example_modifying_auto_generated_content">Example: Modifying auto-generated content</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> installer = install.repositories.mavenInstaller
<span class="keyword">def</span> deployer = uploadArchives.repositories.mavenDeployer

[installer, deployer]*.pom*.whenConfigured {pom -&gt;
    pom.dependencies.find {dep -&gt; dep.groupId == <span class="string"><span class="delimiter">'</span><span class="content">group3</span><span class="delimiter">'</span></span> &amp;&amp; dep.artifactId == <span class="string"><span class="delimiter">'</span><span class="content">runtime</span><span class="delimiter">'</span></span> }.optional = <span class="predefined-constant">true</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you have more than one artifact to publish, things work a little bit differently. See <a href="#sub:multiple_artifacts_per_project">Multiple artifacts per project</a>.</p>
</div>
<div class="paragraph">
<p>To customize the settings for the Maven installer (see <a href="#sub:installing_to_the_local_repository">Installing to the local repository</a>), you can do:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_customization_of_maven_installer"><a class="anchor" href="#example_customization_of_maven_installer"></a><a class="link" href="#example_customization_of_maven_installer">Example: Customization of Maven installer</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">install {
    repositories.mavenInstaller {
        pom.version = <span class="string"><span class="delimiter">'</span><span class="content">1.0Maven</span><span class="delimiter">'</span></span>
        pom.artifactId = <span class="string"><span class="delimiter">'</span><span class="content">myName</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="sub:multiple_artifacts_per_project"><a class="anchor" href="#sub:multiple_artifacts_per_project"></a><a class="link" href="#sub:multiple_artifacts_per_project">Multiple artifacts per project</a></h6>
<div class="paragraph">
<p>Maven can only deal with one artifact per project. This is reflected in the structure of the Maven POM. We think there are many situations where it makes sense to have more than one artifact per project. In such a case you need to generate multiple POMs. In such a case you have to explicitly declare each artifact you want to publish to a Maven repository. The <a href="../javadoc/org/gradle/api/artifacts/maven/MavenDeployer.html">MavenDeployer</a> and the MavenInstaller both provide an API for this:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_generation_of_multiple_poms"><a class="anchor" href="#example_generation_of_multiple_poms"></a><a class="link" href="#example_generation_of_multiple_poms">Example: Generation of multiple poms</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">uploadArchives {
    repositories {
        mavenDeployer {
            repository(<span class="key">url</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://localhost/tmp/myRepo/</span><span class="delimiter">&quot;</span></span>)
            addFilter(<span class="string"><span class="delimiter">'</span><span class="content">api</span><span class="delimiter">'</span></span>) {artifact, file -&gt;
                artifact.name == <span class="string"><span class="delimiter">'</span><span class="content">api</span><span class="delimiter">'</span></span>
            }
            addFilter(<span class="string"><span class="delimiter">'</span><span class="content">service</span><span class="delimiter">'</span></span>) {artifact, file -&gt;
                artifact.name == <span class="string"><span class="delimiter">'</span><span class="content">service</span><span class="delimiter">'</span></span>
            }
            pom(<span class="string"><span class="delimiter">'</span><span class="content">api</span><span class="delimiter">'</span></span>).version = <span class="string"><span class="delimiter">'</span><span class="content">mySpecialMavenVersion</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You need to declare a filter for each artifact you want to publish. This filter defines a boolean expression for which Gradle artifact it accepts. Each filter has a POM associated with it which you can configure. To learn more about this have a look at <a href="../javadoc/org/gradle/api/artifacts/maven/PomFilterContainer.html">PomFilterContainer</a> and its associated classes.</p>
</div>
<div class="sect5">
<h6 id="sub:dependency_mapping"><a class="anchor" href="#sub:dependency_mapping"></a><a class="link" href="#sub:dependency_mapping">Dependency mapping</a></h6>
<div class="paragraph">
<p>The Maven plugin configures the default mapping between the Gradle configurations added by the Java and War plugin and the Maven scopes. Most of the time you don&#8217;t need to touch this and you can safely skip this section. The mapping works like the following. You can map a configuration to one and only one scope. Different configurations can be mapped to one or different scopes. You can also assign a priority to a particular configuration-to-scope mapping. Have a look at <a href="../javadoc/org/gradle/api/artifacts/maven/Conf2ScopeMappingContainer.html">Conf2ScopeMappingContainer</a> to learn more. To access the mapping configuration you can say:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_accessing_a_mapping_configuration"><a class="anchor" href="#example_accessing_a_mapping_configuration"></a><a class="link" href="#example_accessing_a_mapping_configuration">Example: Accessing a mapping configuration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task mappings {
    doLast {
        println conf2ScopeMappings.mappings
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradle exclude rules are converted to Maven excludes if possible. Such a conversion is possible if in the Gradle exclude rule the group as well as the module name is specified (as Maven needs both in contrast to Ivy). Per-configuration excludes are also included in the Maven POM, if they are convertible.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="signing_plugin"><a class="anchor" href="#signing_plugin"></a><a class="link" href="#signing_plugin">The Signing Plugin</a></h3>
<div class="paragraph">
<p>The Signing Plugin adds the ability to digitally sign built files and artifacts. These digital signatures can then be used to prove who built the artifact the signature is attached to as well as other information such as when the signature was generated.</p>
</div>
<div class="paragraph">
<p>The Signing Plugin currently only provides support for generating <a href="https://en.wikipedia.org/wiki/Pretty_Good_Privacy#OpenPGP">OpenPGP signatures</a> (which is the signature format <a href="http://central.sonatype.org/pages/requirements.html#sign-files-with-gpgpgp">required for publication to the Maven Central Repository</a>).</p>
</div>
<div class="sect3">
<h4 id="sec:signing_usage"><a class="anchor" href="#sec:signing_usage"></a><a class="link" href="#sec:signing_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Signing Plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_signing_plugin"><a class="anchor" href="#example_using_the_signing_plugin"></a><a class="link" href="#example_using_the_signing_plugin">Example: Using the Signing Plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">signing</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:signatory_credentials"><a class="anchor" href="#sec:signatory_credentials"></a><a class="link" href="#sec:signatory_credentials">Signatory credentials</a></h4>
<div class="paragraph">
<p>In order to create OpenPGP signatures, you will need a key pair (instructions on creating a key pair using the <a href="https://www.gnupg.org/">GnuPG tools</a> can be found in the <a href="https://www.gnupg.org/documentation/howtos.html">GnuPG HOWTOs</a>). You need to provide the Signing Plugin with your key information, which means three things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The public key ID (The last 8 symbols of the keyId. You can use <code>gpg -K</code> to get it).</p>
</li>
<li>
<p>The absolute path to the secret key ring file containing your private key. (Since gpg 2.1, you need to export the keys with command <code>gpg --keyring secring.gpg --export-secret-keys &gt; ~/.gnupg/secring.gpg</code>).</p>
</li>
<li>
<p>The passphrase used to protect your private key.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These items must be supplied as the values of the <code>signing.keyId</code>, <code>signing.secretKeyRingFile</code>, and <code>signing.password</code> properties, respectively.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Given the personal and private nature of these values, a good practice is to store them in the <code>gradle.properties</code> file in the user&#8217;s Gradle home directory (described in <a href="#sec:gradle_system_properties">System properties</a>) instead of in the project directory itself.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">signing.keyId=24875D73
signing.password=secret
signing.secretKeyRingFile=/Users/me/.gnupg/secring.gpg</code></pre>
</div>
</div>
<div class="paragraph">
<p>If specifying this information (especially <code>signing.password</code>) in the user <code>gradle.properties</code> file is not feasible for your environment, you can source the information however you need to and set the project properties manually.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.gradle.plugins.signing.Sign</span>

gradle.taskGraph.whenReady { taskGraph -&gt;
    <span class="keyword">if</span> (taskGraph.allTasks.any { <span class="local-variable">it</span> <span class="keyword">instanceof</span> Sign }) {
        <span class="comment">// Use Java 6's console to read from the console (no good for</span>
        <span class="comment">// a CI environment)</span>
        Console console = <span class="predefined-type">System</span>.console()
        console.printf <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="char">\n</span><span class="content">We have to sign some things in this build.</span><span class="delimiter">&quot;</span></span> +
                       <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="char">\n</span><span class="content">Please enter your signing details.</span><span class="char">\n</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>

        <span class="keyword">def</span> id = console.readLine(<span class="string"><span class="delimiter">&quot;</span><span class="content">PGP Key Id: </span><span class="delimiter">&quot;</span></span>)
        <span class="keyword">def</span> file = console.readLine(<span class="string"><span class="delimiter">&quot;</span><span class="content">PGP Secret Key Ring File (absolute path): </span><span class="delimiter">&quot;</span></span>)
        <span class="keyword">def</span> password = console.readPassword(<span class="string"><span class="delimiter">&quot;</span><span class="content">PGP Private Key Password: </span><span class="delimiter">&quot;</span></span>)

        allprojects { ext.<span class="string"><span class="delimiter">&quot;</span><span class="content">signing.keyId</span><span class="delimiter">&quot;</span></span> = id }
        allprojects { ext.<span class="string"><span class="delimiter">&quot;</span><span class="content">signing.secretKeyRingFile</span><span class="delimiter">&quot;</span></span> = file }
        allprojects { ext.<span class="string"><span class="delimiter">&quot;</span><span class="content">signing.password</span><span class="delimiter">&quot;</span></span> = password }

        console.printf <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="content">Thanks.</span><span class="char">\n</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the presence of a null value for any these three properties will cause an exception.</p>
</div>
<div class="sect4">
<h5 id="sec:subkeys"><a class="anchor" href="#sec:subkeys"></a><a class="link" href="#sec:subkeys">Using OpenPGP subkeys</a></h5>
<div class="paragraph">
<p>OpenPGP supports subkeys, which are like the normal keys, except they&#8217;re bound to a master key pair. One feature of OpenPGP subkeys is that they can be revoked independently of the master keys which makes key management easier. A practical case study of how subkeys can be leveraged in software development can be read on the <a href="https://wiki.debian.org/Subkeys">Debian wiki</a>.</p>
</div>
<div class="paragraph">
<p>The Signing Plugin supports OpenPGP subkeys out of the box. Just specify a subkey ID as the value in the <code>signing.keyId</code> property.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:using_gpg_agent"><a class="anchor" href="#sec:using_gpg_agent"></a><a class="link" href="#sec:using_gpg_agent">Using gpg-agent</a></h4>
<div class="paragraph">
<p>By default the Signing Plugin uses a Java-based implementation of PGP for signing. This implementation cannot use the gpg-agent program for managing private keys, though. If you want to use the gpg-agent, you can change the signatory implementation used by the Signing Plugin:</p>
</div>
<div class="sect4">
<h5 id="example_sign_with_gnupg"><a class="anchor" href="#example_sign_with_gnupg"></a><a class="link" href="#example_sign_with_gnupg">Example: Sign with GnuPG</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">signing {
    useGpgCmd()
    sign configurations.archives
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This tells the Signing Plugin to use the <code>GnupgSignatory</code> instead of the default <a href="../javadoc/org/gradle/plugins/signing/signatory/pgp/PgpSignatory.html">PgpSignatory</a>. The <code>GnupgSignatory</code> relies on the gpg2 program to sign the artifacts. Of course, this requires that GnuPG is installed.</p>
</div>
<div class="paragraph">
<p>Without any further configuration the <code>gpg2</code> (on Windows: <code>gpg2.exe</code>) executable found on the <code>PATH</code> will be used. The password is supplied by the <code>gpg-agent</code> and the default key is used for signing.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:sec:gnupg_signatory_configuration"><a class="anchor" href="#sec:sec:gnupg_signatory_configuration"></a><a class="link" href="#sec:sec:gnupg_signatory_configuration">Gnupg signatory configuration</a></h5>
<div class="paragraph">
<p>The <code>GnupgSignatory</code> supports a number of configuration options for controlling how gpg is invoked. These are typically set in gradle.properties:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configure_the_gnupgsignatory"><a class="anchor" href="#example_configure_the_gnupgsignatory"></a><a class="link" href="#example_configure_the_gnupgsignatory">Example: Configure the GnupgSignatory</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">signing.gnupg.executable=gpg
signing.gnupg.useLegacyGpg=<span class="predefined-constant">true</span>
signing.gnupg.homeDir=gnupg-home
signing.gnupg.optionsFile=gnupg-home/gpg.conf
signing.gnupg.keyName=<span class="float">24875D</span><span class="integer">73</span>
signing.gnupg.passphrase=gradle</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>signing.gnupg.executable</code></dt>
<dd>
<p>The gpg executable that is invoked for signing. The default value of this property depends on <code>useLegacyGpg</code>. If that is <code>true</code> then the default value of executable is "gpg" otherwise it is "gpg2".</p>
</dd>
<dt class="hdlist1"><code>signing.gnupg.useLegacyGpg</code></dt>
<dd>
<p>Must be <code>true</code> if GnuPG version 1 is used and <code>false</code> otherwise. The default value of the property is <code>false</code>.</p>
</dd>
<dt class="hdlist1"><code>signing.gnupg.homeDir</code></dt>
<dd>
<p>Sets the home directory for GnuPG. If not given the default home directory of GnuPG is used.</p>
</dd>
<dt class="hdlist1"><code>signing.gnupg.optionsFile</code></dt>
<dd>
<p>Sets a custom options file for GnuPG. If not given GnuPG&#8217;s default configuration file is used.</p>
</dd>
<dt class="hdlist1"><code>signing.gnupg.keyName</code></dt>
<dd>
<p>The id of the key that should be used for signing. If not given then the default key configured in GnuPG will be used.</p>
</dd>
<dt class="hdlist1"><code>signing.gnupg.passphrase</code></dt>
<dd>
<p>The passphrase for unlocking the secret key. If not given then the gpg-agent program is used for getting the passphrase.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>All configuration properties are optional.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:specifying_what_to_sign"><a class="anchor" href="#sec:specifying_what_to_sign"></a><a class="link" href="#sec:specifying_what_to_sign">Specifying what to sign</a></h4>
<div class="paragraph">
<p>As well as configuring how things are to be signed (i.e. the signatory configuration), you must also specify what is to be signed. The Signing Plugin provides a DSL that allows you to specify the tasks and/or configurations that should be signed.</p>
</div>
<div class="sect4">
<h5 id="sec:signing_publications"><a class="anchor" href="#sec:signing_publications"></a><a class="link" href="#sec:signing_publications">Signing Publications</a></h5>
<div class="paragraph">
<p>When publishing artifacts, you often want to sign them so the consumer of your artifacts can verify their signature. For example, the <a href="#java_plugin">Java plugin</a> defines a component that you can use to define a publication to a Maven (or Ivy) repository using the <a href="#publishing_maven">Maven Publish Plugin</a> (or the <a href="#publishing_ivy">Ivy Publish Plugin</a>, respectively). Using the Signing DSL, you can specify that all of the artifacts of this publication should be signed.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_signing_a_publication_2"><a class="anchor" href="#example_signing_a_publication_2"></a><a class="link" href="#example_signing_a_publication_2">Example: Signing a publication</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">signing {
    sign publishing.publications.mavenJava
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create a task (of type <a href="../dsl/org.gradle.plugins.signing.Sign.html">Sign</a>) in your project named <code>signMavenJavaPublication</code> that will build all artifacts that are part of the publication (if needed) and then generate signatures for them. The signature files will be placed alongside the artifacts being signed.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_signing_a_publication_output"><a class="anchor" href="#example_signing_a_publication_output"></a><a class="link" href="#example_signing_a_publication_output">Example: Signing a publication output</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle signMavenJavaPublication</code></strong></div>
<div class="content">
<pre>&gt; gradle signMavenJavaPublication
&gt; Task :generatePomFileForMavenJavaPublication
&gt; Task :compileJava
&gt; Task :processResources
&gt; Task :classes
&gt; Task :jar
&gt; Task :javadoc
&gt; Task :javadocJar
&gt; Task :sourcesJar
&gt; Task :signMavenJavaPublication

BUILD SUCCESSFUL in 0s
8 actionable tasks: 8 executed</pre>
</div>
</div>
<div class="paragraph">
<p>In addition, the above DSL allows to <code>sign</code> multiple comma-separated publications. Alternatively, you may specify <code>publishing.publications</code> to sign all publications, or use <code>publishing.publications.matching {  }</code> to sign all publications that match the specified predicate.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:signing_configurations"><a class="anchor" href="#sec:signing_configurations"></a><a class="link" href="#sec:signing_configurations">Signing Configurations</a></h5>
<div class="paragraph">
<p>It is common to want to sign the artifacts of a configuration. For example, the <a href="#java_plugin">Java plugin</a> configures a jar to build and this jar artifact is added to the <code>archives</code> configuration. Using the Signing DSL, you can specify that all of the artifacts of this configuration should be signed.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_signing_a_configuration"><a class="anchor" href="#example_signing_a_configuration"></a><a class="link" href="#example_signing_a_configuration">Example: Signing a configuration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">signing {
    sign configurations.archives
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create a task (of type <a href="../dsl/org.gradle.plugins.signing.Sign.html">Sign</a>) in your project named <code>signArchives</code>, that will build any <code>archives</code> artifacts (if needed) and then generate signatures for them. The signature files will be placed alongside the artifacts being signed.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_signing_a_configuration_output"><a class="anchor" href="#example_signing_a_configuration_output"></a><a class="link" href="#example_signing_a_configuration_output">Example: Signing a configuration output</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle signArchives</code></strong></div>
<div class="content">
<pre>&gt; gradle signArchives
&gt; Task :compileJava
&gt; Task :processResources
&gt; Task :classes
&gt; Task :jar
&gt; Task :signArchives

BUILD SUCCESSFUL in 0s
4 actionable tasks: 4 executed</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:signing_tasks"><a class="anchor" href="#sec:signing_tasks"></a><a class="link" href="#sec:signing_tasks">Signing Tasks</a></h5>
<div class="paragraph">
<p>In some cases the artifact that you need to sign may not be part of a configuration. In this case you can directly sign the task that produces the artifact to sign.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_signing_a_task"><a class="anchor" href="#example_signing_a_task"></a><a class="link" href="#example_signing_a_task">Example: Signing a task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task stuffZip (<span class="key">type</span>: Zip) {
    baseName = <span class="string"><span class="delimiter">&quot;</span><span class="content">stuff</span><span class="delimiter">&quot;</span></span>
    from <span class="string"><span class="delimiter">&quot;</span><span class="content">src/stuff</span><span class="delimiter">&quot;</span></span>
}

signing {
    sign stuffZip
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create a task (of type <a href="../dsl/org.gradle.plugins.signing.Sign.html">Sign</a>) in your project named <code>signStuffZip</code>, that will build the input task&#8217;s archive (if needed) and then sign it. The signature file will be placed alongside the artifact being signed.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_signing_a_task_output"><a class="anchor" href="#example_signing_a_task_output"></a><a class="link" href="#example_signing_a_task_output">Example: Signing a task output</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle signStuffZip</code></strong></div>
<div class="content">
<pre>&gt; gradle signStuffZip
&gt; Task :stuffZip
&gt; Task :signStuffZip

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>For a task to be <em>signable</em>, it must produce an archive of some type, i.e. it must extend <a href="../dsl/org.gradle.api.tasks.bundling.AbstractArchiveTask.html">AbstractArchiveTask</a>. Tasks that do this are the <a href="../dsl/org.gradle.api.tasks.bundling.Tar.html">Tar</a>, <a href="../dsl/org.gradle.api.tasks.bundling.Zip.html">Zip</a>, <a href="../dsl/org.gradle.api.tasks.bundling.Jar.html">Jar</a>, <a href="../dsl/org.gradle.api.tasks.bundling.War.html">War</a> and <a href="../dsl/org.gradle.plugins.ear.Ear.html">Ear</a> tasks.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:conditional_signing"><a class="anchor" href="#sec:conditional_signing"></a><a class="link" href="#sec:conditional_signing">Conditional Signing</a></h5>
<div class="paragraph">
<p>A common usage pattern is to require the signing of build artifacts only under certain conditions. For example, you may not need to sign artifacts for non-release versions. To achieve this, you can specify the condition as an argument of the <code>required()</code> method.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_specifying_when_signing_is_required"><a class="anchor" href="#example_specifying_when_signing_is_required"></a><a class="link" href="#example_specifying_when_signing_is_required">Example: Specifying when signing is required</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">version = <span class="string"><span class="delimiter">'</span><span class="content">1.0-SNAPSHOT</span><span class="delimiter">'</span></span>
ext.isReleaseVersion = !version.endsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">SNAPSHOT</span><span class="delimiter">&quot;</span></span>)

signing {
    required { isReleaseVersion &amp;&amp; gradle.taskGraph.hasTask(<span class="string"><span class="delimiter">&quot;</span><span class="content">uploadArchives</span><span class="delimiter">&quot;</span></span>) }
    sign configurations.archives
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, we only want to require signing if we are building a release version and we are going to publish it. Because we are inspecting the task graph to determine if we are going to be publishing, we must set the <code>signing.required</code> property to a closure to defer the evaluation. See <a href="../javadoc/org/gradle/plugins/signing/SigningExtension.html#setRequired-java.lang.Object-">SigningExtension.setRequired(java.lang.Object)</a> for more information.</p>
</div>
<div class="paragraph">
<p>If the <code>required</code> condition does not hold true, artifacts will only be signed if signatory credentials are configured. Alternatively, you may want to skip signing entirely whether or not signatory credentials are available. If so, you can configure the <a href="../dsl/org.gradle.plugins.signing.Sign.html">Sign</a> tasks to be skipped, for example by attaching a predicate using the <code>onlyIf()</code> method shown in the following example:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_specifying_when_signing_is_skipped"><a class="anchor" href="#example_specifying_when_signing_is_skipped"></a><a class="link" href="#example_specifying_when_signing_is_skipped">Example: Specifying when signing is skipped</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.withType(Sign) {
    onlyIf { isReleaseVersion }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:publishing_the_signatures"><a class="anchor" href="#sec:publishing_the_signatures"></a><a class="link" href="#sec:publishing_the_signatures">Publishing the signatures</a></h4>
<div class="paragraph">
<p>When signing <a href="#sec:signing_publications">publications</a>, the resultant signature artifacts are automatically added to the corresponding publication. Thus, when publishing to a repository, e.g. by executing the <code>publish</code> task, your signatures will be distributed along with the other artifacts without any additional configuration.</p>
</div>
<div class="paragraph">
<p>When signing <a href="#sec:signing_configurations">configurations</a> and <a href="#sec:signing_tasks">tasks</a>, the resultant signature artifacts are automatically added to the <code>signatures</code> and <code>archives</code> dependency configurations. This means that if you want to upload your signatures to your distribution repository along with the artifacts you simply execute the <code>uploadArchives</code> task.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:signing_pom_files"><a class="anchor" href="#sec:signing_pom_files"></a><a class="link" href="#sec:signing_pom_files">Signing POM files</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This section covers signing POM files for the <em>original</em> publishing mechanism available in Gradle 1.0.
The POM file generated by the <em>new</em> Maven publishing support provided by the <a href="#publishing_maven">Maven Publishing plugin</a> is automatically signed if the corresponding publication is <a href="#sec:signing_publications">specified to be signed</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When deploying signatures for your artifacts to a Maven repository, you will also want to sign the published POM file. The Signing Plugin adds a <code>signing.signPom()</code> (see <a href="../dsl/org.gradle.plugins.signing.SigningExtension.html#org.gradle.plugins.signing.SigningExtension:signPom(org.gradle.api.artifacts.maven.MavenDeployment,%20groovy.lang.Closure)">SigningExtension.signPom(org.gradle.api.artifacts.maven.MavenDeployment, groovy.lang.Closure)</a>) method that can be used in the <code>beforeDeployment()</code> block in your upload task configuration.</p>
</div>
<div class="sect4">
<h5 id="example_signing_a_pom_for_deployment"><a class="anchor" href="#example_signing_a_pom_for_deployment"></a><a class="link" href="#example_signing_a_pom_for_deployment">Example: Signing a POM for deployment</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">uploadArchives {
    repositories {
        mavenDeployer {
            beforeDeployment { MavenDeployment deployment -&gt; signing.signPom(deployment) }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When signing is not required and the POM cannot be signed due to insufficient configuration (i.e. no credentials for signing) then the <code>signPom()</code> method will silently do nothing.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="distribution_plugin"><a class="anchor" href="#distribution_plugin"></a><a class="link" href="#distribution_plugin">The Distribution Plugin</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The Distribution Plugin is currently <a href="#feature_lifecycle">incubating</a>. Please be aware that the DSL and other configuration may change in later Gradle versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Distribution Plugin facilitates building archives that serve as distributions of the project. Distribution archives typically contain the executable application and other supporting files, such as documentation.</p>
</div>
<div class="sect3">
<h4 id="sec:distribution_usage"><a class="anchor" href="#sec:distribution_usage"></a><a class="link" href="#sec:distribution_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Distribution Plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_distribution_plugin"><a class="anchor" href="#example_using_the_distribution_plugin"></a><a class="link" href="#example_using_the_distribution_plugin">Example: Using the Distribution Plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">distribution</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The plugin adds an extension named <code>distributions</code> of type <a href="../dsl/org.gradle.api.distribution.DistributionContainer.html">DistributionContainer</a> to the project. It also creates a single distribution in the distributions container extension named <code>main</code>. If your build only produces one distribution you only need to configure this distribution (or use the defaults).</p>
</div>
<div class="paragraph">
<p>You can run <code>gradle distZip</code> to package the main distribution as a ZIP, or <code>gradle distTar</code> to create a TAR file. To build both types of archives just run <code>gradle assembleDist</code>. The files will be created at <code><em>$buildDir</em>/distributions/<em>${project.name}</em>-<em>${project.version}</em>.<em>ext</em></code>.</p>
</div>
<div class="paragraph">
<p>You can run <code>gradle installDist</code> to assemble the uncompressed distribution into <code><em>$buildDir</em>/install/<em>${project.name}</em></code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:distribution_tasks"><a class="anchor" href="#sec:distribution_tasks"></a><a class="link" href="#sec:distribution_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Distribution Plugin adds a number of tasks to your project, as shown below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>distZip</code>  <a href="../dsl/org.gradle.api.tasks.bundling.Zip.html">Zip</a></dt>
<dd>
<p>Creates a ZIP archive of the distribution contents.</p>
</dd>
<dt class="hdlist1"><code>distTar</code>  <a href="../dsl/org.gradle.api.Task.html">Task</a></dt>
<dd>
<p>Creates a TAR archive of the distribution contents.</p>
</dd>
<dt class="hdlist1"><code>assembleDist</code>  <a href="../dsl/org.gradle.api.Task.html">Task</a></dt>
<dd>
<p><em>Depends on</em>: <code>distTar</code>, <code>distZip</code></p>
<div class="paragraph">
<p>Creates ZIP and TAR archives of the distribution contents.</p>
</div>
</dd>
<dt class="hdlist1"><code>installDist</code>  <a href="../dsl/org.gradle.api.tasks.Sync.html">Sync</a></dt>
<dd>
<p>Assembles the distribution content and installs it on the current machine.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For each additional distribution you add to the project, the Distribution Plugin adds the following tasks, where <em>distributionName</em> comes from <a href="../javadoc/org/gradle/api/distribution/Distribution.html#getName--">Distribution.getName()</a>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><em>distributionName</em>DistZip</code>  <a href="../dsl/org.gradle.api.tasks.bundling.Zip.html">Zip</a></dt>
<dd>
<p>Creates a ZIP archive of the distribution contents.</p>
</dd>
<dt class="hdlist1"><code><em>distributionName</em>DistTar</code>  <a href="../dsl/org.gradle.api.tasks.bundling.Tar.html">Tar</a></dt>
<dd>
<p>Creates a TAR archive of the distribution contents.</p>
</dd>
<dt class="hdlist1"><code>assemble<em>DistributionName</em>Dist</code>  <a href="../dsl/org.gradle.api.Task.html">Task</a></dt>
<dd>
<p><em>Depends on</em>: <code><em>distributionName</em>DistTar</code>, <code><em>distributionName</em>DistZip</code></p>
<div class="paragraph">
<p>Creates ZIP and TAR archives of the distribution contents.</p>
</div>
</dd>
<dt class="hdlist1"><code>install<em>DistributionName</em>Dist</code>  <a href="../dsl/org.gradle.api.tasks.Sync.html">Sync</a></dt>
<dd>
<p>Assembles the distribution content and installs it on the current machine.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following sample creates a <code>custom</code> distribution that will cause four additional tasks to be added to the project: <code>customDistZip</code>, <code>customDistTar</code>, <code>assembleCustomDist</code>, and <code>installCustomDist</code>:</p>
</div>
<div class="sect4">
<h5 id="example_adding_extra_distributions"><a class="anchor" href="#example_adding_extra_distributions"></a><a class="link" href="#example_adding_extra_distributions">Example: Adding extra distributions</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">distributions {
    custom {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Given that the project name is <code>myproject</code> and version <code>1.2</code>, running <code>gradle customDistZip</code> will produce a ZIP file named <code>myproject-custom-1.2.zip</code>.</p>
</div>
<div class="paragraph">
<p>Running <code>gradle installCustomDist</code> will install the distribution contents into <code><em>$buildDir</em>/install/custom</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:distribution_contents"><a class="anchor" href="#sec:distribution_contents"></a><a class="link" href="#sec:distribution_contents">Distribution contents</a></h4>
<div class="paragraph">
<p>All of the files in the <code>src/<em>$distribution.name</em>/dist</code> directory will automatically be included in the distribution. You can add additional files by configuring the <a href="../javadoc/org/gradle/api/distribution/Distribution.html">Distribution</a> object that is part of the container.</p>
</div>
<div class="sect4">
<h5 id="example_configuring_the_main_distribution"><a class="anchor" href="#example_configuring_the_main_distribution"></a><a class="link" href="#example_configuring_the_main_distribution">Example: Configuring the main distribution</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">distributions {
    main {
        baseName = <span class="string"><span class="delimiter">'</span><span class="content">someName</span><span class="delimiter">'</span></span>
        contents {
            from { <span class="string"><span class="delimiter">'</span><span class="content">src/readme</span><span class="delimiter">'</span></span> }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, the content of the <code>src/readme</code> directory will be included in the distribution (along with the files in the <code>src/main/dist</code> directory which are added by default).</p>
</div>
<div class="paragraph">
<p>The <code>baseName</code> property has also been changed. This will cause the distribution archives to be created with a different name.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:publishing_distributions"><a class="anchor" href="#sec:publishing_distributions"></a><a class="link" href="#sec:publishing_distributions">Publishing</a></h4>
<div class="paragraph">
<p>A distribution can be published using the <a href="#publishing_ivy">Ivy Publish Plugin</a> or <a href="#publishing_maven">Maven Publish Plugin</a>, or via the <em>original</em> publishing mechanism using the <code>uploadArchives</code> task.</p>
</div>
<div class="sect4">
<h5 id="sec:publishing_distributions_publish_plugins"><a class="anchor" href="#sec:publishing_distributions_publish_plugins"></a><a class="link" href="#sec:publishing_distributions_publish_plugins">Using the Ivy/Maven Publish Plugins</a></h5>
<div class="paragraph">
<p>To publish a distribution to an Ivy repository with the <a href="#publishing_ivy">Ivy Publish Plugin</a>, simply add one or both of its archive tasks to an <a href="../dsl/org.gradle.api.publish.ivy.IvyPublication.html">IvyPublication</a>. The following sample demonstrates how to add the ZIP archive of the <code>main</code> distribution and the TAR archive of the <code>custom</code> distribution to the <code>myDistribution</code> publication:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_distribution_archives_to_an_ivy_publication"><a class="anchor" href="#example_adding_distribution_archives_to_an_ivy_publication"></a><a class="link" href="#example_adding_distribution_archives_to_an_ivy_publication">Example: Adding distribution archives to an Ivy publication</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">ivy-publish</span><span class="delimiter">'</span></span>

publishing {
    publications {
        myDistribution(IvyPublication) {
            artifact distZip
            artifact customDistTar
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, to publish a distribution to a Maven repository using the <a href="#publishing_maven">Maven Publish Plugin</a>, add one or both of its archive tasks to a <a href="../dsl/org.gradle.api.publish.maven.MavenPublication.html">MavenPublication</a> as follows:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_distribution_archives_to_a_maven_publication"><a class="anchor" href="#example_adding_distribution_archives_to_a_maven_publication"></a><a class="link" href="#example_adding_distribution_archives_to_a_maven_publication">Example: Adding distribution archives to a Maven publication</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">maven-publish</span><span class="delimiter">'</span></span>

publishing {
    publications {
        myDistribution(MavenPublication) {
            artifact distZip
            artifact customDistTar
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:publishing_distributions_upload"><a class="anchor" href="#sec:publishing_distributions_upload"></a><a class="link" href="#sec:publishing_distributions_upload">Using the <code>uploadArchives</code> task</a></h5>
<div class="paragraph">
<p>The Distribution Plugin adds the distribution archives as default publishing artifact candidates. With the <a href="#maven_plugin">Maven Plugin</a> applied, the distribution ZIP file will be published when running <code>uploadArchives</code> if no other default artifact is configured.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_publishing_the_distribution_zip_with_the_maven_plugin"><a class="anchor" href="#example_publishing_the_distribution_zip_with_the_maven_plugin"></a><a class="link" href="#example_publishing_the_distribution_zip_with_the_maven_plugin">Example: Publishing the distribution ZIP with the Maven Plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>:<span class="string"><span class="delimiter">'</span><span class="content">maven</span><span class="delimiter">'</span></span>

uploadArchives {
    repositories {
        mavenDeployer {
            repository(<span class="key">url</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://some/repo</span><span class="delimiter">&quot;</span></span>)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="native_projects"><a class="anchor" href="#native_projects"></a><a class="link" href="#native_projects">Native Projects</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="native_software"><a class="anchor" href="#native_software"></a><a class="link" href="#native_software">Building native software</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Support for building native software is currently <a href="#feature_lifecycle">incubating</a>. Please be aware that the DSL, APIs and other configuration may change in later Gradle versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The native software plugins add support for building native software components, such as executables or shared libraries, from code written in C++, C and other languages. While many excellent build tools exist for this space of software development, Gradle offers developers its trademark power and flexibility together with dependency management practices more traditionally found in the JVM development space.</p>
</div>
<div class="paragraph">
<p>The native software plugins make use of the Gradle <a href="#software_model">software model</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:native_features"><a class="anchor" href="#sec:native_features"></a><a class="link" href="#sec:native_features">Features</a></h4>
<div class="paragraph">
<p>The native software plugins provide:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for building native libraries and applications on Windows, Linux, macOS and other platforms.</p>
</li>
<li>
<p>Support for several source languages.</p>
</li>
<li>
<p>Support for building different variants of the same software, for different architectures, operating systems, or for any purpose.</p>
</li>
<li>
<p>Incremental parallel compilation, precompiled headers.</p>
</li>
<li>
<p>Dependency management between native software components.</p>
</li>
<li>
<p>Unit test execution.</p>
</li>
<li>
<p>Generate Visual studio solution and project files.</p>
</li>
<li>
<p>Deep integration with various tool chain, including discovery of installed tool chains.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:supported_languages"><a class="anchor" href="#sec:supported_languages"></a><a class="link" href="#sec:supported_languages">Supported languages</a></h4>
<div class="paragraph">
<p>The following source languages are currently supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>C</p>
</li>
<li>
<p>C++</p>
</li>
<li>
<p>Objective-C</p>
</li>
<li>
<p>Objective-C++</p>
</li>
<li>
<p>Assembly</p>
</li>
<li>
<p>Windows resources</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="native-binaries:tool-chain-support"><a class="anchor" href="#native-binaries:tool-chain-support"></a><a class="link" href="#native-binaries:tool-chain-support">Tool chain support</a></h4>
<div class="paragraph">
<p>Gradle offers the ability to execute the same build using different tool chains. When you build a native binary, Gradle will attempt to locate a tool chain installed on your machine that can build the binary. You can fine tune exactly how this works, see <a href="#native_binaries:tool_chain">Tool chain support</a> for details.</p>
</div>
<div class="paragraph">
<p>The following tool chains are supported:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operating System</th>
<th class="tableblock halign-left valign-top">Tool Chain</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://gcc.gnu.org/">GCC</a></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://clang.llvm.org">Clang</a></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">macOS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses the Clang tool chain bundled with XCode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://visualstudio.microsoft.com/">Visual C++</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows XP and later, Visual C++ 2010/2012/2013/2015/2017.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://gcc.gnu.org/">GCC</a> with <a href="http://cygwin.com">Cygwin 32</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows XP and later.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://gcc.gnu.org/">GCC</a> with <a href="http://www.mingw.org/">MinGW</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows XP and later. <a href="http://mingw-w64.sourceforge.net">Mingw-w64</a> is currently not supported.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following tool chains are unofficially supported. They generally work fine, but are not tested continuously:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operating System</th>
<th class="tableblock halign-left valign-top">Tool Chain</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">macOS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://gcc.gnu.org/">GCC</a> from Macports</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">macOS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://clang.llvm.org">Clang</a> from Macports</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://gcc.gnu.org/">GCC</a> with <a href="http://cygwin.com">Cygwin 64</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows XP and later.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNIX-like</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://gcc.gnu.org/">GCC</a></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNIX-like</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://clang.llvm.org">Clang</a></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:tool_chain_installation"><a class="anchor" href="#sec:tool_chain_installation"></a><a class="link" href="#sec:tool_chain_installation">Tool chain installation</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Note that if you are using GCC then you currently need to install support for C++, even if you are not building from C++ source. This restriction will be removed in a future Gradle version.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To build native software, you will need to have a compatible tool chain installed:</p>
</div>
<div class="sect4">
<h5 id="sec:windows"><a class="anchor" href="#sec:windows"></a><a class="link" href="#sec:windows">Windows</a></h5>
<div class="paragraph">
<p>To build on Windows, install a compatible version of Visual Studio. The native plugins will discover the Visual Studio installations and select the latest version. There is no need to mess around with environment variables or batch scripts. This works fine from a Cygwin shell or the Windows command-line.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can install Cygwin with GCC or MinGW. Clang is currently not supported.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:macOS"><a class="anchor" href="#sec:macOS"></a><a class="link" href="#sec:macOS">macOS</a></h5>
<div class="paragraph">
<p>To build on macOS, you should install XCode. The native plugins will discover the XCode installation using the system PATH.</p>
</div>
<div class="paragraph">
<p>The native plugins also work with GCC and Clang bundled with Macports. To use one of the Macports tool chains, you will need to make the tool chain the default using the <code>port select</code> command and add Macports to the system PATH.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:linux"><a class="anchor" href="#sec:linux"></a><a class="link" href="#sec:linux">Linux</a></h5>
<div class="paragraph">
<p>To build on Linux, install a compatible version of GCC or Clang. The native plugins will discover GCC or Clang using the system PATH.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:native_software_model"><a class="anchor" href="#sec:native_software_model"></a><a class="link" href="#sec:native_software_model">Native software model</a></h4>
<div class="paragraph">
<p>The native software model builds on the base Gradle <a href="#software_model_concepts">software model</a>.</p>
</div>
<div class="paragraph">
<p>To build native software using Gradle, your project should define one or more <em>native components</em>. Each component represents either an executable or a library that Gradle should build. A project can define any number of components. Gradle does not define any components by default.</p>
</div>
<div class="paragraph">
<p>For each component, Gradle defines a <em>source set</em> for each language that the component can be built from. A source set is essentially just a set of source directories containing source files. For example, when you apply the <code>c</code> plugin and define a library called <code>helloworld</code>, Gradle will define, by default, a source set containing the C source files in the <code>src/helloworld/c</code> directory. It will use these source files to build the <code>helloworld</code> library. This is described in more detail below.</p>
</div>
<div class="paragraph">
<p>For each component, Gradle defines one or more <em>binaries</em> as output. To build a binary, Gradle will take the source files defined for the component, compile them as appropriate for the source language, and link the result into a binary file. For an executable component, Gradle can produce executable binary files. For a library component, Gradle can produce both static and shared library binary files. For example, when you define a library called <code>helloworld</code> and build on Linux, Gradle will, by default, produce <code>libhelloworld.so</code> and <code>libhelloworld.a</code> binaries.</p>
</div>
<div class="paragraph">
<p>In many cases, more than one binary can be produced for a component. These binaries may vary based on the tool chain used to build, the compiler/linker flags supplied, the dependencies provided, or additional source files provided. Each native binary produced for a component is referred to as a <em>variant</em>. Binary variants are discussed in detail below.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:parallel_compilation"><a class="anchor" href="#sec:parallel_compilation"></a><a class="link" href="#sec:parallel_compilation">Parallel Compilation</a></h4>
<div class="paragraph">
<p>Gradle uses the single build worker pool to concurrently compile and link native components, by default. No special configuration is required to enable concurrent building.</p>
</div>
<div class="paragraph">
<p>By default, the worker pool size is determined by the number of available processors on the build machine (as reported to the build JVM). To explicitly set the number of workers use the <code>--max-workers</code> command-line option or <code>org.gradle.workers.max</code> system property. There is generally no need to change this setting from its default.</p>
</div>
<div class="paragraph">
<p>The build worker pool is shared across all build tasks. This means that when using <a href="#sec:parallel_execution">parallel project execution</a>, the maximum number of concurrent individual compilation operations does not increase. For example, if the build machine has 4 processing cores and 10 projects are compiling in parallel, Gradle will only use 4 total workers, not 40.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_a_library"><a class="anchor" href="#sec:building_a_library"></a><a class="link" href="#sec:building_a_library">Building a library</a></h4>
<div class="paragraph">
<p>To build either a static or shared native library, you define a library component in the <code>components</code> container. The following sample defines a library called <code>hello</code>:</p>
</div>
<div class="sect4">
<h5 id="example_defining_a_library_component"><a class="anchor" href="#example_defining_a_library_component"></a><a class="link" href="#example_defining_a_library_component">Example: Defining a library component</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        hello(NativeLibrarySpec)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A library component is represented using <a href="../javadoc/org/gradle/nativeplatform/NativeLibrarySpec.html">NativeLibrarySpec</a>. Each library component can produce at least one shared library binary (<a href="../javadoc/org/gradle/nativeplatform/SharedLibraryBinarySpec.html">SharedLibraryBinarySpec</a>) and at least one static library binary (<a href="../javadoc/org/gradle/nativeplatform/StaticLibraryBinarySpec.html">StaticLibraryBinarySpec</a>).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_an_executable"><a class="anchor" href="#sec:building_an_executable"></a><a class="link" href="#sec:building_an_executable">Building an executable</a></h4>
<div class="paragraph">
<p>To build a native executable, you define an executable component in the <code>components</code> container. The following sample defines an executable called <code>main</code>:</p>
</div>
<div class="sect4">
<h5 id="example_defining_executable_components"><a class="anchor" href="#example_defining_executable_components"></a><a class="link" href="#example_defining_executable_components">Example: Defining executable components</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        main(NativeExecutableSpec) {
            sources {
               c.lib <span class="key">library</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An executable component is represented using <a href="../javadoc/org/gradle/nativeplatform/NativeExecutableSpec.html">NativeExecutableSpec</a>. Each executable component can produce at least one executable binary (<a href="../javadoc/org/gradle/nativeplatform/NativeExecutableBinarySpec.html">NativeExecutableBinarySpec</a>).</p>
</div>
<div class="paragraph">
<p>For each component defined, Gradle adds a <a href="../javadoc/org/gradle/language/base/FunctionalSourceSet.html">FunctionalSourceSet</a> with the same name. Each of these functional source sets will contain a language-specific source set for each of the languages supported by the project.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:dependents"><a class="anchor" href="#sec:dependents"></a><a class="link" href="#sec:dependents">Assembling or building dependents</a></h4>
<div class="paragraph">
<p>Sometimes, you may need to <em>assemble</em> (compile and link) or <em>build</em> (compile, link and test) a component or binary and its <em>dependents</em> (things that depend upon the component or binary). The native software model provides tasks that enable this capability. First, the <em>dependent components</em> report gives insight about the relationships between each component. Second, the <em>build and assemble dependents</em> tasks allow you to assemble or build a component and its dependents in one step.</p>
</div>
<div class="paragraph">
<p>In the following example, the build file defines <code>OpenSSL</code> as a dependency of <code>libUtil</code> and <code>libUtil</code> as a dependency of <code>LinuxApp</code> and <code>WindowsApp</code>. Test suites are treated similarly. Dependents can be thought of as reverse dependencies.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/nativeDependents.png" alt="nativeDependents">
</div>
<div class="title">Figure 24. Dependent Components Example</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>By following the dependencies backwards, you can see <code>LinuxApp</code> and <code>WindowsApp</code> are <em>dependents</em> of <code>libUtil</code>. When <code>libUtil</code> is changed, Gradle will need to recompile or relink <code>LinuxApp</code> and <code>WindowsApp</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you <em>assemble</em> dependents of a component, the component and all of its dependents are compiled and linked, including any test suite binaries. Gradle&#8217;s up-to-date checks are used to only compile or link if something has changed. For instance, if you have changed source files in a way that do not affect the headers of your project, Gradle will be able to skip compilation for dependent components and only need to re-link with the new library. Tests are not run when assembling a component.</p>
</div>
<div class="paragraph">
<p>When you <em>build</em> dependents of a component, the component and all of its dependent binaries are compiled, linked <em>and checked</em>. Checking components means running any <a href="#sec:check_tasks">check task</a> including executing any test suites, so tests <em>are</em> run when building a component.</p>
</div>
<div class="paragraph">
<p>In the following sections, we will demonstrate the usage of the <code>assembleDependents*</code>, <code>buildDependents*</code> and <code>dependentComponents</code> tasks with a sample build that contains a CUnit test suite. The build script for the sample is the following:</p>
</div>
<div class="sect4">
<h5 id="example_sample_build"><a class="anchor" href="#example_sample_build"></a><a class="link" href="#example_sample_build">Example: Sample build</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">c</span><span class="delimiter">&quot;</span></span>
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">cunit-test-suite</span><span class="delimiter">'</span></span>

model {
    flavors {
        passing
        failing
    }
    platforms {
        x86 {
            architecture <span class="string"><span class="delimiter">&quot;</span><span class="content">x86</span><span class="delimiter">&quot;</span></span>
        }
    }
    components {
        operators(NativeLibrarySpec) {
            targetPlatform <span class="string"><span class="delimiter">&quot;</span><span class="content">x86</span><span class="delimiter">&quot;</span></span>
        }
    }
    testSuites {
        operatorsTest(CUnitTestSuiteSpec) {
            testing <span class="error">$</span>.components.operators
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/native-binaries/cunit</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:dependents_report"><a class="anchor" href="#sec:dependents_report"></a><a class="link" href="#sec:dependents_report">Dependent components report</a></h5>
<div class="paragraph">
<p>Gradle provides a report that you can run from the command-line that shows a graph of components in your project and components that depend upon them. The following is an example of running <code>gradle dependentComponents</code> on the sample project:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_dependent_components_report"><a class="anchor" href="#example_dependent_components_report"></a><a class="link" href="#example_dependent_components_report">Example: Dependent components report</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle dependentComponents</code></strong></div>
<div class="content">
<pre>&gt; gradle dependentComponents

&gt; Task :dependentComponents

------------------------------------------------------------
Root project
------------------------------------------------------------

operators - Components that depend on native library 'operators'
+--- operators:failingSharedLibrary
+--- operators:failingStaticLibrary
+--- operators:passingSharedLibrary
\--- operators:passingStaticLibrary

Some test suites were not shown, use --test-suites or --all to show them.

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>See <a href="../dsl/org.gradle.api.reporting.dependents.DependentComponentsReport.html">DependentComponentsReport</a> API documentation for more details.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, non-buildable binaries and test suites are hidden from the report. The <code>dependentComponents</code> task provides options that allow you to see all dependents by using the <code>--all</code> option:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_dependent_components_report_2"><a class="anchor" href="#example_dependent_components_report_2"></a><a class="link" href="#example_dependent_components_report_2">Example: Dependent components report</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle dependentComponents --all</code></strong></div>
<div class="content">
<pre>&gt; gradle dependentComponents --all

&gt; Task :dependentComponents

------------------------------------------------------------
Root project
------------------------------------------------------------

operators - Components that depend on native library 'operators'
+--- operators:failingSharedLibrary
+--- operators:failingStaticLibrary
|    \--- operatorsTest:failingCUnitExe (t)
+--- operators:passingSharedLibrary
\--- operators:passingStaticLibrary
     \--- operatorsTest:passingCUnitExe (t)

operatorsTest - Components that depend on Cunit test suite 'operatorsTest'
+--- operatorsTest:failingCUnitExe (t)
\--- operatorsTest:passingCUnitExe (t)

(t) - Test suite binary

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Here is the corresponding report for the <code>operators</code> component, showing dependents of all its binaries:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_report_of_components_that_depends_on_the_operators_component"><a class="anchor" href="#example_report_of_components_that_depends_on_the_operators_component"></a><a class="link" href="#example_report_of_components_that_depends_on_the_operators_component">Example: Report of components that depends on the operators component</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle dependentComponents --component operators</code></strong></div>
<div class="content">
<pre>&gt; gradle dependentComponents --component operators

&gt; Task :dependentComponents

------------------------------------------------------------
Root project
------------------------------------------------------------

operators - Components that depend on native library 'operators'
+--- operators:failingSharedLibrary
+--- operators:failingStaticLibrary
+--- operators:passingSharedLibrary
\--- operators:passingStaticLibrary

Some test suites were not shown, use --test-suites or --all to show them.

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Here is the corresponding report for the <code>operators</code> component, showing dependents of all its binaries, including test suites:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_report_of_components_that_depends_on_the_operators_component_including_test_suites"><a class="anchor" href="#example_report_of_components_that_depends_on_the_operators_component_including_test_suites"></a><a class="link" href="#example_report_of_components_that_depends_on_the_operators_component_including_test_suites">Example: Report of components that depends on the operators component, including test suites</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle dependentComponents --test-suites --component operators</code></strong></div>
<div class="content">
<pre>&gt; gradle dependentComponents --test-suites --component operators

&gt; Task :dependentComponents

------------------------------------------------------------
Root project
------------------------------------------------------------

operators - Components that depend on native library 'operators'
+--- operators:failingSharedLibrary
+--- operators:failingStaticLibrary
|    \--- operatorsTest:failingCUnitExe (t)
+--- operators:passingSharedLibrary
\--- operators:passingStaticLibrary
     \--- operatorsTest:passingCUnitExe (t)

(t) - Test suite binary

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:assemble_dependents"><a class="anchor" href="#sec:assemble_dependents"></a><a class="link" href="#sec:assemble_dependents">Assembling dependents</a></h5>
<div class="paragraph">
<p>For each <a href="../javadoc/org/gradle/nativeplatform/NativeBinarySpec.html">NativeBinarySpec</a>, Gradle will create a task named <code>assembleDependents<em>${component.name}${binary.variant}</em></code> that <em>assembles</em> (compile and link) the binary and all of its dependent binaries.</p>
</div>
<div class="paragraph">
<p>For each <a href="../javadoc/org/gradle/nativeplatform/NativeComponentSpec.html">NativeComponentSpec</a>, Gradle will create a task named <code>assembleDependents<em>${component.name}</em></code> that <em>assembles</em> all the binaries of the component and all of their dependent binaries.</p>
</div>
<div class="paragraph">
<p>For example, to assemble the dependents of the "passing" flavor of the "static" library binary of the "operators" component, you would run the <code>assembleDependentsOperatorsPassingStaticLibrary</code> task:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_assemble_components_that_depends_on_the_passingstatic_binary_of_the_operators_component"><a class="anchor" href="#example_assemble_components_that_depends_on_the_passingstatic_binary_of_the_operators_component"></a><a class="link" href="#example_assemble_components_that_depends_on_the_passingstatic_binary_of_the_operators_component">Example: Assemble components that depends on the passing/static binary of the operators component</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle assembleDependentsOperatorsPassingStaticLibrary --max-workers=1</code></strong></div>
<div class="content">
<pre>&gt; gradle assembleDependentsOperatorsPassingStaticLibrary --max-workers=1
&gt; Task :compileOperatorsTestPassingCUnitExeOperatorsC
&gt; Task :operatorsTestCUnitLauncher
&gt; Task :compileOperatorsTestPassingCUnitExeOperatorsTestC
&gt; Task :compileOperatorsTestPassingCUnitExeOperatorsTestCunitLauncher
&gt; Task :linkOperatorsTestPassingCUnitExe
&gt; Task :operatorsTestPassingCUnitExe
&gt; Task :assembleDependentsOperatorsTestPassingCUnitExe
&gt; Task :compileOperatorsPassingStaticLibraryOperatorsC
&gt; Task :createOperatorsPassingStaticLibrary
&gt; Task :operatorsPassingStaticLibrary
&gt; Task :assembleDependentsOperatorsPassingStaticLibrary

BUILD SUCCESSFUL in 0s
7 actionable tasks: 7 executed</pre>
</div>
</div>
<div class="paragraph">
<p>In the output above, the targeted binary gets assembled as well as the test suite binary that depends on it.</p>
</div>
<div class="paragraph">
<p>You can also assemble <em>all</em> of the dependents of a component (i.e. of all its binaries/variants) using the corresponding component task, e.g. <code>assembleDependentsOperators</code>. This is useful if you have many combinations of build types, flavors and platforms and want to assemble all of them.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:build_dependents"><a class="anchor" href="#sec:build_dependents"></a><a class="link" href="#sec:build_dependents">Building dependents</a></h5>
<div class="paragraph">
<p>For each <a href="../javadoc/org/gradle/nativeplatform/NativeBinarySpec.html">NativeBinarySpec</a>, Gradle will create a task named <code>buildDependents<em>${component.name}${binary.variant}</em></code> that <em>builds</em> (compile, link and check) the binary and all of its dependent binaries.</p>
</div>
<div class="paragraph">
<p>For each <a href="../javadoc/org/gradle/nativeplatform/NativeComponentSpec.html">NativeComponentSpec</a>, Gradle will create a task named <code>buildDependents<em>${component.name}</em></code> that <em>builds</em> all the binaries of the component and all of their dependent binaries.</p>
</div>
<div class="paragraph">
<p>For example, to build the dependents of the "passing" flavor of the "static" library binary of the "operators" component, you would run the <code>buildDependentsOperatorsPassingStaticLibrary</code> task:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_build_components_that_depends_on_the_passingstatic_binary_of_the_operators_component"><a class="anchor" href="#example_build_components_that_depends_on_the_passingstatic_binary_of_the_operators_component"></a><a class="link" href="#example_build_components_that_depends_on_the_passingstatic_binary_of_the_operators_component">Example: Build components that depends on the passing/static binary of the operators component</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle buildDependentsOperatorsPassingStaticLibrary --max-workers=1</code></strong></div>
<div class="content">
<pre>&gt; gradle buildDependentsOperatorsPassingStaticLibrary --max-workers=1
&gt; Task :compileOperatorsTestPassingCUnitExeOperatorsC
&gt; Task :operatorsTestCUnitLauncher
&gt; Task :compileOperatorsTestPassingCUnitExeOperatorsTestC
&gt; Task :compileOperatorsTestPassingCUnitExeOperatorsTestCunitLauncher
&gt; Task :linkOperatorsTestPassingCUnitExe
&gt; Task :operatorsTestPassingCUnitExe
&gt; Task :installOperatorsTestPassingCUnitExe
&gt; Task :runOperatorsTestPassingCUnitExe
&gt; Task :checkOperatorsTestPassingCUnitExe
&gt; Task :buildDependentsOperatorsTestPassingCUnitExe
&gt; Task :compileOperatorsPassingStaticLibraryOperatorsC
&gt; Task :createOperatorsPassingStaticLibrary
&gt; Task :operatorsPassingStaticLibrary
&gt; Task :buildDependentsOperatorsPassingStaticLibrary

BUILD SUCCESSFUL in 0s
9 actionable tasks: 9 executed</pre>
</div>
</div>
<div class="paragraph">
<p>In the output above, the targeted binary as well as the test suite binary that depends on it are built and the test suite has run.</p>
</div>
<div class="paragraph">
<p>You can also build <em>all</em> of the dependents of a component (i.e. of all its binaries/variants) using the corresponding component task, e.g. <code>buildDependentsOperators</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:native_tasks"><a class="anchor" href="#sec:native_tasks"></a><a class="link" href="#sec:native_tasks">Tasks</a></h4>
<div class="paragraph">
<p>For each <a href="../javadoc/org/gradle/nativeplatform/NativeBinarySpec.html">NativeBinarySpec</a> that can be produced by a build, a single <em>lifecycle task</em> is constructed that can be used to create that binary, together with a set of other tasks that do the actual work of compiling, linking or assembling the binary.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><em>${component.name}</em>Executable</code></dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1">Component Type</dt>
<dd>
<p><a href="../javadoc/org/gradle/nativeplatform/NativeExecutableSpec.html">NativeExecutableSpec</a></p>
</dd>
<dt class="hdlist1">Native Binary Type</dt>
<dd>
<p><a href="../javadoc/org/gradle/nativeplatform/NativeExecutableBinarySpec.html">NativeExecutableBinarySpec</a></p>
</dd>
<dt class="hdlist1">Location of created binary</dt>
<dd>
<p><code><em>${project.buildDir}</em>/exe/<em>${component.name}</em>/<em>${component.name}</em></code></p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code><em>${component.name}</em>SharedLibrary</code></dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1">Component Type</dt>
<dd>
<p><a href="../javadoc/org/gradle/nativeplatform/NativeLibrarySpec.html">NativeLibrarySpec</a></p>
</dd>
<dt class="hdlist1">Native Binary Type</dt>
<dd>
<p><a href="../javadoc/org/gradle/nativeplatform/SharedLibraryBinarySpec.html">SharedLibraryBinarySpec</a></p>
</dd>
<dt class="hdlist1">Location of created binary</dt>
<dd>
<p><code><em>${project.buildDir}</em>/libs/<em>${component.name}</em>/shared/lib<em>${component.name}</em>.so</code></p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code><em>${component.name}</em>StaticLibrary</code></dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1">Component Type</dt>
<dd>
<p><a href="../javadoc/org/gradle/nativeplatform/NativeLibrarySpec.html">NativeLibrarySpec</a></p>
</dd>
<dt class="hdlist1">Native Binary Type</dt>
<dd>
<p><a href="../javadoc/org/gradle/nativeplatform/StaticLibraryBinarySpec.html">StaticLibraryBinarySpec</a></p>
</dd>
<dt class="hdlist1">Location of created binary</dt>
<dd>
<p><code><em>${project.buildDir}</em>/libs/<em>${component.name}</em>/static/<em>${component.name}</em>.a</code></p>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="sec:check_tasks"><a class="anchor" href="#sec:check_tasks"></a><a class="link" href="#sec:check_tasks">Check tasks</a></h5>
<div class="paragraph">
<p>For each <a href="../javadoc/org/gradle/nativeplatform/NativeBinarySpec.html">NativeBinarySpec</a> that can be produced by a build, a single <em>check task</em> is constructed that can be used to assemble and check that binary.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>check<em>${component.name}</em>Executable</code></dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1">Component Type</dt>
<dd>
<p><a href="../javadoc/org/gradle/nativeplatform/NativeExecutableSpec.html">NativeExecutableSpec</a></p>
</dd>
<dt class="hdlist1">Native Binary Type</dt>
<dd>
<p><a href="../javadoc/org/gradle/nativeplatform/NativeExecutableBinarySpec.html">NativeExecutableBinarySpec</a></p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>check<em>${component.name}</em>SharedLibrary</code></dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1">Component Type</dt>
<dd>
<p><a href="../javadoc/org/gradle/nativeplatform/NativeLibrarySpec.html">NativeLibrarySpec</a></p>
</dd>
<dt class="hdlist1">Native Binary Type</dt>
<dd>
<p><a href="../javadoc/org/gradle/nativeplatform/SharedLibraryBinarySpec.html">SharedLibraryBinarySpec</a></p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>check<em>${component.name}</em>StaticLibrary</code></dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1">Component Type</dt>
<dd>
<p><a href="../javadoc/org/gradle/nativeplatform/NativeLibrarySpec.html">NativeLibrarySpec</a></p>
</dd>
<dt class="hdlist1">Native Binary Type</dt>
<dd>
<p><a href="../javadoc/org/gradle/nativeplatform/SharedLibraryBinarySpec.html">SharedLibraryBinarySpec</a></p>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The built-in <code>check</code> task depends on all the <em>check tasks</em> for binaries in the project. Without either <a href="#native_binaries:cunit">CUnit</a> or <a href="#native_binaries:google_test">GoogleTest</a> plugins, the binary check task only depends on the <em>lifecycle task</em> that assembles the binary, see <a href="#sec:native_tasks">Native tasks</a>.</p>
</div>
<div class="paragraph">
<p>When the <a href="#native_binaries:cunit">CUnit</a> or <a href="#native_binaries:google_test">GoogleTest</a> plugins are applied, the task that executes the test suites for a component are automatically wired to the appropriate <em>check task</em>.</p>
</div>
<div class="paragraph">
<p>You can also add custom check tasks as follows:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_a_custom_check_task"><a class="anchor" href="#example_adding_a_custom_check_task"></a><a class="link" href="#example_adding_a_custom_check_task">Example: Adding a custom check task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">cpp</span><span class="delimiter">&quot;</span></span>
<span class="comment">// You don't need to apply the plugin below if you're already using CUnit or GoogleTest support</span>
apply <span class="key">plugin</span>: TestingModelBasePlugin

task myCustomCheck {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">Executing my custom check</span><span class="delimiter">'</span></span>
    }
}

model {
    components {
        hello(NativeLibrarySpec) {
            binaries.all {
                <span class="comment">// Register our custom check task to all binaries of this component</span>
                checkedBy <span class="error">$</span>.tasks.myCustomCheck
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/native-binaries/custom-check</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, running <code>check</code> or any of the <em>check tasks</em> for the <code>hello</code> binaries will run the custom check task:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_running_checks_for_a_given_binary"><a class="anchor" href="#example_running_checks_for_a_given_binary"></a><a class="link" href="#example_running_checks_for_a_given_binary">Example: Running checks for a given binary</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle checkHelloSharedLibrary</code></strong></div>
<div class="content">
<pre>&gt; gradle checkHelloSharedLibrary

&gt; Task :myCustomCheck
Executing my custom check

&gt; Task :checkHelloSharedLibrary

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:working_with_shared_libraries"><a class="anchor" href="#sec:working_with_shared_libraries"></a><a class="link" href="#sec:working_with_shared_libraries">Working with shared libraries</a></h5>
<div class="paragraph">
<p>For each executable binary produced, the <code>cpp</code> plugin provides an <code>install${binary.name}</code> task, which creates a development install of the executable, along with the shared libraries it requires. This allows you to run the executable without needing to install the shared libraries in their final locations.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:finding_out_more_about_your_project"><a class="anchor" href="#sec:finding_out_more_about_your_project"></a><a class="link" href="#sec:finding_out_more_about_your_project">Finding out more about your project</a></h4>
<div class="paragraph">
<p>Gradle provides a report that you can run from the command-line that shows some details about the components and binaries that your project produces. To use this report, just run <code>gradle components</code>. Below is an example of running this report for one of the sample projects:</p>
</div>
<div class="sect4">
<h5 id="example_the_components_report"><a class="anchor" href="#example_the_components_report"></a><a class="link" href="#example_the_components_report">Example: The components report</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle components</code></strong></div>
<div class="content">
<pre>&gt; gradle components

&gt; Task :components

------------------------------------------------------------
Root project
------------------------------------------------------------

Native library 'hello'
----------------------

Source sets
    C++ source 'hello:cpp'
        srcDir: src/hello/cpp

Binaries
    Shared library 'hello:sharedLibrary'
        build using task: :helloSharedLibrary
        build type: build type 'debug'
        flavor: flavor 'default'
        target platform: platform 'current'
        tool chain: Tool chain 'clang' (Clang)
        shared library file: build/libs/hello/shared/libhello.dylib
    Static library 'hello:staticLibrary'
        build using task: :helloStaticLibrary
        build type: build type 'debug'
        flavor: flavor 'default'
        target platform: platform 'current'
        tool chain: Tool chain 'clang' (Clang)
        static library file: build/libs/hello/static/libhello.a

Native executable 'main'
------------------------

Source sets
    C++ source 'main:cpp'
        srcDir: src/main/cpp

Binaries
    Executable 'main:executable'
        build using task: :mainExecutable
        install using task: :installMainExecutable
        build type: build type 'debug'
        flavor: flavor 'default'
        target platform: platform 'current'
        tool chain: Tool chain 'clang' (Clang)
        executable file: build/exe/main/main

Note: currently not all plugins register their components, so some components may not be visible here.

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="native_binaries:languages"><a class="anchor" href="#native_binaries:languages"></a><a class="link" href="#native_binaries:languages">Language support</a></h4>
<div class="paragraph">
<p>Presently, Gradle supports building native software from any combination of source languages listed below. A native binary project will contain one or more named <code>FunctionalSourceSet</code> instances (eg 'main', 'test', etc), each of which can contain <code>LanguageSourceSet</code>s containing source files, one for each language.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>C</p>
</li>
<li>
<p>C++</p>
</li>
<li>
<p>Objective-C</p>
</li>
<li>
<p>Objective-C++</p>
</li>
<li>
<p>Assembly</p>
</li>
<li>
<p>Windows resources</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="sec:cpp_sources"><a class="anchor" href="#sec:cpp_sources"></a><a class="link" href="#sec:cpp_sources">C++ sources</a></h5>
<div class="paragraph">
<p>C++ language support is provided by means of the <code>'cpp'</code> plugin.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_the_cpp_plugin"><a class="anchor" href="#example_the_cpp_plugin"></a><a class="link" href="#example_the_cpp_plugin">Example: The 'cpp' plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">cpp</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>C++ sources to be included in a native binary are provided via a <a href="../dsl/org.gradle.language.cpp.CppSourceSet.html">CppSourceSet</a>, which defines a set of C++ source files and optionally a set of exported header files (for a library). By default, for any named component the <a href="../dsl/org.gradle.language.cpp.CppSourceSet.html">CppSourceSet</a> contains <code>.cpp</code> source files in <code>src/${name}/cpp</code>, and header files in <code>src/${name}/headers</code>.</p>
</div>
<div class="paragraph">
<p>While the <code>cpp</code> plugin defines these default locations for each <a href="../dsl/org.gradle.language.cpp.CppSourceSet.html">CppSourceSet</a>, it is possible to extend or override these defaults to allow for a different project layout.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_c_source_set"><a class="anchor" href="#example_c_source_set"></a><a class="link" href="#example_c_source_set">Example: C++ source set</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sources {
    cpp {
        source {
            srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">src/source</span><span class="delimiter">&quot;</span></span>
            include <span class="string"><span class="delimiter">&quot;</span><span class="content">**/*.cpp</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a library named 'main', header files in <code>src/main/headers</code> are considered the "public" or "exported" headers. Header files that should not be exported should be placed inside the <code>src/main/cpp</code> directory (though be aware that such header files should always be referenced in a manner relative to the file including them).</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:c_sources"><a class="anchor" href="#sec:c_sources"></a><a class="link" href="#sec:c_sources">C sources</a></h5>
<div class="paragraph">
<p>C language support is provided by means of the <code>'c'</code> plugin.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_the_c_plugin"><a class="anchor" href="#example_the_c_plugin"></a><a class="link" href="#example_the_c_plugin">Example: The 'c' plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">c</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>C sources to be included in a native binary are provided via a <a href="../dsl/org.gradle.language.c.CSourceSet.html">CSourceSet</a>, which defines a set of C source files and optionally a set of exported header files (for a library). By default, for any named component the <a href="../dsl/org.gradle.language.c.CSourceSet.html">CSourceSet</a> contains <code>.c</code> source files in <code>src/${name}/c</code>, and header files in <code>src/${name}/headers</code>.</p>
</div>
<div class="paragraph">
<p>While the <code>c</code> plugin defines these default locations for each <a href="../dsl/org.gradle.language.c.CSourceSet.html">CSourceSet</a>, it is possible to extend or override these defaults to allow for a different project layout.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_c_source_set_2"><a class="anchor" href="#example_c_source_set_2"></a><a class="link" href="#example_c_source_set_2">Example: C source set</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sources {
    c {
        source {
            srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">src/source</span><span class="delimiter">&quot;</span></span>
            include <span class="string"><span class="delimiter">&quot;</span><span class="content">**/*.c</span><span class="delimiter">&quot;</span></span>
        }
        exportedHeaders {
            srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">src/include</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a library named 'main', header files in <code>src/main/headers</code> are considered the "public" or "exported" headers. Header files that should not be exported should be placed inside the <code>src/main/c</code> directory (though be aware that such header files should always be referenced in a manner relative to the file including them).</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:assembler_sources"><a class="anchor" href="#sec:assembler_sources"></a><a class="link" href="#sec:assembler_sources">Assembler sources</a></h5>
<div class="paragraph">
<p>Assembly language support is provided by means of the <code>'assembler'</code> plugin.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_the_assembler_plugin"><a class="anchor" href="#example_the_assembler_plugin"></a><a class="link" href="#example_the_assembler_plugin">Example: The 'assembler' plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">assembler</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Assembler sources to be included in a native binary are provided via a <a href="../dsl/org.gradle.language.assembler.AssemblerSourceSet.html">AssemblerSourceSet</a>, which defines a set of Assembler source files. By default, for any named component the <a href="../dsl/org.gradle.language.assembler.AssemblerSourceSet.html">AssemblerSourceSet</a> contains <code>.s</code> source files under <code>src/${name}/asm</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:objectivec_sources"><a class="anchor" href="#sec:objectivec_sources"></a><a class="link" href="#sec:objectivec_sources">Objective-C sources</a></h5>
<div class="paragraph">
<p>Objective-C language support is provided by means of the <code>'objective-c'</code> plugin.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_the_objective_c_plugin"><a class="anchor" href="#example_the_objective_c_plugin"></a><a class="link" href="#example_the_objective_c_plugin">Example: The 'objective-c' plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">objective-c</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Objective-C sources to be included in a native binary are provided via a <a href="../dsl/org.gradle.language.objectivec.ObjectiveCSourceSet.html">ObjectiveCSourceSet</a>, which defines a set of Objective-C source files. By default, for any named component the <a href="../dsl/org.gradle.language.objectivec.ObjectiveCSourceSet.html">ObjectiveCSourceSet</a> contains <code>.m</code> source files under <code>src/${name}/objectiveC</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:objectivecpp_sources"><a class="anchor" href="#sec:objectivecpp_sources"></a><a class="link" href="#sec:objectivecpp_sources">Objective-C++ sources</a></h5>
<div class="paragraph">
<p>Objective-C++ language support is provided by means of the <code>'objective-cpp'</code> plugin.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_the_objective_cpp_plugin"><a class="anchor" href="#example_the_objective_cpp_plugin"></a><a class="link" href="#example_the_objective_cpp_plugin">Example: The 'objective-cpp' plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">objective-cpp</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Objective-C++ sources to be included in a native binary are provided via a <a href="../dsl/org.gradle.language.objectivecpp.ObjectiveCppSourceSet.html">ObjectiveCppSourceSet</a>, which defines a set of Objective-C++ source files. By default, for any named component the <a href="../dsl/org.gradle.language.objectivecpp.ObjectiveCppSourceSet.html">ObjectiveCppSourceSet</a> contains <code>.mm</code> source files under <code>src/${name}/objectiveCpp</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring_the_compiler_assembler_and_linker"><a class="anchor" href="#sec:configuring_the_compiler_assembler_and_linker"></a><a class="link" href="#sec:configuring_the_compiler_assembler_and_linker">Configuring the compiler, assembler and linker</a></h4>
<div class="paragraph">
<p>Each binary to be produced is associated with a set of compiler and linker settings, which include command-line arguments as well as macro definitions. These settings can be applied to all binaries, an individual binary, or selectively to a group of binaries based on some criteria.</p>
</div>
<div class="sect4">
<h5 id="example_settings_that_apply_to_all_binaries"><a class="anchor" href="#example_settings_that_apply_to_all_binaries"></a><a class="link" href="#example_settings_that_apply_to_all_binaries">Example: Settings that apply to all binaries</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    binaries {
        all {
            <span class="comment">// Define a preprocessor macro for every binary</span>
            cppCompiler.define <span class="string"><span class="delimiter">&quot;</span><span class="content">NDEBUG</span><span class="delimiter">&quot;</span></span>

            <span class="comment">// Define toolchain-specific compiler and linker options</span>
            <span class="keyword">if</span> (toolChain <span class="keyword">in</span> Gcc) {
                cppCompiler.args <span class="string"><span class="delimiter">&quot;</span><span class="content">-O2</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">-fno-access-control</span><span class="delimiter">&quot;</span></span>
                linker.args <span class="string"><span class="delimiter">&quot;</span><span class="content">-Xlinker</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">-S</span><span class="delimiter">&quot;</span></span>
            }
            <span class="keyword">if</span> (toolChain <span class="keyword">in</span> VisualCpp) {
                cppCompiler.args <span class="string"><span class="delimiter">&quot;</span><span class="content">/Zi</span><span class="delimiter">&quot;</span></span>
                linker.args <span class="string"><span class="delimiter">&quot;</span><span class="content">/DEBUG</span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each binary is associated with a particular <a href="../javadoc/org/gradle/nativeplatform/toolchain/NativeToolChain.html">NativeToolChain</a>, allowing settings to be targeted based on this value.</p>
</div>
<div class="paragraph">
<p>It is easy to apply settings to all binaries of a particular type:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_settings_that_apply_to_all_shared_libraries"><a class="anchor" href="#example_settings_that_apply_to_all_shared_libraries"></a><a class="link" href="#example_settings_that_apply_to_all_shared_libraries">Example: Settings that apply to all shared libraries</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// For any shared library binaries built with Visual C++,</span>
<span class="comment">// define the DLL_EXPORT macro</span>
model {
    binaries {
        withType(SharedLibraryBinarySpec) {
            <span class="keyword">if</span> (toolChain <span class="keyword">in</span> VisualCpp) {
                cCompiler.args <span class="string"><span class="delimiter">&quot;</span><span class="content">/Zi</span><span class="delimiter">&quot;</span></span>
                cCompiler.define <span class="string"><span class="delimiter">&quot;</span><span class="content">DLL_EXPORT</span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Furthermore, it is possible to specify settings that apply to all binaries produced for a particular <code>executable</code> or <code>library</code> component:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_settings_that_apply_to_all_binaries_produced_for_the_main_executable_component"><a class="anchor" href="#example_settings_that_apply_to_all_binaries_produced_for_the_main_executable_component"></a><a class="link" href="#example_settings_that_apply_to_all_binaries_produced_for_the_main_executable_component">Example: Settings that apply to all binaries produced for the 'main' executable component</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        main(NativeExecutableSpec) {
            targetPlatform <span class="string"><span class="delimiter">&quot;</span><span class="content">x86</span><span class="delimiter">&quot;</span></span>
            binaries.all {
                <span class="keyword">if</span> (toolChain <span class="keyword">in</span> VisualCpp) {
                    sources {
                        platformAsm(AssemblerSourceSet) {
                            source.srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">src/main/asm_i386_masm</span><span class="delimiter">&quot;</span></span>
                        }
                    }
                    assembler.args <span class="string"><span class="delimiter">&quot;</span><span class="content">/Zi</span><span class="delimiter">&quot;</span></span>
                } <span class="keyword">else</span> {
                    sources {
                        platformAsm(AssemblerSourceSet) {
                            source.srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">src/main/asm_i386_gcc</span><span class="delimiter">&quot;</span></span>
                        }
                    }
                    assembler.args <span class="string"><span class="delimiter">&quot;</span><span class="content">-g</span><span class="delimiter">&quot;</span></span>
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example above will apply the supplied configuration to all <code>executable</code> binaries built.</p>
</div>
<div class="paragraph">
<p>Similarly, settings can be specified to target binaries for a component that are of a particular type: eg all shared libraries for the main library component.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_settings_that_apply_only_to_shared_libraries_produced_for_the_main_library_component"><a class="anchor" href="#example_settings_that_apply_only_to_shared_libraries_produced_for_the_main_library_component"></a><a class="link" href="#example_settings_that_apply_only_to_shared_libraries_produced_for_the_main_library_component">Example: Settings that apply only to shared libraries produced for the 'main' library component</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        main(NativeLibrarySpec) {
            binaries.withType(SharedLibraryBinarySpec) {
                <span class="comment">// Define a preprocessor macro that only applies to shared libraries</span>
                cppCompiler.define <span class="string"><span class="delimiter">&quot;</span><span class="content">DLL_EXPORT</span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="native_binaries:windows-resources"><a class="anchor" href="#native_binaries:windows-resources"></a><a class="link" href="#native_binaries:windows-resources">Windows Resources</a></h4>
<div class="paragraph">
<p>When using the <a href="../dsl/org.gradle.nativeplatform.toolchain.VisualCpp.html">VisualCpp</a> tool chain, Gradle is able to compile Window Resource (<code>rc</code>) files and link them into a native binary. This functionality is provided by the <code>'windows-resources'</code> plugin.</p>
</div>
<div class="sect4">
<h5 id="example_the_windows_resources_plugin"><a class="anchor" href="#example_the_windows_resources_plugin"></a><a class="link" href="#example_the_windows_resources_plugin">Example: The 'windows-resources' plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">windows-resources</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Windows resources to be included in a native binary are provided via a <a href="../dsl/org.gradle.language.rc.WindowsResourceSet.html">WindowsResourceSet</a>, which defines a set of Windows Resource source files. By default, for any named component the <a href="../dsl/org.gradle.language.rc.WindowsResourceSet.html">WindowsResourceSet</a> contains <code>.rc</code> source files under <code>src/${name}/rc</code>.</p>
</div>
<div class="paragraph">
<p>As with other source types, you can configure the location of the windows resources that should be included in the binary.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_the_location_of_windows_resource_sources"><a class="anchor" href="#example_configuring_the_location_of_windows_resource_sources"></a><a class="link" href="#example_configuring_the_location_of_windows_resource_sources">Example: Configuring the location of Windows resource sources</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build-resource-only-dll.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sources {
    rc {
        source {
            srcDirs <span class="string"><span class="delimiter">&quot;</span><span class="content">src/hello/rc</span><span class="delimiter">&quot;</span></span>
        }
        exportedHeaders {
            srcDirs <span class="string"><span class="delimiter">&quot;</span><span class="content">src/hello/headers</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You are able to construct a resource-only library by providing Windows Resource sources with no other language sources, and configure the linker as appropriate:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_building_a_resource_only_dll"><a class="anchor" href="#example_building_a_resource_only_dll"></a><a class="link" href="#example_building_a_resource_only_dll">Example: Building a resource-only dll</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build-resource-only-dll.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        helloRes(NativeLibrarySpec) {
            binaries.all {
                rcCompiler.args <span class="string"><span class="delimiter">&quot;</span><span class="content">/v</span><span class="delimiter">&quot;</span></span>
                linker.args <span class="string"><span class="delimiter">&quot;</span><span class="content">/noentry</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">/machine:x86</span><span class="delimiter">&quot;</span></span>
            }
            sources {
                rc {
                    source {
                        srcDirs <span class="string"><span class="delimiter">&quot;</span><span class="content">src/hello/rc</span><span class="delimiter">&quot;</span></span>
                    }
                    exportedHeaders {
                        srcDirs <span class="string"><span class="delimiter">&quot;</span><span class="content">src/hello/headers</span><span class="delimiter">&quot;</span></span>
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example above also demonstrates the mechanism of passing extra command-line arguments to the resource compiler. The <code>rcCompiler</code> extension is of type <a href="../javadoc/org/gradle/nativeplatform/PreprocessingTool.html">PreprocessingTool</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:library_dependencies"><a class="anchor" href="#sec:library_dependencies"></a><a class="link" href="#sec:library_dependencies">Library Dependencies</a></h4>
<div class="paragraph">
<p>Dependencies for native components are binary libraries that export header files. The header files are used during compilation, with the compiled binary dependency being used during linking and execution. Header files should be organized into subdirectories to prevent clashes of commonly named headers. For instance, if your <code>mylib</code> project has a <code>logging.h</code> header, it will make it less likely the wrong header is used if you include it as <code>"mylib/logging.h"</code> instead of <code>"logging.h"</code>.</p>
</div>
<div class="sect4">
<h5 id="sec:dependencies_within_the_same_project"><a class="anchor" href="#sec:dependencies_within_the_same_project"></a><a class="link" href="#sec:dependencies_within_the_same_project">Dependencies within the same project</a></h5>
<div class="paragraph">
<p>A set of sources may depend on header files provided by another binary component within the same project. A common example is a native executable component that uses functions provided by a separate native library component.</p>
</div>
<div class="paragraph">
<p>Such a library dependency can be added to a source set associated with the <code>executable</code> component:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_providing_a_library_dependency_to_the_source_set"><a class="anchor" href="#example_providing_a_library_dependency_to_the_source_set"></a><a class="link" href="#example_providing_a_library_dependency_to_the_source_set">Example: Providing a library dependency to the source set</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sources {
    cpp {
        lib <span class="key">library</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, a library dependency can be provided directly to the <code>NativeExecutableBinarySpec</code> for the <code>executable</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_providing_a_library_dependency_to_the_binary"><a class="anchor" href="#example_providing_a_library_dependency_to_the_binary"></a><a class="link" href="#example_providing_a_library_dependency_to_the_binary">Example: Providing a library dependency to the binary</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        hello(NativeLibrarySpec) {
            sources {
                c {
                    source {
                        srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">src/source</span><span class="delimiter">&quot;</span></span>
                        include <span class="string"><span class="delimiter">&quot;</span><span class="content">**/*.c</span><span class="delimiter">&quot;</span></span>
                    }
                    exportedHeaders {
                        srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">src/include</span><span class="delimiter">&quot;</span></span>
                    }
                }
            }
        }
        main(NativeExecutableSpec) {
            sources {
                cpp {
                    source {
                        srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">src/source</span><span class="delimiter">&quot;</span></span>
                        include <span class="string"><span class="delimiter">&quot;</span><span class="content">**/*.cpp</span><span class="delimiter">&quot;</span></span>
                    }
                }
            }
            binaries.all {
                <span class="comment">// Each executable binary produced uses the 'hello' static library binary</span>
                lib <span class="key">library</span>: <span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>, <span class="key">linkage</span>: <span class="string"><span class="delimiter">'</span><span class="content">static</span><span class="delimiter">'</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:project_dependencies"><a class="anchor" href="#sec:project_dependencies"></a><a class="link" href="#sec:project_dependencies">Project Dependencies</a></h5>
<div class="paragraph">
<p>For a component produced in a different Gradle project, the notation is similar.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_project_dependencies_2"><a class="anchor" href="#example_declaring_project_dependencies_2"></a><a class="link" href="#example_declaring_project_dependencies_2">Example: Declaring project dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">project(<span class="string"><span class="delimiter">&quot;</span><span class="content">:lib</span><span class="delimiter">&quot;</span></span>) {
    apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">cpp</span><span class="delimiter">&quot;</span></span>
    model {
        components {
            main(NativeLibrarySpec)
        }

        <span class="comment">// For any shared library binaries built with Visual C++,</span>
        <span class="comment">// define the DLL_EXPORT macro</span>
        binaries {
            withType(SharedLibraryBinarySpec) {
                <span class="keyword">if</span> (toolChain <span class="keyword">in</span> VisualCpp) {
                    cppCompiler.define <span class="string"><span class="delimiter">&quot;</span><span class="content">DLL_EXPORT</span><span class="delimiter">&quot;</span></span>
                }
            }
        }
    }
}

project(<span class="string"><span class="delimiter">&quot;</span><span class="content">:exe</span><span class="delimiter">&quot;</span></span>) {
    apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">cpp</span><span class="delimiter">&quot;</span></span>

    model {
        components {
            main(NativeExecutableSpec) {
                sources {
                    cpp {
                        lib <span class="key">project</span>: <span class="string"><span class="delimiter">'</span><span class="content">:lib</span><span class="delimiter">'</span></span>, <span class="key">library</span>: <span class="string"><span class="delimiter">'</span><span class="content">main</span><span class="delimiter">'</span></span>
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="native_binaries:preCompiledHeaders"><a class="anchor" href="#native_binaries:preCompiledHeaders"></a><a class="link" href="#native_binaries:preCompiledHeaders">Precompiled Headers</a></h4>
<div class="paragraph">
<p>Precompiled headers are a performance optimization that reduces the cost of compiling widely used headers multiple times. This feature <em>precompiles</em> a header such that the compiled object file can be reused when compiling each source file rather than recompiling the header each time. This support is available for C, C++, Objective-C, and Objective-C++ builds.</p>
</div>
<div class="paragraph">
<p>To configure a precompiled header, first a header file needs to be defined that includes all of the headers that should be precompiled. It must be specified as the first included header in every source file where the precompiled header should be used. It is assumed that this header file, and any headers it contains, make use of header guards so that they can be included in an idempotent manner. If header guards are not used in a header file, it is possible the header could be compiled more than once and could potentially lead to a broken build.</p>
</div>
<div class="sect4">
<h5 id="example_creating_a_precompiled_header_file"><a class="anchor" href="#example_creating_a_precompiled_header_file"></a><a class="link" href="#example_creating_a_precompiled_header_file">Example: Creating a precompiled header file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">src/hello/headers/pch.h</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c"><span class="preprocessor">#ifndef</span> PCH_H
<span class="preprocessor">#define</span> PCH_H
<span class="preprocessor">#include</span> <span class="include">&lt;iostream&gt;</span>
<span class="preprocessor">#include</span> <span class="include">&quot;hello.h&quot;</span>
<span class="preprocessor">#endif</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_including_a_precompiled_header_file_in_a_source_file"><a class="anchor" href="#example_including_a_precompiled_header_file_in_a_source_file"></a><a class="link" href="#example_including_a_precompiled_header_file_in_a_source_file">Example: Including a precompiled header file in a source file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">src/hello/cpp/hello.cpp</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="cpp"><span class="preprocessor">#include</span> <span class="include">&quot;pch.h&quot;</span>

<span class="directive">void</span> LIB_FUNC Greeter::hello () {
    std::cout &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello world!</span><span class="delimiter">&quot;</span></span> &lt;&lt; std::endl;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Precompiled headers are specified on a source set. Only one precompiled header file can be specified on a given source set and will be applied to all source files that declare it as the first include. If a source files does not include this header file as the first header, the file will be compiled in the normal manner (without making use of the precompiled header object file). The string provided should be the same as that which is used in the "#include" directive in the source files.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_a_precompiled_header"><a class="anchor" href="#example_configuring_a_precompiled_header"></a><a class="link" href="#example_configuring_a_precompiled_header">Example: Configuring a precompiled header</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        hello(NativeLibrarySpec) {
            sources {
                cpp {
                    preCompiledHeader <span class="string"><span class="delimiter">&quot;</span><span class="content">pch.h</span><span class="delimiter">&quot;</span></span>
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A precompiled header must be included in the same way for all files that use it. Usually, this means the header file should exist in the source set "headers" directory or in a directory included on the compiler include path.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="native_binaries:variants"><a class="anchor" href="#native_binaries:variants"></a><a class="link" href="#native_binaries:variants">Native Binary Variants</a></h4>
<div class="paragraph">
<p>For each executable or library defined, Gradle is able to build a number of different native binary variants. Examples of different variants include debug vs release binaries, 32-bit vs 64-bit binaries, and binaries produced with different custom preprocessor flags.</p>
</div>
<div class="paragraph">
<p>Binaries produced by Gradle can be differentiated on <a href="#native_binaries:build_type">build type</a>, <a href="#native_binaries:platform">platform</a>, and <a href="#native_binaries:flavor">flavor</a>. For each of these 'variant dimensions', it is possible to specify a set of available values as well as target each component at one, some or all of these. For example, a plugin may define a range of support platforms, but you may choose to only target Windows-x86 for a particular component.</p>
</div>
<div class="sect4">
<h5 id="native_binaries:build_type"><a class="anchor" href="#native_binaries:build_type"></a><a class="link" href="#native_binaries:build_type">Build types</a></h5>
<div class="paragraph">
<p>A <code>build type</code> determines various non-functional aspects of a binary, such as whether debug information is included, or what optimisation level the binary is compiled with. Typical build types are 'debug' and 'release', but a project is free to define any set of build types.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_build_types"><a class="anchor" href="#example_defining_build_types"></a><a class="link" href="#example_defining_build_types">Example: Defining build types</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    buildTypes {
        debug
        release
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If no build types are defined in a project, then a single, default build type called 'debug' is added.</p>
</div>
<div class="paragraph">
<p>For a build type, a Gradle project will typically define a set of compiler/linker flags per tool chain.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_debug_binaries"><a class="anchor" href="#example_configuring_debug_binaries"></a><a class="link" href="#example_configuring_debug_binaries">Example: Configuring debug binaries</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    binaries {
        all {
            <span class="keyword">if</span> (toolChain <span class="keyword">in</span> Gcc &amp;&amp; buildType == buildTypes.debug) {
                cppCompiler.args <span class="string"><span class="delimiter">&quot;</span><span class="content">-g</span><span class="delimiter">&quot;</span></span>
            }
            <span class="keyword">if</span> (toolChain <span class="keyword">in</span> VisualCpp &amp;&amp; buildType == buildTypes.debug) {
                cppCompiler.args <span class="string"><span class="delimiter">'</span><span class="content">/Zi</span><span class="delimiter">'</span></span>
                cppCompiler.define <span class="string"><span class="delimiter">'</span><span class="content">DEBUG</span><span class="delimiter">'</span></span>
                linker.args <span class="string"><span class="delimiter">'</span><span class="content">/DEBUG</span><span class="delimiter">'</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>At this stage, it is completely up to the build script to configure the relevant compiler/linker flags for each build type. Future versions of Gradle will automatically include the appropriate debug flags for any 'debug' build type, and may be aware of various levels of optimisation as well.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="native_binaries:platform"><a class="anchor" href="#native_binaries:platform"></a><a class="link" href="#native_binaries:platform">Platform</a></h5>
<div class="paragraph">
<p>An executable or library can be built to run on different operating systems and cpu architectures, with a variant being produced for each platform. Gradle defines each OS/architecture combination as a <a href="../dsl/org.gradle.nativeplatform.platform.NativePlatform.html">NativePlatform</a>, and a project may define any number of platforms. If no platforms are defined in a project, then a single, default platform 'current' is added.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Presently, a <code>Platform</code> consists of a defined operating system and architecture. As we continue to develop the native binary support in Gradle, the concept of Platform will be extended to include things like C-runtime version, Windows SDK, ABI, etc. Sophisticated builds may use the extensibility of Gradle to apply additional attributes to each platform, which can then be queried to specify particular includes, preprocessor macros or compiler arguments for a native binary.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_platforms"><a class="anchor" href="#example_defining_platforms"></a><a class="link" href="#example_defining_platforms">Example: Defining platforms</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    platforms {
        x86 {
            architecture <span class="string"><span class="delimiter">&quot;</span><span class="content">x86</span><span class="delimiter">&quot;</span></span>
        }
        x64 {
            architecture <span class="string"><span class="delimiter">&quot;</span><span class="content">x86_64</span><span class="delimiter">&quot;</span></span>
        }
        itanium {
            architecture <span class="string"><span class="delimiter">&quot;</span><span class="content">ia-64</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a given variant, Gradle will attempt to find a <a href="../javadoc/org/gradle/nativeplatform/toolchain/NativeToolChain.html">NativeToolChain</a> that is able to build for the target platform. Available tool chains are searched in the order defined. See the <a href="#native_binaries:tool_chain">tool chains</a> section below for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="native_binaries:flavor"><a class="anchor" href="#native_binaries:flavor"></a><a class="link" href="#native_binaries:flavor">Flavor</a></h5>
<div class="paragraph">
<p>Each component can have a set of named <code>flavors</code>, and a separate binary variant can be produced for each flavor. While the <code>build type</code> and <code>target platform</code> variant dimensions have a defined meaning in Gradle, each project is free to define any number of flavors and apply meaning to them in any way.</p>
</div>
<div class="paragraph">
<p>An example of component flavors might differentiate between 'demo', 'paid' and 'enterprise' editions of the component, where the same set of sources is used to produce binaries with different functions.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_flavors"><a class="anchor" href="#example_defining_flavors"></a><a class="link" href="#example_defining_flavors">Example: Defining flavors</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    flavors {
        english
        french
    }
    components {
        hello(NativeLibrarySpec) {
            binaries.all {
                <span class="keyword">if</span> (flavor == flavors.french) {
                    cppCompiler.define <span class="string"><span class="delimiter">&quot;</span><span class="content">FRENCH</span><span class="delimiter">&quot;</span></span>
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, a library is defined with a 'english' and 'french' flavor. When compiling the 'french' variant, a separate macro is defined which leads to a different binary being produced.</p>
</div>
<div class="paragraph">
<p>If no flavor is defined for a component, then a single default flavor named 'default' is used.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:selecting_the_build_types_platforms_and_flavors_for_a_component"><a class="anchor" href="#sec:selecting_the_build_types_platforms_and_flavors_for_a_component"></a><a class="link" href="#sec:selecting_the_build_types_platforms_and_flavors_for_a_component">Selecting the build types, platforms and flavors for a component</a></h5>
<div class="paragraph">
<p>For a default component, Gradle will attempt to create a native binary variant for each and every combination of <code>buildType</code> and <code>flavor</code> defined for the project. It is possible to override this on a per-component basis, by specifying the set of <code>targetBuildTypes</code> and/or <code>targetFlavors</code>. By default, Gradle will build for the default platform, see <a href="#native_binaries:platform">above</a>, unless specified explicitly on a per-component basis by specifying a set of <code>targetPlatforms</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_targeting_a_component_at_particular_platforms"><a class="anchor" href="#example_targeting_a_component_at_particular_platforms"></a><a class="link" href="#example_targeting_a_component_at_particular_platforms">Example: Targeting a component at particular platforms</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        hello(NativeLibrarySpec) {
            targetPlatform <span class="string"><span class="delimiter">&quot;</span><span class="content">x86</span><span class="delimiter">&quot;</span></span>
            targetPlatform <span class="string"><span class="delimiter">&quot;</span><span class="content">x64</span><span class="delimiter">&quot;</span></span>
        }
        main(NativeExecutableSpec) {
            targetPlatform <span class="string"><span class="delimiter">&quot;</span><span class="content">x86</span><span class="delimiter">&quot;</span></span>
            targetPlatform <span class="string"><span class="delimiter">&quot;</span><span class="content">x64</span><span class="delimiter">&quot;</span></span>
            sources {
                cpp.lib <span class="key">library</span>: <span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>, <span class="key">linkage</span>: <span class="string"><span class="delimiter">'</span><span class="content">static</span><span class="delimiter">'</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here you can see that the <a href="../dsl/org.gradle.nativeplatform.TargetedNativeComponent.html#org.gradle.nativeplatform.TargetedNativeComponent:targetPlatform(java.lang.String)">TargetedNativeComponent.targetPlatform(java.lang.String)</a> method is used to specify a platform that the <code>NativeExecutableSpec</code> named <code>main</code> should be built for.</p>
</div>
<div class="paragraph">
<p>A similar mechanism exists for selecting <a href="../dsl/org.gradle.nativeplatform.TargetedNativeComponent.html#org.gradle.nativeplatform.TargetedNativeComponent:targetBuildTypes(java.lang.String[])">TargetedNativeComponent.targetBuildTypes(java.lang.String&#8230;&#8203;)</a> and <a href="../dsl/org.gradle.nativeplatform.TargetedNativeComponent.html#org.gradle.nativeplatform.TargetedNativeComponent:targetFlavors(java.lang.String[])">TargetedNativeComponent.targetFlavors(java.lang.String&#8230;&#8203;)</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:building_all_possible_variants"><a class="anchor" href="#sec:building_all_possible_variants"></a><a class="link" href="#sec:building_all_possible_variants">Building all possible variants</a></h5>
<div class="paragraph">
<p>When a set of build types, target platforms, and flavors is defined for a component, a <a href="../javadoc/org/gradle/nativeplatform/NativeBinarySpec.html">NativeBinarySpec</a> model element is created for every possible combination of these. However, in many cases it is not possible to build a particular variant, perhaps because no tool chain is available to build for a particular platform.</p>
</div>
<div class="paragraph">
<p>If a binary variant cannot be built for any reason, then the <a href="../javadoc/org/gradle/nativeplatform/NativeBinarySpec.html">NativeBinarySpec</a> associated with that variant will not be <code>buildable</code>. It is possible to use this property to create a task to generate all possible variants on a particular machine.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_building_all_possible_variants"><a class="anchor" href="#example_building_all_possible_variants"></a><a class="link" href="#example_building_all_possible_variants">Example: Building all possible variants</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    tasks {
        buildAllExecutables(Task) {
            dependsOn <span class="error">$</span>.binaries.findAll { <span class="local-variable">it</span>.buildable }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="native_binaries:tool_chain"><a class="anchor" href="#native_binaries:tool_chain"></a><a class="link" href="#native_binaries:tool_chain">Tool chains</a></h4>
<div class="paragraph">
<p>A single build may utilize different tool chains to build variants for different platforms. To this end, the core 'native-binary' plugins will attempt to locate and make available supported tool chains. However, the set of tool chains for a project may also be explicitly defined, allowing additional cross-compilers to be configured as well as allowing the install directories to be specified.</p>
</div>
<div class="sect4">
<h5 id="sec:defining_tool_chains"><a class="anchor" href="#sec:defining_tool_chains"></a><a class="link" href="#sec:defining_tool_chains">Defining tool chains</a></h5>
<div class="paragraph">
<p>The supported tool chain types are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../dsl/org.gradle.nativeplatform.toolchain.Gcc.html">Gcc</a></p>
</li>
<li>
<p><a href="../dsl/org.gradle.nativeplatform.toolchain.Clang.html">Clang</a></p>
</li>
<li>
<p><a href="../dsl/org.gradle.nativeplatform.toolchain.VisualCpp.html">VisualCpp</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_tool_chains"><a class="anchor" href="#example_defining_tool_chains"></a><a class="link" href="#example_defining_tool_chains">Example: Defining tool chains</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    toolChains {
        visualCpp(VisualCpp) {
            <span class="comment">// Specify the installDir if Visual Studio cannot be located</span>
            <span class="comment">// installDir &quot;C:/Apps/Microsoft Visual Studio 10.0&quot;</span>
        }
        gcc(Gcc) {
            <span class="comment">// Uncomment to use a GCC install that is not in the PATH</span>
            <span class="comment">// path &quot;/usr/bin/gcc&quot;</span>
        }
        clang(Clang)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each tool chain implementation allows for a certain degree of configuration (see the API documentation for more details).</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_tool_chains"><a class="anchor" href="#sec:using_tool_chains"></a><a class="link" href="#sec:using_tool_chains">Using tool chains</a></h5>
<div class="paragraph">
<p>It is not necessary or possible to specify the tool chain that should be used to build. For a given variant, Gradle will attempt to locate a <a href="../javadoc/org/gradle/nativeplatform/toolchain/NativeToolChain.html">NativeToolChain</a> that is able to build for the target platform. Available tool chains are searched in the order defined.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>When a platform does not define an architecture or operating system, the default target of the tool chain is assumed. So if a platform does not define a value for <code>operatingSystem</code>, Gradle will find the first available tool chain that can build for the specified <code>architecture</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The core Gradle tool chains are able to target the following architectures out of the box. In each case, the tool chain will target the current operating system. See the next section for information on cross-compiling for other operating systems.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Tool Chain</th>
<th class="tableblock halign-left valign-top">Architectures</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>GCC</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x86, x86_64</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Clang</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x86, x86_64</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Visual C++</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>x86, x86_64, ia-64</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>So for GCC running on linux, the supported target platforms are 'linux/x86' and 'linux/x86_64'. For GCC running on Windows via Cygwin, platforms 'windows/x86' and 'windows/x86_64' are supported. (The Cygwin POSIX runtime is not yet modelled as part of the platform, but will be in the future.)</p>
</div>
<div class="paragraph">
<p>If no target platforms are defined for a project, then all binaries are built to target a default platform named 'current'. This default platform does not specify any <code>architecture</code> or <code>operatingSystem</code> value, hence using the default values of the first available tool chain.</p>
</div>
<div class="paragraph">
<p>Gradle provides a <em>hook</em> that allows the build author to control the exact set of arguments passed to a tool chain executable. This enables the build author to work around any limitations in Gradle, or assumptions that Gradle makes. The arguments hook should be seen as a 'last-resort' mechanism, with preference given to truly modelling the underlying domain.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_reconfigure_tool_arguments"><a class="anchor" href="#example_reconfigure_tool_arguments"></a><a class="link" href="#example_reconfigure_tool_arguments">Example: Reconfigure tool arguments</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    toolChains {
        visualCpp(VisualCpp) {
            eachPlatform {
                cppCompiler.withArguments { args -&gt;
                    args &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="content">-DFRENCH</span><span class="delimiter">&quot;</span></span>
                }
            }
        }
        clang(Clang) {
            eachPlatform {
                cCompiler.withArguments { args -&gt;
                    <span class="predefined-type">Collections</span>.replaceAll(args, <span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTOM</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">-DFRENCH</span><span class="delimiter">&quot;</span></span>)
                }
                linker.withArguments { args -&gt;
                    args.remove <span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTOM</span><span class="delimiter">&quot;</span></span>
                }
                staticLibArchiver.withArguments { args -&gt;
                    args.remove <span class="string"><span class="delimiter">&quot;</span><span class="content">CUSTOM</span><span class="delimiter">&quot;</span></span>
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:crosscompiling_with_gcc"><a class="anchor" href="#sec:crosscompiling_with_gcc"></a><a class="link" href="#sec:crosscompiling_with_gcc">Cross-compiling with GCC</a></h5>
<div class="paragraph">
<p>Cross-compiling is possible with the <a href="../dsl/org.gradle.nativeplatform.toolchain.Gcc.html">Gcc</a> and <a href="../dsl/org.gradle.nativeplatform.toolchain.Clang.html">Clang</a> tool chains, by adding support for additional target platforms. This is done by specifying a target platform for a toolchain. For each target platform a custom configuration can be specified.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_target_platforms"><a class="anchor" href="#example_defining_target_platforms"></a><a class="link" href="#example_defining_target_platforms">Example: Defining target platforms</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    toolChains {
        gcc(Gcc) {
            target(<span class="string"><span class="delimiter">&quot;</span><span class="content">arm</span><span class="delimiter">&quot;</span></span>){
                cppCompiler.withArguments { args -&gt;
                    args &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="content">-m32</span><span class="delimiter">&quot;</span></span>
                }
                linker.withArguments { args -&gt;
                    args &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="content">-m32</span><span class="delimiter">&quot;</span></span>
                }
            }
            target(<span class="string"><span class="delimiter">&quot;</span><span class="content">sparc</span><span class="delimiter">&quot;</span></span>)
        }
    }
    platforms {
        arm {
            architecture <span class="string"><span class="delimiter">&quot;</span><span class="content">arm</span><span class="delimiter">&quot;</span></span>
        }
        sparc {
            architecture <span class="string"><span class="delimiter">&quot;</span><span class="content">sparc</span><span class="delimiter">&quot;</span></span>
        }
    }
    components {
        main(NativeExecutableSpec) {
            targetPlatform <span class="string"><span class="delimiter">&quot;</span><span class="content">arm</span><span class="delimiter">&quot;</span></span>
            targetPlatform <span class="string"><span class="delimiter">&quot;</span><span class="content">sparc</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="native_binaries:visual_studio"><a class="anchor" href="#native_binaries:visual_studio"></a><a class="link" href="#native_binaries:visual_studio">Visual Studio IDE integration</a></h4>
<div class="paragraph">
<p>Gradle has the ability to generate Visual Studio project and solution files for the native components defined in your build. This ability is added by the <code>visual-studio</code> plugin. For a multi-project build, all projects with native components (and the root project) should have this plugin applied.</p>
</div>
<div class="paragraph">
<p>When the <code>visual-studio</code> plugin is applied to the root project, a task named <code>visualStudio</code> is created, which will generate a Visual Studio solution file containing all components in the build. This solution will include a Visual Studio project for each component, as well as configuring each component to build using Gradle.</p>
</div>
<div class="paragraph">
<p>A task named <code>openVisualStudio</code> is also created by the <code>visual-studio</code> plugin when the project is the root project. This task generates the Visual Studio solution and then opens the solution in Visual Studio. This means you can simply run <code>gradlew openVisualStudio</code> from the root project to generate and open the Visual Studio solution in one convenient step.</p>
</div>
<div class="paragraph">
<p>The content of the generated visual studio files can be modified via API hooks, provided by the <code>visualStudio</code> extension. Take a look at the 'visual-studio' sample, or see <a href="../dsl/org.gradle.ide.visualstudio.VisualStudioExtension.html#org.gradle.ide.visualstudio.VisualStudioExtension:projects">VisualStudioExtension.getProjects()</a> and <a href="../dsl/org.gradle.ide.visualstudio.VisualStudioRootExtension.html#org.gradle.ide.visualstudio.VisualStudioRootExtension:solution">VisualStudioRootExtension.getSolution()</a> in the API documentation for more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="native_binaries:cunit"><a class="anchor" href="#native_binaries:cunit"></a><a class="link" href="#native_binaries:cunit">CUnit support</a></h4>
<div class="paragraph">
<p>The Gradle <code>cunit</code> plugin provides support for compiling and executing CUnit tests in your native-binary project. For each <a href="../javadoc/org/gradle/nativeplatform/NativeExecutableSpec.html">NativeExecutableSpec</a> and <a href="../javadoc/org/gradle/nativeplatform/NativeLibrarySpec.html">NativeLibrarySpec</a> defined in your project, Gradle will create a matching <a href="../dsl/org.gradle.nativeplatform.test.cunit.CUnitTestSuiteSpec.html">CUnitTestSuiteSpec</a> component, named <code>${component.name}Test</code>.</p>
</div>
<div class="sect4">
<h5 id="sec:cunit_sources"><a class="anchor" href="#sec:cunit_sources"></a><a class="link" href="#sec:cunit_sources">CUnit sources</a></h5>
<div class="paragraph">
<p>Gradle will create a <a href="../dsl/org.gradle.language.c.CSourceSet.html">CSourceSet</a> named 'cunit' for each <a href="../dsl/org.gradle.nativeplatform.test.cunit.CUnitTestSuiteSpec.html">CUnitTestSuiteSpec</a> component in the project. This source set should contain the cunit test files for the component under test. Source files can be located in the conventional location (<code>src/${component.name}Test/cunit</code>) or can be configured like any other source set.</p>
</div>
<div class="paragraph">
<p>Gradle initialises the CUnit test registry and executes the tests, utilising some generated CUnit launcher sources. Gradle will expect and call a function with the signature <code>void gradle_cunit_register()</code> that you can use to configure the actual CUnit suites and tests to execute.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_registering_cunit_tests"><a class="anchor" href="#example_registering_cunit_tests"></a><a class="link" href="#example_registering_cunit_tests">Example: Registering CUnit tests</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">suite_operators.c</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c"><span class="preprocessor">#include</span> <span class="include">&lt;CUnit/Basic.h&gt;</span>
<span class="preprocessor">#include</span> <span class="include">&quot;gradle_cunit_register.h&quot;</span>
<span class="preprocessor">#include</span> <span class="include">&quot;test_operators.h&quot;</span>

<span class="predefined-type">int</span> suite_init(<span class="directive">void</span>) {
    <span class="keyword">return</span> <span class="integer">0</span>;
}

<span class="predefined-type">int</span> suite_clean(<span class="directive">void</span>) {
    <span class="keyword">return</span> <span class="integer">0</span>;
}

<span class="directive">void</span> gradle_cunit_register() {
    CU_pSuite pSuiteMath = CU_add_suite(<span class="string"><span class="delimiter">&quot;</span><span class="content">operator tests</span><span class="delimiter">&quot;</span></span>, suite_init, suite_clean);
    CU_add_test(pSuiteMath, <span class="string"><span class="delimiter">&quot;</span><span class="content">test_plus</span><span class="delimiter">&quot;</span></span>, test_plus);
    CU_add_test(pSuiteMath, <span class="string"><span class="delimiter">&quot;</span><span class="content">test_minus</span><span class="delimiter">&quot;</span></span>, test_minus);
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Due to this mechanism, your CUnit sources may not contain a <code>main</code> method since this will clash with the method provided by Gradle.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:building_cunit_executables"><a class="anchor" href="#sec:building_cunit_executables"></a><a class="link" href="#sec:building_cunit_executables">Building CUnit executables</a></h5>
<div class="paragraph">
<p>A <a href="../dsl/org.gradle.nativeplatform.test.cunit.CUnitTestSuiteSpec.html">CUnitTestSuiteSpec</a> component has an associated <a href="../javadoc/org/gradle/nativeplatform/NativeExecutableSpec.html">NativeExecutableSpec</a> or <a href="../javadoc/org/gradle/nativeplatform/NativeLibrarySpec.html">NativeLibrarySpec</a> component. For each <a href="../javadoc/org/gradle/nativeplatform/NativeBinarySpec.html">NativeBinarySpec</a> configured for the main component, a matching <a href="../dsl/org.gradle.nativeplatform.test.cunit.CUnitTestSuiteBinarySpec.html">CUnitTestSuiteBinarySpec</a> will be configured on the test suite component. These test suite binaries can be configured in a similar way to any other binary instance:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_cunit_tests"><a class="anchor" href="#example_configuring_cunit_tests"></a><a class="link" href="#example_configuring_cunit_tests">Example: Configuring CUnit tests</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    binaries {
        withType(CUnitTestSuiteBinarySpec) {
            lib <span class="key">library</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">cunit</span><span class="delimiter">&quot;</span></span>, <span class="key">linkage</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">static</span><span class="delimiter">&quot;</span></span>

            <span class="keyword">if</span> (flavor == flavors.failing) {
                cCompiler.define <span class="string"><span class="delimiter">&quot;</span><span class="content">PLUS_BROKEN</span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Both the CUnit sources provided by your project and the generated launcher require the core CUnit headers and libraries. Presently, this library dependency must be provided by your project for each <a href="../dsl/org.gradle.nativeplatform.test.cunit.CUnitTestSuiteBinarySpec.html">CUnitTestSuiteBinarySpec</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:running_cunit_tests"><a class="anchor" href="#sec:running_cunit_tests"></a><a class="link" href="#sec:running_cunit_tests">Running CUnit tests</a></h5>
<div class="paragraph">
<p>For each <a href="../dsl/org.gradle.nativeplatform.test.cunit.CUnitTestSuiteBinarySpec.html">CUnitTestSuiteBinarySpec</a>, Gradle will create a task to execute this binary, which will run all of the registered CUnit tests. Test results will be found in the <code><em>${build.dir}</em>/test-results</code> directory.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_running_cunit_tests"><a class="anchor" href="#example_running_cunit_tests"></a><a class="link" href="#example_running_cunit_tests">Example: Running CUnit tests</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">c</span><span class="delimiter">&quot;</span></span>
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">cunit-test-suite</span><span class="delimiter">'</span></span>

model {
    flavors {
        passing
        failing
    }
    platforms {
        x86 {
            architecture <span class="string"><span class="delimiter">&quot;</span><span class="content">x86</span><span class="delimiter">&quot;</span></span>
        }
    }
    repositories {
        libs(PrebuiltLibraries) {
            cunit {
                headers.srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">libs/cunit/2.1-2/include</span><span class="delimiter">&quot;</span></span>
                binaries.withType(StaticLibraryBinary) {
                    staticLibraryFile =
                        file(<span class="string"><span class="delimiter">&quot;</span><span class="content">libs/cunit/2.1-2/lib/</span><span class="delimiter">&quot;</span></span> +
                             findCUnitLibForPlatform(targetPlatform))
                }
            }
        }
    }
    components {
        operators(NativeLibrarySpec) {
            targetPlatform <span class="string"><span class="delimiter">&quot;</span><span class="content">x86</span><span class="delimiter">&quot;</span></span>
        }
    }
    testSuites {
        operatorsTest(CUnitTestSuiteSpec) {
            testing <span class="error">$</span>.components.operators
        }
    }
}
model {
    binaries {
        withType(CUnitTestSuiteBinarySpec) {
            lib <span class="key">library</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">cunit</span><span class="delimiter">&quot;</span></span>, <span class="key">linkage</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">static</span><span class="delimiter">&quot;</span></span>

            <span class="keyword">if</span> (flavor == flavors.failing) {
                cCompiler.define <span class="string"><span class="delimiter">&quot;</span><span class="content">PLUS_BROKEN</span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q runOperatorsTestFailingCUnitExe</code></div>
<div class="content">
<pre>&gt; gradle -q runOperatorsTestFailingCUnitExe

There were test failures:
  1. /home/user/gradle/samples/src/operatorsTest/c/test_plus.c:6  - plus(0, -2) == -2
  2. /home/user/gradle/samples/src/operatorsTest/c/test_plus.c:7  - plus(2, 2) == 4


FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':runOperatorsTestFailingCUnitExe'.
&gt; There were failing tests. See the results at: file:///home/user/gradle/samples/build/test-results/operatorsTest/failing/

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.

* Get more help at https://help.gradle.org

BUILD FAILED in 0s</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/native-binaries/cunit</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The current support for CUnit is quite rudimentary. Plans for future integration include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Allow tests to be declared with Javadoc-style annotations.</p>
</li>
<li>
<p>Improved HTML reporting, similar to that available for JUnit.</p>
</li>
<li>
<p>Real-time feedback for test execution.</p>
</li>
<li>
<p>Support for additional test frameworks.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="native_binaries:google_test"><a class="anchor" href="#native_binaries:google_test"></a><a class="link" href="#native_binaries:google_test">GoogleTest support</a></h4>
<div class="paragraph">
<p>The Gradle <code>google-test</code> plugin provides support for compiling and executing GoogleTest tests in your native-binary project. For each <a href="../javadoc/org/gradle/nativeplatform/NativeExecutableSpec.html">NativeExecutableSpec</a> and <a href="../javadoc/org/gradle/nativeplatform/NativeLibrarySpec.html">NativeLibrarySpec</a> defined in your project, Gradle will create a matching <a href="../dsl/org.gradle.nativeplatform.test.googletest.GoogleTestTestSuiteSpec.html">GoogleTestTestSuiteSpec</a> component, named <code>${component.name}Test</code>.</p>
</div>
<div class="sect4">
<h5 id="sec:googletest_sources"><a class="anchor" href="#sec:googletest_sources"></a><a class="link" href="#sec:googletest_sources">GoogleTest sources</a></h5>
<div class="paragraph">
<p>Gradle will create a <a href="../dsl/org.gradle.language.cpp.CppSourceSet.html">CppSourceSet</a> named 'cpp' for each <a href="../dsl/org.gradle.nativeplatform.test.googletest.GoogleTestTestSuiteSpec.html">GoogleTestTestSuiteSpec</a> component in the project. This source set should contain the GoogleTest test files for the component under test. Source files can be located in the conventional location (<code>src/${component.name}Test/cpp</code>) or can be configured like any other source set.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:building_googletest_executables"><a class="anchor" href="#sec:building_googletest_executables"></a><a class="link" href="#sec:building_googletest_executables">Building GoogleTest executables</a></h5>
<div class="paragraph">
<p>A <a href="../dsl/org.gradle.nativeplatform.test.googletest.GoogleTestTestSuiteSpec.html">GoogleTestTestSuiteSpec</a> component has an associated <a href="../javadoc/org/gradle/nativeplatform/NativeExecutableSpec.html">NativeExecutableSpec</a> or <a href="../javadoc/org/gradle/nativeplatform/NativeLibrarySpec.html">NativeLibrarySpec</a> component. For each <a href="../javadoc/org/gradle/nativeplatform/NativeBinarySpec.html">NativeBinarySpec</a> configured for the main component, a matching <a href="../dsl/org.gradle.nativeplatform.test.googletest.GoogleTestTestSuiteBinarySpec.html">GoogleTestTestSuiteBinarySpec</a> will be configured on the test suite component. These test suite binaries can be configured in a similar way to any other binary instance:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_registering_googletest_tests"><a class="anchor" href="#example_registering_googletest_tests"></a><a class="link" href="#example_registering_googletest_tests">Example: Registering GoogleTest tests</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    binaries {
        withType(GoogleTestTestSuiteBinarySpec) {
            lib <span class="key">library</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">googleTest</span><span class="delimiter">&quot;</span></span>, <span class="key">linkage</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">static</span><span class="delimiter">&quot;</span></span>

            <span class="keyword">if</span> (flavor == flavors.failing) {
                cppCompiler.define <span class="string"><span class="delimiter">&quot;</span><span class="content">PLUS_BROKEN</span><span class="delimiter">&quot;</span></span>
            }

            <span class="keyword">if</span> (targetPlatform.operatingSystem.linux) {
                cppCompiler.args <span class="string"><span class="delimiter">'</span><span class="content">-pthread</span><span class="delimiter">'</span></span>
                linker.args <span class="string"><span class="delimiter">'</span><span class="content">-pthread</span><span class="delimiter">'</span></span>

                <span class="keyword">if</span> (toolChain <span class="keyword">instanceof</span> Gcc || toolChain <span class="keyword">instanceof</span> Clang) {
                    <span class="comment">// Use C++03 with the old ABIs, as this is what the googletest binaries were built with</span>
                    cppCompiler.args <span class="string"><span class="delimiter">'</span><span class="content">-std=c++03</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">-D_GLIBCXX_USE_CXX11_ABI=0</span><span class="delimiter">'</span></span>
                    linker.args <span class="string"><span class="delimiter">'</span><span class="content">-std=c++03</span><span class="delimiter">'</span></span>
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/native-binaries/google-test</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The GoogleTest sources provided by your project require the core GoogleTest headers and libraries. Presently, this library dependency must be provided by your project for each <a href="../dsl/org.gradle.nativeplatform.test.googletest.GoogleTestTestSuiteBinarySpec.html">GoogleTestTestSuiteBinarySpec</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:running_googletest_tests"><a class="anchor" href="#sec:running_googletest_tests"></a><a class="link" href="#sec:running_googletest_tests">Running GoogleTest tests</a></h5>
<div class="paragraph">
<p>For each <a href="../dsl/org.gradle.nativeplatform.test.googletest.GoogleTestTestSuiteBinarySpec.html">GoogleTestTestSuiteBinarySpec</a>, Gradle will create a task to execute this binary, which will run all of the registered GoogleTest tests. Test results will be found in the <code><em>${build.dir}</em>/test-results</code> directory.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The current support for GoogleTest is quite rudimentary. Plans for future integration include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Improved HTML reporting, similar to that available for JUnit.</p>
</li>
<li>
<p>Real-time feedback for test execution.</p>
</li>
<li>
<p>Support for additional test frameworks.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="software_model_concepts"><a class="anchor" href="#software_model_concepts"></a><a class="link" href="#software_model_concepts">Software model concepts</a></h3>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<div class="paragraph">
<p>Rule based configuration <a href="https://blog.gradle.org/state-and-future-of-the-gradle-software-model">will be deprecated</a>. New plugins should not use this concept.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The software model describes how a piece of software is built and how the components of the software relate to each other. The software model is organized around some key concepts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <em>component</em> is a general concept that represents some logical piece of software. Examples of components are a command-line application, a web application or a library. A component is often composed of other components. Most Gradle builds will produce at least one component.</p>
</li>
<li>
<p>A <em>library</em> is a reusable component that is linked into or combined into some other component. In the Java ecosystem, a library is often built as a Jar file, and then later bundled into an application of some kind. In the native ecosystem, a library may be built as a shared library or static library, or both.</p>
</li>
<li>
<p>A <em>source set</em> represents a logical group of source files. Most components are built from source sets of various languages. Some source sets contain source that is written by hand, and some source sets may contain source that is generated from something else.</p>
</li>
<li>
<p>A <em>binary</em> represents some output that is built for a component. A component may produce multiple different output binaries. For example, for a C++ library, both a shared library and a static library binary may be produced. Each binary is initially configured to be built from the component sources, but additional source sets can be added to specific binary variants.</p>
</li>
<li>
<p>A <em>variant</em> represents some mutually exclusive binary of a component. A library, for example, might target Java 7 and Java 8, effectively producing two distinct binaries: a Java 7 Jar and a Java 8 Jar. These are different variants of the library.</p>
</li>
<li>
<p>The <em>API</em> of a library represents the artifacts and dependencies that are required to compile against that library. The API typically consists of a binary together with a set of dependencies.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="software_model"><a class="anchor" href="#software_model"></a><a class="link" href="#software_model">Rule based model configuration</a></h3>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<div class="paragraph">
<p>Rule based configuration <a href="https://blog.gradle.org/state-and-future-of-the-gradle-software-model">will be deprecated</a>. New plugins should not use this concept.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Rule based model configuration enables <em>configuration logic to itself have dependencies</em> on other elements of configuration, and to make use of the resolved states of those other elements of configuration while performing its own configuration.</p>
</div>
<div class="sect3">
<h4 id="sec:background"><a class="anchor" href="#sec:background"></a><a class="link" href="#sec:background">Background</a></h4>
<div class="paragraph">
<p>In a nutshell, the Software Model is a very declarative way to describe how a piece of software is built and the other components it needs as dependencies in the process. It also provides a new, rule-based engine for configuring a Gradle build. When we started to implement the software model we set ourselves the following goals:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Improve configuration and execution time performance.</p>
</li>
<li>
<p>Make customizations of builds with complex tool chains easier.</p>
</li>
<li>
<p>Provide a richer, more standardized way to model different software ecosystems.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle drastically improved configuration performance through other measures. There is no longer any need for a drastic, incompatible change in how Gradle builds are configured. Gradle&#8217;s support for building <a href="#native_software">native software</a> and <a href="#play_plugin">Play Framework applications</a> still use the configuration model.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:basic_concepts"><a class="anchor" href="#sec:basic_concepts"></a><a class="link" href="#sec:basic_concepts">Basic Concepts</a></h4>
<div class="sect4">
<h5 id="sec:the_model_space"><a class="anchor" href="#sec:the_model_space"></a><a class="link" href="#sec:the_model_space">The model space</a></h5>
<div class="paragraph">
<p>The term model spaceis used to refer to the formal model, which can be read and modified by rules.</p>
</div>
<div class="paragraph">
<p>A counterpart to the model space is the project space, which should be familiar to readers. The project space is a graph of objects (e.g <code>project.repositories</code>, <code>project.tasks</code> etc.) having a <a href="../dsl/org.gradle.api.Project.html">Project</a> as its root. A build script is effectively adding and configuring objects of this graph. For the most part, the project space is opaque to Gradle. It is an arbitrary graph of objects that Gradle only partially understands.</p>
</div>
<div class="paragraph">
<p>Each project also has its own model space, which is distinct from the project space. A key characteristic of the model space is that Gradle knows much more about it (which is knowledge that can be put to good use). The objects in the model space are managed, to a greater extent than objects in the project space. The origin, structure, state, collaborators and relationships of objects in the model space are first class constructs. This is effectively the characteristic that functionally distinguishes the model space from the project space: the objects of the model space are defined in ways that Gradle can understand them intimately, as opposed to an object that is the result of running relatively opaque code. A ruleis effectively a building block of this definition.</p>
</div>
<div class="paragraph">
<p>The model space will eventually replace the project space, becoming the only space.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:rules"><a class="anchor" href="#sec:rules"></a><a class="link" href="#sec:rules">Rules</a></h5>
<div class="paragraph">
<p>The model space is defined by rules. A rule is just a function (in the abstract sense) that either produces a model element, or acts upon a model element. Every rule has a single subject and zero or more inputs. Only the subject can be changed by a rule, while the inputs are effectively immutable.</p>
</div>
<div class="paragraph">
<p>Gradle guarantees that all inputs are fully realized before the rule executes. The process of realizing a model element is effectively executing all the rules for which it is the subject, transitioning it to its final state. There is a strong analogy here to Gradle&#8217;s task graph and task execution model. Just as tasks depend on each other and Gradle ensures that dependencies are satisfied before executing a task, rules effectively depend on each other (i.e. a rule depends on all rules whose subject is one of the inputs) and Gradle ensures that all dependencies are satisfied before executing the rule.</p>
</div>
<div class="paragraph">
<p>Model elements are very often defined in terms of other model elements. For example, a compile task&#8217;s configuration can be defined in terms of the configuration of the source set that it is compiling. In this scenario, the compile task would be the subject of a rule and the source set an input. Such a rule could configure the task subject based on the source set input without concern for how it was configured, who it was configured by or when the configuration was specified.</p>
</div>
<div class="paragraph">
<p>There are several ways to declare rules, and in several forms.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:rule_sources"><a class="anchor" href="#sec:rule_sources"></a><a class="link" href="#sec:rule_sources">Rule sources</a></h4>
<div class="paragraph">
<p>One way to define rules is via a <a href="../javadoc/org/gradle/model/RuleSource.html">RuleSource</a> subclass. If an object extends RuleSource and contains any methods annotated by '@Mutate', then each such method defines a rule. For each such method, the first argument is the subject, and zero or more subsequent arguments may follow and are inputs of the rule.</p>
</div>
<div class="sect4">
<h5 id="example_applying_a_rule_source_plugin"><a class="anchor" href="#example_applying_a_rule_source_plugin"></a><a class="link" href="#example_applying_a_rule_source_plugin">Example: applying a rule source plugin</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Managed</span>
<span class="type">interface</span> Person {
  <span class="type">void</span> setFirstName(<span class="predefined-type">String</span> name)
  <span class="predefined-type">String</span> getFirstName()

  <span class="type">void</span> setLastName(<span class="predefined-type">String</span> name)
  <span class="predefined-type">String</span> getLastName()
}

<span class="type">class</span> <span class="class">PersonRules</span> <span class="directive">extends</span> RuleSource {
  <span class="annotation">@Model</span> <span class="type">void</span> person(Person p) {}

  <span class="comment">//Create a rule that modifies a Person and takes no other inputs</span>
  <span class="annotation">@Mutate</span> <span class="type">void</span> setFirstName(Person p) {
    p.firstName = <span class="string"><span class="delimiter">&quot;</span><span class="content">John</span><span class="delimiter">&quot;</span></span>
  }

  <span class="comment">//Create a rule that modifies a ModelMap&lt;Task&gt; and takes as input a Person</span>
  <span class="annotation">@Mutate</span> <span class="type">void</span> createHelloTask(ModelMap&lt;Task&gt; tasks, Person p) {
    tasks.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>) {
      doLast {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="inline"><span class="inline-delimiter">$</span>p</span><span class="content">.firstName </span><span class="inline"><span class="inline-delimiter">$</span>p</span><span class="content">.lastName!</span><span class="delimiter">&quot;</span></span>
      }
    }
  }
}

apply <span class="key">plugin</span>: PersonRules</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle hello</code></strong></div>
<div class="content">
<pre>&gt; gradle hello

&gt; Task :hello
Hello John Smith!

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Each of the different methods of the rule source are discrete, independent rules. Their order, or the fact that they belong to the same class, do not affect their behavior.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_model_creation_rule"><a class="anchor" href="#example_a_model_creation_rule"></a><a class="link" href="#example_a_model_creation_rule">Example: a model creation rule</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Model</span> <span class="type">void</span> person(Person p) {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This rule declares that there is a model element at path <code>"person"</code> (defined by the method name), of type <code>Person</code>. This is the form of the <a href="../javadoc/org/gradle/model/Model.html">Model</a> type rule for <a href="../javadoc/org/gradle/model/Managed.html">Managed</a> types. Here, the person object is the rule subject. The method could potentially have a body, that mutated the person instance. It could also potentially have more parameters, which would be the rule inputs.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_model_mutation_rule"><a class="anchor" href="#example_a_model_mutation_rule"></a><a class="link" href="#example_a_model_mutation_rule">Example: a model mutation rule</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">//Create a rule that modifies a Person and takes no other inputs</span>
<span class="annotation">@Mutate</span> <span class="type">void</span> setFirstName(Person p) {
  p.firstName = <span class="string"><span class="delimiter">&quot;</span><span class="content">John</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This <a href="../javadoc/org/gradle/model/Mutate.html">Mutate</a> rule mutates the person object. The first parameter to the method is the subject. Here, a by-type reference is used as no <a href="../javadoc/org/gradle/model/Path.html">Path</a> annotation is present on the parameter. It could also potentially have more parameters, that would be the rule inputs.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_creating_a_task"><a class="anchor" href="#example_creating_a_task"></a><a class="link" href="#example_creating_a_task">Example: creating a task</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">//Create a rule that modifies a ModelMap&lt;Task&gt; and takes as input a Person</span>
<span class="annotation">@Mutate</span> <span class="type">void</span> createHelloTask(ModelMap&lt;Task&gt; tasks, Person p) {
  tasks.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>) {
    doLast {
      println <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="inline"><span class="inline-delimiter">$</span>p</span><span class="content">.firstName </span><span class="inline"><span class="inline-delimiter">$</span>p</span><span class="content">.lastName!</span><span class="delimiter">&quot;</span></span>
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This <a href="../javadoc/org/gradle/model/Mutate.html">Mutate</a> rule effectively adds a task, by mutating the tasks collection. The subject here is the <code>"tasks"</code> node, which is available as a <a href="../javadoc/org/gradle/model/ModelMap.html">ModelMap</a> of <a href="../dsl/org.gradle.api.Task.html">Task</a>. The only input is our person element. As the person is being used as an input here, it will have been realised before executing this rule. That is, the task container effectively <em>depends on</em> the person element. If there are other configuration rules for the person element, potentially specified in a build script or other plugin, they will also be guaranteed to have been executed.</p>
</div>
<div class="paragraph">
<p>As <code>Person</code> is a <a href="../javadoc/org/gradle/model/Managed.html">Managed</a> type in this example, any attempt to modify the person parameter in this method would result in an exception being thrown. Managed objects enforce immutability at the appropriate point in their lifecycle.</p>
</div>
<div class="paragraph">
<p>Rule source plugins can be packaged and distributed in the same manner as other types of plugins (see <a href="#custom_plugins">Custom Plugins</a>). They also may be applied in the same manner (to project objects) as <a href="../javadoc/org/gradle/api/Plugin.html">Plugin</a> implementations (i.e. via <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:apply(java.util.Map)">Project.apply(java.util.Map)</a>).</p>
</div>
<div class="paragraph">
<p>Please see the documentation for <a href="../javadoc/org/gradle/model/RuleSource.html">RuleSource</a> for more information on constraints on how rule sources must be implemented and for more types of rules.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:advanced_concepts"><a class="anchor" href="#sec:advanced_concepts"></a><a class="link" href="#sec:advanced_concepts">Advanced Concepts</a></h4>
<div class="sect4">
<h5 id="sec:model_paths"><a class="anchor" href="#sec:model_paths"></a><a class="link" href="#sec:model_paths">Model paths</a></h5>
<div class="paragraph">
<p>A model path identifies the location of an element relative to the root of its model space. A common representation is a period-delimited set of names. For example, the model path <code>"tasks"</code> is the path to the element that is the task container. Assuming a task whose name is <code>hello</code>, the path <code>"tasks.hello"</code> is the path to this task.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:managed_model_elements"><a class="anchor" href="#sec:managed_model_elements"></a><a class="link" href="#sec:managed_model_elements">Managed model elements</a></h5>
<div class="paragraph">
<p>Currently, any kind of Java object can be part of the model space. However, there is a difference between managed and unmanagedobjects.</p>
</div>
<div class="paragraph">
<p>A managed object is transparent and enforces immutability once realized. Being transparent means that its structure is understood by the rule infrastructure and as such each of its properties are also individual elements in the model space.</p>
</div>
<div class="paragraph">
<p>An unmanagedobject is opaque to the model space and does not enforce immutability. Over time, more mechanisms will be available for defining managed model elements culminating in all model elements being managed in some way.</p>
</div>
<div class="paragraph">
<p>Managed models can be defined by attaching the <code>@Managed</code> annotation to an interface:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_managed_type"><a class="anchor" href="#example_a_managed_type"></a><a class="link" href="#example_a_managed_type">Example: a managed type</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Managed</span>
<span class="type">interface</span> Person {
  <span class="type">void</span> setFirstName(<span class="predefined-type">String</span> name)
  <span class="predefined-type">String</span> getFirstName()

  <span class="type">void</span> setLastName(<span class="predefined-type">String</span> name)
  <span class="predefined-type">String</span> getLastName()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By defining a getter/setter pair, you are effectively declaring a managed property. A managed property is a property for which Gradle will enforce semantics such as immutability when a node of the model is not the subject of a rule. Therefore, this example declares properties named <em>firstName</em> and <em>lastName</em> on the managed type <em>Person</em>. These properties will only be writable when the view is mutable, that is to say when the <em>Person</em> is the subject of a <code>Rule</code> (see below the explanation for rules).</p>
</div>
<div class="paragraph">
<p>Managed properties can be of any scalar type. In addition, properties can also be of any type which is itself managed:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property type</th>
<th class="tableblock halign-left valign-top">Nullable</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>String</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">void</span> setFirstName(<span class="predefined-type">String</span> name)
<span class="predefined-type">String</span> getFirstName()</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>File</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">void</span> setHomeDirectory(<span class="predefined-type">File</span> homeDir)
<span class="predefined-type">File</span> getHomeDirectory()</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Integer</code>, <code>Boolean</code>, <code>Byte</code>, <code>Short</code>, <code>Float</code>, <code>Long</code>, <code>Double</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">void</span> setId(<span class="predefined-type">Long</span> id)
<span class="predefined-type">Long</span> getId()</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code>, <code>boolean</code>, <code>byte</code>, <code>short</code>, <code>float</code>, <code>long</code>, <code>double</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">void</span> setEmployed(<span class="type">boolean</span> isEmployed)
<span class="type">boolean</span> isEmployed()</code></pre>
</div>
</div>
<hr>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">void</span> setAge(<span class="type">int</span> age)
<span class="type">int</span> getAge()</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Another <em>managed</em> type.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Only if read/write</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">void</span> setMother(Person mother)
Person getMother()</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An <em>enumeration</em> type.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">void</span> setMaritalStatus(MaritalStatus status)
MaritalStatus getMaritalStatus()</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A <code>ManagedSet</code>. A managed set supports the creation of new named model elements, but not their removal.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Only if read/write</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ModelSet&lt;Person&gt; getChildren()</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A <code>Set</code> or <code>List</code> of scalar types. All classic operations on collections are supported: add, remove, clear&#8230;&#8203;</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Only if read/write</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">void</span> setUserGroups(<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; groups)
<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; getUserGroups()</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If the type of a property is itself a managed type, it is possible to declare only a getter, in which case you are declaring a read-only property. A read-only property will be instantiated by Gradle, and cannot be replaced with another object of the same type (for example calling a setter). However, the properties of that property can potentially be changed, if, and only if, the property is the subject of a rule. If it&#8217;s not the case, the property is immutable, like any classic read/write managed property, and properties of the property cannot be changed at all.</p>
</div>
<div class="paragraph">
<p>Managed types can be defined out of interfaces or abstract classes and are usually defined in plugins, which are written either in Java or Groovy. Please see the <a href="../javadoc/org/gradle/model/Managed.html">Managed</a> annotation for more information on creating managed model objects.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:model_element_types"><a class="anchor" href="#sec:model_element_types"></a><a class="link" href="#sec:model_element_types">Model element types</a></h5>
<div class="paragraph">
<p>There are particular types (language types) supported by the model space and can be generalised as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Type definitions</caption>
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scalar</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A scalar type is one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a primitive type (e.g. <code>int</code>) or its boxed type (e.g <code>Integer</code>)</p>
</li>
<li>
<p>a <code>BigInteger</code> or <code>BigDecimal</code></p>
</li>
<li>
<p>a <code>String</code></p>
</li>
<li>
<p>a <code>File</code></p>
</li>
<li>
<p>an enumeration type</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scalar Collection</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A java.util.List or java.util.Set containing one of the scalar types</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Managed type</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Any class which is a valid managed model (i.e.annotated with @<a href="../javadoc/org/gradle/model/Managed.html">Managed</a>)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Managed collection</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A <a href="../javadoc/org/gradle/model/ModelMap.html">ModelMap</a> or <a href="../javadoc/org/gradle/model/ModelSet.html">ModelSet</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>There are various contexts in which these types can be used:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Model type support</caption>
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Context</th>
<th class="tableblock halign-left valign-top">Supported types</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creating top level model elements</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Any managed type</p>
</li>
<li>
<p><a href="../javadoc/org/gradle/language/base/FunctionalSourceSet.html">FunctionalSourceSet</a> (when the <a href="../javadoc/org/gradle/language/base/plugins/LanguageBasePlugin.html">LanguageBasePlugin</a> plugin has been applied)</p>
</li>
<li>
<p>Subtypes of <a href="../javadoc/org/gradle/language/base/LanguageSourceSet.html">LanguageSourceSet</a> which have been registered via <a href="../javadoc/org/gradle/platform/base/ComponentType.html">ComponentType</a></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Properties of managed model elements</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The properties (attributes) of a managed model elements may be one or more of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A managed type</p>
</li>
<li>
<p>A type which is annotated with @<a href="../javadoc/org/gradle/model/Unmanaged.html">Unmanaged</a></p>
</li>
<li>
<p>A Scalar Collection</p>
</li>
<li>
<p>A Managed collection containing managed types</p>
</li>
<li>
<p>A Managed collection containing <a href="../javadoc/org/gradle/language/base/FunctionalSourceSet.html">FunctionalSourceSet</a>'s (when the <a href="../javadoc/org/gradle/language/base/plugins/LanguageBasePlugin.html">LanguageBasePlugin</a> plugin has been applied)</p>
</li>
<li>
<p>Subtypes of <a href="../javadoc/org/gradle/language/base/LanguageSourceSet.html">LanguageSourceSet</a> which have been registered via <a href="../javadoc/org/gradle/platform/base/ComponentType.html">ComponentType</a></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="sec:language_source_sets"><a class="anchor" href="#sec:language_source_sets"></a><a class="link" href="#sec:language_source_sets">Language source sets</a></h5>
<div class="paragraph">
<p><a href="../javadoc/org/gradle/language/base/FunctionalSourceSet.html">FunctionalSourceSet</a>s and subtypes of <a href="../javadoc/org/gradle/language/base/LanguageSourceSet.html">LanguageSourceSet</a> (which have been registered via <a href="../javadoc/org/gradle/platform/base/ComponentType.html">ComponentType</a>) can be added to the model space via rules or via the model DSL.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_strongly_modelling_sources_sets"><a class="anchor" href="#example_strongly_modelling_sources_sets"></a><a class="link" href="#example_strongly_modelling_sources_sets">Example: Strongly modelling sources sets</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java-lang</span><span class="delimiter">'</span></span>

<span class="comment">//Creating LanguageSourceSets via rules</span>
<span class="type">class</span> <span class="class">LanguageSourceSetRules</span> <span class="directive">extends</span> RuleSource {
    <span class="annotation">@Model</span>
    <span class="type">void</span> mySourceSet(JavaSourceSet javaSource) {
        javaSource.source.srcDir(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/main/my</span><span class="delimiter">&quot;</span></span>)
    }
}
apply <span class="key">plugin</span>: LanguageSourceSetRules

<span class="comment">//Creating LanguageSourceSets via the model DSL</span>
model {
    another(JavaSourceSet) {
        source {
            srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">src/main/another</span><span class="delimiter">&quot;</span></span>
        }
    }
}

<span class="comment">//Using FunctionalSourceSets</span>
<span class="annotation">@Managed</span>
<span class="type">interface</span> SourceBundle {
    FunctionalSourceSet getFreeSources()
    FunctionalSourceSet getPaidSources()
}
model {
    sourceBundle(SourceBundle) {
        freeSources.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">main</span><span class="delimiter">&quot;</span></span>, JavaSourceSet)
        freeSources.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">resources</span><span class="delimiter">&quot;</span></span>, JvmResourceSet)
        paidSources.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">main</span><span class="delimiter">&quot;</span></span>, JavaSourceSet)
        paidSources.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">resources</span><span class="delimiter">&quot;</span></span>, JvmResourceSet)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle help</code></div>
<div class="content">
<pre>&gt; gradle help

&gt; Task :help</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/modelRules/language-support</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:references_binding_and_scopes"><a class="anchor" href="#sec:references_binding_and_scopes"></a><a class="link" href="#sec:references_binding_and_scopes">References, binding and scopes</a></h5>
<div class="paragraph">
<p>As previously mentioned, a rule has a subject and zero or more inputs. The rule&#8217;s subject and inputs are declared as references and are boundto model elements before execution by Gradle. Each rule must effectively forward declare the subject and inputs as references. Precisely how this is done depends on the form of the rule. For example, the rules provided by a <a href="../javadoc/org/gradle/model/RuleSource.html">RuleSource</a> declare references as method parameters.</p>
</div>
<div class="paragraph">
<p>A reference is either by-path or by-type.</p>
</div>
<div class="paragraph">
<p>A by-type reference identifies a particular model element by its type. For example, a reference to the <a href="../javadoc/org/gradle/api/tasks/TaskContainer.html">TaskContainer</a> effectively identifies the <code>"tasks"</code> element in the project model space. The model space is not exhaustively searched for candidates for by-type binding; rather, a rule is given a scope (discussed later) that determines the search space for a by-type binding.</p>
</div>
<div class="paragraph">
<p>A by-pathreference identifies a particular model element by its path in model space. By-path references are always relative to the rule scope; there is currently no way to path out of the scope. All by-path references also have an associated type, but this does not influence what the reference binds to. The element identified by the path must however by type compatible with the reference, or a fatal binding failure will occur.</p>
</div>
<div class="sect5">
<h6 id="sec:binding_scope"><a class="anchor" href="#sec:binding_scope"></a><a class="link" href="#sec:binding_scope">Binding scope</a></h6>
<div class="paragraph">
<p>Rules are bound within a scope, which determines how references bind. Most rules are bound at the project scope (i.e. the root of the model graph for the project). However, rules can be scoped to a node within the graph. The <a href="../javadoc/org/gradle/model/ModelMap.html#named-java.lang.String,%20java.lang.Class-">ModelMap.named(java.lang.String, java.lang.Class)</a> method is an example of a mechanism for applying scoped rules. Rules declared in the build script using the <code>model {}</code> block, or via a <code>RuleSource</code> applied as a plugin use the root of the model space as the scope. This can be considered the default scope.</p>
</div>
<div class="paragraph">
<p>By-path references are always relative to the rule scope. When the scope is the root, this effectively allows binding to any element in the graph. When it is not, then only the children of the scope can be referenced using "by-path" notation.</p>
</div>
<div class="paragraph">
<p>When binding by-type references, the following elements are considered:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The scope element itself.</p>
</li>
<li>
<p>The immediate children of the scope element.</p>
</li>
<li>
<p>The immediate children of the model space (i.e. project space) root.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the common case, where the rule is effectively scoped to the root, only the immediate children of the root need to be considered.</p>
</div>
</div>
<div class="sect5">
<h6 id="binding_all_elements_in_scope"><a class="anchor" href="#binding_all_elements_in_scope"></a><a class="link" href="#binding_all_elements_in_scope">Binding to all elements in a scope matching type</a></h6>
<div class="paragraph">
<p>Mutating or validating all elements of a given type in some scope is a common use-case. To accommodate this, rules can be applied via the <code>@Each</code> annotation.</p>
</div>
<div class="paragraph">
<p>In the example below, a <code>@Defaults</code> rule is applied to each <code>FileItem</code> in the model setting a default file size of "1024". Another rule applies a <a href="../javadoc/org/gradle/model/RuleSource.html">RuleSource</a> to every <code>DirectoryItem</code> that makes sure all file sizes are positive and divisible by "16".</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_a_dsl_example_applying_a_rule_to_every_element_in_a_scope"><a class="anchor" href="#example_a_dsl_example_applying_a_rule_to_every_element_in_a_scope"></a><a class="link" href="#example_a_dsl_example_applying_a_rule_to_every_element_in_a_scope">Example: a DSL example applying a rule to every element in a scope</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Managed</span> <span class="type">interface</span> Item <span class="directive">extends</span> Named {}
<span class="annotation">@Managed</span> <span class="type">interface</span> FileItem <span class="directive">extends</span> Item {
    <span class="type">void</span> setSize(<span class="type">int</span> size)
    <span class="type">int</span> getSize()
}
<span class="annotation">@Managed</span> <span class="type">interface</span> DirectoryItem <span class="directive">extends</span> Item {
    ModelMap&lt;Item&gt; getChildren()
}

<span class="type">class</span> <span class="class">PluginRules</span> <span class="directive">extends</span> RuleSource {
    <span class="annotation">@Defaults</span> <span class="type">void</span> setDefaultFileSize(<span class="annotation">@Each</span> FileItem file) {
        file.size = <span class="integer">1024</span>
    }

    <span class="annotation">@Rules</span> <span class="type">void</span> applyValidateRules(ValidateRules rules, <span class="annotation">@Each</span> DirectoryItem directory)  {}
}
apply <span class="key">plugin</span>: PluginRules

<span class="directive">abstract</span> <span class="type">class</span> <span class="class">ValidateRules</span> <span class="directive">extends</span> RuleSource {
    <span class="annotation">@Validate</span>
    <span class="type">void</span> validateSizeIsPositive(ModelMap&lt;FileItem&gt; files) {
        files.each { file -&gt;
            <span class="keyword">assert</span> file.size &gt; <span class="integer">0</span>
        }
    }

    <span class="annotation">@Validate</span>
    <span class="type">void</span> validateSizeDivisibleBySixteen(ModelMap&lt;FileItem&gt; files) {
        files.each { file -&gt;
            <span class="keyword">assert</span> file.size % <span class="integer">16</span> == <span class="integer">0</span>
        }
    }
}

model {
    root(DirectoryItem) {
        children {
            dir(DirectoryItem) {
                children {
                    file1(FileItem)
                    file2(FileItem) { size = <span class="integer">2048</span> }
                }
            }
            file3(FileItem)
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/modelRules/ruleSourcePluginEach</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="model-dsl"><a class="anchor" href="#model-dsl"></a><a class="link" href="#model-dsl">The model DSL</a></h4>
<div class="paragraph">
<p>In addition to using a RuleSource, it is also possible to declare a model and rules directly in a build script using the model DSL.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>The model DSL makes heavy use of various Groovy DSL features. Please have a read of <a href="#groovy-dsl-basics">Groovy DSL basics</a> for an introduction to these Groovy features.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The general form of the model DSL is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    <span class="error"></span>rule-definitions<span class="error"></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All rules are nested inside a <code>model</code> block. There may be any number of rule definitions inside each <code>model</code> block, and there may be any number of <code>model</code> blocks in a build script. You can also use a <code>model</code> block in build scripts that are applied using <code>apply from: $uri</code>.</p>
</div>
<div class="paragraph">
<p>There are currently 2 kinds of rule that you can define using the model DSL: configuration rules, and creation rules.</p>
</div>
<div class="sect4">
<h5 id="sec:configuration_rules"><a class="anchor" href="#sec:configuration_rules"></a><a class="link" href="#sec:configuration_rules">Configuration rules</a></h5>
<div class="paragraph">
<p>You can define a rule that configures a particular model element. A configuration rule has the following form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    <span class="error"></span>model-path-to-subject<span class="error"></span> {
        <span class="error"></span>configuration code<span class="error"></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Continuing with the example so far of the model element <code>"person"</code> of type <code>Person</code> being present, the following DSL snippet adds a configuration rule for the person that sets its <code>lastName</code> property.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_dsl_configuration_rule"><a class="anchor" href="#example_dsl_configuration_rule"></a><a class="link" href="#example_dsl_configuration_rule">Example: DSL configuration rule</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    person {
        lastName = <span class="string"><span class="delimiter">&quot;</span><span class="content">Smith</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A configuration rule specifies a path to the subject that should be configured and a closure containing the code to run when the subject is configured. The closure is executed with the subject passed as the closure delegate. Exactly what code you can provide in the closure depends on the type of the subject. This is discussed below.</p>
</div>
<div class="paragraph">
<p>You should note that the configuration code is not executed immediately but is instead executed only when the subject is required. This is an important behaviour of model rules and allows Gradle to configure only those elements that are required for the build, which helps reduce build time. For example, let&#8217;s run a task that uses the "person" object:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuration_run_when_required"><a class="anchor" href="#example_configuration_run_when_required"></a><a class="link" href="#example_configuration_run_when_required">Example: Configuration run when required</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    person {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">configuring person</span><span class="delimiter">&quot;</span></span>
        lastName = <span class="string"><span class="delimiter">&quot;</span><span class="content">Smith</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle showPerson</code></strong></div>
<div class="content">
<pre>&gt; gradle showPerson
configuring person

&gt; Task :showPerson
Hello John Smith!

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You can see that before the task is run, the "person" element is configured by running the rule closure. Now let&#8217;s run a task that does not require the "person" element:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuration_not_run_when_not_required"><a class="anchor" href="#example_configuration_not_run_when_not_required"></a><a class="link" href="#example_configuration_not_run_when_not_required">Example: Configuration not run when not required</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle somethingElse</code></strong></div>
<div class="content">
<pre>&gt; gradle somethingElse

&gt; Task :somethingElse
Not using person

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>In this instance, you can see that the "person" element is not configured at all.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:creation_rules"><a class="anchor" href="#sec:creation_rules"></a><a class="link" href="#sec:creation_rules">Creation rules</a></h5>
<div class="paragraph">
<p>It is also possible to create model elements at the root level. The general form of a creation rule is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    <span class="error"></span>element-name<span class="error"></span>(<span class="error"></span>element-type<span class="error"></span>) {
        <span class="error"></span>initialization code<span class="error"></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following model rule creates the <code>"person"</code> element:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_dsl_creation_rule"><a class="anchor" href="#example_dsl_creation_rule"></a><a class="link" href="#example_dsl_creation_rule">Example: DSL creation rule</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    person(Person) {
        firstName = <span class="string"><span class="delimiter">&quot;</span><span class="content">John</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A creation rule definition specifies the path of the element to create, plus its public type, represented as a Java interface or class. Only certain types of model elements can be created.</p>
</div>
<div class="paragraph">
<p>A creation rule may also provide a closure containing the initialization code to run when the element is created. The closure is executed with the element passed as the closure delegate. Exactly what code you can provide in the closure depends on the type of the subject. This is discussed below.</p>
</div>
<div class="paragraph">
<p>The initialization closure is optional and can be omitted, for example:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_dsl_creation_rule_without_initialization"><a class="anchor" href="#example_dsl_creation_rule_without_initialization"></a><a class="link" href="#example_dsl_creation_rule_without_initialization">Example: DSL creation rule without initialization</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    barry(Person)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should note that the initialization code is not executed immediately but is instead executed only when the element is required. The initialization code is executed before any configuration rules are run. For example:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_initialization_before_configuration"><a class="anchor" href="#example_initialization_before_configuration"></a><a class="link" href="#example_initialization_before_configuration">Example: Initialization before configuration</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    person {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">configuring person</span><span class="delimiter">&quot;</span></span>
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">last name is </span><span class="inline"><span class="inline-delimiter">$</span>lastName</span><span class="content">, should be Smythe</span><span class="delimiter">&quot;</span></span>
        lastName = <span class="string"><span class="delimiter">&quot;</span><span class="content">Smythe</span><span class="delimiter">&quot;</span></span>
    }
    person(Person) {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">creating person</span><span class="delimiter">&quot;</span></span>
        firstName = <span class="string"><span class="delimiter">&quot;</span><span class="content">John</span><span class="delimiter">&quot;</span></span>
        lastName = <span class="string"><span class="delimiter">&quot;</span><span class="content">Smith</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle showPerson</code></strong></div>
<div class="content">
<pre>&gt; gradle showPerson
creating person
configuring person
last name is Smith, should be Smythe

&gt; Task :showPerson
Hello John Smythe!

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the creation rule appears in the build script <em>after</em> the configuration rule, but its code runs before the code of the configuration rule. Gradle collects up all the rules for a particular subject before running any of them, then runs the rules in the appropriate order.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:model_rule_closures"><a class="anchor" href="#sec:model_rule_closures"></a><a class="link" href="#sec:model_rule_closures">Model rule closures</a></h5>
<div class="paragraph">
<p>Most DSL rules take a closure containing some code to run to configure the subject. The code you can use in this closure depends on the type of the subject of the rule.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can use the <a href="#model-report">model report</a> to determine the type of a particular model element.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In general, a rule closure may contain arbitrary code, mixed with some type specific DSL syntax.</p>
</div>
<div class="sect5">
<h6 id="sec:modelmap_subject"><a class="anchor" href="#sec:modelmap_subject"></a><a class="link" href="#sec:modelmap_subject"><code>ModelMap&lt;T&gt;</code> subject</a></h6>
<div class="paragraph">
<p>A <a href="../javadoc/org/gradle/model/ModelMap.html">ModelMap</a> is basically a map of model elements, indexed by some name. When a <code>ModelMap</code> is used as the subject of a DSL rule, the rule closure can use any of the methods defined on the <a href="../javadoc/org/gradle/model/ModelMap.html">ModelMap</a> interface.</p>
</div>
<div class="paragraph">
<p>A rule closure with <code>ModelMap</code> as a subject can also include nested creation or configuration rules. These behave in a similar way to the creation and configuration rules that appear directly under the <code>model</code> block.</p>
</div>
<div class="paragraph">
<p>Here is an example of a nested creation rule:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_nested_dsl_creation_rule"><a class="anchor" href="#example_nested_dsl_creation_rule"></a><a class="link" href="#example_nested_dsl_creation_rule">Example: Nested DSL creation rule</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    people {
        john(Person) {
            firstName = <span class="string"><span class="delimiter">&quot;</span><span class="content">John</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As before, a nested creation rule defines a name and public type for the element, and optionally, a closure containing code to use to initialize the element. The code is run only when the element is required in the build.</p>
</div>
<div class="paragraph">
<p>Here is an example of a nested configuration rule:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_nested_dsl_configuration_rule"><a class="anchor" href="#example_nested_dsl_configuration_rule"></a><a class="link" href="#example_nested_dsl_configuration_rule">Example: Nested DSL configuration rule</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    people {
        john {
            lastName = <span class="string"><span class="delimiter">&quot;</span><span class="content">Smith</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As before, a nested configuration rule defines the name of the element to configure and a closure containing code to use to configure the element. The code is run only when the element is required in the build.</p>
</div>
<div class="paragraph">
<p><code>ModelMap</code> introduces several other kinds of rules. For example, you can define a rule that targets each of the elements in the map. The code in the rule closure is executed once for each element in the map, when that element is required. Let&#8217;s run a task that requires all of the children of the "people" element:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_dsl_configuration_rule_for_each_element_in_a_map"><a class="anchor" href="#example_dsl_configuration_rule_for_each_element_in_a_map"></a><a class="link" href="#example_dsl_configuration_rule_for_each_element_in_a_map">Example: DSL configuration rule for each element in a map</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    people {
        john(Person) {
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">creating </span><span class="inline"><span class="inline-delimiter">$</span><span class="local-variable">it</span></span><span class="delimiter">&quot;</span></span>
            firstName = <span class="string"><span class="delimiter">&quot;</span><span class="content">John</span><span class="delimiter">&quot;</span></span>
            lastName = <span class="string"><span class="delimiter">&quot;</span><span class="content">Smith</span><span class="delimiter">&quot;</span></span>
        }
        all {
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">configuring </span><span class="inline"><span class="inline-delimiter">$</span><span class="local-variable">it</span></span><span class="delimiter">&quot;</span></span>
        }
        barry(Person) {
            println <span class="string"><span class="delimiter">&quot;</span><span class="content">creating </span><span class="inline"><span class="inline-delimiter">$</span><span class="local-variable">it</span></span><span class="delimiter">&quot;</span></span>
            firstName = <span class="string"><span class="delimiter">&quot;</span><span class="content">Barry</span><span class="delimiter">&quot;</span></span>
            lastName = <span class="string"><span class="delimiter">&quot;</span><span class="content">Barry</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle listPeople</code></strong></div>
<div class="content">
<pre>&gt; gradle listPeople
creating Person 'people.barry'
configuring Person 'people.barry'
creating Person 'people.john'
configuring Person 'people.john'

&gt; Task :listPeople
Hello Barry Barry!
Hello John Smith!

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Any method on <a href="../javadoc/org/gradle/model/ModelMap.html">ModelMap</a> that accepts an <a href="../javadoc/org/gradle/api/Action.html">Action</a> as its last parameter can also be used to define a nested rule.</p>
</div>
<div class="sect5">
<h6 id="sec:managed_type_subject"><a class="anchor" href="#sec:managed_type_subject"></a><a class="link" href="#sec:managed_type_subject"><code>@Managed</code> type subject</a></h6>
<div class="paragraph">
<p>When a managed type is used as the subject of a DSL rule, the rule closure can use any of the methods defined on the managed type interface.</p>
</div>
<div class="paragraph">
<p>A rule closure can also configure the properties of the element using nested closures. For example:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_nested_dsl_property_configuration"><a class="anchor" href="#example_nested_dsl_property_configuration"></a><a class="link" href="#example_nested_dsl_property_configuration">Example: Nested DSL property configuration</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    person {
        address {
            city = <span class="string"><span class="delimiter">&quot;</span><span class="content">Melbourne</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Currently, the nested closures do not define rules and are executed immediately. Please be aware that this behaviour will change in a future Gradle release.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="sec:all_other_subjects"><a class="anchor" href="#sec:all_other_subjects"></a><a class="link" href="#sec:all_other_subjects">All other subjects</a></h6>
<div class="paragraph">
<p>For all other types, the rule closure can use any of the methods defined by the type. There is no special DSL defined for these elements.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="dsl-type-coercion"><a class="anchor" href="#dsl-type-coercion"></a><a class="link" href="#dsl-type-coercion">Automatic type coercion</a></h5>
<div class="paragraph">
<p>Scalar properties in managed types can be assigned <code>CharSequence</code> values (e.g. <code>String</code>, <code>GString</code>, etc.) and they will be converted to the actual property type for you. This works for all scalar types including `File`s, which will be resolved relative to the current project.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_dsl_example_showing_type_conversions"><a class="anchor" href="#example_a_dsl_example_showing_type_conversions"></a><a class="link" href="#example_a_dsl_example_showing_type_conversions">Example: a DSL example showing type conversions</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">enum</span> Temperature {
   TOO_HOT,
   TOO_COLD,
   JUST_RIGHT
}

<span class="annotation">@Managed</span>
<span class="type">interface</span> Item {
   <span class="type">void</span> setName(<span class="predefined-type">String</span> n); <span class="predefined-type">String</span> getName()

   <span class="type">void</span> setQuantity(<span class="type">int</span> q); <span class="type">int</span> getQuantity()

   <span class="type">void</span> setPrice(<span class="type">float</span> p); <span class="type">float</span> getPrice()

   <span class="type">void</span> setTemperature(Temperature t)
   Temperature getTemperature()

   <span class="type">void</span> setDataFile(<span class="predefined-type">File</span> f); <span class="predefined-type">File</span> getDataFile()
}

<span class="type">class</span> <span class="class">ItemRules</span> <span class="directive">extends</span> RuleSource {
   <span class="annotation">@Model</span>
   <span class="type">void</span> item(Item item) {
      <span class="keyword">def</span> data = item.dataFile.text.trim()
      <span class="keyword">def</span> (name, quantity, price, temp) = data.split(<span class="string"><span class="delimiter">'</span><span class="content">,</span><span class="delimiter">'</span></span>)
      item.name = name
      item.quantity = quantity
      item.price = price
      item.temperature = temp
   }

   <span class="annotation">@Defaults</span>
   <span class="type">void</span> setDefaults(Item item) {
      item.dataFile = <span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>
   }

   <span class="annotation">@Mutate</span>
   <span class="type">void</span> createDataTask(ModelMap&lt;Task&gt; tasks, Item item) {
      tasks.create(<span class="string"><span class="delimiter">'</span><span class="content">showData</span><span class="delimiter">'</span></span>) {
         doLast {
            println <span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">
Item '</span><span class="inline"><span class="inline-delimiter">$</span>item</span><span class="content">.name'
   quantity:    </span><span class="inline"><span class="inline-delimiter">$</span>item</span><span class="content">.quantity
   price:       </span><span class="inline"><span class="inline-delimiter">$</span>item</span><span class="content">.price
   temperature: </span><span class="inline"><span class="inline-delimiter">$</span>item</span><span class="content">.temperature</span><span class="delimiter">&quot;&quot;&quot;</span></span>
         }
      }
   }
}

apply <span class="key">plugin</span>: ItemRules

model {
   item {
      price = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>price * (quantity &lt; <span class="integer">10</span> ? <span class="integer">2</span> : <span class="float">0.5</span>)<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
   }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/modelRules/modelDslCoercion</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the above example, an <code>Item</code> is created and is initialized in <code>setDefaults()</code> by providing the path to the data file. In the <code>item()</code> method the resolved <code>File</code> is parsed to extract and set the data. In the DSL block at the end, the price is adjusted based on the quantity; if there are fewer than 10 remaining the price is doubled, otherwise it is reduced by 50%. The <code>GString</code> expression is a valid value since it resolves to a <code>float</code> value in string form.</p>
</div>
<div class="paragraph">
<p>Finally, in <code>createDataTask()</code> we add the <code>showData</code> task to display all of the configured values.</p>
</div>
</div>
<div class="sect4">
<h5 id="dsl-rule-input-dependencies"><a class="anchor" href="#dsl-rule-input-dependencies"></a><a class="link" href="#dsl-rule-input-dependencies">Declaring input dependencies</a></h5>
<div class="paragraph">
<p>Rules declared in the DSL may <em>depend</em> on other model elements through the use of a special syntax, which is of the form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="error">$</span>.<span class="error"></span>path-to-model-element<span class="error"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Paths are a period separated list of identifiers. To directly depend on the <code>firstName</code> of the person, the following could be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="error">$</span>.person.firstName</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_a_dsl_rule_using_inputs"><a class="anchor" href="#example_a_dsl_rule_using_inputs"></a><a class="link" href="#example_a_dsl_rule_using_inputs">Example: a DSL rule using inputs</a></h5>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    tasks {
        hello(Task) {
            <span class="keyword">def</span> p = <span class="error">$</span>.person
            doLast {
                println <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="inline"><span class="inline-delimiter">$</span>p</span><span class="content">.firstName </span><span class="inline"><span class="inline-delimiter">$</span>p</span><span class="content">.lastName!</span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/modelRules/modelDsl</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the above snippet, the <code>$.person</code> construct is an input reference. The construct returns the value of the model element at the specified path, as its default type (i.e. the type advertised by the <a href="#model-report">Model Report</a>). It may appear anywhere in the rule that an expression may normally appear. It is not limited to the right hand side of variable assignments.</p>
</div>
<div class="paragraph">
<p>The input element is guaranteed to be fully configured before the rule executes. That is, all of the rules that mutate the element are guaranteed to have been previously executed, leaving the target element in its final, immutable, state.</p>
</div>
<div class="paragraph">
<p>Most model elements enforce immutability when being used as inputs. Any attempt to mutate such an element will result in a runtime error. However, some legacy type objects do not currently implement such checks. Regardless, it is always invalid to attempt to mutate an input to a rule.</p>
</div>
<div class="sect5">
<h6 id="sec:using_modelmap_as_an_input"><a class="anchor" href="#sec:using_modelmap_as_an_input"></a><a class="link" href="#sec:using_modelmap_as_an_input">Using <code>ModelMap&lt;T&gt;</code> as an input</a></h6>
<div class="paragraph">
<p>When you use a <a href="../javadoc/org/gradle/model/ModelMap.html">ModelMap</a> as input, each item in the map is made available as a property.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="model-report"><a class="anchor" href="#model-report"></a><a class="link" href="#model-report">The model report</a></h4>
<div class="paragraph">
<p>The built-in <a href="../dsl/org.gradle.api.reporting.model.ModelReport.html">ModelReport</a> task displays a hierarchical view of the elements in the model space. Each item prefixed with a <code>+</code> on the model report is a model element and the visual nesting of these elements correlates to the model path (e.g. <code>tasks.help</code>). The model report displays the following details about each model element:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 13. Model report - model element details</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Detail</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is the underlying type of the model element and is typically a fully qualified class name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is conditionally displayed on the report when a model element can be represented as a string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Every model element has a creator. A creator signifies the origin of the model element (i.e. what created the model element).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rules</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is a listing of the rules, excluding the creator rule, which are executed for a given model element. The order in which the rules are displayed reflects the order in which they are executed.</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="example_model_task_output"><a class="anchor" href="#example_model_task_output"></a><a class="link" href="#example_model_task_output">Example: Model task output</a></h5>
<div class="listingblock">
<div class="title">Output of <code>gradle model</code></div>
<div class="content">
<pre>&gt; gradle model

&gt; Task :model

------------------------------------------------------------
Root project
------------------------------------------------------------

+ person
      | Type:   	Person
      | Creator: 	PersonRules#person(Person)
      | Rules:
          person { ... } @ build.gradle line 97, column 3
          PersonRules#setFirstName(Person)
    + age
          | Type:   	int
          | Value:  	0
          | Creator: 	PersonRules#person(Person)
    + children
          | Type:   	org.gradle.model.ModelSet&lt;Person&gt;
          | Creator: 	PersonRules#person(Person)
    + employed
          | Type:   	boolean
          | Value:  	false
          | Creator: 	PersonRules#person(Person)
    + father
          | Type:   	Person
          | Value:  	null
          | Creator: 	PersonRules#person(Person)
    + firstName
          | Type:   	java.lang.String
          | Value:  	John
          | Creator: 	PersonRules#person(Person)
    + homeDirectory
          | Type:   	java.io.File
          | Value:  	null
          | Creator: 	PersonRules#person(Person)
    + id
          | Type:   	java.lang.Long
          | Value:  	null
          | Creator: 	PersonRules#person(Person)
    + lastName
          | Type:   	java.lang.String
          | Value:  	Smith
          | Creator: 	PersonRules#person(Person)
    + maritalStatus
          | Type:   	MaritalStatus
          | Creator: 	PersonRules#person(Person)
    + mother
          | Type:   	Person
          | Value:  	null
          | Creator: 	PersonRules#person(Person)
    + userGroups
          | Type:   	java.util.List&lt;java.lang.String&gt;
          | Value:  	null
          | Creator: 	PersonRules#person(Person)
+ tasks
      | Type:   	org.gradle.model.ModelMap&lt;org.gradle.api.Task&gt;
      | Creator: 	Project.&lt;init&gt;.tasks()
      | Rules:
          PersonRules#createHelloTask(ModelMap&lt;Task&gt;, Person)
    + buildEnvironment
          | Type:   	org.gradle.api.tasks.diagnostics.BuildEnvironmentReportTask
          | Value:  	task ':buildEnvironment'
          | Creator: 	Project.&lt;init&gt;.tasks.buildEnvironment()
          | Rules:
              copyToTaskContainer
    + components
          | Type:   	org.gradle.api.reporting.components.ComponentReport
          | Value:  	task ':components'
          | Creator: 	Project.&lt;init&gt;.tasks.components()
          | Rules:
              copyToTaskContainer
    + dependencies
          | Type:   	org.gradle.api.tasks.diagnostics.DependencyReportTask
          | Value:  	task ':dependencies'
          | Creator: 	Project.&lt;init&gt;.tasks.dependencies()
          | Rules:
              copyToTaskContainer
    + dependencyInsight
          | Type:   	org.gradle.api.tasks.diagnostics.DependencyInsightReportTask
          | Value:  	task ':dependencyInsight'
          | Creator: 	Project.&lt;init&gt;.tasks.dependencyInsight()
          | Rules:
              copyToTaskContainer
    + dependentComponents
          | Type:   	org.gradle.api.reporting.dependents.DependentComponentsReport
          | Value:  	task ':dependentComponents'
          | Creator: 	Project.&lt;init&gt;.tasks.dependentComponents()
          | Rules:
              copyToTaskContainer
    + hello
          | Type:   	org.gradle.api.Task
          | Value:  	task ':hello'
          | Creator: 	PersonRules#createHelloTask(ModelMap&lt;Task&gt;, Person) &gt; create(hello)
          | Rules:
              copyToTaskContainer
    + help
          | Type:   	org.gradle.configuration.Help
          | Value:  	task ':help'
          | Creator: 	Project.&lt;init&gt;.tasks.help()
          | Rules:
              copyToTaskContainer
    + init
          | Type:   	org.gradle.buildinit.tasks.InitBuild
          | Value:  	task ':init'
          | Creator: 	Project.&lt;init&gt;.tasks.init()
          | Rules:
              copyToTaskContainer
    + model
          | Type:   	org.gradle.api.reporting.model.ModelReport
          | Value:  	task ':model'
          | Creator: 	Project.&lt;init&gt;.tasks.model()
          | Rules:
              copyToTaskContainer
    + projects
          | Type:   	org.gradle.api.tasks.diagnostics.ProjectReportTask
          | Value:  	task ':projects'
          | Creator: 	Project.&lt;init&gt;.tasks.projects()
          | Rules:
              copyToTaskContainer
    + properties
          | Type:   	org.gradle.api.tasks.diagnostics.PropertyReportTask
          | Value:  	task ':properties'
          | Creator: 	Project.&lt;init&gt;.tasks.properties()
          | Rules:
              copyToTaskContainer
    + tasks
          | Type:   	org.gradle.api.tasks.diagnostics.TaskReportTask
          | Value:  	task ':tasks'
          | Creator: 	Project.&lt;init&gt;.tasks.tasks()
          | Rules:
              copyToTaskContainer
    + wrapper
          | Type:   	org.gradle.api.tasks.wrapper.Wrapper
          | Value:  	task ':wrapper'
          | Creator: 	Project.&lt;init&gt;.tasks.wrapper()
          | Rules:
              copyToTaskContainer</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:limitations_and_future_direction"><a class="anchor" href="#sec:limitations_and_future_direction"></a><a class="link" href="#sec:limitations_and_future_direction">Limitations and future direction</a></h4>
<div class="paragraph">
<p><em>The rule engine that was part of the Software Model will be deprecated.</em> Everything under the model block will be ported as extensions to the current model. Native users will no longer have a separate extension model compared to the rest of the Gradle community, and they will be able to make use of the new variant aware dependency management. For more information, see the <a href="https://blog.gradle.org/state-and-future-of-the-gradle-software-model">blog post</a> on the state and future of the software model.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rule_source"><a class="anchor" href="#rule_source"></a><a class="link" href="#rule_source">Implementing model rules in a plugin</a></h3>
<div class="paragraph">
<p>A plugin can define rules by extending <a href="../javadoc/org/gradle/model/RuleSource.html">RuleSource</a> and adding methods that define the rules. The plugin class can either extend <a href="../javadoc/org/gradle/model/RuleSource.html">RuleSource</a> directly or can implement <a href="../javadoc/org/gradle/api/Plugin.html">Plugin</a> and include a nested <a href="../javadoc/org/gradle/model/RuleSource.html">RuleSource</a> subclass.</p>
</div>
<div class="paragraph">
<p>Refer to the API docs for <a href="../javadoc/org/gradle/model/RuleSource.html">RuleSource</a> for more details.</p>
</div>
<div class="sect3">
<h4 id="sec:applying_additional_rules"><a class="anchor" href="#sec:applying_additional_rules"></a><a class="link" href="#sec:applying_additional_rules">Applying additional rules</a></h4>
<div class="paragraph">
<p>A rule method annotated with <a href="../javadoc/org/gradle/model/Rules.html">Rules</a> can apply a <a href="../javadoc/org/gradle/model/RuleSource.html">RuleSource</a> to a target model element.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="software_model_extend"><a class="anchor" href="#software_model_extend"></a><a class="link" href="#software_model_extend">Extending the software model</a></h3>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<div class="paragraph">
<p>Rule based configuration <a href="https://blog.gradle.org/state-and-future-of-the-gradle-software-model">will be deprecated</a>. New plugins should not use this concept.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="introduction"><a class="anchor" href="#introduction"></a><a class="link" href="#introduction">Introduction</a></h4>
<div class="paragraph">
<p>One of the strengths of Gradle has always been its extensibility, and its adaptability to new domains. The software model takes this extensibility to a new level, enabling the deep modeling of specific domains via richly typed DSLs. The following chapter describes how the model and the corresponding DSLs can be extended to support domains like the <a href="#play_plugin">Play Framework</a> or <a href="#native_software">native software development</a>. Before reading this you should be familiar with the Gradle software model <a href="#software_model">rule based configuration</a> and <a href="#software_model_concepts">concepts</a>.</p>
</div>
<div class="paragraph">
<p>The following build script is an example of using a custom software model for building Markdown based documentation:</p>
</div>
<div class="sect4">
<h5 id="example_an_example_of_using_a_custom_software_model"><a class="anchor" href="#example_an_example_of_using_a_custom_software_model"></a><a class="link" href="#example_an_example_of_using_a_custom_software_model">Example: an example of using a custom software model</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">sample.documentation.DocumentationComponent</span>
<span class="keyword">import</span> <span class="include">sample.documentation.TextSourceSet</span>
<span class="keyword">import</span> <span class="include">sample.markdown.MarkdownSourceSet</span>

apply <span class="key">plugin</span>:sample.documentation.DocumentationPlugin
apply <span class="key">plugin</span>:sample.markdown.MarkdownPlugin

model {
    components {
        docs(DocumentationComponent) {
            sources {
                reference(TextSourceSet)
                userguide(MarkdownSourceSet) {
                    generateIndex = <span class="predefined-constant">true</span>
                    smartQuotes = <span class="predefined-constant">true</span>
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/customModel/languageType/</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The rest of this chapter is dedicated to explaining what is going on behind this build script.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:concepts"><a class="anchor" href="#sec:concepts"></a><a class="link" href="#sec:concepts">Concepts</a></h4>
<div class="paragraph">
<p>A custom software model type has a public type, a base interface and internal views. Multiple such types then collaborate to define a custom software model.</p>
</div>
<div class="sect4">
<h5 id="sec:public_type_and_base_interfaces"><a class="anchor" href="#sec:public_type_and_base_interfaces"></a><a class="link" href="#sec:public_type_and_base_interfaces">Public type and base interfaces</a></h5>
<div class="paragraph">
<p>Extended types declare a <em>public type</em> that extends a <em>base interface</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Components extend the <a href="../javadoc/org/gradle/platform/base/ComponentSpec.html">ComponentSpec</a> base interface</p>
</li>
<li>
<p>Binaries extend the <a href="../javadoc/org/gradle/platform/base/BinarySpec.html">BinarySpec</a> base interface</p>
</li>
<li>
<p>Source sets extend the <a href="../javadoc/org/gradle/language/base/LanguageSourceSet.html">LanguageSourceSet</a> base interface</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <em>public type</em> is exposed to build logic.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:internal_views"><a class="anchor" href="#sec:internal_views"></a><a class="link" href="#sec:internal_views">Internal views</a></h5>
<div class="paragraph">
<p>Adding internal views to your model type, you can make some data visible to build logic via a public type, while hiding the rest of the data behind the internal view types. This is covered in a <a href="#software-model-extend-internal-views">dedicated section</a> below.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:components_all_the_way_down"><a class="anchor" href="#sec:components_all_the_way_down"></a><a class="link" href="#sec:components_all_the_way_down">Components all the way down</a></h5>
<div class="paragraph">
<p>Components are composed of other components. A source set is just a special kind of component representing sources. It might be that the sources are provided, or generated. Similarly, some components are composed of different binaries, which are built by tasks. All buildable components are built by tasks. In the software model, you will write rules to generate both binaries from components and tasks from binaries.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:components"><a class="anchor" href="#sec:components"></a><a class="link" href="#sec:components">Components</a></h4>
<div class="paragraph">
<p>To declare a custom component type one must extend <a href="../javadoc/org/gradle/platform/base/ComponentSpec.html">ComponentSpec</a>, or one of the following, depending on the use case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../javadoc/org/gradle/platform/base/SourceComponentSpec.html">SourceComponentSpec</a> represents a component which has sources</p>
</li>
<li>
<p><a href="../javadoc/org/gradle/platform/base/VariantComponentSpec.html">VariantComponentSpec</a> represents a component which generates different binaries based on context (target platforms, build flavors, &#8230;&#8203;). Such a component generally produces multiple binaries.</p>
</li>
<li>
<p><a href="../javadoc/org/gradle/platform/base/GeneralComponentSpec.html">GeneralComponentSpec</a> is a convenient base interface for components that are built from sources and variant-aware. This is the typical case for a lot of software components, and therefore it should be in most of the cases the base type to be extended.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The core software model includes more types that can be used as base for extension. For example: <a href="../javadoc/org/gradle/platform/base/LibrarySpec.html">LibrarySpec</a> and <a href="../javadoc/org/gradle/platform/base/ApplicationSpec.html">ApplicationSpec</a> can also be extended in this manner. Theses are no-op extensions of <code>GeneralComponentSpec</code> used to describe a software model better by distinguishing libraries and applications components. <a href="../javadoc/org/gradle/testing/base/TestSuiteSpec.html">TestSuiteSpec</a> should be used for all components that describe a test suite.</p>
</div>
<div class="sect4">
<h5 id="example_declare_a_custom_component"><a class="anchor" href="#example_declare_a_custom_component"></a><a class="link" href="#example_declare_a_custom_component">Example: Declare a custom component</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">DocumentationComponent.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Managed</span>
<span class="type">interface</span> DocumentationComponent <span class="directive">extends</span> GeneralComponentSpec {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Types extending <code>ComponentSpec</code> are registered via a rule annotated with <a href="../javadoc/org/gradle/platform/base/ComponentType.html">ComponentType</a>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_register_a_custom_component"><a class="anchor" href="#example_register_a_custom_component"></a><a class="link" href="#example_register_a_custom_component">Example: Register a custom component</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">DocumentationPlugin.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">DocumentationPlugin</span> <span class="directive">extends</span> RuleSource {
    <span class="annotation">@ComponentType</span>
    <span class="type">void</span> registerComponent(TypeBuilder&lt;DocumentationComponent&gt; builder) {}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:binaries"><a class="anchor" href="#sec:binaries"></a><a class="link" href="#sec:binaries">Binaries</a></h4>
<div class="paragraph">
<p>To declare a custom binary type one must extend <a href="../javadoc/org/gradle/platform/base/BinarySpec.html">BinarySpec</a>.</p>
</div>
<div class="sect4">
<h5 id="example_declare_a_custom_binary"><a class="anchor" href="#example_declare_a_custom_binary"></a><a class="link" href="#example_declare_a_custom_binary">Example: Declare a custom binary</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">DocumentationBinary.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Managed</span>
<span class="type">interface</span> DocumentationBinary <span class="directive">extends</span> BinarySpec {
    <span class="predefined-type">File</span> getOutputDir()
    <span class="type">void</span> setOutputDir(<span class="predefined-type">File</span> outputDir)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Types extending <code>BinarySpec</code> are registered via a rule annotated with <a href="../javadoc/org/gradle/platform/base/ComponentType.html">ComponentType</a>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_register_a_custom_binary"><a class="anchor" href="#example_register_a_custom_binary"></a><a class="link" href="#example_register_a_custom_binary">Example: Register a custom binary</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">DocumentationPlugin.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">DocumentationPlugin</span> <span class="directive">extends</span> RuleSource {
    <span class="annotation">@ComponentType</span>
    <span class="type">void</span> registerBinary(TypeBuilder&lt;DocumentationBinary&gt; builder) {}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:source_sets"><a class="anchor" href="#sec:source_sets"></a><a class="link" href="#sec:source_sets">Source sets</a></h4>
<div class="paragraph">
<p>To declare a custom source set type one must extend <a href="../javadoc/org/gradle/language/base/LanguageSourceSet.html">LanguageSourceSet</a>.</p>
</div>
<div class="sect4">
<h5 id="example_declare_a_custom_source_set"><a class="anchor" href="#example_declare_a_custom_source_set"></a><a class="link" href="#example_declare_a_custom_source_set">Example: Declare a custom source set</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">MarkdownSourceSet.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Managed</span>
<span class="type">interface</span> MarkdownSourceSet <span class="directive">extends</span> LanguageSourceSet {
    <span class="type">boolean</span> isGenerateIndex()
    <span class="type">void</span> setGenerateIndex(<span class="type">boolean</span> generateIndex)

    <span class="type">boolean</span> isSmartQuotes()
    <span class="type">void</span> setSmartQuotes(<span class="type">boolean</span> smartQuotes)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Types extending <code>LanguageSourceSet</code> are registered via a rule annotated with <a href="../javadoc/org/gradle/platform/base/ComponentType.html">ComponentType</a>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_register_a_custom_source_set"><a class="anchor" href="#example_register_a_custom_source_set"></a><a class="link" href="#example_register_a_custom_source_set">Example: Register a custom source set</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">MarkdownPlugin.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">MarkdownPlugin</span> <span class="directive">extends</span> RuleSource {
    <span class="annotation">@ComponentType</span>
    <span class="type">void</span> registerMarkdownLanguage(TypeBuilder&lt;MarkdownSourceSet&gt; builder) {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Setting the <em>language name</em> is mandatory.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:putting_it_all_together"><a class="anchor" href="#sec:putting_it_all_together"></a><a class="link" href="#sec:putting_it_all_together">Putting it all together</a></h4>
<div class="sect4">
<h5 id="sec:generating_binaries_from_components"><a class="anchor" href="#sec:generating_binaries_from_components"></a><a class="link" href="#sec:generating_binaries_from_components">Generating binaries from components</a></h5>
<div class="paragraph">
<p>Binaries generation from components is done via rules annotated with <a href="../javadoc/org/gradle/platform/base/ComponentBinaries.html">ComponentBinaries</a>. This rule generates a <code>DocumentationBinary</code> named <code>exploded</code> for each <code>DocumentationComponent</code> and sets its <code>outputDir</code> property:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_generates_documentation_binaries"><a class="anchor" href="#example_generates_documentation_binaries"></a><a class="link" href="#example_generates_documentation_binaries">Example: Generates documentation binaries</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">DocumentationPlugin.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">DocumentationPlugin</span> <span class="directive">extends</span> RuleSource {
    <span class="annotation">@ComponentBinaries</span>
    <span class="type">void</span> generateDocBinaries(ModelMap&lt;DocumentationBinary&gt; binaries, VariantComponentSpec component, <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">buildDir</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">File</span> buildDir) {
        binaries.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">exploded</span><span class="delimiter">&quot;</span></span>) { binary -&gt;
            outputDir = <span class="keyword">new</span> <span class="predefined-type">File</span>(buildDir, <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>component.name<span class="inline-delimiter">}</span></span><span class="content">/</span><span class="inline"><span class="inline-delimiter">${</span>binary.name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:generating_tasks_from_binaries"><a class="anchor" href="#sec:generating_tasks_from_binaries"></a><a class="link" href="#sec:generating_tasks_from_binaries">Generating tasks from binaries</a></h5>
<div class="paragraph">
<p>Tasks generation from binaries is done via rules annotated with <a href="../javadoc/org/gradle/platform/base/BinaryTasks.html">BinaryTasks</a>. This rule generates a <code>Copy</code> task for each <code>TextSourceSet</code> of each <code>DocumentationBinary</code>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_generates_tasks_for_text_source_sets"><a class="anchor" href="#example_generates_tasks_for_text_source_sets"></a><a class="link" href="#example_generates_tasks_for_text_source_sets">Example: Generates tasks for text source sets</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">DocumentationPlugin.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">DocumentationPlugin</span> <span class="directive">extends</span> RuleSource {
    <span class="annotation">@BinaryTasks</span>
    <span class="type">void</span> generateTextTasks(ModelMap&lt;Task&gt; tasks, <span class="directive">final</span> DocumentationBinary binary) {
        binary.inputs.withType(TextSourceSet) { textSourceSet -&gt;
            <span class="keyword">def</span> taskName = binary.tasks.taskName(<span class="string"><span class="delimiter">&quot;</span><span class="content">compile</span><span class="delimiter">&quot;</span></span>, textSourceSet.name)
            <span class="keyword">def</span> outputDir = <span class="keyword">new</span> <span class="predefined-type">File</span>(binary.outputDir, textSourceSet.name)
            tasks.create(taskName, Copy) {
                from textSourceSet.source
                destinationDir = outputDir
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This rule generates a <code>MarkdownCompileTask</code> task for each <code>MarkdownSourceSet</code> of each <code>DocumentationBinary</code>:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_register_a_custom_source_set_2"><a class="anchor" href="#example_register_a_custom_source_set_2"></a><a class="link" href="#example_register_a_custom_source_set_2">Example: Register a custom source set</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">MarkdownPlugin.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">MarkdownPlugin</span> <span class="directive">extends</span> RuleSource {
    <span class="annotation">@BinaryTasks</span>
    <span class="type">void</span> processMarkdownDocumentation(ModelMap&lt;Task&gt; tasks, <span class="directive">final</span> DocumentationBinary binary) {
        binary.inputs.withType(MarkdownSourceSet) { markdownSourceSet -&gt;
            <span class="keyword">def</span> taskName = binary.tasks.taskName(<span class="string"><span class="delimiter">&quot;</span><span class="content">compile</span><span class="delimiter">&quot;</span></span>, markdownSourceSet.name)
            <span class="keyword">def</span> outputDir = <span class="keyword">new</span> <span class="predefined-type">File</span>(binary.outputDir, markdownSourceSet.name)
            tasks.create(taskName, MarkdownHtmlCompile) { compileTask -&gt;
                compileTask.source = markdownSourceSet.source
                compileTask.destinationDir = outputDir
                compileTask.smartQuotes = markdownSourceSet.smartQuotes
                compileTask.generateIndex = markdownSourceSet.generateIndex
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the sample source for more on the <code>MarkdownCompileTask</code> task.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_your_custom_model"><a class="anchor" href="#sec:using_your_custom_model"></a><a class="link" href="#sec:using_your_custom_model">Using your custom model</a></h5>
<div class="paragraph">
<p>This build script demonstrate usage of the custom model defined in the sections above:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_an_example_of_using_a_custom_software_model_2"><a class="anchor" href="#example_an_example_of_using_a_custom_software_model_2"></a><a class="link" href="#example_an_example_of_using_a_custom_software_model_2">Example: an example of using a custom software model</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">sample.documentation.DocumentationComponent</span>
<span class="keyword">import</span> <span class="include">sample.documentation.TextSourceSet</span>
<span class="keyword">import</span> <span class="include">sample.markdown.MarkdownSourceSet</span>

apply <span class="key">plugin</span>:sample.documentation.DocumentationPlugin
apply <span class="key">plugin</span>:sample.markdown.MarkdownPlugin

model {
    components {
        docs(DocumentationComponent) {
            sources {
                reference(TextSourceSet)
                userguide(MarkdownSourceSet) {
                    generateIndex = <span class="predefined-constant">true</span>
                    smartQuotes = <span class="predefined-constant">true</span>
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/customModel/languageType/</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>And in the components reports for such a build script we can see our model types properly registered:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_components_report"><a class="anchor" href="#example_components_report"></a><a class="link" href="#example_components_report">Example: components report</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q components</code></strong></div>
<div class="content">
<pre>&gt; gradle -q components

------------------------------------------------------------
Root project
------------------------------------------------------------

DocumentationComponent 'docs'
-----------------------------

Source sets
    Markdown source 'docs:userguide'
        srcDir: src/docs/userguide
    Text source 'docs:reference'
        srcDir: src/docs/reference

Binaries
    DocumentationBinary 'docs:exploded'
        build using task: :docsExploded

Note: currently not all plugins register their components, so some components may not be visible here.</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="software-model-extend-internal-views"><a class="anchor" href="#software-model-extend-internal-views"></a><a class="link" href="#software-model-extend-internal-views">About internal views</a></h4>
<div class="paragraph">
<p>Internal views can be added to an already registered type or to a new custom type. In other words, using internal views, you can attach extra properties to already registered components, binaries and source sets types like <code>JvmLibrarySpec</code>, <code>JarBinarySpec</code> or <code>JavaSourceSet</code> and to the custom types you write.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with a simple component public type and its internal view declarations:</p>
</div>
<div class="sect4">
<h5 id="example_public_type_and_internal_view_declaration"><a class="anchor" href="#example_public_type_and_internal_view_declaration"></a><a class="link" href="#example_public_type_and_internal_view_declaration">Example: public type and internal view declaration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Managed</span> <span class="type">interface</span> MyComponent <span class="directive">extends</span> ComponentSpec {
    <span class="predefined-type">String</span> getPublicData()
    <span class="type">void</span> setPublicData(<span class="predefined-type">String</span> data)
}
<span class="annotation">@Managed</span> <span class="type">interface</span> MyComponentInternal <span class="directive">extends</span> MyComponent {
    <span class="predefined-type">String</span> getInternalData()
    <span class="type">void</span> setInternalData(<span class="predefined-type">String</span> internal)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The type registration is as follows:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_type_registration"><a class="anchor" href="#example_type_registration"></a><a class="link" href="#example_type_registration">Example: type registration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">MyPlugin</span> <span class="directive">extends</span> RuleSource {
    <span class="annotation">@ComponentType</span>
    <span class="type">void</span> registerMyComponent(TypeBuilder&lt;MyComponent&gt; builder) {
        builder.internalView(MyComponentInternal)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>internalView(type)</code> method of the type builder can be called several times. This is how you would add several internal views to a type.</p>
</div>
<div class="paragraph">
<p>Now, let&#8217;s mutate both public and internal data using some rule:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_public_and_internal_data_mutation"><a class="anchor" href="#example_public_and_internal_data_mutation"></a><a class="link" href="#example_public_and_internal_data_mutation">Example: public and internal data mutation</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">MyPlugin</span> <span class="directive">extends</span> RuleSource {
    <span class="annotation">@Mutate</span>
    <span class="type">void</span> mutateMyComponents(ModelMap&lt;MyComponentInternal&gt; components) {
        components.all { component -&gt;
            component.publicData = <span class="string"><span class="delimiter">&quot;</span><span class="content">Some PUBLIC data</span><span class="delimiter">&quot;</span></span>
            component.internalData = <span class="string"><span class="delimiter">&quot;</span><span class="content">Some INTERNAL data</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Our <code>internalData</code> property should not be exposed to build logic. Let&#8217;s check this using the <code>model</code> task on the following build file:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_build_script_and_model_report_output"><a class="anchor" href="#example_build_script_and_model_report_output"></a><a class="link" href="#example_build_script_and_model_report_output">Example: Build script and model report output</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: MyPlugin
model {
    components {
        my(MyComponent)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q model</code></div>
<div class="content">
<pre>&gt; gradle -q model

------------------------------------------------------------
Root project
------------------------------------------------------------

+ components
      | Type:   	org.gradle.platform.base.ComponentSpecContainer
      | Creator: 	ComponentBasePlugin.PluginRules#components(ComponentSpecContainer)
      | Rules:
          components { ... } @ build.gradle line 53, column 5
          MyPlugin#mutateMyComponents(ModelMap&lt;MyComponentInternal&gt;)
    + my
          | Type:   	MyComponent
          | Creator: 	components { ... } @ build.gradle line 53, column 5 &gt; create(my)
          | Rules:
              MyPlugin#mutateMyComponents(ModelMap&lt;MyComponentInternal&gt;) &gt; all()
        + publicData
              | Type:   	java.lang.String
              | Value:  	Some PUBLIC data
              | Creator: 	components { ... } @ build.gradle line 53, column 5 &gt; create(my)
+ tasks
      | Type:   	org.gradle.model.ModelMap&lt;org.gradle.api.Task&gt;
      | Creator: 	Project.&lt;init&gt;.tasks()
    + assemble
          | Type:   	org.gradle.api.DefaultTask
          | Value:  	task ':assemble'
          | Creator: 	Project.&lt;init&gt;.tasks.assemble()
          | Rules:
              copyToTaskContainer
    + build
          | Type:   	org.gradle.api.DefaultTask
          | Value:  	task ':build'
          | Creator: 	Project.&lt;init&gt;.tasks.build()
          | Rules:
              copyToTaskContainer
    + buildEnvironment
          | Type:   	org.gradle.api.tasks.diagnostics.BuildEnvironmentReportTask
          | Value:  	task ':buildEnvironment'
          | Creator: 	Project.&lt;init&gt;.tasks.buildEnvironment()
          | Rules:
              copyToTaskContainer
    + check
          | Type:   	org.gradle.api.DefaultTask
          | Value:  	task ':check'
          | Creator: 	Project.&lt;init&gt;.tasks.check()
          | Rules:
              copyToTaskContainer
    + clean
          | Type:   	org.gradle.api.tasks.Delete
          | Value:  	task ':clean'
          | Creator: 	Project.&lt;init&gt;.tasks.clean()
          | Rules:
              copyToTaskContainer
    + components
          | Type:   	org.gradle.api.reporting.components.ComponentReport
          | Value:  	task ':components'
          | Creator: 	Project.&lt;init&gt;.tasks.components()
          | Rules:
              copyToTaskContainer
    + dependencies
          | Type:   	org.gradle.api.tasks.diagnostics.DependencyReportTask
          | Value:  	task ':dependencies'
          | Creator: 	Project.&lt;init&gt;.tasks.dependencies()
          | Rules:
              copyToTaskContainer
    + dependencyInsight
          | Type:   	org.gradle.api.tasks.diagnostics.DependencyInsightReportTask
          | Value:  	task ':dependencyInsight'
          | Creator: 	Project.&lt;init&gt;.tasks.dependencyInsight()
          | Rules:
              copyToTaskContainer
    + dependentComponents
          | Type:   	org.gradle.api.reporting.dependents.DependentComponentsReport
          | Value:  	task ':dependentComponents'
          | Creator: 	Project.&lt;init&gt;.tasks.dependentComponents()
          | Rules:
              copyToTaskContainer
    + help
          | Type:   	org.gradle.configuration.Help
          | Value:  	task ':help'
          | Creator: 	Project.&lt;init&gt;.tasks.help()
          | Rules:
              copyToTaskContainer
    + init
          | Type:   	org.gradle.buildinit.tasks.InitBuild
          | Value:  	task ':init'
          | Creator: 	Project.&lt;init&gt;.tasks.init()
          | Rules:
              copyToTaskContainer
    + model
          | Type:   	org.gradle.api.reporting.model.ModelReport
          | Value:  	task ':model'
          | Creator: 	Project.&lt;init&gt;.tasks.model()
          | Rules:
              copyToTaskContainer
    + projects
          | Type:   	org.gradle.api.tasks.diagnostics.ProjectReportTask
          | Value:  	task ':projects'
          | Creator: 	Project.&lt;init&gt;.tasks.projects()
          | Rules:
              copyToTaskContainer
    + properties
          | Type:   	org.gradle.api.tasks.diagnostics.PropertyReportTask
          | Value:  	task ':properties'
          | Creator: 	Project.&lt;init&gt;.tasks.properties()
          | Rules:
              copyToTaskContainer
    + tasks
          | Type:   	org.gradle.api.tasks.diagnostics.TaskReportTask
          | Value:  	task ':tasks'
          | Creator: 	Project.&lt;init&gt;.tasks.tasks()
          | Rules:
              copyToTaskContainer
    + wrapper
          | Type:   	org.gradle.api.tasks.wrapper.Wrapper
          | Value:  	task ':wrapper'
          | Creator: 	Project.&lt;init&gt;.tasks.wrapper()
          | Rules:
              copyToTaskContainer</pre>
</div>
</div>
<div class="paragraph">
<p>We can see in this report that <code>publicData</code> is present and that <code>internalData</code> is not.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="groovy_projects"><a class="anchor" href="#groovy_projects"></a><a class="link" href="#groovy_projects">Groovy Projects</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="tutorial_groovy_projects"><a class="anchor" href="#tutorial_groovy_projects"></a><a class="link" href="#tutorial_groovy_projects">Groovy Quickstart</a></h3>
<div class="paragraph">
<p>To build a Groovy project, you use the <em>Groovy plugin</em>. This plugin extends the Java plugin to add Groovy compilation capabilities to your project. Your project can contain Groovy source code, Java source code, or a mix of the two. In every other respect, a Groovy project is identical to a Java project, which we have already seen in <a href="#tutorial_java_projects">the Java projects tutorial</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:a_basic_groovy_project"><a class="anchor" href="#sec:a_basic_groovy_project"></a><a class="link" href="#sec:a_basic_groovy_project">A basic Groovy project</a></h4>
<div class="paragraph">
<p>Let&#8217;s look at an example. To use the Groovy plugin, add the following to your build file:</p>
</div>
<div class="sect4">
<h5 id="example_groovy_plugin"><a class="anchor" href="#example_groovy_plugin"></a><a class="link" href="#example_groovy_plugin">Example: Groovy plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">groovy</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/groovy/quickstart</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This will also apply the Java plugin to the project, if it has not already been applied. The Groovy plugin extends the <code>compile</code> task to look for source files in directory <code>src/main/groovy</code>, and the <code>compileTest</code> task to look for test source files in directory <code>src/test/groovy</code>. The compile tasks use joint compilation for these directories, which means they can contain a mixture of Java and Groovy source files.</p>
</div>
<div class="paragraph">
<p>To use the Groovy compilation tasks, you must also declare the Groovy version to use and where to find the Groovy libraries. You do this by adding a dependency to the <code>groovy</code> configuration. The <code>compile</code> configuration inherits this dependency, so the Groovy libraries will be included in classpath when compiling Groovy and Java source. For our sample, we will use Groovy 2.2.0 from the public Maven repository:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_dependency_on_groovy"><a class="anchor" href="#example_dependency_on_groovy"></a><a class="link" href="#example_dependency_on_groovy">Example: Dependency on Groovy</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    compile <span class="string"><span class="delimiter">'</span><span class="content">org.codehaus.groovy:groovy-all:2.4.15</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is our complete build file:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_groovy_example_complete_build_file"><a class="anchor" href="#example_groovy_example_complete_build_file"></a><a class="link" href="#example_groovy_example_complete_build_file">Example: Groovy example - complete build file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">groovy</span><span class="delimiter">'</span></span>
repositories {
    mavenCentral()
}

dependencies {
    compile <span class="string"><span class="delimiter">'</span><span class="content">org.codehaus.groovy:groovy-all:2.4.15</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running <code>gradle build</code> will compile, test and JAR your project.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovy_tutorial_summary"><a class="anchor" href="#sec:groovy_tutorial_summary"></a><a class="link" href="#sec:groovy_tutorial_summary">Summary</a></h4>
<div class="paragraph">
<p>This chapter describes a very simple Groovy project. Usually, a real project will require more than this. Because a Groovy project <em>is</em> a Java project, whatever you can do with a Java project, you can also do with a Groovy project.</p>
</div>
<div class="paragraph">
<p>You can find out more about the <a href="#groovy_plugin">Groovy plugin</a>, and you can find more sample Groovy projects in the <code>samples/groovy</code> directory in the Gradle distribution.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="groovy_plugin"><a class="anchor" href="#groovy_plugin"></a><a class="link" href="#groovy_plugin">The Groovy Plugin</a></h3>
<div class="paragraph">
<p>The Groovy plugin extends the Java plugin to add support for Groovy projects. It can deal with Groovy code, mixed Groovy and Java code, and even pure Java code (although we don&#8217;t necessarily recommend to use it for the latter). The plugin supports <em>joint compilation</em>, which allows you to freely mix and match Groovy and Java code, with dependencies in both directions. For example, a Groovy class can extend a Java class that in turn extends a Groovy class. This makes it possible to use the best language for the job, and to rewrite any class in the other language if needed.</p>
</div>
<div class="sect3">
<h4 id="sec:groovy_usage"><a class="anchor" href="#sec:groovy_usage"></a><a class="link" href="#sec:groovy_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Groovy plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_groovy_plugin"><a class="anchor" href="#example_using_the_groovy_plugin"></a><a class="link" href="#example_using_the_groovy_plugin">Example: Using the Groovy plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">groovy</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovy_tasks"><a class="anchor" href="#sec:groovy_tasks"></a><a class="link" href="#sec:groovy_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Groovy plugin adds the following tasks to the project.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>compileGroovy</code>  <a href="../dsl/org.gradle.api.tasks.compile.GroovyCompile.html">GroovyCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>compileJava</code></p>
<div class="paragraph">
<p>Compiles production Groovy source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>compileTestGroovy</code>  <a href="../dsl/org.gradle.api.tasks.compile.GroovyCompile.html">GroovyCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>compileTestJava</code></p>
<div class="paragraph">
<p>Compiles test Groovy source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>compile<em>SourceSet</em>Groovy</code>  <a href="../dsl/org.gradle.api.tasks.compile.GroovyCompile.html">GroovyCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>compile<em>SourceSet</em>Java</code></p>
<div class="paragraph">
<p>Compiles the given source set&#8217;s Groovy source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>groovydoc</code>  <a href="../dsl/org.gradle.api.tasks.javadoc.Groovydoc.html">Groovydoc</a></dt>
<dd>
<div class="paragraph">
<p>Generates API documentation for the production Groovy source files.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The Groovy plugin adds the following dependencies to tasks added by the Java plugin.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 14. Groovy plugin - additional task dependencies</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Task name</th>
<th class="tableblock halign-left valign-top">Depends on</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>classes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compileGroovy</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>testClasses</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compileTestGroovy</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>sourceSet</em>Classes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compile<em>SourceSet</em>Groovy</code></p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="img/groovyPluginTasks.png" alt="groovyPluginTasks">
</div>
<div class="title">Figure 25. Groovy plugin - tasks</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovy_project_layout"><a class="anchor" href="#sec:groovy_project_layout"></a><a class="link" href="#sec:groovy_project_layout">Project layout</a></h4>
<div class="paragraph">
<p>The Groovy plugin assumes the project layout shown in <a href="#groovylayout">Groovy Layout</a>. All the Groovy source directories can contain Groovy <em>and</em> Java code. The Java source directories may only contain Java source code.<sup class="footnote">[<a id="_footnoteref_9" class="footnote" href="#_footnotedef_9" title="View footnote.">9</a>]</sup> None of these directories need to exist or have anything in them; the Groovy plugin will simply compile whatever it finds.</p>
</div>
<div id="groovylayout" class="dlist">
<dl>
<dt class="hdlist1"><code>src/main/java</code></dt>
<dd>
<p>Production Java source.</p>
</dd>
<dt class="hdlist1"><code>src/main/resources</code></dt>
<dd>
<p>Production resources, such as XML and properties files.</p>
</dd>
<dt class="hdlist1"><code>src/main/groovy</code></dt>
<dd>
<p>Production Groovy source. May also contain Java source files for joint compilation.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/test/java</code></dt>
<dd>
<p>Test Java source.</p>
</dd>
<dt class="hdlist1"><code>src/test/resources</code></dt>
<dd>
<p>Test resources.</p>
</dd>
<dt class="hdlist1"><code>src/test/groovy</code></dt>
<dd>
<p>Test Groovy source. May also contain Java source files for joint compilation.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/java</code></dt>
<dd>
<p>Java source for the source set named <em>sourceSet</em>.</p>
</dd>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/resources</code></dt>
<dd>
<p>Resources for the source set named <em>sourceSet</em>.</p>
</dd>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/groovy</code></dt>
<dd>
<p>Groovy source files for the given source set. May also contain Java source files for joint compilation.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="sec:changing_groovy_project_layout"><a class="anchor" href="#sec:changing_groovy_project_layout"></a><a class="link" href="#sec:changing_groovy_project_layout">Changing the project layout</a></h5>
<div class="paragraph">
<p>Just like the Java plugin, the Groovy plugin allows you to configure custom locations for Groovy production and test source files.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_custom_groovy_source_layout"><a class="anchor" href="#example_custom_groovy_source_layout"></a><a class="link" href="#example_custom_groovy_source_layout">Example: Custom Groovy source layout</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sourceSets {
    main {
        groovy {
            srcDirs = [<span class="string"><span class="delimiter">'</span><span class="content">src/groovy</span><span class="delimiter">'</span></span>]
        }
    }

    test {
        groovy {
            srcDirs = [<span class="string"><span class="delimiter">'</span><span class="content">test/groovy</span><span class="delimiter">'</span></span>]
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovy_dependency_management"><a class="anchor" href="#sec:groovy_dependency_management"></a><a class="link" href="#sec:groovy_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>Because Gradle&#8217;s build language is based on Groovy, and parts of Gradle are implemented in Groovy, Gradle already ships with a Groovy library. Nevertheless, Groovy projects need to explicitly declare a Groovy dependency. This dependency will then be used on compile and runtime class paths. It will also be used to get hold of the Groovy compiler and Groovydoc tool, respectively.</p>
</div>
<div class="paragraph">
<p>If Groovy is used for production code, the Groovy dependency should be added to the <code>compile</code> configuration:</p>
</div>
<div class="sect4">
<h5 id="example_configuration_of_groovy_dependency"><a class="anchor" href="#example_configuration_of_groovy_dependency"></a><a class="link" href="#example_configuration_of_groovy_dependency">Example: Configuration of Groovy dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    compile <span class="string"><span class="delimiter">'</span><span class="content">org.codehaus.groovy:groovy-all:2.4.15</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If Groovy is only used for test code, the Groovy dependency should be added to the <code>testCompile</code> configuration:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuration_of_groovy_test_dependency"><a class="anchor" href="#example_configuration_of_groovy_test_dependency"></a><a class="link" href="#example_configuration_of_groovy_test_dependency">Example: Configuration of Groovy test dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    testCompile <span class="string"><span class="delimiter">'</span><span class="content">org.codehaus.groovy:groovy-all:2.4.15</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use the Groovy library that ships with Gradle, declare a <code>localGroovy()</code> dependency. Note that different Gradle versions ship with different Groovy versions; as such, using <code>localGroovy()</code> is less safe then declaring a regular Groovy dependency.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuration_of_bundled_groovy_dependency"><a class="anchor" href="#example_configuration_of_bundled_groovy_dependency"></a><a class="link" href="#example_configuration_of_bundled_groovy_dependency">Example: Configuration of bundled Groovy dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    compile localGroovy()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Groovy library doesn&#8217;t necessarily have to come from a remote repository. It could also come from a local <code>lib</code> directory, perhaps checked in to source control:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuration_of_groovy_file_dependency"><a class="anchor" href="#example_configuration_of_groovy_file_dependency"></a><a class="link" href="#example_configuration_of_groovy_file_dependency">Example: Configuration of Groovy file dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    flatDir { dirs <span class="string"><span class="delimiter">'</span><span class="content">lib</span><span class="delimiter">'</span></span> }
}

dependencies {
    compile module(<span class="string"><span class="delimiter">'</span><span class="content">org.codehaus.groovy:groovy:2.4.15</span><span class="delimiter">'</span></span>) {
        dependency(<span class="string"><span class="delimiter">'</span><span class="content">org.ow2.asm:asm-all:5.0.3</span><span class="delimiter">'</span></span>)
        dependency(<span class="string"><span class="delimiter">'</span><span class="content">antlr:antlr:2.7.7</span><span class="delimiter">'</span></span>)
        dependency(<span class="string"><span class="delimiter">'</span><span class="content">commons-cli:commons-cli:1.2</span><span class="delimiter">'</span></span>)
        module(<span class="string"><span class="delimiter">'</span><span class="content">org.apache.ant:ant:1.9.4</span><span class="delimiter">'</span></span>) {
            dependencies(<span class="string"><span class="delimiter">'</span><span class="content">org.apache.ant:ant-junit:1.9.4@jar</span><span class="delimiter">'</span></span>,
                         <span class="string"><span class="delimiter">'</span><span class="content">org.apache.ant:ant-launcher:1.9.4</span><span class="delimiter">'</span></span>)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:automatic_configuration_of_groovyclasspath"><a class="anchor" href="#sec:automatic_configuration_of_groovyclasspath"></a><a class="link" href="#sec:automatic_configuration_of_groovyclasspath">Automatic configuration of groovyClasspath</a></h4>
<div class="paragraph">
<p>The <code>GroovyCompile</code> and <code>Groovydoc</code> tasks consume Groovy code in two ways: on their <code>classpath</code>, and on their <code>groovyClasspath</code>. The former is used to locate classes referenced by the source code, and will typically contain the Groovy library along with other libraries. The latter is used to load and execute the Groovy compiler and Groovydoc tool, respectively, and should only contain the Groovy library and its dependencies.</p>
</div>
<div class="paragraph">
<p>Unless a task&#8217;s <code>groovyClasspath</code> is configured explicitly, the Groovy (base) plugin will try to infer it from the task&#8217;s <code>classpath</code>. This is done as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a <code>groovy-all(-indy)</code> Jar is found on <code>classpath</code>, that jar will be added to <code>groovyClasspath</code>.</p>
</li>
<li>
<p>If a <code>groovy(-indy)</code> jar is found on <code>classpath</code>, and the project has at least one repository declared, a corresponding <code>groovy(-indy)</code> repository dependency will be added to <code>groovyClasspath</code>.</p>
</li>
<li>
<p>Otherwise, execution of the task will fail with a message saying that <code>groovyClasspath</code> could not be inferred.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the <code>-indy</code> variation of each jar refers to the version with <code>invokedynamic</code> support.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovy_convention_properties"><a class="anchor" href="#sec:groovy_convention_properties"></a><a class="link" href="#sec:groovy_convention_properties">Convention properties</a></h4>
<div class="paragraph">
<p>The Groovy plugin does not add any convention properties to the project.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovy_source_set_properties"><a class="anchor" href="#sec:groovy_source_set_properties"></a><a class="link" href="#sec:groovy_source_set_properties">Source set properties</a></h4>
<div class="paragraph">
<p>The Groovy plugin adds the following convention properties to each source set in the project. You can use these properties in your build script as though they were properties of the source set object.</p>
</div>
<div class="sect4">
<h5 id="groovy_plugin_source_set_properties"><a class="anchor" href="#groovy_plugin_source_set_properties"></a><a class="link" href="#groovy_plugin_source_set_properties">Groovy Plugin  source set properties</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>groovy</code>  <a href="../dsl/org.gradle.api.file.SourceDirectorySet.html">SourceDirectorySet</a> (read-only)</dt>
<dd>
<p><em>Default value</em>: Not null</p>
<div class="paragraph">
<p>The Groovy source files of this source set. Contains all <code>.groovy</code> and <code>.java</code> files found in the Groovy source directories, and excludes all other types of files.</p>
</div>
</dd>
<dt class="hdlist1"><code>groovy.srcDirs</code>  <code>Set&lt;File&gt;</code></dt>
<dd>
<p><em>Default value</em>: <code>[<em>projectDir</em>/src/<em>name</em>/groovy]</code></p>
<div class="paragraph">
<p>The source directories containing the Groovy source files of this source set. May also contain Java source files for joint compilation. Can set using anything described in <a href="#sec:specifying_multiple_files">Specifying Multiple Files</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>allGroovy</code>  <a href="../javadoc/org/gradle/api/file/FileTree.html">FileTree</a> (read-only)</dt>
<dd>
<p><em>Default value</em>: Not null</p>
<div class="paragraph">
<p>All Groovy source files of this source set. Contains only the <code>.groovy</code> files found in the Groovy source directories.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These properties are provided by a convention object of type <a href="../dsl/org.gradle.api.tasks.GroovySourceSet.html">GroovySourceSet</a>.</p>
</div>
<div class="paragraph">
<p>The Groovy plugin also modifies some source set properties:</p>
</div>
</div>
<div class="sect4">
<h5 id="groovy_plugin_modified_source_set_properties"><a class="anchor" href="#groovy_plugin_modified_source_set_properties"></a><a class="link" href="#groovy_plugin_modified_source_set_properties">Groovy Plugin - modified source set properties</a></h5>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Change</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allJava</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds all <code>.java</code> files found in the Groovy source directories.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds all source files found in the Groovy source directories.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:groovyCompile"><a class="anchor" href="#sec:groovyCompile"></a><a class="link" href="#sec:groovyCompile">GroovyCompile</a></h4>
<div class="paragraph">
<p>The Groovy plugin adds a <a href="../dsl/org.gradle.api.tasks.compile.GroovyCompile.html">GroovyCompile</a> task for each source set in the project. The task type extends the <code>JavaCompile</code> task (see <a href="#sec:compile">the relevant Java Plugin section</a>). The <code>GroovyCompile</code> task supports most configuration options of the official Groovy compiler.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 15. Groovy plugin - GroovyCompile properties</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Task Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>classpath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>sourceSet</em>.compileClasspath</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/file/FileTree.html">FileTree</a>. Can set using anything described in <a href="#sec:specifying_multiple_files">Specifying Multiple Files</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>sourceSet</em>.groovy</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>destinationDir</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>File</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>sourceSet</em>.groovy.outputDir</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>groovyClasspath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>groovy</code> configuration if non-empty; Groovy library found on <code>classpath</code> otherwise</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:groovy_cross_compilation"><a class="anchor" href="#sec:groovy_cross_compilation"></a><a class="link" href="#sec:groovy_cross_compilation">Compiling and testing for Java 6 or Java 7</a></h4>
<div class="paragraph">
<p>The Groovy compiler will always be executed with the same version of Java that was used to start Gradle. You should set <code>sourceCompatibility</code> and <code>targetCompatibility</code> to <code>1.6</code> or <code>1.7</code>. If you also have Java source files, you can follow the same steps as for the <a href="#sec:java_cross_compilation">Java plugin</a> to ensure the correct Java compiler is used.</p>
</div>
<div class="sect4">
<h5 id="example_configure_java_6_build_for_groovy"><a class="anchor" href="#example_configure_java_6_build_for_groovy"></a><a class="link" href="#example_configure_java_6_build_for_groovy">Example: Configure Java 6 build for Groovy</a></h5>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code># in $HOME/.gradle/gradle.properties
java6Home=/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sourceCompatibility = <span class="float">1.6</span>
targetCompatibility = <span class="float">1.6</span>

<span class="keyword">assert</span> hasProperty(<span class="string"><span class="delimiter">'</span><span class="content">java6Home</span><span class="delimiter">'</span></span>) : <span class="string"><span class="delimiter">&quot;</span><span class="content">Set the property 'java6Home' in your your gradle.properties pointing to a Java 6 installation</span><span class="delimiter">&quot;</span></span>
<span class="keyword">def</span> javaExecutablesPath = <span class="keyword">new</span> <span class="predefined-type">File</span>(java6Home, <span class="string"><span class="delimiter">'</span><span class="content">bin</span><span class="delimiter">'</span></span>)
<span class="keyword">def</span> javaExecutables = [:].withDefault { execName -&gt;
    <span class="keyword">def</span> executable = <span class="keyword">new</span> <span class="predefined-type">File</span>(javaExecutablesPath, execName)
    <span class="keyword">assert</span> executable.exists() : <span class="string"><span class="delimiter">&quot;</span><span class="content">There is no </span><span class="inline"><span class="inline-delimiter">${</span>execName<span class="inline-delimiter">}</span></span><span class="content"> executable in </span><span class="inline"><span class="inline-delimiter">${</span>javaExecutablesPath<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    executable
}
tasks.withType(AbstractCompile) {
    options.with {
        fork = <span class="predefined-constant">true</span>
        forkOptions.javaHome = file(java6Home)
    }
}
tasks.withType(Javadoc) {
    executable = javaExecutables.javadoc
}
tasks.withType(Test) {
    executable = javaExecutables.java
}
tasks.withType(JavaExec) {
    executable = javaExecutables.java
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="codenarc_plugin"><a class="anchor" href="#codenarc_plugin"></a><a class="link" href="#codenarc_plugin">The CodeNarc Plugin</a></h3>
<div class="paragraph">
<p>The CodeNarc plugin performs quality checks on your project&#8217;s Groovy source files using <a href="http://codenarc.sourceforge.net/index.html">CodeNarc</a> and generates reports from these checks.</p>
</div>
<div class="sect3">
<h4 id="sec:codenarc_usage"><a class="anchor" href="#sec:codenarc_usage"></a><a class="link" href="#sec:codenarc_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the CodeNarc plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_codenarc_plugin"><a class="anchor" href="#example_using_the_codenarc_plugin"></a><a class="link" href="#example_using_the_codenarc_plugin">Example: Using the CodeNarc plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">codenarc</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The plugin adds a number of tasks to the project that perform the quality checks when used with the <a href="#groovy_plugin">Groovy Plugin</a>. You can execute the checks by running <code>gradle check</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:codenarc_tasks"><a class="anchor" href="#sec:codenarc_tasks"></a><a class="link" href="#sec:codenarc_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The CodeNarc plugin adds the following tasks to the project:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>codenarcMain</code>  <a href="../dsl/org.gradle.api.plugins.quality.CodeNarc.html">CodeNarc</a></dt>
<dd>
<div class="paragraph">
<p>Runs CodeNarc against the production Java source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>codenarcTest</code>  <a href="../dsl/org.gradle.api.plugins.quality.CodeNarc.html">CodeNarc</a></dt>
<dd>
<div class="paragraph">
<p>Runs CodeNarc against the test Java source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>codenarc<em>SourceSet</em></code>  <a href="../dsl/org.gradle.api.plugins.quality.CodeNarc.html">CodeNarc</a></dt>
<dd>
<div class="paragraph">
<p>Runs CodeNarc against the given source set&#8217;s Java source files.</p>
</div>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="dependencies_added_to_other_tasks"><a class="anchor" href="#dependencies_added_to_other_tasks"></a><a class="link" href="#dependencies_added_to_other_tasks">Dependencies added to other tasks</a></h5>
<div class="paragraph">
<p>The CodeNarc plugin adds the following dependencies to tasks defined by the Groovy plugin.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>check</code></dt>
<dd>
<p><em>Depends on</em>: All CodeNarc tasks, including <code>codenarcMain</code> and <code>codenarcTest</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:codenarc_project_layout"><a class="anchor" href="#sec:codenarc_project_layout"></a><a class="link" href="#sec:codenarc_project_layout">Project layout</a></h4>
<div class="paragraph">
<p>The CodeNarc plugin expects the following project layout:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;root&gt;
 config
     codenarc           <b class="conum">(1)</b>
         codenarc.xml   <b class="conum">(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>CodeNarc configuration files go here</p>
</li>
<li>
<p>Primary CodeNarc configuration file</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="sec:codenarc_dependency_management"><a class="anchor" href="#sec:codenarc_dependency_management"></a><a class="link" href="#sec:codenarc_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>The CodeNarc plugin adds the following dependency configurations:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. CodeNarc plugin - dependency configurations</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>codenarc</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The CodeNarc libraries to use</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:codenarc_configuration"><a class="anchor" href="#sec:codenarc_configuration"></a><a class="link" href="#sec:codenarc_configuration">Configuration</a></h4>
<div class="paragraph">
<p>See the <a href="../dsl/org.gradle.api.plugins.quality.CodeNarcExtension.html">CodeNarcExtension</a> class in the API documentation.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="java_projects"><a class="anchor" href="#java_projects"></a><a class="link" href="#java_projects">Java Projects</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="tutorial_java_projects"><a class="anchor" href="#tutorial_java_projects"></a><a class="link" href="#tutorial_java_projects">Java Quickstart</a></h3>
<div class="sect3">
<h4 id="sec:the_java_plugin"><a class="anchor" href="#sec:the_java_plugin"></a><a class="link" href="#sec:the_java_plugin">The Java plugin</a></h4>
<div class="paragraph">
<p>As we have seen, Gradle is a general-purpose build tool. It can build pretty much anything you care to implement in your build script. Out-of-the-box, however, it doesn&#8217;t build anything unless you add code to your build script to do so.</p>
</div>
<div class="paragraph">
<p>Most Java projects are pretty similar as far as the basics go: you need to compile your Java source files, run some unit tests, and create a JAR file containing your classes. It would be nice if you didn&#8217;t have to code all this up for every project. Luckily, you don&#8217;t have to. Gradle solves this problem through the use of <em>plugins</em>. A plugin is an extension to Gradle which configures your project in some way, typically by adding some pre-configured tasks which together do something useful. Gradle ships with a number of plugins, and you can easily write your own and share them with others. One such plugin is the <em>Java plugin</em>. This plugin adds some tasks to your project which will compile and unit test your Java source code, and bundle it into a JAR file.</p>
</div>
<div class="paragraph">
<p>The Java plugin is convention based. This means that the plugin defines default values for many aspects of the project, such as where the Java source files are located. If you follow the convention in your project, you generally don&#8217;t need to do much in your build script to get a useful build. Gradle allows you to customize your project if you don&#8217;t want to or cannot follow the convention in some way. In fact, because support for Java projects is implemented as a plugin, you don&#8217;t have to use the plugin at all to build a Java project, if you don&#8217;t want to.</p>
</div>
<div class="paragraph">
<p>We have in-depth coverage with many examples about the Java plugin, dependency management and multi-project builds in later chapters. In this chapter we want to give you an initial idea of how to use the Java plugin to build a Java project.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:a_basic_java_project"><a class="anchor" href="#sec:a_basic_java_project"></a><a class="link" href="#sec:a_basic_java_project">A basic Java project</a></h4>
<div class="paragraph">
<p>Let&#8217;s look at a simple example. To use the Java plugin, add the following to your build file:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_java_plugin"><a class="anchor" href="#example_using_the_java_plugin"></a><a class="link" href="#example_using_the_java_plugin">Example: Using the Java plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/java/quickstart</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is all you need to define a Java project. This will apply the Java plugin to your project, which adds a number of tasks to your project.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">What tasks are available?</div>
<div class="paragraph">
<p>You can use <code>gradle tasks</code> to list the tasks of a project. This will let you see the tasks that the Java plugin has added to your project.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Gradle expects to find your production source code under <code>src/main/java</code> and your test source code under <code>src/test/java</code>. In addition, any files under <code>src/main/resources</code> will be included in the JAR file as resources, and any files under <code>src/test/resources</code> will be included in the classpath used to run the tests. All output files are created under the <code>build</code> directory, with the JAR file ending up in the <code>build/libs</code> directory.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:building_the_project"><a class="anchor" href="#sec:building_the_project"></a><a class="link" href="#sec:building_the_project">Building the project</a></h5>
<div class="paragraph">
<p>The Java plugin adds quite a few tasks to your project. However, there are only a handful of tasks that you will need to use to build the project. The most commonly used task is the <code>build</code> task, which does a full build of the project. When you run <code>gradle build</code>, Gradle will compile and test your code, and create a JAR file containing your main classes and resources:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_building_a_java_project"><a class="anchor" href="#example_building_a_java_project"></a><a class="link" href="#example_building_a_java_project">Example: Building a Java project</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle build</code></strong></div>
<div class="content">
<pre>&gt; gradle build
&gt; Task :compileJava
&gt; Task :processResources
&gt; Task :classes
&gt; Task :jar
&gt; Task :assemble
&gt; Task :compileTestJava
&gt; Task :processTestResources
&gt; Task :testClasses
&gt; Task :test
&gt; Task :check
&gt; Task :build

BUILD SUCCESSFUL in 0s
6 actionable tasks: 6 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Some other useful tasks are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">clean</dt>
<dd>
<p>Deletes the <code>build</code> directory, removing all built files.</p>
</dd>
<dt class="hdlist1">assemble</dt>
<dd>
<p>Compiles and jars your code, but does not run the unit tests. Other plugins add more artifacts to this task. For example, if you use the War plugin, this task will also build the WAR file for your project.</p>
</dd>
<dt class="hdlist1">check</dt>
<dd>
<p>Compiles and tests your code. Other plugins add more checks to this task. For example, if you use the <code>checkstyle</code> plugin, this task will also run Checkstyle against your source code.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="sec:java_external_dependencies"><a class="anchor" href="#sec:java_external_dependencies"></a><a class="link" href="#sec:java_external_dependencies">External dependencies</a></h5>
<div class="paragraph">
<p>Usually, a Java project will have some dependencies on external JAR files. To reference these JAR files in the project, you need to tell Gradle where to find them. In Gradle, artifacts such as JAR files, are located in a <em>repository</em>. A repository can be used for fetching the dependencies of a project, or for publishing the artifacts of a project, or both. For this example, we will use the public Maven repository:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_maven_repository"><a class="anchor" href="#example_adding_maven_repository"></a><a class="link" href="#example_adding_maven_repository">Example: Adding Maven repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    mavenCentral()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s add some dependencies. Here, we will declare that our production classes have a compile-time dependency on commons collections, and that our test classes have a compile-time dependency on junit:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_dependencies"><a class="anchor" href="#example_adding_dependencies"></a><a class="link" href="#example_adding_dependencies">Example: Adding dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    compile <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">commons-collections</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">commons-collections</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">3.2.2</span><span class="delimiter">'</span></span>
    testCompile <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">junit</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">junit</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">4.+</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can find out more in <a href="#dependency_management_for_java_projects">Dependency Management for Java Projects</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:customizing_the_project"><a class="anchor" href="#sec:customizing_the_project"></a><a class="link" href="#sec:customizing_the_project">Customizing the project</a></h5>
<div class="paragraph">
<p>The Java plugin adds a number of properties to your project. These properties have default values which are usually sufficient to get started. It&#8217;s easy to change these values if they don&#8217;t suit. Let&#8217;s look at this for our sample. Here we will specify the version number for our Java project, along with some attributes to the JAR manifest.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_customization_of_manifest_mf"><a class="anchor" href="#example_customization_of_manifest_mf"></a><a class="link" href="#example_customization_of_manifest_mf">Example: Customization of MANIFEST.MF</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">version = <span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>
jar {
    manifest {
        attributes <span class="string"><span class="delimiter">'</span><span class="content">Implementation-Title</span><span class="delimiter">'</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">Gradle Quickstart</span><span class="delimiter">'</span></span>,
                   <span class="string"><span class="delimiter">'</span><span class="content">Implementation-Version</span><span class="delimiter">'</span></span>: version
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">What properties are available?</div>
<div class="paragraph">
<p>You can use <code>gradle properties</code> to list the properties of a project. This will allow you to see the properties added by the Java plugin, and their default values.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The tasks which the Java plugin adds are regular tasks, exactly the same as if they were declared in the build file. This means you can use any of the mechanisms shown in earlier chapters to customize these tasks. For example, you can set the properties of a task, add behaviour to a task, change the dependencies of a task, or replace a task entirely. In our sample, we will configure the <code>test</code> task, which is of type <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a>, to add a system property when the tests are executed:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_a_test_system_property"><a class="anchor" href="#example_adding_a_test_system_property"></a><a class="link" href="#example_adding_a_test_system_property">Example: Adding a test system property</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    systemProperties <span class="string"><span class="delimiter">'</span><span class="content">property</span><span class="delimiter">'</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">value</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:publishing_the_jar_file"><a class="anchor" href="#sec:publishing_the_jar_file"></a><a class="link" href="#sec:publishing_the_jar_file">Publishing the JAR file</a></h5>
<div class="paragraph">
<p>Usually the JAR file needs to be published somewhere. To do this, you need to tell Gradle where to publish the JAR file. In Gradle, artifacts such as JAR files are published to repositories. In our sample, we will publish to a local directory. You can also publish to a remote location, or multiple locations.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_publishing_the_jar_file"><a class="anchor" href="#example_publishing_the_jar_file"></a><a class="link" href="#example_publishing_the_jar_file">Example: Publishing the JAR file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">uploadArchives {
    repositories {
       flatDir {
           dirs <span class="string"><span class="delimiter">'</span><span class="content">repos</span><span class="delimiter">'</span></span>
       }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To publish the JAR file, run <code>gradle uploadArchives</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:creating_an_eclipse_project"><a class="anchor" href="#sec:creating_an_eclipse_project"></a><a class="link" href="#sec:creating_an_eclipse_project">Creating an Eclipse project</a></h5>
<div class="paragraph">
<p>To create the Eclipse-specific descriptor files, like <code>.project</code>, you need to add another plugin to your build file:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_eclipse_plugin"><a class="anchor" href="#example_eclipse_plugin"></a><a class="link" href="#example_eclipse_plugin">Example: Eclipse plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">eclipse</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now execute <code>gradle eclipse</code> command to generate Eclipse project files. More information about the <code>eclipse</code> task can be found in the <a href="#eclipse_plugin">Eclipse Plugin</a> chapter.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:summary"><a class="anchor" href="#sec:summary"></a><a class="link" href="#sec:summary">Summary</a></h5>
<div class="paragraph">
<p>Here&#8217;s the complete build file for our sample:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_java_example_complete_build_file"><a class="anchor" href="#example_java_example_complete_build_file"></a><a class="link" href="#example_java_example_complete_build_file">Example: Java example - complete build file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">eclipse</span><span class="delimiter">'</span></span>
version = <span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>
jar {
    manifest {
        attributes <span class="string"><span class="delimiter">'</span><span class="content">Implementation-Title</span><span class="delimiter">'</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">Gradle Quickstart</span><span class="delimiter">'</span></span>,
                   <span class="string"><span class="delimiter">'</span><span class="content">Implementation-Version</span><span class="delimiter">'</span></span>: version
    }
}
repositories {
    mavenCentral()
}
dependencies {
    compile <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">commons-collections</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">commons-collections</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">3.2.2</span><span class="delimiter">'</span></span>
    testCompile <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">junit</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">junit</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">4.+</span><span class="delimiter">'</span></span>
}
test {
    systemProperties <span class="string"><span class="delimiter">'</span><span class="content">property</span><span class="delimiter">'</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">value</span><span class="delimiter">'</span></span>
}
uploadArchives {
    repositories {
       flatDir {
           dirs <span class="string"><span class="delimiter">'</span><span class="content">repos</span><span class="delimiter">'</span></span>
       }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:examples"><a class="anchor" href="#sec:examples"></a><a class="link" href="#sec:examples">Multi-project Java build</a></h4>
<div class="paragraph">
<p>Now let&#8217;s look at a typical multi-project build. Below is the layout for the project:</p>
</div>
<div class="listingblock">
<div class="title">Multi-project build - hierarchical layout</div>
<div class="content">
<pre>.
 api
 services
  shared
  webservice
 shared</pre>
</div>
</div>
<div class="paragraph">
<p>Here we have four projects. Project <code>api</code> produces a JAR file which is shipped to the client to provide them a Java client for your XML webservice. Project <code>webservice</code> is a webapp which returns XML. Project <code>shared</code> contains code used both by <code>api</code> and <code>webservice</code>. Project <code>services/shared</code> has code that depends on the <code>shared</code> project.</p>
</div>
<div class="sect4">
<h5 id="sec:defining_a_multiproject_build"><a class="anchor" href="#sec:defining_a_multiproject_build"></a><a class="link" href="#sec:defining_a_multiproject_build">Defining a multi-project build</a></h5>
<div class="paragraph">
<p>To define a multi-project build, you need to create a <em>settings file</em>. The settings file lives in the root directory of the source tree, and specifies which projects to include in the build. It must be called <code>settings.gradle</code>. For this example, we are using a simple hierarchical layout. Here is the corresponding settings file:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_multi_project_build_settings_gradle_file"><a class="anchor" href="#example_multi_project_build_settings_gradle_file"></a><a class="link" href="#example_multi_project_build_settings_gradle_file">Example: Multi-project build - settings.gradle file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">settings.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">include <span class="string"><span class="delimiter">&quot;</span><span class="content">shared</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">api</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">services:webservice</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">services:shared</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can find out more about the settings file in <a href="#multi_project_builds">Authoring Multi-Project Builds</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:common_configuration"><a class="anchor" href="#sec:common_configuration"></a><a class="link" href="#sec:common_configuration">Common configuration</a></h5>
<div class="paragraph">
<p>For most multi-project builds, there is some configuration which is common to all projects. In our sample, we will define this common configuration in the root project, using a technique called <em>configuration injection</em>. Here, the root project is like a container and the <code>subprojects</code> method iterates over the elements of this container - the projects in this instance - and injects the specified configuration. This way we can easily define the manifest content for all archives, and some common dependencies:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_multi_project_build_common_configuration"><a class="anchor" href="#example_multi_project_build_common_configuration"></a><a class="link" href="#example_multi_project_build_common_configuration">Example: Multi-project build - common configuration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">subprojects {
    apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
    apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">eclipse-wtp</span><span class="delimiter">'</span></span>

    repositories {
       mavenCentral()
    }

    dependencies {
        testCompile <span class="string"><span class="delimiter">'</span><span class="content">junit:junit:4.12</span><span class="delimiter">'</span></span>
    }

    version = <span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>

    jar {
        manifest.attributes <span class="key">provider</span>: <span class="string"><span class="delimiter">'</span><span class="content">gradle</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that our sample applies the Java plugin to each subproject. This means the tasks and configuration properties we have seen in the previous section are available in each subproject. So, you can compile, test, and JAR all the projects by running <code>gradle build</code> from the root project directory.</p>
</div>
<div class="paragraph">
<p>Also note that these plugins are only applied within the <code>subprojects</code> section, not at the root level, so the root build will not expect to find Java source files in the root project, only in the subprojects.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:dependencies_between_projects"><a class="anchor" href="#sec:dependencies_between_projects"></a><a class="link" href="#sec:dependencies_between_projects">Dependencies between projects</a></h5>
<div class="paragraph">
<p>You can add dependencies between projects in the same build, so that, for example, the JAR file of one project is used to compile another project. In the <code>api</code> build file we will add a dependency on the <code>shared</code> project. Due to this dependency, Gradle will ensure that project <code>shared</code> always gets built before project <code>api</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_multi_project_build_dependencies_between_projects"><a class="anchor" href="#example_multi_project_build_dependencies_between_projects"></a><a class="link" href="#example_multi_project_build_dependencies_between_projects">Example: Multi-project build - dependencies between projects</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">api/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    compile project(<span class="string"><span class="delimiter">'</span><span class="content">:shared</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:creating_a_distribution"><a class="anchor" href="#sec:creating_a_distribution"></a><a class="link" href="#sec:creating_a_distribution">Creating a distribution</a></h5>
<div class="paragraph">
<p>We also add a distribution, that gets shipped to the client:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_multi_project_build_distribution_file"><a class="anchor" href="#example_multi_project_build_distribution_file"></a><a class="link" href="#example_multi_project_build_distribution_file">Example: Multi-project build - distribution file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">api/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task dist(<span class="key">type</span>: Zip) {
    dependsOn spiJar
    from <span class="string"><span class="delimiter">'</span><span class="content">src/dist</span><span class="delimiter">'</span></span>
    into(<span class="string"><span class="delimiter">'</span><span class="content">libs</span><span class="delimiter">'</span></span>) {
        from spiJar.archivePath
        from configurations.runtime
    }
}

artifacts {
   archives dist
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_tutorial_where_to_next"><a class="anchor" href="#sec:java_tutorial_where_to_next"></a><a class="link" href="#sec:java_tutorial_where_to_next">Where to next?</a></h4>
<div class="paragraph">
<p>In this chapter, you have seen how to do some of the things you commonly need to build a Java based project. This chapter is not exhaustive, and there are many other things you can do with Java projects in Gradle. You can find out more about the <a href="#java_plugin">Java plugin</a>, and you can find more sample Java projects in the <code>samples/java</code> directory in the Gradle distribution.</p>
</div>
<div class="paragraph">
<p>Otherwise, continue on to <a href="#dependency_management_for_java_projects">Dependency Management for Java Projects</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="building_java_projects"><a class="anchor" href="#building_java_projects"></a><a class="link" href="#building_java_projects">Building Java &amp; JVM projects</a></h3>
<div class="paragraph">
<p>Gradle uses a convention-over-configuration approach to building JVM-based projects that borrows several conventions from Apache Maven. In particular, it uses the same default directory structure for source files and resources, and it works with Maven-compatible repositories.</p>
</div>
<div class="paragraph">
<p>We will look at Java projects in detail in this chapter, but most of the topics apply to other supported JVM languages as well, such as <a href="https://guides.gradle.org/building-kotlin-jvm-libraries/">Kotlin</a>, <a href="#groovy_plugin">Groovy</a> and <a href="#scala_plugin">Scala</a>. If you don&#8217;t have much experience with building JVM-based projects with Gradle, take a look at the <a href="#tutorial_java_projects">Java Quickstart</a> first as it will give you a good overview of the basics.</p>
</div>
<div class="sect3">
<h4 id="introduction_2"><a class="anchor" href="#introduction_2"></a><a class="link" href="#introduction_2">Introduction</a></h4>
<div class="paragraph">
<p>The simplest build script for a Java project applies the <a href="#java_plugin">Java Plugin</a> and optionally sets the project version and Java compatibility versions:</p>
</div>
<div class="sect4">
<h5 id="example_applying_the_java_plugin"><a class="anchor" href="#example_applying_the_java_plugin"></a><a class="link" href="#example_applying_the_java_plugin">Example: Applying the Java Plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
}

sourceCompatibility = <span class="string"><span class="delimiter">'</span><span class="content">1.8</span><span class="delimiter">'</span></span>
targetCompatibility = <span class="string"><span class="delimiter">'</span><span class="content">1.8</span><span class="delimiter">'</span></span>
version = <span class="string"><span class="delimiter">'</span><span class="content">1.2.1</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By applying the Java Plugin, you get a whole host of features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>compileJava</code> task that compiles all the Java source files under <em>src/main/java</em></p>
</li>
<li>
<p>A <code>compileTestJava</code> task for source files under <em>src/test/java</em></p>
</li>
<li>
<p>A <code>test</code> task that runs the tests from <em>src/test/java</em></p>
</li>
<li>
<p>A <code>jar</code> task that packages the <code>main</code> compiled classes and resources from <em>src/main/resources</em> into a single JAR named <em>&lt;project&gt;-&lt;version&gt;.jar</em></p>
</li>
<li>
<p>A <code>javadoc</code> task that generates Javadoc for the <code>main</code> classes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This isn&#8217;t sufficient to build any non-trivial Java project  at the very least, you&#8217;ll probably have some file dependencies. But it means that your build script only needs the information that is specific to <em>your</em> project.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Although the properties in the example are optional, we recommend that you specify them in your projects. The compatibility options mitigate against problems with the project being built with different Java compiler versions, and the version string is important for tracking the progression of the project. The project version is also used in archive names by default.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Java Plugin also integrates the above tasks into the standard <a href="#sec:base_tasks">Base Plugin lifecycle tasks</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>jar</code> is attached to <code>assemble</code> <sup class="footnote">[<a id="_footnoteref_10" class="footnote" href="#_footnotedef_10" title="View footnote.">10</a>]</sup></p>
</li>
<li>
<p><code>test</code> is attached to <code>check</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The rest of the chapter explains the different avenues for customizing the build to your requirements. You will also see later how to adjust the build for libraries, applications, web apps and enterprise apps.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_source_sets"><a class="anchor" href="#sec:java_source_sets"></a><a class="link" href="#sec:java_source_sets">Declaring your source files via source sets</a></h4>
<div class="paragraph">
<p>Gradle&#8217;s Java support was the first to introduce a new concept for building source-based projects: <em>source sets</em>. The main idea is that source files and resources are often logically grouped by type, such as application code, unit tests and integration tests. Each logical group typically has its own sets of file dependencies, classpaths, and more. Significantly, the files that form a source set <em>don&#8217;t have to be located in the same directory</em>!</p>
</div>
<div class="paragraph">
<p>Source sets are a powerful concept that tie together several aspects of compilation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the source files and where they&#8217;re located</p>
</li>
<li>
<p>the compilation classpath, including any required dependencies (via Gradle <a href="#sub:terminology_configuration">configurations</a>)</p>
</li>
<li>
<p>where the compiled class files are placed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can see how these relate to one another in this diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/java-sourcesets-compilation.png" alt="java sourcesets compilation">
</div>
<div class="title">Figure 26. Source sets and Java compilation</div>
</div>
<div class="paragraph">
<p>The shaded boxes represent properties of the source set itself. On top of that, the Java Plugin automatically creates a compilation task for every source set you or a plugin defines  named <code>compile<em>SourceSet</em>Java</code>  and several <a href="#java_source_set_configurations">dependency configurations</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">The <code>main</code> source set</div>
<div class="paragraph">
<p>Most language plugins, Java included, automatically create a source set called <code>main</code>, which is used for the project&#8217;s production code. This source set is special in that its name is not included in the names of the configurations and tasks, hence why you have just a <code>compileJava</code> task and <code>compileOnly</code> and <code>implementation</code> configurations rather than <code>compileMainJava</code>, <code>mainCompileOnly</code> and <code>mainImplementation</code> respectively.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Java projects typically include resources other than source files, such as properties files, that may need processing  for example by replacing tokens within the files  and packaging within the final JAR. The Java Plugin handles this by automatically creating a dedicated task for each defined source set called <code>process<em>SourceSet</em>Resources</code> (or <code>processResources</code> for the <code>main</code> source set). The following diagram shows how the source set fits in with this task:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/java-sourcesets-process-resources.png" alt="java sourcesets process resources">
</div>
<div class="title">Figure 27. Processing non-source files for a source set</div>
</div>
<div class="paragraph">
<p>As before, the shaded boxes represent properties of the source set, which in this case comprises the locations of the resource files and where they are copied to.</p>
</div>
<div class="paragraph">
<p>In addition to the <code>main</code> source set, the Java Plugin defines a <code>test</code> source set that represents the project&#8217;s tests. This source set is used by the <code>test</code> task, which runs the tests. You can learn more about this task and related topics in the <a href="#java_testing">Java testing</a> chapter.</p>
</div>
<div class="paragraph">
<p>Projects typically use this source set for unit tests, but you can also use it for integration, acceptance and other types of test if you wish. The alternative approach is to <a href="#sec:custom_java_source_sets">define a new source set</a> for each of your other test types, which is typically done for one or both of the following reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You want to keep the tests separate from one another for aesthetics and manageability</p>
</li>
<li>
<p>The different test types require different compilation or runtime classpaths or some other difference in setup</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can see an example of this approach in the Java testing chapter, which shows you <a href="#sec:configuring_java_integration_tests">how to set up integration tests</a> in a project.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll learn more about source sets and the features they provide in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#sec:custom_java_source_set_paths">Customizing file and directory locations</a></p>
</li>
<li>
<p><a href="#sec:configuring_java_integration_tests">Configuring Java integration tests</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_dependency_management_overview"><a class="anchor" href="#sec:java_dependency_management_overview"></a><a class="link" href="#sec:java_dependency_management_overview">Managing your dependencies</a></h4>
<div class="paragraph">
<p>The vast majority of Java projects rely on libraries, so managing a project&#8217;s dependencies is an important part of building a Java project. Dependency management is a big topic, so we will focus on the basics for Java projects here. If you&#8217;d like to dive into the detail, check out the <a href="#introduction_dependency_management">introduction to dependency management</a>.</p>
</div>
<div class="paragraph">
<p>Specifying the dependencies for your Java project requires just three pieces of information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Which dependency you need, such as a name and version</p>
</li>
<li>
<p>What it&#8217;s needed for, e.g. compilation or running</p>
</li>
<li>
<p>Where to look for it</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first two are specified in a <code>dependencies {}</code> block and the third in a <code>repositories {}</code> block. For example, to tell Gradle that your project requires version 3.6.7 of <a href="http://hibernate.org/">Hibernate</a> Core to compile and run your production code, and that you want to download the library from the Maven Central repository, you can use the following fragment:</p>
</div>
<div class="sect4">
<h5 id="example_declaring_dependencies"><a class="anchor" href="#example_declaring_dependencies"></a><a class="link" href="#example_declaring_dependencies">Example: Declaring dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.hibernate:hibernate-core:3.6.7.Final</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Gradle terminology for the three elements is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Repository</em> (ex: <code>mavenCentral()</code>)  where to look for the modules you declare as dependencies</p>
</li>
<li>
<p><em>Configuration</em> (ex: <code>implementation</code>) - a named collection of dependencies, grouped together for a specific goal such as compiling or running a module a more flexible form of Maven scopes</p>
</li>
<li>
<p><em>Module coordinate</em> (ex: <code>org.hibernate:hibernate-core-3.6.7.Final</code>)  the ID of the dependency, usually in the form '<em>&lt;group&gt;</em>:<em>&lt;module&gt;</em>:<em>&lt;version&gt;</em>' (or '<em>&lt;groupId&gt;</em>:<em>&lt;artifactId&gt;</em>:<em>&lt;version&gt;</em>' in Maven terminology)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find a more comprehensive glossary of dependency management terms <a href="#dependency_management_terminology">here</a>.</p>
</div>
<div class="paragraph">
<p>As far as configurations go, the main ones of interest are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>compileOnly</code> for dependencies that are necessary to compile your production code but shouldn&#8217;t be part of the runtime classpath</p>
</li>
<li>
<p><code>implementation</code> (supersedes <code>compile</code>) used for compilation and runtime</p>
</li>
<li>
<p><code>runtimeOnly</code> (supersedes <code>runtime</code>)  only used at runtime, not for compilation</p>
</li>
<li>
<p><code>testCompileOnly</code>  same as <code>compileOnly</code> except it&#8217;s for the tests</p>
</li>
<li>
<p><code>testImplementation</code> test equivalent of <code>implementation</code></p>
</li>
<li>
<p><code>testRuntimeOnly</code> test equivalent of <code>runtimeOnly</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can learn more about these and how they relate to one another in the <a href="#sec:java_plugin_and_dependency_management">plugin reference chapter</a>.</p>
</div>
<div class="paragraph">
<p>Be aware that the <a href="#java_library_plugin">Java Library Plugin</a> creates an additional configuration  <code>api</code>  for dependencies that are required for compiling both the module and any modules that depend on it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Why no <code>compile</code> configuration?</div>
<div class="paragraph">
<p>The Java Plugin has historically used the <code>compile</code> configuration for dependencies that are required to both compile and run a project&#8217;s production code. It is now deprecated  although it won&#8217;t be going away any time soon  because it doesn&#8217;t distinguish between dependencies that impact the public API of a Java library project and those that don&#8217;t. You can learn more about the importance of this distinction in <a href="#sec:building_java_libraries">Building Java libraries</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We have only scratched the surface here, so we recommend that you read the dedicated dependency management chapters once you&#8217;re comfortable with the basics of building Java projects with Gradle. Some common scenarios that require further reading include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Defining a custom <a href="#sub:maven_repo">Maven-</a> or <a href="#sec:ivy_repositories">Ivy-compatible</a> repository</p>
</li>
<li>
<p>Using dependencies from a <a href="#sec:flat_dir_resolver">local filesystem directory</a></p>
</li>
<li>
<p>Declaring dependencies with <a href="#sub:declaring_dependency_with_changing_version">changing</a> (e.g. SNAPSHOT) and <a href="#sub:declaring_dependency_with_dynamic_version">dynamic</a> (range) versions</p>
</li>
<li>
<p>Declaring a sibling <a href="#sec:declaring_project_dependency">project as a dependency</a></p>
</li>
<li>
<p><a href="#managing_transitive_dependencies">Controlling transitive dependencies and their versions</a></p>
</li>
<li>
<p>Testing your fixes to a 3rd-party dependency via <a href="#composite_builds">composite builds</a> (a better alternative to publishing to and consuming from <a href="#sub:maven_local">Maven Local</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You&#8217;ll discover that Gradle has a rich API for working with dependencies one that takes time to master, but is straightforward to use for common scenarios.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:compile"><a class="anchor" href="#sec:compile"></a><a class="link" href="#sec:compile">Compiling your code</a></h4>
<div class="paragraph">
<p>Compiling both your production and test code can be trivially easy if you follow the conventions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Put your production source code under the <em>src/main/java</em> directory</p>
</li>
<li>
<p>Put your test source code under <em>src/test/java</em></p>
</li>
<li>
<p>Declare your production compile dependencies in the <code>compileOnly</code> or <code>implementation</code> configurations (see previous section)</p>
</li>
<li>
<p>Declare your test compile dependencies in the <code>testCompileOnly</code> or <code>testImplementation</code> configurations</p>
</li>
<li>
<p>Run the <code>compileJava</code> task for the production code and <code>compileTestJava</code> for the tests</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Other JVM language plugins, such as the one for <a href="#groovy_plugin">Groovy</a>, follow the same pattern of conventions. We recommend that you follow these conventions wherever possible, but you don&#8217;t have to. There are several options for customization, as you&#8217;ll see next.</p>
</div>
<div class="sect4">
<h5 id="sec:custom_java_source_set_paths"><a class="anchor" href="#sec:custom_java_source_set_paths"></a><a class="link" href="#sec:custom_java_source_set_paths">Customizing file and directory locations</a></h5>
<div class="paragraph">
<p>Imagine you have a legacy project that uses an <em>src</em> directory for the production code and <em>test</em> for the test code. The conventional directory structure won&#8217;t work, so you need to tell Gradle where to find the source files. You do that via source set configuration.</p>
</div>
<div class="paragraph">
<p>Each source set defines where its source code resides, along with the resources and the output directory for the class files. You can override the convention values by using the following syntax:</p>
</div>
<div class="sect5">
<h6 id="example_declaring_custom_source_directories"><a class="anchor" href="#example_declaring_custom_source_directories"></a><a class="link" href="#example_declaring_custom_source_directories">Example: Declaring custom source directories</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sourceSets {
    main {
         java {
            srcDirs = [<span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>]
         }
    }

    test {
        java {
            srcDirs = [<span class="string"><span class="delimiter">'</span><span class="content">test</span><span class="delimiter">'</span></span>]
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now Gradle will only search directly in <em>src</em> and <em>test</em> for the respective source code. What if you don&#8217;t want to override the convention, but simply want to <em>add</em> an extra source directory, perhaps one that contains some third-party source code you want to keep separate? The syntax is similar:</p>
</div>
</div>
<div class="sect5">
<h6 id="example_declaring_custom_source_directories_additively"><a class="anchor" href="#example_declaring_custom_source_directories_additively"></a><a class="link" href="#example_declaring_custom_source_directories_additively">Example: Declaring custom source directories additively</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sourceSets {
    main {
        java {
            srcDir <span class="string"><span class="delimiter">'</span><span class="content">thirdParty/src/main/java</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Crucially, we&#8217;re using the <em>method</em> <code>srcDir()</code> here to append a directory path, whereas setting the <code>srcDirs</code> property replaces any existing values. This is a common convention in Gradle: setting a property replaces values, while the corresponding method appends values.</p>
</div>
<div class="paragraph">
<p>You can see all the properties and methods available on source sets in the DSL reference for <a href="../dsl/org.gradle.api.tasks.SourceSet.html">SourceSet</a> and <a href="../dsl/org.gradle.api.file.SourceDirectorySet.html">SourceDirectorySet</a>. Note that <code>srcDirs</code> and <code>srcDir()</code> are both on <code>SourceDirectorySet</code>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="changing_compiler_options"><a class="anchor" href="#changing_compiler_options"></a><a class="link" href="#changing_compiler_options">Changing compiler options</a></h5>
<div class="paragraph">
<p>Most of the compiler options are accessible through the corresponding task, such as <code>compileJava</code> and <code>compileTestJava</code>. These tasks are of type <a href="../dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a>, so read the task reference for an up-to-date and comprehensive list of the options.</p>
</div>
<div class="paragraph">
<p>For example, if you want to use a separate JVM process for the compiler and prevent compilation failures from failing the build, you can use this configuration:</p>
</div>
<div class="sect5">
<h6 id="example_setting_java_compiler_options"><a class="anchor" href="#example_setting_java_compiler_options"></a><a class="link" href="#example_setting_java_compiler_options">Example: Setting Java compiler options</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">compileJava {
    options.incremental = <span class="predefined-constant">true</span>
    options.fork = <span class="predefined-constant">true</span>
    options.failOnError = <span class="predefined-constant">false</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s also how you can change the verbosity of the compiler, disable debug output in the byte code and configure where the compiler can find annotation processors.</p>
</div>
<div class="paragraph">
<p>Two common options for the Java compiler are defined at the project level:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>sourceCompatibility</code></dt>
<dd>
<p>Defines which language version of Java your source files should be treated as.</p>
</dd>
<dt class="hdlist1"><code>targetCompatibility</code></dt>
<dd>
<p>Defines the minimum JVM version your code should run on, i.e. it determines the version of byte code the compiler generates.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If you need or want more than one compilation task for any reason, you can either <a href="#sec:custom_java_source_sets">create a new source set</a> or simply define a new task of type <a href="../dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a>. We look at setting up a new source set next.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:java_cross_compilation"><a class="anchor" href="#sec:java_cross_compilation"></a><a class="link" href="#sec:java_cross_compilation">Compiling and testing Java 6/7</a></h5>
<div class="paragraph">
<p>Gradle can only run on Java version 7 or higher. However, support for running Gradle on Java 7 has been deprecated and is scheduled to be removed in Gradle 5.0. There are two reasons for deprecating support for Java 7:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java 7 reached <a href="http://www.oracle.com/technetwork/java/javase/eol-135779.html">end of life</a>. Therefore, Oracle ceased public availability of security fixes and upgrades for Java 7 as of April 2015.</p>
</li>
<li>
<p>Once support for Java 7 has ceased (likely with Gradle 5.0), Gradle&#8217;s implementation can start to use Java 8 APIs optimized for performance and usability.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle still supports compiling, testing, generating Javadoc and executing applications for Java 6 and Java 7. Java 5 is not supported.</p>
</div>
<div class="paragraph">
<p>To use Java 6 or Java 7, the following tasks need to be configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>JavaCompile</code> task to fork and use the correct Java home</p>
</li>
<li>
<p><code>Javadoc</code> task to use the correct <code>javadoc</code> executable</p>
</li>
<li>
<p><code>Test</code> and the <code>JavaExec</code> task to use the correct <code>java</code> executable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sample shows how the <code>build.gradle</code> needs to be adjusted. In order to be able to make the build machine-independent, the location of the old Java home and target version should be configured in <code>GRADLE_USER_HOME/gradle.properties</code> <sup class="footnote">[<a id="_footnoteref_11" class="footnote" href="#_footnotedef_11" title="View footnote.">11</a>]</sup> in the user&#8217;s home directory on each developer machine, as shown in the example.</p>
</div>
<div class="sect5">
<h6 id="example_configure_java_6_build"><a class="anchor" href="#example_configure_java_6_build"></a><a class="link" href="#example_configure_java_6_build">Example: Configure Java 6 build</a></h6>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># in $HOME/.gradle/gradle.properties
javaHome=/Library/Java/JavaVirtualMachines/1.7.0.jdk/Contents/Home
targetJavaVersion=1.7</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">assert</span> hasProperty(<span class="string"><span class="delimiter">'</span><span class="content">javaHome</span><span class="delimiter">'</span></span>): <span class="string"><span class="delimiter">&quot;</span><span class="content">Set the property 'javaHome' in your your gradle.properties pointing to a Java 6 or 7 installation</span><span class="delimiter">&quot;</span></span>
<span class="keyword">assert</span> hasProperty(<span class="string"><span class="delimiter">'</span><span class="content">targetJavaVersion</span><span class="delimiter">'</span></span>): <span class="string"><span class="delimiter">&quot;</span><span class="content">Set the property 'targetJavaVersion' in your your gradle.properties to '1.6' or '1.7'</span><span class="delimiter">&quot;</span></span>

sourceCompatibility = targetJavaVersion

<span class="keyword">def</span> javaExecutablesPath = <span class="keyword">new</span> <span class="predefined-type">File</span>(javaHome, <span class="string"><span class="delimiter">'</span><span class="content">bin</span><span class="delimiter">'</span></span>)
<span class="keyword">def</span> javaExecutables = [:].withDefault { execName -&gt;
    <span class="keyword">def</span> executable = <span class="keyword">new</span> <span class="predefined-type">File</span>(javaExecutablesPath, execName)
    <span class="keyword">assert</span> executable.exists(): <span class="string"><span class="delimiter">&quot;</span><span class="content">There is no </span><span class="inline"><span class="inline-delimiter">${</span>execName<span class="inline-delimiter">}</span></span><span class="content"> executable in </span><span class="inline"><span class="inline-delimiter">${</span>javaExecutablesPath<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    executable
}
tasks.withType(AbstractCompile) {
    options.with {
        fork = <span class="predefined-constant">true</span>
        forkOptions.javaHome = file(javaHome)
    }
}
tasks.withType(Javadoc) {
    executable = javaExecutables.javadoc
}
tasks.withType(Test) {
    executable = javaExecutables.java
}
tasks.withType(JavaExec) {
    executable = javaExecutables.java
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:custom_java_source_sets"><a class="anchor" href="#sec:custom_java_source_sets"></a><a class="link" href="#sec:custom_java_source_sets">Compiling independent sources separately</a></h5>
<div class="paragraph">
<p>Most projects have at least two independent sets of sources: the production code and the test code. Gradle already makes this scenario part of its Java convention, but what if you have other sets of sources? One of the most common scenarios is when you have separate integration tests of some form or other. In that case, a custom source set may be just what you need.</p>
</div>
<div class="paragraph">
<p>You can see a complete example for setting up integration tests in the <a href="#sec:configuring_java_integration_tests">Java testing chapter</a>. You can set up other source sets that fulfil different roles in the same way. The question then becomes: when should you define a custom source set?</p>
</div>
<div class="paragraph">
<p>To answer that question, consider whether the sources:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Need to be compiled with a unique classpath</p>
</li>
<li>
<p>Generate classes that are handled differently from the <code>main</code> and <code>test</code> ones</p>
</li>
<li>
<p>Form a natural part of the project</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If your answer to both 3 and either one of the others is yes, then a custom source set is probably the right approach. For example, integration tests are typically part of the project because they test the code in <code>main</code>. In addition, they often have either their own dependencies independent of the <code>test</code> source set or they need to be run with a custom <code>Test</code> task.</p>
</div>
<div class="paragraph">
<p>Other common scenarios are less clear cut and may have better solutions. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Separate API and implementation JARs it may make sense to have these as separate projects, particularly if you already have a multi-project build</p>
</li>
<li>
<p>Generated sources if the resulting sources should be compiled with the production code, add their path(s) to the <code>main</code> source set and make sure that the <code>compileJava</code> task depends on the task that generates the sources</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you&#8217;re unsure whether to create a custom source set or not, then go ahead and do so. It should be straightforward and if it&#8217;s not, then it&#8217;s probably not the right tool for the job.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_resources"><a class="anchor" href="#sec:java_resources"></a><a class="link" href="#sec:java_resources">Managing resources</a></h4>
<div class="paragraph">
<p>Many Java projects make use of resources beyond source files, such as images, configuration files and localization data. Sometimes these files simply need to be packaged unchanged and sometimes they need to be processed as template files or in some other way. Either way, the Java Plugin adds a specific <a href="../dsl/org.gradle.api.tasks.Copy.html">Copy</a> task for each source set that handles the processing of its associated resources.</p>
</div>
<div class="paragraph">
<p>The task&#8217;s name follows the convention of <code>process<em>SourceSet</em>Resources</code> or <code>processResources</code> for the <code>main</code> source set and it will automatically copy any files in <em>src/[sourceSet]/resources</em> to a directory that will be included in the production JAR. This target directory will also be included in the runtime classpath of the tests.</p>
</div>
<div class="paragraph">
<p>Since <code>processResources</code> is an instance of the <code>Copy</code> task, you can perform any of the processing described in the <a href="#sec:copying_files">Working With Files</a> chapter.</p>
</div>
<div class="sect4">
<h5 id="sec:properties_files"><a class="anchor" href="#sec:properties_files"></a><a class="link" href="#sec:properties_files">Java properties files and reproducible builds</a></h5>
<div class="paragraph">
<p>You can easily create Java properties files via the <a href="../dsl/org.gradle.api.tasks.WriteProperties.html">WriteProperties</a> task, which fixes a well-known problem with <code>Properties.store()</code> that can reduce the usefulness of <a href="#sec:up_to_date_checks">incremental builds</a>.</p>
</div>
<div class="paragraph">
<p>The standard Java API for writing properties files produces a unique file every time, even when the same properties and values are used, because it includes a timestamp in the comments. Gradle&#8217;s <code>WriteProperties</code> task generates exactly the same output byte-for-byte if none of the properties have changed. This is achieved by a few tweaks to how a properties file is generated:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>no timestamp comment is added to the output</p>
</li>
<li>
<p>the line separator is system independent, but can be configured explicitly (it defaults to <code>'\n'</code>)</p>
</li>
<li>
<p>the properties are sorted alphabetically</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sometimes it can be desirable to recreate archives in a byte for byte way on different machines. You want to be sure that building an artifact from source code produces the same result, byte for byte, no matter when and where it is built. This is necessary for projects like reproducible-builds.org.</p>
</div>
<div class="paragraph">
<p>These tweaks not only lead to better incremental build integration, but they also help with <a href="https://reproducible-builds.org">reproducible builds</a>. In essence, reproducible builds guarantee that you will see the same results from a build execution  including test results and production binaries no matter when or on what system you run it.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:running_java_tests"><a class="anchor" href="#sec:running_java_tests"></a><a class="link" href="#sec:running_java_tests">Running tests</a></h4>
<div class="paragraph">
<p>Alongside providing automatic compilation of unit tests in <em>src/test/java</em>, the Java Plugin has native support for running tests that use JUnit 3, 4 &amp; 5 (JUnit 5 support <a href="https://docs.gradle.org/4.6/release-notes.html#junit-5-support">came in Gradle 4.6</a>) and TestNG. You get:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An automatic <code>test</code> task of type <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a>, using the <code>test</code> source set</p>
</li>
<li>
<p>An HTML test report that includes the results from <em>all</em> <code>Test</code> tasks that run</p>
</li>
<li>
<p>Easy filtering of which tests to run</p>
</li>
<li>
<p>Fine-grained control over how the tests are run</p>
</li>
<li>
<p>The opportunity to create your own test execution and test reporting tasks</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You do <em>not</em> get a <code>Test</code> task for every source set you declare, since not every source set represents tests! That&#8217;s why you typically need to <a href="#sec:custom_java_source_sets">create your own <code>Test</code> tasks</a> for things like integration and acceptance tests if they can&#8217;t be included with the <code>test</code> source set.</p>
</div>
<div class="paragraph">
<p>As there is a lot to cover when it comes to testing, the topic has its <a href="#java_testing">own chapter</a> in which we look at:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How tests are run</p>
</li>
<li>
<p>How to run a subset of tests via filtering</p>
</li>
<li>
<p>How Gradle discovers tests</p>
</li>
<li>
<p>How to configure test reporting and add your own reporting tasks</p>
</li>
<li>
<p>How to make use of specific JUnit and TestNG features</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also learn more about configuring tests in the DSL reference for <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_packaging"><a class="anchor" href="#sec:java_packaging"></a><a class="link" href="#sec:java_packaging">Packaging and publishing</a></h4>
<div class="paragraph">
<p>How you package and potentially publish your Java project depends on what type of project it is. Libraries, applications, web applications and enterprise applications all have differing requirements. In this section, we will focus on the bare bones provided by the Java Plugin.</p>
</div>
<div class="paragraph">
<p>The one and only packaging feature provided by the Java Plugin directly is a <code>jar</code> task that packages all the compiled production classes and resources into a single JAR. This JAR is then added as an artifact  as opposed to a dependency in the <code>archives</code> configuration, hence why it is automatically built by the <code>assemble</code> task.</p>
</div>
<div class="paragraph">
<p>If you want any other JAR or alternative archive built, you either have to apply an appropriate plugin or create the task manually. For example, if you want a task that generates a 'sources' JAR, define your own <code>Jar</code> task like so:</p>
</div>
<div class="sect4">
<h5 id="example_defining_a_custom_task_to_create_a_sources_jar"><a class="anchor" href="#example_defining_a_custom_task_to_create_a_sources_jar"></a><a class="link" href="#example_defining_a_custom_task_to_create_a_sources_jar">Example: Defining a custom task to create a 'sources' JAR</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task sourcesJar(<span class="key">type</span>: Jar) {
    classifier = <span class="string"><span class="delimiter">'</span><span class="content">sources</span><span class="delimiter">'</span></span>
    from sourceSets.main.allJava
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="../dsl/org.gradle.api.tasks.bundling.Jar.html">Jar</a> for more details on the configuration options available to you. And note that you need to use <code>classifier</code> rather than <code>appendix</code> here for correct publication of the JAR.</p>
</div>
<div class="paragraph">
<p>If you instead want to create an 'uber' (AKA 'fat') JAR, then you can use a task definition like this:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_creating_a_java_uber_or_fat_jar_2"><a class="anchor" href="#example_creating_a_java_uber_or_fat_jar_2"></a><a class="link" href="#example_creating_a_java_uber_or_fat_jar_2">Example: Creating a Java uber or fat JAR</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
}

version = <span class="string"><span class="delimiter">'</span><span class="content">1.0.0</span><span class="delimiter">'</span></span>

repositories {
    mavenCentral()
}

dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">commons-io:commons-io:2.6</span><span class="delimiter">'</span></span>
}

task uberJar(<span class="key">type</span>: Jar) {
    appendix = <span class="string"><span class="delimiter">'</span><span class="content">uber</span><span class="delimiter">'</span></span>

    from sourceSets.main.output
    from configurations.runtimeClasspath.
                                         findAll { <span class="local-variable">it</span>.name.endsWith(<span class="string"><span class="delimiter">'</span><span class="content">jar</span><span class="delimiter">'</span></span>) }.
                                         collect { zipTree(<span class="local-variable">it</span>) }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are several options for publishing a JAR once it has been created:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <a href="#publishing_maven">Maven Publish Plugin</a></p>
</li>
<li>
<p>the <a href="#publishing_ivy">Ivy Publish Plugin</a></p>
</li>
<li>
<p>the <code>uploadArchives</code> task the <a href="#artifact_management">original publishing mechanism</a> which works with both Ivy and (if you apply the <a href="#maven_plugin">Maven Plugin</a>) Maven</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The former two "Publish" plugins are the preferred options.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:jar_manifest"><a class="anchor" href="#sec:jar_manifest"></a><a class="link" href="#sec:jar_manifest">Modifying the JAR manifest</a></h5>
<div class="paragraph">
<p>Each instance of the <code>Jar</code>, <code>War</code> and <code>Ear</code> tasks has a <code>manifest</code> property that allows you to customize the <em>MANIFEST.MF</em> file that goes into the corresponding archive. The following example demonstrates how to set attributes in the JAR&#8217;s manifest:</p>
</div>
<div class="sect5">
<h6 id="example_customization_of_manifest_mf_2"><a class="anchor" href="#example_customization_of_manifest_mf_2"></a><a class="link" href="#example_customization_of_manifest_mf_2">Example: Customization of MANIFEST.MF</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">jar {
    manifest {
        attributes(<span class="string"><span class="delimiter">&quot;</span><span class="content">Implementation-Title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Gradle</span><span class="delimiter">&quot;</span></span>,
                   <span class="string"><span class="delimiter">&quot;</span><span class="content">Implementation-Version</span><span class="delimiter">&quot;</span></span>: version)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="../javadoc/org/gradle/api/java/archives/Manifest.html">Manifest</a> for the configuration options it provides.</p>
</div>
<div class="paragraph">
<p>You can also create standalone instances of <code>Manifest</code>. One reason for doing so is to share manifest information between JARs. The following example demonstrates how to share common attributes between JARs:</p>
</div>
</div>
<div class="sect5">
<h6 id="example_creating_a_manifest_object"><a class="anchor" href="#example_creating_a_manifest_object"></a><a class="link" href="#example_creating_a_manifest_object">Example: Creating a manifest object.</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ext.sharedManifest = manifest {
    attributes(<span class="string"><span class="delimiter">&quot;</span><span class="content">Implementation-Title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Gradle</span><span class="delimiter">&quot;</span></span>,
               <span class="string"><span class="delimiter">&quot;</span><span class="content">Implementation-Version</span><span class="delimiter">&quot;</span></span>: version)
}
task fooJar(<span class="key">type</span>: Jar) {
    manifest = project.manifest {
        from sharedManifest
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another option available to you is to merge manifests into a single <code>Manifest</code> object. Those source manifests can take the form of a text for or another <code>Manifest</code> object. In the following example, the source manifests are all text files except for <code>sharedManifest</code>, which is the <code>Manifest</code> object from the previous example:</p>
</div>
</div>
<div class="sect5">
<h6 id="example_separate_manifest_mf_for_a_particular_archive"><a class="anchor" href="#example_separate_manifest_mf_for_a_particular_archive"></a><a class="link" href="#example_separate_manifest_mf_for_a_particular_archive">Example: Separate MANIFEST.MF for a particular archive</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task barJar(<span class="key">type</span>: Jar) {
    manifest {
        attributes <span class="key">key1</span>: <span class="string"><span class="delimiter">'</span><span class="content">value1</span><span class="delimiter">'</span></span>
        from sharedManifest, <span class="string"><span class="delimiter">'</span><span class="content">src/config/basemanifest.txt</span><span class="delimiter">'</span></span>
        from(<span class="string"><span class="delimiter">'</span><span class="content">src/config/javabasemanifest.txt</span><span class="delimiter">'</span></span>,
             <span class="string"><span class="delimiter">'</span><span class="content">src/config/libbasemanifest.txt</span><span class="delimiter">'</span></span>) {
            eachEntry { details -&gt;
                <span class="keyword">if</span> (details.baseValue != details.mergeValue) {
                    details.value = baseValue
                }
                <span class="keyword">if</span> (details.key == <span class="string"><span class="delimiter">'</span><span class="content">foo</span><span class="delimiter">'</span></span>) {
                    details.exclude()
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Manifests are merged in the order they are declared in the <code>from</code> statement. If the base manifest and the merged manifest both define values for the same key, the merged manifest wins by default. You can fully customize the merge behavior by adding <code>eachEntry</code> actions in which you have access to a <a href="../javadoc/org/gradle/api/java/archives/ManifestMergeDetails.html">ManifestMergeDetails</a> instance for each entry of the resulting manifest. Note that the merge is done lazily, either when generating the JAR or when <code>Manifest.writeTo()</code> or <code>Manifest.getEffectiveManifest()</code> are called.</p>
</div>
<div class="paragraph">
<p>Speaking of <code>writeTo()</code>, you can use that to easily write a manifest to disk at any time, like so:</p>
</div>
</div>
<div class="sect5">
<h6 id="example_saving_a_manifest_mf_to_disk"><a class="anchor" href="#example_saving_a_manifest_mf_to_disk"></a><a class="link" href="#example_saving_a_manifest_mf_to_disk">Example: Saving a MANIFEST.MF to disk</a></h6>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">jar.manifest.writeTo(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/mymanifest.mf</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:generating_javadocs"><a class="anchor" href="#sec:generating_javadocs"></a><a class="link" href="#sec:generating_javadocs">Generating API documentation</a></h4>
<div class="paragraph">
<p>The Java Plugin provides a <code>javadoc</code> task of type <a href="../dsl/org.gradle.api.tasks.javadoc.Javadoc.html">Javadoc</a>, that will generate standard Javadocs for all your production code, i.e. whatever source is in the <code>main</code> source set. The task supports the core Javadoc and standard doclet options described in the <a href="http://docs.oracle.com/javase/7/docs/technotes/tools/windows/javadoc.html#options">Javadoc reference documentation</a>. See <a href="../javadoc/org/gradle/external/javadoc/CoreJavadocOptions.html">CoreJavadocOptions</a> and <a href="../javadoc/org/gradle/external/javadoc/StandardJavadocDocletOptions.html">StandardJavadocDocletOptions</a> for a complete list of those options.</p>
</div>
<div class="paragraph">
<p>As an example of what you can do, imagine you want to use Asciidoc syntax in your Javadoc comments. To do this, you need to add Asciidoclet to Javadoc&#8217;s doclet path. Here&#8217;s an example that does just that:</p>
</div>
<div class="sect4">
<h5 id="example_using_a_custom_doclet_with_javadoc"><a class="anchor" href="#example_using_a_custom_doclet_with_javadoc"></a><a class="link" href="#example_using_a_custom_doclet_with_javadoc">Example: Using a custom doclet with Javadoc</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    asciidoclet
}

dependencies {
    asciidoclet <span class="string"><span class="delimiter">'</span><span class="content">org.asciidoctor:asciidoclet:1.+</span><span class="delimiter">'</span></span>
}

javadoc {
    options.docletpath = configurations.asciidoclet.files.toList()
    options.doclet = <span class="string"><span class="delimiter">'</span><span class="content">org.asciidoctor.Asciidoclet</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You don&#8217;t have to create a configuration for this, but it&#8217;s an elegant way to handle dependencies that are required for a unique purpose.</p>
</div>
<div class="paragraph">
<p>You might also want to create your own Javadoc tasks, for example to generate API docs for the tests:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_a_custom_javadoc_task"><a class="anchor" href="#example_defining_a_custom_javadoc_task"></a><a class="link" href="#example_defining_a_custom_javadoc_task">Example: Defining a custom Javadoc task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task testJavadoc(<span class="key">type</span>: Javadoc) {
    source = sourceSets.test.allJava
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>These are just two non-trivial but common customizations that you might come across.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:cleaning_java_build"><a class="anchor" href="#sec:cleaning_java_build"></a><a class="link" href="#sec:cleaning_java_build">Cleaning the build</a></h4>
<div class="paragraph">
<p>The Java Plugin adds a <code>clean</code> task to your project by virtue of applying the <a href="#base_plugin">Base Plugin</a>. This task simply deletes everything in the <code>$buildDir</code> directory, hence why you should always put files generated by the build in there. The task is an instance of <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a> and you can change what directory it deletes by setting its <code>dir</code> property.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_java_libraries"><a class="anchor" href="#sec:building_java_libraries"></a><a class="link" href="#sec:building_java_libraries">Building Java libraries</a></h4>
<div class="paragraph">
<p>The unique aspect of library projects is that they are used (or "consumed") by other Java projects. That means the dependency metadata published with the JAR file  usually in the form of a Maven POM  is crucial. In particular, consumers of your library should be able to distinguish between two different types of dependencies: those that are only required to compile your library and those that are also required to compile the consumer.</p>
</div>
<div class="paragraph">
<p>Gradle manages this distinction via the <a href="#java_library_plugin">Java Library Plugin</a>, which introduces an <em>api</em> configuration in addition to the <em>implementation</em> one covered in this chapter. If the types from a dependency appear in public fields or methods of your library&#8217;s public classes, then that dependency is exposed via your library&#8217;s public API and should therefore be added to the <em>api</em> configuration. Otherwise, the dependency is an internal implementation detail and should be added to <em>implementation</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The Java Library Plugin automatically applies the standard Java Plugin as well.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you&#8217;re unsure of the difference between an API and implementation dependency, the <a href="#sec:java_library_recognizing_dependencies">Java Library Plugin chapter</a> has a detailed explanation. In addition, you can see a basic, practical example of building a Java library in the corresponding <a href="https://guides.gradle.org/building-java-libraries/"><em>guide</em></a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_java_applications"><a class="anchor" href="#sec:building_java_applications"></a><a class="link" href="#sec:building_java_applications">Building Java applications</a></h4>
<div class="paragraph">
<p>Java applications packaged as a JAR aren&#8217;t set up for easy launching from the command line or a desktop environment. The <a href="#application_plugin">Application Plugin</a> solves the command line aspect by creating a distribution that includes the production JAR, its dependencies and launch scripts Unix-like and Windows systems.</p>
</div>
<div class="paragraph">
<p>See the plugin&#8217;s chapter for more details, but here&#8217;s a quick summary of what you get:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>assemble</code> creates ZIP and TAR distributions of the application containing everything needed to run it</p>
</li>
<li>
<p>A <code>run</code> task that starts the application from the build (for easy testing)</p>
</li>
<li>
<p>Shell and Windows Batch scripts to start the application</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that you will need to explicitly apply the Java Plugin in your build script.</p>
</div>
<div class="paragraph">
<p>You can see a basic example of building a Java application in the corresponding <a href="https://guides.gradle.org/building-java-applications/"><em>guide</em></a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_java_webapps"><a class="anchor" href="#sec:building_java_webapps"></a><a class="link" href="#sec:building_java_webapps">Building Java web applications</a></h4>
<div class="paragraph">
<p>Java web applications can be packaged and deployed in a number of ways depending on the technology you use. For example, you might use <a href="https://projects.spring.io/spring-boot/">Spring Boot</a> with a fat JAR or a <a href="https://www.reactivemanifesto.org/">Reactive</a>-based system running on <a href="https://netty.io/">Netty</a>. Whatever technology you use, Gradle and its large community of plugins will satisfy your needs. Core Gradle, though, only directly supports traditional Servlet-based web applications deployed as WAR files.</p>
</div>
<div class="paragraph">
<p>That support comes via the <a href="#war_plugin">War Plugin</a>, which automatically applies the Java Plugin and adds an extra packaging step that does the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copies static resources from <em>src/main/webapp</em> into the root of the WAR</p>
</li>
<li>
<p>Copies the compiled production classes into a <em>WEB-INF/classes</em> subdirectory of the WAR</p>
</li>
<li>
<p>Copies the library dependencies into a <em>WEB-INF/lib</em> subdirectory of the WAR</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is done by the <code>war</code> task, which effectively replaces the <code>jar</code> task  although that task remains and is attached to the <code>assemble</code> lifecycle task. See the plugin&#8217;s chapter for more details and configuration options.</p>
</div>
<div class="paragraph">
<p>There is no core support for running your web application directly from the build, but we do recommend that you try the <a href="https://plugins.gradle.org/plugin/org.gretty">Gretty</a> community plugin, which provides an embedded Servlet container.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:building_java_enterprise_apps"><a class="anchor" href="#sec:building_java_enterprise_apps"></a><a class="link" href="#sec:building_java_enterprise_apps">Building Java EE applications</a></h4>
<div class="paragraph">
<p>Java enterprise systems have changed a lot over the years, but if you&#8217;re still deploying to JEE application servers, you can make use of the <a href="#ear_plugin">Ear Plugin</a>. This adds conventions and a task for building EAR files. The plugin&#8217;s chapter has more details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="java_testing"><a class="anchor" href="#java_testing"></a><a class="link" href="#java_testing">Testing in Java &amp; JVM projects</a></h3>
<div class="paragraph">
<p>Testing on the JVM is a rich subject matter. There are many different testing libraries and frameworks, as well as many different types of test. All need to be part of the build, whether they are executed frequently or infrequently. This chapter is dedicated to explaining how Gradle handles differing requirements between and within builds, with significant coverage of how it integrates with the two most common testing frameworks: <a href="https://junit.org/">JUnit</a> and <a href="https://testng.org/">TestNG</a>.</p>
</div>
<div class="paragraph">
<p>It explains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ways to control how the tests are run (<a href="#sec:test_execution">Test execution</a>)</p>
</li>
<li>
<p>How to select specific tests to run (<a href="#test_filtering">Test filtering</a>)</p>
</li>
<li>
<p>What test reports are generated and how to influence the process (<a href="#test_reporting">Test reporting</a>)</p>
</li>
<li>
<p>How Gradle finds tests to run (<a href="#sec:test_detection">Test detection</a>)</p>
</li>
<li>
<p>How to make use of the major frameworks' mechanisms for grouping tests together (<a href="#test_grouping">Test grouping</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>But first, we look at the basics of JVM testing in Gradle.</p>
</div>
<div class="sect3">
<h4 id="sec:java_testing_basics"><a class="anchor" href="#sec:java_testing_basics"></a><a class="link" href="#sec:java_testing_basics">The basics</a></h4>
<div class="paragraph">
<p>All JVM testing revolves around a single task type: <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a>. This runs a collection of test cases using any supported test library  JUnit, JUnit Platform or TestNG and collates the results. You can then turn those results into a report via an instance of the <a href="../dsl/org.gradle.api.tasks.testing.TestReport.html">TestReport</a> task type.</p>
</div>
<div class="paragraph">
<p>In order to operate, the <code>Test</code> task type requires just two pieces of information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Where to find the compiled test classes (property: <a href="../dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:testClassesDirs">Test.getTestClassesDirs()</a>)</p>
</li>
<li>
<p>The execution classpath, which should include the classes under test as well as the test library that you&#8217;re using (property: <a href="../dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:classpath">Test.getClasspath()</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you&#8217;re using a JVM language plugin  such as the <a href="#java_plugin">Java Plugin</a> you will automatically get the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A dedicated <code>test</code> source set for unit tests</p>
</li>
<li>
<p>A <code>test</code> task of type <code>Test</code> that runs those unit tests</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The JVM language plugins use the source set to configure the task with the appropriate execution classpath and the directory containing the compiled test classes. In addition, they attach the <code>test</code> task to the <code>check</code> <a href="#sec:lifecycle_tasks">lifecycle task</a>.</p>
</div>
<div class="paragraph">
<p>It&#8217;s also worth bearing in mind that the <code>test</code> source set automatically creates <a href="#java_source_set_configurations">corresponding dependency configurations</a>  of which the most useful are <code>testImplementation</code> and <code>testRuntimeOnly</code>  that the plugins tie into the <code>test</code> task&#8217;s classpath.</p>
</div>
<div class="paragraph">
<p>All you need to do in most cases is configure the appropriate compilation and runtime dependencies and add any necessary configuration to the <code>test</code> task. The following example shows a simple setup that uses JUnit 4.x and changes the maximum heap size for the tests' JVM to 1 gigabyte:</p>
</div>
<div class="sect4">
<h5 id="example_a_basic_configuration_for_the_test_task"><a class="anchor" href="#example_a_basic_configuration_for_the_test_task"></a><a class="link" href="#example_a_basic_configuration_for_the_test_task">Example: A basic configuration for the 'test' task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    testImplementation <span class="string"><span class="delimiter">'</span><span class="content">junit:junit:4.12</span><span class="delimiter">'</span></span>
}

test {
    useJUnit()

    maxHeapSize = <span class="string"><span class="delimiter">'</span><span class="content">1G</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a> task has many generic configuration options as well as several framework-specific ones that you can find described in <a href="../javadoc/org/gradle/api/tasks/testing/junit/JUnitOptions.html">JUnitOptions</a>, <a href="../javadoc/org/gradle/api/tasks/testing/junitplatform/JUnitPlatformOptions.html">JUnitPlatformOptions</a> and <a href="../javadoc/org/gradle/api/tasks/testing/testng/TestNGOptions.html">TestNGOptions</a>. We cover a significant number of them in the rest of the chapter.</p>
</div>
<div class="paragraph">
<p>If you want to set up your own <code>Test</code> task with its own set of test classes, then the easiest approach is to create your own source set and <code>Test</code> task instance, as shown in <a href="#sec:configuring_java_integration_tests">Configuring integration tests</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:test_execution"><a class="anchor" href="#sec:test_execution"></a><a class="link" href="#sec:test_execution">Test execution</a></h4>
<div class="paragraph">
<p>Gradle executes tests in a separate ('forked') JVM, isolated from the main build process. This prevents classpath pollution and excessive memory consumption for the build process. It also allows you to run the tests with different JVM arguments than the build is using.</p>
</div>
<div class="paragraph">
<p>You can control how the test process is launched via several properties on the <code>Test</code> task, including the following:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>maxParallelForks</code>  default: 1</dt>
<dd>
<p>You can run your tests in parallel by setting this property to a value greater than 1. This may make your test suites complete faster, particularly if you run them on a multi-core CPU. When using parallel test execution, make sure your tests are properly isolated from one another. Tests that interact with the filesystem are particularly prone to conflict, causing intermittent test failures.</p>
<div class="paragraph">
<p>Your tests can distinguish between parallel test processes by using the value of the <code>org.gradle.test.worker</code> property, which is unique for each process. You can use this for anything you want, but it&#8217;s particularly useful for filenames and other resource identifiers to prevent the kind of conflict we just mentioned.</p>
</div>
</dd>
<dt class="hdlist1"><code>forkEvery</code> - default: 0 (no maximum)</dt>
<dd>
<p>This property specifies the maximum number of test classes that Gradle should run on a test process before its disposed of and a fresh one created. This is mainly used as a way to manage leaky tests or frameworks that have static state that can&#8217;t be cleared or reset between tests.</p>
<div class="paragraph">
<p><strong>Warning: a low value (other than 0) can severely hurt the performance of the tests</strong></p>
</div>
</dd>
<dt class="hdlist1"><code>ignoreFailures</code>  default: false</dt>
<dd>
<p>If this property is <code>true</code>, Gradle will continue with the project&#8217;s build once the tests have completed, even if some of them have failed. Note that, by default, the <code>Test</code> task always executes every test that it detects, irrespective of this setting.</p>
</dd>
<dt class="hdlist1"><code>failFast</code>  (since Gradle 4.6) default: false</dt>
<dd>
<p>Set this to <code>true</code> if you want the build to fail and finish as soon as one of your tests fails. This can save a lot of time when you have a long-running test suite and is particularly useful when running the build on continuous integration servers. When a build fails before all tests have run, the test reports only include the results of the tests that have completed, successfully or not.</p>
<div class="paragraph">
<p>You can also enable this behavior by using the <code>--fail-fast</code> command line option.</p>
</div>
</dd>
<dt class="hdlist1"><code>testLogging</code> default: <em>not set</em></dt>
<dd>
<p>This property represents a set of options that control which test events are logged and at what level. You can also configure other logging behavior via this property. See <a href="../javadoc/org/gradle/api/tasks/testing/logging/TestLoggingContainer.html">TestLoggingContainer</a> for more detail.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>See <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a> for details on all the available configuration options.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The test process can exit unexpectedly if configured incorrectly. For instance, if the Java executable does not exist or an invalid JVM argument is provided, the test process will fail to start. Similarly, if a test makes programmatic changes to the test process, this can also cause unexpected failures.</p>
</div>
<div class="paragraph">
<p>For example, issues may occur if a <code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/SecurityManager.html">SecurityManager</a></code> is modified in a test because
Gradle&#8217;s internal messaging depends on reflection and socket communication, which may be disrupted if the permissions on the security manager change. In this particular case, you should restore the original <code>SecurityManager</code> after the test so that the
gradle test worker process can continue to function.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="test_filtering"><a class="anchor" href="#test_filtering"></a><a class="link" href="#test_filtering">Test filtering</a></h4>
<div class="paragraph">
<p>It&#8217;s a common requirement to run subsets of a test suite, such as when you&#8217;re fixing a bug or developing a new test case. Gradle provides two mechanisms to do this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Filtering (the preferred option)</p>
</li>
<li>
<p>Test inclusion/exclusion</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Filtering supersedes the inclusion/exclusion mechanism, but you may still come across the latter in the wild.</p>
</div>
<div class="paragraph">
<p>With Gradle&#8217;s test filtering you can select tests to run based on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A fully-qualified class name or fully qualified method name, e.g. <code>org.gradle.SomeTest</code>, <code>org.gradle.SomeTest.someMethod</code></p>
</li>
<li>
<p>A simple class name or method name if the pattern starts with an upper-case letter, e.g. <code>SomeTest</code>, <code>SomeTest.someMethod</code> (since Gradle 4.7)</p>
</li>
<li>
<p>'*' wildcard matching</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can enable filtering either in the build script or via the <code>--tests</code> command-line option. Here&#8217;s an example of some filters that are applied every time the build runs:</p>
</div>
<div class="sect4">
<h5 id="example_filtering_tests_in_the_build_script"><a class="anchor" href="#example_filtering_tests_in_the_build_script"></a><a class="link" href="#example_filtering_tests_in_the_build_script">Example: Filtering tests in the build script</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    filter {
        <span class="comment">//include specific method in any of the tests</span>
        includeTestsMatching <span class="string"><span class="delimiter">&quot;</span><span class="content">*UiCheck</span><span class="delimiter">&quot;</span></span>

        <span class="comment">//include all tests from package</span>
        includeTestsMatching <span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.internal.*</span><span class="delimiter">&quot;</span></span>

        <span class="comment">//include all integration tests</span>
        includeTestsMatching <span class="string"><span class="delimiter">&quot;</span><span class="content">*IntegTest</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more details and examples of declaring filters in the build script, please see the <a href="../javadoc/org/gradle/api/tasks/testing/TestFilter.html">TestFilter</a> reference.</p>
</div>
<div class="paragraph">
<p>The command-line option is especially useful to execute a single test method. When you use <code>--tests</code>, be aware that the inclusions declared in the build script are still honored. It is also possible to supply multiple <code>--tests</code> options, all of whose patterns will take effect. The following sections have several examples of using the command-line option.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Not all test frameworks play well with filtering. Some advanced, synthetic tests may not be fully compatible. However, the vast majority of tests and use cases work perfectly well with Gradle&#8217;s filtering mechanism.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following two sections look at the specific cases of simple class/method names and fully-qualified names.</p>
</div>
</div>
<div class="sect4">
<h5 id="simple_name_pattern"><a class="anchor" href="#simple_name_pattern"></a><a class="link" href="#simple_name_pattern">Simple name pattern</a></h5>
<div class="paragraph">
<p>Since 4.7, Gradle has treated a pattern starting with an uppercase letter as a simple class name, or a class name + method name. For example, the following command lines run either all or exactly one of the tests in the <code>SomeTestClass</code> test case, regardless of what  package it&#8217;s in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code># Executes all tests in SomeTestClass
gradle test --tests SomeTestClass

# Executes a single specified test in SomeTestClass
gradle test --tests SomeTestClass.someSpecificMethod

gradle test --tests SomeTestClass.*someMethod*</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="full_qualified_name_pattern"><a class="anchor" href="#full_qualified_name_pattern"></a><a class="link" href="#full_qualified_name_pattern">Fully-qualified name pattern</a></h5>
<div class="paragraph">
<p>Prior to 4.7 or if the pattern doesn&#8217;t start with an uppercase letter, Gradle treats the pattern as fully-qualified. So if you want to use the test class name irrespective of its package, you would use <code>--tests *.SomeTestClass</code>. Here are some more examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code># specific class
gradle test --tests org.gradle.SomeTestClass

# specific class and method
gradle test --tests org.gradle.SomeTestClass.someSpecificMethod

# method name containing spaces
gradle test --tests "org.gradle.SomeTestClass.some method containing spaces"

# all classes at specific package (recursively)
gradle test --tests 'all.in.specific.package*'

# specific method at specific package (recursively)
gradle test --tests 'all.in.specific.package*.someSpecificMethod'

gradle test --tests '*IntegTest'

gradle test --tests '*IntegTest*ui*'

gradle test --tests '*ParameterizedTest.foo*'

# the second iteration of a parameterized test
gradle test --tests '*ParameterizedTest.*[2]'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the wildcard '*' has no special understanding of the '.' package separator. It&#8217;s purely text based. So <code>--tests *.SomeTestClass</code> will match any package, regardless of its 'depth'.</p>
</div>
<div class="paragraph">
<p>You can also combine filters defined at the command line with <a href="#sec:continuous_build">continuous build</a> to re-execute a subset of tests immediately after every change to a production or test source file. The following executes all tests in the 'com.mypackage.foo' package or subpackages whenever a change triggers the tests to run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>gradle test --continuous --tests "com.mypackage.foo.*"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:single_test_execution_via_system_properties"><a class="anchor" href="#sec:single_test_execution_via_system_properties"></a><a class="link" href="#sec:single_test_execution_via_system_properties">Single test execution via System Properties</a></h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This mechanism has been superseded by 'Test Filtering', described above. We only include it in case you encounter it in online forums and blogs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Test inclusions/exclusions are a file-based  as opposed to a class name-based mechanism for selecting tests to run. It&#8217;s activated when you use the <code>-D<em>taskName</em>.single=<em>&lt;pattern&gt;</em></code> option on the command line, e.g. <code>-Dtest.single=MyTest</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="test_reporting"><a class="anchor" href="#test_reporting"></a><a class="link" href="#test_reporting">Test reporting</a></h4>
<div class="paragraph">
<p>The <code>Test</code> task generates the following results by default:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An HTML test report</p>
</li>
<li>
<p>XML test results in a format compatible with the Ant JUnit report task one that is supported by many other tools, such as CI servers</p>
</li>
<li>
<p>An efficient binary format of the results used by the <code>Test</code> task to generate the other formats</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In most cases, you&#8217;ll work with the standard HTML report, which automatically includes the results from <em>all</em> your <code>Test</code> tasks, even the ones you explicitly add to the build yourself. For example, if you add a <code>Test</code> task for integration tests, the report will include the results of both the unit tests and the integration tests if both tasks are run.</p>
</div>
<div class="paragraph">
<p>Unlike with many of the testing configuration options, there are several project-level <a href="#sec:java_convention_properties">convention properties that affect the test reports</a>. For example, you can change the destination of the test results and reports like so:</p>
</div>
<div class="sect4">
<h5 id="example_changing_the_default_test_report_and_results_directories"><a class="anchor" href="#example_changing_the_default_test_report_and_results_directories"></a><a class="link" href="#example_changing_the_default_test_report_and_results_directories">Example: Changing the default test report and results directories</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">reporting.baseDir = <span class="string"><span class="delimiter">&quot;</span><span class="content">my-reports</span><span class="delimiter">&quot;</span></span>
testResultsDirName = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/my-test-results</span><span class="delimiter">&quot;</span></span>

task showDirs {
    doLast {
        logger.quiet(rootDir.toPath().relativize(project.reportsDir.toPath()).toString())
        logger.quiet(rootDir.toPath().relativize(project.testResultsDir.toPath()).toString())
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q showDirs</code></strong></div>
<div class="content">
<pre>&gt; gradle -q showDirs
my-reports
build/my-test-results</pre>
</div>
</div>
<div class="paragraph">
<p>Follow the link to the convention properties for more details.</p>
</div>
<div class="paragraph">
<p>There is also a standalone <a href="../dsl/org.gradle.api.tasks.testing.TestReport.html">TestReport</a> task type that you can use to generate a custom HTML test report. All it requires are a value for <code>destinationDir</code> and the test results you want included in the report. Here is a sample which generates a combined report for the unit tests from all subprojects:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_creating_a_unit_test_report_for_subprojects"><a class="anchor" href="#example_creating_a_unit_test_report_for_subprojects"></a><a class="link" href="#example_creating_a_unit_test_report_for_subprojects">Example: Creating a unit test report for subprojects</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">subprojects {
    apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>

    <span class="comment">// Disable the test report for the individual test task</span>
    test {
        reports.html.enabled = <span class="predefined-constant">false</span>
    }
}

task testReport(<span class="key">type</span>: TestReport) {
    destinationDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/reports/allTests</span><span class="delimiter">&quot;</span></span>)
    <span class="comment">// Include the results from the `test` task in all subprojects</span>
    reportOn subprojects*.test
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should note that the <code>TestReport</code> type combines the results from multiple test tasks and needs to aggregate the results of individual test classes. This means that if a given test class is executed by multiple test tasks, then the test report will include executions of that class, but it can be hard to distinguish individual executions of that class and their output.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:test_detection"><a class="anchor" href="#sec:test_detection"></a><a class="link" href="#sec:test_detection">Test detection</a></h4>
<div class="paragraph">
<p>By default, Gradle will run all tests that it detects, which it does by inspecting the compiled test classes. This detection uses different criteria depending on the test framework used.</p>
</div>
<div class="paragraph">
<p>For <em>JUnit</em>, Gradle scans for both JUnit 3 and 4 test classes. A class is considered to be a JUnit test if it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ultimately inherits from <code>TestCase</code> or <code>GroovyTestCase</code></p>
</li>
<li>
<p>Is annotated with <code>@RunWith</code></p>
</li>
<li>
<p>Contains a method annotated with <code>@Test</code> or a super class does</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For <em>TestNG</em>, Gradle scans for methods annotated with <code>@Test</code>.</p>
</div>
<div class="paragraph">
<p>Note that abstract classes are not executed. In addition, be aware that Gradle scans up the inheritance tree into jar files on the test classpath. So if those JARs contain test classes, they will also be run.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t want to use test class detection, you can disable it by setting the <code>scanForTestClasses</code> property on <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a> to <code>false</code>. When you do that, the test task uses only the <code>includes</code> and <code>excludes</code> properties to find test classes.</p>
</div>
<div class="paragraph">
<p>If <code>scanForTestClasses</code> is false and no include or exclude patterns are specified, Gradle defaults to running any class that matches the patterns <code>**/*Tests.class</code> and <code>**/*Test.class</code>, excluding those that match <code>**/Abstract*.class</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>With <a href="http://junit.org/junit5/docs/current/user-guide">JUnit Platform</a>, only <code>includes</code> and <code>excludes</code> are used to filter test classes  <code>scanForTestClasses</code> has no effect.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="test_grouping"><a class="anchor" href="#test_grouping"></a><a class="link" href="#test_grouping">Test grouping</a></h4>
<div class="paragraph">
<p>JUnit, JUnit Platform and TestNG allow sophisticated groupings of test methods.</p>
</div>
<div class="paragraph">
<p>JUnit 4.8 introduced the concept of categories for grouping JUnit 4 tests classes and methods.<sup class="footnote">[<a id="_footnoteref_12" class="footnote" href="#_footnotedef_12" title="View footnote.">12</a>]</sup> <a href="../dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:useJUnit(org.gradle.api.Action)">Test.useJUnit(org.gradle.api.Action)</a> allows you to specify the JUnit categories you want to include and exclude. For example, the following configuration includes tests in <code>CategoryA</code> and excludes those in <code>CategoryB</code> for the <code>test</code> task:</p>
</div>
<div class="sect4">
<h5 id="example_junit_categories"><a class="anchor" href="#example_junit_categories"></a><a class="link" href="#example_junit_categories">Example: JUnit Categories</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    useJUnit {
        includeCategories <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.junit.CategoryA</span><span class="delimiter">'</span></span>
        excludeCategories <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.junit.CategoryB</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="http://junit.org/junit5/docs/current/user-guide">JUnit Platform</a> introduced <a href="http://junit.org/junit5/docs/current/user-guide/#writing-tests-tagging-and-filtering">tagging</a> to replace categories. You can specify the included/excluded tags via <a href="../javadoc/org/gradle/api/tasks/testing/Test.html#useJUnitPlatform-org.gradle.api.Action-">Test.useJUnitPlatform(org.gradle.api.Action)</a>, as follows:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_junit_platform_tags"><a class="anchor" href="#example_junit_platform_tags"></a><a class="link" href="#example_junit_platform_tags">Example: JUnit Platform Tags</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    useJUnitPlatform {
        includeTags <span class="string"><span class="delimiter">'</span><span class="content">fast</span><span class="delimiter">'</span></span>
        excludeTags <span class="string"><span class="delimiter">'</span><span class="content">slow</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The TestNG framework uses the concept of test groups for a similar effect.<sup class="footnote">[<a id="_footnoteref_13" class="footnote" href="#_footnotedef_13" title="View footnote.">13</a>]</sup> You can configure which test groups to include or exclude during the test execution via the <a href="../dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:useTestNG(org.gradle.api.Action)">Test.useTestNG(org.gradle.api.Action)</a> setting, as seen here:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_grouping_testng_tests"><a class="anchor" href="#example_grouping_testng_tests"></a><a class="link" href="#example_grouping_testng_tests">Example: Grouping TestNG tests</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    useTestNG {
        excludeGroups <span class="string"><span class="delimiter">'</span><span class="content">integrationTests</span><span class="delimiter">'</span></span>
        includeGroups <span class="string"><span class="delimiter">'</span><span class="content">unitTests</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using_junit5"><a class="anchor" href="#using_junit5"></a><a class="link" href="#using_junit5">Using JUnit 5</a></h4>
<div class="paragraph">
<p><a href="http://junit.org/junit5">JUnit 5</a> is the latest version of the well-known JUnit test framework.
Unlike its predecessor, JUnit 5 is modularized and composed of several modules:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>JUnit 5 = JUnit Platform + JUnit Jupiter + JUnit Vintage</pre>
</div>
</div>
<div class="paragraph">
<p>The JUnit Platform serves as a foundation for launching testing frameworks on the JVM. JUnit Jupiter is the combination of the new <a href="http://junit.org/junit5/docs/current/user-guide/#writing-tests">programming model</a>
 and <a href="http://junit.org/junit5/docs/current/user-guide/#extensions">extension model</a> for writing tests and extensions in JUnit 5. JUnit Vintage provides a <code>TestEngine</code> for running JUnit 3 and JUnit 4 based tests on the platform.</p>
</div>
<div class="paragraph">
<p>The following code enables JUnit Platform support in <code>build.gradle</code>:</p>
</div>
<div class="sect4">
<h5 id="example_enabling_junit_platform_to_run_your_tests"><a class="anchor" href="#example_enabling_junit_platform_to_run_your_tests"></a><a class="link" href="#example_enabling_junit_platform_to_run_your_tests">Example: Enabling JUnit Platform to run your tests</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="../javadoc/org/gradle/api/tasks/testing/Test.html#useJUnitPlatform">Test.useJUnitPlatform()</a> for more details.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>There are some known limitations of using JUnit 5 with Gradle, for example that tests in static nested classes won&#8217;t be discovered and classes are still displayed by their class name instead of <code>@DisplayName</code>. These will be fixed in future version of Gradle. If you find more, please tell us at <a href="https://github.com/gradle/gradle/issues/new" class="bare">https://github.com/gradle/gradle/issues/new</a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="compiling_and_executing_junit_jupiter_tests"><a class="anchor" href="#compiling_and_executing_junit_jupiter_tests"></a><a class="link" href="#compiling_and_executing_junit_jupiter_tests">Compiling and executing JUnit Jupiter tests</a></h5>
<div class="paragraph">
<p>To enable JUnit Jupiter support in Gradle, all you need to do is add the following dependencies:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_junit_jupiter_dependencies"><a class="anchor" href="#example_junit_jupiter_dependencies"></a><a class="link" href="#example_junit_jupiter_dependencies">Example: JUnit Jupiter dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    testImplementation <span class="string"><span class="delimiter">'</span><span class="content">org.junit.jupiter:junit-jupiter-api:5.1.0</span><span class="delimiter">'</span></span>
    testRuntimeOnly <span class="string"><span class="delimiter">'</span><span class="content">org.junit.jupiter:junit-jupiter-engine:5.1.0</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then put your test cases into <em>src/test/java</em> as normal and execute them with <code>gradle test</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="executing_legacy_tests_with_junit_vintage"><a class="anchor" href="#executing_legacy_tests_with_junit_vintage"></a><a class="link" href="#executing_legacy_tests_with_junit_vintage">Executing legacy tests with JUnit Vintage</a></h5>
<div class="paragraph">
<p>If you want to run JUnit 3/4 tests on JUnit Platform, or even mix them with Jupiter tests, you should add extra JUnit Vintage Engine dependencies:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_junit_vintage_dependencies"><a class="anchor" href="#example_junit_vintage_dependencies"></a><a class="link" href="#example_junit_vintage_dependencies">Example: JUnit Vintage dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    testImplementation <span class="string"><span class="delimiter">'</span><span class="content">org.junit.jupiter:junit-jupiter-api:5.1.0</span><span class="delimiter">'</span></span>
    testRuntimeOnly <span class="string"><span class="delimiter">'</span><span class="content">org.junit.jupiter:junit-jupiter-engine:5.1.0</span><span class="delimiter">'</span></span>
    testCompileOnly <span class="string"><span class="delimiter">'</span><span class="content">junit:junit:4.12</span><span class="delimiter">'</span></span>
    testRuntimeOnly <span class="string"><span class="delimiter">'</span><span class="content">org.junit.vintage:junit-vintage-engine:5.1.0</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this way, you can use <code>gradle test</code> to test JUnit 3/4 tests on JUnit Platform, without the need to rewrite them.</p>
</div>
<div class="paragraph">
<p>A sample of mixed tests can be found at <code>samples/testing/junitplatform/mix</code> in the '-all' distribution of Gradle.</p>
</div>
</div>
<div class="sect4">
<h5 id="filtering_test_engine"><a class="anchor" href="#filtering_test_engine"></a><a class="link" href="#filtering_test_engine">Filtering test engine</a></h5>
<div class="paragraph">
<p>JUnit Platform allows you to use different test engines. JUnit currently provides two <code>TestEngine</code> implementations out of the box:
<a href="https://junit.org/junit5/docs/current/api/org/junit/jupiter/engine/package-summary.html">junit-jupiter-engine</a> and <a href="https://junit.org/junit5/docs/current/api/org/junit/vintage/engine/package-summary.html">junit-vintage-engine</a>.
You can also write and plug in your own <code>TestEngine</code> implementation as documented <a href="https://junit.org/junit5/docs/current/user-guide/#launcher-api-engines-custom">here</a>.</p>
</div>
<div class="paragraph">
<p>By default, all test engines on the test runtime classpath will be used.
To control specific test engine implementations explicitly, you can add the following setting to your build script:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_filter_specific_engines"><a class="anchor" href="#example_filter_specific_engines"></a><a class="link" href="#example_filter_specific_engines">Example: Filter specific engines</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    useJUnitPlatform {
        includeEngines <span class="string"><span class="delimiter">'</span><span class="content">junit-vintage</span><span class="delimiter">'</span></span>
        <span class="comment">// excludeEngines 'junit-jupiter'</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A test engine filtering sample can be found at <code>samples/testing/junitplatform/engine</code> in the '-all' distribution of Gradle.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="test_execution_order"><a class="anchor" href="#test_execution_order"></a><a class="link" href="#test_execution_order">Test execution order in TestNG</a></h4>
<div class="paragraph">
<p>TestNG allows explicit control of the execution order of tests when you use a <em>testng.xml</em> file. Without such a file  or an equivalent one configured by <a href="../javadoc/org/gradle/api/tasks/testing/testng/TestNGOptions.html#getSuiteXmlBuilder--">TestNGOptions.getSuiteXmlBuilder()</a>  you can&#8217;t specify the test execution order. However, what you <em>can</em> do is control whether all aspects of a test  including its associated <code>@BeforeXXX</code> and <code>@AfterXXX</code> methods, such as those annotated with <code>@Before/AfterClass</code> and <code>@Before/AfterMethod</code>are executed before the next test starts. You do this by setting the <a href="../javadoc/org/gradle/api/tasks/testing/testng/TestNGOptions.html#getPreserveOrder--">TestNGOptions.getPreserveOrder()</a> property to <code>true</code>. If you set it to <code>false</code>, you may encounter scenarios in which the execution order is something like: <code>TestA.doBeforeClass()</code> &#8594; <code>TestB.doBeforeClass()</code> &#8594; <code>TestA</code> tests.</p>
</div>
<div class="paragraph">
<p>While preserving the order of tests is the default behavior when directly working with <em>testng.xml</em> files, the <a href="https://jitpack.io/com/github/cbeust/testng/master/javadoc/org/testng/TestNG.html">TestNG API</a> that is used by Gradle&#8217;s TestNG integration executes tests in unpredictable order by default.<sup class="footnote">[<a id="_footnoteref_14" class="footnote" href="#_footnotedef_14" title="View footnote.">14</a>]</sup> The ability to preserve test execution order was introduced with TestNG version 5.14.5. Setting the <code>preserveOrder</code> property to <code>true</code> for an older TestNG version will cause the build to fail.</p>
</div>
<div class="sect4">
<h5 id="example_preserving_order_of_testng_tests"><a class="anchor" href="#example_preserving_order_of_testng_tests"></a><a class="link" href="#example_preserving_order_of_testng_tests">Example: Preserving order of TestNG tests</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    useTestNG {
        preserveOrder <span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>groupByInstance</code> property controls whether tests should be grouped by instance rather than by class. The <a href="http://testng.org/doc/documentation-main.html#dependencies-with-annotations">TestNG documentation</a> explains the difference in more detail, but essentially, if you have a test method <code>A()</code> that depends on <code>B()</code>, grouping by instance ensures that each A-B pairing, e.g. <code>B(1)</code>-<code>A(1)</code>, is executed before the next pairing. With group by class, all <code>B()</code> methods are run and then all <code>A()</code> ones.</p>
</div>
<div class="paragraph">
<p>Note that you typically only have more than one instance of a test if you&#8217;re using a data provider to parameterize it. Also, grouping tests by instances was introduced with TestNG version 6.1. Setting the <code>groupByInstances</code> property to <code>true</code> for an older TestNG version will cause the build to fail.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_grouping_testng_tests_by_instances"><a class="anchor" href="#example_grouping_testng_tests_by_instances"></a><a class="link" href="#example_grouping_testng_tests_by_instances">Example: Grouping TestNG tests by instances</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    useTestNG {
        groupByInstances = <span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="testNgParameterizedReporting"><a class="anchor" href="#testNgParameterizedReporting"></a><a class="link" href="#testNgParameterizedReporting">TestNG parameterized methods and reporting</a></h5>
<div class="paragraph">
<p>TestNG supports <a href="http://testng.org/doc/documentation-main.html#parameters">parameterizing test methods</a>, allowing a particular test method to be executed multiple times with different inputs. Gradle includes the parameter values in its reporting of the test method execution.</p>
</div>
<div class="paragraph">
<p>Given a parameterized test method named <code>aTestMethod</code> that takes two parameters, it will be reported with the name <code>aTestMethod(toStringValueOfParam1, toStringValueOfParam2)</code>. This makes it easy to identify the parameter values for a particular iteration.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring_java_integration_tests"><a class="anchor" href="#sec:configuring_java_integration_tests"></a><a class="link" href="#sec:configuring_java_integration_tests">Configuring integration tests</a></h4>
<div class="paragraph">
<p>A common requirement for projects is to incorporate integration tests in one form or another. Their aim is to verify that the various parts of the project are working together properly. This often means that they require special execution setup and dependencies compared to unit tests.</p>
</div>
<div class="paragraph">
<p>The simplest way to add integration tests to your build is by taking these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new <a href="#sec:java_source_sets">source set</a> for them</p>
</li>
<li>
<p>Add the dependencies you need to the appropriate configurations for that source set</p>
</li>
<li>
<p>Configure the compilation and runtime classpaths for that source set</p>
</li>
<li>
<p>Create a task to run the integration tests</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You may also need to perform some additional configuration depending on what form the integration tests take. We will discuss those as we go.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with a practical example that implements the first three steps in a build script, centered around a new source set <code>intTest</code>:</p>
</div>
<div class="sect4">
<h5 id="example_setting_up_working_integration_tests"><a class="anchor" href="#example_setting_up_working_integration_tests"></a><a class="link" href="#example_setting_up_working_integration_tests">Example: Setting up working integration tests</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sourceSets {
    intTest {
        compileClasspath += sourceSets.main.output
        runtimeClasspath += sourceSets.main.output
    }
}

configurations {
    intTestImplementation.extendsFrom implementation
    intTestRuntimeOnly.extendsFrom runtimeOnly
}

dependencies {
    intTestImplementation <span class="string"><span class="delimiter">'</span><span class="content">junit:junit:4.12</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will set up a new source set called <code>intTest</code> that automatically creates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>intTestImplementation</code>, <code>intTestCompileOnly</code>, <code>intTestRuntimeOnly</code> configurations (and <a href="#java_source_set_configurations">a few others</a> that are less commonly needed)</p>
</li>
<li>
<p>A <code>compileIntTestJava</code> task that will compile all the source files under <em>src/intTest/java</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The example also does the following, not all of which you may need for your specific integration tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adds the production classes from the <code>main</code> source set to the compilation and runtime classpaths of the integration tests  <code>sourceSets.main.output</code> is a <a href="#sec:file_collections">file collection</a> of all the directories containing compiled production classes and resources</p>
</li>
<li>
<p>Makes the <code>intTestImplementation</code> configuration extend from <code>implementation</code>, which means that all the declared dependencies of the production code also become dependencies of the integration tests</p>
</li>
<li>
<p>Does the same for the <code>intTestRuntimeOnly</code> configuration</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In most cases, you want your integration tests to have access to the classes under test, which is why we ensure that those are included on the compilation and runtime classpaths in this example. But some types of test interact with the production code in a different way. For example, you may have tests that run your application as an executable and verify the output. In the case of web applications, the tests may interact with your application via HTTP. Since the tests don&#8217;t need direct access to the classes under test in such cases, you don&#8217;t need to add the production classes to the test classpath.</p>
</div>
<div class="paragraph">
<p>Another common step is to attach all the unit test dependencies to the integration tests as well  via <code>intTestImplementation.extendsFrom testImplementation</code>  but that only makes sense if the integration tests require <em>all</em> or nearly all the same dependencies that the unit tests have.</p>
</div>
<div class="paragraph">
<p>There are a couple of other facets of the example you should take note of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>+=</code> allows you to append paths and collections of paths to <code>compileClasspath</code> and <code>runtimeClasspath</code> instead of overwriting them</p>
</li>
<li>
<p>If you want to use the convention-based configurations, such as <code>intTestImplementation</code>, you <em>must</em> declare the dependencies <em>after</em> the new source set</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Creating and configuring a source set automatically sets up the compilation stage, but it does nothing with respect to running the integration tests. So the last piece of the puzzle is a custom test task that uses the information from the new source set to configure its runtime classpath and the test classes:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_defining_a_working_integration_test_task"><a class="anchor" href="#example_defining_a_working_integration_test_task"></a><a class="link" href="#example_defining_a_working_integration_test_task">Example: Defining a working integration test task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task integrationTest(<span class="key">type</span>: Test) {
    description = <span class="string"><span class="delimiter">'</span><span class="content">Runs integration tests.</span><span class="delimiter">'</span></span>
    group = <span class="string"><span class="delimiter">'</span><span class="content">verification</span><span class="delimiter">'</span></span>

    testClassesDirs = sourceSets.intTest.output.classesDirs
    classpath = sourceSets.intTest.runtimeClasspath
    shouldRunAfter test
}

check.dependsOn integrationTest</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, we&#8217;re accessing a source set to get the relevant information, i.e. where the compiled test classes are the <code>testClassesDir</code> property and what needs to be on the classpath when running them <code>classpath</code>.</p>
</div>
<div class="paragraph">
<p>Users commonly want to run integration tests after the unit tests, because they are often slower to run and you want the build to fail early on the unit tests rather than later on the integration tests. That&#8217;s why the above example adds a <code>shouldRunAfter()</code> declaration. This is preferred over <code>mustRunAfter()</code> so that Gradle has more flexibility in executing the build in parallel.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:skipping_java_tests"><a class="anchor" href="#sec:skipping_java_tests"></a><a class="link" href="#sec:skipping_java_tests">Skipping the tests</a></h4>
<div class="paragraph">
<p>If you want to skip the tests when running a build, you have a few options. You can either do it via <a href="#sec:excluding_tasks_from_the_command_line">command line arguments</a> or <a href="#sec:skipping_tasks">in the build script</a>. To do it on the command line, you can use the <code>-x</code> or <code>--exclude-task</code> option like so:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>gradle build -x test</pre>
</div>
</div>
<div class="paragraph">
<p>This excludes the <code>test</code> task and any other task that it <em>exclusively</em> depends on, i.e. no other task depends on the same task. Those tasks will not be marked "SKIPPED" by Gradle, but will simply not appear in the list of tasks executed.</p>
</div>
<div class="paragraph">
<p>Skipping a test via the build script can be done a few ways. One common approach is to make test execution conditional via the <a href="../dsl/org.gradle.api.Task.html#org.gradle.api.Task:onlyIf(org.gradle.api.specs.Spec)">Task.onlyIf(org.gradle.api.specs.Spec)</a> method. The following sample skips the <code>test</code> task if the project has a property called <code>mySkipTests</code>:</p>
</div>
<div class="sect4">
<h5 id="example_skipping_the_unit_tests_based_on_a_project_property"><a class="anchor" href="#example_skipping_the_unit_tests_based_on_a_project_property"></a><a class="link" href="#example_skipping_the_unit_tests_based_on_a_project_property">Example: Skipping the unit tests based on a project property</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test.onlyIf { !project.hasProperty(<span class="string"><span class="delimiter">'</span><span class="content">mySkipTests</span><span class="delimiter">'</span></span>) }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, Gradle will mark the skipped tests as "SKIPPED" rather than exclude them from the build.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:forcing_java_tests_to_run"><a class="anchor" href="#sec:forcing_java_tests_to_run"></a><a class="link" href="#sec:forcing_java_tests_to_run">Forcing tests to run</a></h4>
<div class="paragraph">
<p>In well-defined builds, you can rely on Gradle to only run tests if the tests themselves or the production code change. However, you may encounter situations where the tests rely on a third-party service or something else that might change but can&#8217;t be modeled in the build.</p>
</div>
<div class="paragraph">
<p>You can force tests to run in this situation by cleaning the output of the relevant <code>Test</code> task  say <code>test</code>  and running the tests again, like so:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>gradle cleanTest test</pre>
</div>
</div>
<div class="paragraph">
<p><code>cleanTest</code> is based on a <a href="#sec:task_rules">task rule</a> provided by the <a href="#sec:base_tasks">Base Plugin</a>. You can use it for <em>any</em> task.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:debugging_java_tests"><a class="anchor" href="#sec:debugging_java_tests"></a><a class="link" href="#sec:debugging_java_tests">Debugging when running tests</a></h4>
<div class="paragraph">
<p>On the few occasions that you want to debug your code while the tests are running, it can be helpful if you can attach a debugger at that point. You can either set the <a href="../dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:debug">Test.getDebug()</a> property to <code>true</code> or use the <code>--debug-jvm</code> command line option.</p>
</div>
<div class="paragraph">
<p>When debugging for tests is enabled, Gradle will start the test process suspended and listening on port 5005.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="java_plugin"><a class="anchor" href="#java_plugin"></a><a class="link" href="#java_plugin">The Java Plugin</a></h3>
<div class="paragraph">
<p>The Java plugin adds Java compilation along with testing and bundling capabilities to a project. It serves as the basis for many of the other JVM language Gradle plugins. You can find a comprehensive introduction and overview to the Java Plugin in the <a href="#building_java_projects">Building Java Projects</a> chapter.</p>
</div>
<div class="sect3">
<h4 id="sec:java_usage"><a class="anchor" href="#sec:java_usage"></a><a class="link" href="#sec:java_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Java plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_java_plugin_2"><a class="anchor" href="#example_using_the_java_plugin_2"></a><a class="link" href="#example_using_the_java_plugin_2">Example: Using the Java plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_project_layout"><a class="anchor" href="#sec:java_project_layout"></a><a class="link" href="#sec:java_project_layout">Project layout</a></h4>
<div class="paragraph">
<p>The Java plugin assumes the project layout shown below. None of these directories need to exist or have anything in them. The Java plugin will compile whatever it finds, and handles anything which is missing.</p>
</div>
<div id="javalayout" class="dlist">
<dl>
<dt class="hdlist1"><code>src/main/java</code></dt>
<dd>
<p>Production Java source.</p>
</dd>
<dt class="hdlist1"><code>src/main/resources</code></dt>
<dd>
<p>Production resources, such as XML and properties files.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/test/java</code></dt>
<dd>
<p>Test Java source.</p>
</dd>
<dt class="hdlist1"><code>src/test/resources</code></dt>
<dd>
<p>Test resources.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/java</code></dt>
<dd>
<p>Java source for the source set named <em>sourceSet</em>.</p>
</dd>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/resources</code></dt>
<dd>
<p>Resources for the source set named <em>sourceSet</em>.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="sec:changing_java_project_layout"><a class="anchor" href="#sec:changing_java_project_layout"></a><a class="link" href="#sec:changing_java_project_layout">Changing the project layout</a></h5>
<div class="paragraph">
<p>You configure the project layout by configuring the appropriate source set. This is discussed in more detail in the following sections. Here is a brief example which changes the main Java and resource source directories.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_custom_java_source_layout"><a class="anchor" href="#example_custom_java_source_layout"></a><a class="link" href="#example_custom_java_source_layout">Example: Custom Java source layout</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sourceSets {
    main {
        java {
            srcDirs = [<span class="string"><span class="delimiter">'</span><span class="content">src/java</span><span class="delimiter">'</span></span>]
        }
        resources {
            srcDirs = [<span class="string"><span class="delimiter">'</span><span class="content">src/resources</span><span class="delimiter">'</span></span>]
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="source_sets"><a class="anchor" href="#source_sets"></a><a class="link" href="#source_sets">Source sets</a></h4>
<div class="paragraph">
<p>The plugin adds the following <a href="#sec:java_source_sets">source sets</a>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>main</code></dt>
<dd>
<p>Contains the production source code of the project, which is compiled and assembled into a JAR.</p>
</dd>
<dt class="hdlist1"><code>test</code></dt>
<dd>
<p>Contains your test source code, which is compiled and executed using JUnit or TestNG. These are typically unit tests, but you can include any test in this source set as long as they all share the same compilation and runtime classpaths.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="sec:source_set_properties"><a class="anchor" href="#sec:source_set_properties"></a><a class="link" href="#sec:source_set_properties">Source set properties</a></h5>
<div class="paragraph">
<p>The following table lists some of the important properties of a source set. You can find more details in the API documentation for <a href="../dsl/org.gradle.api.tasks.SourceSet.html">SourceSet</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>name</code> (read-only) <code>String</code></dt>
<dd>
<p>The name of the source set, used to identify it.</p>
</dd>
<dt class="hdlist1"><code>output</code> (read-only) <a href="../dsl/org.gradle.api.tasks.SourceSetOutput.html">SourceSetOutput</a></dt>
<dd>
<p>The output files of the source set, containing its compiled classes and resources.</p>
</dd>
<dt class="hdlist1"><code>output.classesDirs</code> (read-only) <a href="../javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a></dt>
<dd>
<p><em>Default value</em>: <code>$buildDir/classes/java/$name</code>, e.g. <em>build/classes/java/main</em></p>
<div class="paragraph">
<p>The directories to generate the classes of this source set into. May contain directories for other JVM languages, e.g. <em>build/classes/kotlin/main</em>.</p>
</div>
</dd>
<dt class="hdlist1"><code>output.resourcesDir</code> <code>File</code></dt>
<dd>
<p><em>Default value</em>: <code>$buildDir/resources/$name</code>, e.g. <em>build/resources/main</em></p>
<div class="paragraph">
<p>The directory to generate the resources of this source set into.</p>
</div>
</dd>
<dt class="hdlist1"><code>compileClasspath</code> <a href="../javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a></dt>
<dd>
<p><em>Default value</em>: <code>${name}CompileClasspath</code> configuration</p>
<div class="paragraph">
<p>The classpath to use when compiling the source files of this source set.</p>
</div>
</dd>
<dt class="hdlist1"><code>annotationProcessorPath</code> <a href="../javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a></dt>
<dd>
<p><em>Default value</em>: <code>${name}AnnotationProcessor</code> configuration</p>
<div class="paragraph">
<p>The processor path to use when compiling the source files of this source set.</p>
</div>
</dd>
<dt class="hdlist1"><code>runtimeClasspath</code> <a href="../javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a></dt>
<dd>
<p><em>Default value</em>: <code>$output</code>, <code>${name}RuntimeClasspath</code> configuration</p>
<div class="paragraph">
<p>The classpath to use when executing the classes of this source set.</p>
</div>
</dd>
<dt class="hdlist1"><code>java</code> (read-only) <a href="../dsl/org.gradle.api.file.SourceDirectorySet.html">SourceDirectorySet</a></dt>
<dd>
<p>The Java source files of this source set. Contains only <code>.java</code> files found in the Java source directories, and excludes all other files.</p>
</dd>
<dt class="hdlist1"><code>java.srcDirs</code> <code>Set&lt;File&gt;</code></dt>
<dd>
<p><em>Default value</em>: <code>src/$name/java</code>, e.g. <em>src/main/java</em></p>
<div class="paragraph">
<p>The source directories containing the Java source files of this source set.  You can set this to any value that is described in sec:specifying_multiple_files<a href="#sec:specifying_multiple_files">this section</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>java.outputDir</code> <code>File</code></dt>
<dd>
<p><em>Default value</em>: <code>$buildDir/classes/java/$name</code>, e.g. <em>build/classes/java/main</em></p>
<div class="paragraph">
<p>The directory to generate compiled Java sources into. You can set this to any value that is described in <a href="#sec:single_file_paths">this section</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>resources</code> (read-only) <a href="../dsl/org.gradle.api.file.SourceDirectorySet.html">SourceDirectorySet</a></dt>
<dd>
<p>The resources of this source set. Contains only resources, and excludes any <code>.java</code> files found in the resource directories. Other plugins, such as the <a href="#groovy_plugin">Groovy Plugin</a>, exclude additional types of files from this collection.</p>
</dd>
<dt class="hdlist1"><code>resources.srcDirs</code> <code>Set&lt;File&gt;</code></dt>
<dd>
<p><em>Default value</em>: <code>[src/$name/resources]</code></p>
<div class="paragraph">
<p>The directories containing the resources of this source set. You can set this to any type of value that is described in <a href="#sec:specifying_multiple_files">this section</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>allJava</code> (read-only) <a href="../dsl/org.gradle.api.file.SourceDirectorySet.html">SourceDirectorySet</a></dt>
<dd>
<p><em>Default value</em>: Same as <code>java</code> property</p>
<div class="paragraph">
<p>All Java files of this source set. Some plugins, such as the Groovy Plugin, add additional Java source files to this collection.</p>
</div>
</dd>
<dt class="hdlist1"><code>allSource</code> (read-only) <a href="../dsl/org.gradle.api.file.SourceDirectorySet.html">SourceDirectorySet</a></dt>
<dd>
<p><em>Default value</em>: Sum of everything in the <code>resources</code> and <code>java</code> properties</p>
<div class="paragraph">
<p>All source files of this source set of any language. This includes all resource files and all Java source files. Some plugins, such as the Groovy Plugin, add additional source files to this collection.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="sec:defining_new_source_sets"><a class="anchor" href="#sec:defining_new_source_sets"></a><a class="link" href="#sec:defining_new_source_sets">Defining new source sets</a></h5>
<div class="paragraph">
<p>See the <a href="#sec:configuring_java_integration_tests">integration test example</a> in the <em>Testing in Java &amp; JVM projects</em> chapter.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:some_source_set_examples"><a class="anchor" href="#sec:some_source_set_examples"></a><a class="link" href="#sec:some_source_set_examples">Some other simple source set examples</a></h5>
<div class="paragraph">
<p>Adding a JAR containing the classes of a source set:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_assembling_a_jar_for_a_source_set"><a class="anchor" href="#example_assembling_a_jar_for_a_source_set"></a><a class="link" href="#example_assembling_a_jar_for_a_source_set">Example: Assembling a JAR for a source set</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task intTestJar(<span class="key">type</span>: Jar) {
    from sourceSets.intTest.output
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Generating Javadoc for a source set:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_generating_the_javadoc_for_a_source_set"><a class="anchor" href="#example_generating_the_javadoc_for_a_source_set"></a><a class="link" href="#example_generating_the_javadoc_for_a_source_set">Example: Generating the Javadoc for a source set</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task intTestJavadoc(<span class="key">type</span>: Javadoc) {
    source sourceSets.intTest.allJava
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adding a test suite to run the tests in a source set:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_running_tests_in_a_source_set"><a class="anchor" href="#example_running_tests_in_a_source_set"></a><a class="link" href="#example_running_tests_in_a_source_set">Example: Running tests in a source set</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task intTest(<span class="key">type</span>: Test) {
    testClassesDirs = sourceSets.intTest.output.classesDirs
    classpath = sourceSets.intTest.runtimeClasspath
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_tasks"><a class="anchor" href="#sec:java_tasks"></a><a class="link" href="#sec:java_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Java plugin adds a number of tasks to your project, as shown below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>compileJava</code>  <a href="../dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a></dt>
<dd>
<p><em>Depends on</em>: All tasks which contribute to the compilation classpath, including <code>jar</code> tasks from projects that are on the classpath via project dependencies</p>
<div class="paragraph">
<p>Compiles production Java source files using the JDK compiler.</p>
</div>
</dd>
<dt class="hdlist1"><code>processResources</code>  <a href="../dsl/org.gradle.api.tasks.Copy.html">Copy</a></dt>
<dd>
<p>Copies production resources into the production resources directory.</p>
</dd>
<dt class="hdlist1"><code>classes</code></dt>
<dd>
<p><em>Depends on</em>: <code>compileJava</code>, <code>processResources</code></p>
<div class="paragraph">
<p>This is an aggregate task that just depends on other tasks. Other plugins may attach additional compilation tasks to it.</p>
</div>
</dd>
<dt class="hdlist1"><code>compileTestJava</code>  <a href="../dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>classes</code>, and all tasks that contribute to the test compilation classpath</p>
<div class="paragraph">
<p>Compiles test Java source files using the JDK compiler.</p>
</div>
</dd>
<dt class="hdlist1"><code>processTestResources</code>  <a href="../dsl/org.gradle.api.tasks.Copy.html">Copy</a></dt>
<dd>
<p>Copies test resources into the test resources directory.</p>
</dd>
<dt class="hdlist1"><code>testClasses</code></dt>
<dd>
<p><em>Depends on</em>: <code>compileTestJava</code>, <code>processTestResources</code></p>
<div class="paragraph">
<p>This is an aggregate task that just depends on other tasks. Other plugins may attach additional test compilation tasks to it.</p>
</div>
</dd>
<dt class="hdlist1"><code>jar</code>  <a href="../dsl/org.gradle.api.tasks.bundling.Jar.html">Jar</a></dt>
<dd>
<p><em>Depends on</em>: <code>classes</code></p>
<div class="paragraph">
<p>Assembles the production JAR file, based on the classes and resources attached to the <code>main</code> source set.</p>
</div>
</dd>
<dt class="hdlist1"><code>javadoc</code>  <a href="../dsl/org.gradle.api.tasks.javadoc.Javadoc.html">Javadoc</a></dt>
<dd>
<p><em>Depends on</em>: <code>classes</code></p>
<div class="paragraph">
<p>Generates API documentation for the production Java source using Javadoc.</p>
</div>
</dd>
<dt class="hdlist1"><code>test</code>  <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a></dt>
<dd>
<p><em>Depends on</em>: <code>testClasses</code>, and all tasks which produce the test runtime classpath</p>
<div class="paragraph">
<p>Runs the unit tests using JUnit or TestNG.</p>
</div>
</dd>
<dt class="hdlist1"><code>uploadArchives</code>  <a href="../dsl/org.gradle.api.tasks.Upload.html">Upload</a></dt>
<dd>
<p><em>Depends on</em>: <code>jar</code>, and any other task that produces an artifact attached to the <code>archives</code> configuration</p>
<div class="paragraph">
<p>Uploads artifacts in the <code>archives</code> configuration including the production JAR file to the configured repositories.</p>
</div>
</dd>
<dt class="hdlist1"><code>clean</code>  <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a></dt>
<dd>
<p>Deletes the project build directory.</p>
</dd>
<dt class="hdlist1"><code>clean<em>TaskName</em></code>  <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a></dt>
<dd>
<p>Deletes files created by the specified task. For example, <code>cleanJar</code> will delete the JAR file created by the <code>jar</code> task and <code>cleanTest</code> will delete the test results created by the <code>test</code> task.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="java_source_set_tasks"><a class="anchor" href="#java_source_set_tasks"></a><a class="link" href="#java_source_set_tasks">SourceSet Tasks</a></h5>
<div class="paragraph">
<p>For each source set you add to the project, the Java plugin adds the following tasks:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>compile<em>SourceSet</em>Java</code>  <a href="../dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a></dt>
<dd>
<p><em>Depends on</em>: All tasks which contribute to the source set&#8217;s compilation classpath</p>
<div class="paragraph">
<p>Compiles the given source set&#8217;s Java source files using the JDK compiler.</p>
</div>
</dd>
<dt class="hdlist1"><code>process<em>SourceSet</em>Resources</code>  <a href="../dsl/org.gradle.api.tasks.Copy.html">Copy</a></dt>
<dd>
<p>Copies the given source set&#8217;s resources into the resources directory.</p>
</dd>
<dt class="hdlist1"><code><em>sourceSet</em>Classes</code>  <a href="../dsl/org.gradle.api.Task.html">Task</a></dt>
<dd>
<p><em>Depends on</em>: <code>compile<em>SourceSet</em>Java</code>, <code>process<em>SourceSet</em>Resources</code></p>
<div class="paragraph">
<p>Prepares the given source set&#8217;s classes and resources for packaging and execution. Some plugins may add additional compilation tasks for the source set.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="lifecycle_tasks"><a class="anchor" href="#lifecycle_tasks"></a><a class="link" href="#lifecycle_tasks">Lifecycle Tasks</a></h5>
<div class="paragraph">
<p>The Java plugin attaches some of its tasks to the lifecycle tasks defined by the <a href="#sec:base_tasks">Base Plugin</a>  which the Java Plugin applies automatically  and it also adds a few other lifecycle tasks:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>assemble</code></dt>
<dd>
<p><em>Depends on</em>: <code>jar</code>, and all other tasks that create artifacts attached to the <code>archives</code> configuration</p>
<div class="paragraph">
<p>Aggregate task that assembles all the archives in the project. This task is added by the Base Plugin.</p>
</div>
</dd>
<dt class="hdlist1"><code>check</code></dt>
<dd>
<p><em>Depends on</em>: <code>test</code></p>
<div class="paragraph">
<p>Aggregate task that performs verification tasks, such as running the tests. Some plugins add their own verification tasks to <code>check</code>. You should also attach any custom <code>Test</code> tasks to this lifecycle task if you want them to execute for a full build. This task is added by the Base Plugin.</p>
</div>
</dd>
<dt class="hdlist1"><code>build</code></dt>
<dd>
<p><em>Depends on</em>: <code>check</code>, <code>assemble</code></p>
<div class="paragraph">
<p>Aggregate tasks that performs a full build of the project. This task is added by the Base Plugin.</p>
</div>
</dd>
<dt class="hdlist1"><code>buildNeeded</code></dt>
<dd>
<p><em>Depends on</em>: <code>build</code>, and <code>buildNeeded</code> tasks in all projects that are dependencies in the <code>testRuntimeClasspath</code> configuration.</p>
<div class="paragraph">
<p>Performs a full build of the project and all projects it depends on.</p>
</div>
</dd>
<dt class="hdlist1"><code>buildDependents</code></dt>
<dd>
<p><em>Depends on</em>: <code>build</code>, and <code>buildDependents</code> tasks in all projects that have this project as a dependency in theeir <code>testRuntimeClasspath</code> configurations</p>
<div class="paragraph">
<p>Performs a full build of the project and all projects which depend upon it.</p>
</div>
</dd>
<dt class="hdlist1"><code>build<em>ConfigName</em></code> <em>task rule</em></dt>
<dd>
<p><em>Depends on</em>: all tasks that generate the artifacts attached to the named <em>ConfigName</em>  configuration</p>
<div class="paragraph">
<p>Assembles the artifacts for the specified configuration. This rule is added by the Base Plugin.</p>
</div>
</dd>
<dt class="hdlist1"><code>upload<em>ConfigName</em></code> <em>task rule</em>, type: <a href="../dsl/org.gradle.api.tasks.Upload.html">Upload</a></dt>
<dd>
<p><em>Depends on</em>: all tasks that generate the artifacts attached to the named <em>ConfigName</em>  configuration</p>
<div class="paragraph">
<p>Assembles and uploads the artifacts in the specified configuration. This rule is added by the Base Plugin.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following diagram shows the relationships between these tasks.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/javaPluginTasks.png" alt="javaPluginTasks">
</div>
<div class="title">Figure 28. Java plugin - tasks</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_plugin_and_dependency_management"><a class="anchor" href="#sec:java_plugin_and_dependency_management"></a><a class="link" href="#sec:java_plugin_and_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>The Java plugin adds a number of <a href="#managing_dependency_configurations">dependency configurations</a> to your project, as shown below. It assigns those configurations to tasks such as <code>compileJava</code> and <code>test</code>.</p>
</div>
<div class="sect4">
<h5 id="tab:configurations"><a class="anchor" href="#tab:configurations"></a><a class="link" href="#tab:configurations">Dependency configurations</a></h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>To find information on the <code>api</code> configuration, please consult the <a href="#sec:java_library_separation">Java Library Plugin</a> reference documentation and the <a href="#dependency_management_for_java_projects">Dependency Management Tutorial</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><span class="line-through"><code>compile</code></span>(Deprecated)</dt>
<dd>
<p>Compile time dependencies. Superseded by <code>implementation</code>.</p>
</dd>
<dt class="hdlist1"><code>implementation</code> extends <code>compile</code></dt>
<dd>
<p>Implementation only dependencies.</p>
</dd>
<dt class="hdlist1"><code>compileOnly</code></dt>
<dd>
<p>Compile time only dependencies, not used at runtime.</p>
</dd>
<dt class="hdlist1"><code>compileClasspath</code> extends <code>compile, compileOnly, implementation</code></dt>
<dd>
<p>Compile classpath, used when compiling source. Used by task <code>compileJava</code>.</p>
</dd>
<dt class="hdlist1"><code>annotationProcessor</code></dt>
<dd>
<p>Annotation processors used during compilation.</p>
</dd>
<dt class="hdlist1"><span class="line-through"><code>runtime</code></span>(Deprecated) extends <code>compile</code></dt>
<dd>
<p>Runtime dependencies. Superseded by <code>runtimeOnly</code>.</p>
</dd>
<dt class="hdlist1"><code>runtimeOnly</code></dt>
<dd>
<p>Runtime only dependencies.</p>
</dd>
<dt class="hdlist1"><code>runtimeClasspath</code> extends <code>runtimeOnly, runtime, implementation</code></dt>
<dd>
<p>Runtime classpath contains elements of the implementation, as well as runtime only elements.</p>
</dd>
<dt class="hdlist1"><span class="line-through"><code>testCompile</code></span>(Deprecated) extends <code>compile</code></dt>
<dd>
<p>Additional dependencies for compiling tests. Superseded by <code>testImplementation</code>.</p>
</dd>
<dt class="hdlist1"><code>testImplementation</code> extends <code>testCompile, implementation</code></dt>
<dd>
<p>Implementation only dependencies for tests.</p>
</dd>
<dt class="hdlist1"><code>testCompileOnly</code></dt>
<dd>
<p>Additional dependencies only for compiling tests, not used at runtime.</p>
</dd>
<dt class="hdlist1"><code>testCompileClasspath</code> extends <code>testCompile, testCompileOnly, testImplementation</code></dt>
<dd>
<p>Test compile classpath, used when compiling test sources. Used by task <code>compileTestJava</code>.</p>
</dd>
<dt class="hdlist1"><span class="line-through"><code>testRuntime</code></span>(Deprecated) extends <code>runtime, testCompile</code></dt>
<dd>
<p>Additional dependencies for running tests only. Used by task <code>test</code>. Superseded by <code>testRuntimeOnly</code>.</p>
</dd>
<dt class="hdlist1"><code>testRuntimeOnly</code> extends <code>runtimeOnly</code></dt>
<dd>
<p>Runtime only dependencies for running tests. Used by task <code>test</code>.</p>
</dd>
<dt class="hdlist1"><code>testRuntimeClasspath</code> extends <code>testRuntimeOnly, testRuntime, testImplementation</code></dt>
<dd>
<p>Runtime classpath for running tests.</p>
</dd>
<dt class="hdlist1"><code>archives</code></dt>
<dd>
<p>Artifacts (e.g. jars) produced by this project. Used by tasks <code>uploadArchives</code>.</p>
</dd>
<dt class="hdlist1"><code>default</code> extends <code>runtime</code></dt>
<dd>
<p>The default configuration used by a project dependency on this project. Contains the artifacts and dependencies required by this project at runtime.</p>
</dd>
</dl>
</div>
<div class="imageblock">
<div class="content">
<img src="img/javaPluginConfigurations.png" alt="javaPluginConfigurations">
</div>
<div class="title">Figure 29. Java plugin - dependency configurations</div>
</div>
<div class="paragraph">
<p>For each source set you add to the project, the Java plugins adds the following dependency configurations:</p>
</div>
</div>
<div class="sect4">
<h5 id="java_source_set_configurations"><a class="anchor" href="#java_source_set_configurations"></a><a class="link" href="#java_source_set_configurations">SourceSet dependency configurations</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><span class="line-through"><code><em>sourceSet</em>Compile</code></span>(Deprecated)</dt>
<dd>
<p>Compile time dependencies for the given source set. Superseded by <code><em>sourceSet</em>Implementation</code>.</p>
</dd>
<dt class="hdlist1"><code><em>sourceSet</em>Implementation</code> extends <code><em>sourceSet</em>Compile</code></dt>
<dd>
<p>Compile time dependencies for the given source set. Used by <code><em>sourceSet</em>CompileClasspath, <em>sourceSet</em>RuntimeClasspath</code>.</p>
</dd>
<dt class="hdlist1"><code><em>sourceSet</em>CompileOnly</code></dt>
<dd>
<p>Compile time only dependencies for the given source set, not used at runtime.</p>
</dd>
<dt class="hdlist1"><code><em>sourceSet</em>CompileClasspath</code> extends <code>compile<em>SourceSet</em>Java</code></dt>
<dd>
<p>Compile classpath, used when compiling source. Used by <code><em>sourceSet</em>Compile, <em>sourceSet</em>CompileOnly, <em>sourceSet</em>Implementation</code>.</p>
</dd>
<dt class="hdlist1"><code><em>sourceSet</em>AnnotationProcessor</code></dt>
<dd>
<p>Annotation processors used during compilation of this source set.</p>
</dd>
<dt class="hdlist1"><span class="line-through"><code><em>sourceSet</em>Runtime</code></span>(Deprecated)</dt>
<dd>
<p>Runtime dependencies for the given source set. Used by <code><em>sourceSet</em>Compile</code>. Superseded by <code><em>sourceSet</em>RuntimeOnly</code>.</p>
</dd>
<dt class="hdlist1"><code><em>sourceSet</em>RuntimeOnly</code></dt>
<dd>
<p>Runtime only dependencies for the given source set.</p>
</dd>
<dt class="hdlist1"><code><em>sourceSet</em>RuntimeClasspath</code> extends <code><em>sourceSet</em>RuntimeOnly, <em>sourceSet</em>Runtime, <em>sourceSet</em>Implementation</code></dt>
<dd>
<p>Runtime classpath contains elements of the implementation, as well as runtime only elements.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_plugin_publishing"><a class="anchor" href="#sec:java_plugin_publishing"></a><a class="link" href="#sec:java_plugin_publishing">Publishing</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>components.java</code></dt>
<dd>
<p>A <a href="../javadoc/org/gradle/api/component/SoftwareComponent.html">SoftwareComponent</a> for <a href="#publishing_overview">publishing</a> the production JAR created by the <code>jar</code> task. This component includes the runtime dependency information for the JAR.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_convention_properties"><a class="anchor" href="#sec:java_convention_properties"></a><a class="link" href="#sec:java_convention_properties">Convention properties</a></h4>
<div class="paragraph">
<p>The Java Plugin adds a number of convention properties to the project, shown below. You can use these properties in your build script as though they were properties of the project object.</p>
</div>
<div class="sect4">
<h5 id="directory_properties"><a class="anchor" href="#directory_properties"></a><a class="link" href="#directory_properties">Directory properties</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>String reporting.baseDir</code></dt>
<dd>
<p>The name of the directory to generate reports into, relative to the build directory. Default value: <code>reports</code></p>
</dd>
<dt class="hdlist1"><code>(read-only) File reportsDir</code></dt>
<dd>
<p>The directory to generate reports into. Default value: <code><em>buildDir</em>/<em>reporting.baseDir</em></code></p>
</dd>
<dt class="hdlist1"><code>String testResultsDirName</code></dt>
<dd>
<p>The name of the directory to generate test result .xml files into, relative to the build directory. Default value: <code>test-results</code></p>
</dd>
<dt class="hdlist1"><code>(read-only) File testResultsDir</code></dt>
<dd>
<p>The directory to generate test result .xml files into. Default value: <code><em>buildDir</em>/<em>testResultsDirName</em></code></p>
</dd>
<dt class="hdlist1"><code>String testReportDirName</code></dt>
<dd>
<p>The name of the directory to generate the test report into, relative to the reports directory. Default value: <code>tests</code></p>
</dd>
<dt class="hdlist1"><code>(read-only) File testReportDir</code></dt>
<dd>
<p>The directory to generate the test report into. Default value: <code><em>reportsDir</em>/testReportDirName</code></p>
</dd>
<dt class="hdlist1"><code>String libsDirName</code></dt>
<dd>
<p>The name of the directory to generate libraries into, relative to the build directory. Default value: <code>libs</code></p>
</dd>
<dt class="hdlist1"><code>(read-only) File libsDir</code></dt>
<dd>
<p>The directory to generate libraries into. Default value: <code><em>buildDir</em>/<em>libsDirName</em></code></p>
</dd>
<dt class="hdlist1"><code>String distsDirName</code></dt>
<dd>
<p>The name of the directory to generate distributions into, relative to the build directory. Default value: <code>distributions</code></p>
</dd>
<dt class="hdlist1"><code>(read-only) File distsDir</code></dt>
<dd>
<p>The directory to generate distributions into. Default value: <code><em>buildDir</em>/<em>distsDirName</em></code></p>
</dd>
<dt class="hdlist1"><code>String docsDirName</code></dt>
<dd>
<p>The name of the directory to generate documentation into, relative to the build directory. Default value: <code>docs</code></p>
</dd>
<dt class="hdlist1"><code>(read-only) File docsDir</code></dt>
<dd>
<p>The directory to generate documentation into. Default value: <code><em>buildDir</em>/<em>docsDirName</em></code></p>
</dd>
<dt class="hdlist1"><code>String dependencyCacheDirName</code></dt>
<dd>
<p>The name of the directory to use to cache source dependency information, relative to the build directory. Default value: <code>dependency-cache</code></p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="other_convention_properties"><a class="anchor" href="#other_convention_properties"></a><a class="link" href="#other_convention_properties">Other convention properties</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>(read-only) <a href="../javadoc/org/gradle/api/tasks/SourceSetContainer.html">SourceSetContainer</a> sourceSets</code></dt>
<dd>
<p>Contains the project&#8217;s source sets. Default value: Not null <a href="../javadoc/org/gradle/api/tasks/SourceSetContainer.html">SourceSetContainer</a></p>
</dd>
<dt class="hdlist1"><code><a href="../javadoc/org/gradle/api/JavaVersion.html">JavaVersion</a> sourceCompatibility</code></dt>
<dd>
<p>Java version compatibility to use when compiling Java source. Default value: version of the current JVM in use <a href="../javadoc/org/gradle/api/JavaVersion.html">JavaVersion</a>. Can also set using a String or a Number, e.g. <code>'1.5'</code> or <code>1.5</code>.</p>
</dd>
<dt class="hdlist1"><code><a href="../javadoc/org/gradle/api/JavaVersion.html">JavaVersion</a> targetCompatibility</code></dt>
<dd>
<p>Java version to generate classes for. Default value: <code><em>sourceCompatibility</em></code>. Can also set using a String or Number, e.g. <code>'1.5'</code> or <code>1.5</code>.</p>
</dd>
<dt class="hdlist1"><code>String archivesBaseName</code></dt>
<dd>
<p>The basename to use for archives, such as JAR or ZIP files. Default value: <code><em>projectName</em></code></p>
</dd>
<dt class="hdlist1"><code><a href="../javadoc/org/gradle/api/java/archives/Manifest.html">Manifest</a> manifest</code></dt>
<dd>
<p>The manifest to include in all JAR files. Default value: an empty manifest.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These properties are provided by convention objects of type <a href="../javadoc/org/gradle/api/plugins/JavaPluginConvention.html">JavaPluginConvention</a>, and <a href="../javadoc/org/gradle/api/plugins/BasePluginConvention.html">BasePluginConvention</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:javadoc"><a class="anchor" href="#sec:javadoc"></a><a class="link" href="#sec:javadoc">Javadoc</a></h4>
<div class="paragraph">
<p>The <code>javadoc</code> task is an instance of <a href="../dsl/org.gradle.api.tasks.javadoc.Javadoc.html">Javadoc</a>. It supports the core Javadoc options and the options of the standard doclet described in the <a href="http://docs.oracle.com/javase/7/docs/technotes/tools/windows/javadoc.html">reference documentation</a> of the Javadoc executable. For a complete list of supported Javadoc options consult the API documentation of the following classes: <a href="../javadoc/org/gradle/external/javadoc/CoreJavadocOptions.html">CoreJavadocOptions</a> and <a href="../javadoc/org/gradle/external/javadoc/StandardJavadocDocletOptions.html">StandardJavadocDocletOptions</a>.</p>
</div>
<div class="sect4">
<h5 id="javadoc_properties"><a class="anchor" href="#javadoc_properties"></a><a class="link" href="#javadoc_properties">Javadoc properties</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><a href="../javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a> classpath</code></dt>
<dd>
<p>Default value: <code>sourceSets.main.output</code> + <code>sourceSets.main.compileClasspath</code></p>
</dd>
<dt class="hdlist1"><code><a href="../javadoc/org/gradle/api/file/FileTree.html">FileTree</a> source</code></dt>
<dd>
<p>Default value: <code>sourceSets.main.allJava</code>. Can set using anything described in <a href="#sec:specifying_multiple_files">Understanding implicit conversion to file collections</a>.</p>
</dd>
<dt class="hdlist1"><code>File destinationDir</code></dt>
<dd>
<p>Default value: <code><em>docsDir</em>/javadoc</code></p>
</dd>
<dt class="hdlist1"><code>String title</code></dt>
<dd>
<p>Default value: The name and version of the project</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:clean"><a class="anchor" href="#sec:clean"></a><a class="link" href="#sec:clean">Clean</a></h4>
<div class="paragraph">
<p>The <code>clean</code> task is an instance of <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a>. It simply removes the directory denoted by its <code>dir</code> property.</p>
</div>
<div class="sect4">
<h5 id="clean_properties"><a class="anchor" href="#clean_properties"></a><a class="link" href="#clean_properties">Clean properties</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>File dir</code></dt>
<dd>
<p>Default value: <code><em>buildDir</em></code></p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="resources"><a class="anchor" href="#resources"></a><a class="link" href="#resources">Resources</a></h4>
<div class="paragraph">
<p>The Java plugin uses the <a href="../dsl/org.gradle.api.tasks.Copy.html">Copy</a> task for resource handling. It adds an instance for each source set in the project. You can find out more about the copy task in <a href="#sec:copying_files">File copying in depth</a>.</p>
</div>
<div class="sect4">
<h5 id="processresources_properties"><a class="anchor" href="#processresources_properties"></a><a class="link" href="#processresources_properties">ProcessResources properties</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>Object srcDirs</code></dt>
<dd>
<p>Default value: <code><em>sourceSet</em>.resources</code>. Can set using anything described in <a href="#sec:specifying_multiple_files">Understanding implicit conversion to file collections</a>.</p>
</dd>
<dt class="hdlist1"><code>File destinationDir</code></dt>
<dd>
<p>Default value: <code><em>sourceSet</em>.output.resourcesDir</code>. Can set using anything described in <a href="#sec:locating_files">file paths in depth</a>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="compilejava"><a class="anchor" href="#compilejava"></a><a class="link" href="#compilejava">CompileJava</a></h4>
<div class="paragraph">
<p>The Java plugin adds a <a href="../dsl/org.gradle.api.tasks.compile.JavaCompile.html">JavaCompile</a> instance for each source set in the project. Some of the most common configuration options are shown below.</p>
</div>
<div class="sect4">
<h5 id="compile_properties"><a class="anchor" href="#compile_properties"></a><a class="link" href="#compile_properties">Compile properties</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><a href="../javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a> classpath</code></dt>
<dd>
<p>Default value: <code><em>sourceSet</em>.compileClasspath</code></p>
</dd>
<dt class="hdlist1"><code><a href="../javadoc/org/gradle/api/file/FileTree.html">FileTree</a> source</code></dt>
<dd>
<p>Default value: <code><em>sourceSet</em>.java</code>. Can set using anything described in <a href="#sec:specifying_multiple_files">Understanding implicit conversion to file collections</a>.</p>
</dd>
<dt class="hdlist1"><code>File destinationDir</code></dt>
<dd>
<p>Default value: <code><em>sourceSet</em>.java.outputDir</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>By default, the Java compiler runs in the Gradle process. Setting <code>options.fork</code> to <code>true</code> causes compilation to occur in a separate process. In the case of the Ant javac task, this means that a new process will be forked for each compile task, which can slow down compilation. Conversely, Gradle&#8217;s direct compiler integration (see above) will reuse the same compiler process as much as possible. In both cases, all fork options specified with <code>options.forkOptions</code> will be honored.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:incremental_compile"><a class="anchor" href="#sec:incremental_compile"></a><a class="link" href="#sec:incremental_compile">Incremental Java compilation</a></h5>
<div class="paragraph">
<p>Gradle comes with a sophisticated incremental Java compiler that is active by default.</p>
</div>
<div class="paragraph">
<p>This gives you the following benefits</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Incremental builds are much faster.</p>
</li>
<li>
<p>The smallest possible number of class files are changed.
Classes that don&#8217;t need to be recompiled remain unchanged in the output directory.
An example scenario when this is really useful is using JRebel - the fewer output classes are changed the quicker the JVM can use refreshed classes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To help you understand how incremental compilation works, the following provides a high-level overview:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle will recompile all classes <em>affected</em> by a change.</p>
</li>
<li>
<p>A class is <em>affected</em> if it has been changed or if it depends on another affected class.
This works no matter if the other class is defined in the same project, another project or even an external library.</p>
</li>
<li>
<p>A class&#8217;s dependencies are determined from type references in its bytecode.</p>
</li>
<li>
<p>Since constants can be inlined, any change to a constant will result in Gradle recompiling all source files.
For that reason, you should try to minimize the use of constants in your source code and replace them with static methods where possible.</p>
</li>
<li>
<p>Since source-retention annotations are not visible in bytecode, changes to a source-retention annotation will result in full recompilation.</p>
</li>
<li>
<p>You can improve incremental compilation performance by applying good software desing principles like loose coupling.
For instance, if you put an interface between a concrete class and its dependents, the dependent classes are only recompiled when the interface changes, but not when the implementation changes.</p>
</li>
<li>
<p>The class analysis is cached in the project directory, so the first build after a clean checkout can be slower. Consider turning off the incremental compiler on your build server.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="sec:incremental_compilation_known_issues"><a class="anchor" href="#sec:incremental_compilation_known_issues"></a><a class="link" href="#sec:incremental_compilation_known_issues">Known issues</a></h6>
<div class="ulist">
<ul>
<li>
<p>If a compile task fails due to a compile error, it will do a full compilation again the next time it is invoked.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:incremental_annotation_processing"><a class="anchor" href="#sec:incremental_annotation_processing"></a><a class="link" href="#sec:incremental_annotation_processing">Incremental annotation processing</a></h5>
<div class="paragraph">
<p>Starting with Gradle 4.7, the incremental compiler also supports incremental annotation processing.
Annotation processors need to opt in to this feature, otherwise they will trigger a full recompilation.</p>
</div>
<div class="paragraph">
<p>As a user you can see which annotation processors are triggering full recompilations in the <code>--info</code> log.
Incremental annotation processing will be deactivated if a custom <code>executable</code> or <code>javaHome</code> is configured on the compile task.</p>
</div>
<div class="sect5">
<h6 id="making_an_annotation_processor_incremental"><a class="anchor" href="#making_an_annotation_processor_incremental"></a><a class="link" href="#making_an_annotation_processor_incremental">Making an annotation processor incremental</a></h6>
<div class="paragraph">
<p>Please first have a look at <a href="#sec:incremental_compile">incremental Java compilation</a>, as incremental annotation processing builds on top of it.</p>
</div>
<div class="paragraph">
<p>Gradle supports incremental compilation for two common categories of annotation processors: "isolating" and "aggregating".
Please consult the information below to decide which category fits your processor.</p>
</div>
<div class="paragraph">
<p>You can then register your processor for incremental compilation using a file in the processor&#8217;s META-INF directory.
The format is one line per processor, with the fully qualified name of the processor class and its category separated by a comma.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_registering_incremental_annotation_processors"><a class="anchor" href="#example_registering_incremental_annotation_processors"></a><a class="link" href="#example_registering_incremental_annotation_processors">Example: Registering incremental annotation processors</a></h5>
<div class="listingblock">
<div class="title">processor/src/main/resources/META-INF/gradle/incremental.annotation.processors</div>
<div class="content">
<pre>EntityProcessor,isolating
ServiceRegistryProcessor,dynamic</pre>
</div>
</div>
<div class="paragraph">
<p>If your processor can only decide at runtime whether it is incremental or not, you can declare it as "dynamic" in the META-INF descriptor
and return its true type at runtime using the <a href="https://docs.oracle.com/javase/10/docs/api/javax/annotation/processing/Processor.html#getSupportedOptions()">Processor#getSupportedOptions()</a> method.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_registering_incremental_annotation_processors_dynamically"><a class="anchor" href="#example_registering_incremental_annotation_processors_dynamically"></a><a class="link" href="#example_registering_incremental_annotation_processors_dynamically">Example: Registering incremental annotation processors dynamically</a></h5>
<div class="listingblock">
<div class="title">processor/src/main/java/ServiceRegistryProcessor.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Override</span>
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; getSupportedOptions() {
    <span class="keyword">return</span> <span class="predefined-type">Collections</span>.singleton(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.annotation.processing.aggregating</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both categories have the following limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They must generate their files using the <a href="https://docs.oracle.com/javase/10/docs/api/javax/annotation/processing/Filer.html">Filer API</a>.
Writing files any other way will result in silent failures later on, as these files won&#8217;t be cleaned up correctly.
If your processor does this, it cannot be incremental.</p>
</li>
<li>
<p>They must not depend on compiler-specific APIs like <a href="https://docs.oracle.com/javase/8/docs/jdk/api/javac/tree/com/sun/source/util/Trees.html">com.sun.source.util.Trees</a>.
Gradle wraps the processing APIs, so attempts to cast to compiler-specific types will fail.
If your processor does this, it cannot be incremental, unless you have some fallback mechanism.</p>
</li>
<li>
<p>If they use <a href="https://docs.oracle.com/javase/10/docs/api/javax/annotation/processing/Filer.html#getResource(javax.tools.JavaFileManager.Location,java.lang.CharSequence,java.lang.CharSequence)">Filer#getResource</a>, Gradle will recompile all source files.
See <a href="https://github.com/gradle/gradle/issues/4701">gradle/issues/4701</a></p>
</li>
<li>
<p>If they use <a href="https://docs.oracle.com/javase/10/docs/api/javax/annotation/processing/Filer.html#createResource(javax.tools.JavaFileManager.Location,java.lang.CharSequence,java.lang.CharSequence,javax.lang.model.element.Element...)">Filer#createResource</a>, Gradle will recompile all source files.
See <a href="https://github.com/gradle/gradle/issues/4702">gradle/issues/4702</a></p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="isolating_annotation_processors"><a class="anchor" href="#isolating_annotation_processors"></a><a class="link" href="#isolating_annotation_processors">"Isolating" annotation processors</a></h6>
<div class="paragraph">
<p>The fastest category, these look at each annotated element in isolation, creating generated files or validation messages for it.
For instance an <code>EntityProcessor</code> could create a <code>&lt;TypeName&gt;Repository</code> for each type annotated  with <code>@Entity</code>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_an_isolated_annotation_processor"><a class="anchor" href="#example_an_isolated_annotation_processor"></a><a class="link" href="#example_an_isolated_annotation_processor">Example: An isolated annotation processor</a></h5>
<div class="listingblock">
<div class="title">processor/src/main/java/EntityProcessor.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Set</span>&lt;? <span class="directive">extends</span> <span class="predefined-type">Element</span>&gt; entities = roundEnv.getElementsAnnotatedWith(entityAnnotation);
<span class="keyword">for</span> (<span class="predefined-type">Element</span> entity : entities) {
    createRepository((TypeElement) entity);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>"Isolating" processors have the following limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They must make all decisions (code generation, validation messages) for an annotated type based on information reachable from its AST.
This means you can analyze the types' super-class, method return types, annotations etc., even transitively.
But you cannot make decisions based on unrelated elements in the RoundEnvironment.
Doing so will result in silent failures because too few files will be recompiled later.
If your processor needs to make decisions based on a combination of otherwise unrelated elements, mark it as "aggregating" instead.</p>
</li>
<li>
<p>They must provide exactly one originating element for each file generated with the <code>Filer</code> API.
If zero or many originating elements are provided, Gradle will recompile all source files.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a source file is recompiled, Gradle will recompile all files generated from it.
When a source file is deleted, the files generated from it are deleted.</p>
</div>
<div class="sect5">
<h6 id="aggregating_annotation_processors"><a class="anchor" href="#aggregating_annotation_processors"></a><a class="link" href="#aggregating_annotation_processors">"Aggregating" annotation processors</a></h6>
<div class="paragraph">
<p>These can aggregate several source files into one ore more output files or validation messages.
For instance, a <code>ServiceRegistryProcessor</code> could create a single <code>ServiceRegistry</code> with one method for each type annotated with <code>@Service</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_an_aggregating_annotation_processor"><a class="anchor" href="#example_an_aggregating_annotation_processor"></a><a class="link" href="#example_an_aggregating_annotation_processor">Example: An aggregating annotation processor</a></h5>
<div class="listingblock">
<div class="title">processor/src/main/java/ServiceRegistryProcessor.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">JavaFileObject serviceRegistry = filer.createSourceFile(<span class="string"><span class="delimiter">&quot;</span><span class="content">ServiceRegistry</span><span class="delimiter">&quot;</span></span>);
<span class="predefined-type">Writer</span> writer = serviceRegistry.openWriter();
writer.write(<span class="string"><span class="delimiter">&quot;</span><span class="content">public class ServiceRegistry {</span><span class="delimiter">&quot;</span></span>);
<span class="keyword">for</span> (<span class="predefined-type">Element</span> service : roundEnv.getElementsAnnotatedWith(serviceAnnotation)) {
    addServiceCreationMethod(writer, (TypeElement) service);
}
writer.write(<span class="string"><span class="delimiter">&quot;</span><span class="content">}</span><span class="delimiter">&quot;</span></span>);
writer.close();</code></pre>
</div>
</div>
<div class="paragraph">
<p>"Aggregating" processors have the following limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They can only read <code>CLASS</code> or <code>RUNTIME</code> retention annotations</p>
</li>
<li>
<p>They can only read parameter names if the user passes the <code>-parameters</code> compiler argument.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gradle will always reprocess (but not recompile) all annotated files that the processor was registered for.
Gradle will always recompile any files the processor generates.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:java_compile_avoidance"><a class="anchor" href="#sec:java_compile_avoidance"></a><a class="link" href="#sec:java_compile_avoidance">Compile avoidance</a></h5>
<div class="paragraph">
<p>If a dependent project has changed in an <a href="https://en.wikipedia.org/wiki/Application_binary_interface">ABI</a>-compatible way (only its private API has changed), then Java compilation tasks will be up-to-date. This means that if project <code>A</code> depends on project <code>B</code> and a class in <code>B</code> is changed in an ABI-compatible way (typically, changing only the body of a method), then Gradle won&#8217;t recompile <code>A</code>.</p>
</div>
<div class="paragraph">
<p>Some of the types of changes that do not affect the public API and are ignored:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Changing a method body</p>
</li>
<li>
<p>Changing a comment</p>
</li>
<li>
<p>Adding, removing or changing private methods, fields, or inner classes</p>
</li>
<li>
<p>Adding, removing or changing a resource</p>
</li>
<li>
<p>Changing the name of jars or directories in the classpath</p>
</li>
<li>
<p>Renaming a parameter</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Compile-avoidance is deactivated if annotation processors are found on the compile classpath, because for annotation processors the implementation details matter. Annotation processors should be declared on the annotation processor path instead. Gradle 5.0 will ignore processors on the compile classpath.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_annotation_processors"><a class="anchor" href="#example_declaring_annotation_processors"></a><a class="link" href="#example_declaring_annotation_processors">Example: Declaring annotation processors</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    <span class="comment">// The dagger compiler and its transitive dependencies will only be found on annotation processing classpath</span>
    annotationProcessor <span class="string"><span class="delimiter">'</span><span class="content">com.google.dagger:dagger-compiler:2.8</span><span class="delimiter">'</span></span>

    <span class="comment">// And we still need the Dagger library on the compile classpath itself</span>
    implementation <span class="string"><span class="delimiter">'</span><span class="content">com.google.dagger:dagger:2.8</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_test"><a class="anchor" href="#sec:java_test"></a><a class="link" href="#sec:java_test">Test</a></h4>
<div class="paragraph">
<p>The <code>test</code> task is an instance of <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a>. It automatically detects and executes all unit tests in the <code>test</code> source set. It also generates a report once test execution is complete. JUnit and TestNG are both supported. Have a look at <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a> for the complete API.</p>
</div>
<div class="paragraph">
<p>See the <a href="#java_testing">Testing in Java &amp; JVM projects</a> chapter for more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:jar"><a class="anchor" href="#sec:jar"></a><a class="link" href="#sec:jar">Jar</a></h4>
<div class="paragraph">
<p>The <code>jar</code> task creates a JAR file containing the class files and resources of the project. The JAR file is declared as an artifact in the <code>archives</code> dependency configuration. This means that the JAR is available in the classpath of a dependent project. If you upload your project into a repository, this JAR is declared as part of the dependency descriptor. You can learn more about how to work with archives in <a href="#sec:archives">Archive creation in depth</a> and artifact configurations in <a href="#artifact_management">Legacy Publishing</a>.</p>
</div>
<div class="sect4">
<h5 id="sub:manifest"><a class="anchor" href="#sub:manifest"></a><a class="link" href="#sub:manifest">Manifest</a></h5>
<div class="paragraph">
<p>Each jar or war object has a <code>manifest</code> property with a separate instance of <a href="../javadoc/org/gradle/api/java/archives/Manifest.html">Manifest</a>. When the archive is generated, a corresponding <code>MANIFEST.MF</code> file is written into the archive.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_customization_of_manifest_mf_3"><a class="anchor" href="#example_customization_of_manifest_mf_3"></a><a class="link" href="#example_customization_of_manifest_mf_3">Example: Customization of MANIFEST.MF</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">jar {
    manifest {
        attributes(<span class="string"><span class="delimiter">&quot;</span><span class="content">Implementation-Title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Gradle</span><span class="delimiter">&quot;</span></span>,
                   <span class="string"><span class="delimiter">&quot;</span><span class="content">Implementation-Version</span><span class="delimiter">&quot;</span></span>: version)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can create stand-alone instances of a <code>Manifest</code>. You can use that for example, to share manifest information between jars.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_creating_a_manifest_object_2"><a class="anchor" href="#example_creating_a_manifest_object_2"></a><a class="link" href="#example_creating_a_manifest_object_2">Example: Creating a manifest object.</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ext.sharedManifest = manifest {
    attributes(<span class="string"><span class="delimiter">&quot;</span><span class="content">Implementation-Title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Gradle</span><span class="delimiter">&quot;</span></span>,
               <span class="string"><span class="delimiter">&quot;</span><span class="content">Implementation-Version</span><span class="delimiter">&quot;</span></span>: version)
}
task fooJar(<span class="key">type</span>: Jar) {
    manifest = project.manifest {
        from sharedManifest
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can merge other manifests into any <code>Manifest</code> object. The other manifests might be either described by a file path or, like in the example above, by a reference to another <code>Manifest</code> object.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_separate_manifest_mf_for_a_particular_archive_2"><a class="anchor" href="#example_separate_manifest_mf_for_a_particular_archive_2"></a><a class="link" href="#example_separate_manifest_mf_for_a_particular_archive_2">Example: Separate MANIFEST.MF for a particular archive</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task barJar(<span class="key">type</span>: Jar) {
    manifest {
        attributes <span class="key">key1</span>: <span class="string"><span class="delimiter">'</span><span class="content">value1</span><span class="delimiter">'</span></span>
        from sharedManifest, <span class="string"><span class="delimiter">'</span><span class="content">src/config/basemanifest.txt</span><span class="delimiter">'</span></span>
        from(<span class="string"><span class="delimiter">'</span><span class="content">src/config/javabasemanifest.txt</span><span class="delimiter">'</span></span>,
             <span class="string"><span class="delimiter">'</span><span class="content">src/config/libbasemanifest.txt</span><span class="delimiter">'</span></span>) {
            eachEntry { details -&gt;
                <span class="keyword">if</span> (details.baseValue != details.mergeValue) {
                    details.value = baseValue
                }
                <span class="keyword">if</span> (details.key == <span class="string"><span class="delimiter">'</span><span class="content">foo</span><span class="delimiter">'</span></span>) {
                    details.exclude()
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Manifests are merged in the order they are declared by the <code>from</code> statement. If the base manifest and the merged manifest both define values for the same key, the merged manifest wins by default. You can fully customize the merge behavior by adding <code>eachEntry</code> actions in which you have access to a <a href="../javadoc/org/gradle/api/java/archives/ManifestMergeDetails.html">ManifestMergeDetails</a> instance for each entry of the resulting manifest. The merge is not immediately triggered by the from statement. It is done lazily, either when generating the jar, or by calling <code>writeTo</code> or <code>effectiveManifest</code></p>
</div>
<div class="paragraph">
<p>You can easily write a manifest to disk.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_saving_a_manifest_mf_to_disk_2"><a class="anchor" href="#example_saving_a_manifest_mf_to_disk_2"></a><a class="link" href="#example_saving_a_manifest_mf_to_disk_2">Example: Saving a MANIFEST.MF to disk</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">jar.manifest.writeTo(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/mymanifest.mf</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="java_library_plugin"><a class="anchor" href="#java_library_plugin"></a><a class="link" href="#java_library_plugin">The Java Library Plugin</a></h3>
<div class="paragraph">
<p>The Java Library plugin expands the capabilities of the Java plugin by providing specific knowledge about Java libraries. In particular, a Java library exposes an API to consumers (i.e., other projects using the Java or the Java Library plugin). All the source sets, tasks and configurations exposed by the Java plugin are implicitly available when using this plugin.</p>
</div>
<div class="sect3">
<h4 id="sec:java_library_usage"><a class="anchor" href="#sec:java_library_usage"></a><a class="link" href="#sec:java_library_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Java Library plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_java_library_plugin"><a class="anchor" href="#example_using_the_java_library_plugin"></a><a class="link" href="#example_using_the_java_library_plugin">Example: Using the Java Library plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java-library</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_library_separation"><a class="anchor" href="#sec:java_library_separation"></a><a class="link" href="#sec:java_library_separation">API and implementation separation</a></h4>
<div class="paragraph">
<p>The key difference between the standard Java plugin and the Java Library plugin is that the latter introduces the concept of an <em>API</em> exposed to consumers. A library is a Java component meant to be consumed by other components. It&#8217;s a very common use case in multi-project builds, but also as soon as you have external dependencies.</p>
</div>
<div class="paragraph">
<p>The plugin exposes two <a href="#managing_dependency_configurations">configurations</a> that can be used to declare dependencies: <code>api</code> and <code>implementation</code>. The <code>api</code> configuration should be used to declare dependencies which are exported by the library API, whereas the <code>implementation</code> configuration should be used to declare dependencies which are internal to the component.</p>
</div>
<div class="sect4">
<h5 id="example_declaring_api_and_implementation_dependencies"><a class="anchor" href="#example_declaring_api_and_implementation_dependencies"></a><a class="link" href="#example_declaring_api_and_implementation_dependencies">Example: Declaring API and implementation dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    api <span class="string"><span class="delimiter">'</span><span class="content">commons-httpclient:commons-httpclient:3.1</span><span class="delimiter">'</span></span>
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.apache.commons:commons-lang3:3.5</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dependencies appearing in the <code>api</code> configurations will be transitively exposed to consumers of the library, and as such will appear on the compile classpath of consumers. Dependencies found in the <code>implementation</code> configuration will, on the other hand, not be exposed to consumers, and therefore not leak into the consumers' compile classpath. This comes with several benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dependencies do not leak into the compile classpath of consumers anymore, so you will never accidentally depend on a transitive dependency</p>
</li>
<li>
<p>faster compilation thanks to reduced classpath size</p>
</li>
<li>
<p>less recompilations when implementation dependencies change: consumers would not need to be recompiled</p>
</li>
<li>
<p>cleaner publishing: when used in conjunction with the new <code>maven-publish</code> plugin, Java libraries produce POM files that distinguish exactly between what is required to compile against the library and what is required to use the library at runtime (in other words, don&#8217;t mix what is needed to compile the library itself and what is needed to compile against the library).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>compile</code> configuration still exists but should not be used as it will not offer the guarantees that the <code>api</code> and <code>implementation</code> configurations provide.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If your build consumes a published module with POM metadata, the Java and Java Library plugins both honor api and implementation separation through the scopes used in the pom. Meaning that the compile classpath only includes <code>compile</code> scoped dependencies, while the runtime classpath adds the <code>runtime</code> scoped dependencies as well.</p>
</div>
<div class="paragraph">
<p>This often does not have an effect on modules published with Maven, where the POM that defines the project is directly published as metadata. There, the compile scope includes both dependencies that were required to compile the project (i.e. implementation dependencies) and dependencies required to compile against the published library (i.e. API dependencies). For most published libraries, this means that all dependencies belong to the compile scope. However, as mentioned above, if the library is published with Gradle, the produced POM file only puts <code>api</code> dependencies into the compile scope and the remaining <code>implementation</code> dependencies into the runtime scope.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Separating compile and runtime scope of modules is active by default in Gradle 5.0+. In Gradle 4.6+, you need to activate it by adding <code>enableFeaturePreview('IMPROVED_POM_SUPPORT')</code> in <em>settings.gradle</em>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_library_recognizing_dependencies"><a class="anchor" href="#sec:java_library_recognizing_dependencies"></a><a class="link" href="#sec:java_library_recognizing_dependencies">Recognizing API and implementation dependencies</a></h4>
<div class="paragraph">
<p>This section will help you identify API and Implementation dependencies in your code using simple rules of thumb. The first of these is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prefer the <code>implementation</code> configuration over <code>api</code> when possible</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This keeps the dependencies off of the consumer&#8217;s compilation classpath. In addition, the consumers will immediately fail to compile if any implementation types accidentally leak into the public API.</p>
</div>
<div class="paragraph">
<p>So when should you use the <code>api</code> configuration? An API dependency is one that contains at least one type that is exposed in the library binary interface, often referred to as its ABI (Application Binary Interface). This includes, but is not limited to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>types used in super classes or interfaces</p>
</li>
<li>
<p>types used in public method parameters, including generic parameter types (where <em>public</em> is something that is visible to compilers. I.e. , <em>public</em>, <em>protected</em> and <em>package private</em> members in the Java world)</p>
</li>
<li>
<p>types used in public fields</p>
</li>
<li>
<p>public annotation types</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By contrast, any type that is used in the following list is irrelevant to the ABI, and therefore should be declared as an <code>implementation</code> dependency:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>types exclusively used in method bodies</p>
</li>
<li>
<p>types exclusively used in private members</p>
</li>
<li>
<p>types exclusively found in internal classes (future versions of Gradle will let you declare which packages belong to the public API)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following class makes use of a couple of third-party libraries, one of which is exposed in the class&#8217;s public API and the other is only used internally. The import statements don&#8217;t help us determine which is which, so we have to look at the fields, constructors and methods instead:</p>
</div>
<div class="sect4">
<h5 id="example_making_the_difference_between_api_and_implementation"><a class="anchor" href="#example_making_the_difference_between_api_and_implementation"></a><a class="link" href="#example_making_the_difference_between_api_and_implementation">Example: Making the difference between API and implementation</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">src/main/java/org/gradle/HttpClientWrapper.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// The following types can appear anywhere in the code</span>
<span class="comment">// but say nothing about API or implementation usage</span>
<span class="keyword">import</span> <span class="include">org.apache.commons.httpclient.*</span>;
<span class="keyword">import</span> <span class="include">org.apache.commons.httpclient.methods.*</span>;
<span class="keyword">import</span> <span class="include">org.apache.commons.lang3.exception.ExceptionUtils</span>;
<span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="keyword">import</span> <span class="include">java.io.UnsupportedEncodingException</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">HttpClientWrapper</span> {

    <span class="directive">private</span> <span class="directive">final</span> HttpClient client; <span class="comment">// private member: implementation details</span>

    <span class="comment">// HttpClient is used as a parameter of a public method</span>
    <span class="comment">// so &quot;leaks&quot; into the public API of this component</span>
    <span class="directive">public</span> HttpClientWrapper(HttpClient client) {
        <span class="local-variable">this</span>.client = client;
    }

    <span class="comment">// public methods belongs to your API</span>
    <span class="directive">public</span> <span class="type">byte</span><span class="type">[]</span> doRawGet(<span class="predefined-type">String</span> url) {
        GetMethod method = <span class="keyword">new</span> GetMethod(url);
        <span class="keyword">try</span> {
            <span class="type">int</span> statusCode = doGet(method);
            <span class="keyword">return</span> method.getResponseBody();

        } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
            ExceptionUtils.rethrow(e); <span class="comment">// this dependency is internal only</span>
        } <span class="keyword">finally</span> {
            method.releaseConnection();
        }
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }

    <span class="comment">// GetMethod is used in a private method, so doesn't belong to the API</span>
    <span class="directive">private</span> <span class="type">int</span> doGet(GetMethod method) <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="type">int</span> statusCode = client.executeMethod(method);
        <span class="keyword">if</span> (statusCode != HttpStatus.SC_OK) {
            <span class="predefined-type">System</span>.err.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Method failed: </span><span class="delimiter">&quot;</span></span> + method.getStatusLine());
        }
        <span class="keyword">return</span> statusCode;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>public</em> constructor of <code>HttpClientWrapper</code> uses <code>HttpClient</code> as a parameter, so it is exposed to consumers and therefore belongs to the API. Note that <code>GetMethod</code> is used in the signature of a <em>private</em> method, and so it doesn&#8217;t count towards making HttpClient an API dependency.</p>
</div>
<div class="paragraph">
<p>On the other hand, the <code>ExceptionUtils</code> type, coming from the <code>commons-lang</code> library, is only used in a method body (not in its signature), so it&#8217;s an implementation dependency.</p>
</div>
<div class="paragraph">
<p>Therefore, we can deduce that <code>commons-httpclient</code> is an API dependency, whereas <code>commons-lang</code> is an implementation dependency. This conclusion translates into the following declaration in the build script:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_api_and_implementation_dependencies_2"><a class="anchor" href="#example_declaring_api_and_implementation_dependencies_2"></a><a class="link" href="#example_declaring_api_and_implementation_dependencies_2">Example: Declaring API and implementation dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    api <span class="string"><span class="delimiter">'</span><span class="content">commons-httpclient:commons-httpclient:3.1</span><span class="delimiter">'</span></span>
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.apache.commons:commons-lang3:3.5</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_library_configurations_graph"><a class="anchor" href="#sec:java_library_configurations_graph"></a><a class="link" href="#sec:java_library_configurations_graph">The Java Library plugin configurations</a></h4>
<div class="paragraph">
<p>The following graph describes the main configurations setup when the Java Library plugin is in use.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/java-library-ignore-deprecated-main.png" alt="java library ignore deprecated main">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The configurations in <em>green</em> are the ones a user should use to declare dependencies</p>
</li>
<li>
<p>The configurations in <em>pink</em> are the ones used when a component compiles, or runs against the library</p>
</li>
<li>
<p>The configurations in <em>blue</em> are internal to the component, for its own use</p>
</li>
<li>
<p>The configurations in <em>white</em> are configurations inherited from the Java plugin</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And the next graph describes the test configurations setup:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/java-library-ignore-deprecated-test.png" alt="java library ignore deprecated test">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <em>compile</em>, <em>testCompile</em>, <em>runtime</em> and <em>testRuntime</em> configurations inherited from the Java plugin are still available but are deprecated. You should avoid using them, as they are only kept for backwards compatibility.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The role of each configuration is described in the following tables:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 17. Java Library plugin - configurations used to declare dependencies</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration name</th>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Consumable?</th>
<th class="tableblock halign-left valign-top">Resolvable?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring API dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you should declare dependencies which are transitively exported to consumers, for compile.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>implementation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring implementation dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you should declare dependencies which are purely internal and not meant to be exposed to consumers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compileOnly</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring compile only dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you should declare dependencies which are only required at compile time, but should not leak into the runtime. This typically includes dependencies which are shaded when found at runtime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>runtimeOnly</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring runtime dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you should declare dependencies which are only required at runtime, and not at compile time.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>testImplementation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you should declare dependencies which are used to compile tests.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>testCompileOnly</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring test compile only dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you should declare dependencies which are only required at test compile time, but should not leak into the runtime. This typically includes dependencies which are shaded when found at runtime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>testRuntimeOnly</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring test runtime dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is where you should declare dependencies which are only required at test runtime, and not at test compile time.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 18. Java Library plugin  configurations used by consumers</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration name</th>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Consumable?</th>
<th class="tableblock halign-left valign-top">Resolvable?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>apiElements</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For compiling against this library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration is meant to be used by consumers, to retrieve all the elements necessary to compile against this library. Unlike the <code>default</code> configuration, this doesn&#8217;t leak implementation or runtime dependencies.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>runtimeElements</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For executing this library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration is meant to be used by consumers, to retrieve all the elements necessary to run against this library.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 19. Java Library plugin - configurations used by the library itself</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration name</th>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Consumable?</th>
<th class="tableblock halign-left valign-top">Resolvable?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compileClasspath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For compiling this library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration contains the compile classpath of this library, and is therefore used when invoking the java compiler to compile it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">runtimeClasspath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For executing this library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration contains the runtime classpath of this library</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">testCompileClasspath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For compiling the tests of this library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration contains the test compile classpath of this library.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">testRuntimeClasspath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For executing tests of this library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration contains the test runtime classpath of this library</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:java_library_known_issues"><a class="anchor" href="#sec:java_library_known_issues"></a><a class="link" href="#sec:java_library_known_issues">Known issues</a></h4>
<div class="sect4">
<h5 id="sec:java_library_known_issues_compat"><a class="anchor" href="#sec:java_library_known_issues_compat"></a><a class="link" href="#sec:java_library_known_issues_compat">Compatibility with other plugins</a></h5>
<div class="paragraph">
<p>At the moment the Java Library plugin is only wired to behave correctly with the <code>java</code> plugin. Other plugins, such as the Groovy plugin, may not behave correctly. In particular, if the Groovy plugin is used in addition to the <code>java-library</code> plugin, then consumers may not get the Groovy classes when they consume the library. To workaround this, you need to explicitly wire the Groovy compile dependency, like this:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_the_groovy_plugin_to_work_with_java_library"><a class="anchor" href="#example_configuring_the_groovy_plugin_to_work_with_java_library"></a><a class="link" href="#example_configuring_the_groovy_plugin_to_work_with_java_library">Example: Configuring the Groovy plugin to work with Java Library</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">a/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    apiElements {
        outgoing.variants.getByName(<span class="string"><span class="delimiter">'</span><span class="content">classes</span><span class="delimiter">'</span></span>).artifact(
            <span class="key">file</span>: compileGroovy.destinationDir,
            <span class="key">type</span>: ArtifactTypeDefinition.JVM_CLASS_DIRECTORY,
            <span class="key">builtBy</span>: compileGroovy)
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:java_library_known_issues_memory"><a class="anchor" href="#sec:java_library_known_issues_memory"></a><a class="link" href="#sec:java_library_known_issues_memory">Increased memory usage for consumers</a></h5>
<div class="paragraph">
<p>When a project uses the Java Library plugin, consumers will use the output classes directory of this project directly on their compile classpath, instead of the jar file if the project uses the Java plugin. An indirect consequence is that up-to-date checking will require more memory, because Gradle will snapshot individual class files instead of a single jar. This may lead to increased memory consumption for large projects.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="java_library_distribution_plugin"><a class="anchor" href="#java_library_distribution_plugin"></a><a class="link" href="#java_library_distribution_plugin">The Java Library Distribution Plugin</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The Java library distribution plugin is currently <a href="#feature_lifecycle">incubating</a>. Please be aware that the DSL and other configuration may change in later Gradle versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Java library distribution plugin adds support for building a distribution ZIP for a Java library. The distribution contains the JAR file for the library and its dependencies.</p>
</div>
<div class="sect3">
<h4 id="sec:java_library_distribution_usage"><a class="anchor" href="#sec:java_library_distribution_usage"></a><a class="link" href="#sec:java_library_distribution_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Java library distribution plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_java_library_distribution_plugin"><a class="anchor" href="#example_using_the_java_library_distribution_plugin"></a><a class="link" href="#example_using_the_java_library_distribution_plugin">Example: Using the Java library distribution plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java-library-distribution</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To define the name for the distribution you have to set the <code>baseName</code> property as shown below:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configure_the_distribution_name"><a class="anchor" href="#example_configure_the_distribution_name"></a><a class="link" href="#example_configure_the_distribution_name">Example: Configure the distribution name</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">distributions {
    main{
        baseName = <span class="string"><span class="delimiter">'</span><span class="content">my-name</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The plugin builds a distribution for your library. The distribution will package up the runtime dependencies of the library. All files stored in <code>src/main/dist</code> will be added to the root of the archive distribution. You can run <code>gradle distZip</code> to create a ZIP file containing the distribution.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:java_library_distribution_tasks"><a class="anchor" href="#sec:java_library_distribution_tasks"></a><a class="link" href="#sec:java_library_distribution_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Java library distribution plugin adds the following tasks to the project.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>distZip</code>  <a href="../dsl/org.gradle.api.tasks.bundling.Zip.html">Zip</a></dt>
<dd>
<p><em>Depends on</em>: <code>jar</code></p>
<div class="paragraph">
<p>Creates a full distribution ZIP archive including runtime libraries.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="java_library_distribution_resources"><a class="anchor" href="#java_library_distribution_resources"></a><a class="link" href="#java_library_distribution_resources">Including other resources in the distribution</a></h4>
<div class="paragraph">
<p>All of the files from the <code>src/dist</code> directory are copied. To include any static files in the distribution, simply arrange them in the <code>src/dist</code> directory, or add them to the content of the distribution.</p>
</div>
<div class="sect4">
<h5 id="example_include_files_in_the_distribution"><a class="anchor" href="#example_include_files_in_the_distribution"></a><a class="link" href="#example_include_files_in_the_distribution">Example: Include files in the distribution</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">distributions {
    main {
        baseName = <span class="string"><span class="delimiter">'</span><span class="content">my-name</span><span class="delimiter">'</span></span>
        contents {
            from { <span class="string"><span class="delimiter">'</span><span class="content">src/dist</span><span class="delimiter">'</span></span> }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dependency_management_for_java_projects"><a class="anchor" href="#dependency_management_for_java_projects"></a><a class="link" href="#dependency_management_for_java_projects">Dependency Management for Java Projects</a></h3>
<div class="paragraph">
<p>This chapter explains how to apply basic dependency management concepts to Java-based projects. For a detailed introduction to dependency management, see <a href="#introduction_dependency_management">Introduction to Dependency Management</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:setting_up_a_standard_build_script_java_tutorial"><a class="anchor" href="#sec:setting_up_a_standard_build_script_java_tutorial"></a><a class="link" href="#sec:setting_up_a_standard_build_script_java_tutorial">Dissecting a typical build script</a></h4>
<div class="paragraph">
<p>Let&#8217;s have a look at a very simple build script for a Java-based project. It applies the <a href="#java_library_plugin">Java Library plugin</a> which automatically introduces a standard project layout, provides tasks for performing typical work and adequate support for dependency management.</p>
</div>
<div class="sect4">
<h5 id="example_dependency_declarations_for_a_java_based_project"><a class="anchor" href="#example_dependency_declarations_for_a_java_based_project"></a><a class="link" href="#example_dependency_declarations_for_a_java_based_project">Example: Dependency declarations for a Java-based project</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java-library</span><span class="delimiter">'</span></span>

repositories {
    mavenCentral()
}

dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.hibernate:hibernate-core:3.6.7.Final</span><span class="delimiter">'</span></span>
    api <span class="string"><span class="delimiter">'</span><span class="content">com.google.guava:guava:23.0</span><span class="delimiter">'</span></span>
    testImplementation <span class="string"><span class="delimiter">'</span><span class="content">junit:junit:4.+</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:dependencies(groovy.lang.Closure)">Project.dependencies{}</a> code block declares that Hibernate core 3.6.7.Final is required to compile the project&#8217;s production source code. It also states that junit &gt;= 4.0 is required to compile the project&#8217;s tests. All dependencies are supposed to be looked up in the Maven Central repository as defined by <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:repositories(groovy.lang.Closure)">Project.repositories{}</a>. The following sections explain each aspect in more detail.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:module_dependencies_java_tutorial"><a class="anchor" href="#sec:module_dependencies_java_tutorial"></a><a class="link" href="#sec:module_dependencies_java_tutorial">Declaring module dependencies</a></h4>
<div class="paragraph">
<p>There are various <a href="#dependency_types">types of dependencies</a> that you can declare. One such type is a <em>module dependency</em>. A <a href="#sec:declaring_dependency_to_module">module dependency</a> represents a dependency on a module with a specific version built outside the current build. Modules are usually stored in a repository, such as Maven Central, a corporate Maven or Ivy repository, or a directory in the local file system.</p>
</div>
<div class="paragraph">
<p>To define an module dependency, you add it to a <a href="#sec:configurations_java_tutorial">dependency configuration</a>:</p>
</div>
<div class="sect4">
<h5 id="example_definition_of_a_module_dependency"><a class="anchor" href="#example_definition_of_a_module_dependency"></a><a class="link" href="#example_definition_of_a_module_dependency">Example: Definition of a module dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    implementation <span class="string"><span class="delimiter">'</span><span class="content">org.hibernate:hibernate-core:3.6.7.Final</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To find out more about defining dependencies, have a look at <a href="#declaring_dependencies">Declaring Dependencies</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configurations_java_tutorial"><a class="anchor" href="#sec:configurations_java_tutorial"></a><a class="link" href="#sec:configurations_java_tutorial">Using dependency configurations</a></h4>
<div class="paragraph">
<p>A <a href="../dsl/org.gradle.api.artifacts.Configuration.html">Configuration</a> is a named set of dependencies and artifacts. There are three main purposes for a <em>configuration</em>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Declaring dependencies</dt>
<dd>
<p>A plugin uses configurations to make it easy for build authors to declare what other subprojects or external artifacts are needed for various purposes during the execution of tasks defined by the plugin. For example a plugin may need the Spring web framework dependency to compile the source code.</p>
</dd>
<dt class="hdlist1">Resolving dependencies</dt>
<dd>
<p>A plugin uses configurations to find (and possibly download) inputs to the tasks it defines. For example Gradle needs to download Spring web framework JAR files from Maven Central.</p>
</dd>
<dt class="hdlist1">Exposing artifacts for consumption</dt>
<dd>
<p>A plugin uses configurations to define what <em>artifacts</em> it generates for other projects to consume. For example the project would like to publish its compiled source code packaged in the JAR file to an in-house Artifactory repository.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>With those three purposes in mind, let&#8217;s take a look at a few of the <a href="#sec:java_library_configurations_graph">standard configurations defined by the Java Library Plugin</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">implementation</dt>
<dd>
<p>The dependencies required to compile the production source of the project which <em>are not</em> part of the API exposed by the project. For example the project uses Hibernate for its internal persistence layer implementation.</p>
</dd>
<dt class="hdlist1">api</dt>
<dd>
<p>The dependencies required to compile the production source of the project which <em>are</em> part of the API exposed by the project. For example the project uses Guava and exposes public interfaces with Guava classes in their method signatures.</p>
</dd>
<dt class="hdlist1">testImplementation</dt>
<dd>
<p>The dependencies required to compile and run the test source of the project. For example the project decided to write test code with the test framework JUnit.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Various plugins add further standard configurations. You can also define your own custom configurations in your build via <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:configurations(groovy.lang.Closure)">Project.configurations{}</a>. See <a href="#managing_dependency_configurations">Managing Dependency Configurations</a> for the details of defining and customizing dependency configurations.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:repositories_java_tutorial"><a class="anchor" href="#sec:repositories_java_tutorial"></a><a class="link" href="#sec:repositories_java_tutorial">Declaring common Java repositories</a></h4>
<div class="paragraph">
<p>How does Gradle know where to find the files for external dependencies? Gradle looks for them in a <em>repository</em>. A repository is a collection of modules, organized by <code>group</code>, <code>name</code> and <code>version</code>. Gradle understands different <a href="#repository_types">repository types</a>, such as Maven and Ivy, and supports various ways of accessing the repository via HTTP or other protocols.</p>
</div>
<div class="paragraph">
<p>By default, Gradle does not define any repositories. You need to define at least one with the help of <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:repositories(groovy.lang.Closure)">Project.repositories{}</a> before you can use module dependencies. One option is use the Maven Central repository:</p>
</div>
<div class="sect4">
<h5 id="example_usage_of_maven_central_repository"><a class="anchor" href="#example_usage_of_maven_central_repository"></a><a class="link" href="#example_usage_of_maven_central_repository">Example: Usage of Maven central repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    mavenCentral()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also have repositories on the local file system. This works for both Maven and Ivy repositories.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_usage_of_a_local_ivy_directory"><a class="anchor" href="#example_usage_of_a_local_ivy_directory"></a><a class="link" href="#example_usage_of_a_local_ivy_directory">Example: Usage of a local Ivy directory</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    ivy {
        <span class="comment">// URL can refer to a local directory</span>
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">../local-repo</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A project can have multiple repositories. Gradle will look for a dependency in each repository in the order they are specified, stopping at the first repository that contains the requested module.</p>
</div>
<div class="paragraph">
<p>To find out more about defining repositories, have a look at <a href="#declaring_repositories">Declaring Repositories</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:publishing_artifacts_java_tutorial"><a class="anchor" href="#sec:publishing_artifacts_java_tutorial"></a><a class="link" href="#sec:publishing_artifacts_java_tutorial">Publishing artifacts</a></h4>
<div class="paragraph">
<p>Dependency configurations are also used to publish files. Gradle calls these files <em>publication artifacts</em>, or usually just <em>artifacts</em>. As a user you will need to tell Gradle where to publish the artifacts. You do this by declaring repositories for the <code>uploadArchives</code> task. Here&#8217;s an example of publishing to a Maven repository:</p>
</div>
<div class="sect4">
<h5 id="example_publishing_to_a_maven_repository"><a class="anchor" href="#example_publishing_to_a_maven_repository"></a><a class="link" href="#example_publishing_to_a_maven_repository">Example: Publishing to a Maven repository</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">maven</span><span class="delimiter">'</span></span>

uploadArchives {
    repositories {
        mavenDeployer {
            repository(<span class="key">url</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://localhost/tmp/myRepo/</span><span class="delimiter">&quot;</span></span>)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, when you run <code>gradle uploadArchives</code>, Gradle will build the JAR file, generate a <code>.pom</code> file and upload the artifacts.</p>
</div>
<div class="paragraph">
<p>To learn more about publishing artifacts, have a look at <a href="#artifact_management">Legacy Publishing</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ant"><a class="anchor" href="#ant"></a><a class="link" href="#ant">Using Ant from Gradle</a></h3>
<div class="paragraph">
<p>Gradle provides excellent integration with Ant. You can use individual Ant tasks or entire Ant builds in your Gradle builds. In fact, you will find that it&#8217;s far easier and more powerful using Ant tasks in a Gradle build script, than it is to use Ant&#8217;s XML format. You could even use Gradle simply as a powerful Ant task scripting tool.</p>
</div>
<div class="paragraph">
<p>Ant can be divided into two layers. The first layer is the Ant language. It provides the syntax for the <code>build.xml</code> file, the handling of the targets, special constructs like macrodefs, and so on. In other words, everything except the Ant tasks and types. Gradle understands this language, and allows you to import your Ant <code>build.xml</code> directly into a Gradle project. You can then use the targets of your Ant build as if they were Gradle tasks.</p>
</div>
<div class="paragraph">
<p>The second layer of Ant is its wealth of Ant tasks and types, like <code>javac</code>, <code>copy</code> or <code>jar</code>. For this layer Gradle provides integration simply by relying on Groovy, and the fantastic <code>AntBuilder</code>.</p>
</div>
<div class="paragraph">
<p>Finally, since build scripts are Groovy scripts, you can always execute an Ant build as an external process. Your build script may contain statements like: <code>"ant clean compile".execute()</code>.<sup class="footnote">[<a id="_footnoteref_15" class="footnote" href="#_footnotedef_15" title="View footnote.">15</a>]</sup></p>
</div>
<div class="paragraph">
<p>You can use Gradle&#8217;s Ant integration as a path for migrating your build from Ant to Gradle. For example, you could start by importing your existing Ant build. Then you could move your dependency declarations from the Ant script to your build file. Finally, you could move your tasks across to your build file, or replace them with some of Gradle&#8217;s plugins. This process can be done in parts over time, and you can have a working Gradle build during the entire process.</p>
</div>
<div class="sect3">
<h4 id="sec:using_ant_tasks"><a class="anchor" href="#sec:using_ant_tasks"></a><a class="link" href="#sec:using_ant_tasks">Using Ant tasks and types in your build</a></h4>
<div class="paragraph">
<p>In your build script, a property called <code>ant</code> is provided by Gradle. This is a reference to an <a href="../javadoc/org/gradle/api/AntBuilder.html">AntBuilder</a> instance. This <code>AntBuilder</code> is used to access Ant tasks, types and properties from your build script. There is a very simple mapping from Ant&#8217;s <code>build.xml</code> format to Groovy, which is explained below.</p>
</div>
<div class="paragraph">
<p>You execute an Ant task by calling a method on the <code>AntBuilder</code> instance. You use the task name as the method name. For example, you execute the Ant <code>echo</code> task by calling the <code>ant.echo()</code> method. The attributes of the Ant task are passed as Map parameters to the method. Below is an example of the <code>echo</code> task. Notice that we can also mix Groovy code and the Ant task markup. This can be extremely powerful.</p>
</div>
<div class="sect4">
<h5 id="example_using_an_ant_task"><a class="anchor" href="#example_using_an_ant_task"></a><a class="link" href="#example_using_an_ant_task">Example: Using an Ant task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task hello {
    doLast {
        <span class="predefined-type">String</span> greeting = <span class="string"><span class="delimiter">'</span><span class="content">hello from Ant</span><span class="delimiter">'</span></span>
        ant.echo(<span class="key">message</span>: greeting)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle hello</code></div>
<div class="content">
<pre>&gt; gradle hello

&gt; Task :hello
[ant:echo] hello from Ant

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You pass nested text to an Ant task by passing it as a parameter of the task method call. In this example, we pass the message for the <code>echo</code> task as nested text:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_passing_nested_text_to_an_ant_task"><a class="anchor" href="#example_passing_nested_text_to_an_ant_task"></a><a class="link" href="#example_passing_nested_text_to_an_ant_task">Example: Passing nested text to an Ant task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task hello {
    doLast {
        ant.echo(<span class="string"><span class="delimiter">'</span><span class="content">hello from Ant</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle hello</code></div>
<div class="content">
<pre>&gt; gradle hello

&gt; Task :hello
[ant:echo] hello from Ant

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You pass nested elements to an Ant task inside a closure. Nested elements are defined in the same way as tasks, by calling a method with the same name as the element we want to define.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_passing_nested_elements_to_an_ant_task"><a class="anchor" href="#example_passing_nested_elements_to_an_ant_task"></a><a class="link" href="#example_passing_nested_elements_to_an_ant_task">Example: Passing nested elements to an Ant task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task zip {
    doLast {
        ant.zip(<span class="key">destfile</span>: <span class="string"><span class="delimiter">'</span><span class="content">archive.zip</span><span class="delimiter">'</span></span>) {
            fileset(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>) {
                include(<span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">**.xml</span><span class="delimiter">'</span></span>)
                exclude(<span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">**.java</span><span class="delimiter">'</span></span>)
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can access Ant types in the same way that you access tasks, using the name of the type as the method name. The method call returns the Ant data type, which you can then use directly in your build script. In the following example, we create an Ant <code>path</code> object, then iterate over the contents of it.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_an_ant_type"><a class="anchor" href="#example_using_an_ant_type"></a><a class="link" href="#example_using_an_ant_type">Example: Using an Ant type</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task list {
    doLast {
        <span class="keyword">def</span> path = ant.path {
            fileset(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">libs</span><span class="delimiter">'</span></span>, <span class="key">includes</span>: <span class="string"><span class="delimiter">'</span><span class="content">*.jar</span><span class="delimiter">'</span></span>)
        }
        path.list().each {
            println <span class="local-variable">it</span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>More information about <code>AntBuilder</code> can be found in 'Groovy in Action' 8.4 or at the <a href="http://groovy-lang.org/scripting-ant.html">Groovy Wiki</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_custom_ant_tasks"><a class="anchor" href="#sec:using_custom_ant_tasks"></a><a class="link" href="#sec:using_custom_ant_tasks">Using custom Ant tasks in your build</a></h5>
<div class="paragraph">
<p>To make custom tasks available in your build, you can use the <code>taskdef</code> (usually easier) or <code>typedef</code> Ant task, just as you would in a <code>build.xml</code> file. You can then refer to the custom Ant task as you would a built-in Ant task.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_a_custom_ant_task"><a class="anchor" href="#example_using_a_custom_ant_task"></a><a class="link" href="#example_using_a_custom_ant_task">Example: Using a custom Ant task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task check {
    doLast {
        ant.taskdef(<span class="key">resource</span>: <span class="string"><span class="delimiter">'</span><span class="content">checkstyletask.properties</span><span class="delimiter">'</span></span>) {
            classpath {
                fileset(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">libs</span><span class="delimiter">'</span></span>, <span class="key">includes</span>: <span class="string"><span class="delimiter">'</span><span class="content">*.jar</span><span class="delimiter">'</span></span>)
            }
        }
        ant.checkstyle(<span class="key">config</span>: <span class="string"><span class="delimiter">'</span><span class="content">checkstyle.xml</span><span class="delimiter">'</span></span>) {
            fileset(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use Gradle&#8217;s dependency management to assemble the classpath to use for the custom tasks. To do this, you need to define a custom configuration for the classpath, then add some dependencies to the configuration. This is described in more detail in <a href="declaring_dependencies.html">Declaring Dependencies</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_the_classpath_for_a_custom_ant_task"><a class="anchor" href="#example_declaring_the_classpath_for_a_custom_ant_task"></a><a class="link" href="#example_declaring_the_classpath_for_a_custom_ant_task">Example: Declaring the classpath for a custom Ant task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    pmd
}

dependencies {
    pmd <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">pmd</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">pmd</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">4.2.5</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use the classpath configuration, use the <code>asPath</code> property of the custom configuration.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_a_custom_ant_task_and_dependency_management_together"><a class="anchor" href="#example_using_a_custom_ant_task_and_dependency_management_together"></a><a class="link" href="#example_using_a_custom_ant_task_and_dependency_management_together">Example: Using a custom Ant task and dependency management together</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task check {
    doLast {
        ant.taskdef(<span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">pmd</span><span class="delimiter">'</span></span>,
                    <span class="key">classname</span>: <span class="string"><span class="delimiter">'</span><span class="content">net.sourceforge.pmd.ant.PMDTask</span><span class="delimiter">'</span></span>,
                    <span class="key">classpath</span>: configurations.pmd.asPath)
        ant.pmd(<span class="key">shortFilenames</span>: <span class="string"><span class="delimiter">'</span><span class="content">true</span><span class="delimiter">'</span></span>,
                <span class="key">failonruleviolation</span>: <span class="string"><span class="delimiter">'</span><span class="content">true</span><span class="delimiter">'</span></span>,
                <span class="key">rulesetfiles</span>: file(<span class="string"><span class="delimiter">'</span><span class="content">pmd-rules.xml</span><span class="delimiter">'</span></span>).toURI().toString()) {
            formatter(<span class="key">type</span>: <span class="string"><span class="delimiter">'</span><span class="content">text</span><span class="delimiter">'</span></span>, <span class="key">toConsole</span>: <span class="string"><span class="delimiter">'</span><span class="content">true</span><span class="delimiter">'</span></span>)
            fileset(<span class="key">dir</span>: <span class="string"><span class="delimiter">'</span><span class="content">src</span><span class="delimiter">'</span></span>)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:import_ant_build"><a class="anchor" href="#sec:import_ant_build"></a><a class="link" href="#sec:import_ant_build">Importing an Ant build</a></h4>
<div class="paragraph">
<p>You can use the <code>ant.importBuild()</code> method to import an Ant build into your Gradle project. When you import an Ant build, each Ant target is treated as a Gradle task. This means you can manipulate and execute the Ant targets in exactly the same way as Gradle tasks.</p>
</div>
<div class="sect4">
<h5 id="example_importing_an_ant_build"><a class="anchor" href="#example_importing_an_ant_build"></a><a class="link" href="#example_importing_an_ant_build">Example: Importing an Ant build</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ant.importBuild <span class="string"><span class="delimiter">'</span><span class="content">build.xml</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;project&gt;</span>
    <span class="tag">&lt;target</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;echo&gt;</span>Hello, from Ant<span class="tag">&lt;/echo&gt;</span>
    <span class="tag">&lt;/target&gt;</span>
<span class="tag">&lt;/project&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle hello</code></div>
<div class="content">
<pre>&gt; gradle hello

&gt; Task :hello
[ant:echo] Hello, from Ant

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You can add a task which depends on an Ant target:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_task_that_depends_on_ant_target"><a class="anchor" href="#example_task_that_depends_on_ant_target"></a><a class="link" href="#example_task_that_depends_on_ant_target">Example: Task that depends on Ant target</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ant.importBuild <span class="string"><span class="delimiter">'</span><span class="content">build.xml</span><span class="delimiter">'</span></span>

task intro(<span class="key">dependsOn</span>: hello) {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">Hello, from Gradle</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle intro</code></div>
<div class="content">
<pre>&gt; gradle intro

&gt; Task :hello
[ant:echo] Hello, from Ant

&gt; Task :intro
Hello, from Gradle

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Or, you can add behaviour to an Ant target:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_behaviour_to_an_ant_target"><a class="anchor" href="#example_adding_behaviour_to_an_ant_target"></a><a class="link" href="#example_adding_behaviour_to_an_ant_target">Example: Adding behaviour to an Ant target</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ant.importBuild <span class="string"><span class="delimiter">'</span><span class="content">build.xml</span><span class="delimiter">'</span></span>

hello {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">Hello, from Gradle</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle hello</code></div>
<div class="content">
<pre>&gt; gradle hello

&gt; Task :hello
[ant:echo] Hello, from Ant
Hello, from Gradle

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible for an Ant target to depend on a Gradle task:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_ant_target_that_depends_on_gradle_task"><a class="anchor" href="#example_ant_target_that_depends_on_gradle_task"></a><a class="link" href="#example_ant_target_that_depends_on_gradle_task">Example: Ant target that depends on Gradle task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ant.importBuild <span class="string"><span class="delimiter">'</span><span class="content">build.xml</span><span class="delimiter">'</span></span>

task intro {
    doLast {
        println <span class="string"><span class="delimiter">'</span><span class="content">Hello, from Gradle</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;project&gt;</span>
    <span class="tag">&lt;target</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">depends</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">intro</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;echo&gt;</span>Hello, from Ant<span class="tag">&lt;/echo&gt;</span>
    <span class="tag">&lt;/target&gt;</span>
<span class="tag">&lt;/project&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle hello</code></div>
<div class="content">
<pre>&gt; gradle hello

&gt; Task :intro
Hello, from Gradle

&gt; Task :hello
[ant:echo] Hello, from Ant

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Sometimes it may be necessary to rename the task generated for an Ant target to avoid a naming collision with existing Gradle tasks. To do this, use the <a href="../javadoc/org/gradle/api/AntBuilder.html#importBuild-java.lang.Object-org.gradle.api.Transformer-">AntBuilder.importBuild(java.lang.Object, org.gradle.api.Transformer)</a> method.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_renaming_imported_ant_targets"><a class="anchor" href="#example_renaming_imported_ant_targets"></a><a class="link" href="#example_renaming_imported_ant_targets">Example: Renaming imported Ant targets</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ant.importBuild(<span class="string"><span class="delimiter">'</span><span class="content">build.xml</span><span class="delimiter">'</span></span>) { antTargetName -&gt;
    <span class="string"><span class="delimiter">'</span><span class="content">a-</span><span class="delimiter">'</span></span> + antTargetName
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;project&gt;</span>
    <span class="tag">&lt;target</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;echo&gt;</span>Hello, from Ant<span class="tag">&lt;/echo&gt;</span>
    <span class="tag">&lt;/target&gt;</span>
<span class="tag">&lt;/project&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle a-hello</code></div>
<div class="content">
<pre>&gt; gradle a-hello

&gt; Task :a-hello
[ant:echo] Hello, from Ant

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>Note that while the second argument to this method should be a <a href="../javadoc/org/gradle/api/Transformer.html">Transformer</a>, when programming in Groovy we can simply use a closure instead of an anonymous inner class (or similar) due to <a href="http://mrhaki.blogspot.ie/2013/11/groovy-goodness-implicit-closure.html">Groovy&#8217;s support for automatically coercing closures to single-abstract-method types</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:ant_properties"><a class="anchor" href="#sec:ant_properties"></a><a class="link" href="#sec:ant_properties">Ant properties and references</a></h4>
<div class="paragraph">
<p>There are several ways to set an Ant property, so that the property can be used by Ant tasks. You can set the property directly on the <code>AntBuilder</code> instance. The Ant properties are also available as a Map which you can change. You can also use the Ant <code>property</code> task. Below are some examples of how to do this.</p>
</div>
<div class="sect4">
<h5 id="example_setting_an_ant_property"><a class="anchor" href="#example_setting_an_ant_property"></a><a class="link" href="#example_setting_an_ant_property">Example: Setting an Ant property</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ant.buildDir = buildDir
ant.properties.buildDir = buildDir
ant.properties[<span class="string"><span class="delimiter">'</span><span class="content">buildDir</span><span class="delimiter">'</span></span>] = buildDir
ant.property(<span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">buildDir</span><span class="delimiter">'</span></span>, <span class="key">location</span>: buildDir)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;echo&gt;</span>buildDir = ${buildDir}<span class="tag">&lt;/echo&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Many Ant tasks set properties when they execute. There are several ways to get the value of these properties. You can get the property directly from the <code>AntBuilder</code> instance. The Ant properties are also available as a Map. Below are some examples.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_getting_an_ant_property"><a class="anchor" href="#example_getting_an_ant_property"></a><a class="link" href="#example_getting_an_ant_property">Example: Getting an Ant property</a></h5>
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">antProp</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">a property defined in an Ant build</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println ant.antProp
println ant.properties.antProp
println ant.properties[<span class="string"><span class="delimiter">'</span><span class="content">antProp</span><span class="delimiter">'</span></span>]</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are several ways to set an Ant reference:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_setting_an_ant_reference"><a class="anchor" href="#example_setting_an_ant_reference"></a><a class="link" href="#example_setting_an_ant_reference">Example: Setting an Ant reference</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ant.path(<span class="key">id</span>: <span class="string"><span class="delimiter">'</span><span class="content">classpath</span><span class="delimiter">'</span></span>, <span class="key">location</span>: <span class="string"><span class="delimiter">'</span><span class="content">libs</span><span class="delimiter">'</span></span>)
ant.references.classpath = ant.path(<span class="key">location</span>: <span class="string"><span class="delimiter">'</span><span class="content">libs</span><span class="delimiter">'</span></span>)
ant.references[<span class="string"><span class="delimiter">'</span><span class="content">classpath</span><span class="delimiter">'</span></span>] = ant.path(<span class="key">location</span>: <span class="string"><span class="delimiter">'</span><span class="content">libs</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;path</span> <span class="attribute-name">refid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">classpath</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are several ways to get an Ant reference:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_getting_an_ant_reference"><a class="anchor" href="#example_getting_an_ant_reference"></a><a class="link" href="#example_getting_an_ant_reference">Example: Getting an Ant reference</a></h5>
<div class="listingblock">
<div class="title">build.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;path</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">antPath</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">location</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">libs</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println ant.references.antPath
println ant.references[<span class="string"><span class="delimiter">'</span><span class="content">antPath</span><span class="delimiter">'</span></span>]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:ant_logging"><a class="anchor" href="#sec:ant_logging"></a><a class="link" href="#sec:ant_logging">Ant logging</a></h4>
<div class="paragraph">
<p>Gradle maps Ant message priorities to Gradle log levels so that messages logged from Ant appear in the Gradle output. By default, these are mapped as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. Ant message priority mapping</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Ant Message Priority</th>
<th class="tableblock halign-left valign-top">Gradle Log Level</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>VERBOSE</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DEBUG</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>DEBUG</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DEBUG</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>INFO</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INFO</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>WARN</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>WARN</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>ERROR</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ERROR</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="sec:fine_tuning_ant_logging"><a class="anchor" href="#sec:fine_tuning_ant_logging"></a><a class="link" href="#sec:fine_tuning_ant_logging">Fine tuning Ant logging</a></h5>
<div class="paragraph">
<p>The default mapping of Ant message priority to Gradle log level can sometimes be problematic. For example, there is no message priority that maps directly to the <code>LIFECYCLE</code> log level, which is the default for Gradle. Many Ant tasks log messages at the <em>INFO</em> priority, which means to expose those messages from Gradle, a build would have to be run with the log level set to <code>INFO</code>, potentially logging much more output than is desired.</p>
</div>
<div class="paragraph">
<p>Conversely, if an Ant task logs messages at too high of a level, to suppress those messages would require the build to be run at a higher log level, such as <code>QUIET</code>. However, this could result in other, desirable output being suppressed.</p>
</div>
<div class="paragraph">
<p>To help with this, Gradle allows the user to fine tune the Ant logging and control the mapping of message priority to Gradle log level. This is done by setting the priority that should map to the default Gradle <code>LIFECYCLE</code> log level using the <a href="../javadoc/org/gradle/api/AntBuilder.html#setLifecycleLogLevel-java.lang.String-">AntBuilder.setLifecycleLogLevel(java.lang.String)</a> method. When this value is set, any Ant message logged at the configured priority or above will be logged at least at <code>LIFECYCLE</code>. Any Ant message logged below this priority will be logged at most at <code>INFO</code>.</p>
</div>
<div class="paragraph">
<p>For example, the following changes the mapping such that Ant <em>INFO</em> priority messages are exposed at the <code>LIFECYCLE</code> log level.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_fine_tuning_ant_logging"><a class="anchor" href="#example_fine_tuning_ant_logging"></a><a class="link" href="#example_fine_tuning_ant_logging">Example: Fine tuning Ant logging</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ant.lifecycleLogLevel = <span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span>

task hello {
    doLast {
        ant.echo(<span class="key">level</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">info</span><span class="delimiter">&quot;</span></span>, <span class="key">message</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">hello from info priority!</span><span class="delimiter">&quot;</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle hello</code></div>
<div class="content">
<pre>&gt; gradle hello

&gt; Task :hello
[ant:echo] hello from info priority!

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, if the <code>lifecycleLogLevel</code> was set to <em>ERROR</em>, Ant messages logged at the <em>WARN</em> priority would no longer be logged at the <code>WARN</code> log level. They would now be logged at the <code>INFO</code> level and would be suppressed by default.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:ant_api"><a class="anchor" href="#sec:ant_api"></a><a class="link" href="#sec:ant_api">API</a></h4>
<div class="paragraph">
<p>The Ant integration is provided by <a href="../javadoc/org/gradle/api/AntBuilder.html">AntBuilder</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="antlr_plugin"><a class="anchor" href="#antlr_plugin"></a><a class="link" href="#antlr_plugin">The ANTLR Plugin</a></h3>
<div class="paragraph">
<p>The ANTLR plugin extends the Java plugin to add support for generating parsers using <a href="http://www.antlr.org/">ANTLR</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The ANTLR plugin supports ANTLR version 2, 3 and 4.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec:antlr_usage"><a class="anchor" href="#sec:antlr_usage"></a><a class="link" href="#sec:antlr_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the ANTLR plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_antlr_plugin"><a class="anchor" href="#example_using_the_antlr_plugin"></a><a class="link" href="#example_using_the_antlr_plugin">Example: Using the ANTLR plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">antlr</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:antlr_tasks"><a class="anchor" href="#sec:antlr_tasks"></a><a class="link" href="#sec:antlr_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The ANTLR plugin adds a number of tasks to your project, as shown below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>generateGrammarSource</code>  <a href="../dsl/org.gradle.api.plugins.antlr.AntlrTask.html">AntlrTask</a></dt>
<dd>
<p>Generates the source files for all production ANTLR grammars.</p>
</dd>
<dt class="hdlist1"><code>generateTestGrammarSource</code>  <a href="../dsl/org.gradle.api.plugins.antlr.AntlrTask.html">AntlrTask</a></dt>
<dd>
<p>Generates the source files for all test ANTLR grammars.</p>
</dd>
<dt class="hdlist1"><code>generate<em>SourceSet</em>GrammarSource</code>  <a href="../dsl/org.gradle.api.plugins.antlr.AntlrTask.html">AntlrTask</a></dt>
<dd>
<p>Generates the source files for all ANTLR grammars for the given source set.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The ANTLR plugin adds the following dependencies to tasks added by the Java plugin.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. ANTLR plugin - additional task dependencies</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Task name</th>
<th class="tableblock halign-left valign-top">Depends on</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>compileJava</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>generateGrammarSource</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>compileTestJava</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>generateTestGrammarSource</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>compile<em>SourceSet</em>Java</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>generate<em>SourceSet</em>GrammarSource</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:antlr_project_layout"><a class="anchor" href="#sec:antlr_project_layout"></a><a class="link" href="#sec:antlr_project_layout">Project layout</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/main/antlr</code></dt>
<dd>
<p>Production ANTLR grammar files. If the ANTLR grammar is organized in packages, the structure in the antlr folder should reflect the package structure. This ensures that the generated sources end up in the correct target subfolder.</p>
</dd>
<dt class="hdlist1"><code>src/test/antlr</code></dt>
<dd>
<p>Test ANTLR grammar files.</p>
</dd>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/antlr</code></dt>
<dd>
<p>ANTLR grammar files for the given source set.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:antlr_dependency_management"><a class="anchor" href="#sec:antlr_dependency_management"></a><a class="link" href="#sec:antlr_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>The ANTLR plugin adds an <code>antlr</code> dependency configuration which provides the ANTLR implementation to use. The following example shows how to use ANTLR version 3.</p>
</div>
<div class="sect4">
<h5 id="example_declare_antlr_version"><a class="anchor" href="#example_declare_antlr_version"></a><a class="link" href="#example_declare_antlr_version">Example: Declare ANTLR version</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    antlr <span class="string"><span class="delimiter">&quot;</span><span class="content">org.antlr:antlr:3.5.2</span><span class="delimiter">&quot;</span></span> <span class="comment">// use ANTLR version 3</span>
    <span class="comment">// antlr &quot;org.antlr:antlr4:4.5&quot; // use ANTLR version 4</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If no dependency is declared, <code>antlr:antlr:2.7.7</code> will be used as the default. To use a different ANTLR version add the appropriate dependency to the <code>antlr</code> dependency configuration as above.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:antlr_convention_properties"><a class="anchor" href="#sec:antlr_convention_properties"></a><a class="link" href="#sec:antlr_convention_properties">Convention properties</a></h4>
<div class="paragraph">
<p>The ANTLR plugin does not add any convention properties.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:antlr_source_set_properties"><a class="anchor" href="#sec:antlr_source_set_properties"></a><a class="link" href="#sec:antlr_source_set_properties">Source set properties</a></h4>
<div class="paragraph">
<p>The ANTLR plugin adds the following properties to each source set in the project.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>antlr</code>  <a href="../dsl/org.gradle.api.file.SourceDirectorySet.html">SourceDirectorySet</a></dt>
<dd>
<p>The ANTLR grammar files of this source set. Contains all <code>.g</code> or <code>.g4</code> files found in the ANTLR source directories, and excludes all other types of files. <em>Default value is non-null.</em></p>
</dd>
<dt class="hdlist1"><code>antlr.srcDirs</code>  <code>Set&lt;File&gt;</code></dt>
<dd>
<p>The source directories containing the ANTLR grammar files of this source set.
Can set using anything <a href="#sec:specifying_multiple_files">that implicitly converts to a file collection</a>.
Default value is <code>[<em>projectDir</em>/src/<em>name</em>/antlr]</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:controlling_the_antlr_generator_process"><a class="anchor" href="#sec:controlling_the_antlr_generator_process"></a><a class="link" href="#sec:controlling_the_antlr_generator_process">Controlling the ANTLR generator process</a></h4>
<div class="paragraph">
<p>The ANTLR tool is executed in a forked process. This allows fine grained control over memory settings for the ANTLR process. To set the heap size of an ANTLR process, the <code>maxHeapSize</code> property of <a href="../dsl/org.gradle.api.plugins.antlr.AntlrTask.html">AntlrTask</a> can be used. To pass additional command-line arguments, append to the <code>arguments</code> property of <a href="../dsl/org.gradle.api.plugins.antlr.AntlrTask.html">AntlrTask</a>.</p>
</div>
<div class="sect4">
<h5 id="example_setting_custom_max_heap_size_and_extra_arguments_for_antlr"><a class="anchor" href="#example_setting_custom_max_heap_size_and_extra_arguments_for_antlr"></a><a class="link" href="#example_setting_custom_max_heap_size_and_extra_arguments_for_antlr">Example: Setting custom max heap size and extra arguments for ANTLR</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">generateGrammarSource {
    maxHeapSize = <span class="string"><span class="delimiter">&quot;</span><span class="content">64m</span><span class="delimiter">&quot;</span></span>
    arguments += [<span class="string"><span class="delimiter">&quot;</span><span class="content">-visitor</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">-long-messages</span><span class="delimiter">&quot;</span></span>]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="application_plugin"><a class="anchor" href="#application_plugin"></a><a class="link" href="#application_plugin">The Application Plugin</a></h3>
<div class="paragraph">
<p>The Application plugin facilitates creating an executable JVM application. It makes it easy to start the application locally during development, and to package the application as a TAR and/or ZIP including operating system specific start scripts.</p>
</div>
<div class="paragraph">
<p>Applying the Application plugin also implicitly applies the <a href="#java_plugin">Java plugin</a>. The <code>main</code> source set is effectively the application.</p>
</div>
<div class="paragraph">
<p>Applying the Application plugin also implicitly applies the <a href="#distribution_plugin">Distribution plugin</a>. A <code>main</code> distribution is created that packages up the application, including code dependencies and generated start scripts.</p>
</div>
<div class="sect3">
<h4 id="sec:application_usage"><a class="anchor" href="#sec:application_usage"></a><a class="link" href="#sec:application_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the application plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_application_plugin"><a class="anchor" href="#example_using_the_application_plugin"></a><a class="link" href="#example_using_the_application_plugin">Example: Using the application plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">application</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The only mandatory configuration for the plugin is the specification of the main class (i.e. entry point) of the application.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configure_the_application_main_class"><a class="anchor" href="#example_configure_the_application_main_class"></a><a class="link" href="#example_configure_the_application_main_class">Example: Configure the application main class</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">mainClassName = <span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.sample.Main</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can run the application by executing the <code>run</code> task (type: <a href="../javadoc/org.gradle.api.tasks.JavaExec.html">JavaExec</a>). This will compile the main source set, and launch a new JVM with its classes (along with all runtime dependencies) as the classpath and using the specified main class. You can launch the application in debug mode with <code>gradle run --debug-jvm</code> (see <a href="../javadoc/org/gradle/api/tasks/JavaExec.html#setDebug-boolean-">JavaExec.setDebug(boolean)</a>).</p>
</div>
<div class="paragraph">
<p>Since Gradle 4.9, the command line arguments can be passed with <code>--args</code>. For example, if you want to launch the application with command line arguments <code>foo --bar</code>, you can use <code>gradle run --args="foo --bar"</code> (see <a href="../javadoc/org/gradle/api/tasks/JavaExec.html#setArgsString-java.lang.String-">JavaExec.setArgsString(java.lang.String)</a>.</p>
</div>
<div class="paragraph">
<p>If your application requires a specific set of JVM settings or system properties, you can configure the <code>applicationDefaultJvmArgs</code> property. These JVM arguments are applied to the <code>run</code> task and also considered in the generated start scripts of your distribution.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configure_default_jvm_settings"><a class="anchor" href="#example_configure_default_jvm_settings"></a><a class="link" href="#example_configure_default_jvm_settings">Example: Configure default JVM settings</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">applicationDefaultJvmArgs = [<span class="string"><span class="delimiter">&quot;</span><span class="content">-Dgreeting.language=en</span><span class="delimiter">&quot;</span></span>]</code></pre>
</div>
</div>
<div class="paragraph">
<p>If your application&#8217;s start scripts should be in a different directory than <code>bin</code>, you can configure the <code>executableDir</code> property.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configure_custom_directory_for_start_scripts"><a class="anchor" href="#example_configure_custom_directory_for_start_scripts"></a><a class="link" href="#example_configure_custom_directory_for_start_scripts">Example: Configure custom directory for start scripts</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">executableDir = <span class="string"><span class="delimiter">&quot;</span><span class="content">custom_bin_dir</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:the_distribution"><a class="anchor" href="#sec:the_distribution"></a><a class="link" href="#sec:the_distribution">The distribution</a></h5>
<div class="paragraph">
<p>A distribution of the application can be created, by way of the <a href="#distribution_plugin">Distribution plugin</a> (which is automatically applied). A <code>main</code> distribution is created with the following content:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 22. Distribution content</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Location</th>
<th class="tableblock halign-left valign-top">Content</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(root dir)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>src/dist</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All runtime dependencies and main source set class files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Start scripts (generated by <code>createStartScripts</code> task).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Static files to be added to the distribution can be simply added to <code>src/dist</code>. More advanced customization can be done by configuring the <a href="../javadoc/org.gradle.api.file.file.CopySpec.html">CopySpec</a> exposed by the main distribution.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_include_output_from_other_tasks_in_the_application_distribution"><a class="anchor" href="#example_include_output_from_other_tasks_in_the_application_distribution"></a><a class="link" href="#example_include_output_from_other_tasks_in_the_application_distribution">Example: Include output from other tasks in the application distribution</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task createDocs {
    <span class="keyword">def</span> docs = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/docs</span><span class="delimiter">&quot;</span></span>)
    outputs.dir docs
    doLast {
        docs.mkdirs()
        <span class="keyword">new</span> <span class="predefined-type">File</span>(docs, <span class="string"><span class="delimiter">&quot;</span><span class="content">readme.txt</span><span class="delimiter">&quot;</span></span>).write(<span class="string"><span class="delimiter">&quot;</span><span class="content">Read me!</span><span class="delimiter">&quot;</span></span>)
    }
}

distributions {
    main {
        contents {
            from(createDocs) {
                into <span class="string"><span class="delimiter">&quot;</span><span class="content">docs</span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By specifying that the distribution should include the task&#8217;s output files (see <a href="#sec:task_inputs_outputs">more about tasks</a>), Gradle knows that the task that produces the files must be invoked before the distribution can be assembled and will take care of this for you.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_automatically_creating_files_for_distribution"><a class="anchor" href="#example_automatically_creating_files_for_distribution"></a><a class="link" href="#example_automatically_creating_files_for_distribution">Example: Automatically creating files for distribution</a></h5>
<div class="listingblock">
<div class="title">Output of <code>gradle distZip</code></div>
<div class="content">
<pre>&gt; gradle distZip
&gt; Task :createDocs
&gt; Task :compileJava
&gt; Task :processResources NO-SOURCE
&gt; Task :classes
&gt; Task :jar
&gt; Task :startScripts
&gt; Task :distZip

BUILD SUCCESSFUL in 0s
5 actionable tasks: 5 executed</pre>
</div>
</div>
<div class="paragraph">
<p>You can run <code>gradle installDist</code> to create an image of the application in <code>build/install/<em>projectName</em></code>. You can run <code>gradle distZip</code> to create a ZIP containing the distribution, <code>gradle distTar</code> to create an application TAR or <code>gradle assemble</code> to build both.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:customizing_start_script_generation"><a class="anchor" href="#sec:customizing_start_script_generation"></a><a class="link" href="#sec:customizing_start_script_generation">Customizing start script generation</a></h5>
<div class="paragraph">
<p>The application plugin can generate Unix (suitable for Linux, macOS etc.) and Windows start scripts out of the box. The start scripts launch a JVM with the specified settings defined as part of the original build and runtime environment (e.g. <code>JAVA_OPTS</code> env var). The default script templates are based on the same scripts used to launch Gradle itself, that ship as part of a Gradle distribution.</p>
</div>
<div class="paragraph">
<p>The start scripts are completely customizable. Please refer to the documentation of <a href="../dsl/org.gradle.jvm.application.tasks.CreateStartScripts.html">CreateStartScripts</a> for more details and customization examples.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:application_tasks"><a class="anchor" href="#sec:application_tasks"></a><a class="link" href="#sec:application_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Application plugin adds the following tasks to the project.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>run</code>  <a href="../dsl/org.gradle.api.tasks.JavaExec.html">JavaExec</a></dt>
<dd>
<p><em>Depends on</em>: <code>classes</code></p>
<div class="paragraph">
<p>Starts the application.</p>
</div>
</dd>
<dt class="hdlist1"><code>startScripts</code>  <a href="../dsl/org.gradle.api.tasks.application.tasks.application.CreateStartScripts.html">CreateStartScripts</a></dt>
<dd>
<p><em>Depends on</em>: <code>jar</code></p>
<div class="paragraph">
<p>Creates OS specific scripts to run the project as a JVM application.</p>
</div>
</dd>
<dt class="hdlist1"><code>installDist</code>  <a href="../dsl/org.gradle.api.tasks.Sync.html">Sync</a></dt>
<dd>
<p><em>Depends on</em>: <code>jar</code>, <code>startScripts</code></p>
<div class="paragraph">
<p>Installs the application into a specified directory.</p>
</div>
</dd>
<dt class="hdlist1"><code>distZip</code>  <a href="../dsl/org.gradle.api.tasks.bundling.tasks.bundling.Zip.html">Zip</a></dt>
<dd>
<p><em>Depends on</em>: <code>jar</code>, <code>startScripts</code></p>
<div class="paragraph">
<p>Creates a full distribution ZIP archive including runtime libraries and OS specific scripts.</p>
</div>
</dd>
<dt class="hdlist1"><code>distTar</code>  <a href="../dsl/org.gradle.api.tasks.bundling.tasks.bundling.Tar.html">Tar</a></dt>
<dd>
<p><em>Depends on</em>: <code>jar</code>, <code>startScripts</code></p>
<div class="paragraph">
<p>Creates a full distribution TAR archive including runtime libraries and OS specific scripts.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:application_convention_properties"><a class="anchor" href="#sec:application_convention_properties"></a><a class="link" href="#sec:application_convention_properties">Convention properties</a></h4>
<div class="paragraph">
<p>The application plugin adds some properties to the project, which you can use to configure its behaviour. See the <a href="../dsl/org.gradle.api.Project.html">Project</a> class in the API documentation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="checkstyle_plugin"><a class="anchor" href="#checkstyle_plugin"></a><a class="link" href="#checkstyle_plugin">The Checkstyle Plugin</a></h3>
<div class="paragraph">
<p>The Checkstyle plugin performs quality checks on your project&#8217;s Java source files using <a href="http://checkstyle.sourceforge.net/index.html">Checkstyle</a> and generates reports from these checks.</p>
</div>
<div class="sect3">
<h4 id="sec:checkstyle_usage"><a class="anchor" href="#sec:checkstyle_usage"></a><a class="link" href="#sec:checkstyle_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Checkstyle plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_checkstyle_plugin"><a class="anchor" href="#example_using_the_checkstyle_plugin"></a><a class="link" href="#example_using_the_checkstyle_plugin">Example: Using the Checkstyle plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">checkstyle</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The plugin adds a number of tasks to the project that perform the quality checks. You can execute the checks by running <code>gradle check</code>.</p>
</div>
<div class="paragraph">
<p>Note that Checkstyle will run with the same Java version used to run Gradle.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:checkstyle_tasks"><a class="anchor" href="#sec:checkstyle_tasks"></a><a class="link" href="#sec:checkstyle_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Checkstyle plugin adds the following tasks to the project:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>checkstyleMain</code>  <a href="../dsl/org.gradle.api.plugins.quality.Checkstyle.html">Checkstyle</a></dt>
<dd>
<p><em>Depends on</em>: <code>classes</code></p>
<div class="paragraph">
<p>Runs Checkstyle against the production Java source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>checkstyleTest</code>  <a href="../dsl/org.gradle.api.plugins.quality.Checkstyle.html">Checkstyle</a></dt>
<dd>
<p><em>Depends on</em>: <code>testClasses</code></p>
<div class="paragraph">
<p>Runs Checkstyle against the test Java source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>checkstyle<em>SourceSet</em></code>  <a href="../dsl/org.gradle.api.plugins.quality.Checkstyle.html">Checkstyle</a></dt>
<dd>
<p><em>Depends on</em>: <code><em>sourceSet</em>Classes</code></p>
<div class="paragraph">
<p>Runs Checkstyle against the given source set&#8217;s Java source files.</p>
</div>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="dependencies_added_to_other_tasks_2"><a class="anchor" href="#dependencies_added_to_other_tasks_2"></a><a class="link" href="#dependencies_added_to_other_tasks_2">Dependencies added to other tasks</a></h5>
<div class="paragraph">
<p>The Checkstyle plugin adds the following dependencies to tasks defined by the Java plugin.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>check</code></dt>
<dd>
<p><em>Depends on</em>: All Checkstyle tasks, including <code>checkstyleMain</code> and <code>checkstyleTest</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:checkstyle_project_layout"><a class="anchor" href="#sec:checkstyle_project_layout"></a><a class="link" href="#sec:checkstyle_project_layout">Project layout</a></h4>
<div class="paragraph">
<p>By default, the Checkstyle plugin expects configuration files to be placed in the root project, but this can be changed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;root&gt;
 config
     checkstyle           <b class="conum">(1)</b>
         checkstyle.xml   <b class="conum">(2)</b>
         suppressions.xml</pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Checkstyle configuration files go here</p>
</li>
<li>
<p>Primary Checkstyle configuration file</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="sec:checkstyle_dependency_management"><a class="anchor" href="#sec:checkstyle_dependency_management"></a><a class="link" href="#sec:checkstyle_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>The Checkstyle plugin adds the following dependency configurations:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. Checkstyle plugin - dependency configurations</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>checkstyle</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The Checkstyle libraries to use</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:checkstyle_configuration"><a class="anchor" href="#sec:checkstyle_configuration"></a><a class="link" href="#sec:checkstyle_configuration">Configuration</a></h4>
<div class="paragraph">
<p>See the <a href="../dsl/org.gradle.api.plugins.quality.CheckstyleExtension.html">CheckstyleExtension</a> class in the API documentation.</p>
</div>
<div class="sect4">
<h5 id="sec:checkstyle_built_in_variables"><a class="anchor" href="#sec:checkstyle_built_in_variables"></a><a class="link" href="#sec:checkstyle_built_in_variables">Built-in variables</a></h5>
<div class="paragraph">
<p>The Checkstyle plugin defines a <code>config_loc</code> property that can be used in Checkstyle configuration files to define paths to other configuration files like <code>suppressions.xml</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_the_config_loc_property"><a class="anchor" href="#example_using_the_config_loc_property"></a><a class="link" href="#example_using_the_config_loc_property">Example: Using the config_loc property</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">config/checkstyle/checkstyle.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">&lt;module name=<span class="string"><span class="delimiter">&quot;</span><span class="content">SuppressionFilter</span><span class="delimiter">&quot;</span></span>&gt;
    &lt;property name=<span class="string"><span class="delimiter">&quot;</span><span class="content">file</span><span class="delimiter">&quot;</span></span> value=<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>config_loc<span class="inline-delimiter">}</span></span><span class="content">/suppressions.xml</span><span class="delimiter">&quot;</span></span>/&gt;
&lt;<span class="regexp"><span class="delimiter">/</span><span class="content">module&gt;</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:checkstyle_customize_xsl"><a class="anchor" href="#sec:checkstyle_customize_xsl"></a><a class="link" href="#sec:checkstyle_customize_xsl">Customizing the HTML report</a></h4>
<div class="paragraph">
<p>The HTML report generated by the <a href="../dsl/org.gradle.api.plugins.quality.Checkstyle.html">Checkstyle</a> task can be customized using a XSLT stylesheet, for example to highlight specific errors or change its appearance:</p>
</div>
<div class="sect4">
<h5 id="example_customizing_the_html_report"><a class="anchor" href="#example_customizing_the_html_report"></a><a class="link" href="#example_customizing_the_html_report">Example: Customizing the HTML report</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.withType(Checkstyle) {
    reports {
        xml.enabled <span class="predefined-constant">false</span>
        html.enabled <span class="predefined-constant">true</span>
        html.stylesheet resources.text.fromFile(<span class="string"><span class="delimiter">'</span><span class="content">config/xsl/checkstyle-custom.xsl</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/checkstyle/contribution/tree/master/xsl">View a sample Checkstyle stylesheet.</a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="findbugs_plugin"><a class="anchor" href="#findbugs_plugin"></a><a class="link" href="#findbugs_plugin">The FindBugs Plugin</a></h3>
<div class="paragraph">
<p>The FindBugs plugin performs quality checks on your project&#8217;s Java source files using <a href="http://findbugs.sourceforge.net">FindBugs</a> and generates reports from these checks.</p>
</div>
<div class="sect3">
<h4 id="sec:findbugs_usage"><a class="anchor" href="#sec:findbugs_usage"></a><a class="link" href="#sec:findbugs_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the FindBugs plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_findbugs_plugin"><a class="anchor" href="#example_using_the_findbugs_plugin"></a><a class="link" href="#example_using_the_findbugs_plugin">Example: Using the FindBugs plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">findbugs</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The plugin adds a number of tasks to the project that perform the quality checks. You can execute the checks by running <code>gradle check</code>.</p>
</div>
<div class="paragraph">
<p>Note that Findbugs will run with the same Java version used to run Gradle.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:findbugs_tasks"><a class="anchor" href="#sec:findbugs_tasks"></a><a class="link" href="#sec:findbugs_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The FindBugs plugin adds the following tasks to the project:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>findbugsMain</code>  <a href="../dsl/org.gradle.api.plugins.quality.FindBugs.html">FindBugs</a></dt>
<dd>
<p><em>Depends on</em>: <code>classes</code></p>
<div class="paragraph">
<p>Runs FindBugs against the production Java source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>findbugsTest</code>  <a href="../dsl/org.gradle.api.plugins.quality.FindBugs.html">FindBugs</a></dt>
<dd>
<p><em>Depends on</em>: <code>testClasses</code></p>
<div class="paragraph">
<p>Runs FindBugs against the test Java source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>findbugs<em>SourceSet</em></code>  <a href="../dsl/org.gradle.api.plugins.quality.FindBugs.html">FindBugs</a></dt>
<dd>
<p><em>Depends on</em>: <code><em>sourceSet</em>Classes</code></p>
<div class="paragraph">
<p>Runs FindBugs against the given source set&#8217;s Java source files.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The FindBugs plugin adds the following dependencies to tasks defined by the Java plugin.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 24. FindBugs plugin - additional task dependencies</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Task name</th>
<th class="tableblock halign-left valign-top">Depends on</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>check</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All FindBugs tasks, including <code>findbugsMain</code> and <code>findbugsTest</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:findbugs_dependency_management"><a class="anchor" href="#sec:findbugs_dependency_management"></a><a class="link" href="#sec:findbugs_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>The FindBugs plugin adds the following dependency configurations:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 25. FindBugs plugin - dependency configurations</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>findbugs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The FindBugs libraries to use</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:findbugs_configuration"><a class="anchor" href="#sec:findbugs_configuration"></a><a class="link" href="#sec:findbugs_configuration">Configuration</a></h4>
<div class="paragraph">
<p>See the <a href="../dsl/org.gradle.api.plugins.quality.FindBugsExtension.html">FindBugsExtension</a> class in the API documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:findbugs_customize_xsl"><a class="anchor" href="#sec:findbugs_customize_xsl"></a><a class="link" href="#sec:findbugs_customize_xsl">Customizing the HTML report</a></h4>
<div class="paragraph">
<p>The HTML report generated by the <a href="../dsl/org.gradle.api.plugins.quality.FindBugs.html">FindBugs</a> task can be customized using a XSLT stylesheet, for example to highlight specific errors or change its appearance:</p>
</div>
<div class="sect4">
<h5 id="example_customizing_the_html_report_2"><a class="anchor" href="#example_customizing_the_html_report_2"></a><a class="link" href="#example_customizing_the_html_report_2">Example: Customizing the HTML report</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.withType(FindBugs) {
    reports {
        xml.enabled <span class="predefined-constant">false</span>
        html.enabled <span class="predefined-constant">true</span>
        html.stylesheet resources.text.fromFile(<span class="string"><span class="delimiter">'</span><span class="content">config/xsl/findbugs-custom.xsl</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/findbugsproject/findbugs/tree/master/findbugs/src/xsl">View a sample FindBugs stylesheet.</a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jacoco_plugin"><a class="anchor" href="#jacoco_plugin"></a><a class="link" href="#jacoco_plugin">The JaCoCo Plugin</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The JaCoCo plugin is currently <a href="#feature_lifecycle">incubating</a>. Please be aware that the DSL and other configuration may change in later Gradle versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The JaCoCo plugin provides code coverage metrics for Java code via integration with <a href="http://www.eclemma.org/jacoco/">JaCoCo</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:jacoco_getting_started"><a class="anchor" href="#sec:jacoco_getting_started"></a><a class="link" href="#sec:jacoco_getting_started">Getting Started</a></h4>
<div class="paragraph">
<p>To get started, apply the JaCoCo plugin to the project you want to calculate code coverage for.</p>
</div>
<div class="sect4">
<h5 id="example_applying_the_jacoco_plugin"><a class="anchor" href="#example_applying_the_jacoco_plugin"></a><a class="link" href="#example_applying_the_jacoco_plugin">Example: Applying the JaCoCo plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">jacoco</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the Java plugin is also applied to your project, a new task named <code>jacocoTestReport</code> is created that depends on the <code>test</code> task. The report is available at <code><em>$buildDir</em>/reports/jacoco/test</code>. By default, a HTML report is generated.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configuring_the_jacoco_plugin"><a class="anchor" href="#sec:configuring_the_jacoco_plugin"></a><a class="link" href="#sec:configuring_the_jacoco_plugin">Configuring the JaCoCo Plugin</a></h4>
<div class="paragraph">
<p>The JaCoCo plugin adds a project extension named <code>jacoco</code> of type <a href="../dsl/org.gradle.testing.jacoco.plugins.JacocoPluginExtension.html">JacocoPluginExtension</a>, which allows configuring defaults for JaCoCo usage in your build.</p>
</div>
<div class="sect4">
<h5 id="example_configuring_jacoco_plugin_settings"><a class="anchor" href="#example_configuring_jacoco_plugin_settings"></a><a class="link" href="#example_configuring_jacoco_plugin_settings">Example: Configuring JaCoCo plugin settings</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">jacoco {
    toolVersion = <span class="string"><span class="delimiter">&quot;</span><span class="content">0.8.1</span><span class="delimiter">&quot;</span></span>
    reportsDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/customJacocoReportDir</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 26. Gradle defaults for JaCoCo properties</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Gradle default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reportsDir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>$buildDir</em>/reports/jacoco</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:jacoco_report_configuration"><a class="anchor" href="#sec:jacoco_report_configuration"></a><a class="link" href="#sec:jacoco_report_configuration">JaCoCo Report configuration</a></h4>
<div class="paragraph">
<p>The <a href="../dsl/org.gradle.testing.jacoco.tasks.JacocoReport.html">JacocoReport</a> task can be used to generate code coverage reports in different formats. It implements the standard Gradle type <a href="../dsl/org.gradle.api.reporting.Reporting.html">Reporting</a> and exposes a report container of type <a href="../javadoc/org/gradle/testing/jacoco/tasks/JacocoReportsContainer.html">JacocoReportsContainer</a>.</p>
</div>
<div class="sect4">
<h5 id="example_configuring_test_task"><a class="anchor" href="#example_configuring_test_task"></a><a class="link" href="#example_configuring_test_task">Example: Configuring test task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">jacocoTestReport {
    reports {
        xml.enabled <span class="predefined-constant">false</span>
        csv.enabled <span class="predefined-constant">false</span>
        html.destination file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/jacocoHtml</span><span class="delimiter">&quot;</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="img/jacocoHtmlReport.png" alt="JaCoCo HTML report" width="903" height="277">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:jacoco_report_violation_rules"><a class="anchor" href="#sec:jacoco_report_violation_rules"></a><a class="link" href="#sec:jacoco_report_violation_rules">Enforcing code coverage metrics</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This feature requires the use of JaCoCo version 0.6.3 or higher.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <a href="../dsl/org.gradle.testing.jacoco.tasks.JacocoCoverageVerification.html">JacocoCoverageVerification</a> task can be used to verify if code coverage metrics are met based on configured rules. Its API exposes the method <a href="../javadoc/org/gradle/testing/jacoco/tasks/JacocoCoverageVerification.html#violationRules-org.gradle.api.Action-">JacocoCoverageVerification.violationRules(org.gradle.api.Action)</a> which is used as main entry point for configuring rules. Invoking any of those methods returns an instance of <a href="../javadoc/org/gradle/testing/jacoco/tasks/rules/JacocoViolationRulesContainer.html">JacocoViolationRulesContainer</a> providing extensive configuration options. The build fails if any of the configured rules are not met. JaCoCo only reports the first violated rule.</p>
</div>
<div class="paragraph">
<p>Code coverage requirements can be specified for a project as a whole, for individual files, and for particular JaCoCo-specific types of coverage, e.g., lines covered or branches covered. The following example describes the syntax.</p>
</div>
<div class="sect4">
<h5 id="example_configuring_violation_rules"><a class="anchor" href="#example_configuring_violation_rules"></a><a class="link" href="#example_configuring_violation_rules">Example: Configuring violation rules</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">jacocoTestCoverageVerification {
    violationRules {
        rule {
            limit {
                minimum = <span class="float">0.5</span>
            }
        }

        rule {
            enabled = <span class="predefined-constant">false</span>
            element = <span class="string"><span class="delimiter">'</span><span class="content">CLASS</span><span class="delimiter">'</span></span>
            includes = [<span class="string"><span class="delimiter">'</span><span class="content">org.gradle.*</span><span class="delimiter">'</span></span>]

            limit {
                counter = <span class="string"><span class="delimiter">'</span><span class="content">LINE</span><span class="delimiter">'</span></span>
                value = <span class="string"><span class="delimiter">'</span><span class="content">TOTALCOUNT</span><span class="delimiter">'</span></span>
                maximum = <span class="float">0.3</span>
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/testing/jacoco/quickstart</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <a href="../dsl/org.gradle.testing.jacoco.tasks.JacocoCoverageVerification.html">JacocoCoverageVerification</a> task is not a task dependency of the <code>check</code> task provided by the Java plugin. There is a good reason for it. The task is currently not incremental as it doesn&#8217;t declare any outputs. Any violation of the declared rules would automatically result in a failed build when executing the <code>check</code> task. This behavior might not be desirable for all users. Future versions of Gradle might change the behavior.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:jacoco_specific_task_configuration"><a class="anchor" href="#sec:jacoco_specific_task_configuration"></a><a class="link" href="#sec:jacoco_specific_task_configuration">JaCoCo specific task configuration</a></h4>
<div class="paragraph">
<p>The JaCoCo plugin adds a <a href="../dsl/org.gradle.testing.jacoco.plugins.JacocoTaskExtension.html">JacocoTaskExtension</a> extension to all tasks of type <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a>. This extension allows the configuration of the JaCoCo specific properties of the test task.</p>
</div>
<div class="sect4">
<h5 id="example_configuring_test_task_2"><a class="anchor" href="#example_configuring_test_task_2"></a><a class="link" href="#example_configuring_test_task_2">Example: Configuring test task</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    jacoco {
        append = <span class="predefined-constant">false</span>
        destinationFile = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/jacoco/jacocoTest.exec</span><span class="delimiter">&quot;</span></span>)
        classDumpDir = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/jacoco/classpathdumps</span><span class="delimiter">&quot;</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Using the configuration <code>append = true</code> (the default) causes the JaCoCo agent to append to a shared output file that may be left over from a different test execution.
If <code>append = true</code>, Gradle disables caching for the Test task since it cannot guarantee the same results each time.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Default values of the JaCoCo Task extension</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    jacoco {
        append = <span class="predefined-constant">true</span>
        enabled = <span class="predefined-constant">true</span>
        destPath = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/jacoco</span><span class="delimiter">&quot;</span></span>
        includes = <span class="type">[]</span>
        excludes = <span class="type">[]</span>
        excludeClassLoaders = <span class="type">[]</span>
        includeNoLocationClasses = <span class="predefined-constant">false</span>
        sessionId = <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;auto-generated value&gt;</span><span class="delimiter">&quot;</span></span>
        dumpOnExit = <span class="predefined-constant">true</span>
        classDumpDir = <span class="predefined-constant">null</span>
        output = Output.FILE
        address = <span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span>
        port = <span class="integer">6300</span>
        jmx = <span class="predefined-constant">false</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>While all tasks of type <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a> are automatically enhanced to provide coverage information when the <code>java</code> plugin has been applied, any task that implements <a href="../javadoc/org/gradle/process/JavaForkOptions.html">JavaForkOptions</a> can be enhanced by the JaCoCo plugin. That is, any task that forks Java processes can be used to generate coverage information.</p>
</div>
<div class="paragraph">
<p>For example you can configure your build to generate code coverage using the <code>application</code> plugin.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_application_plugin_to_generate_code_coverage_data"><a class="anchor" href="#example_using_application_plugin_to_generate_code_coverage_data"></a><a class="link" href="#example_using_application_plugin_to_generate_code_coverage_data">Example: Using application plugin to generate code coverage data</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application</span><span class="delimiter">&quot;</span></span>
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">jacoco</span><span class="delimiter">&quot;</span></span>

mainClassName = <span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle.MyMain</span><span class="delimiter">&quot;</span></span>

jacoco {
    applyTo run
}

task applicationCodeCoverageReport(<span class="key">type</span>:JacocoReport){
    executionData run
    sourceSets sourceSets.main
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/testing/jacoco/application</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Coverage reports generated by applicationCodeCoverageReport</div>
<div class="content">
<pre>.
 build
     jacoco
      run.exec
     reports
         jacoco
             applicationCodeCoverageReport
                 html
                     index.html</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:jacoco_tasks"><a class="anchor" href="#sec:jacoco_tasks"></a><a class="link" href="#sec:jacoco_tasks">Tasks</a></h4>
<div class="paragraph">
<p>For projects that also apply the Java Plugin, the JaCoCo plugin automatically adds the following tasks:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>jacocoTestReport</code>  <a href="../dsl/org.gradle.testing.jacoco.tasks.JacocoReport.html">JacocoReport</a></dt>
<dd>
<div class="paragraph">
<p>Generates code coverage report for the test task.</p>
</div>
</dd>
<dt class="hdlist1"><code>jacocoTestCoverageVerification</code>  <a href="../dsl/org.gradle.testing.jacoco.tasks.JacocoCoverageVerification.html">JacocoCoverageVerification</a></dt>
<dd>
<div class="paragraph">
<p>Verifies code coverage metrics based on specified rules for the test task.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:jacoco_dependency_management"><a class="anchor" href="#sec:jacoco_dependency_management"></a><a class="link" href="#sec:jacoco_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>The JaCoCo plugin adds the following dependency configurations:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 27. JaCoCo plugin - dependency configurations</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jacocoAnt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The JaCoCo Ant library used for running the <code>JacocoReport</code>, <code>JacocoMerge</code> and <code>JacocoCoverageVerification</code> tasks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jacocoAgent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The JaCoCo agent library used for instrumenting the code under test.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="jdepend_plugin"><a class="anchor" href="#jdepend_plugin"></a><a class="link" href="#jdepend_plugin">The JDepend Plugin</a></h3>
<div class="paragraph">
<p>The JDepend plugin performs quality checks on your project&#8217;s source files using <a href="http://clarkware.com/software/JDepend.html">JDepend</a> and generates reports from these checks.</p>
</div>
<div class="sect3">
<h4 id="sec:jdepend_usage"><a class="anchor" href="#sec:jdepend_usage"></a><a class="link" href="#sec:jdepend_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the JDepend plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_jdepend_plugin"><a class="anchor" href="#example_using_the_jdepend_plugin"></a><a class="link" href="#example_using_the_jdepend_plugin">Example: Using the JDepend plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">jdepend</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The plugin adds a number of tasks to the project that perform the quality checks. You can execute the checks by running <code>gradle check</code>.</p>
</div>
<div class="paragraph">
<p>Note that JDepend will run with the same Java version used to run Gradle.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:jdepend_tasks"><a class="anchor" href="#sec:jdepend_tasks"></a><a class="link" href="#sec:jdepend_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The JDepend plugin adds the following tasks to the project:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>jdependMain</code>  <a href="../dsl/org.gradle.api.plugins.quality.JDepend.html">JDepend</a></dt>
<dd>
<p><em>Depends on</em>: <code>classes</code></p>
<div class="paragraph">
<p>Runs JDepend against the production Java source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>jdependTest</code>  <a href="../dsl/org.gradle.api.plugins.quality.JDepend.html">JDepend</a></dt>
<dd>
<p><em>Depends on</em>: <code>testClasses</code></p>
<div class="paragraph">
<p>Runs JDepend against the test Java source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>jdepend<em>SourceSet</em></code>  <a href="../dsl/org.gradle.api.plugins.quality.JDepend.html">JDepend</a></dt>
<dd>
<p><em>Depends on</em>: <code><em>sourceSet</em>Classes</code></p>
<div class="paragraph">
<p>Runs JDepend against the given source set&#8217;s Java source files.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The JDepend plugin adds the following dependencies to tasks defined by the Java plugin.</p>
</div>
<div class="sect4">
<h5 id="additional_task_dependencies"><a class="anchor" href="#additional_task_dependencies"></a><a class="link" href="#additional_task_dependencies">Additional task dependencies</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>check</code></dt>
<dd>
<p>All JDepend tasks, including <code>jdependMain</code> and <code>jdependTest</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:jdepend_dependency_management"><a class="anchor" href="#sec:jdepend_dependency_management"></a><a class="link" href="#sec:jdepend_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>The JDepend plugin adds the following dependency configurations:</p>
</div>
<div class="sect4">
<h5 id="dependency_configurations"><a class="anchor" href="#dependency_configurations"></a><a class="link" href="#dependency_configurations">Dependency configurations</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>jdepend</code></dt>
<dd>
<p>The JDepend libraries to use</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:jdepend_configuration"><a class="anchor" href="#sec:jdepend_configuration"></a><a class="link" href="#sec:jdepend_configuration">Configuration</a></h4>
<div class="paragraph">
<p>See the <a href="../dsl/org.gradle.api.plugins.quality.()JDependExtension.html">JDependExtension</a> class in the API documentation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="osgi_plugin"><a class="anchor" href="#osgi_plugin"></a><a class="link" href="#osgi_plugin">The OSGi Plugin</a></h3>
<div class="paragraph">
<p>The OSGi plugin provides a factory method to create an <a href="../javadoc/org/gradle/api/plugins/osgi/OsgiManifest.html">OsgiManifest</a> object. <code>OsgiManifest</code> extends <a href="../javadoc/org/gradle/api/java/archives/Manifest.html">Manifest</a>. To learn more about generic manifest handling, see <a href="#sub:manifest">more about Java manifests</a>. If the Java plugins is applied, the OSGi plugin replaces the manifest object of the default jar with an <code>OsgiManifest</code> object. The replaced manifest is merged into the new one.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The OSGi plugin makes heavy use of the <a href="http://bnd.bndtools.org/">BND tool</a>. A separate <a href="https://github.com/bndtools/bnd/blob/master/biz.aQute.bnd.gradle/README.md">plugin implementation</a> is maintained by the BND authors that has more advanced features.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec:osgi_usage"><a class="anchor" href="#sec:osgi_usage"></a><a class="link" href="#sec:osgi_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the OSGi plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_osgi_plugin"><a class="anchor" href="#example_using_the_osgi_plugin"></a><a class="link" href="#example_using_the_osgi_plugin">Example: Using the OSGi plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">osgi</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:osgi_implicitly_applied_plugins"><a class="anchor" href="#sec:osgi_implicitly_applied_plugins"></a><a class="link" href="#sec:osgi_implicitly_applied_plugins">Implicitly applied plugins</a></h4>
<div class="paragraph">
<p>Applies the Java base plugin.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:osgi_tasks"><a class="anchor" href="#sec:osgi_tasks"></a><a class="link" href="#sec:osgi_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The OSGi plugin adds the following tasks to the project:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>osgiClasses</code>  <a href="../dsl/org.gradle.api.tasks.Sync.html">Sync</a></dt>
<dd>
<p><em>Depends on</em>: <code>classes</code></p>
<div class="paragraph">
<p>Copies all classes from the main source set to a single directory that is processed by BND.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:osgi_convention_object"><a class="anchor" href="#sec:osgi_convention_object"></a><a class="link" href="#sec:osgi_convention_object">Convention object</a></h4>
<div class="paragraph">
<p>The OSGi plugin adds the following convention object: <a href="../javadoc/org/gradle/api/plugins/osgi/OsgiPluginConvention.html">OsgiPluginConvention</a></p>
</div>
<div class="sect4">
<h5 id="sec:osgi_convention_properties"><a class="anchor" href="#sec:osgi_convention_properties"></a><a class="link" href="#sec:osgi_convention_properties">Convention properties</a></h5>
<div class="paragraph">
<p>The OSGi plugin does not add any convention properties to the project.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:osgi_convention_methods"><a class="anchor" href="#sec:osgi_convention_methods"></a><a class="link" href="#sec:osgi_convention_methods">Convention methods</a></h5>
<div class="paragraph">
<p>The OSGi plugin adds the following methods. For more details, see the API documentation of the convention object.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 28. OSGi methods</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">osgiManifest()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/plugins/osgi/OsgiManifest.html">OsgiManifest</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns an OsgiManifest object.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">osgiManifest(Closure cl)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/plugins/osgi/OsgiManifest.html">OsgiManifest</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns an OsgiManifest object configured by the closure.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The classes in the classes dir are analyzed regarding their package dependencies and the packages they expose. Based on this the <em>Import-Package</em> and the <em>Export-Package</em> values of the OSGi Manifest are calculated. If the classpath contains jars with an OSGi bundle, the bundle information is used to specify version information for the <em>Import-Package</em> value. Beside the explicit properties of the <code>OsgiManifest</code> object you can add instructions.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuration_of_osgi_manifest_mf_file"><a class="anchor" href="#example_configuration_of_osgi_manifest_mf_file"></a><a class="link" href="#example_configuration_of_osgi_manifest_mf_file">Example: Configuration of OSGi MANIFEST.MF file</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">jar {
    manifest { <span class="comment">// the manifest of the default jar is of type OsgiManifest</span>
        name = <span class="string"><span class="delimiter">'</span><span class="content">overwrittenSpecialOsgiName</span><span class="delimiter">'</span></span>
        instruction <span class="string"><span class="delimiter">'</span><span class="content">Private-Package</span><span class="delimiter">'</span></span>,
                <span class="string"><span class="delimiter">'</span><span class="content">org.mycomp.package1</span><span class="delimiter">'</span></span>,
                <span class="string"><span class="delimiter">'</span><span class="content">org.mycomp.package2</span><span class="delimiter">'</span></span>
        instruction <span class="string"><span class="delimiter">'</span><span class="content">Bundle-Vendor</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">MyCompany</span><span class="delimiter">'</span></span>
        instruction <span class="string"><span class="delimiter">'</span><span class="content">Bundle-Description</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Platform2: Metrics 2 Measures Framework</span><span class="delimiter">'</span></span>
        instruction <span class="string"><span class="delimiter">'</span><span class="content">Bundle-DocURL</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">http://www.mycompany.com</span><span class="delimiter">'</span></span>
    }
}
task fooJar(<span class="key">type</span>: Jar) {
    manifest = osgiManifest {
        instruction <span class="string"><span class="delimiter">'</span><span class="content">Bundle-Vendor</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">MyCompany</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first argument of the instruction call is the key of the property. The other arguments form the value. To learn more about the available instructions have a look at the <a href="http://bnd.bndtools.org/">BND tool</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pmd_plugin"><a class="anchor" href="#pmd_plugin"></a><a class="link" href="#pmd_plugin">The PMD Plugin</a></h3>
<div class="paragraph">
<p>The PMD plugin performs quality checks on your project&#8217;s Java source files using <a href="http://pmd.sourceforge.net">PMD</a> and generates reports from these checks.</p>
</div>
<div class="sect3">
<h4 id="sec:pmd_usage"><a class="anchor" href="#sec:pmd_usage"></a><a class="link" href="#sec:pmd_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the PMD plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_pmd_plugin"><a class="anchor" href="#example_using_the_pmd_plugin"></a><a class="link" href="#example_using_the_pmd_plugin">Example: Using the PMD plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">pmd</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The plugin adds a number of tasks to the project that perform the quality checks. You can execute the checks by running <code>gradle check</code>.</p>
</div>
<div class="paragraph">
<p>Note that PMD will run with the same Java version used to run Gradle.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:pmd_tasks"><a class="anchor" href="#sec:pmd_tasks"></a><a class="link" href="#sec:pmd_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The PMD plugin adds the following tasks to the project:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>pmdMain</code>  <a href="../dsl/org.gradle.api.plugins.quality.Pmd.html">Pmd</a></dt>
<dd>
<div class="paragraph">
<p>Runs PMD against the production Java source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>pmdTest</code>  <a href="../dsl/org.gradle.api.plugins.quality.Pmd.html">Pmd</a></dt>
<dd>
<div class="paragraph">
<p>Runs PMD against the test Java source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>pmd<em>SourceSet</em></code>  <a href="../dsl/org.gradle.api.plugins.quality.Pmd.html">Pmd</a></dt>
<dd>
<div class="paragraph">
<p>Runs PMD against the given source set&#8217;s Java source files.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The PMD plugin adds the following dependencies to tasks defined by the Java plugin.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 29. PMD plugin - additional task dependencies</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Task name</th>
<th class="tableblock halign-left valign-top">Depends on</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>check</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All PMD tasks, including <code>pmdMain</code> and <code>pmdTest</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:pmd_dependency_management"><a class="anchor" href="#sec:pmd_dependency_management"></a><a class="link" href="#sec:pmd_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>The PMD plugin adds the following dependency configurations:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 30. PMD plugin - dependency configurations</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pmd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The PMD libraries to use</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:pmd_configuration"><a class="anchor" href="#sec:pmd_configuration"></a><a class="link" href="#sec:pmd_configuration">Configuration</a></h4>
<div class="paragraph">
<p>See the <a href="../dsl/org.gradle.api.plugins.quality.PmdExtension.html">PmdExtension</a> class in the API documentation.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="java_web_projects"><a class="anchor" href="#java_web_projects"></a><a class="link" href="#java_web_projects">Java Web Projects</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="ear_plugin"><a class="anchor" href="#ear_plugin"></a><a class="link" href="#ear_plugin">The Ear Plugin</a></h3>
<div class="paragraph">
<p>The Ear plugin adds support for assembling web application EAR files. It adds a default EAR archive task. It doesn&#8217;t require the Java plugin, but for projects that also use the Java plugin it disables the default JAR archive generation.</p>
</div>
<div class="sect3">
<h4 id="sec:ear_usage"><a class="anchor" href="#sec:ear_usage"></a><a class="link" href="#sec:ear_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Ear plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_ear_plugin"><a class="anchor" href="#example_using_the_ear_plugin"></a><a class="link" href="#example_using_the_ear_plugin">Example: Using the Ear plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">ear</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:ear_tasks"><a class="anchor" href="#sec:ear_tasks"></a><a class="link" href="#sec:ear_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Ear plugin adds the following tasks to the project.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ear</code>  <a href="../dsl/org.gradle.plugins.ear.Ear.html">Ear</a></dt>
<dd>
<p><em>Depends on</em>: <code>compile</code> (only if the Java plugin is also applied)</p>
<div class="paragraph">
<p>Assembles the application EAR file.</p>
</div>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="dependencies_added_to_other_tasks_3"><a class="anchor" href="#dependencies_added_to_other_tasks_3"></a><a class="link" href="#dependencies_added_to_other_tasks_3">Dependencies added to other tasks</a></h5>
<div class="paragraph">
<p>The Ear plugin adds the following dependencies to tasks added by the <a href="#base_plugin">Base Plugin</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>assemble</code></dt>
<dd>
<p><em>Depends on</em>: <code>ear</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:ear_project_layout"><a class="anchor" href="#sec:ear_project_layout"></a><a class="link" href="#sec:ear_project_layout">Project layout</a></h4>
<div class="listingblock">
<div class="content">
<pre>.
 src
     main
         application <b class="conum">(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Ear resources, such as a META-INF directory</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="sec:ear_dependency_management"><a class="anchor" href="#sec:ear_dependency_management"></a><a class="link" href="#sec:ear_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>The Ear plugin adds two dependency configurations: <code>deploy</code> and <code>earlib</code>. All dependencies in the <code>deploy</code> configuration are placed in the root of the EAR archive, and are <em>not</em> transitive. All dependencies in the <code>earlib</code> configuration are placed in the 'lib' directory in the EAR archive and <em>are</em> transitive.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:ear_convention_properties"><a class="anchor" href="#sec:ear_convention_properties"></a><a class="link" href="#sec:ear_convention_properties">Convention properties</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>appDirName</code>  <code>String</code></dt>
<dd>
<p>The name of the application source directory, relative to the project directory. <em>Default value: `src/main/application`</em>.</p>
</dd>
<dt class="hdlist1"><code>libDirName</code>  <code>String</code></dt>
<dd>
<p>The name of the lib directory inside the generated EAR. <em>Default value: `lib`</em>.</p>
</dd>
<dt class="hdlist1"><code>deploymentDescriptor</code>  <a href="../javadoc/org/gradle/plugins/ear/descriptor/DeploymentDescriptor.html">DeploymentDescriptor</a></dt>
<dd>
<p>Metadata to generate a deployment descriptor file, e.g. <code>application.xml</code>. <em>Default value: A deployment descriptor with sensible defaults named <code>application.xml`</em>. If this file already exists in the `appDirName/META-INF</code> then the existing file contents will be used and the explicit configuration in the <code>ear.deploymentDescriptor</code> will be ignored.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These properties are provided by a <a href="../dsl/org.gradle.plugins.ear.EarPluginConvention.html">EarPluginConvention</a> convention object.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:ear_default_settings"><a class="anchor" href="#sec:ear_default_settings"></a><a class="link" href="#sec:ear_default_settings">Ear</a></h4>
<div class="paragraph">
<p>The default behavior of the Ear task is to copy the content of <code>src/main/application</code> to the root of the archive. If your <code>application</code> directory doesn&#8217;t contain a <code>META-INF/application.xml</code> deployment descriptor then one will be generated for you.</p>
</div>
<div class="paragraph">
<p>The <a href="../dsl/org.gradle.plugins.ear.Ear.html">Ear</a> class in the API documentation has additional useful information.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:ear_customizing"><a class="anchor" href="#sec:ear_customizing"></a><a class="link" href="#sec:ear_customizing">Customizing</a></h4>
<div class="paragraph">
<p>Here is an example with the most important customization options:</p>
</div>
<div class="sect4">
<h5 id="example_customization_of_ear_plugin"><a class="anchor" href="#example_customization_of_ear_plugin"></a><a class="link" href="#example_customization_of_ear_plugin">Example: Customization of ear plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">ear</span><span class="delimiter">'</span></span>
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>

repositories { mavenCentral() }

dependencies {
    <span class="comment">// The following dependencies will be the ear modules and</span>
    <span class="comment">// will be placed in the ear root</span>
    deploy project(<span class="key">path</span>: <span class="string"><span class="delimiter">'</span><span class="content">:war</span><span class="delimiter">'</span></span>, <span class="key">configuration</span>: <span class="string"><span class="delimiter">'</span><span class="content">archives</span><span class="delimiter">'</span></span>)

    <span class="comment">// The following dependencies will become ear libs and will</span>
    <span class="comment">// be placed in a dir configured via the libDirName property</span>
    earlib <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">log4j</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">log4j</span><span class="delimiter">'</span></span>, <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">1.2.15</span><span class="delimiter">'</span></span>, <span class="key">ext</span>: <span class="string"><span class="delimiter">'</span><span class="content">jar</span><span class="delimiter">'</span></span>
}

ear {
    appDirName <span class="string"><span class="delimiter">'</span><span class="content">src/main/app</span><span class="delimiter">'</span></span>  <span class="comment">// use application metadata found in this folder</span>
    <span class="comment">// put dependent libraries into APP-INF/lib inside the generated EAR</span>
    libDirName <span class="string"><span class="delimiter">'</span><span class="content">APP-INF/lib</span><span class="delimiter">'</span></span>
    deploymentDescriptor {  <span class="comment">// custom entries for application.xml:</span>
<span class="comment">//      fileName = &quot;application.xml&quot;  // same as the default value</span>
<span class="comment">//      version = &quot;6&quot;  // same as the default value</span>
        applicationName = <span class="string"><span class="delimiter">&quot;</span><span class="content">customear</span><span class="delimiter">&quot;</span></span>
        initializeInOrder = <span class="predefined-constant">true</span>
        displayName = <span class="string"><span class="delimiter">&quot;</span><span class="content">Custom Ear</span><span class="delimiter">&quot;</span></span>  <span class="comment">// defaults to project.name</span>
        <span class="comment">// defaults to project.description if not set</span>
        description = <span class="string"><span class="delimiter">&quot;</span><span class="content">My customized EAR for the Gradle documentation</span><span class="delimiter">&quot;</span></span>
<span class="comment">//      libraryDirectory = &quot;APP-INF/lib&quot;  // not needed, above libDirName setting does this</span>
<span class="comment">//      module(&quot;my.jar&quot;, &quot;java&quot;)  // won't deploy as my.jar isn't deploy dependency</span>
<span class="comment">//      webModule(&quot;my.war&quot;, &quot;/&quot;)  // won't deploy as my.war isn't deploy dependency</span>
        securityRole <span class="string"><span class="delimiter">&quot;</span><span class="content">admin</span><span class="delimiter">&quot;</span></span>
        securityRole <span class="string"><span class="delimiter">&quot;</span><span class="content">superadmin</span><span class="delimiter">&quot;</span></span>
        withXml { provider -&gt; <span class="comment">// add a custom node to the XML</span>
            provider.asNode().appendNode(<span class="string"><span class="delimiter">&quot;</span><span class="content">data-source</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">my/data/source</span><span class="delimiter">&quot;</span></span>)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also use customization options that the <a href="../dsl/org.gradle.plugins.ear.Ear.html">Ear</a> task provides, such as <code>from</code> and <code>metaInf</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:using_custom_app_xml"><a class="anchor" href="#sec:using_custom_app_xml"></a><a class="link" href="#sec:using_custom_app_xml">Using custom descriptor file</a></h4>
<div class="paragraph">
<p>You may already have appropriate settings in a <code>application.xml</code> file and want to use that instead of configuring the <code>ear.deploymentDescriptor</code> section of the build script. To accommodate that goal, place the <code>META-INF/application.xml</code> in the right place inside your source folders (see the <code>appDirName</code> property). The file contents will be used and the explicit configuration in the <code>ear.deploymentDescriptor</code> will be ignored.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="play_plugin"><a class="anchor" href="#play_plugin"></a><a class="link" href="#play_plugin">Building Play applications</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Support for building Play applications is currently <a href="#feature_lifecycle">incubating</a>. Please be aware that the DSL, APIs and other configuration may change in later Gradle versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://www.playframework.com/">Play</a> is a modern web application framework. The Play plugin adds support for building, testing and running Play applications with Gradle.</p>
</div>
<div class="paragraph">
<p>The Play plugin makes use of the Gradle <a href="#software_model">software model</a>.</p>
</div>
<div class="sect3">
<h4 id="sec:play_usage"><a class="anchor" href="#sec:play_usage"></a><a class="link" href="#sec:play_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Play plugin, include the following in your build script to apply the <code>play</code> plugin and add the Lightbend repositories:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_play_plugin"><a class="anchor" href="#example_using_the_play_plugin"></a><a class="link" href="#example_using_the_play_plugin">Example: Using the Play plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">play</span><span class="delimiter">'</span></span>
}

repositories {
    jcenter()
    maven {
        name <span class="string"><span class="delimiter">&quot;</span><span class="content">lightbend-maven-release</span><span class="delimiter">&quot;</span></span>
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">https://repo.lightbend.com/lightbend/maven-releases</span><span class="delimiter">&quot;</span></span>
    }
    ivy {
        name <span class="string"><span class="delimiter">&quot;</span><span class="content">lightbend-ivy-release</span><span class="delimiter">&quot;</span></span>
        url <span class="string"><span class="delimiter">&quot;</span><span class="content">https://repo.lightbend.com/lightbend/ivy-releases</span><span class="delimiter">&quot;</span></span>
        layout <span class="string"><span class="delimiter">&quot;</span><span class="content">ivy</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that defining the Lightbend repositories is necessary. In future versions of Gradle, this will be replaced with a more convenient syntax.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:play_limitations"><a class="anchor" href="#sec:play_limitations"></a><a class="link" href="#sec:play_limitations">Limitations</a></h4>
<div class="paragraph">
<p>The Play plugin currently has a few limitations.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle does not yet support aggregate reverse routes introduced in Play 2.4.x.</p>
</li>
<li>
<p>A given project may only define a single Play application. This means that a single project cannot build more than one Play application. However, a multi-project build can have many projects that each define their own Play application.</p>
</li>
<li>
<p>Play applications can only target a single platform (combination of Play, Scala and Java version) at a time. This means that it is currently not possible to define multiple variants of a Play application that, for example, produce jars for both Scala 2.10 and 2.11. This limitation may be lifted in future Gradle versions.</p>
</li>
<li>
<p>Support for generating IDE configurations for Play applications is limited to <a href="#idea_plugin">IDEA</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:play_software_model"><a class="anchor" href="#sec:play_software_model"></a><a class="link" href="#sec:play_software_model">Software Model</a></h4>
<div class="paragraph">
<p>The Play plugin uses a <em>software model</em> to describe a Play application and how to build it. The Play software model extends the base Gradle <a href="#software_model_concepts">software model</a> to add support for building Play applications. A Play application is represented by a <a href="../javadoc/org/gradle/play/PlayApplicationSpec.html">PlayApplicationSpec</a> component type. The plugin automatically creates a single <a href="../javadoc/org/gradle/play/PlayApplicationBinarySpec.html">PlayApplicationBinarySpec</a> instance when it is applied. Additional Play components cannot be added to a project.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/playPluginModel.png" alt="playPluginModel">
</div>
<div class="title">Figure 30. Play plugin - software model</div>
</div>
<div class="sect4">
<h5 id="sec:the_play_application_component"><a class="anchor" href="#sec:the_play_application_component"></a><a class="link" href="#sec:the_play_application_component">The Play application component</a></h5>
<div class="paragraph">
<p>A Play application component describes the application to be built and consists of several configuration elements. One type of element that describes the application are the source sets that define where the application controller, route, template and model class source files should be found. These source sets are logical groupings of files of a particular type and a default source set for each type is created when the <code>play</code> plugin is applied.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 31. Default Play source sets</caption>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Source Set</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Directory</th>
<th class="tableblock halign-left valign-top">Filters</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/language/java/JavaSourceSet.html">JavaSourceSet</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">app</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">**/*.java</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scala</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/language/scala/ScalaLanguageSourceSet.html">ScalaLanguageSourceSet</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">app</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">**/*.scala</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">routes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/language/routes/RoutesSourceSet.html">RoutesSourceSet</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">conf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">routes, *.routes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">twirlTemplates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/language/twirl/TwirlSourceSet.html">TwirlSourceSet</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">app</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">**/*.scala.*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">javaScript</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/language/javascript/JavaScriptSourceSet.html">JavaScriptSourceSet</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">app/assets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">**/*.js</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>These source sets can be configured or additional source sets can be added to the Play component. See <a href="#configuring_play">Configuring Play</a> for further information.</p>
</div>
<div class="paragraph">
<p>Another element of configuring a Play application is the <em>platform</em>. To build a Play application, Gradle needs to understand which versions of Play, Scala and Java to use. The Play component specifies this requirement as a <a href="../javadoc/org/gradle/play/platform/PlayPlatform.html">PlayPlatform</a>. If these values are not configured, a default version of Play, Scala and Java will be used. See <a href="#configuring_play_platform">Targeting a certain version of Play</a> for information on configuring the Play platform.</p>
</div>
<div class="paragraph">
<p>Note that only a single platform can be specified for a given Play component. This means that only a single version of Play, Scala and Java can be used to build a Play component. In other words, a Play component can only produce one set of outputs, and those outputs will be built using the versions specified by the platform configured on the component.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:the_play_application_binary"><a class="anchor" href="#sec:the_play_application_binary"></a><a class="link" href="#sec:the_play_application_binary">The Play application binary</a></h5>
<div class="paragraph">
<p>A Play application component is compiled and packaged to produce a set of outputs which are represented by a <a href="../javadoc/org/gradle/play/PlayApplicationBinarySpec.html">PlayApplicationBinarySpec</a>. The Play binary specifies the jar files produced by building the component as well as providing elements by which additional content can be added to those jar files. It also exposes the tasks involved in building the component and creating the binary.</p>
</div>
<div class="paragraph">
<p>See <a href="#configuring_play">Configuring Play</a> for examples of configuring the Play binary.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:play_project_layout"><a class="anchor" href="#sec:play_project_layout"></a><a class="link" href="#sec:play_project_layout">Project Layout</a></h4>
<div class="paragraph">
<p>The Play plugin follows the typical Play application layout. You can <a href="#configuring_play_sourcesets">configure source sets</a> to include additional directories or change the defaults.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> app                  Application source code.
  assets           Assets that require compilation.
   javascripts  JavaScript source code to be minified.
  controllers      Application controller source code.
  models           Application business source code.
  views            Application UI templates.
 build.gradle         Your project's build script.
 conf                 Main application configuration file and routes files.
 public               Public assets.
  images           Application image files.
  javascripts      Typically JavaScript source code.
  stylesheets      Typically CSS source code.
 test                 Test source code.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:play_tasks"><a class="anchor" href="#sec:play_tasks"></a><a class="link" href="#sec:play_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Play plugin hooks into the normal Gradle lifecycle tasks such as <code>assemble</code>, <code>check</code> and <code>build</code>, but it also adds several additional tasks which form the lifecycle of a Play project:</p>
</div>
<div class="sect4">
<h5 id="play_lifecycle_tasks"><a class="anchor" href="#play_lifecycle_tasks"></a><a class="link" href="#play_lifecycle_tasks">Play Plugin  lifecycle tasks</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>playBinary</code>  <a href="../dsl/org.gradle.api.Task.html">Task</a></dt>
<dd>
<p><em>Depends on</em>: All compile tasks for source sets added to the Play application.</p>
<div class="paragraph">
<p>Performs a build of just the Play application.</p>
</div>
</dd>
<dt class="hdlist1"><code>dist</code>  <a href="../dsl/org.gradle.api.Task.html">Task</a></dt>
<dd>
<p><em>Depends on</em>: <code>createPlayBinaryZipDist</code>, <code>createPlayBinaryTarDist</code></p>
<div class="paragraph">
<p>Assembles the Play distribution.</p>
</div>
</dd>
<dt class="hdlist1"><code>stage</code>  <a href="../dsl/org.gradle.api.Task.html">Task</a></dt>
<dd>
<p><em>Depends on</em>: <code>stagePlayBinaryDist</code></p>
<div class="paragraph">
<p>Stages the Play distribution.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The plugin also provides tasks for running, testing and packaging your Play application:</p>
</div>
</div>
<div class="sect4">
<h5 id="play_plugin_running_and_testing_tasks"><a class="anchor" href="#play_plugin_running_and_testing_tasks"></a><a class="link" href="#play_plugin_running_and_testing_tasks">Play Plugin  running and testing tasks</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>runPlayBinary</code>  <a href="../dsl/org.gradle.play.tasks.PlayRun.html">PlayRun</a></dt>
<dd>
<p><em>Depends on</em>: <code>playBinary</code> to build Play application.</p>
<div class="paragraph">
<p>Runs the Play application for local development. See <a href="#play_continuous_build">how this works with continuous build.</a></p>
</div>
</dd>
<dt class="hdlist1"><code>testPlayBinary</code>  <a href="../dsl/org.gradle.api.tasks.testing.Test.html">Test</a></dt>
<dd>
<p><em>Depends on</em>: <code>playBinary</code> to build Play application and <code>compilePlayBinaryTests</code>.</p>
<div class="paragraph">
<p>Runs JUnit/TestNG tests for the Play application.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For the different types of sources in a Play application, the plugin adds the following compilation tasks:</p>
</div>
</div>
<div class="sect4">
<h5 id="play_source_set_tasks"><a class="anchor" href="#play_source_set_tasks"></a><a class="link" href="#play_source_set_tasks">Play Plugin  source set tasks</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>compilePlayBinaryScala</code>  <a href="../javadoc/org/gradle/language/scala/tasks/PlatformScalaCompile.html">PlatformScalaCompile</a></dt>
<dd>
<p><em>Depends on</em>: Scala and Java</p>
<div class="paragraph">
<p>Compiles all Scala and Java sources defined by the Play application.</p>
</div>
</dd>
<dt class="hdlist1"><code>compilePlayBinaryPlayTwirlTemplates</code>  <a href="../dsl/org.gradle.play.tasks.TwirlCompile.html">TwirlCompile</a></dt>
<dd>
<p><em>Depends on</em>: Twirl templates</p>
<div class="paragraph">
<p>Compiles Twirl templates with the Twirl compiler. Gradle supports all of the built-in Twirl template formats (HTML, XML, TXT and JavaScript). Twirl templates need to match the pattern <code>*.scala.*</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>compilePlayBinaryPlayRoutes</code>  <a href="../dsl/org.gradle.play.tasks.RoutesCompile.html">RoutesCompile</a></dt>
<dd>
<p><em>Depends on</em>: Play Route files</p>
<div class="paragraph">
<p>Compiles routes files into Scala sources.</p>
</div>
</dd>
<dt class="hdlist1"><code>minifyPlayBinaryJavaScript</code>  <a href="../dsl/org.gradle.play.tasks.JavaScriptMinify.html">JavaScriptMinify</a></dt>
<dd>
<p><em>Depends on</em>: JavaScript files</p>
<div class="paragraph">
<p>Minifies JavaScript files with the Google Closure compiler.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:play_finding_out_more_about_your_project"><a class="anchor" href="#sec:play_finding_out_more_about_your_project"></a><a class="link" href="#sec:play_finding_out_more_about_your_project">Finding out more about your project</a></h4>
<div class="paragraph">
<p>Gradle provides a report that you can run from the command-line that shows some details about the components and binaries that your project produces. To use this report, just run <code>gradle components</code>. Below is an example of running this report for one of the sample projects:</p>
</div>
<div class="sect4">
<h5 id="example_the_components_report_2"><a class="anchor" href="#example_the_components_report_2"></a><a class="link" href="#example_the_components_report_2">Example: The components report</a></h5>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle components</code></strong></div>
<div class="content">
<pre>&gt; gradle components

&gt; Task :components

------------------------------------------------------------
Root project
------------------------------------------------------------

Play Application 'play'
-----------------------

Source sets
    Java source 'play:java'
        srcDir: app
        includes: **/*.java
    JavaScript source 'play:javaScript'
        srcDir: app/assets
        includes: **/*.js
    JVM resources 'play:resources'
        srcDir: conf
    Routes source 'play:routes'
        srcDir: conf
        includes: routes, *.routes
    Scala source 'play:scala'
        srcDir: app
        includes: **/*.scala
    Twirl template source 'play:twirlTemplates'
        srcDir: app
        includes: **/*.scala.*

Binaries
    Play Application Jar 'play:binary'
        build using task: :playBinary
        target platform: Play Platform (Play 2.6.15, Scala: 2.12, Java: Java SE 8)
        toolchain: Default Play Toolchain
        classes dir: build/playBinary/classes
        resources dir: build/playBinary/resources
        JAR file: build/playBinary/lib/basic.jar

Note: currently not all plugins register their components, so some components may not be visible here.

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="play_continuous_build"><a class="anchor" href="#play_continuous_build"></a><a class="link" href="#play_continuous_build">Running a Play application</a></h4>
<div class="paragraph">
<p>The <code>runPlayBinary</code> task starts the Play application under development. During development it is beneficial to execute this task as a <a href="#sec:continuous_build">continuous build</a>. Continuous build is a generic feature that supports automatically re-running a build when inputs change. The <code>runPlayBinary</code> task is continuous build awarein that it behaves differently when run as part of a continuous build.</p>
</div>
<div class="paragraph">
<p>When not run as part of a continuous build, the <code>runPlayBinary</code> task will <em>block</em> the build. That is, the task will not complete as long as the application is running. When running as part of a continuous build, the task will start the application if not running and otherwise propagate any changes to the code of the application to the running instance. This is useful for quickly iterating on your Play application with an edit-&gt;rebuild-&gt;refresh cycle. Changes to your application will not take affect until the end of the overall build.</p>
</div>
<div class="paragraph">
<p>To enable continuous build, run Gradle with <code>-t runPlayBinary</code> or <code>--continuous runPlayBinary</code>.</p>
</div>
<div class="paragraph">
<p>Users of Play used to such a workflow with Play&#8217;s default build system should note that compile errors are handled differently. If a build failure occurs during a continuous build, the Play application will not be reloaded. Instead, you will be presented with an exception message. The exception message will only contain the overall cause of the build failure. More detailed information will only be available from the console.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuring_play"><a class="anchor" href="#configuring_play"></a><a class="link" href="#configuring_play">Configuring a Play application</a></h4>
<div class="sect4">
<h5 id="configuring_play_platform"><a class="anchor" href="#configuring_play_platform"></a><a class="link" href="#configuring_play_platform">Targeting a certain version of Play</a></h5>
<div class="paragraph">
<p>By default, Gradle uses Play 2.6.15, Scala 2.12 and the version of Java used to start the build. A Play application can select a different version by specifying a target <a href="../dsl/org.gradle.play.PlayApplicationSpec.html#org.gradle.play.PlayApplicationSpec:platform(java.lang.Object)">PlayApplicationSpec.platform(java.lang.Object)</a> on the Play application component.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_selecting_a_version_of_the_play_framework"><a class="anchor" href="#example_selecting_a_version_of_the_play_framework"></a><a class="link" href="#example_selecting_a_version_of_the_play_framework">Example: Selecting a version of the Play Framework</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        play {
            platform <span class="key">play</span>: <span class="string"><span class="delimiter">'</span><span class="content">2.6.15</span><span class="delimiter">'</span></span>, <span class="key">scala</span>: <span class="string"><span class="delimiter">'</span><span class="content">2.12</span><span class="delimiter">'</span></span>, <span class="key">java</span>: <span class="string"><span class="delimiter">'</span><span class="content">1.8</span><span class="delimiter">'</span></span>
            injectedRoutesGenerator = <span class="predefined-constant">true</span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following versions of Play and Scala are supported:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 32. Play supported versions</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Play</th>
<th class="tableblock halign-left valign-top">Scala</th>
<th class="tableblock halign-left valign-top">Java</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.6.x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11 and 2.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5.x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.4.x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10 and 2.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3.x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10 and 2.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6, 1.7 and 1.8</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="sec:adding_dependencies"><a class="anchor" href="#sec:adding_dependencies"></a><a class="link" href="#sec:adding_dependencies">Adding dependencies</a></h5>
<div class="paragraph">
<p>You can add compile, test and runtime dependencies to a Play application through <a href="../dsl/org.gradle.api.artifacts.Configuration.html">Configuration</a> created by the Play plugin.</p>
</div>
<div class="paragraph">
<p>If you are coming from SBT, the Play SBT plugin provides short names for common dependencies. For instance, if your project has a dependency on <code>ws</code>, you will need to add a dependency to <code>com.typesafe.play:play-ws_2.11:2.3.9</code> where <code>2.11</code> is your Scala version and <code>2.3.9</code> is your Play framework version.</p>
</div>
<div class="paragraph">
<p>Other dependencies that have short names, such as <code>jacksons</code> may actually be multiple dependencies. For those dependencies, you will need to work out the dependency coordinates from a dependency report.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>play</code> is used for compile time dependencies.</p>
</li>
<li>
<p><code>playTest</code> is used for test compile time dependencies.</p>
</li>
<li>
<p><code>playRun</code> is used for run time dependencies.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_dependencies_to_a_play_application"><a class="anchor" href="#example_adding_dependencies_to_a_play_application"></a><a class="link" href="#example_adding_dependencies_to_a_play_application">Example: Adding dependencies to a Play application</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    play <span class="string"><span class="delimiter">&quot;</span><span class="content">commons-lang:commons-lang:2.6</span><span class="delimiter">&quot;</span></span>
    play <span class="string"><span class="delimiter">&quot;</span><span class="content">com.typesafe.play:play-guice_2.12:2.6.15</span><span class="delimiter">&quot;</span></span>
    play <span class="string"><span class="delimiter">&quot;</span><span class="content">ch.qos.logback:logback-classic:1.2.3</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Play 2.6 has a more modular architecture and, because of that, you may need to add some dependencies manually. For example, <a href="https://playframework.com/documentation/2.6.x/Migration26#Guice-DI-support-moved-to-separate-module">Guice support was moved to a separated module</a>. Considering the following definition for a Play 2.6 project:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_play_2_6_project"><a class="anchor" href="#example_a_play_2_6_project"></a><a class="link" href="#example_a_play_2_6_project">Example: A Play 2.6 project</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        play {
            platform <span class="key">play</span>: <span class="string"><span class="delimiter">'</span><span class="content">2.6.7</span><span class="delimiter">'</span></span>, <span class="key">scala</span>: <span class="string"><span class="delimiter">'</span><span class="content">2.12</span><span class="delimiter">'</span></span>, <span class="key">java</span>: <span class="string"><span class="delimiter">'</span><span class="content">1.8</span><span class="delimiter">'</span></span>
            injectedRoutesGenerator = <span class="predefined-constant">true</span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can add Guice dependency like:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_guice_dependency_in_play_2_6_project"><a class="anchor" href="#example_adding_guice_dependency_in_play_2_6_project"></a><a class="link" href="#example_adding_guice_dependency_in_play_2_6_project">Example: Adding Guice dependency in Play 2.6 project</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    play <span class="string"><span class="delimiter">&quot;</span><span class="content">com.typesafe.play:play-guice_2.12:2.6.7</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course, pay attention to keep the Play version and Scala version for the dependency consistent with the platform versions.</p>
</div>
</div>
<div class="sect4">
<h5 id="configuring_play_sourcesets"><a class="anchor" href="#configuring_play_sourcesets"></a><a class="link" href="#configuring_play_sourcesets">Configuring the default source sets</a></h5>
<div class="paragraph">
<p>You can further configure the default source sets to do things like add new directories, add filters, etc.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_extra_source_sets_to_a_play_application"><a class="anchor" href="#example_configuring_extra_source_sets_to_a_play_application"></a><a class="link" href="#example_configuring_extra_source_sets_to_a_play_application">Example: Configuring extra source sets to a Play application</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        play {
            sources {
                java {
                    source.srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">additional/java</span><span class="delimiter">&quot;</span></span>
                }
                javaScript {
                    source {
                        srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">additional/javascript</span><span class="delimiter">&quot;</span></span>
                        exclude <span class="string"><span class="delimiter">&quot;</span><span class="content">**/old_*.js</span><span class="delimiter">&quot;</span></span>
                    }
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:adding_extra_source_sets"><a class="anchor" href="#sec:adding_extra_source_sets"></a><a class="link" href="#sec:adding_extra_source_sets">Adding extra source sets</a></h5>
<div class="paragraph">
<p>If your Play application has additional sources that exist in non-standard directories, you can add extra source sets that Gradle will automatically add to the appropriate compile tasks.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_adding_extra_source_sets_to_a_play_application"><a class="anchor" href="#example_adding_extra_source_sets_to_a_play_application"></a><a class="link" href="#example_adding_extra_source_sets_to_a_play_application">Example: Adding extra source sets to a Play application</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        play {
            sources {
                extraJava(JavaSourceSet) {
                    source.srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">extra/java</span><span class="delimiter">&quot;</span></span>
                }
                extraTwirl(TwirlSourceSet) {
                    source.srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">extra/twirl</span><span class="delimiter">&quot;</span></span>
                }
                extraRoutes(RoutesSourceSet) {
                    source.srcDir <span class="string"><span class="delimiter">&quot;</span><span class="content">extra/routes</span><span class="delimiter">&quot;</span></span>
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:configuring_compiler_options"><a class="anchor" href="#sec:configuring_compiler_options"></a><a class="link" href="#sec:configuring_compiler_options">Configuring compiler options</a></h5>
<div class="paragraph">
<p>If your Play application requires additional Scala compiler flags, you can add these arguments directly to the Scala compiler task.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_scala_compiler_options"><a class="anchor" href="#example_configuring_scala_compiler_options"></a><a class="link" href="#example_configuring_scala_compiler_options">Example: Configuring Scala compiler options</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        play {
            binaries.all {
                tasks.withType(PlatformScalaCompile) {
                    scalaCompileOptions.additionalParameters = [<span class="string"><span class="delimiter">&quot;</span><span class="content">-feature</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">-language:implicitConversions</span><span class="delimiter">&quot;</span></span>]
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:configuring_routes_style"><a class="anchor" href="#sec:configuring_routes_style"></a><a class="link" href="#sec:configuring_routes_style">Configuring routes style</a></h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The injected router is only supported in Play Framework 2.4 or better.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If your Play application&#8217;s router uses dependency injection to access your controllers, you&#8217;ll need to configure your application to <em>not</em> use the default static router. Under the covers, the Play plugin is using the <code>InjectedRoutesGenerator</code> instead of the default <code>StaticRoutesGenerator</code> to generate the router classes.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_routes_style"><a class="anchor" href="#example_configuring_routes_style"></a><a class="link" href="#example_configuring_routes_style">Example: Configuring routes style</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        play {
            injectedRoutesGenerator = <span class="predefined-constant">true</span>
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:configuring_twirl_templates"><a class="anchor" href="#sec:configuring_twirl_templates"></a><a class="link" href="#sec:configuring_twirl_templates">Configuring Twirl templates</a></h5>
<div class="paragraph">
<p>A custom Twirl template format can be configured independently for each Twirl source set. See the <a href="../javadoc/org/gradle/language/twirl/TwirlSourceSet.html">TwirlSourceSet</a> for an example.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:injecting_a_custom_asset_pipeline"><a class="anchor" href="#sec:injecting_a_custom_asset_pipeline"></a><a class="link" href="#sec:injecting_a_custom_asset_pipeline">Injecting a custom asset pipeline</a></h5>
<div class="paragraph">
<p>Gradle Play support comes with a simplistic asset processing pipeline that minifies JavaScript assets. However, many organizations have their own custom pipeline for processing assets. You can easily hook the results of your pipeline into the Play binary by utilizing the <a href="../javadoc/org/gradle/play/PublicAssets.html">PublicAssets</a> property on the binary.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_configuring_a_custom_asset_pipeline"><a class="anchor" href="#example_configuring_a_custom_asset_pipeline"></a><a class="link" href="#example_configuring_a_custom_asset_pipeline">Example: Configuring a custom asset pipeline</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    components {
        play {
            binaries.all { binary -&gt;
                tasks.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">addCopyrightToPlay</span><span class="inline"><span class="inline-delimiter">${</span>binary.name.capitalize()<span class="inline-delimiter">}</span></span><span class="content">Assets</span><span class="delimiter">&quot;</span></span>, AddCopyrights) { copyrightTask -&gt;
                    source <span class="string"><span class="delimiter">&quot;</span><span class="content">raw-assets</span><span class="delimiter">&quot;</span></span>
                    copyrightFile = project.file(<span class="string"><span class="delimiter">'</span><span class="content">copyright.txt</span><span class="delimiter">'</span></span>)
                    destinationDir = project.file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>buildDir<span class="inline-delimiter">}</span></span><span class="content">/play</span><span class="inline"><span class="inline-delimiter">${</span>binary.name.capitalize()<span class="inline-delimiter">}</span></span><span class="content">/addCopyRights</span><span class="delimiter">&quot;</span></span>)

                    <span class="comment">// Hook this task into the binary</span>
                    binary.assets.addAssetDir destinationDir
                    binary.assets.builtBy copyrightTask
                }
            }
        }
    }
}

<span class="type">class</span> <span class="class">AddCopyrights</span> <span class="directive">extends</span> SourceTask {
    <span class="annotation">@InputFile</span>
    <span class="predefined-type">File</span> copyrightFile

    <span class="annotation">@OutputDirectory</span>
    <span class="predefined-type">File</span> destinationDir

    <span class="annotation">@TaskAction</span>
    <span class="type">void</span> generateAssets() {
        <span class="predefined-type">String</span> copyright = copyrightFile.text
        getSource().each { <span class="predefined-type">File</span> file -&gt;
            <span class="predefined-type">File</span> outputFile = <span class="keyword">new</span> <span class="predefined-type">File</span>(destinationDir, file.name)
            outputFile.text = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>copyright<span class="inline-delimiter">}</span></span><span class="char">\n</span><span class="inline"><span class="inline-delimiter">${</span>file.text<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:multiproject_play_applications"><a class="anchor" href="#sec:multiproject_play_applications"></a><a class="link" href="#sec:multiproject_play_applications">Multi-project Play applications</a></h4>
<div class="paragraph">
<p>Play applications can be built in multi-project builds as well. Simply apply the <code>play</code> plugin in the appropriate subprojects and create any project dependencies on the <code>play</code> configuration.</p>
</div>
<div class="sect4">
<h5 id="example_configuring_dependencies_on_play_subprojects"><a class="anchor" href="#example_configuring_dependencies_on_play_subprojects"></a><a class="link" href="#example_configuring_dependencies_on_play_subprojects">Example: Configuring dependencies on Play subprojects</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    play project(<span class="string"><span class="delimiter">&quot;</span><span class="content">:admin</span><span class="delimiter">&quot;</span></span>)
    play project(<span class="string"><span class="delimiter">&quot;</span><span class="content">:user</span><span class="delimiter">&quot;</span></span>)
    play project(<span class="string"><span class="delimiter">&quot;</span><span class="content">:util</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <code>play/multiproject</code> sample provided in the Gradle distribution for a working example.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="packaging_play_distribution"><a class="anchor" href="#packaging_play_distribution"></a><a class="link" href="#packaging_play_distribution">Packaging a Play application for distribution</a></h4>
<div class="paragraph">
<p>Gradle provides the capability to package your Play application so that it can easily be distributed and run in a target environment. The distribution package (zip file) contains the Play binary jars, all dependencies, and generated scripts that set up the classpath and run the application in a Play-specific <a href="http://netty.io">Netty</a> container.</p>
</div>
<div class="paragraph">
<p>The distribution can be created by running the <code>dist</code> lifecycle task and places the distribution in the <code>$buildDir/distributions</code> directory. Alternatively, one can validate the contents by running the <code>stage</code> lifecycle task which copies the files to the <code>$buildDir/stage</code> directory using the layout of the distribution package.</p>
</div>
<div class="sect4">
<h5 id="play_plugin_distribution_tasks"><a class="anchor" href="#play_plugin_distribution_tasks"></a><a class="link" href="#play_plugin_distribution_tasks">Play Plugin  distribution tasks</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>createPlayBinaryStartScripts</code>  <a href="../javadoc/org/gradle/api/tasks/application/CreateStartScripts.html">CreateStartScripts</a></dt>
<dd>
<div class="paragraph">
<p>Generates scripts to run the Play application distribution.</p>
</div>
</dd>
<dt class="hdlist1"><code>stagePlayBinaryDist</code>  <a href="../dsl/org.gradle.api.tasks.Copy.html">Copy</a></dt>
<dd>
<p><em>Depends on</em>: <code>playBinary</code>, <code>createPlayBinaryStartScripts</code></p>
<div class="paragraph">
<p>Copies all jar files, dependencies and scripts into a staging directory.</p>
</div>
</dd>
<dt class="hdlist1"><code>createPlayBinaryZipDist</code>  <a href="../dsl/org.gradle.api.tasks.bundling.Zip.html">Zip</a></dt>
<dd>
<div class="paragraph">
<p>Bundles the Play application as a standalone distribution packaged as a zip.</p>
</div>
</dd>
<dt class="hdlist1"><code>createPlayBinaryTarDist</code>  <a href="../dsl/org.gradle.api.tasks.bundling.Tar.html">Tar</a></dt>
<dd>
<div class="paragraph">
<p>Bundles the Play application as a standalone distribution packaged as a tar.</p>
</div>
</dd>
<dt class="hdlist1"><code>stage</code>  <a href="../dsl/org.gradle.api.Task.html">Task</a></dt>
<dd>
<p><em>Depends on</em>: <code>stagePlayBinaryDist</code></p>
<div class="paragraph">
<p>Lifecycle task for staging a Play distribution.</p>
</div>
</dd>
<dt class="hdlist1"><code>dist</code>  <a href="../dsl/org.gradle.api.Task.html">Task</a></dt>
<dd>
<p><em>Depends on</em>: <code>createPlayBinaryZipDist</code>, <code>createPlayBinaryTarDist</code></p>
<div class="paragraph">
<p>Lifecycle task for creating a Play distribution.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="adding_files_to_play_distribution"><a class="anchor" href="#adding_files_to_play_distribution"></a><a class="link" href="#adding_files_to_play_distribution">Adding additional files to your Play application distribution</a></h5>
<div class="paragraph">
<p>You can add additional files to the distribution package using the <a href="../javadoc/org/gradle/api/distribution/Distribution.html">Distribution</a> API.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_add_extra_files_to_a_play_application_distribution"><a class="anchor" href="#example_add_extra_files_to_a_play_application_distribution"></a><a class="link" href="#example_add_extra_files_to_a_play_application_distribution">Example: Add extra files to a Play application distribution</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    distributions {
        playBinary {
            contents {
                from(<span class="string"><span class="delimiter">&quot;</span><span class="content">README.md</span><span class="delimiter">&quot;</span></span>)
                from(<span class="string"><span class="delimiter">&quot;</span><span class="content">scripts</span><span class="delimiter">&quot;</span></span>) {
                    into <span class="string"><span class="delimiter">&quot;</span><span class="content">bin</span><span class="delimiter">&quot;</span></span>
                }
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="play_ide"><a class="anchor" href="#play_ide"></a><a class="link" href="#play_ide">Building a Play application with an IDE</a></h4>
<div class="paragraph">
<p>If you want to generate IDE metadata configuration for your Play project, you need to apply the appropriate IDE plugin. Gradle supports generating IDE metadata for IDEA only for Play projects at this time.</p>
</div>
<div class="paragraph">
<p>To generate IDEA&#8217;s metadata, apply the <code>idea</code> plugin along with the <code>play</code> plugin.</p>
</div>
<div class="sect4">
<h5 id="example_applying_both_the_play_and_idea_plugins"><a class="anchor" href="#example_applying_both_the_play_and_idea_plugins"></a><a class="link" href="#example_applying_both_the_play_and_idea_plugins">Example: Applying both the Play and IDEA plugins</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">play</span><span class="delimiter">'</span></span>
    id <span class="string"><span class="delimiter">'</span><span class="content">idea</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Source code generated by routes and Twirl templates cannot be generated by IDEA directly, so changes made to those files will not affect compilation until the next Gradle build. You can run the Play application with Gradle in <a href="#sec:continuous_build">continuous build</a> to automatically rebuild and reload the application whenever something changes.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:play_resources"><a class="anchor" href="#sec:play_resources"></a><a class="link" href="#sec:play_resources">Resources</a></h4>
<div class="paragraph">
<p>For additional information about developing Play applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Play types in the Gradle DSL Guide:</p>
<div class="ulist">
<ul>
<li>
<p><a href="../javadoc/org/gradle/play/PlayApplicationBinarySpec.html">PlayApplicationBinarySpec</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/play/PlayApplicationSpec.html">PlayApplicationSpec</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/play/platform/PlayPlatform.html">PlayPlatform</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/play/JvmClasses.html">JvmClasses</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/play/PublicAssets.html">PublicAssets</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/play/distribution/PlayDistributionContainer.html">PlayDistributionContainer</a></p>
</li>
<li>
<p><a href="../dsl/org.gradle.play.tasks.JavaScriptMinify.html">JavaScriptMinify</a></p>
</li>
<li>
<p><a href="../dsl/org.gradle.play.tasks.PlayRun.html">PlayRun</a></p>
</li>
<li>
<p><a href="../dsl/org.gradle.play.tasks.RoutesCompile.html">RoutesCompile</a></p>
</li>
<li>
<p><a href="../dsl/org.gradle.play.tasks.TwirlCompile.html">TwirlCompile</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://www.playframework.com/documentation">Play Framework Documentation</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="war_plugin"><a class="anchor" href="#war_plugin"></a><a class="link" href="#war_plugin">The War Plugin</a></h3>
<div class="paragraph">
<p>The War plugin extends the Java plugin to add support for assembling web application WAR files. It disables the default JAR archive generation of the Java plugin and adds a default WAR archive task.</p>
</div>
<div class="sect3">
<h4 id="sec:war_usage"><a class="anchor" href="#sec:war_usage"></a><a class="link" href="#sec:war_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the War plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_war_plugin"><a class="anchor" href="#example_using_the_war_plugin"></a><a class="link" href="#example_using_the_war_plugin">Example: Using the War plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">war</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:war_project_layout"><a class="anchor" href="#sec:war_project_layout"></a><a class="link" href="#sec:war_project_layout">Project layout</a></h4>
<div class="paragraph">
<p>In addition to the <a href="#sec:java_project_layout">standard Java project layout</a>, the War Plugin adds:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/main/webapp</code></dt>
<dd>
<p>Web application sources</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:war_tasks"><a class="anchor" href="#sec:war_tasks"></a><a class="link" href="#sec:war_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The War plugin adds and modifies the following tasks:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>war</code>  <a href="../dsl/org.gradle.api.tasks.bundling.War.html">War</a></dt>
<dd>
<p><em>Depends on</em>: <code>compile</code></p>
<div class="paragraph">
<p>Assembles the application WAR file.</p>
</div>
</dd>
<dt class="hdlist1"><code>assemble</code> - <em>lifecycle task</em></dt>
<dd>
<p><em>Depends on</em>: <code>war</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The War plugin adds the following dependencies to tasks added by the Java plugin;</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/warPluginTasks.png" alt="warPluginTasks">
</div>
<div class="title">Figure 31. War plugin - tasks</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:war_dependency_management"><a class="anchor" href="#sec:war_dependency_management"></a><a class="link" href="#sec:war_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>The War plugin adds two dependency configurations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>providedCompile</code></p>
</li>
<li>
<p><code>providedRuntime</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These two configurations have the same scope as the respective <code>compile</code> and <code>runtime</code> configurations, except that they are not added to the WAR archive.</p>
</div>
<div class="paragraph">
<p>It is important to note that these <code>provided</code> configurations work transitively. Let&#8217;s say you add <code>commons-httpclient:commons-httpclient:3.0</code> to any of the provided configurations. This dependency has a dependency on <code>commons-codec</code>. Because this is a provided configuration, this means that neither of these dependencies will be added to your WAR, even if the <code>commons-codec</code> library is an explicit dependency of your <code>compile</code> configuration. If you don&#8217;t want this transitive behavior, simply declare your <code>provided</code> dependencies like <code>commons-httpclient:commons-httpclient:3.0@jar</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:war_plugin_publishing"><a class="anchor" href="#sec:war_plugin_publishing"></a><a class="link" href="#sec:war_plugin_publishing">Publishing</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>components.web</code></dt>
<dd>
<p>A <a href="../javadoc/org/gradle/api/component/SoftwareComponent.html">SoftwareComponent</a> for <a href="#publishing_overview">publishing</a> the production WAR created by the <code>war</code> task.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:war_convention_properties"><a class="anchor" href="#sec:war_convention_properties"></a><a class="link" href="#sec:war_convention_properties">Convention properties</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>webAppDirName</code> <code>String</code></dt>
<dd>
<p><em>Default value</em>: <code>src/main/webapp</code></p>
<div class="paragraph">
<p>The name of the web application source directory, relative to the project directory.</p>
</div>
</dd>
<dt class="hdlist1"><code>webAppDir</code> (read-only) <code>File</code></dt>
<dd>
<p><em>Default value</em>: <code>$webAppDirName</code>, e.g. <em>src/main/webapp</em></p>
<div class="paragraph">
<p>The path to the web application source directory.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These properties are provided by a <a href="../dsl/org.gradle.api.plugins.WarPluginConvention.html">WarPluginConvention</a> object.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:war_default_settings"><a class="anchor" href="#sec:war_default_settings"></a><a class="link" href="#sec:war_default_settings">War</a></h4>
<div class="paragraph">
<p>The default behavior of the <code>War</code> task is to copy the content of <code>src/main/webapp</code> to the root of the archive. Your <code>webapp</code> directory may of course contain a <code>WEB-INF</code> sub-directory, which may contain a <code>web.xml</code> file. Your compiled classes are compiled to <code>WEB-INF/classes</code>. All the dependencies of the <code>runtime</code> <sup class="footnote">[<a id="_footnoteref_16" class="footnote" href="#_footnotedef_16" title="View footnote.">16</a>]</sup> configuration are copied to <code>WEB-INF/lib</code>.</p>
</div>
<div class="paragraph">
<p>The <a href="../dsl/org.gradle.api.tasks.bundling.War.html">War</a> class in the API documentation has additional useful information.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:war_customizing"><a class="anchor" href="#sec:war_customizing"></a><a class="link" href="#sec:war_customizing">Customizing</a></h4>
<div class="paragraph">
<p>Here is an example with the most important customization options:</p>
</div>
<div class="sect4">
<h5 id="example_customization_of_war_plugin"><a class="anchor" href="#example_customization_of_war_plugin"></a><a class="link" href="#example_customization_of_war_plugin">Example: Customization of war plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
   moreLibs
}

repositories {
   flatDir { dirs <span class="string"><span class="delimiter">&quot;</span><span class="content">lib</span><span class="delimiter">&quot;</span></span> }
   jcenter()
}

dependencies {
    compile module(<span class="string"><span class="delimiter">&quot;</span><span class="content">:compile:1.0</span><span class="delimiter">&quot;</span></span>) {
        dependency <span class="string"><span class="delimiter">&quot;</span><span class="content">:compile-transitive-1.0@jar</span><span class="delimiter">&quot;</span></span>
        dependency <span class="string"><span class="delimiter">&quot;</span><span class="content">:providedCompile-transitive:1.0@jar</span><span class="delimiter">&quot;</span></span>
    }
    providedCompile <span class="string"><span class="delimiter">&quot;</span><span class="content">javax.servlet:servlet-api:2.5</span><span class="delimiter">&quot;</span></span>
    providedCompile module(<span class="string"><span class="delimiter">&quot;</span><span class="content">:providedCompile:1.0</span><span class="delimiter">&quot;</span></span>) {
        dependency <span class="string"><span class="delimiter">&quot;</span><span class="content">:providedCompile-transitive:1.0@jar</span><span class="delimiter">&quot;</span></span>
    }
    runtime <span class="string"><span class="delimiter">&quot;</span><span class="content">:runtime:1.0</span><span class="delimiter">&quot;</span></span>
    providedRuntime <span class="string"><span class="delimiter">&quot;</span><span class="content">:providedRuntime:1.0@jar</span><span class="delimiter">&quot;</span></span>
    testCompile <span class="string"><span class="delimiter">&quot;</span><span class="content">junit:junit:4.12</span><span class="delimiter">&quot;</span></span>
    moreLibs <span class="string"><span class="delimiter">&quot;</span><span class="content">:otherLib:1.0</span><span class="delimiter">&quot;</span></span>
}

war {
    from <span class="string"><span class="delimiter">'</span><span class="content">src/rootContent</span><span class="delimiter">'</span></span> <span class="comment">// adds a file-set to the root of the archive</span>
    webInf { from <span class="string"><span class="delimiter">'</span><span class="content">src/additionalWebInf</span><span class="delimiter">'</span></span> } <span class="comment">// adds a file-set to the WEB-INF dir.</span>
    classpath fileTree(<span class="string"><span class="delimiter">'</span><span class="content">additionalLibs</span><span class="delimiter">'</span></span>) <span class="comment">// adds a file-set to the WEB-INF/lib dir.</span>
    classpath configurations.moreLibs <span class="comment">// adds a configuration to the WEB-INF/lib dir.</span>
    webXml = file(<span class="string"><span class="delimiter">'</span><span class="content">src/someWeb.xml</span><span class="delimiter">'</span></span>) <span class="comment">// copies a file to WEB-INF/web.xml</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course one can configure the different file-sets with a closure to define excludes and includes.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="scala_projects"><a class="anchor" href="#scala_projects"></a><a class="link" href="#scala_projects">Scala Projects</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="scala_plugin"><a class="anchor" href="#scala_plugin"></a><a class="link" href="#scala_plugin">The Scala Plugin</a></h3>
<div class="paragraph">
<p>The Scala plugin extends the Java plugin to add support for Scala projects. It can deal with Scala code, mixed Scala and Java code, and even pure Java code (although we don&#8217;t necessarily recommend to use it for the latter). The plugin supports <em>joint compilation</em>, which allows you to freely mix and match Scala and Java code, with dependencies in both directions. For example, a Scala class can extend a Java class that in turn extends a Scala class. This makes it possible to use the best language for the job, and to rewrite any class in the other language if needed.</p>
</div>
<div class="sect3">
<h4 id="sec:scala_usage"><a class="anchor" href="#sec:scala_usage"></a><a class="link" href="#sec:scala_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Scala plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_scala_plugin"><a class="anchor" href="#example_using_the_scala_plugin"></a><a class="link" href="#example_using_the_scala_plugin">Example: Using the Scala plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">scala</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_tasks"><a class="anchor" href="#sec:scala_tasks"></a><a class="link" href="#sec:scala_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Scala plugin adds the following tasks to the project.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>compileScala</code>  <a href="../dsl/org.gradle.api.tasks.scala.ScalaCompile.html">ScalaCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>compileJava</code></p>
<div class="paragraph">
<p>Compiles production Scala source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>compileTestScala</code>  <a href="../dsl/org.gradle.api.tasks.scala.ScalaCompile.html">ScalaCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>compileTestJava</code></p>
<div class="paragraph">
<p>Compiles test Scala source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>compile<em>SourceSet</em>Scala</code>  <a href="../dsl/org.gradle.api.tasks.scala.ScalaCompile.html">ScalaCompile</a></dt>
<dd>
<p><em>Depends on</em>: <code>compile<em>SourceSet</em>Java</code></p>
<div class="paragraph">
<p>Compiles the given source set&#8217;s Scala source files.</p>
</div>
</dd>
<dt class="hdlist1"><code>scaladoc</code>  <a href="../dsl/org.gradle.api.tasks.scala.ScalaDoc.html">ScalaDoc</a></dt>
<dd>
<div class="paragraph">
<p>Generates API documentation for the production Scala source files.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The Scala plugin adds the following dependencies to tasks added by the Java plugin.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 33. Scala plugin - additional task dependencies</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Task name</th>
<th class="tableblock halign-left valign-top">Depends on</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>classes</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>compileScala</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>testClasses</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>compileTestScala</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code><em>sourceSet</em>Classes</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>compile<em>SourceSet</em>Scala</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="img/scalaPluginTasks.png" alt="scalaPluginTasks">
</div>
<div class="title">Figure 32. Scala plugin - tasks</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_project_layout"><a class="anchor" href="#sec:scala_project_layout"></a><a class="link" href="#sec:scala_project_layout">Project layout</a></h4>
<div class="paragraph">
<p>The Scala plugin assumes the project layout shown below. All the Scala source directories can contain Scala <em>and</em> Java code. The Java source directories may only contain Java source code. None of these directories need to exist or have anything in them; the Scala plugin will simply compile whatever it finds.</p>
</div>
<div id="scalalayout" class="dlist">
<dl>
<dt class="hdlist1"><code>src/main/java</code></dt>
<dd>
<p>Production Java source.</p>
</dd>
<dt class="hdlist1"><code>src/main/resources</code></dt>
<dd>
<p>Production resources, such as XML and properties files.</p>
</dd>
<dt class="hdlist1"><code>src/main/scala</code></dt>
<dd>
<p>Production Scala source. May also contain Java source files for joint compilation.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/test/java</code></dt>
<dd>
<p>Test Java source.</p>
</dd>
<dt class="hdlist1"><code>src/test/resources</code></dt>
<dd>
<p>Test resources.</p>
</dd>
<dt class="hdlist1"><code>src/test/scala</code></dt>
<dd>
<p>Test Scala source. May also contain Java source files for joint compilation.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/java</code></dt>
<dd>
<p>Java source for the source set named <em>sourceSet</em>.</p>
</dd>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/resources</code></dt>
<dd>
<p>Resources for the source set named <em>sourceSet</em>.</p>
</dd>
<dt class="hdlist1"><code>src/<em>sourceSet</em>/scala</code></dt>
<dd>
<p>Scala source files for the given source set. May also contain Java source files for joint compilation.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="sec:changing_scala_project_layout"><a class="anchor" href="#sec:changing_scala_project_layout"></a><a class="link" href="#sec:changing_scala_project_layout">Changing the project layout</a></h5>
<div class="paragraph">
<p>Just like the Java plugin, the Scala plugin allows you to configure custom locations for Scala production and test source files.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_custom_scala_source_layout"><a class="anchor" href="#example_custom_scala_source_layout"></a><a class="link" href="#example_custom_scala_source_layout">Example: Custom Scala source layout</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sourceSets {
    main {
        scala {
            srcDirs = [<span class="string"><span class="delimiter">'</span><span class="content">src/scala</span><span class="delimiter">'</span></span>]
        }
    }
    test {
        scala {
            srcDirs = [<span class="string"><span class="delimiter">'</span><span class="content">test/scala</span><span class="delimiter">'</span></span>]
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_dependency_management"><a class="anchor" href="#sec:scala_dependency_management"></a><a class="link" href="#sec:scala_dependency_management">Dependency management</a></h4>
<div class="paragraph">
<p>Scala projects need to declare a <code>scala-library</code> dependency. This dependency will then be used on compile and runtime class paths. It will also be used to get hold of the Scala compiler and Scaladoc tool, respectively.<sup class="footnote">[<a id="_footnoteref_17" class="footnote" href="#_footnotedef_17" title="View footnote.">17</a>]</sup></p>
</div>
<div class="paragraph">
<p>If Scala is used for production code, the <code>scala-library</code> dependency should be added to the <code>compile</code> configuration:</p>
</div>
<div class="sect4">
<h5 id="example_declaring_a_scala_dependency_for_production_code"><a class="anchor" href="#example_declaring_a_scala_dependency_for_production_code"></a><a class="link" href="#example_declaring_a_scala_dependency_for_production_code">Example: Declaring a Scala dependency for production code</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    compile <span class="string"><span class="delimiter">'</span><span class="content">org.scala-lang:scala-library:2.11.12</span><span class="delimiter">'</span></span>
    testCompile <span class="string"><span class="delimiter">'</span><span class="content">org.scalatest:scalatest_2.11:3.0.0</span><span class="delimiter">'</span></span>
    testCompile <span class="string"><span class="delimiter">'</span><span class="content">junit:junit:4.12</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If Scala is only used for test code, the <code>scala-library</code> dependency should be added to the <code>testCompile</code> configuration:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_declaring_a_scala_dependency_for_test_code"><a class="anchor" href="#example_declaring_a_scala_dependency_for_test_code"></a><a class="link" href="#example_declaring_a_scala_dependency_for_test_code">Example: Declaring a Scala dependency for test code</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    testCompile <span class="string"><span class="delimiter">&quot;</span><span class="content">org.scala-lang:scala-library:2.11.1</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:configure_scala_classpath"><a class="anchor" href="#sec:configure_scala_classpath"></a><a class="link" href="#sec:configure_scala_classpath">Automatic configuration of scalaClasspath</a></h4>
<div class="paragraph">
<p>The <code>ScalaCompile</code> and <code>ScalaDoc</code> tasks consume Scala code in two ways: on their <code>classpath</code>, and on their <code>scalaClasspath</code>. The former is used to locate classes referenced by the source code, and will typically contain <code>scala-library</code> along with other libraries. The latter is used to load and execute the Scala compiler and Scaladoc tool, respectively, and should only contain the <code>scala-compiler</code> library and its dependencies.</p>
</div>
<div class="paragraph">
<p>Unless a task&#8217;s <code>scalaClasspath</code> is configured explicitly, the Scala (base) plugin will try to infer it from the task&#8217;s <code>classpath</code>. This is done as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a <code>scala-library</code> jar is found on <code>classpath</code>, and the project has at least one repository declared, a corresponding <code>scala-compiler</code> repository dependency will be added to <code>scalaClasspath</code>.</p>
</li>
<li>
<p>Otherwise, execution of the task will fail with a message saying that <code>scalaClasspath</code> could not be inferred.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:configure_zinc_compiler"><a class="anchor" href="#sec:configure_zinc_compiler"></a><a class="link" href="#sec:configure_zinc_compiler">Configuring the Zinc compiler</a></h4>
<div class="paragraph">
<p>The Scala plugin uses a configuration named <code>zinc</code> to resolve the <a href="https://github.com/typesafehub/zinc">Zinc compiler</a> and its dependencies. Gradle will provide a default version of Zinc, but if you need to use a particular Zinc version, you can add an explicit dependency like <code>com.typesafe.zinc:zinc:0.3.6</code> to the <code>zinc</code> configuration. Gradle supports version 0.3.0 of Zinc and above; however, due to a regression in the Zinc compiler, versions 0.3.2 through 0.3.5.2 cannot be used.</p>
</div>
<div class="sect4">
<h5 id="example_declaring_a_version_of_the_zinc_compiler_to_use"><a class="anchor" href="#example_declaring_a_version_of_the_zinc_compiler_to_use"></a><a class="link" href="#example_declaring_a_version_of_the_zinc_compiler_to_use">Example: Declaring a version of the Zinc compiler to use</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    zinc <span class="string"><span class="delimiter">'</span><span class="content">com.typesafe.zinc:zinc:0.3.9</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is important to take care when declaring your <code>scala-library</code> dependency. The Zinc compiler itself needs a compatible version of <code>scala-library</code> that may be different from the version required by your application. Gradle takes care of adding a compatible version of <code>scala-library</code> for you, but over-broad dependency resolution rules could force an incompatible version to be used instead.</p>
</div>
<div class="paragraph">
<p>For example, using <code>configurations.all</code> to force a particular version of <code>scala-library</code> would also override the version used by the Zinc compiler:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_forcing_a_scala_library_dependency_for_all_configurations"><a class="anchor" href="#example_forcing_a_scala_library_dependency_for_all_configurations"></a><a class="link" href="#example_forcing_a_scala_library_dependency_for_all_configurations">Example: Forcing a scala-library dependency for all configurations</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations.all {
    resolutionStrategy.force <span class="string"><span class="delimiter">&quot;</span><span class="content">org.scala-lang:scala-library:2.11.12</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The best way to avoid this problem is to be more selective when configuring the <code>scala-library</code> dependency (such as not using a <code>configuration.all</code> rule or using a conditional to prevent the rule from being applied to the <code>zinc</code> configuration). Sometimes this rule may come from a plugin or other code that you do not have control over. In such a case, you can force a correct version of the library on the <code>zinc</code> configuration only:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_forcing_a_scala_library_dependency_for_the_zinc_configuration"><a class="anchor" href="#example_forcing_a_scala_library_dependency_for_the_zinc_configuration"></a><a class="link" href="#example_forcing_a_scala_library_dependency_for_the_zinc_configuration">Example: Forcing a scala-library dependency for the zinc configuration</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations.zinc {
    resolutionStrategy.force <span class="string"><span class="delimiter">&quot;</span><span class="content">org.scala-lang:scala-library:2.10.5</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can diagnose problems with the version of the Zinc compiler selected by running <a href="#inspecting_dependencies">dependencyInsight</a> for the <code>zinc</code> configuration.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_convention_properties"><a class="anchor" href="#sec:scala_convention_properties"></a><a class="link" href="#sec:scala_convention_properties">Convention properties</a></h4>
<div class="paragraph">
<p>The Scala plugin does not add any convention properties to the project.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_source_set_properties"><a class="anchor" href="#sec:scala_source_set_properties"></a><a class="link" href="#sec:scala_source_set_properties">Source set properties</a></h4>
<div class="paragraph">
<p>The Scala plugin adds the following convention properties to each source set in the project. You can use these properties in your build script as though they were properties of the source set object.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>scala</code>  <a href="../dsl/org.gradle.api.file.SourceDirectorySet.html">SourceDirectorySet</a> (read-only)</dt>
<dd>
<p>The Scala source files of this source set. Contains all <code>.scala</code> and <code>.java</code> files found in the Scala source directories, and excludes all other types of files. <em>Default value:</em> non-null.</p>
</dd>
<dt class="hdlist1"><code>scala.srcDirs</code>  <code>Set&lt;File&gt;</code></dt>
<dd>
<p>The source directories containing the Scala source files of this source set. May also contain Java source files for joint compilation.
Can set using anything described in <a href="#sec:specifying_multiple_files">Understanding implicit conversion to file collections</a>.
<em>Default value:</em> <code>[<em>projectDir</em>/src/<em>name</em>/scala]</code>.</p>
</dd>
<dt class="hdlist1"><code>allScala</code>  <a href="../javadoc/org/gradle/api/file/FileTree.html">FileTree</a> (read-only)</dt>
<dd>
<p>All Scala source files of this source set. Contains only the <code>.scala</code> files found in the Scala source directories. <em>Default value:</em> non-null.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These convention properties are provided by a convention object of type <a href="../dsl/org.gradle.api.tasks.ScalaSourceSet.html">ScalaSourceSet</a>.</p>
</div>
<div class="paragraph">
<p>The Scala plugin also modifies some source set properties:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 34. Scala plugin - source set properties</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Change</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allJava</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds all <code>.java</code> files found in the Scala source directories.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds all source files found in the Scala source directories.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:scala_compiling_in_external_process"><a class="anchor" href="#sec:scala_compiling_in_external_process"></a><a class="link" href="#sec:scala_compiling_in_external_process">Compiling in external process</a></h4>
<div class="paragraph">
<p>Scala compilation takes place in an external process.</p>
</div>
<div class="paragraph">
<p>Memory settings for the external process default to the defaults of the JVM. To adjust memory settings, configure the <code>scalaCompileOptions.forkOptions</code> property as needed:</p>
</div>
<div class="sect4">
<h5 id="example_adjusting_memory_settings"><a class="anchor" href="#example_adjusting_memory_settings"></a><a class="link" href="#example_adjusting_memory_settings">Example: Adjusting memory settings</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.withType(ScalaCompile) {
    configure(scalaCompileOptions.forkOptions) {
        memoryMaximumSize = <span class="string"><span class="delimiter">'</span><span class="content">1g</span><span class="delimiter">'</span></span>
        jvmArgs = [<span class="string"><span class="delimiter">'</span><span class="content">-XX:MaxPermSize=512m</span><span class="delimiter">'</span></span>]
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_incremental_compilation"><a class="anchor" href="#sec:scala_incremental_compilation"></a><a class="link" href="#sec:scala_incremental_compilation">Incremental compilation</a></h4>
<div class="paragraph">
<p>By compiling only classes whose source code has changed since the previous compilation, and classes affected by these changes, incremental compilation can significantly reduce Scala compilation time. It is particularly effective when frequently compiling small code increments, as is often done at development time.</p>
</div>
<div class="paragraph">
<p>The Scala plugin defaults to incremental compilation by integrating with <a href="https://github.com/typesafehub/zinc">Zinc</a>, a standalone version of <a href="https://github.com/harrah/xsbt">sbt</a>'s incremental Scala compiler. If you want to disable the incremental compilation, set <code>force = true</code> in your build file:</p>
</div>
<div class="sect4">
<h5 id="example_forcing_all_code_to_be_compiled"><a class="anchor" href="#example_forcing_all_code_to_be_compiled"></a><a class="link" href="#example_forcing_all_code_to_be_compiled">Example: Forcing all code to be compiled</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.withType(ScalaCompile) {
    scalaCompileOptions.with {
        force = <span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Note:</em> This will only cause all classes to be recompiled if at least one input source file has changed. If there are no changes to the source files, the <code>compileScala</code> task will still be considered <code>UP-TO-DATE</code> as usual.</p>
</div>
<div class="paragraph">
<p>The Zinc-based Scala Compiler supports joint compilation of Java and Scala code. By default, all Java and Scala code under <code>src/main/scala</code> will participate in joint compilation. Even Java code will be compiled incrementally.</p>
</div>
<div class="paragraph">
<p>Incremental compilation requires dependency analysis of the source code. The results of this analysis are stored in the file designated by <code>scalaCompileOptions.incrementalOptions.analysisFile</code> (which has a sensible default). In a multi-project build, analysis files are passed on to downstream <code>ScalaCompile</code> tasks to enable incremental compilation across project boundaries. For <code>ScalaCompile</code> tasks added by the Scala plugin, no configuration is necessary to make this work. For other <code>ScalaCompile</code> tasks that you might add, the property <code>scalaCompileOptions.incrementalOptions.publishedCode</code> needs to be configured to point to the classes folder or Jar archive by which the code is passed on to compile class paths of downstream <code>ScalaCompile</code> tasks. Note that if <code>publishedCode</code> is not set correctly, downstream tasks may not recompile code affected by upstream changes, leading to incorrect compilation results.</p>
</div>
<div class="paragraph">
<p>Note that Zinc&#8217;s Nailgun based daemon mode is not supported. Instead, we plan to enhance Gradle&#8217;s own compiler daemon to stay alive across Gradle invocations, reusing the same Scala compiler. This is expected to yield another significant speedup for Scala compilation.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:scala_cross_compilation"><a class="anchor" href="#sec:scala_cross_compilation"></a><a class="link" href="#sec:scala_cross_compilation">Compiling and testing for Java 6 or Java 7</a></h4>
<div class="paragraph">
<p>The Scala compiler ignores Gradle&#8217;s <code>targetCompatibility</code> and <code>sourceCompatibility</code> settings. In Scala 2.11, the Scala compiler always compiles to Java 6 compatible bytecode. In Scala 2.12, the Scala compiler always compiles to Java 8 compatible bytecode. If you also have Java source, you can follow the same steps as for the <a href="#sec:java_cross_compilation">Java plugin</a> to ensure the correct Java compiler is used.</p>
</div>
<div class="sect4">
<h5 id="example_configure_java_6_build_for_scala"><a class="anchor" href="#example_configure_java_6_build_for_scala"></a><a class="link" href="#example_configure_java_6_build_for_scala">Example: Configure Java 6 build for Scala</a></h5>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># in $HOME/.gradle/gradle.properties
java6Home=/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">sourceCompatibility = <span class="float">1.6</span>

<span class="keyword">assert</span> hasProperty(<span class="string"><span class="delimiter">'</span><span class="content">java6Home</span><span class="delimiter">'</span></span>) : <span class="string"><span class="delimiter">&quot;</span><span class="content">Set the property 'java6Home' in your your gradle.properties pointing to a Java 6 installation</span><span class="delimiter">&quot;</span></span>
<span class="keyword">def</span> javaExecutablesPath = <span class="keyword">new</span> <span class="predefined-type">File</span>(java6Home, <span class="string"><span class="delimiter">'</span><span class="content">bin</span><span class="delimiter">'</span></span>)
<span class="keyword">def</span> javaExecutables = [:].withDefault { execName -&gt;
    <span class="keyword">def</span> executable = <span class="keyword">new</span> <span class="predefined-type">File</span>(javaExecutablesPath, execName)
    <span class="keyword">assert</span> executable.exists() : <span class="string"><span class="delimiter">&quot;</span><span class="content">There is no </span><span class="inline"><span class="inline-delimiter">${</span>execName<span class="inline-delimiter">}</span></span><span class="content"> executable in </span><span class="inline"><span class="inline-delimiter">${</span>javaExecutablesPath<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    executable
}

tasks.withType(AbstractCompile) {
    options.with {
        fork = <span class="predefined-constant">true</span>
        forkOptions.javaHome = file(java6Home)
    }
}
tasks.withType(Test) {
    executable = javaExecutables.java
}
tasks.withType(JavaExec) {
    executable = javaExecutables.java
}
tasks.withType(Javadoc) {
    executable = javaExecutables.javadoc
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:eclipse_integration"><a class="anchor" href="#sec:eclipse_integration"></a><a class="link" href="#sec:eclipse_integration">Eclipse Integration</a></h4>
<div class="paragraph">
<p>When the Eclipse plugin encounters a Scala project, it adds additional configuration to make the project work with Scala IDE out of the box. Specifically, the plugin adds a Scala nature and dependency container.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:intellij_idea_integration"><a class="anchor" href="#sec:intellij_idea_integration"></a><a class="link" href="#sec:intellij_idea_integration">IntelliJ IDEA Integration</a></h4>
<div class="paragraph">
<p>When the IDEA plugin encounters a Scala project, it adds additional configuration to make the project work with IDEA out of the box. Specifically, the plugin adds a Scala SDK (IntelliJ IDEA 14+) and a Scala compiler library that matches the Scala version on the project&#8217;s class path. The Scala plugin is backwards compatible with earlier versions of IntelliJ IDEA and it is possible to add a Scala facet instead of the default Scala SDK by configuring <code>targetVersion</code> on <a href="../dsl/org.gradle.plugins.ide.idea.model.IdeaModel.html">IdeaModel</a>.</p>
</div>
<div class="sect4">
<h5 id="example_explicitly_specify_a_target_intellij_idea_version"><a class="anchor" href="#example_explicitly_specify_a_target_intellij_idea_version"></a><a class="link" href="#example_explicitly_specify_a_target_intellij_idea_version">Example: Explicitly specify a target IntelliJ IDEA version</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">idea {
    targetVersion = <span class="string"><span class="delimiter">&quot;</span><span class="content">13</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="integrating_gradle"><a class="anchor" href="#integrating_gradle"></a><a class="link" href="#integrating_gradle">Integrating Gradle</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="eclipse_plugin"><a class="anchor" href="#eclipse_plugin"></a><a class="link" href="#eclipse_plugin">The Eclipse Plugins</a></h3>
<div class="paragraph">
<p>The Eclipse plugins generate files that are used by the <a href="http://eclipse.org">Eclipse IDE</a>, thus making it possible to import the project into Eclipse (<code>File</code> - <code>Import&#8230;&#8203;</code> - <code>Existing Projects into Workspace</code>).</p>
</div>
<div class="paragraph">
<p>The <code>eclipse-wtp</code> is automatically applied whenever the <code>eclipse</code> plugin is applied to a <a href="#war_plugin">War</a> or <a href="#ear_plugin">Ear</a> project. For utility projects (i.e. <a href="#java_plugin">Java</a> projects used by other web projects), you need to apply the <code>eclipse-wtp</code> plugin explicitly.</p>
</div>
<div class="paragraph">
<p>What exactly the <code>eclipse</code> plugin generates depends on which other plugins are used:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 35. Eclipse plugin behavior</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Plugin</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generates minimal <code>.project</code> file.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#java_plugin">Java</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds Java configuration to <code>.project</code>. Generates <code>.classpath</code> and JDT settings file.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#groovy_plugin">Groovy</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds Groovy configuration to <code>.project</code> file.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#scala_plugin">Scala</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds Scala support to <code>.project</code> and <code>.classpath</code> files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#war_plugin">War</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds web application support to <code>.project</code> file.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#ear_plugin">Ear</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds ear application support to <code>.project</code> file.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>eclipse-wtp</code> plugin generates all WTP settings files and enhances the <code>.project</code> file. If a <a href="#java_plugin">Java</a> or <a href="#war_plugin">War</a> is applied, <code>.classpath</code> will be extended to get a proper packaging structure for this utility library or web application project.</p>
</div>
<div class="paragraph">
<p>Both Eclipse plugins are open to customization and provide a standardized set of hooks for adding and removing content from the generated files.</p>
</div>
<div class="sect3">
<h4 id="sec:eclipse_usage"><a class="anchor" href="#sec:eclipse_usage"></a><a class="link" href="#sec:eclipse_usage">Usage</a></h4>
<div class="paragraph">
<p>To use either the Eclipse or the Eclipse WTP plugin, include one of the lines in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_eclipse_plugin"><a class="anchor" href="#example_using_the_eclipse_plugin"></a><a class="link" href="#example_using_the_eclipse_plugin">Example: Using the Eclipse plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">eclipse</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_using_the_eclipse_wtp_plugin"><a class="anchor" href="#example_using_the_eclipse_wtp_plugin"></a><a class="link" href="#example_using_the_eclipse_wtp_plugin">Example: Using the Eclipse WTP plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">eclipse-wtp</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Note:</em> Internally, the <code>eclipse-wtp</code> plugin also applies the <code>eclipse</code> plugin so you don&#8217;t need to apply both.</p>
</div>
<div class="paragraph">
<p>Both Eclipse plugins add a number of tasks to your projects. The main tasks that you will use are the <code>eclipse</code> and <code>cleanEclipse</code> tasks.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:eclipse_tasks"><a class="anchor" href="#sec:eclipse_tasks"></a><a class="link" href="#sec:eclipse_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The Eclipse plugins add the tasks shown below to a project.</p>
</div>
<div class="sect4">
<h5 id="eclipsetasks"><a class="anchor" href="#eclipsetasks"></a><a class="link" href="#eclipsetasks">Eclipse Plugin tasks</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>eclipse</code>  <a href="../dsl/org.gradle.api.Task.html">Task</a></dt>
<dd>
<p><em>Depends on</em>: all Eclipse configuration file generation tasks</p>
<div class="paragraph">
<p>Generates all Eclipse configuration files</p>
</div>
</dd>
<dt class="hdlist1"><code>cleanEclipse</code>  <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a></dt>
<dd>
<p><em>Depends on</em>: all Eclipse configuration file clean tasks</p>
<div class="paragraph">
<p>Removes all Eclipse configuration files</p>
</div>
</dd>
<dt class="hdlist1"><code>cleanEclipseProject</code>  <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a></dt>
<dd>
<div class="paragraph">
<p>Removes the <code>.project</code> file.</p>
</div>
</dd>
<dt class="hdlist1"><code>cleanEclipseClasspath</code>  <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a></dt>
<dd>
<div class="paragraph">
<p>Removes the <code>.classpath</code> file.</p>
</div>
</dd>
<dt class="hdlist1"><code>cleanEclipseJdt</code>  <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a></dt>
<dd>
<div class="paragraph">
<p>Removes the <code>.settings/org.eclipse.jdt.core.prefs</code> file.</p>
</div>
</dd>
<dt class="hdlist1"><code>eclipseProject</code>  <a href="../dsl/org.gradle.plugins.ide.eclipse.GenerateEclipseProject.html">GenerateEclipseProject</a></dt>
<dd>
<div class="paragraph">
<p>Generates the <code>.project</code> file.</p>
</div>
</dd>
<dt class="hdlist1"><code>eclipseClasspath</code>  <a href="../dsl/org.gradle.plugins.ide.eclipse.GenerateEclipseClasspath.html">GenerateEclipseClasspath</a></dt>
<dd>
<div class="paragraph">
<p>Generates the <code>.classpath</code> file.</p>
</div>
</dd>
<dt class="hdlist1"><code>eclipseJdt</code>  <a href="../dsl/org.gradle.plugins.ide.eclipse.GenerateEclipseJdt.html">GenerateEclipseJdt</a></dt>
<dd>
<div class="paragraph">
<p>Generates the <code>.settings/org.eclipse.jdt.core.prefs</code> file.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="eclipsewtptasks"><a class="anchor" href="#eclipsewtptasks"></a><a class="link" href="#eclipsewtptasks">Eclipse WTP Plugin  additional tasks</a></h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>cleanEclipseWtpComponent</code>  <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a></dt>
<dd>
<div class="paragraph">
<p>Removes the <code>.settings/org.eclipse.wst.common.component</code> file.</p>
</div>
</dd>
<dt class="hdlist1"><code>cleanEclipseWtpFacet</code>  <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a></dt>
<dd>
<div class="paragraph">
<p>Removes the <code>.settings/org.eclipse.wst.common.project.facet.core.xml</code> file.</p>
</div>
</dd>
<dt class="hdlist1"><code>eclipseWtpComponent</code>  <a href="../dsl/org.gradle.plugins.ide.eclipse.GenerateEclipseWtpComponent.html">GenerateEclipseWtpComponent</a></dt>
<dd>
<div class="paragraph">
<p>Generates the <code>.settings/org.eclipse.wst.common.component</code> file.</p>
</div>
</dd>
<dt class="hdlist1"><code>eclipseWtpFacet</code>  <a href="../dsl/org.gradle.plugins.ide.eclipse.GenerateEclipseWtpFacet.html">GenerateEclipseWtpFacet</a></dt>
<dd>
<div class="paragraph">
<p>Generates the <code>.settings/org.eclipse.wst.common.project.facet.core.xml</code> file.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:eclipse_configuration"><a class="anchor" href="#sec:eclipse_configuration"></a><a class="link" href="#sec:eclipse_configuration">Configuration</a></h4>
<table id="eclipse-configuration" class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 36. Configuration of the Eclipse plugins</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Model</th>
<th class="tableblock halign-left valign-top">Reference name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../dsl/org.gradle.plugins.ide.eclipse.model.EclipseModel.html">EclipseModel</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eclipse</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Top level element that enables configuration of the Eclipse plugin in a DSL-friendly fashion.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../dsl/org.gradle.plugins.ide.eclipse.model.EclipseProject.html">EclipseProject</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eclipse.project</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows configuring project information</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../dsl/org.gradle.plugins.ide.eclipse.model.EclipseClasspath.html">EclipseClasspath</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eclipse.classpath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows configuring classpath information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../dsl/org.gradle.plugins.ide.eclipse.model.EclipseJdt.html">EclipseJdt</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eclipse.jdt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows configuring jdt information (source/target Java compatibility).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../dsl/org.gradle.plugins.ide.eclipse.model.EclipseWtpComponent.html">EclipseWtpComponent</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eclipse.wtp.component</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows configuring wtp component information only if <code>eclipse-wtp</code> plugin was applied.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../dsl/org.gradle.plugins.ide.eclipse.model.EclipseWtpFacet.html">EclipseWtpFacet</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eclipse.wtp.facet</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows configuring wtp facet information only if <code>eclipse-wtp</code> plugin was applied.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="sec:eclipse_customizing_the_generated_files"><a class="anchor" href="#sec:eclipse_customizing_the_generated_files"></a><a class="link" href="#sec:eclipse_customizing_the_generated_files">Customizing the generated files</a></h4>
<div class="paragraph">
<p>The Eclipse plugins allow you to customize the generated metadata files. The plugins provide a DSL for configuring model objects that model the Eclipse view of the project. These model objects are then merged with the existing Eclipse XML metadata to ultimately generate new metadata. The model objects provide lower level hooks for working with domain objects representing the file content before and after merging with the model configuration. They also provide a very low level hook for working directly with the raw XML for adjustment before it is persisted, for fine tuning and configuration that the Eclipse and Eclipse WTP plugins do not model.</p>
</div>
<div class="sect4">
<h5 id="sec:merging_with_eclipse_files"><a class="anchor" href="#sec:merging_with_eclipse_files"></a><a class="link" href="#sec:merging_with_eclipse_files">Merging</a></h5>
<div class="paragraph">
<p>Sections of existing Eclipse files that are also the target of generated content will be amended or overwritten, depending on the particular section. The remaining sections will be left as-is.</p>
</div>
<div class="sect5">
<h6 id="sec:complete_rewrite_of_eclipse_files"><a class="anchor" href="#sec:complete_rewrite_of_eclipse_files"></a><a class="link" href="#sec:complete_rewrite_of_eclipse_files">Disabling merging with a complete rewrite</a></h6>
<div class="paragraph">
<p>To completely rewrite existing Eclipse files, execute a clean task together with its corresponding generation task, like <code>gradle cleanEclipse eclipse</code> (in that order). If you want to make this the default behavior, add <code>tasks.eclipse.dependsOn(cleanEclipse)</code> to your build script. This makes it unnecessary to execute the clean task explicitly.</p>
</div>
<div class="paragraph">
<p>This strategy can also be used for individual files that the plugins would generate. For instance, this can be done for the <code>.classpath</code> file with <code>gradle cleanEclipseClasspath eclipseClasspath</code>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:hooking_into_the_eclipse_generation_lifecycle"><a class="anchor" href="#sec:hooking_into_the_eclipse_generation_lifecycle"></a><a class="link" href="#sec:hooking_into_the_eclipse_generation_lifecycle">Hooking into the generation lifecycle</a></h5>
<div class="paragraph">
<p>The Eclipse plugins provide objects modeling the sections of the Eclipse files that are generated by Gradle. The generation lifecycle is as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The file is read; or a default version provided by Gradle is used if it does not exist</p>
</li>
<li>
<p>The <code>beforeMerged</code> hook is executed with a domain object representing the existing file</p>
</li>
<li>
<p>The existing content is merged with the configuration inferred from the Gradle build or defined explicitly in the eclipse DSL</p>
</li>
<li>
<p>The <code>whenMerged</code> hook is executed with a domain object representing contents of the file to be persisted</p>
</li>
<li>
<p>The <code>withXml</code> hook is executed with a raw representation of the XML that will be persisted</p>
</li>
<li>
<p>The final XML is persisted</p>
</li>
</ol>
</div>
<div class="sect5">
<h6 id="eclipse-plugin-hooks"><a class="anchor" href="#eclipse-plugin-hooks"></a><a class="link" href="#eclipse-plugin-hooks">Advanced configuration hooks</a></h6>
<div class="paragraph">
<p>The following list covers the domain object used for each of the Eclipse model types:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="../dsl/org.gradle.plugins.ide.eclipse.model.EclipseProject.html">EclipseProject</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>beforeMerged { <a href="../javadoc/org/gradle/plugins/ide/eclipse/model/Project.html">Project</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>whenMerged { <a href="../javadoc/org/gradle/plugins/ide/eclipse/model/Project.html">Project</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>withXml { <a href="../javadoc/org/gradle/api/XmlProvider.html">XmlProvider</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="../dsl/org.gradle.plugins.ide.eclipse.model.EclipseClasspath.html">EclipseClasspath</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>beforeMerged { <a href="../javadoc/org/gradle/plugins/ide/eclipse/model/Classpath.html">Classpath</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>whenMerged { <a href="../javadoc/org/gradle/plugins/ide/eclipse/model/Classpath.html">Classpath</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>withXml { <a href="../javadoc/org/gradle/api/XmlProvider.html">XmlProvider</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="../dsl/org.gradle.plugins.ide.eclipse.model.EclipseWtpComponent.html">EclipseWtpComponent</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>beforeMerged { <a href="../javadoc/org/gradle/plugins/ide/eclipse/model/WtpComponent.html">WtpComponent</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>whenMerged { <a href="../javadoc/org/gradle/plugins/ide/eclipse/model/WtpComponent.html">WtpComponent</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>withXml { <a href="../javadoc/org/gradle/api/XmlProvider.html">XmlProvider</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="../dsl/org.gradle.plugins.ide.eclipse.model.EclipseWtpFacet.html">EclipseWtpFacet</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>beforeMerged { <a href="../javadoc/org/gradle/plugins/ide/eclipse/model/WtpFacet.html">WtpFacet</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>whenMerged { <a href="../javadoc/org/gradle/plugins/ide/eclipse/model/WtpFacet.html">WtpFacet</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>withXml { <a href="../javadoc/org/gradle/api/XmlProvider.html">XmlProvider</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="../dsl/org.gradle.plugins.ide.eclipse.model.EclipseJdt.html">EclipseJdt</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>beforeMerged { <a href="../javadoc/org/gradle/plugins/ide/eclipse/model/Jdt.html">Jdt</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>whenMerged { <a href="../javadoc/org/gradle/plugins/ide/eclipse/model/Jdt.html">Jdt</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>withProperties { arg -&gt; }</code> argument type &#8658; <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Properties.html"><code>java.util.Properties</code></a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="sec:partial-overwrite"><a class="anchor" href="#sec:partial-overwrite"></a><a class="link" href="#sec:partial-overwrite">Partial overwrite of existing content</a></h6>
<div class="paragraph">
<p>A complete overwrite causes all existing content to be discarded, thereby losing any changes made directly in the IDE. Alternatively, the <code>beforeMerged</code> hook makes it possible to overwrite just certain parts of the existing content. The following example removes all existing dependencies from the <code>Classpath</code> domain object:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_partial_overwrite_for_classpath"><a class="anchor" href="#example_partial_overwrite_for_classpath"></a><a class="link" href="#example_partial_overwrite_for_classpath">Example: Partial Overwrite for Classpath</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">eclipse.classpath.file {
    beforeMerged { classpath -&gt;
        classpath.entries.removeAll { entry -&gt; entry.kind == <span class="string"><span class="delimiter">'</span><span class="content">lib</span><span class="delimiter">'</span></span> || entry.kind == <span class="string"><span class="delimiter">'</span><span class="content">var</span><span class="delimiter">'</span></span> }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting <code>.classpath</code> file will only contain Gradle-generated dependency entries, but not any other dependency entries that may have been present in the original file. (In the case of dependency entries, this is also the default behavior.) Other sections of the <code>.classpath</code> file will be either left as-is or merged. The same could be done for the natures in the <code>.project</code> file:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_partial_overwrite_for_project"><a class="anchor" href="#example_partial_overwrite_for_project"></a><a class="link" href="#example_partial_overwrite_for_project">Example: Partial Overwrite for Project</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">eclipse.project.file.beforeMerged { project -&gt;
    project.natures.clear()
}</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="sec:eclipse_modify_domain_objects"><a class="anchor" href="#sec:eclipse_modify_domain_objects"></a><a class="link" href="#sec:eclipse_modify_domain_objects">Modifying the fully populated domain objects</a></h6>
<div class="paragraph">
<p>The <code>whenMerged</code> hook allows to manipulate the fully populated domain objects. Often this is the preferred way to customize Eclipse files. Here is how you would export all the dependencies of an Eclipse project:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_export_classpath_entries"><a class="anchor" href="#example_export_classpath_entries"></a><a class="link" href="#example_export_classpath_entries">Example: Export Classpath Entries</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">eclipse.classpath.file {
    whenMerged { classpath -&gt;
        classpath.entries.findAll { entry -&gt; entry.kind == <span class="string"><span class="delimiter">'</span><span class="content">lib</span><span class="delimiter">'</span></span> }*.exported = <span class="predefined-constant">false</span>
    }
}</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="sec:eclipse_modify_xml"><a class="anchor" href="#sec:eclipse_modify_xml"></a><a class="link" href="#sec:eclipse_modify_xml">Modifying the XML representation</a></h6>
<div class="paragraph">
<p>The <code>withXml</code> hook allows to manipulate the in-memory XML representation just before the file gets written to disk. Although Groovy&#8217;s XML support makes up for a lot, this approach is less convenient than manipulating the domain objects. In return, you get total control over the generated file, including sections not modeled by the domain objects.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_customizing_the_xml"><a class="anchor" href="#example_customizing_the_xml"></a><a class="link" href="#example_customizing_the_xml">Example: Customizing the XML</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">eclipse-wtp</span><span class="delimiter">'</span></span>

eclipse.wtp.facet.file.withXml { provider -&gt;
    provider.asNode().fixed.find { <span class="local-variable">it</span>.@facet == <span class="string"><span class="delimiter">'</span><span class="content">jst.java</span><span class="delimiter">'</span></span> }.@facet = <span class="string"><span class="delimiter">'</span><span class="content">jst2.java</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="idea_plugin"><a class="anchor" href="#idea_plugin"></a><a class="link" href="#idea_plugin">The IDEA Plugin</a></h3>
<div class="paragraph">
<p>The IDEA plugin generates files that are used by <a href="http://www.jetbrains.com/idea/">IntelliJ IDEA</a>, thus making it possible to open the project from IDEA (<code>File</code> - <code>Open Project</code>). Both external dependencies (including associated source and Javadoc files) and project dependencies are considered.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you simply want to load a Gradle project into IntelliJ IDEA, then use the IDE&#8217;s <a href="https://www.jetbrains.com/help/idea/gradle.html#gradle_import">import facility</a>. You do not need to apply this plugin to import your project into IDEA, although if you do, the import will take account of any extra IDEA configuration you have that doesn&#8217;t directly modify the generated files  see the <a href="#sec:idea_configuration">Configuration</a> section for more details.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>What exactly the IDEA plugin generates depends on which other plugins are used:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Always</strong></dt>
<dd>
<p>Generates an IDEA module file. Also generates an IDEA project and workspace file if the project is the root project.</p>
</dd>
<dt class="hdlist1"><strong><a href="#java_plugin">Java Plugin</a></strong></dt>
<dd>
<p>Additionally adds Java configuration to the IDEA module and project files.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>One focus of the IDEA plugin is to be open to customization. The plugin provides a standardized set of hooks for adding and removing content from the generated files.</p>
</div>
<div class="sect3">
<h4 id="sec:idea_usage"><a class="anchor" href="#sec:idea_usage"></a><a class="link" href="#sec:idea_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the IDEA plugin, include this in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_idea_plugin"><a class="anchor" href="#example_using_the_idea_plugin"></a><a class="link" href="#example_using_the_idea_plugin">Example: Using the IDEA plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">idea</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The IDEA plugin adds a number of tasks to your project. The <code>idea</code> task generates an IDEA module file for the project. When the project is the root project, the <code>idea</code> task also generates an IDEA project and workspace. The IDEA project includes modules for each of the projects in the Gradle build.</p>
</div>
<div class="paragraph">
<p>The IDEA plugin also adds an <code>openIdea</code> task when the project is the root project. This task generates the IDEA configuration files and opens the result in IDEA. This means you can simply run <code>./gradlew openIdea</code> from the root project to generate and open the IDEA project in one convenient step.</p>
</div>
<div class="paragraph">
<p>The IDEA plugin also adds a <code>cleanIdea</code> task to the project. This task deletes the generated files, if present.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:idea_tasks"><a class="anchor" href="#sec:idea_tasks"></a><a class="link" href="#sec:idea_tasks">Tasks</a></h4>
<div class="paragraph">
<p>The IDEA plugin adds the tasks shown below to a project. Notice that the <code>clean</code> task does not depend on the <code>cleanIdeaWorkspace</code> task. This is because the workspace typically contains a lot of user specific temporary data and it is not desirable to manipulate it outside IDEA.</p>
</div>
<div id="ideatasks" class="dlist">
<dl>
<dt class="hdlist1"><code>idea</code></dt>
<dd>
<p><em>Depends on</em>: <code>ideaProject</code>, <code>ideaModule</code>, <code>ideaWorkspace</code></p>
<div class="paragraph">
<p>Generates all IDEA configuration files</p>
</div>
</dd>
<dt class="hdlist1"><code>openIdea</code></dt>
<dd>
<p><em>Depends on</em>: <code>idea</code></p>
<div class="paragraph">
<p>Generates all IDEA configuration files and opens the project in IDEA</p>
</div>
</dd>
<dt class="hdlist1"><code>cleanIdea</code>  <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a></dt>
<dd>
<p><em>Depends on</em>: <code>cleanIdeaProject</code>, <code>cleanIdeaModule</code></p>
<div class="paragraph">
<p>Removes all IDEA configuration files</p>
</div>
</dd>
<dt class="hdlist1"><code>cleanIdeaProject</code>  <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a></dt>
<dd>
<p>Removes the IDEA project file</p>
</dd>
<dt class="hdlist1"><code>cleanIdeaModule</code>  <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a></dt>
<dd>
<p>Removes the IDEA module file</p>
</dd>
<dt class="hdlist1"><code>cleanIdeaWorkspace</code>  <a href="../dsl/org.gradle.api.tasks.Delete.html">Delete</a></dt>
<dd>
<p>Removes the IDEA workspace file</p>
</dd>
<dt class="hdlist1"><code>ideaProject</code>  <a href="../dsl/org.gradle.plugins.ide.idea.GenerateIdeaProject.html">GenerateIdeaProject</a></dt>
<dd>
<p>Generates the <code>.ipr</code> file. This task is only added to the root project.</p>
</dd>
<dt class="hdlist1"><code>ideaModule</code>  <a href="../dsl/org.gradle.plugins.ide.idea.GenerateIdeaModule.html">GenerateIdeaModule</a></dt>
<dd>
<p>Generates the <code>.iml</code> file</p>
</dd>
<dt class="hdlist1"><code>ideaWorkspace</code>  <a href="../dsl/org.gradle.plugins.ide.idea.GenerateIdeaWorkspace.html">GenerateIdeaWorkspace</a></dt>
<dd>
<p>Generates the <code>.iws</code> file. This task is only added to the root project.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec:idea_configuration"><a class="anchor" href="#sec:idea_configuration"></a><a class="link" href="#sec:idea_configuration">Configuration</a></h4>
<div class="paragraph">
<p>The plugin adds some configuration options that allow to customize the IDEA project and module files that it generates. These take the form of both model properties and lower-level mechanisms that modify the generated files directly. For example, you can add source and resource directories, as well as inject your own fragments of XML. The former type of configuration is honored by IDEA&#8217;s import facility, whereas the latter is not.</p>
</div>
<div class="paragraph">
<p>Here are the configuration properties you can use:</p>
</div>
<div id="idea-configuration" class="dlist">
<dl>
<dt class="hdlist1"><code>idea</code>  <a href="../dsl/org.gradle.plugins.ide.idea.model.IdeaModel.html">IdeaModel</a></dt>
<dd>
<p>Top level element that enables configuration of the idea plugin in a DSL-friendly fashion</p>
</dd>
<dt class="hdlist1"><code>idea.project</code> <a href="../dsl/org.gradle.plugins.ide.idea.model.IdeaProject.html">IdeaProject</a></dt>
<dd>
<p>Allows configuring project information</p>
</dd>
<dt class="hdlist1"><code>idea.module</code> <a href="../dsl/org.gradle.plugins.ide.idea.model.IdeaModule.html">IdeaModule</a></dt>
<dd>
<p>Allows configuring module information</p>
</dd>
<dt class="hdlist1"><code>idea.workspace</code> <a href="../dsl/org.gradle.plugins.ide.idea.model.IdeaWorkspace.html">IdeaWorkspace</a></dt>
<dd>
<p>Allows configuring the workspace XML</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Follow the links to the types for examples of using these configuration properties.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:idea_customizing_the_generated_files"><a class="anchor" href="#sec:idea_customizing_the_generated_files"></a><a class="link" href="#sec:idea_customizing_the_generated_files">Customizing the generated files</a></h4>
<div class="paragraph">
<p>The IDEA plugin provides hooks and behavior for customizing the generated content in a more controlled and detailed way. In addition, the <code>withXml</code> hook is the only practical way to modify the workspace file because its corresponding domain object is essentially empty.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The techniques we discuss in this section don&#8217;t work with IDEA&#8217;s import facility
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The tasks recognize existing IDEA files and merge them with the generated content.</p>
</div>
<div class="sect4">
<h5 id="sec:merging_with_idea_files"><a class="anchor" href="#sec:merging_with_idea_files"></a><a class="link" href="#sec:merging_with_idea_files">Merging</a></h5>
<div class="paragraph">
<p>Sections of existing IDEA files that are also the target of generated content will be amended or overwritten, depending on the particular section. The remaining sections will be left as-is.</p>
</div>
<div class="sect5">
<h6 id="sec:complete_overwrite_of_idea_files"><a class="anchor" href="#sec:complete_overwrite_of_idea_files"></a><a class="link" href="#sec:complete_overwrite_of_idea_files">Disabling merging with a complete overwrite</a></h6>
<div class="paragraph">
<p>To completely rewrite existing IDEA files, execute a clean task together with its corresponding generation task, like <code>gradle cleanIdea idea</code> (in that order). If you want to make this the default behavior, add <code>tasks.idea.dependsOn(cleanIdea)</code> to your build script. This makes it unnecessary to execute the clean task explicitly.</p>
</div>
<div class="paragraph">
<p>This strategy can also be used for individual files that the plugin would generate. For instance, this can be done for the <code>.iml</code> file with <code>gradle cleanIdeaModule ideaModule</code>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:hooking_into_the_idea_generation_lifecycle"><a class="anchor" href="#sec:hooking_into_the_idea_generation_lifecycle"></a><a class="link" href="#sec:hooking_into_the_idea_generation_lifecycle">Hooking into the generation lifecycle</a></h5>
<div class="paragraph">
<p>The plugin provides objects modeling the sections of the metadata files that are generated by Gradle. The generation lifecycle is as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The file is read; or a default version provided by Gradle is used if it does not exist</p>
</li>
<li>
<p>The <code>beforeMerged</code> hook is executed with a domain object representing the existing file</p>
</li>
<li>
<p>The existing content is merged with the configuration inferred from the Gradle build or defined explicitly in the eclipse DSL</p>
</li>
<li>
<p>The <code>whenMerged</code> hook is executed with a domain object representing contents of the file to be persisted</p>
</li>
<li>
<p>The <code>withXml</code> hook is executed with a raw representation of the XML that will be persisted</p>
</li>
<li>
<p>The final XML is persisted</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following are the domain objects used for each of the model types:</p>
</div>
<div id="idea-hooks" class="dlist">
<dl>
<dt class="hdlist1"><a href="../dsl/org.gradle.plugins.ide.idea.model.IdeaProject.html">IdeaProject</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>beforeMerged { <a href="../javadoc/org/gradle/plugins/ide/idea/model/Project.html">Project</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>whenMerged { <a href="../javadoc/org/gradle/plugins/ide/idea/model/Project.html">Project</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>withXml { <a href="../javadoc/org/gradle/api/XmlProvider.html">XmlProvider</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="../javadoc/org/gradle/plugins/ide/idea/model/IdeaModule.html">IdeaModule</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>beforeMerged { <a href="../javadoc/org/gradle/plugins/ide/idea/model/Module.html">Module</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>whenMerged { <a href="../javadoc/org/gradle/plugins/ide/idea/model/Module.html">Module</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>withXml { <a href="../javadoc/org/gradle/api/XmlProvider.html">XmlProvider</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="../javadoc/org/gradle/plugins/ide/idea/model/IdeaWorkspace.html">IdeaWorkspace</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>beforeMerged { <a href="../javadoc/org/gradle/plugins/ide/idea/model/Workspace.html">Workspace</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>whenMerged { <a href="../javadoc/org/gradle/plugins/ide/idea/model/Workspace.html">Workspace</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
<li>
<p><code>withXml { <a href="../javadoc/org/gradle/api/XmlProvider.html">XmlProvider</a> arg -&gt; &#8230;&#8203; }</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sect5">
<h6 id="sec:partial-rewrite"><a class="anchor" href="#sec:partial-rewrite"></a><a class="link" href="#sec:partial-rewrite">Partial rewrite of existing content</a></h6>
<div class="paragraph">
<p>A "complete rewrite" causes all existing content to be discarded, thereby losing any changes made directly in the IDE. The <code>beforeMerged</code> hook makes it possible to overwrite just certain parts of the existing content. The following example removes all existing dependencies from the <code>Module</code> domain object:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_partial_rewrite_for_module"><a class="anchor" href="#example_partial_rewrite_for_module"></a><a class="link" href="#example_partial_rewrite_for_module">Example: Partial Rewrite for Module</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">idea.module.iml {
    beforeMerged { module -&gt;
        module.dependencies.clear()
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting module file will only contain Gradle-generated dependency entries, but not any other dependency entries that may have been present in the original file. (In the case of dependency entries, this is also the default behavior.) Other sections of the module file will be either left as-is or merged. The same could be done for the module paths in the project file:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_partial_rewrite_for_project"><a class="anchor" href="#example_partial_rewrite_for_project"></a><a class="link" href="#example_partial_rewrite_for_project">Example: Partial Rewrite for Project</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">idea.project.ipr {
    beforeMerged { project -&gt;
        project.modulePaths.clear()
    }
}</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="sec:idea_modify_domain_objects"><a class="anchor" href="#sec:idea_modify_domain_objects"></a><a class="link" href="#sec:idea_modify_domain_objects">Modifying the fully populated domain objects</a></h6>
<div class="paragraph">
<p>The <code>whenMerged</code> hook allows you to manipulate the fully populated domain objects. Often this is the preferred way to customize IDEA files. Here is how you would export all the dependencies of an IDEA module:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_export_dependencies"><a class="anchor" href="#example_export_dependencies"></a><a class="link" href="#example_export_dependencies">Example: Export Dependencies</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">idea.module.iml {
    whenMerged { module -&gt;
        module.dependencies*.exported = <span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="sec:idea_modify_xml"><a class="anchor" href="#sec:idea_modify_xml"></a><a class="link" href="#sec:idea_modify_xml">Modifying the XML representation</a></h6>
<div class="paragraph">
<p>The <code>withXml</code> hook allows you to manipulate the in-memory XML representation just before the file gets written to disk. Although Groovy&#8217;s XML support makes up for a lot, this approach is less convenient than manipulating the domain objects. In return, you get total control over the generated file, including sections not modeled by the domain objects.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="example_customizing_the_xml_2"><a class="anchor" href="#example_customizing_the_xml_2"></a><a class="link" href="#example_customizing_the_xml_2">Example: Customizing the XML</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">idea.project.ipr {
    withXml { provider -&gt;
        provider.node.component
                .find { <span class="local-variable">it</span>.@name == <span class="string"><span class="delimiter">'</span><span class="content">VcsDirectoryMappings</span><span class="delimiter">'</span></span> }
                .mapping.@vcs = <span class="string"><span class="delimiter">'</span><span class="content">Git</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:further_things_to_consider"><a class="anchor" href="#sec:further_things_to_consider"></a><a class="link" href="#sec:further_things_to_consider">Further things to consider</a></h4>
<div class="paragraph">
<p>The paths of dependencies in the generated IDEA files are absolute. If you manually define a path variable pointing to the Gradle dependency cache, IDEA will automatically replace the absolute dependency paths with this path variable. you can configure this path variable via the <code>idea.pathVariables</code> property, so that it can do a proper merge without creating duplicates.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="embedding"><a class="anchor" href="#embedding"></a><a class="link" href="#embedding">Embedding Gradle using the Tooling API</a></h3>
<div class="sect3">
<h4 id="sec:embedding_introduction"><a class="anchor" href="#sec:embedding_introduction"></a><a class="link" href="#sec:embedding_introduction">Introduction to the Tooling API</a></h4>
<div class="paragraph">
<p>Gradle provides a programmatic API called the Tooling API, which you can use for embedding Gradle into your own software. This API allows you to execute and monitor builds and to query Gradle about the details of a build. The main audience for this API is IDE, CI server, other UI authors; however, the API is open for anyone who needs to embed Gradle in their application.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#test_kit">Gradle TestKit</a> uses the Tooling API for functional testing of your Gradle plugins.</p>
</li>
<li>
<p><a href="http://projects.eclipse.org/projects/tools.buildship">Eclipse Buildship</a> uses the Tooling API for importing your Gradle project and running tasks.</p>
</li>
<li>
<p><a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a> uses the Tooling API for importing your Gradle project and running tasks.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:embedding_features"><a class="anchor" href="#sec:embedding_features"></a><a class="link" href="#sec:embedding_features">Tooling API Features</a></h4>
<div class="paragraph">
<p>A fundamental characteristic of the Tooling API is that it operates in a version independent way. This means that you can use the same API to work with builds that use different versions of Gradle, including versions that are newer or older than the version of the Tooling API that you are using. The Tooling API is Gradle wrapper aware and, by default, uses the same Gradle version as that used by the wrapper-powered build.</p>
</div>
<div class="paragraph">
<p>Some features that the Tooling API provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Query the details of a build, including the project hierarchy and the project dependencies, external dependencies (including source and Javadoc jars), source directories and tasks of each project.</p>
</li>
<li>
<p>Execute a build and listen to stdout and stderr logging and progress messages (e.g. the messages shown in the 'status bar' when you run on the command line).</p>
</li>
<li>
<p>Execute a specific test class or test method.</p>
</li>
<li>
<p>Receive interesting events as a build executes, such as project configuration, task execution or test execution.</p>
</li>
<li>
<p>Cancel a build that is running.</p>
</li>
<li>
<p>Combine multiple separate Gradle builds into a single composite build.</p>
</li>
<li>
<p>The Tooling API can download and install the appropriate Gradle version, similar to the wrapper.</p>
</li>
<li>
<p>The implementation is lightweight, with only a small number of dependencies. It is also a well-behaved library, and makes no assumptions about your classloader structure or logging configuration. This makes the API easy to embed in your application.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:embedding_daemon"><a class="anchor" href="#sec:embedding_daemon"></a><a class="link" href="#sec:embedding_daemon">Tooling API and the Gradle Build Daemon</a></h4>
<div class="paragraph">
<p>The Tooling API always uses the Gradle daemon. This means that subsequent calls to the Tooling API, be it model building requests or task executing requests will be executed in the same long-living process. <a href="#gradle_daemon">Gradle Daemon</a> contains more details about the daemon, specifically information on situations when new daemons are forked.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:embedding_quickstart"><a class="anchor" href="#sec:embedding_quickstart"></a><a class="link" href="#sec:embedding_quickstart">Quickstart</a></h4>
<div class="paragraph">
<p>As the Tooling API is an interface for developers, the Javadoc is the main documentation for it. We provide several <em>samples</em> that live in <code>samples/toolingApi</code> in your Gradle distribution. These samples specify all of the required dependencies for the Tooling API with examples for querying information from Gradle builds and executing tasks from the Tooling API.</p>
</div>
<div class="paragraph">
<p>To use the Tooling API, add the following repository and dependency declarations to your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_tooling_api"><a class="anchor" href="#example_using_the_tooling_api"></a><a class="link" href="#example_using_the_tooling_api">Example: Using the tooling API</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    maven { url <span class="string"><span class="delimiter">'</span><span class="content">https://repo.gradle.org/gradle/libs-releases</span><span class="delimiter">'</span></span> }
}

dependencies {
    compile <span class="string"><span class="delimiter">&quot;</span><span class="content">org.gradle:gradle-tooling-api:</span><span class="inline"><span class="inline-delimiter">${</span>toolingApiVersion<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    <span class="comment">// The tooling API need an SLF4J implementation available at runtime, replace this with any other implementation</span>
    runtime <span class="string"><span class="delimiter">'</span><span class="content">org.slf4j:slf4j-simple:1.7.10</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The main entry point to the Tooling API is the <a href="../javadoc/org/gradle/tooling/GradleConnector.html">GradleConnector</a>. You can navigate from there to find code samples and explore the available Tooling API models. You can use <a href="https://docs.gradle.org/nightly/javadoc/org/gradle/tooling/GradleConnector.html#connect--">GradleConnector.connect()</a> to create a <a href="../javadoc/org/gradle/tooling/ProjectConnection.html">ProjectConnection</a>. A <code>ProjectConnection</code> connects to a single Gradle project. Using the connection you can execute tasks, tests and retrieve models relative to this project.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:embedding_compatibility"><a class="anchor" href="#sec:embedding_compatibility"></a><a class="link" href="#sec:embedding_compatibility">Gradle version and Java version compatibility</a></h4>
<div class="sect4">
<h5 id="provider_side"><a class="anchor" href="#provider_side"></a><a class="link" href="#provider_side">Provider side</a></h5>
<div class="paragraph">
<p>The current version of Tooling API supports running builds using Gradle versions 1.2 and later. However, support for running builds with Gradle versions older than 2.6 is deprecated and will be removed in Tooling API version 5.0.</p>
</div>
</div>
<div class="sect4">
<h5 id="consumer_side"><a class="anchor" href="#consumer_side"></a><a class="link" href="#consumer_side">Consumer side</a></h5>
<div class="paragraph">
<p>The current version of Gradle supports running builds via Tooling API versions 2.0 and later. However, support for running builds via Tooling API versions older than 3.0 is deprecated and will be removed in Gradle 5.0.</p>
</div>
<div class="paragraph">
<p>You should note that not all features of the Tooling API are available for all versions of Gradle. For example, build cancellation is only available when a build uses Gradle 2.1 and later. Refer to the documentation for each class and method for more details.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="java_version"><a class="anchor" href="#java_version"></a><a class="link" href="#java_version">Java version</a></h4>
<div class="paragraph">
<p>The Tooling API requires Java 8 or later. Java 7 is currently still supported but will be removed in Gradle 5.0. The Gradle version used by builds may have additional Java version requirements.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extending_gradle"><a class="anchor" href="#extending_gradle"></a><a class="link" href="#extending_gradle">Extending Gradle</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="custom_plugins"><a class="anchor" href="#custom_plugins"></a><a class="link" href="#custom_plugins">Writing Custom Plugins</a></h3>
<div class="paragraph">
<p>A Gradle plugin packages up reusable pieces of build logic, which can be used across many different projects and builds. Gradle allows you to implement your own plugins, so you can reuse your build logic, and share it with others.</p>
</div>
<div class="paragraph">
<p>You can implement a Gradle plugin in any language you like, provided the implementation ends up compiled as bytecode. In our examples, we are going to use Groovy as the implementation language. Groovy, Java or Kotlin are all good choices as the language to use to implement a plugin, as the Gradle API has been designed to work well with these languages. In general, a plugin implemented using Java or Kotlin, which are statically typed, will perform better than the same plugin implemented using Groovy.</p>
</div>
<div class="sect3">
<h4 id="sec:packaging_a_plugin"><a class="anchor" href="#sec:packaging_a_plugin"></a><a class="link" href="#sec:packaging_a_plugin">Packaging a plugin</a></h4>
<div class="paragraph">
<p>There are several places where you can put the source for the plugin.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Build script</dt>
<dd>
<p>You can include the source for the plugin directly in the build script. This has the benefit that the plugin is automatically compiled and included in the classpath of the build script without you having to do anything. However, the plugin is not visible outside the build script, and so you cannot reuse the plugin outside the build script it is defined in.</p>
</dd>
<dt class="hdlist1"><code>buildSrc</code> project</dt>
<dd>
<p>You can put the source for the plugin in the <code><em>rootProjectDir</em>/buildSrc/src/main/groovy</code> directory. Gradle will take care of compiling and testing the plugin and making it available on the classpath of the build script. The plugin is visible to every build script used by the build. However, it is not visible outside the build, and so you cannot reuse the plugin outside the build it is defined in.</p>
<div class="paragraph">
<p>See <a href="#organizing_gradle_projects">Organizing Gradle Projects</a> for more details about the <code>buildSrc</code> project.</p>
</div>
</dd>
<dt class="hdlist1">Standalone project</dt>
<dd>
<p>You can create a separate project for your plugin. This project produces and publishes a JAR which you can then use in multiple builds and share with others. Generally, this JAR might include some plugins, or bundle several related task classes into a single library. Or some combination of the two.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In our examples, we will start with the plugin in the build script, to keep things simple. Then we will look at creating a standalone project.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:writing_a_simple_plugin"><a class="anchor" href="#sec:writing_a_simple_plugin"></a><a class="link" href="#sec:writing_a_simple_plugin">Writing a simple plugin</a></h4>
<div class="paragraph">
<p>To create a Gradle plugin, you need to write a class that implements the <a href="../javadoc/org/gradle/api/Plugin.html">Plugin</a> interface. When the plugin is applied to a project, Gradle creates an instance of the plugin class and calls the instance&#8217;s <a href="../javadoc/org/gradle/api/Plugin.html#apply-T-">Plugin.apply()</a> method. The project object is passed as a parameter, which the plugin can use to configure the project however it needs to. The following sample contains a greeting plugin, which adds a <code>hello</code> task to the project.</p>
</div>
<div class="sect4">
<h5 id="example_a_custom_plugin"><a class="anchor" href="#example_a_custom_plugin"></a><a class="link" href="#example_a_custom_plugin">Example: A custom plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">GreetingPlugin</span> <span class="directive">implements</span> Plugin&lt;Project&gt; {
    <span class="type">void</span> apply(Project project) {
        project.task(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>) {
            doLast {
                println <span class="string"><span class="delimiter">'</span><span class="content">Hello from the GreetingPlugin</span><span class="delimiter">'</span></span>
            }
        }
    }
}

<span class="comment">// Apply the plugin</span>
apply <span class="key">plugin</span>: GreetingPlugin</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
Hello from the GreetingPlugin</pre>
</div>
</div>
<div class="paragraph">
<p>One thing to note is that a new instance of a plugin is created for each project it is applied to. Also note that the <a href="../javadoc/org/gradle/api/Plugin.html">Plugin</a> class is a generic type. This example has it receiving the <a href="../dsl/org.gradle.api.Project.html">Project</a> type as a type parameter. A plugin can instead receive a parameter of type <a href="../dsl/org.gradle.api.initialization.Settings.html">Settings</a>, in which case the plugin can be applied in a settings script, or a parameter of type <a href="../dsl/org.gradle.api.invocation.Gradle.html">Gradle</a>, in which case the plugin can be applied in an initialization script.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:getting_input_from_the_build"><a class="anchor" href="#sec:getting_input_from_the_build"></a><a class="link" href="#sec:getting_input_from_the_build">Making the plugin configurable</a></h4>
<div class="paragraph">
<p>Most plugins need to obtain some configuration from the build script. One method for doing this is to use <em>extension objects</em>. The Gradle <a href="../dsl/org.gradle.api.Project.html">Project</a> has an associated <a href="../javadoc/org/gradle/api/plugins/ExtensionContainer.html">ExtensionContainer</a> object that contains all the settings and properties for the plugins that have been applied to the project. You can provide configuration for your plugin by adding an extension object to this container. An extension object is simply a Java Bean compliant class. Groovy is a good language choice to implement an extension object because plain old Groovy objects contain all the getter and setter methods that a Java Bean requires. Java and Kotlin are other good choices.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s add a simple extension object to the project. Here we add a <code>greeting</code> extension object to the project, which allows you to configure the greeting.</p>
</div>
<div class="sect4">
<h5 id="example_a_custom_plugin_extension"><a class="anchor" href="#example_a_custom_plugin_extension"></a><a class="link" href="#example_a_custom_plugin_extension">Example: A custom plugin extension</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">GreetingPluginExtension</span> {
    <span class="predefined-type">String</span> message = <span class="string"><span class="delimiter">'</span><span class="content">Hello from GreetingPlugin</span><span class="delimiter">'</span></span>
}

<span class="type">class</span> <span class="class">GreetingPlugin</span> <span class="directive">implements</span> Plugin&lt;Project&gt; {
    <span class="type">void</span> apply(Project project) {
        <span class="comment">// Add the 'greeting' extension object</span>
        <span class="keyword">def</span> extension = project.extensions.create(<span class="string"><span class="delimiter">'</span><span class="content">greeting</span><span class="delimiter">'</span></span>, GreetingPluginExtension)
        <span class="comment">// Add a task that uses configuration from the extension object</span>
        project.task(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>) {
            doLast {
                println extension.message
            }
        }
    }
}

apply <span class="key">plugin</span>: GreetingPlugin

<span class="comment">// Configure the extension</span>
greeting.message = <span class="string"><span class="delimiter">'</span><span class="content">Hi from Gradle</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
Hi from Gradle</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>GreetingPluginExtension</code> is a plain old Groovy object with a property called <code>message</code>. The extension object is added to the plugin list with the name <code>greeting</code>. This object then becomes available as a project property with the same name as the extension object.</p>
</div>
<div class="paragraph">
<p>Oftentimes, you have several related properties you need to specify on a single plugin. Gradle adds a configuration closure block for each extension object, so you can group settings together. The following example shows you how this works.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_a_custom_plugin_with_configuration_closure"><a class="anchor" href="#example_a_custom_plugin_with_configuration_closure"></a><a class="link" href="#example_a_custom_plugin_with_configuration_closure">Example: A custom plugin with configuration closure</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">GreetingPluginExtension</span> {
    <span class="predefined-type">String</span> message
    <span class="predefined-type">String</span> greeter
}

<span class="type">class</span> <span class="class">GreetingPlugin</span> <span class="directive">implements</span> Plugin&lt;Project&gt; {
    <span class="type">void</span> apply(Project project) {
        <span class="keyword">def</span> extension = project.extensions.create(<span class="string"><span class="delimiter">'</span><span class="content">greeting</span><span class="delimiter">'</span></span>, GreetingPluginExtension)
        project.task(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>) {
            doLast {
                println <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>extension.message<span class="inline-delimiter">}</span></span><span class="content"> from </span><span class="inline"><span class="inline-delimiter">${</span>extension.greeter<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}

apply <span class="key">plugin</span>: GreetingPlugin

<span class="comment">// Configure the extension using a DSL block</span>
greeting {
    message = <span class="string"><span class="delimiter">'</span><span class="content">Hi</span><span class="delimiter">'</span></span>
    greeter = <span class="string"><span class="delimiter">'</span><span class="content">Gradle</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
Hi from Gradle</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, several settings can be grouped together within the <code>greeting</code> closure. The name of the closure block in the build script (<code>greeting</code>) needs to match the extension object name. Then, when the closure is executed, the fields on the extension object will be mapped to the variables within the closure based on the standard Groovy closure delegate feature.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:working_with_files_in_custom_tasks_and_plugins"><a class="anchor" href="#sec:working_with_files_in_custom_tasks_and_plugins"></a><a class="link" href="#sec:working_with_files_in_custom_tasks_and_plugins">Working with files in custom tasks and plugins</a></h4>
<div class="paragraph">
<p>When developing custom tasks and plugins, it&#8217;s a good idea to be very flexible when accepting input configuration for file locations. To do this, you can leverage the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a> method to resolve values to files as late as possible.</p>
</div>
<div class="sect4">
<h5 id="example_evaluating_file_properties_lazily"><a class="anchor" href="#example_evaluating_file_properties_lazily"></a><a class="link" href="#example_evaluating_file_properties_lazily">Example: Evaluating file properties lazily</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">GreetingToFileTask</span> <span class="directive">extends</span> DefaultTask {

    <span class="keyword">def</span> destination

    <span class="predefined-type">File</span> getDestination() {
        project.file(destination)
    }

    <span class="annotation">@TaskAction</span>
    <span class="keyword">def</span> <span class="function">greet</span>() {
        <span class="keyword">def</span> file = getDestination()
        file.parentFile.mkdirs()
        file.write <span class="string"><span class="delimiter">'</span><span class="content">Hello!</span><span class="delimiter">'</span></span>
    }
}
task greet(<span class="key">type</span>: GreetingToFileTask) {
    destination = { project.greetingFile }
}

task sayGreeting(<span class="key">dependsOn</span>: greet) {
    doLast {
        println file(greetingFile).text
    }
}

ext.greetingFile = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/hello.txt</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q sayGreeting</code></strong></div>
<div class="content">
<pre>&gt; gradle -q sayGreeting
Hello!</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, we configure the <code>greet</code> task <code>destination</code> property as a closure, which is evaluated with the <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:file(java.lang.Object)">Project.file(java.lang.Object)</a> method to turn the return value of the closure into a <code>File</code> object at the last minute. You will notice that in the example above we specify the <code>greetingFile</code> property value after we have configured to use it for the task. This kind of lazy evaluation is a key benefit of accepting any value when setting a file property, then resolving that value when reading the property.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:mapping_extension_properties_to_task_properties"><a class="anchor" href="#sec:mapping_extension_properties_to_task_properties"></a><a class="link" href="#sec:mapping_extension_properties_to_task_properties">Mapping extension properties to task properties</a></h4>
<div class="paragraph">
<p>Capturing user input from the build script through an extension and mapping it to input/output properties of a custom task is considered a best practice. The end user only interacts with the exposed DSL defined by the extension. The imperative logic is hidden in the plugin implementation.</p>
</div>
<div class="paragraph">
<p>The extension declaration in the build script as well as the mapping between extension properties and custom task properties occurs during Gradle&#8217;s configuration phase of the build lifecycle. To avoid evaluation order issues, the actual value of a mapped property has to be resolved during the execution phase. For more information please see <a href="#sec:build_phases">the section on build phases</a>. Gradle&#8217;s API offers types for representing a property that should be lazily evaluated e.g. during execution time. Refer to <a href="#lazy_configuration">Lazy Configuration</a> for more information.</p>
</div>
<div class="paragraph">
<p>The following demonstrates the usage of the type for mapping an extension property to a task property:</p>
</div>
<div class="sect4">
<h5 id="example_mapping_extension_properties_to_task_properties"><a class="anchor" href="#example_mapping_extension_properties_to_task_properties"></a><a class="link" href="#example_mapping_extension_properties_to_task_properties">Example: Mapping extension properties to task properties</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">GreetingPlugin</span> <span class="directive">implements</span> Plugin&lt;Project&gt; {
    <span class="type">void</span> apply(Project project) {
        <span class="keyword">def</span> extension = project.extensions.create(<span class="string"><span class="delimiter">'</span><span class="content">greeting</span><span class="delimiter">'</span></span>, GreetingPluginExtension, project)
        project.tasks.create(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>, Greeting) {
            message = extension.message
            outputFiles = extension.outputFiles
        }
    }
}

<span class="type">class</span> <span class="class">GreetingPluginExtension</span> {
    <span class="directive">final</span> Property&lt;<span class="predefined-type">String</span>&gt; message
    <span class="directive">final</span> ConfigurableFileCollection outputFiles

    GreetingPluginExtension(Project project) {
        message = project.objects.property(<span class="predefined-type">String</span>)
        message.set(<span class="string"><span class="delimiter">'</span><span class="content">Hello from GreetingPlugin</span><span class="delimiter">'</span></span>)
        outputFiles = project.layout.configurableFiles()
    }

    <span class="type">void</span> setOutputFiles(FileCollection outputFiles) {
        <span class="local-variable">this</span>.outputFiles.setFrom(outputFiles)
    }
}

<span class="type">class</span> <span class="class">Greeting</span> <span class="directive">extends</span> DefaultTask {
    <span class="directive">final</span> Property&lt;<span class="predefined-type">String</span>&gt; message = project.objects.property(<span class="predefined-type">String</span>)
    <span class="directive">final</span> ConfigurableFileCollection outputFiles = project.layout.configurableFiles()

    <span class="type">void</span> setOutputFiles(FileCollection outputFiles) {
        <span class="local-variable">this</span>.outputFiles.setFrom(outputFiles)
    }

    <span class="annotation">@TaskAction</span>
    <span class="type">void</span> printMessage() {
        outputFiles.each {
            logger.quiet <span class="string"><span class="delimiter">&quot;</span><span class="content">Writing message 'Hi from Gradle' to file</span><span class="delimiter">&quot;</span></span>
            <span class="local-variable">it</span>.text = message.get()
        }
    }
}

apply <span class="key">plugin</span>: GreetingPlugin

greeting {
    message = <span class="string"><span class="delimiter">'</span><span class="content">Hi from Gradle</span><span class="delimiter">'</span></span>
    outputFiles = layout.files(<span class="string"><span class="delimiter">'</span><span class="content">a.txt</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">b.txt</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/userguide/tasks/mapExtensionPropertiesToTaskProperties</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Output of <code>gradle -q hello</code></div>
<div class="content">
<pre>&gt; gradle -q hello
Writing message 'Hi from Gradle' to file
Writing message 'Hi from Gradle' to file</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:custom_plugins_standalone_project"><a class="anchor" href="#sec:custom_plugins_standalone_project"></a><a class="link" href="#sec:custom_plugins_standalone_project">A standalone project</a></h4>
<div class="paragraph">
<p>Now we will move our plugin to a standalone project, so we can publish it and share it with others. This project is simply a Groovy project that produces a JAR containing the plugin classes. Here is a simple build script for the project. It applies the Groovy plugin, and adds the Gradle API as a compile-time dependency.</p>
</div>
<div class="sect4">
<h5 id="example_a_build_for_a_custom_plugin"><a class="anchor" href="#example_a_build_for_a_custom_plugin"></a><a class="link" href="#example_a_build_for_a_custom_plugin">Example: A build for a custom plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">groovy</span><span class="delimiter">'</span></span>
}

dependencies {
    compile gradleApi()
    compile localGroovy()
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The code for this example can be found at <strong><code>samples/customPlugin/plugin</code></strong> in the -all distribution of Gradle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>So how does Gradle find the <a href="../javadoc/org/gradle/api/Plugin.html">Plugin</a> implementation? The answer is you need to provide a properties file in the jar&#8217;s <code>META-INF/gradle-plugins</code> directory that matches the id of your plugin.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_wiring_for_a_custom_plugin"><a class="anchor" href="#example_wiring_for_a_custom_plugin"></a><a class="link" href="#example_wiring_for_a_custom_plugin">Example: Wiring for a custom plugin</a></h5>
<div class="listingblock">
<div class="title">src/main/resources/META-INF/gradle-plugins/org.samples.greeting.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">implementation-class=org.gradle.GreetingPlugin</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the properties filename matches the plugin id and is placed in the resources folder, and that the <code>implementation-class</code> property identifies the <a href="../javadoc/org/gradle/api/Plugin.html">Plugin</a> implementation class.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:creating_a_plugin_id"><a class="anchor" href="#sec:creating_a_plugin_id"></a><a class="link" href="#sec:creating_a_plugin_id">Creating a plugin id</a></h5>
<div class="paragraph">
<p>Plugin ids are fully qualified in a manner similar to Java packages (i.e. a reverse domain name). This helps to avoid collisions and provides a way to group plugins with similar ownership.</p>
</div>
<div class="paragraph">
<p>Your plugin id should be a combination of components that reflect namespace (a reasonable pointer to you or your organization) and the name of the plugin it provides. For example if you had a Github account named "foo" and your plugin was named "bar", a suitable plugin id might be <code>com.github.foo.bar</code>. Similarly, if the plugin was developed at the baz organization, the plugin id might be <code>org.baz.bar</code>.</p>
</div>
<div class="paragraph">
<p>Plugin ids should conform to the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>May contain any alphanumeric character, '.', and '-'.</p>
</li>
<li>
<p>Must contain at least one '.' character separating the namespace from the name of the plugin.</p>
</li>
<li>
<p>Conventionally use a lowercase reverse domain name convention for the namespace.</p>
</li>
<li>
<p>Conventionally use only lowercase characters in the name.</p>
</li>
<li>
<p><code>org.gradle</code> and <code>com.gradleware</code> namespaces may not be used.</p>
</li>
<li>
<p>Cannot start or end with a '.' character.</p>
</li>
<li>
<p>Cannot contain consecutive '.' characters (i.e. '..').</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although there are conventional similarities between plugin ids and package names, package names are generally more detailed than is necessary for a plugin id. For instance, it might seem reasonable to add "gradle" as a component of your plugin id, but since plugin ids are only used for Gradle plugins, this would be superfluous. Generally, a namespace that identifies ownership and a name are all that are needed for a good plugin id.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:publishing_your_plugin"><a class="anchor" href="#sec:publishing_your_plugin"></a><a class="link" href="#sec:publishing_your_plugin">Publishing your plugin</a></h5>
<div class="paragraph">
<p>If you are publishing your plugin internally for use within your organization, you can publish it like any other code artifact. See the <a href="#publishing_ivy">Ivy</a> and <a href="#publishing_maven">Maven</a> chapters on publishing artifacts.</p>
</div>
<div class="paragraph">
<p>If you are interested in publishing your plugin to be used by the wider Gradle community, you can publish it to the <a href="http://plugins.gradle.org">Gradle Plugin Portal</a>. This site provides the ability to search for and gather information about plugins contributed by the Gradle community. Please refer to the corresponding <a href="https://guides.gradle.org/publishing-plugins-to-gradle-plugin-portal/">guide</a> on how to make your plugin available on this site.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_your_plugin_in_another_project"><a class="anchor" href="#sec:using_your_plugin_in_another_project"></a><a class="link" href="#sec:using_your_plugin_in_another_project">Using your plugin in another project</a></h5>
<div class="paragraph">
<p>To use a plugin in a build script, you need to add the plugin classes to the build script&#8217;s classpath. To do this, you use a &#8220;buildscript { }&#8221; block, as described in see <a href="#sec:applying_plugins_buildscript">Applying plugins using the buildscript block</a>. The following example shows how you might do this when the JAR containing the plugin has been published to a local repository:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_a_custom_plugin_in_another_project"><a class="anchor" href="#example_using_a_custom_plugin_in_another_project"></a><a class="link" href="#example_using_a_custom_plugin_in_another_project">Example: Using a custom plugin in another project</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">buildscript {
    repositories {
        maven {
<span class="comment">// END SNIPPET use-plugin</span>
<span class="comment">// END SNIPPET use-task</span>
            <span class="keyword">def</span> producerName = findProperty(<span class="string"><span class="delimiter">'</span><span class="content">producerName</span><span class="delimiter">'</span></span>) ?: <span class="string"><span class="delimiter">'</span><span class="content">plugin</span><span class="delimiter">'</span></span>
            <span class="keyword">def</span> repoLocation = <span class="string"><span class="delimiter">&quot;</span><span class="content">../</span><span class="inline"><span class="inline-delimiter">$</span>producerName</span><span class="content">/build/repo</span><span class="delimiter">&quot;</span></span>
<span class="comment">// START SNIPPET use-plugin</span>
<span class="comment">// START SNIPPET use-task</span>
            url = uri(repoLocation)
        }
    }
    dependencies {
        classpath <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.gradle</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">customPlugin</span><span class="delimiter">'</span></span>,
                                  <span class="key">version</span>: <span class="string"><span class="delimiter">'</span><span class="content">1.0-SNAPSHOT</span><span class="delimiter">'</span></span>
    }
}
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.samples.greeting</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if your plugin is published to the plugin portal, you can use the incubating plugins DSL (see <a href="#sec:plugins_block">Applying plugins using the plugins DSL</a>) to apply the plugin:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_applying_a_community_plugin_with_the_plugins_dsl"><a class="anchor" href="#example_applying_a_community_plugin_with_the_plugins_dsl"></a><a class="link" href="#example_applying_a_community_plugin_with_the_plugins_dsl">Example: Applying a community plugin with the plugins DSL</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">com.jfrog.bintray</span><span class="delimiter">'</span></span> version <span class="string"><span class="delimiter">'</span><span class="content">0.4.1</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:writing_tests_for_your_plugin"><a class="anchor" href="#sec:writing_tests_for_your_plugin"></a><a class="link" href="#sec:writing_tests_for_your_plugin">Writing tests for your plugin</a></h5>
<div class="paragraph">
<p>You can use the <a href="../javadoc/org/gradle/testfixtures/ProjectBuilder.html">ProjectBuilder</a> class to create <a href="../dsl/org.gradle.api.Project.html">Project</a> instances to use when you test your plugin implementation.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_testing_a_custom_plugin"><a class="anchor" href="#example_testing_a_custom_plugin"></a><a class="link" href="#example_testing_a_custom_plugin">Example: Testing a custom plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">src/test/groovy/org/gradle/GreetingPluginTest.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">GreetingPluginTest</span> {
    <span class="annotation">@Test</span>
    <span class="directive">public</span> <span class="type">void</span> greeterPluginAddsGreetingTaskToProject() {
        Project project = ProjectBuilder.builder().build()
        project.pluginManager.apply <span class="string"><span class="delimiter">'</span><span class="content">org.samples.greeting</span><span class="delimiter">'</span></span>

        assertTrue(project.tasks.hello <span class="keyword">instanceof</span> GreetingTask)
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec:using_the_java_gradle_plugin_development_plugin"><a class="anchor" href="#sec:using_the_java_gradle_plugin_development_plugin"></a><a class="link" href="#sec:using_the_java_gradle_plugin_development_plugin">Using the Java Gradle Plugin Development Plugin</a></h5>
<div class="paragraph">
<p>You can use the incubating <a href="#java_gradle_plugin">Java Gradle Plugin Development Plugin</a> to eliminate some of the boilerplate declarations in your build script and provide some basic validations of plugin metadata. This plugin will automatically apply the <a href="#java_plugin">Java Plugin</a>, add the <code>gradleApi()</code> dependency to the compile configuration, and perform plugin metadata validations as part of the <code>jar</code> task execution, and generate plugin descriptors in the resulting JAR&#8217;s <code>META-INF</code> directory.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_the_java_gradle_plugin_development_plugin"><a class="anchor" href="#example_using_the_java_gradle_plugin_development_plugin"></a><a class="link" href="#example_using_the_java_gradle_plugin_development_plugin">Example: Using the Java Gradle Plugin Development plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">java-gradle-plugin</span><span class="delimiter">'</span></span>
    id <span class="string"><span class="delimiter">'</span><span class="content">groovy</span><span class="delimiter">'</span></span>
}

gradlePlugin {
    plugins {
        simplePlugin {
            id = <span class="string"><span class="delimiter">'</span><span class="content">org.samples.greeting</span><span class="delimiter">'</span></span>
            implementationClass = <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.GreetingPlugin</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When publishing plugins to custom plugin repositories using the <a href="#publishing_ivy">Ivy</a> or <a href="#publishing_maven">Maven</a> publish plugins, the <a href="#java_gradle_plugin">Java Gradle Plugin Development Plugin</a> will also generate plugin marker artifacts named based on the plugin id which depend on the plugin&#8217;s implementation artifact.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:implementing_a_dsl"><a class="anchor" href="#sec:implementing_a_dsl"></a><a class="link" href="#sec:implementing_a_dsl">Providing a configuration DSL for the plugin</a></h4>
<div class="paragraph">
<p>As we saw above, you can use an extension object to provide configuration for your plugin. Using an extension object also extends the Gradle DSL to add a project property and DSL block for the plugin. An extension object is simply a regular object, and so you can provide DSL elements nested inside this block by adding properties and methods to the extension object.</p>
</div>
<div class="paragraph">
<p>Gradle provides several conveniences to help create a well-behaved DSL for your plugin.</p>
</div>
<div class="sect4">
<h5 id="sec:nested_dsl_elements"><a class="anchor" href="#sec:nested_dsl_elements"></a><a class="link" href="#sec:nested_dsl_elements">Nested DSL elements</a></h5>
<div class="paragraph">
<p>When Gradle creates a task or extension object, Gradle <em>decorates</em> the implementation class to mix in DSL support. To create a nested DSL element you can use the <a href="../javadoc/org/gradle/api/model/ObjectFactory.html">ObjectFactory</a> type to create objects that are similarly decorated. These decorated objects can then be made visible to the DSL through properties and methods of the plugin&#8217;s extension:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_nested_dsl_elements"><a class="anchor" href="#example_nested_dsl_elements"></a><a class="link" href="#example_nested_dsl_elements">Example: Nested DSL elements</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> name
}

<span class="type">class</span> <span class="class">GreetingPluginExtension</span> {
    <span class="predefined-type">String</span> message
    <span class="directive">final</span> Person greeter

    <span class="annotation">@javax</span>.inject.Inject
    GreetingPluginExtension(<span class="predefined-type">ObjectFactory</span> objectFactory) {
        <span class="comment">// Create a Person instance</span>
        greeter = objectFactory.newInstance(Person)
    }

    <span class="type">void</span> greeter(<span class="predefined-type">Action</span>&lt;? <span class="local-variable">super</span> Person&gt; action) {
        action.execute(greeter)
    }
}

<span class="type">class</span> <span class="class">GreetingPlugin</span> <span class="directive">implements</span> Plugin&lt;Project&gt; {
    <span class="type">void</span> apply(Project project) {
        <span class="comment">// Create the extension, passing in an ObjectFactory for it to use</span>
        <span class="keyword">def</span> extension = project.extensions.create(<span class="string"><span class="delimiter">'</span><span class="content">greeting</span><span class="delimiter">'</span></span>, GreetingPluginExtension, project.objects)
        project.task(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>) {
            doLast {
                println <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>extension.message<span class="inline-delimiter">}</span></span><span class="content"> from </span><span class="inline"><span class="inline-delimiter">${</span>extension.greeter.name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
            }
        }
    }
}

apply <span class="key">plugin</span>: GreetingPlugin

greeting {
    message = <span class="string"><span class="delimiter">'</span><span class="content">Hi</span><span class="delimiter">'</span></span>
    greeter {
        name = <span class="string"><span class="delimiter">'</span><span class="content">Gradle</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q hello</code></strong></div>
<div class="content">
<pre>&gt; gradle -q hello
Hi from Gradle</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the plugin passes the project&#8217;s <code>ObjectFactory</code> to the extension object through its constructor. The constructor uses this to create a nested object and makes this object available to the DSL through the <code>greeter</code> property.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec:maintaining_multiple_domain_objects"><a class="anchor" href="#sec:maintaining_multiple_domain_objects"></a><a class="link" href="#sec:maintaining_multiple_domain_objects">Configuring a collection of objects</a></h5>
<div class="paragraph">
<p>Gradle provides some utility classes for maintaining collections of objects, intended to work well with the Gradle DSL.</p>
</div>
</div>
<div class="sect4">
<h5 id="example_managing_a_collection_of_objects"><a class="anchor" href="#example_managing_a_collection_of_objects"></a><a class="link" href="#example_managing_a_collection_of_objects">Example: Managing a collection of objects</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Book</span> {
    <span class="directive">final</span> <span class="predefined-type">String</span> name
    <span class="predefined-type">File</span> sourceFile

    <span class="predefined-type">Book</span>(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name
    }
}

<span class="type">class</span> <span class="class">DocumentationPlugin</span> <span class="directive">implements</span> Plugin&lt;Project&gt; {
    <span class="type">void</span> apply(Project project) {
        <span class="comment">// Create a container of Book instances</span>
        <span class="keyword">def</span> books = project.container(<span class="predefined-type">Book</span>)
        books.all {
            sourceFile = project.file(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/docs/</span><span class="inline"><span class="inline-delimiter">$</span>name</span><span class="delimiter">&quot;</span></span>)
        }
        <span class="comment">// Add the container as an extension object</span>
        project.extensions.books = books
    }
}

apply <span class="key">plugin</span>: DocumentationPlugin

<span class="comment">// Configure the container</span>
books {
    quickStart {
        sourceFile = file(<span class="string"><span class="delimiter">'</span><span class="content">src/docs/quick-start</span><span class="delimiter">'</span></span>)
    }
    userGuide {

    }
    developerGuide {

    }
}

task books {
    doLast {
        books.each { book -&gt;
            println <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.name -&gt; </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.sourceFile</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle -q books</code></strong></div>
<div class="content">
<pre>&gt; gradle -q books
developerGuide -&gt; /home/user/gradle/samples/src/docs/developerGuide
quickStart -&gt; /home/user/gradle/samples/src/docs/quick-start
userGuide -&gt; /home/user/gradle/samples/src/docs/userGuide</pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:container(java.lang.Class)">Project.container(java.lang.Class)</a> methods create instances of <a href="../dsl/org.gradle.api.NamedDomainObjectContainer.html">NamedDomainObjectContainer</a>, that have many useful methods for managing and configuring the objects. In order to use a type with any of the <code>project.container</code> methods, it MUST expose a property named &#8220;name&#8221; as the unique, and constant, name for the object. The <code>project.container(Class)</code> variant of the container method creates new instances by attempting to invoke the constructor of the class that takes a single string argument, which is the desired name of the object. See the above link for <code>project.container</code> method variants that allow custom instantiation strategies.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="java_gradle_plugin"><a class="anchor" href="#java_gradle_plugin"></a><a class="link" href="#java_gradle_plugin">Gradle Plugin Development Plugin</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The Java Gradle plugin development plugin is currently <a href="#feature_lifecycle">incubating</a>. Please be aware that the DSL and other configuration may change in later Gradle versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Java Gradle Plugin development plugin can be used to assist in the development of Gradle plugins. It automatically applies the <a href="#java_plugin">Java</a> plugin, adds the <code>gradleApi()</code> dependency to the compile configuration and performs validation of plugin metadata during <code>jar</code> task execution.</p>
</div>
<div class="paragraph">
<p>The plugin also integrates with <a href="#test_kit">TestKit</a>, a library that aids in writing and executing functional tests for plugin code. It automatically adds the <code>gradleTestKit()</code> dependency to the test compile configuration and generates a plugin classpath manifest file consumed by a <code>GradleRunner</code> instance if found. Please refer to <a href="#sub:test-kit-automatic-classpath-injection">Automatic classpath injection with the Plugin Development Plugin</a> for more on its usage, configuration options and samples.</p>
</div>
<div class="sect3">
<h4 id="sec:gradle_plugin_dev_usage"><a class="anchor" href="#sec:gradle_plugin_dev_usage"></a><a class="link" href="#sec:gradle_plugin_dev_usage">Usage</a></h4>
<div class="paragraph">
<p>To use the Java Gradle Plugin Development plugin, include the following in your build script:</p>
</div>
<div class="sect4">
<h5 id="example_using_the_java_gradle_plugin_development_plugin_2"><a class="anchor" href="#example_using_the_java_gradle_plugin_development_plugin_2"></a><a class="link" href="#example_using_the_java_gradle_plugin_development_plugin_2">Example: Using the Java Gradle Plugin Development plugin</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">java-gradle-plugin</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Applying the plugin automatically applies the <a href="#java_plugin">Java</a> plugin and adds the <code>gradleApi()</code> dependency to the compile configuration. It also adds some validations to the build.</p>
</div>
<div class="paragraph">
<p>The following validations are performed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There is a plugin descriptor defined for the plugin.</p>
</li>
<li>
<p>The plugin descriptor contains an <code>implementation-class</code> property.</p>
</li>
<li>
<p>The <code>implementation-class</code> property references a valid class file in the jar.</p>
</li>
<li>
<p>Each property getter or the corresponding field must be annotated with a property annotation like <code>@InputFile</code> and <code>@OutputDirectory</code>. Properties that don&#8217;t participate in up-to-date checks should be annotated with <code>@Internal</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any failed validations will result in a warning message.</p>
</div>
<div class="paragraph">
<p>For each plugin you are developing, add an entry to the <code>gradlePlugin {}</code> script block:</p>
</div>
</div>
<div class="sect4">
<h5 id="example_using_the_gradleplugin_block"><a class="anchor" href="#example_using_the_gradleplugin_block"></a><a class="link" href="#example_using_the_gradleplugin_block">Example: Using the gradlePlugin {} block.</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">gradlePlugin {
    plugins {
        simplePlugin {
            id = <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample.simple-plugin</span><span class="delimiter">'</span></span>
            implementationClass = <span class="string"><span class="delimiter">'</span><span class="content">org.gradle.sample.SimplePlugin</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>gradlePlugin {}</code> block defines the plugins being built by the project including the <code>id</code> and <code>implementationClass</code> of the plugin. From this data about the plugins being developed, Gradle can automatically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Generate the plugin descriptor in the <code>jar</code> file&#8217;s <code>META-INF</code> directory.</p>
</li>
<li>
<p>Configure the <a href="#publishing_maven">Maven</a> or <a href="#publishing_ivy">Ivy Publish Plugins</a> publishing plugins to publish a <a href="#sec:plugin_markers">Plugin Marker Artifact</a> for each plugin.</p>
</li>
<li>
<p>Moreover, if the <a href="https://plugins.gradle.org/docs/publish-plugin">Plugin Publishing Plugin</a> is applied, it will publish each plugin using the same name, plugin id, display name, and description to the Gradle Plugin Portal (see <a href="https://guides.gradle.org/publishing-plugins-to-gradle-plugin-portal/">Publishing Plugins to Gradle Plugin Portal</a> for details).</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lazy_configuration"><a class="anchor" href="#lazy_configuration"></a><a class="link" href="#lazy_configuration">Lazy Configuration</a></h3>
<div class="paragraph">
<p>As a build grows in complexity, knowing when and where a particular value is configured can become difficult to reason about. Gradle provides several ways to manage this complexity using <em>lazy configuration</em>.</p>
</div>
<div class="sect3">
<h4 id="sec:lazy_properties"><a class="anchor" href="#sec:lazy_properties"></a><a class="link" href="#sec:lazy_properties">Lazy properties</a></h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The Provider API is currently <a href="#feature_lifecycle">incubating</a>. Please be aware that the DSL and other configuration may change in later Gradle versions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Gradle provides lazy properties, which delay the calculation of a propertys value until its absolutely required. Lazy types are faster, more understandable and better instrumented than the internal convention mapping mechanisms. This provides two main benefits to build script and plugin authors:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Build authors can wire together Gradle models without worrying when a particular propertys value will be known. For example, when you want to map properties in an extension to task properties but the values aren&#8217;t known until the build script configures them.</p>
</li>
<li>
<p>Build authors can avoid resource intensive work during the configuration phase, which can have a direct impact on maximum build performance. For example, when a property value comes from parsing a file.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Gradle represents lazy properties with two interfaces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../javadoc/org/gradle/api/provider/Provider.html">Provider</a> are properties that can only be queried and cannot be changed.</p>
<div class="ulist">
<ul>
<li>
<p>Properties with these types are read-only.</p>
</li>
<li>
<p>The method <a href="../javadoc/org/gradle/api/provider/Provider.html#get--">Provider.get()</a> returns the current value of the property.</p>
</li>
<li>
<p>A <code>Provider</code> can be created by the factory method <a href="../javadoc/org/gradle/api/provider/ProviderFactory.html#provider-java.util.concurrent.Callable-">ProviderFactory.provider(java.util.concurrent.Callable)</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/provider/Property.html">Property</a> are properties that can be queried and overwritten.</p>
<div class="ulist">
<ul>
<li>
<p>Properties with these types are configurable.</p>
</li>
<li>
<p><code>Property</code> implements the <code>Provider</code> interface.</p>
</li>
<li>
<p>The method <a href="../javadoc/org/gradle/api/provider/Property.html#set-T-">Property.set(T)</a> specifies a value for the property, overwriting whatever value may have been present.</p>
</li>
<li>
<p>The method <a href="../javadoc/org/gradle/api/provider/Property.html#set-org.gradle.api.provider.Provider-">Property.set(org.gradle.api.provider.Provider)</a> specifies a <code>Provider</code> for the value for the property, overwriting whatever value may have been present. This allows you to wire together <code>Provider</code> and <code>Property</code> instances before the values are configured.</p>
</li>
<li>
<p>A <code>Property</code> can be created by the factory method <a href="../javadoc/org/gradle/api/model/ObjectFactory.html#property-java.lang.Class-">ObjectFactory.property(java.lang.Class)</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Neither of these types nor their subtypes are intended to be implemented by a build script or plugin author.  Gradle provides several factory methods to create instances of these types. See the <a href="#sec:lazy_configuration_reference">Quick Reference</a> for all of the types and factories available.</p>
</div>
<div class="paragraph">
<p>Lazy properties are intended to be passed around and only evaluated when required (usually, during the execution phase). For more information about the Gradle build phases, please see <a href="#sec:build_phases">Build Lifecycle</a>.</p>
</div>
<div class="paragraph">
<p>The following demonstrates a task with a read-only property and a configurable property:</p>
</div>
<div class="sect4">
<h5 id="example_using_a_read_only_and_configurable_property"><a class="anchor" href="#example_using_a_read_only_and_configurable_property"></a><a class="link" href="#example_using_a_read_only_and_configurable_property">Example: Using a read-only and configurable property</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Greeting</span> <span class="directive">extends</span> DefaultTask {
    <span class="comment">// Configurable by the user</span>
    <span class="annotation">@Input</span>
    <span class="directive">final</span> Property&lt;<span class="predefined-type">String</span>&gt; message = project.objects.property(<span class="predefined-type">String</span>)

    <span class="comment">// Read-only property calculated from the message</span>
    <span class="annotation">@Internal</span>
    <span class="directive">final</span> <span class="predefined-type">Provider</span>&lt;<span class="predefined-type">String</span>&gt; fullMessage = message.map { <span class="local-variable">it</span> + <span class="string"><span class="delimiter">&quot;</span><span class="content"> from Gradle</span><span class="delimiter">&quot;</span></span> }

    <span class="annotation">@TaskAction</span>
    <span class="type">void</span> printMessage() {
        logger.quiet(fullMessage.get())
    }
}

task greeting(<span class="key">type</span>: Greeting) {
    <span class="comment">// Note that this is effectively calling Property.set()</span>
    message = <span class="string"><span class="delimiter">'</span><span class="content">Hi</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle greeting</code></strong></div>
<div class="content">
<pre>&gt; gradle greeting

&gt; Task :greeting
Hi from Gradle

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Greeting</code> task has a <code>Property&lt;String&gt;</code> for the mutable part of the message and a <code>Provider&lt;String&gt;</code> for the calculated, read-only, message.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Note that Groovy Gradle DSL will generate setter methods for each <code>Property</code>-typed property in a task implementation. These setter methods allow you to configure the property using the assignment (<code>=</code>) operator as a convenience.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:creating_property_provider"><a class="anchor" href="#sec:creating_property_provider"></a><a class="link" href="#sec:creating_property_provider">Creating a Property or Provider</a></h4>
<div class="paragraph">
<p>If provider types are not intended to be implemented directly by build script or plugin authors, how do you create a new one? Gradle provides various factory APIs to create new instances of both <a href="../javadoc/org/gradle/api/provider/Provider.html">Provider</a> and <a href="../javadoc/org/gradle/api/provider/Property.html">Property</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../javadoc/org/gradle/api/provider/ProviderFactory.html#provider-java.util.concurrent.Callable-">ProviderFactory.provider(java.util.concurrent.Callable)</a> instantiates a new <code>Provider</code>. An instance of the <a href="../javadoc/org/gradle/api/provider/ProviderFactory.html">ProviderFactory</a> can be referenced from <a href="../javadoc/org/gradle/api/Project.html#getProviders--">Project.getProviders()</a> or by injecting <code>ProviderFactory</code> through a constructor or method.</p>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/model/ObjectFactory.html#property-java.lang.Class-">ObjectFactory.property(java.lang.Class)</a> instantiates a new <code>Property</code>. An instance of the <a href="../javadoc/org/gradle/api/model/ObjectFactory.html">ObjectFactory</a> can be referenced from <a href="../javadoc/org/gradle/api/Project.html#getObjects--">Project.getObjects()</a> or by injecting <code>ObjectFactory</code> through a constructor or method.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><a href="../dsl/org.gradle.api.Project.html">Project</a> does not provide a specific method signature for creating a provider from a <code>groovy.lang.Closure</code>. When writing a plugin with Groovy, you can use the method signature accepting a <code>java.util.concurrent.Callable</code> parameter. Groovy&#8217;s <a href="http://docs.groovy-lang.org/next/html/documentation/core-semantics.html#_assigning_a_closure_to_a_sam_type">Closure to type coercion</a> will take care of the rest.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec:working_with_files_in_lazy_properties"><a class="anchor" href="#sec:working_with_files_in_lazy_properties"></a><a class="link" href="#sec:working_with_files_in_lazy_properties">Working with files and Providers</a></h4>
<div class="paragraph">
<p>In <a href="#working_with_files">Working with Files</a>, we introduced four collection types for <code>File</code>-like objects:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 37. Collection of files recap</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Read-only Type</th>
<th class="tableblock halign-left valign-top">Configurable Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/file/ConfigurableFileCollection.html">ConfigurableFileCollection</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/file/FileTree.html">FileTree</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../javadoc/org/gradle/api/file/ConfigurableFileTree.html">ConfigurableFileTree</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All of these types are also considered <code>Provider</code> types.</p>
</div>
<div class="paragraph">
<p>In this section, we are going to introduce more strongly typed models for a <a href="../javadoc/org/gradle/api/file/FileSystemLocation.html">FileSystemLocation</a>: <a href="../javadoc/org/gradle/api/file/Directory.html">Directory</a> and <a href="../javadoc/org/gradle/api/file/RegularFile.html">RegularFile</a>. These types shouldn&#8217;t be confused with the standard Java <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html">java.io.File</a> type as they tell Gradle to expect more specific values (a directory or a non-directory, regular file).</p>
</div>
<div class="paragraph">
<p>Gradle provides two specialized <code>Property</code> subtypes for dealing with these types: <a href="../javadoc/org/gradle/api/file/RegularFileProperty.html">RegularFileProperty</a> and <a href="../javadoc/org/gradle/api/file/DirectoryProperty.html">DirectoryProperty</a>. <a href="../javadoc/org/gradle/api/file/ProjectLayout.html">ProjectLayout</a> has methods to create these: <a href="../javadoc/org/gradle/api/file/ProjectLayout.html#fileProperty--">ProjectLayout.fileProperty()</a> and <a href="../javadoc/org/gradle/api/file/ProjectLayout.html#directoryProperty--">ProjectLayout.directoryProperty()</a>.</p>
</div>
<div class="paragraph">
<p>A <code>DirectoryProperty</code> can also be used to create a lazily evaluated <code>Provider</code> for a <code>Directory</code> and <code>RegularFile</code> via <a href="../javadoc/org/gradle/api/file/DirectoryProperty.html#dir-java.lang.String-">DirectoryProperty.dir(java.lang.String)</a> and <a href="../javadoc/org/gradle/api/file/DirectoryProperty.html#file-java.lang.String-">DirectoryProperty.file(java.lang.String)</a> respectively. These methods create paths that are relative to the location set for the original <code>DirectoryProperty</code>.</p>
</div>
<div class="sect4">
<h5 id="example_using_file_and_directory_property"><a class="anchor" href="#example_using_file_and_directory_property"></a><a class="link" href="#example_using_file_and_directory_property">Example: Using file and directory property</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">FooExtension</span> {
    <span class="directive">final</span> DirectoryProperty someDirectory
    <span class="directive">final</span> RegularFileProperty someFile
    <span class="directive">final</span> ConfigurableFileCollection someFiles

    FooExtension(Project project) {
        someDirectory = project.layout.directoryProperty()
        someFile = project.layout.fileProperty()
        someFiles = project.layout.configurableFiles()
    }
}

project.extensions.create(<span class="string"><span class="delimiter">'</span><span class="content">foo</span><span class="delimiter">'</span></span>, FooExtension, project)

foo {
    someDirectory = project.layout.projectDirectory.dir(<span class="string"><span class="delimiter">'</span><span class="content">some-directory</span><span class="delimiter">'</span></span>)
    someFile = project.layout.buildDirectory.file(<span class="string"><span class="delimiter">'</span><span class="content">some-file</span><span class="delimiter">'</span></span>)
    someFiles.from project.layout.configurableFiles(someDirectory, someFile)
}

task print {
    doLast {
        <span class="keyword">def</span> someDirectory = project.foo.someDirectory.get().asFile
        logger.quiet(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo.someDirectory = </span><span class="delimiter">&quot;</span></span> + someDirectory)
        logger.quiet(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo.someFiles contains someDirectory? </span><span class="delimiter">&quot;</span></span> + project.foo.someFiles.contains(someDirectory))

        <span class="keyword">def</span> someFile = project.foo.someFile.get().asFile
        logger.quiet(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo.someFile = </span><span class="delimiter">&quot;</span></span> + someFile)
        logger.quiet(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo.someFiles contains someFile? </span><span class="delimiter">&quot;</span></span> + project.foo.someFiles.contains(someFile))
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle print</code></strong></div>
<div class="content">
<pre>&gt; gradle print

&gt; Task :print
foo.someDirectory = /home/user/gradle/samples/some-directory
foo.someFiles contains someDirectory? true
foo.someFile = /home/user/gradle/samples/build/some-file
foo.someFiles contains someFile? true

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
<div class="paragraph">
<p>This example shows how <code>Provider</code> types can be used inside an extension. Lazy values for <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:buildDir">Project.getBuildDir()</a> and <a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:projectDir">Project.getProjectDir()</a> can be accessed through <a href="../javadoc/org/gradle/api/Project.html#getLayout--">Project.getLayout()</a> with <a href="../javadoc/org/gradle/api/file/ProjectLayout.html#getBuildDirectory--">ProjectLayout.getBuildDirectory()</a> and <a href="../javadoc/org/gradle/api/file/ProjectLayout.html#getProjectDirectory--">ProjectLayout.getProjectDirectory()</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:working_with_task_dependencies_in_lazy_properties"><a class="anchor" href="#sec:working_with_task_dependencies_in_lazy_properties"></a><a class="link" href="#sec:working_with_task_dependencies_in_lazy_properties">Working with task dependencies and Providers</a></h4>
<div class="paragraph">
<p>Many builds have several tasks that depend on each other. This usually means that one task processes the outputs of another task as an input. For these outputs and inputs, we need to know their locations on the file system and appropriately configure each task to know where to look. This can be cumbersome if any of these values are configurable by a user or configured by multiple plugins.</p>
</div>
<div class="paragraph">
<p>To make this easier, Gradle offers convenient APIs for defining files or directories as task inputs and outputs in a descriptive way. As an example consider the following plugin with a producer and consumer task, which are wired together via inputs and outputs:</p>
</div>
<div class="sect4">
<h5 id="example_implicit_task_dependency"><a class="anchor" href="#example_implicit_task_dependency"></a><a class="link" href="#example_implicit_task_dependency">Example: Implicit task dependency</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Producer</span> <span class="directive">extends</span> DefaultTask {
    <span class="annotation">@OutputFile</span>
    <span class="directive">final</span> RegularFileProperty outputFile = newOutputFile()

    <span class="annotation">@TaskAction</span>
    <span class="type">void</span> produce() {
        <span class="predefined-type">String</span> message = <span class="string"><span class="delimiter">'</span><span class="content">Hello, World!</span><span class="delimiter">'</span></span>
        <span class="keyword">def</span> output = outputFile.get().asFile
        output.text = message
        logger.quiet(<span class="string"><span class="delimiter">&quot;</span><span class="content">Wrote '</span><span class="inline"><span class="inline-delimiter">${</span>message<span class="inline-delimiter">}</span></span><span class="content">' to </span><span class="inline"><span class="inline-delimiter">${</span>output<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
    }
}

<span class="type">class</span> <span class="class">Consumer</span> <span class="directive">extends</span> DefaultTask {
    <span class="annotation">@InputFile</span>
    <span class="directive">final</span> RegularFileProperty inputFile = newInputFile()

    <span class="annotation">@TaskAction</span>
    <span class="type">void</span> consume() {
        <span class="keyword">def</span> input = inputFile.get().asFile
        <span class="keyword">def</span> message = input.text
        logger.quiet(<span class="string"><span class="delimiter">&quot;</span><span class="content">Read '</span><span class="inline"><span class="inline-delimiter">${</span>message<span class="inline-delimiter">}</span></span><span class="content">' from </span><span class="inline"><span class="inline-delimiter">${</span>input<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
    }
}

task producer(<span class="key">type</span>: Producer)
task consumer(<span class="key">type</span>: Consumer)

<span class="comment">// Wire property from producer to consumer task</span>
consumer.inputFile = producer.outputFile

<span class="comment">// Set values for the producer lazily</span>
<span class="comment">// Note that the consumer does not need to be changed again.</span>
producer.outputFile = layout.buildDirectory.file(<span class="string"><span class="delimiter">'</span><span class="content">file.txt</span><span class="delimiter">'</span></span>)

<span class="comment">// Change the base output directory.</span>
<span class="comment">// Note that this automatically changes producer.outputFile and consumer.inputFile</span>
buildDir = <span class="string"><span class="delimiter">'</span><span class="content">output</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle consumer</code></strong></div>
<div class="content">
<pre>&gt; gradle consumer

&gt; Task :producer
Wrote 'Hello, World!' to /home/user/gradle/samples/output/file.txt

&gt; Task :consumer
Read 'Hello, World!' from /home/user/gradle/samples/output/file.txt

BUILD SUCCESSFUL in 0s
2 actionable tasks: 2 executed</pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, the task outputs and inputs are connected before any location is defined. This is possible because the input and output properties use the <code>Provider</code> API. The output property is created with <a href="../javadoc/org/gradle/api/DefaultTask.html#newOutputFile--">DefaultTask.newOutputFile()</a> and the input property is created with <a href="../javadoc/org/gradle/api/DefaultTask.html#newInputFile--">DefaultTask.newInputFile()</a>. Values are only resolved when they are needed during execution. The setters can be called at any time before the task is executed and the change will automatically affect all related input and output properties.</p>
</div>
<div class="paragraph">
<p>Another thing to note is the absence of any explicit task dependency. Properties created via <code>newOutputFile()</code> and <code>newOutputDirectory()</code> bring knowledge about which task is generating them, so using them as task input will implicitly link tasks together.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:working_with_collection"><a class="anchor" href="#sec:working_with_collection"></a><a class="link" href="#sec:working_with_collection">Working with collection Providers</a></h4>
<div class="paragraph">
<p>In this section, we are going to explore lazy collections. They work exactly like any other <code>Provider</code> and, just like <code>FileSystemLocation</code> providers, they have additional modeling around them. There are two provider interfaces available, one for <code>List</code> values and another for <code>Set</code> values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>List</code> values the interface is called <a href="../javadoc/org/gradle/api/provider/ListProperty.html">ListProperty</a>. You can create a new <code>ListProperty</code> using <a href="../javadoc/org/gradle/api/model/ObjectFactory.html#listProperty-java.lang.Class-">ObjectFactory.listProperty(java.lang.Class)</a> and specifying the element&#8217;s type.</p>
</li>
<li>
<p>For <code>Set</code> values the interface is called <a href="../javadoc/org/gradle/api/provider/SetProperty.html">SetProperty</a>. You can create a new <code>SetProperty</code> using <a href="../javadoc/org/gradle/api/model/ObjectFactory.html#setProperty-java.lang.Class-">ObjectFactory.setProperty(java.lang.Class)</a> and specifying the element&#8217;s type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This type of property allows you to overwrite the entire collection value with <a href="../javadoc/org/gradle/api/provider/HasMultipleValues.html#set-java.lang.Iterable-">HasMultipleValues.set(java.lang.Iterable)</a> and <a href="../javadoc/org/gradle/api/provider/HasMultipleValues.html#set-org.gradle.api.provider.Provider-">HasMultipleValues.set(org.gradle.api.provider.Provider)</a> or add new elements through the various <code>add</code> methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../javadoc/org/gradle/api/provider/HasMultipleValues.html#add-T-">HasMultipleValues.add(T)</a>: Add a single concrete element to the collection</p>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/provider/HasMultipleValues.html#add-org.gradle.api.provider.Provider-">HasMultipleValues.add(org.gradle.api.provider.Provider)</a>: Add a lazily evaluated element to the collection</p>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/provider/HasMultipleValues.html#addAll-org.gradle.api.provider.Provider-">HasMultipleValues.addAll(org.gradle.api.provider.Provider)</a>: Add a lazily evaluated collection of elements to the list</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Just like every <code>Provider</code>, the collection is calculated when <a href="../javadoc/org/gradle/api/provider/Provider.html#get--">Provider.get()</a> is called. The following example show the <a href="../javadoc/org/gradle/api/provider/ListProperty.html">ListProperty</a> in action:</p>
</div>
<div class="sect4">
<h5 id="example_list_property"><a class="anchor" href="#example_list_property"></a><a class="link" href="#example_list_property">Example: List property</a></h5>
<div class="listingblock multi-language-sample">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task print {
    doLast {
        ListProperty&lt;<span class="predefined-type">String</span>&gt; list = project.objects.listProperty(<span class="predefined-type">String</span>)

        <span class="comment">// Resolve the list</span>
        logger.quiet(<span class="string"><span class="delimiter">'</span><span class="content">The list contains: </span><span class="delimiter">'</span></span> + list.get())

        <span class="comment">// Add elements to the empty list</span>
        list.add(project.provider { <span class="string"><span class="delimiter">'</span><span class="content">element-1</span><span class="delimiter">'</span></span> })  <span class="comment">// Add a provider element</span>
        list.add(<span class="string"><span class="delimiter">'</span><span class="content">element-2</span><span class="delimiter">'</span></span>)                       <span class="comment">// Add a concrete element</span>

        <span class="comment">// Resolve the list</span>
        logger.quiet(<span class="string"><span class="delimiter">'</span><span class="content">The list contains: </span><span class="delimiter">'</span></span> + list.get())

        <span class="comment">// Overwrite the entire list with a new list</span>
        list.set([<span class="string"><span class="delimiter">'</span><span class="content">element-3</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">element-4</span><span class="delimiter">'</span></span>])

        <span class="comment">// Resolve the list</span>
        logger.quiet(<span class="string"><span class="delimiter">'</span><span class="content">The list contains: </span><span class="delimiter">'</span></span> + list.get())

        <span class="comment">// Add more elements through a list provider</span>
        list.addAll(project.provider { [<span class="string"><span class="delimiter">'</span><span class="content">element-5</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">element-6</span><span class="delimiter">'</span></span>] })

        <span class="comment">// Resolve the list</span>
        logger.quiet(<span class="string"><span class="delimiter">'</span><span class="content">The list contains: </span><span class="delimiter">'</span></span> + list.get())
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output of <strong><code>gradle print</code></strong></div>
<div class="content">
<pre>&gt; gradle print

&gt; Task :print
The list contains: []
The list contains: [element-1, element-2]
The list contains: [element-3, element-4]
The list contains: [element-3, element-4, element-5, element-6]

BUILD SUCCESSFUL in 0s
1 actionable task: 1 executed</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec:lazy_configuration_faqs"><a class="anchor" href="#sec:lazy_configuration_faqs"></a><a class="link" href="#sec:lazy_configuration_faqs">Guidelines</a></h4>
<div class="paragraph">
<p>This section will introduce guidelines to be successful with the Provider API. To see those guidelines in action, have a look at <a href="https://github.com/gradle-guides/gradle-site-plugin">gradle-site-plugin</a>, a Gradle plugin demonstrating established techniques and practices for plugin development.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="../javadoc/org/gradle/api/provider/Property.html">Property</a> and <a href="../javadoc/org/gradle/api/provider/Provider.html">Provider</a> types have all of the overloads you need to query or configure a value. For this reason, you should follow the following guidelines:</p>
<div class="ulist">
<ul>
<li>
<p>For configurable properties, expose the <a href="../javadoc/org/gradle/api/provider/Property.html">Property</a> directly through a single getter.</p>
</li>
<li>
<p>For non-configurable properties, expose an <a href="../javadoc/org/gradle/api/provider/Provider.html">Provider</a> directly through a single getter.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Avoid simplifying calls like <code>obj.getProperty().get()</code> and <code>obj.getProperty().set(T)</code> in your code by introducing additional getters and setters.</p>
</li>
<li>
<p>When migrating your plugin to use providers, follow these guidelines:</p>
<div class="ulist">
<ul>
<li>
<p>If it&#8217;s a new property, expose it as a <a href="../javadoc/org/gradle/api/provider/Property.html">Property</a> or <a href="../javadoc/org/gradle/api/provider/Provider.html">Provider</a> using a single getter.</p>
</li>
<li>
<p>If it&#8217;s incubating, change it to use a <a href="../javadoc/org/gradle/api/provider/Property.html">Property</a> or <a href="../javadoc/org/gradle/api/provider/Provider.html">Provider</a> using a single getter.</p>
</li>
<li>
<p>If it&#8217;s a stable property, add a new <a href="../javadoc/org/gradle/api/provider/Property.html">Property</a> or <a href="../javadoc/org/gradle/api/provider/Provider.html">Provider</a> and deprecate the old one. You should wire the old getter/setters into the new property as appropriate.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sec:lazy_configuration_roadmap"><a class="anchor" href="#sec:lazy_configuration_roadmap"></a><a class="link" href="#sec:lazy_configuration_roadmap">Future development</a></h4>
<div class="paragraph">
<p>Going forward, new properties will use the Provider API. The Groovy Gradle DSL adds convenience methods to make the use of Providers mostly transparent in build scripts. Existing tasks will have their existing "raw" properties replaced by Providers as needed and in a backwards compatible way. New tasks will be designed with the Provider API.</p>
</div>
<div class="paragraph">
<p>The Provider API is <a href="#feature_lifecycle">incubating</a>. Please create new issues at <a href="https://github.com/gradle/gradle/issues/new">gradle/gradle</a> to report bugs or to submit use cases for new features.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec:lazy_configuration_reference"><a class="anchor" href="#sec:lazy_configuration_reference"></a><a class="link" href="#sec:lazy_configuration_reference">Provider Files API Reference</a></h4>
<div class="paragraph">
<p>Use these types for <em>read-only</em> values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="../javadoc/org/gradle/api/provider/Provider.html">Provider</a>&lt;<a href="../javadoc/org/gradle/api/file/RegularFile.html">RegularFile</a>&gt;</dt>
<dd>
<p>File on disk</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="../javadoc/org/gradle/api/file/ProjectLayout.html#fileProperty--">ProjectLayout.fileProperty()</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/file/DirectoryProperty.html#file-java.lang.String-">DirectoryProperty.file(java.lang.String)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="../javadoc/org/gradle/api/provider/Provider.html">Provider</a>&lt;<a href="../javadoc/org/gradle/api/file/Directory.html">Directory</a>&gt;</dt>
<dd>
<p>Directory on disk</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="../javadoc/org/gradle/api/file/ProjectLayout.html#directoryProperty--">ProjectLayout.directoryProperty()</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/file/DirectoryProperty.html#dir-java.lang.String-">DirectoryProperty.dir(java.lang.String)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="../javadoc/org/gradle/api/file/FileCollection.html">FileCollection</a></dt>
<dd>
<p>Unstructured collection of files</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:files(java.lang.Object[])">Project.files(java.lang.Object[])</a></p>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/file/ProjectLayout.html#files-java.lang.Object...-">ProjectLayout.files(java.lang.Object...)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="../javadoc/org/gradle/api/file/FileTree.html">FileTree</a></dt>
<dd>
<p>Hierarchy of files</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:fileTree(java.lang.Object)">Project.fileTree(java.lang.Object)</a> will produce a <a href="../javadoc/org/gradle/api/file/ConfigurableFileTree.html">ConfigurableFileTree</a>, or you can use <a href="../javadoc/org/gradle/api/Project.html#zipTree-java.lang.Object-">Project.zipTree(Object)</a> and <a href="../javadoc/org/gradle/api/Project.html#tarTree-java.lang.Object-">Project.tarTree(Object)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="property_files_api_reference"><a class="anchor" href="#property_files_api_reference"></a><a class="link" href="#property_files_api_reference">Property Files API Reference</a></h4>
<div class="paragraph">
<p>Use these types for <em>mutable</em> values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="../javadoc/org/gradle/api/file/RegularFileProperty.html">RegularFileProperty</a></dt>
<dd>
<p>File on disk</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="../javadoc/org/gradle/api/DefaultTask.html#newInputFile--">DefaultTask.newInputFile()</a> and <a href="../javadoc/org/gradle/api/DefaultTask.html#newOutputFile--">DefaultTask.newOutputFile()</a> if used as task input/output</p>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/file/Directory.html#file-java.lang.String-">Directory.file(java.lang.String)</a> otherwise</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="../javadoc/org/gradle/api/file/DirectoryProperty.html">DirectoryProperty</a></dt>
<dd>
<p>Directory on disk</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="../javadoc/org/gradle/api/DefaultTask.html#newInputDirectory--">DefaultTask.newInputDirectory()</a> and <a href="../javadoc/org/gradle/api/DefaultTask.html#newOutputDirectory--">DefaultTask.newOutputDirectory()</a> if used as task input/output</p>
</li>
<li>
<p><a href="../javadoc/org/gradle/api/file/Directory.html#dir-java.lang.String-">Directory.dir(java.lang.String)</a> otherwise</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="../javadoc/org/gradle/api/file/ConfigurableFileCollection.html">ConfigurableFileCollection</a></dt>
<dd>
<p>Unstructured collection of files</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="../javadoc/org/gradle/api/file/ProjectLayout.html#configurableFiles-java.lang.Object...-">ProjectLayout.configurableFiles(java.lang.Object...)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><a href="../javadoc/org/gradle/api/file/ConfigurableFileTree.html">ConfigurableFileTree</a></dt>
<dd>
<p>Hierarchy of files</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Factories</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="../dsl/org.gradle.api.Project.html#org.gradle.api.Project:fileTree(java.lang.Object)">Project.fileTree(java.lang.Object)</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="lazy_collections_api_reference"><a class="anchor" href="#lazy_collections_api_reference"></a><a class="link" href="#lazy_collections_api_reference">Lazy Collections API Reference</a></h4>
<div class="ulist">
<ul>
<li>
<p>For lists, use <a href="../javadoc/org/gradle/api/model/ObjectFactory.html#listProperty-java.lang.Class-">ObjectFactory.listProperty(java.lang.Class)</a> to get a <a href="../javadoc/org/gradle/api/provider/ListProperty.html">ListProperty</a> which is also a <code>Provider&lt;List&lt;T&gt;&gt;</code></p>
</li>
<li>
<p>For sets, use <a href="../javadoc/org/gradle/api/model/ObjectFactory.html#setProperty-java.lang.Class-">ObjectFactory.setProperty(java.lang.Class)</a> to get a <a href="../javadoc/org/gradle/api/provider/SetProperty.html">SetProperty</a> which is a <code>Provider&lt;Set&lt;T&gt;&gt;</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="lazy_objects_api_reference"><a class="anchor" href="#lazy_objects_api_reference"></a><a class="link" href="#lazy_objects_api_reference">Lazy Objects API Reference</a></h4>
<div class="paragraph">
<p>Use <a href="../javadoc/org/gradle/api/model/ObjectFactory.html#property-java.lang.Class-">ObjectFactory.property(java.lang.Class)</a> to construct a <code>Property&lt;T&gt;</code> which is a <code>Provider&lt;T&gt;</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="licenses"><a class="anchor" href="#licenses"></a><a class="link" href="#licenses">Licenses</a></h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="documentation_licenses"><a class="anchor" href="#documentation_licenses"></a><a class="link" href="#documentation_licenses">Documentation licenses</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="sec:gradle_documentation"><a class="anchor" href="#sec:gradle_documentation"></a><a class="link" href="#sec:gradle_documentation">Gradle Documentation</a></h3>
<div class="paragraph">
<p><em>Copyright  2007-2018 Gradle, Inc.</em></p>
</div>
<div class="paragraph">
<p>Gradle build tool source code is open and licensed under the <a href="https://github.com/gradle/gradle/blob/master/LICENSE">Apache License 2.0</a>.
Gradle user manual and DSL references are licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. At <a href="http://www.defmacro.org/ramblings/lisp.html" class="bare">http://www.defmacro.org/ramblings/lisp.html</a> you find an interesting article comparing Ant, XML, Java and Lisp. It&#8217;s funny that the 'if Java had that syntax' syntax in this article is actually the Groovy syntax.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. Gradle supports partial multi-project builds (see <a href="#multi_project_builds">Authoring Multi-Project Builds</a>).
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. There are command line switches to change this behavior. See <a href="#command_line_interface">Command-Line Interface</a>)
</div>
<div class="footnote" id="_footnotedef_4">
<a href="#_footnoteref_4">4</a>. The real use case we had, was using <a href="http://lucene.apache.org/solr" class="bare">http://lucene.apache.org/solr</a>, where you need a separate war for each index you are accessing. That was one reason why we have created a distribution of webapps. The Resin servlet container allows us, to let such a distribution point to a base installation of the servlet container.
</div>
<div class="footnote" id="_footnotedef_5">
<a href="#_footnoteref_5">5</a>. We do this here, as it makes the layout a bit easier. We usually put the project specific stuff into the build script of the respective projects.
</div>
<div class="footnote" id="_footnotedef_6">
<a href="#_footnoteref_6">6</a>. You might be wondering why there is neither an import for the <code>StopExecutionException</code> nor do we access it via its fully qualified name. The reason is, that Gradle adds a set of default imports to your script (see <a href="#script-default-imports">Default imports</a>).
</div>
<div class="footnote" id="_footnotedef_7">
<a href="#_footnoteref_7">7</a>. Any language element except for statement labels.
</div>
<div class="footnote" id="_footnotedef_8">
<a href="#_footnoteref_8">8</a>. It is planned for a future release to provide out-of-the-box support for this
</div>
<div class="footnote" id="_footnotedef_9">
<a href="#_footnoteref_9">9</a>. Gradle uses the same conventions as introduced by Russel Winder&#8217;s <a href="https://gant.github.io/">Gant tool</a>.
</div>
<div class="footnote" id="_footnotedef_10">
<a href="#_footnoteref_10">10</a>. In fact, any artifact added to the <code>archives</code> configuration will be built by <code>assemble</code>
</div>
<div class="footnote" id="_footnotedef_11">
<a href="#_footnoteref_11">11</a>. For more details on <code>gradle.properties</code> see <a href="#sec:gradle_configuration_properties">Gradle configuration properties</a>
</div>
<div class="footnote" id="_footnotedef_12">
<a href="#_footnoteref_12">12</a>. The JUnit wiki contains a detailed description on how to work with JUnit categories: <a href="https://github.com/junit-team/junit/wiki/Categories" class="bare">https://github.com/junit-team/junit/wiki/Categories</a>.
</div>
<div class="footnote" id="_footnotedef_13">
<a href="#_footnoteref_13">13</a>. The TestNG documentation contains more details about test groups: <a href="http://testng.org/doc/documentation-main.html#test-groups" class="bare">http://testng.org/doc/documentation-main.html#test-groups</a>.
</div>
<div class="footnote" id="_footnotedef_14">
<a href="#_footnoteref_14">14</a>. The TestNG documentation contains more details about test ordering when working with <code>testng.xml</code> files: <a href="http://testng.org/doc/documentation-main.html#testng-xml" class="bare">http://testng.org/doc/documentation-main.html#testng-xml</a>.
</div>
<div class="footnote" id="_footnotedef_15">
<a href="#_footnoteref_15">15</a>. In Groovy you can execute Strings. To learn more about executing external processes with Groovy have a look in 'Groovy in Action' 9.3.2 or at the Groovy wiki
</div>
<div class="footnote" id="_footnotedef_16">
<a href="#_footnoteref_16">16</a>. The <code>runtime</code> configuration extends the <code>compile</code> configuration.
</div>
<div class="footnote" id="_footnotedef_17">
<a href="#_footnoteref_17">17</a>. See <a href="#sec:configure_scala_classpath">Automatic configuration of Scala classpath</a>.
</div>
</div>
</div>
<!-- end div class="chapter" -->
<aside class="secondary-navigation"></aside>
</main>

<footer class="site-layout__footer site-footer" itemscope="itemscope" itemtype="https://schema.org/WPFooter">
    <nav class="site-footer__navigation" itemtype="https://schema.org/SiteNavigationElement">
        <section class="site-footer__links">
            <div class="site-footer__link-group">
                <header><strong>Docs</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="/userguide/userguide.html" itemprop="url">User Manual</a></li>
                    <li itemprop="name"><a href="/dsl/" itemprop="url">DSL Reference</a></li>
                    <li itemprop="name"><a href="/release-notes.html" itemprop="url">Release Notes</a></li>
                    <li itemprop="name"><a href="/javadoc/" itemprop="url">Javadoc</a></li>
                </ul>
            </div>
            <div class="site-footer__link-group">
                <header><strong>News</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://blog.gradle.org/" itemprop="url">Blog</a></li>
                    <li itemprop="name"><a href="https://newsletter.gradle.com/" itemprop="url">Newsletter</a></li>
                    <li itemprop="name"><a href="https://twitter.com/gradle" itemprop="url">Twitter</a></li>
                </ul>
            </div>
            <div class="site-footer__link-group">
                <header><strong>Products</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://gradle.com/build-scans" itemprop="url">Build Scans</a></li>
                    <li itemprop="name"><a href="https://gradle.com/build-cache" itemprop="url">Build Cache</a></li>
                    <li itemprop="name"><a href="https://gradle.com/enterprise/resources" itemprop="url">Enterprise Docs</a></li>
                </ul>
            </div>
            <div class="site-footer__link-group">
                <header><strong>Get Help</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://discuss.gradle.org/c/help-discuss" itemprop="url">Forums</a></li>
                    <li itemprop="name"><a href="https://github.com/gradle/" itemprop="url">GitHub</a></li>
                    <li itemprop="name"><a href="https://gradle.org/training/" itemprop="url">Training</a></li>
                    <li itemprop="name"><a href="https://gradle.org/services/" itemprop="url">Services</a></li>
                </ul>
            </div>
        </section>
        <section class="site-footer__subscribe-newsletter">
            <p>Subscribe for important Gradle updates and news</p>
            <form id="newsletter-form" class="newsletter-form" action="https://go.pardot.com/l/68052/2017-12-01/b8dh7j" method="post">
                <input id="email" class="email" name="email" type="email" placeholder="name@email.com" pattern="[^@\s]+@[^@\s]+\.[^@\s]+" maxlength="255" required=""/>
                <button id="submit" class="submit" type="submit">Subscribe</button>
            </form>
            <p class="disclaimer">By entering your email, you agree to our <a href="https://gradle.org/terms/">Terms</a> and <a href="https://gradle.org/privacy/">Privacy Policy</a>, including receipt of emails. You can unsubscribe at any time.</p>
        </section>
    </nav>
    <div class="site-footer-secondary">
        <div class="site-footer-secondary__contents">
            <div class="site-footer__copy"> <a href="https://gradle.com">Gradle Inc.</a>
                <time>2018</time>
                All rights reserved.
            </div>
            <div class="site-footer__logo"><a href="/">
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40" class="logo-icon">
                    <g style="fill:none;opacity:0.7">
                        <g fill="#11272E">
                            <path
                                d="M37.7 7.1C36.4 4.8 34 4 32.4 4 30.4 4 28.7 5.1 29 5.9 29.1 6 29.5 6.8 29.7 7.2 30 7.7 30.6 7.3 30.9 7.2 31.5 6.9 32.2 6.7 32.9 6.8 33.6 6.9 34.6 7.4 35.3 8.6 36.8 11.6 32.1 17.8 26.2 13.5 20.3 9.3 14.5 10.7 11.9 11.5 9.3 12.4 8.1 13.3 9.2 15.3 10.6 18 10.1 17.1 11.5 19.4 13.6 22.9 18.3 17.7 18.3 17.7 14.8 23 11.8 21.7 10.6 19.9 9.6 18.2 8.8 16.3 8.8 16.3 -0.1 19.5 2.3 33.6 2.3 33.6L6.7 33.6C7.9 28.4 11.9 28.6 12.6 33.6L15.9 33.6C18.9 23.5 26.4 33.6 26.4 33.6L30.8 33.6C29.6 26.7 33.3 24.5 35.6 20.5 37.9 16.4 40.1 11.5 37.7 7.1L37.7 7.1ZM26.3 20.5C24 19.7 24.9 17.3 24.9 17.3 24.9 17.3 26.9 18 29.6 18.9 29.5 19.6 28.1 21 26.3 20.5L26.3 20.5Z"/>
                            <path d="M28.4 18.7C28.5 19.3 28 19.9 27.3 20 26.6 20.1 26 19.6 26 18.9 25.9 18.3 26.4 17.7 27.1 17.6 27.7 17.6 28.3 18 28.4 18.7"/>
                            <path
                                d="M37.7 7.1C36.4 4.8 34 4 32.4 4 30.4 4 28.7 5.1 29 5.9 29.1 6 29.5 6.8 29.7 7.2 30 7.7 30.6 7.3 30.9 7.2 31.5 6.9 32.2 6.7 32.9 6.8 33.6 6.9 34.6 7.4 35.3 8.6 36.8 11.6 32.1 17.8 26.2 13.5 20.3 9.3 14.5 10.7 11.9 11.5 9.3 12.4 8.1 13.3 9.2 15.3 10.6 18 10.1 17.1 11.5 19.4 13.6 22.9 18.3 17.7 18.3 17.7 14.8 23 11.8 21.7 10.6 19.9 9.6 18.2 8.8 16.3 8.8 16.3 -0.1 19.5 2.3 33.6 2.3 33.6L6.7 33.6C7.9 28.4 11.9 28.6 12.6 33.6L15.9 33.6C18.9 23.5 26.4 33.6 26.4 33.6L30.8 33.6C29.6 26.7 33.3 24.5 35.6 20.5 37.9 16.4 40.1 11.5 37.7 7.1L37.7 7.1ZM26.3 20.5C24 19.7 24.9 17.3 24.9 17.3 24.9 17.3 26.9 18 29.6 18.9 29.5 19.6 28.1 21 26.3 20.5L26.3 20.5Z"/>
                            <path d="M28.4 18.7C28.5 19.3 28 19.9 27.3 20 26.6 20.1 26 19.6 26 18.9 25.9 18.3 26.4 17.7 27.1 17.6 27.7 17.6 28.3 18 28.4 18.7"/>
                        </g>
                    </g>
                </svg>
            </a></div>
            <div class="site-footer-secondary__links">
                <a href="https://gradle.com/careers">Careers</a> |
                <a href="https://gradle.org/privacy">Privacy</a> |
                <a href="https://gradle.org/terms">Terms of Service</a> |
                <a href="https://gradle.org/contact/">Contact</a>
            </div>
        </div>
    </div>
</footer>

<script type="text/javascript">
    // Polyfill Element.matches()
    if (!Element.prototype.matches) {
        Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
    }
    // Polyfill Element.closest()
    if (!Element.prototype.closest) {
        Element.prototype.closest = function (s) {
            var el = this;
            if (!document.documentElement.contains(el)) return null;
            do {
                if (typeof el.matches === "function" && el.matches(s)) return el;
                el = el.parentElement || el.parentNode;
            } while (el !== null);
            return null;
        };
    }
    [].forEach.call(document.querySelectorAll(".docs-navigation a[href$='" + window.location.pathname + "']"), function (link) {
        // Add "active" to all links same as current URL
        link.classList.add("active");

        // Expand all parent navigation
        var parentListEl = link.closest("li");
        while (parentListEl !== null) {
            var dropDownEl = parentListEl.querySelector(".nav-dropdown");
            if (dropDownEl !== null) {
                dropDownEl.classList.add("expanded");
            }
            parentListEl = parentListEl.parentNode.closest("li");
        }
    });

    // Expand/contract multi-level side navigation
    [].forEach.call(document.querySelectorAll(".docs-navigation .nav-dropdown"), function registerSideNavActions(collapsibleElement) {
        collapsibleElement.addEventListener("click", function toggleExpandedSideNav(evt) {
            evt.preventDefault();
            evt.target.classList.toggle("expanded");
            evt.target.setAttribute("aria-expanded", evt.target.classList.contains("expanded").toString());
            return false;
        }, false);
    });
</script>

</body>
</html>